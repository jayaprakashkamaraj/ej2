{"version":3,"file":"ej2-documenteditor.min.js","sources":["../../src/document-editor/base/dictionary.js","../../src/document-editor/base/unique-format.js","../../src/document-editor/base/unique-formats.js","../../src/document-editor/document-editor.js","../../src/document-editor/implementation/print.js","../../src/document-editor/implementation/format/section-format.js","../../src/document-editor/implementation/list/level-override.js","../../src/document-editor/implementation/list/list.js","../../src/document-editor/implementation/format/list-format.js","../../src/document-editor/implementation/format/paragraph-format.js","../../src/document-editor/implementation/format/character-format.js","../../src/document-editor/implementation/editor/editor-helper.js","../../src/document-editor/implementation/format/style.js","../../src/document-editor/implementation/format/border.js","../../src/document-editor/implementation/format/borders.js","../../src/document-editor/implementation/format/shading.js","../../src/document-editor/implementation/format/table-format.js","../../src/document-editor/implementation/format/row-format.js","../../src/document-editor/implementation/format/cell-format.js","../../src/document-editor/implementation/viewer/page.js","../../src/document-editor/implementation/context-menu.js","../../src/document-editor/implementation/list/abstract-list.js","../../src/document-editor/implementation/list/list-level.js","../../src/document-editor/implementation/viewer/layout.js","../../src/document-editor/implementation/viewer/render.js","../../src/document-editor/implementation/viewer/text-helper.js","../../src/document-editor/implementation/viewer/zooming.js","../../src/document-editor/implementation/viewer/viewer.js","../../src/document-editor/implementation/viewer/sfdt-reader.js","../../src/document-editor/implementation/selection/selection-format.js","../../src/document-editor/implementation/writer/html-export.js","../../src/document-editor/implementation/selection/selection-helper.js","../../src/document-editor/implementation/selection/selection.js","../../src/document-editor/implementation/search/text-search.js","../../src/document-editor/implementation/search/text-search-result.js","../../src/document-editor/implementation/search/text-search-results.js","../../src/document-editor/implementation/search/search-results.js","../../src/document-editor/implementation/search/search.js","../../src/document-editor/implementation/search/options-pane.js","../../src/document-editor/implementation/editor/table-resizer.js","../../src/document-editor/implementation/editor/editor.js","../../src/document-editor/implementation/editor-history/history-helper.js","../../src/document-editor/implementation/editor-history/base-history-info.js","../../src/document-editor/implementation/editor/image-resizer.js","../../src/document-editor/implementation/editor-history/history-info.js","../../src/document-editor/implementation/editor-history/editor-history.js","../../src/document-editor/implementation/writer/word-export.js","../../src/document-editor/implementation/writer/text-export.js","../../src/document-editor/implementation/writer/sfdt-export.js","../../src/document-editor/implementation/dialogs/hyperlink-dialog.js","../../src/document-editor/implementation/dialogs/table-dialog.js","../../src/document-editor/implementation/dialogs/bookmark-dialog.js","../../src/document-editor/implementation/dialogs/table-of-contents-dialog.js","../../src/document-editor/implementation/dialogs/page-setup-dialog.js","../../src/document-editor/implementation/dialogs/paragraph-dialog.js","../../src/document-editor/implementation/dialogs/list-view-model.js","../../src/document-editor/implementation/dialogs/list-dialog.js","../../src/document-editor/implementation/dialogs/style-dialog.js","../../src/document-editor/implementation/dialogs/bullets-and-numbering-dialog.js","../../src/document-editor/implementation/dialogs/font-dialog.js","../../src/document-editor/implementation/dialogs/table-properties-dialog.js","../../src/document-editor/implementation/dialogs/borders-and-shading-dialog.js","../../src/document-editor/implementation/dialogs/table-options-dialog.js","../../src/document-editor/implementation/dialogs/cell-options-dialog.js","../../src/document-editor/implementation/dialogs/styles-dialog.js"],"sourcesContent":["import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Dictionary = /** @class */ (function () {\n    function Dictionary() {\n        this.keysInternal = [];\n        this.valuesInternal = [];\n        this.item = [];\n    }\n    Object.defineProperty(Dictionary.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.keysInternal.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Dictionary.prototype, \"keys\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.getItem();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Dictionary.prototype.getItem = function () {\n        this.item = [];\n        for (var i = 0; i < this.keysInternal.length; i++) {\n            this.item.push(this.keysInternal[i]);\n        }\n        return this.item;\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.add = function (key, value) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key or value is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        // if (index < 0 || index > this.keysInternal.length - 1) {\n        if (index < 0) {\n            this.keysInternal.push(key);\n            this.valuesInternal.push(value);\n        }\n        return 1;\n        // else {\n        //     throw new RangeError('An item with the same key has already been added.');\n        // }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.get = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            return this.valuesInternal[index];\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.set = function (key, value) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            this.valuesInternal[index] = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.remove = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            this.keysInternal.splice(index, 1);\n            this.valuesInternal.splice(index, 1);\n            return true;\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.containsKey = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.clear = function () {\n        this.keysInternal = [];\n        this.valuesInternal = [];\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.destroy = function () {\n        this.clear();\n        this.keysInternal = undefined;\n        this.valuesInternal = undefined;\n    };\n    return Dictionary;\n}());\nexport { Dictionary };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from './dictionary';\n/**\n * @private\n */\nvar WUniqueFormat = /** @class */ (function () {\n    function WUniqueFormat(type) {\n        this.referenceCount = 0;\n        this.uniqueFormatType = type;\n        this.propertiesHash = new Dictionary();\n    }\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isEqual = function (source, property, modifiedValue) {\n        var isEqual = false;\n        switch (this.uniqueFormatType) {\n            case 1:\n                isEqual = this.isBorderEqual(source, property, modifiedValue);\n                break;\n            case 2:\n                isEqual = this.isCharacterFormatEqual(source, property, modifiedValue);\n                break;\n            case 3:\n                isEqual = this.isParagraphFormatEqual(source, property, modifiedValue);\n                break;\n            case 4:\n                isEqual = this.isCellFormatEqual(source, property, modifiedValue);\n                break;\n            case 5:\n                isEqual = this.isShadingEqual(source, property, modifiedValue);\n                break;\n            case 6:\n                isEqual = this.isRowFormatEqual(source, property, modifiedValue);\n                break;\n            case 7:\n                isEqual = this.isListFormatEqual(source, property, modifiedValue);\n                break;\n            case 8:\n                isEqual = this.isTableFormatEqual(source, property, modifiedValue);\n                break;\n            case 9:\n                isEqual = this.isListLevelEqual(source, property, modifiedValue);\n                break;\n            case 10:\n                isEqual = this.isSectionFormatEqual(source, property, modifiedValue);\n                break;\n            default:\n                break;\n        }\n        return isEqual;\n    };\n    // tslint:disable-next-line:max-line-length\n    WUniqueFormat.prototype.isNotEqual = function (property, source, modifiedProperty, modifiedValue, uniqueFormatType) {\n        var targetValue = undefined;\n        var propertyType = WUniqueFormat.getPropertyType(uniqueFormatType, property);\n        if (this.propertiesHash.containsKey(propertyType)) {\n            targetValue = this.propertiesHash.get(propertyType);\n        }\n        var sourceValue = undefined;\n        if (property === modifiedProperty) {\n            sourceValue = modifiedValue;\n        }\n        else if (source.containsKey(propertyType)) {\n            sourceValue = source.get(propertyType);\n        }\n        // tslint:disable-next-line:max-line-length\n        if (!(targetValue === sourceValue || (!isNullOrUndefined(targetValue) && !isNullOrUndefined(sourceValue) && targetValue === sourceValue))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.getPropertyType = function (uniqueFormatType, property) {\n        var type = 0;\n        switch (uniqueFormatType) {\n            case 1:\n                type = this.getBorderPropertyType(property);\n                break;\n            case 2:\n                type = this.getCharacterFormatPropertyType(property);\n                break;\n            case 3:\n                type = this.getParaFormatPropertyType(property);\n                break;\n            case 4:\n                type = this.getCellFormatPropertyType(property);\n                break;\n            case 5:\n                type = this.getShadingPropertyType(property);\n                break;\n            case 6:\n                type = this.getRowFormatType(property);\n                break;\n            case 7:\n                type = this.getListFormatType(property);\n                break;\n            case 8:\n                type = this.getTableFormatType(property);\n                break;\n            case 9:\n                type = this.getListLevelType(property);\n                break;\n            case 10:\n                type = this.getSectionFormatType(property);\n                break;\n            default:\n                break;\n        }\n        return type;\n    };\n    WUniqueFormat.getRowFormatType = function (property) {\n        if (property === 'allowBreakAcrossPages') {\n            return 1;\n        }\n        if (property === 'isHeader') {\n            return 2;\n        }\n        if (property === 'height') {\n            return 3;\n        }\n        if (property === 'heightType') {\n            return 4;\n        }\n        if (property === 'gridBefore') {\n            return 5;\n        }\n        if (property === 'gridBeforeWidth') {\n            return 6;\n        }\n        if (property === 'gridBeforeWidthType') {\n            return 7;\n        }\n        if (property === 'gridAfter') {\n            return 8;\n        }\n        if (property === 'gridAfterWidth') {\n            return 9;\n        }\n        if (property === 'gridAfterWidthType') {\n            return 10;\n        }\n        return 0;\n    };\n    WUniqueFormat.getListFormatType = function (property) {\n        if (property === 'listId') {\n            return 1;\n        }\n        if (property === 'listLevelNumber') {\n            return 2;\n        }\n        return 0;\n    };\n    WUniqueFormat.getTableFormatType = function (property) {\n        if (property === 'leftMargin') {\n            return 1;\n        }\n        if (property === 'rightMargin') {\n            return 2;\n        }\n        if (property === 'topMargin') {\n            return 3;\n        }\n        if (property === 'bottomMargin') {\n            return 4;\n        }\n        if (property === 'cellSpacing') {\n            return 5;\n        }\n        if (property === 'leftIndent') {\n            return 6;\n        }\n        if (property === 'tableAlignment') {\n            return 7;\n        }\n        if (property === 'preferredWidth') {\n            return 8;\n        }\n        if (property === 'preferredWidthType') {\n            return 9;\n        }\n        return 0;\n    };\n    WUniqueFormat.getListLevelType = function (property) {\n        if (property === 'listLevelPattern') {\n            return 1;\n        }\n        if (property === 'startAt') {\n            return 2;\n        }\n        if (property === 'followCharacter') {\n            return 3;\n        }\n        if (property === 'numberFormat') {\n            return 4;\n        }\n        if (property === 'restartLevel') {\n            return 5;\n        }\n        return 0;\n    };\n    WUniqueFormat.getShadingPropertyType = function (property) {\n        if (property === 'backgroundColor') {\n            return 1;\n        }\n        if (property === 'foregroundColor') {\n            return 2;\n        }\n        if (property === 'textureStyle') {\n            return 3;\n        }\n        return 0;\n    };\n    WUniqueFormat.getCellFormatPropertyType = function (property) {\n        if (property === 'leftMargin') {\n            return 1;\n        }\n        if (property === 'rightMargin') {\n            return 2;\n        }\n        if (property === 'topMargin') {\n            return 3;\n        }\n        if (property === 'bottomMargin') {\n            return 4;\n        }\n        if (property === 'columnSpan') {\n            return 5;\n        }\n        if (property === 'rowSpan') {\n            return 6;\n        }\n        if (property === 'verticalAlignment') {\n            return 7;\n        }\n        if (property === 'preferredWidthType') {\n            return 8;\n        }\n        if (property === 'preferredWidth') {\n            return 9;\n        }\n        if (property === 'cellWidth') {\n            return 10;\n        }\n        return 0;\n    };\n    WUniqueFormat.getBorderPropertyType = function (property) {\n        if (property === 'color') {\n            return 1;\n        }\n        if (property === 'lineStyle') {\n            return 2;\n        }\n        if (property === 'lineWidth') {\n            return 3;\n        }\n        if (property === 'shadow') {\n            return 4;\n        }\n        if (property === 'space') {\n            return 5;\n        }\n        if (property === 'hasNoneStyle') {\n            return 6;\n        }\n        return 0;\n    };\n    WUniqueFormat.getCharacterFormatPropertyType = function (property) {\n        if (property === 'fontColor') {\n            return 1;\n        }\n        if (property === 'fontFamily') {\n            return 2;\n        }\n        if (property === 'fontSize') {\n            return 3;\n        }\n        if (property === 'bold') {\n            return 4;\n        }\n        if (property === 'italic') {\n            return 5;\n        }\n        if (property === 'underline') {\n            return 6;\n        }\n        if (property === 'strikethrough') {\n            return 7;\n        }\n        if (property === 'baselineAlignment') {\n            return 8;\n        }\n        if (property === 'highlightColor') {\n            return 9;\n        }\n        return 0;\n    };\n    WUniqueFormat.getParaFormatPropertyType = function (property) {\n        if (property === 'leftIndent') {\n            return 1;\n        }\n        if (property === 'rightIndent') {\n            return 2;\n        }\n        if (property === 'firstLineIndent') {\n            return 3;\n        }\n        if (property === 'textAlignment') {\n            return 4;\n        }\n        if (property === 'beforeSpacing') {\n            return 5;\n        }\n        if (property === 'afterSpacing') {\n            return 6;\n        }\n        if (property === 'lineSpacing') {\n            return 7;\n        }\n        if (property === 'lineSpacingType') {\n            return 8;\n        }\n        if (property === 'outlineLevel') {\n            return 9;\n        }\n        return 0;\n    };\n    WUniqueFormat.getSectionFormatType = function (property) {\n        if (property === 'headerDistance') {\n            return 1;\n        }\n        if (property === 'footerDistance') {\n            return 2;\n        }\n        if (property === 'differentFirstPage') {\n            return 3;\n        }\n        if (property === 'differentOddAndEvenPages') {\n            return 4;\n        }\n        if (property === 'pageWidth') {\n            return 5;\n        }\n        if (property === 'pageHeight') {\n            return 6;\n        }\n        if (property === 'leftMargin') {\n            return 7;\n        }\n        if (property === 'topMargin') {\n            return 8;\n        }\n        if (property === 'rightMargin') {\n            return 9;\n        }\n        if (property === 'bottomMargin') {\n            return 10;\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isBorderEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('color', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('lineStyle', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('lineWidth', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('shadow', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('space', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('hasNoneStyle', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isCharacterFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('fontColor', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontFamily', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontSize', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('bold', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('italic', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('underline', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('strikethrough', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('baselineAlignment', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('highlightColor', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        return true;\n    };\n    WUniqueFormat.prototype.isParagraphFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('rightIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('firstLineIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('textAlignment', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('beforeSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('afterSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('lineSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('lineSpacingType', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('outlineLevel', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isCellFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('columnSpan', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('rowSpan', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('verticalAlignment', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidthType', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidth', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('cellWidth', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isShadingEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('backgroundColor', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        if (this.isNotEqual('foregroundColor', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        if (this.isNotEqual('textureStyle', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isRowFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('allowBreakAcrossPages', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('isHeader', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('height', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('heightType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBefore', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBeforeWidth', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBeforeWidthType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfter', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfterWidth', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfterWidthType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isListFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('listId', source, modifiedProperty, modifiedValue, 7)) {\n            return false;\n        }\n        if (this.isNotEqual('listLevelNumber', source, modifiedProperty, modifiedValue, 7)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isTableFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('cellSpacing', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('leftIndent', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('tableAlignment', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidth', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidthType', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isListLevelEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('listLevelPattern', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('startAt', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('followCharacter', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('numberFormat', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('restartLevel', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isSectionFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('headerDistance', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('footerDistance', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('differentFirstPage', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('differentOddAndEvenPages', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('pageWidth', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('pageHeight', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.cloneItems = function (format, property, value, uniqueFormatType) {\n        var propertyType = WUniqueFormat.getPropertyType(uniqueFormatType, property);\n        var keys = format.propertiesHash.getItem();\n        for (var i = 0; i < keys.length; i++) {\n            if (keys[i] === propertyType) {\n                this.propertiesHash.add(propertyType, value);\n            }\n            else {\n                this.propertiesHash.add(keys[i], format.propertiesHash.get(keys[i]));\n            }\n        }\n        if (!format.propertiesHash.containsKey(propertyType)) {\n            this.propertiesHash.add(propertyType, value);\n        }\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.mergeProperties = function (format) {\n        var hash = format.cloneProperties();\n        var keys = this.propertiesHash.keys;\n        for (var i = 0; i < keys.length; i++) {\n            if (!hash.containsKey(keys[i])) {\n                hash.add(keys[i], this.propertiesHash.get(keys[i]));\n            }\n        }\n        return hash;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.cloneProperties = function () {\n        var hash = new Dictionary();\n        var keys = this.propertiesHash.keys;\n        for (var i = 0; i < keys.length; i++) {\n            hash.add(keys[i], this.propertiesHash.get(keys[i]));\n        }\n        return hash;\n    };\n    // public cloneItemsInternal(format: WUniqueFormat): void {\n    //     let keys: number[] = format.propertiesHash.getItem();\n    //     for (let i: number = 0; i < keys.length; i++) {\n    //         this.propertiesHash.add(keys[i], format.propertiesHash.get(keys[i]));\n    //     }\n    //     this.referenceCount = format.referenceCount;\n    // }\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.propertiesHash)) {\n            this.propertiesHash.destroy();\n        }\n        this.propertiesHash = undefined;\n        this.referenceCount = undefined;\n        this.uniqueFormatType = undefined;\n    };\n    return WUniqueFormat;\n}());\nexport { WUniqueFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WUniqueFormat } from './unique-format';\n/**\n * @private\n */\nvar WUniqueFormats = /** @class */ (function () {\n    function WUniqueFormats() {\n        this.items = [];\n    }\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.addUniqueFormat = function (format, type) {\n        var matchedFormat = undefined;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].isEqual(format, undefined, undefined)) {\n                matchedFormat = this.items[i];\n                break;\n            }\n        }\n        if (isNullOrUndefined(matchedFormat)) {\n            matchedFormat = new WUniqueFormat(type);\n            matchedFormat.propertiesHash = format;\n            matchedFormat.referenceCount = 1;\n            this.items.push(matchedFormat);\n        }\n        else {\n            matchedFormat.referenceCount++;\n        }\n        return matchedFormat;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.updateUniqueFormat = function (uniqueFormat, property, value) {\n        var matchedFormat = undefined;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].isEqual(uniqueFormat.propertiesHash, property, value)) {\n                matchedFormat = this.items[i];\n                break;\n            }\n        }\n        if (isNullOrUndefined(matchedFormat)) {\n            matchedFormat = new WUniqueFormat(uniqueFormat.uniqueFormatType);\n            matchedFormat.cloneItems(uniqueFormat, property, value, uniqueFormat.uniqueFormatType);\n            matchedFormat.referenceCount = 1;\n            this.items.push(matchedFormat);\n        }\n        else {\n            matchedFormat.referenceCount++;\n        }\n        this.remove(uniqueFormat);\n        uniqueFormat = undefined;\n        return matchedFormat;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.remove = function (uniqueFormat) {\n        uniqueFormat.referenceCount--;\n        if (uniqueFormat.referenceCount <= 0) {\n            this.items.splice(this.items.indexOf(uniqueFormat), 1);\n            uniqueFormat.destroy();\n            uniqueFormat = undefined;\n        }\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.clear = function () {\n        if (isNullOrUndefined(this.items)) {\n            for (var i = 0; i < this.items.length; i++) {\n                this.items[i].destroy();\n            }\n        }\n        this.items = [];\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.destroy = function () {\n        this.clear();\n        this.items = undefined;\n    };\n    return WUniqueFormats;\n}());\nexport { WUniqueFormats };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Event } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, L10n, setCulture, Browser } from '@syncfusion/ej2-base';\nimport { Save } from '@syncfusion/ej2-file-utils';\nimport { LayoutViewer, PageLayoutViewer, BulletsAndNumberingDialog } from './index';\nimport { Print } from './index';\nimport { BodyWidget, ParagraphWidget } from './index';\nimport { WSectionFormat, WParagraphFormat, WCharacterFormat } from './index';\nimport { SfdtReader } from './index';\nimport { Selection } from './index';\nimport { Editor, EditorHistory } from './index';\nimport { WStyles } from './index';\nimport { Search } from './index';\nimport { OptionsPane } from './index';\nimport { WordExport } from './index';\nimport { TextExport } from './index';\nimport { ContextMenu } from './index';\nimport { ImageResizer } from './index';\nimport { SfdtExport } from './index';\nimport { HyperlinkDialog, TableDialog, BookmarkDialog, StylesDialog, TableOfContentsDialog } from './index';\nimport { PageSetupDialog, ParagraphDialog, ListDialog, StyleDialog, FontDialog } from './index';\nimport { TablePropertiesDialog, BordersAndShadingDialog, CellOptionsDialog, TableOptionsDialog } from './index';\n/**\n * The Document editor component is used to draft, save or print rich text contents as page by page.\n */\nvar DocumentEditor = /** @class */ (function (_super) {\n    __extends(DocumentEditor, _super);\n    /**\n     * Initialize the constructor of DocumentEditor\n     */\n    function DocumentEditor(options, element) {\n        var _this = _super.call(this, options, element) || this;\n        //Internal Variable\n        _this.enableHeaderFooterIn = false;\n        /**\n         * @private\n         */\n        _this.isShiftingEnabled = false;\n        /**\n         * @private\n         */\n        _this.isLayoutEnabled = true;\n        /**\n         * @private\n         */\n        _this.isPastingContent = false;\n        /**\n         * @private\n         */\n        _this.parser = undefined;\n        _this.disableHistoryIn = false;\n        /**\n         * @private\n         */\n        _this.findResultsList = undefined;\n        /**\n         * Gets or sets the name of the document.\n         */\n        _this.documentName = '';\n        /**\n         * @private\n         */\n        _this.tablePropertiesDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.bordersAndShadingDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.cellOptionsDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.tableOptionsDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.paragraphDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.imageResizerModule = undefined;\n        /**\n         * Gets or Sets a value indicating whether holding Ctrl key is required to follow hyperlink on click. The default value is true.\n         */\n        _this.useCtrlClickToFollowHyperlink = true;\n        /**\n         * Gets or sets the page outline color.\n         */\n        _this.pageOutline = '#000000';\n        /**\n         * Gets or sets a value indicating whether to enable cursor in document editor on read only state or not. The default value is false.\n         */\n        _this.enableCursorOnReadOnly = false;\n        /**\n         * Gets or sets a value indicating whether local paste needs to be enabled or not.\n         */\n        _this.enableLocalPaste = false;\n        /**\n         * @private\n         */\n        _this.defaultLocale = {\n            'Table': 'Table',\n            'Row': 'Row',\n            'Cell': 'Cell',\n            'Ok': 'Ok',\n            'Cancel': 'Cancel',\n            'Size': 'Size',\n            'Preferred Width': 'Preferred width',\n            'Points': 'Points',\n            'Percent': 'Percent',\n            'Measure in': 'Measure in',\n            'Alignment': 'Alignment',\n            'Left': 'Left',\n            'Center': 'Center',\n            'Right': 'Right',\n            'Justify': 'Justify',\n            'Indent from left': 'Indent from left',\n            'Borders and Shading': 'Borders and Shading',\n            'Options': 'Options',\n            'Specify height': 'Specify height',\n            'At least': 'At least',\n            'Exactly': 'Exactly',\n            'Row height is': 'Row height is',\n            'Allow row to break across pages': 'Allow row to break across pages',\n            'Repeat as header row at the top of each page': 'Repeat as header row at the top of each page',\n            'Vertical alignment': 'Vertical alignment',\n            'Top': 'Top',\n            'Bottom': 'Bottom',\n            'Default cell margins': 'Default cell margins',\n            'Default cell spacing': 'Default cell spacing',\n            'Allow spacing between cells': 'Allow spacing between cells',\n            'Cell margins': 'Cell margins',\n            'Same as the whole table': 'Same as the whole table',\n            'Borders': 'Borders',\n            'None': 'None',\n            'Single': 'Single',\n            'Dot': 'Dot',\n            'DashSmallGap': 'DashSmallGap',\n            'DashLargeGap': 'DashLargeGap',\n            'DashDot': 'DashDot',\n            'DashDotDot': 'DashDotDot',\n            'Double': 'Double',\n            'Triple': 'Triple',\n            'ThinThickSmallGap': 'ThinThickSmallGap',\n            'ThickThinSmallGap': 'ThickThinSmallGap',\n            'ThinThickThinSmallGap': 'ThinThickThinSmallGap',\n            'ThinThickMediumGap': 'ThinThickMediumGap',\n            'ThickThinMediumGap': 'ThickThinMediumGap',\n            'ThinThickThinMediumGap': 'ThinThickThinMediumGap',\n            'ThinThickLargeGap': 'ThinThickLargeGap',\n            'ThickThinLargeGap': 'ThickThinLargeGap',\n            'ThinThickThinLargeGap': 'ThinThickThinLargeGap',\n            'SingleWavy': 'SingleWavy',\n            'DoubleWavy': 'DoubleWavy',\n            'DashDotStroked': 'DashDotStroked',\n            'Emboss3D': 'Emboss3D',\n            'Engrave3D': 'Engrave3D',\n            'Outset': 'Outset',\n            'Inset': 'Inset',\n            'Thick': 'Thick',\n            'Style': 'Style',\n            'Width': 'Width',\n            'Height': 'Height',\n            'Letter': 'Letter',\n            'Tabloid': 'Tabloid',\n            'Legal': 'Legal',\n            'Statement': 'Statement',\n            'Executive': 'Executive',\n            'A3': 'A3',\n            'A4': 'A4',\n            'A5': 'A5',\n            'B4': 'B4',\n            'B5': 'B5',\n            'Custom Size': 'Custom size',\n            'Different odd and even': 'Different odd and even',\n            'Different first page': 'Different first page',\n            'From edge': 'From edge',\n            'Header': 'Header',\n            'Footer': 'Footer',\n            'Margin': 'Margins',\n            'Paper': 'Paper',\n            'Layout': 'Layout',\n            'Orientation': 'Orientation',\n            'Landscape': 'Landscape',\n            'Portrait': 'Portrait',\n            'Table Of Contents': 'Table Of Contents',\n            'Show page numbers': 'Show page numbers',\n            'Right align page numbers': 'Right align page numbers',\n            'Nothing': 'Nothing',\n            'Tab leader': 'Tab leader',\n            'Show levels': 'Show levels',\n            'Use hyperlinks instead of page numbers': 'Use hyperlinks instead of page numbers',\n            'Build table of contents from': 'Build table of contents from',\n            'Styles': 'Styles',\n            'Available styles': 'Available styles',\n            'TOC level': 'TOC level',\n            'Heading': 'Heading',\n            'List Paragraph': 'List Paragraph',\n            'Normal': 'Normal',\n            'Outline levels': 'Outline levels',\n            'Table entry fields': 'Table entry fields',\n            'Modify': 'Modify',\n            'Color': 'Color',\n            'Setting': 'Setting',\n            'Box': 'Box',\n            'All': 'All',\n            'Custom': 'Custom',\n            'Preview': 'Preview',\n            'Shading': 'Shading',\n            'Fill': 'Fill',\n            'Apply To': 'Apply to',\n            'Table Properties': 'Table Properties',\n            'Cell Options': 'Cell Options',\n            'Table Options': 'Table Options',\n            'Insert Table': 'Insert Table',\n            'Number of columns': 'Number of columns',\n            'Number of rows': 'Number of rows',\n            'Text to display': 'Text to display',\n            'Address': 'Address',\n            'Insert Hyperlink': 'Insert Hyperlink',\n            'Edit Hyperlink': 'Edit Hyperlink',\n            'Insert': 'Insert',\n            'General': 'General',\n            'Indentation': 'Indentation',\n            'Before text': 'Before text',\n            'Special': 'Special',\n            'First line': 'First line',\n            'Hanging': 'Hanging',\n            'After text': 'After text',\n            'By': 'By',\n            'Before': 'Before',\n            'Line Spacing': 'Line spacing',\n            'After': 'After',\n            'At': 'At',\n            'Multiple': 'Multiple',\n            'Spacing': 'Spacing',\n            'Define new Multilevel list': 'Define new Multilevel list',\n            'List level': 'List level',\n            'Choose level to modify': 'Choose level to modify',\n            'Level': 'Level',\n            'Number format': 'Number format',\n            'Number style for this level': 'Number style for this level',\n            'Enter formatting for number': 'Enter formatting for number',\n            'Start at': 'Start at',\n            'Restart list after': 'Restart list after',\n            'Position': 'Position',\n            'Text indent at': 'Text indent at',\n            'Aligned at': 'Aligned at',\n            'Follow number with': 'Follow number with',\n            'Tab character': 'Tab character',\n            'Space': 'Space',\n            'Arabic': 'Arabic',\n            'UpRoman': 'UpRoman',\n            'LowRoman': 'LowRoman',\n            'UpLetter': 'UpLetter',\n            'LowLetter': 'LowLetter',\n            'Number': 'Number',\n            'Leading zero': 'Leading zero',\n            'Bullet': 'Bullet',\n            'Ordinal': 'Ordinal',\n            'Ordinal Text': 'Ordinal Text',\n            'For East': 'For East',\n            'No Restart': 'No Restart',\n            'Font': 'Font',\n            'Font style': 'Font style',\n            'Underline style': 'Underline style',\n            'Font color': 'Font color',\n            'Effects': 'Effects',\n            'Strikethrough': 'Strikethrough',\n            'Superscript': 'Superscript',\n            'Subscript': 'Subscript',\n            'Double strikethrough': 'Double strikethrough',\n            'Regular': 'Regular',\n            'Bold': 'Bold',\n            'Italic': 'Italic',\n            'Cut': 'Cut',\n            'Copy': 'Copy',\n            'Paste': 'Paste',\n            'Hyperlink': 'Hyperlink',\n            'Open Hyperlink': 'Open Hyperlink',\n            'Copy Hyperlink': 'Copy Hyperlink',\n            'Remove Hyperlink': 'Remove Hyperlink',\n            'Paragraph': 'Paragraph',\n            'Merge Cells': 'Merge Cells',\n            'Insert Above': 'Insert Above',\n            'Insert Below': 'Insert Below',\n            'Insert Left': 'Insert Left',\n            'Insert Right': 'Insert Right',\n            'Delete': 'Delete',\n            'Delete Table': 'Delete Table',\n            'Delete Row': 'Delete Row',\n            'Delete Column': 'Delete Column',\n            'File Name': 'File Name',\n            'Format Type': 'Format Type',\n            'Save': 'Save',\n            'Navigation': 'Navigation',\n            'Results': 'Results',\n            'Replace': 'Replace',\n            'Replace All': 'Replace All',\n            'We replaced all': 'We replaced all',\n            'Find': 'Find',\n            'No matches': 'No matches',\n            'All Done': 'All Done',\n            'Result': 'Result',\n            'of': 'of',\n            'instances': 'instances',\n            'with': 'with',\n            'Click to follow link': 'Click to follow link',\n            'Continue Numbering': 'Continue Numbering',\n            'Bookmark name': 'Bookmark name',\n            'Close': 'Close',\n            'Restart At': 'Restart At',\n            'Properties': 'Properties',\n            'Name': 'Name',\n            'Style type': 'Style type',\n            'Style based on': 'Style based on',\n            'Style for following paragraph': 'Style for following paragraph',\n            'Formatting': 'Formatting',\n            'Numbering and Bullets': 'Numbering and Bullets',\n            'Numbering': 'Numbering',\n            'Update Field': 'Update Field',\n            'Edit Field': 'Edit Field',\n            'Bookmark': 'Bookmark',\n            'Page Setup': 'Page Setup',\n            'No bookmarks found': 'No bookmarks found',\n            'Number format tooltip information': 'Single-level number format: </br>[PREFIX]%[LEVELNUMBER][SUFFIX]</br>'\n                + 'For example, \"Chapter %1.\" will display numbering like</br>Chapter 1. Item</br>Chapter 2. Item</br>…'\n                + '</br>Chapter N. Item</br>'\n                + '</br>Multilevel number format:</br>[PREFIX]%[LEVELNUMBER][SUFFIX]+[PREFIX]%[LEVELNUMBER][SUFFIX]'\n                + '</br>For example, \"%1.%2.\" will display numbering like</br>1.1. Item</br>1.2. Item</br>…</br>1.N. Item',\n            'Format': 'Format',\n            'Create New Style': 'Create New Style',\n            'Modify Style': 'Modify Style',\n            'New': 'New',\n            'Bullets': 'Bullets',\n            'Use bookmarks': 'Use bookmarks',\n            'Table of Contents': 'Table of Contents'\n        };\n        _this.viewer = new PageLayoutViewer(_this);\n        _this.parser = new SfdtReader(_this.viewer);\n        return _this;\n    }\n    DocumentEditor_1 = DocumentEditor;\n    Object.defineProperty(DocumentEditor.prototype, \"enableHeaderAndFooter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.enableHeaderFooterIn;\n        },\n        set: function (value) {\n            this.enableHeaderFooterIn = value;\n            this.viewer.updateScrollBars();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"pageCount\", {\n        /**\n         * Gets the total number of pages.\n         */\n        get: function () {\n            if (!this.isDocumentLoaded || isNullOrUndefined(this.viewer)) {\n                return 1;\n            }\n            return this.viewer.pages.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"selection\", {\n        /**\n         *  Gets the selection object of the document editor.\n         * @returns Selection\n         * @default undefined\n         */\n        get: function () {\n            return this.selectionModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"editor\", {\n        /**\n         *  Gets the editor object of the document editor.\n         * @returns Editor\n         * @default undefined\n         */\n        get: function () {\n            return this.editorModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"editorHistory\", {\n        /**\n         * Gets the editor history object of the document editor.\n         * @returns EditorHistory\n         */\n        get: function () {\n            return this.editorHistoryModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"search\", {\n        /**\n         * Gets the search object of the document editor.\n         * @returns { Search }\n         */\n        get: function () {\n            return this.searchModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"contextMenu\", {\n        /**\n         * Gets the context menu object of the document editor.\n         * @returns ContextMenu\n         */\n        get: function () {\n            return this.contextMenuModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"containerId\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.element.id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"isDocumentLoaded\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isDocumentLoadedIn;\n        },\n        set: function (value) {\n            this.isDocumentLoadedIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"enableHistoryMode\", {\n        /**\n         * Determines whether history needs to be enabled or not.\n         * @default - false\n         * @private\n         */\n        get: function () {\n            return this.enableEditorHistory && !isNullOrUndefined(this.editorHistoryModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"documentStart\", {\n        /**\n         * Gets the start text position in the document.\n         * @default undefined\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.selectionModule)) {\n                return this.selection.getDocumentStart();\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"documentEnd\", {\n        /**\n         * Gets the end text position in the document.\n         * @default undefined\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.selectionModule)) {\n                return this.selection.getDocumentEnd();\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"isReadOnlyMode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isReadOnly || isNullOrUndefined(this.editorModule) || isNullOrUndefined(this.selectionModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"enableImageResizerMode\", {\n        /**\n         * Specifies to enable image resizer option\n         * default - false\n         * @private\n         */\n        get: function () {\n            return this.enableImageResizer && !isNullOrUndefined(this.imageResizerModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    DocumentEditor.prototype.preRender = function () {\n        this.findResultsList = [];\n        //pre render section\n    };\n    DocumentEditor.prototype.render = function () {\n        this.viewer.initializeComponents();\n        this.openBlank();\n        if (!isNullOrUndefined(this.element)) {\n            var container = this.element;\n            container.style.minHeight = '200px';\n            container.style.minWidth = '200px';\n        }\n    };\n    /**\n     * Get component name\n     * @private\n     */\n    DocumentEditor.prototype.getModuleName = function () {\n        return 'DocumentEditor';\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @private\n     */\n    DocumentEditor.prototype.onPropertyChanged = function (model, oldProp) {\n        for (var _i = 0, _a = Object.keys(model); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'zoomFactor':\n                    if (this.viewer) {\n                        this.viewer.zoomFactor = model.zoomFactor;\n                    }\n                    break;\n                case 'locale':\n                    this.localizeDialogs();\n                    break;\n                case 'isReadOnly':\n                    if (!isNullOrUndefined(this.optionsPaneModule) && this.optionsPaneModule.isOptionsPaneShow) {\n                        this.optionsPaneModule.showHideOptionsPane(false);\n                    }\n                    break;\n            }\n        }\n    };\n    DocumentEditor.prototype.localizeDialogs = function () {\n        if (this.locale !== '') {\n            var l10n = new L10n('documenteditor', this.defaultLocale);\n            l10n.setLocale(this.locale);\n            setCulture(this.locale);\n            if (this.optionsPaneModule) {\n                this.optionsPaneModule.initOptionsPane(l10n);\n            }\n            if (this.paragraphDialogModule) {\n                this.paragraphDialogModule.initParagraphDialog(l10n);\n            }\n            if (this.pageSetupDialogModule) {\n                this.pageSetupDialogModule.initPageSetupDialog(l10n);\n            }\n            if (this.fontDialogModule) {\n                this.fontDialogModule.initFontDialog(l10n);\n            }\n            if (this.hyperlinkDialogModule) {\n                this.hyperlinkDialogModule.initHyperlinkDialog(l10n);\n            }\n            if (this.contextMenuModule) {\n                this.contextMenuModule.initContextMenu(l10n);\n            }\n            if (this.listDialogModule) {\n                this.listDialogModule.initListDialog(l10n);\n            }\n            if (this.tablePropertiesDialogModule) {\n                this.tablePropertiesDialogModule.initTablePropertyDialog(l10n);\n            }\n            if (this.bordersAndShadingDialogModule) {\n                this.bordersAndShadingDialogModule.initBordersAndShadingsDialog(l10n);\n            }\n            if (this.cellOptionsDialogModule) {\n                this.cellOptionsDialogModule.initCellMarginsDialog(l10n);\n            }\n            if (this.tableOptionsDialogModule) {\n                this.tableOptionsDialogModule.initTableOptionsDialog(l10n);\n            }\n            if (this.tableDialogModule) {\n                this.tableDialogModule.initTableDialog(l10n);\n            }\n            if (this.styleDialogModule) {\n                this.styleDialogModule.initStyleDialog(l10n);\n            }\n            if (this.tableOfContentsDialogModule) {\n                this.tableOfContentsDialogModule.initTableOfContentDialog(l10n);\n            }\n        }\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @private\n     */\n    DocumentEditor.prototype.getPersistData = function () {\n        return 'documenteditor';\n    };\n    DocumentEditor.prototype.clearPreservedCollectionsInViewer = function () {\n        if (this.viewer instanceof LayoutViewer) {\n            this.viewer.clearDocumentItems();\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.getDocumentEditorElement = function () {\n        return this.element;\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireContentChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('contentChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireDocumentChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('documentChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireSelectionChange = function () {\n        if (!this.viewer.isCompositionStart && Browser.isDevice && this.editorModule) {\n            this.editorModule.predictText();\n        }\n        var eventArgs = { source: this };\n        this.trigger('selectionChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireZoomFactorChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('zoomFactorChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireViewChange = function () {\n        if (this.viewer && this.viewer.pages.length > 0) {\n            if (this.viewer.visiblePages.length > 0) {\n                var pages = this.viewer.visiblePages;\n                var eventArgs = {\n                    startPage: pages[0].index + 1,\n                    endPage: pages[pages.length - 1].index + 1,\n                    source: this\n                };\n                this.trigger('viewChange', eventArgs);\n            }\n        }\n    };\n    /**\n     * Shows the Paragraph dialog\n     * @private\n     */\n    DocumentEditor.prototype.showParagraphDialog = function (paragraphFormat) {\n        if (this.paragraphDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.paragraphDialogModule.show(paragraphFormat);\n        }\n    };\n    /**\n     * Shows the margin dialog\n     * @private\n     */\n    DocumentEditor.prototype.showPageSetupDialog = function () {\n        if (this.pageSetupDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.pageSetupDialogModule.show();\n        }\n    };\n    /**\n     * Shows the font dialog\n     * @private\n     */\n    DocumentEditor.prototype.showFontDialog = function (characterFormat) {\n        if (this.fontDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.fontDialogModule.showFontDialog(characterFormat);\n        }\n    };\n    /**\n     * Shows the cell option dialog\n     * @private\n     */\n    DocumentEditor.prototype.showCellOptionsDialog = function () {\n        if (this.cellOptionsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.cellOptionsDialogModule.show();\n        }\n    };\n    /**\n     * Shows the table options dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showTableOptionsDialog = function () {\n        if (this.tableOptionsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableOptionsDialogModule.show();\n        }\n    };\n    /**\n     * Shows insert table dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTableDialog = function () {\n        if (this.tableDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableDialogModule.show();\n        }\n    };\n    /**\n     * Shows the table of content dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTableOfContentsDialog = function () {\n        if (this.tableOfContentsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableOfContentsDialogModule.show();\n        }\n    };\n    /* tslint:enable:no-any */\n    /**\n     * Shows the style dialog\n     * @private\n     */\n    DocumentEditor.prototype.showStyleDialog = function () {\n        if (this.styleDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.styleDialogModule.show();\n        }\n    };\n    /**\n     * Shows the hyperlink dialog\n     * @private\n     */\n    DocumentEditor.prototype.showHyperlinkDialog = function () {\n        if (this.hyperlinkDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.hyperlinkDialogModule.show();\n        }\n    };\n    /**\n     * Shows the bookmark dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showBookmarkDialog = function () {\n        if (this.bookmarkDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.bookmarkDialogModule.show();\n        }\n    };\n    /**\n     * Shows the styles dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showStylesDialog = function () {\n        if (this.stylesDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.stylesDialogModule.show();\n        }\n    };\n    /**\n     * Shows the List dialog\n     * @private\n     */\n    DocumentEditor.prototype.showListDialog = function () {\n        if (this.listDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.listDialogModule.showListDialog();\n        }\n    };\n    /**\n     * Shows the table properties dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTablePropertiesDialog = function () {\n        if (this.tablePropertiesDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tablePropertiesDialogModule.show();\n        }\n    };\n    /**\n     * Shows the borders and shading dialog\n     * @private\n     */\n    DocumentEditor.prototype.showBordersAndShadingDialog = function () {\n        if (this.bordersAndShadingDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.bordersAndShadingDialogModule.show();\n        }\n    };\n    //tslint:disable: max-func-body-length\n    DocumentEditor.prototype.requiredModules = function () {\n        var modules = [];\n        if (this.enablePrint) {\n            modules.push({\n                member: 'Print', args: []\n            });\n        }\n        if (this.enableSfdtExport || this.enableWordExport || this.enableTextExport || this.enableSelection || this.enableEditor) {\n            modules.push({\n                member: 'SfdtExport', args: [this.viewer]\n            });\n        }\n        if (this.enableWordExport) {\n            modules.push({\n                member: 'WordExport', args: []\n            });\n        }\n        if (this.enableTextExport) {\n            modules.push({\n                member: 'TextExport', args: []\n            });\n        }\n        if (this.enableSelection || this.enableSearch || this.enableEditor) {\n            modules.push({\n                member: 'Selection', args: [this]\n            });\n            if (this.enableContextMenu) {\n                modules.push({\n                    member: 'ContextMenu', args: [this.viewer]\n                });\n            }\n        }\n        if (this.enableSearch) {\n            modules.push({\n                member: 'Search', args: [this]\n            });\n            if (this.enableOptionsPane) {\n                modules.push({\n                    member: 'OptionsPane', args: [this.viewer]\n                });\n            }\n        }\n        if (this.enableEditor) {\n            modules.push({\n                member: 'Editor', args: [this.viewer]\n            });\n            if (this.enableImageResizer) {\n                modules.push({\n                    member: 'ImageResizer', args: [this, this.viewer]\n                });\n            }\n            if (this.enableEditorHistory) {\n                modules.push({\n                    member: 'EditorHistory', args: [this]\n                });\n            }\n            if (this.enableHyperlinkDialog) {\n                modules.push({\n                    member: 'HyperlinkDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableDialog) {\n                modules.push({\n                    member: 'TableDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableBookmarkDialog) {\n                modules.push({\n                    member: 'BookmarkDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableOfContentsDialog) {\n                modules.push({\n                    member: 'TableOfContentsDialog', args: [this.viewer]\n                });\n            }\n            if (this.enablePageSetupDialog) {\n                modules.push({\n                    member: 'PageSetupDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableStyleDialog) {\n                modules.push({\n                    member: 'StylesDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'StyleDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'BulletsAndNumberingDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableListDialog) {\n                modules.push({\n                    member: 'ListDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableParagraphDialog) {\n                modules.push({\n                    member: 'ParagraphDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableFontDialog) {\n                modules.push({\n                    member: 'FontDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTablePropertiesDialog) {\n                modules.push({\n                    member: 'TablePropertiesDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'CellOptionsDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableBordersAndShadingDialog) {\n                modules.push({\n                    member: 'BordersAndShadingDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableOptionsDialog) {\n                modules.push({\n                    member: 'TableOptionsDialog', args: [this.viewer]\n                });\n            }\n        }\n        return modules;\n    };\n    // Public Implementation Starts\n    /**\n     * Opens the given Sfdt text.\n     * @param {string} sfdtText.\n     */\n    DocumentEditor.prototype.open = function (sfdtText) {\n        if (!isNullOrUndefined(this.viewer)) {\n            this.clearPreservedCollectionsInViewer();\n            this.viewer.lists = [];\n            this.viewer.abstractLists = [];\n            this.viewer.styles = new WStyles();\n            if (!isNullOrUndefined(sfdtText) && this.viewer) {\n                this.viewer.onDocumentChanged(this.parser.convertJsonToDocument(sfdtText));\n                if (this.editorModule) {\n                    this.editorModule.intializeDefaultStyles();\n                }\n            }\n        }\n    };\n    /**\n     * Scrolls view to start of the given page number if exists.\n     * @param  {number} pageNumber.\n     * @returns void\n     */\n    DocumentEditor.prototype.scrollToPage = function (pageNumber) {\n        if (isNullOrUndefined(this.viewer) || pageNumber < 1 || pageNumber > this.viewer.pages.length) {\n            return false;\n        }\n        this.viewer.scrollToPage(pageNumber - 1);\n        return true;\n    };\n    /**\n     * Enables all the modules.\n     * @returns void\n     */\n    DocumentEditor.prototype.enableAllModules = function () {\n        this.enablePrint = this.enableSfdtExport = this.enableWordExport = this.enableTextExport\n            = this.enableSelection = this.enableContextMenu = this.enableSearch = this.enableOptionsPane\n                = this.enableEditor = this.enableImageResizer = this.enableEditorHistory\n                    = this.enableHyperlinkDialog = this.enableTableDialog = this.enableBookmarkDialog\n                        = this.enableTableOfContentsDialog = this.enablePageSetupDialog = this.enableStyleDialog\n                            = this.enableListDialog = this.enableParagraphDialog = this.enableFontDialog\n                                = this.enableTablePropertiesDialog = this.enableBordersAndShadingDialog\n                                    = this.enableTableOptionsDialog = true;\n        // tslint:disable-next-line:max-line-length\n        DocumentEditor_1.Inject(Print, SfdtExport, WordExport, TextExport, Selection, Search, Editor, ImageResizer, EditorHistory, ContextMenu, OptionsPane, HyperlinkDialog, TableDialog, BookmarkDialog, TableOfContentsDialog, PageSetupDialog, StyleDialog, ListDialog, ParagraphDialog, BulletsAndNumberingDialog, FontDialog, TablePropertiesDialog, BordersAndShadingDialog, TableOptionsDialog, CellOptionsDialog, StylesDialog);\n    };\n    /**\n     * Resizes the component and its sub elements based on given size or container size.\n     * @param width\n     * @param height\n     */\n    DocumentEditor.prototype.resize = function (width, height) {\n        if (this.element) {\n            if (!isNullOrUndefined(width) && width > 200) {\n                this.element.style.width = width + 'px';\n            }\n            if (!isNullOrUndefined(height) && height > 200) {\n                this.element.style.height = height + 'px';\n            }\n            if (this.viewer) {\n                this.viewer.updateViewerSize();\n            }\n        }\n    };\n    /**\n     * Shifts the focus to the document.\n     */\n    DocumentEditor.prototype.focusIn = function () {\n        if (this.viewer) {\n            this.viewer.updateFocus();\n        }\n    };\n    /**\n     * Fits the page based on given fit type.\n     * @param  {PageFitType} pageFitType? - Default value of ‘pageFitType’ parameter is 'None'\n     * @returns void\n     */\n    DocumentEditor.prototype.fitPage = function (pageFitType) {\n        if (isNullOrUndefined(pageFitType)) {\n            pageFitType = 'None';\n        }\n        if (this.viewer) {\n            this.viewer.pageFitType = pageFitType;\n        }\n    };\n    /**\n     * Prints the document.\n     * @param  {Window} printWindow? - Default value of 'printWindow' parameter is undefined.\n     */\n    DocumentEditor.prototype.print = function (printWindow) {\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation.');\n        }\n        if (this.printModule) {\n            this.printModule.print(this.viewer, printWindow);\n        }\n        else {\n            throw new Error('Invalid operation. Print is not enabled.');\n        }\n    };\n    /**\n     * Serialize the data to JSON string.\n     */\n    DocumentEditor.prototype.serialize = function () {\n        var json = '';\n        if (this.enableSfdtExport && this.sfdtExportModule instanceof SfdtExport) {\n            json = this.sfdtExportModule.serialize();\n        }\n        else {\n            throw new Error('Invalid operation. Sfdt export is not enabled.');\n        }\n        return json;\n    };\n    /**\n     * Saves the document.\n     * @param {string} fileName\n     * @param {FormatType} formatType\n     */\n    DocumentEditor.prototype.save = function (fileName, formatType) {\n        fileName = fileName || 'Untitled';\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation.');\n        }\n        if (formatType === 'Docx' && this.wordExportModule) {\n            if (this.wordExportModule) {\n                this.wordExportModule.save(this.viewer, fileName);\n            }\n        }\n        else if (formatType === 'Txt' && this.textExportModule) {\n            this.textExportModule.save(this.viewer, fileName);\n        }\n        else if (formatType === 'Sfdt' && this.enableSfdtExport && this.sfdtExportModule) {\n            var jsonString = this.serialize();\n            var blob = new Blob([jsonString], {\n                type: 'application/json'\n            });\n            Save.save(fileName + '.sfdt', blob);\n        }\n        else {\n            throw new Error('Invalid operation. Specified export is not enabled.');\n        }\n    };\n    /**\n     * Saves the document as blob.\n     * @param {FormatType} formatType\n     */\n    DocumentEditor.prototype.saveAsBlob = function (formatType) {\n        var _this = this;\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation');\n        }\n        return new Promise(function (resolve, reject) {\n            if (formatType === 'Docx' && _this.wordExportModule) {\n                resolve(_this.wordExportModule.saveAsBlob(_this.viewer));\n            }\n            else if (formatType === 'Txt' && _this.textExportModule) {\n                resolve(_this.textExportModule.saveAsBlob(_this.viewer));\n            }\n            else if (formatType === 'Sfdt' && _this.enableSfdtExport && _this.sfdtExportModule) {\n                resolve(_this.sfdtExportModule.saveAsBlob(_this.viewer));\n            }\n        });\n    };\n    /**\n     * Opens a blank document.\n     */\n    DocumentEditor.prototype.openBlank = function () {\n        var section = new BodyWidget();\n        section.index = 0;\n        section.sectionFormat = new WSectionFormat(section);\n        var paragraph = new ParagraphWidget();\n        paragraph.index = 0;\n        paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n        paragraph.characterFormat = new WCharacterFormat(paragraph);\n        section.childWidgets.push(paragraph);\n        paragraph.containerWidget = section;\n        var sections = [];\n        sections.push(section);\n        // tslint:disable-next-line:max-line-length\n        var hfs = this.parser.parseHeaderFooter({ header: {}, footer: {}, evenHeader: {}, evenFooter: {}, firstPageHeader: {}, firstPageFooter: {} }, undefined);\n        if (this.viewer) {\n            this.clearPreservedCollectionsInViewer();\n            this.viewer.headersFooters.push(hfs);\n            this.viewer.onDocumentChanged(sections);\n            if (this.editorModule) {\n                this.editorModule.intializeDefaultStyles();\n                var style = this.viewer.styles.findByName('Normal');\n                paragraph.paragraphFormat.baseStyle = style;\n                paragraph.paragraphFormat.listFormat.baseStyle = style;\n            }\n        }\n    };\n    /**\n     * Gets the style names based on given style type.\n     * @param styleType\n     */\n    DocumentEditor.prototype.getStyleNames = function (styleType) {\n        if (this.viewer) {\n            return this.viewer.styles.getStyleNames(styleType);\n        }\n        return [];\n    };\n    /**\n     * Gets the style objects on given style type.\n     * @param styleType\n     */\n    DocumentEditor.prototype.getStyles = function (styleType) {\n        if (this.viewer) {\n            return this.viewer.styles.getStyles(styleType);\n        }\n        return [];\n    };\n    /**\n     * Shows the dialog.\n     * @param {DialogType} dialogType\n     * @returns void\n     */\n    DocumentEditor.prototype.showDialog = function (dialogType) {\n        switch (dialogType) {\n            case 'Hyperlink':\n                this.showHyperlinkDialog();\n                break;\n            case 'Table':\n                this.showTableDialog();\n                break;\n            case 'Bookmark':\n                this.showBookmarkDialog();\n                break;\n            case 'TableOfContents':\n                this.showTableOfContentsDialog();\n                break;\n            case 'PageSetup':\n                this.showPageSetupDialog();\n                break;\n            case 'List':\n                this.showListDialog();\n                break;\n            case 'Styles':\n                this.showStylesDialog();\n                break;\n            case 'Style':\n                this.showStyleDialog();\n                break;\n            case 'Paragraph':\n                this.showParagraphDialog();\n                break;\n            case 'Font':\n                this.showFontDialog();\n                break;\n            case 'TableProperties':\n                this.showTablePropertiesDialog();\n                break;\n            case 'BordersAndShading':\n                this.showBordersAndShadingDialog();\n                break;\n            case 'TableOptions':\n                this.showTableOptionsDialog();\n                break;\n        }\n    };\n    /**\n     * Shows the options pane.\n     */\n    DocumentEditor.prototype.showOptionsPane = function () {\n        if (!isNullOrUndefined(this.optionsPaneModule) && !isNullOrUndefined(this.viewer)) {\n            this.optionsPaneModule.showHideOptionsPane(true);\n        }\n    };\n    /**\n     * Destroys all managed resources used by this object.\n     */\n    DocumentEditor.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.destroyDependentModules();\n        if (!isNullOrUndefined(this.viewer)) {\n            this.viewer.destroy();\n        }\n        this.viewer = undefined;\n        if (!isNullOrUndefined(this.element)) {\n            this.element.classList.remove('e-documenteditor');\n            this.element.innerHTML = '';\n        }\n        this.element = undefined;\n        this.findResultsList = [];\n        this.findResultsList = undefined;\n    };\n    DocumentEditor.prototype.destroyDependentModules = function () {\n        if (this.printModule) {\n            this.printModule.destroy();\n            this.printModule = undefined;\n        }\n        if (this.sfdtExportModule) {\n            this.sfdtExportModule.destroy();\n            this.sfdtExportModule = undefined;\n        }\n        if (this.optionsPaneModule) {\n            this.optionsPaneModule.destroy();\n            this.optionsPaneModule = undefined;\n        }\n        if (!isNullOrUndefined(this.hyperlinkDialogModule)) {\n            this.hyperlinkDialogModule.destroy();\n            this.hyperlinkDialogModule = undefined;\n        }\n        if (this.searchModule) {\n            this.searchModule.destroy();\n            this.searchModule = undefined;\n        }\n        if (this.contextMenuModule) {\n            this.contextMenuModule.destroy();\n            this.contextMenuModule = undefined;\n        }\n        if (this.editorModule) {\n            this.editorModule.destroy();\n            this.editorModule = undefined;\n        }\n        if (this.selectionModule) {\n            this.selectionModule.destroy();\n            this.selectionModule = undefined;\n        }\n        if (this.editorHistoryModule) {\n            this.editorHistoryModule.destroy();\n            this.editorHistoryModule = undefined;\n        }\n        if (!isNullOrUndefined(this.paragraphDialogModule)) {\n            this.paragraphDialogModule.destroy();\n            this.paragraphDialogModule = undefined;\n        }\n        if (this.pageSetupDialogModule) {\n            this.pageSetupDialogModule.destroy();\n            this.pageSetupDialogModule = undefined;\n        }\n        if (this.fontDialogModule) {\n            this.fontDialogModule.destroy();\n            this.fontDialogModule = undefined;\n        }\n        if (this.listDialogModule) {\n            this.listDialogModule.destroy();\n            this.listDialogModule = undefined;\n        }\n        if (this.imageResizerModule) {\n            this.imageResizerModule.destroy();\n            this.imageResizerModule = undefined;\n        }\n        if (this.tablePropertiesDialogModule) {\n            this.tablePropertiesDialogModule.destroy();\n            this.tablePropertiesDialogModule = undefined;\n        }\n        if (this.bordersAndShadingDialogModule) {\n            this.bordersAndShadingDialogModule.destroy();\n            this.bordersAndShadingDialogModule = undefined;\n        }\n        if (this.cellOptionsDialogModule) {\n            this.cellOptionsDialogModule.destroy();\n            this.cellOptionsDialogModule = undefined;\n        }\n        if (this.tableOptionsDialogModule) {\n            this.tableOptionsDialogModule.destroy();\n            this.tableOptionsDialogModule = undefined;\n        }\n        if (this.tableDialogModule) {\n            this.tableDialogModule.destroy();\n            this.tableDialogModule = undefined;\n        }\n        if (this.styleDialogModule) {\n            this.styleDialogModule = undefined;\n        }\n        if (this.bookmarkDialogModule) {\n            this.bookmarkDialogModule.destroy();\n            this.bookmarkDialogModule = undefined;\n        }\n        if (this.styleDialogModule) {\n            this.styleDialogModule.destroy();\n            this.styleDialogModule = undefined;\n        }\n        if (this.textExportModule) {\n            this.textExportModule.destroy();\n            this.textExportModule = undefined;\n        }\n        if (this.wordExportModule) {\n            this.wordExportModule.destroy();\n            this.wordExportModule = undefined;\n        }\n        if (this.tableOfContentsDialogModule) {\n            this.tableOfContentsDialogModule.destroy();\n            this.tableOfContentsDialogModule = undefined;\n        }\n    };\n    var DocumentEditor_1;\n    __decorate([\n        Property(1)\n    ], DocumentEditor.prototype, \"zoomFactor\", void 0);\n    __decorate([\n        Property(true)\n    ], DocumentEditor.prototype, \"isReadOnly\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enablePrint\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSelection\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableEditor\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableEditorHistory\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSfdtExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableWordExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTextExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableOptionsPane\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableContextMenu\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableHyperlinkDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableBookmarkDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableOfContentsDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSearch\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableParagraphDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableListDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTablePropertiesDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableBordersAndShadingDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enablePageSetupDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableStyleDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableFontDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableOptionsDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableImageResizer\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"documentChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"viewChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"zoomFactorChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"selectionChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"requestNavigate\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"contentChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"keyDown\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"searchResultsChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"destroyed\", void 0);\n    DocumentEditor = DocumentEditor_1 = __decorate([\n        NotifyPropertyChanges\n    ], DocumentEditor);\n    return DocumentEditor;\n}(Component));\nexport { DocumentEditor };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Print class\n */\nvar Print = /** @class */ (function () {\n    function Print() {\n    }\n    /**\n     * Gets module name.\n     */\n    Print.prototype.getModuleName = function () {\n        return 'Print';\n    };\n    /**\n     * Prints the current viewer\n     * @param viewer\n     * @param printWindow\n     * @private\n     */\n    Print.prototype.print = function (viewer, printWindow) {\n        this.printWindow(viewer, navigator.userAgent, printWindow);\n    };\n    /**\n     * Opens print window and displays current page to print.\n     * @private\n     */\n    Print.prototype.printWindow = function (viewer, browserUserAgent, printWindow) {\n        var height = this.getPageHeight(viewer.pages);\n        var width = this.getPageWidth(viewer.pages);\n        var printElement = document.createElement('div');\n        printElement.style.width = '100%';\n        printElement.style.height = '100%';\n        printElement.style.overflow = 'scroll';\n        // Rendering canvas to print\n        this.generatePrintContent(viewer, printElement);\n        if (isNullOrUndefined(printWindow)) {\n            printWindow = window.open('', 'print', 'height=452,width=1024,tabbar=no');\n        }\n        if ((browserUserAgent.indexOf('Chrome') !== -1) || (browserUserAgent.indexOf('Firefox')) !== -1) {\n            // Chrome and Firefox\n            printWindow.document.write('<!DOCTYPE html>');\n            // tslint:disable-next-line:max-line-length\n            printWindow.document.write('<html moznomarginboxes mozdisallowselectionprint><head><style>html, body { height: 100 %; } img { height: 100 %; width: 100 %; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:' + width.toString() + 'px ' + height.toString() + 'px; }@media print{ body { margin: 0cm; }</style></head> <body><center>');\n        }\n        else {\n            // Internet Explorer and Edge\n            // tslint:disable-next-line:max-line-length\n            printWindow.document.write('<html><head><style>@page{margin:0;size:' + width.toString() + 'px ' + height.toString() + 'px;}</style></head><body><center>');\n        }\n        // tslint:disable-next-line:max-line-length\n        printWindow.document.write(printElement.innerHTML + '</center><script> (function() { window.ready = true; })(); </script></body></html>');\n        printElement = undefined;\n        printWindow.document.close();\n        printWindow.focus();\n        var interval = setInterval(function () {\n            if (printWindow.ready) {\n                printWindow.print();\n                printWindow.close();\n                clearInterval(interval);\n            }\n        }, 500);\n    };\n    /**\n     * Generates print content.\n     * @private\n     */\n    Print.prototype.generatePrintContent = function (viewer, element) {\n        // Rendering canvas to print\n        var htmlString = '';\n        for (var i = 0; i < viewer.pages.length; i++) {\n            var page = viewer.pages[i];\n            var pageHeight = page.boundingRectangle.height;\n            var pageWidth = page.boundingRectangle.width;\n            viewer.render.isPrinting = true;\n            viewer.render.renderWidgets(page, 0, 0, 0, 0);\n            var canvasURL = viewer.render.pageCanvas.toDataURL();\n            viewer.render.isPrinting = false;\n            // tslint:disable-next-line:max-line-length\n            htmlString += '<div><img src=' + canvasURL + ' style=\"margin:0px;display:block;width: ' + pageWidth.toString() + 'px; height:' + pageHeight.toString() + 'px; \"/></div><br/>';\n        }\n        element.innerHTML = htmlString;\n    };\n    /**\n     * Gets page width.\n     * @param pages\n     * @private\n     */\n    Print.prototype.getPageWidth = function (pages) {\n        var width = 0;\n        for (var i = 0; i < pages.length; i++) {\n            if (width < pages[i].boundingRectangle.width) {\n                width = pages[i].boundingRectangle.width;\n            }\n        }\n        return width;\n    };\n    /**\n     *  Gets page height.\n     * @private\n     */\n    Print.prototype.getPageHeight = function (pages) {\n        var height = 0;\n        for (var i = 0; i < pages.length; i++) {\n            if (height < pages[i].boundingRectangle.height) {\n                height = pages[i].boundingRectangle.height;\n            }\n        }\n        return height;\n    };\n    /**\n     * @private\n     */\n    Print.prototype.destroy = function () {\n        return;\n    };\n    return Print;\n}());\nexport { Print };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\n/**\n * @private\n */\nvar WSectionFormat = /** @class */ (function () {\n    function WSectionFormat(node) {\n        this.uniqueSectionFormat = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WSectionFormat.prototype, \"headerDistance\", {\n        get: function () {\n            return this.getPropertyValue('headerDistance');\n        },\n        set: function (value) {\n            this.setPropertyValue('headerDistance', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"footerDistance\", {\n        get: function () {\n            return this.getPropertyValue('footerDistance');\n        },\n        set: function (value) {\n            this.setPropertyValue('footerDistance', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"differentFirstPage\", {\n        get: function () {\n            return this.getPropertyValue('differentFirstPage');\n        },\n        set: function (value) {\n            this.setPropertyValue('differentFirstPage', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"differentOddAndEvenPages\", {\n        get: function () {\n            return this.getPropertyValue('differentOddAndEvenPages');\n        },\n        set: function (value) {\n            this.setPropertyValue('differentOddAndEvenPages', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"pageHeight\", {\n        get: function () {\n            return this.getPropertyValue('pageHeight');\n        },\n        set: function (value) {\n            this.setPropertyValue('pageHeight', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"pageWidth\", {\n        get: function () {\n            return this.getPropertyValue('pageWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('pageWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WSectionFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueSectionFormat)) {\n            WSectionFormat.uniqueSectionFormats.remove(this.uniqueSectionFormat);\n        }\n        this.uniqueSectionFormat = undefined;\n    };\n    WSectionFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueSectionFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueSectionFormat.uniqueFormatType, property);\n            return this.uniqueSectionFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WSectionFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'headerDistance':\n                value = 36;\n                break;\n            case 'footerDistance':\n                value = 36;\n                break;\n            case 'differentFirstPage':\n                value = false;\n                break;\n            case 'differentOddAndEvenPages':\n                value = false;\n                break;\n            case 'pageWidth':\n                value = 612;\n                break;\n            case 'pageHeight':\n                value = 792;\n                break;\n            case 'leftMargin':\n                value = 72;\n                break;\n            case 'topMargin':\n                value = 72;\n                break;\n            case 'rightMargin':\n                value = 72;\n                break;\n            case 'bottomMargin':\n                value = 72;\n                break;\n        }\n        return value;\n    };\n    WSectionFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WSectionFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueSectionFormat) && this.uniqueSectionFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueSectionFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WSectionFormat.getPropertyDefaultValue(property);\n    };\n    WSectionFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WSectionFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueSectionFormat)) {\n            this.initializeUniqueSectionFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueSectionFormat.uniqueFormatType, property);\n            if (this.uniqueSectionFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueSectionFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat, property, value);\n        }\n    };\n    WSectionFormat.prototype.initializeUniqueSectionFormat = function (property, propValue) {\n        var uniqueSectionFormatTemp = new Dictionary();\n        this.addUniqueSectionFormat('headerDistance', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('footerDistance', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('differentFirstPage', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('differentOddAndEvenPages', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('pageWidth', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('pageHeight', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('leftMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('topMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('rightMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('bottomMargin', property, propValue, uniqueSectionFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.addUniqueFormat(uniqueSectionFormatTemp, WSectionFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WSectionFormat.prototype.addUniqueSectionFormat = function (property, modifiedProperty, propValue, uniqueSectionFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WSectionFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueSectionFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueSectionFormatTemp.add(propertyType, WSectionFormat.getPropertyDefaultValue(property));\n        }\n    };\n    WSectionFormat.prototype.copyFormat = function (format, history) {\n        if (history && (history.isUndoing || history.isRedoing)) {\n            this.uniqueSectionFormat = format.uniqueSectionFormat;\n        }\n        else {\n            if (!isNullOrUndefined(format)) {\n                if (!isNullOrUndefined(format.uniqueSectionFormat) && format.uniqueSectionFormat.propertiesHash) {\n                    this.updateUniqueSectionFormat(format);\n                }\n            }\n        }\n    };\n    WSectionFormat.prototype.updateUniqueSectionFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueSectionFormat) {\n            hash = this.uniqueSectionFormat.mergeProperties(format.uniqueSectionFormat);\n            if (this.uniqueSectionFormat.referenceCount === 0) {\n                WSectionFormat.uniqueSectionFormats.remove(this.uniqueSectionFormat);\n                this.uniqueSectionFormat = undefined;\n            }\n        }\n        this.uniqueSectionFormat = new WUniqueFormat(WSectionFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueSectionFormat.mergeProperties(format.uniqueSectionFormat);\n        }\n        this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.addUniqueFormat(hash, WSectionFormat.uniqueFormatType);\n    };\n    WSectionFormat.prototype.cloneFormat = function () {\n        var format = new WSectionFormat();\n        format.uniqueSectionFormat = this.uniqueSectionFormat;\n        return format;\n    };\n    WSectionFormat.clear = function () {\n        this.uniqueSectionFormats.clear();\n    };\n    WSectionFormat.uniqueSectionFormats = new WUniqueFormats();\n    WSectionFormat.uniqueFormatType = 10;\n    return WSectionFormat;\n}());\nexport { WSectionFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WLevelOverride = /** @class */ (function () {\n    function WLevelOverride() {\n    }\n    WLevelOverride.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.overrideListLevel)) {\n            this.overrideListLevel.destroy();\n        }\n        this.levelNumber = undefined;\n        this.startAt = undefined;\n        this.overrideListLevel = undefined;\n    };\n    return WLevelOverride;\n}());\nexport { WLevelOverride };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WLevelOverride } from './level-override';\n/**\n * @private\n */\nvar WList = /** @class */ (function () {\n    function WList() {\n        this.listId = -1;\n        this.sourceListId = -1;\n        this.abstractListId = -1;\n        this.abstractList = undefined;\n        this.levelOverrides = [];\n    }\n    WList.prototype.getListLevel = function (levelNumber) {\n        var listLevel = undefined;\n        var levelOverride = this.getLevelOverride(levelNumber);\n        if (!isNullOrUndefined(levelOverride) && !isNullOrUndefined(levelOverride.overrideListLevel)) {\n            listLevel = levelOverride.overrideListLevel;\n        }\n        else {\n            listLevel = this.abstractList.levels[levelNumber];\n        }\n        return listLevel;\n    };\n    WList.prototype.getLevelOverride = function (levelNumber) {\n        for (var i = 0; i < this.levelOverrides.length; i++) {\n            if (this.levelOverrides[i] instanceof WLevelOverride) {\n                var levelOverride = this.levelOverrides[i];\n                if (levelOverride.levelNumber === levelNumber) {\n                    return levelOverride;\n                }\n            }\n        }\n        return undefined;\n    };\n    WList.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.levelOverrides)) {\n            this.levelOverrides = [];\n        }\n        this.abstractListId = undefined;\n        this.listId = undefined;\n        this.sourceListId = undefined;\n        this.levelOverrides = undefined;\n    };\n    WList.prototype.mergeList = function (list) {\n        if (!isNullOrUndefined(this.abstractListId) && this.abstractListId !== -1) {\n            this.abstractListId = list.abstractListId;\n        }\n        if (!isNullOrUndefined(this.listId) && this.listId !== -1) {\n            this.listId = list.listId;\n        }\n        if (!isNullOrUndefined(this.sourceListId) && this.sourceListId !== -1) {\n            this.sourceListId = list.sourceListId;\n        }\n        if (!isNullOrUndefined(this.levelOverrides) && this.levelOverrides.length !== 0) {\n            this.levelOverrides = list.levelOverrides;\n        }\n    };\n    return WList;\n}());\nexport { WList };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WParagraphStyle } from './style';\nimport { WList } from '../list/list';\n/**\n * @private\n */\nvar WListFormat = /** @class */ (function () {\n    function WListFormat(node) {\n        this.uniqueListFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseStyle = undefined;\n        this.list = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WListFormat.prototype, \"listId\", {\n        get: function () {\n            return this.getPropertyValue('listId');\n        },\n        set: function (listId) {\n            this.setPropertyValue('listId', listId);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListFormat.prototype, \"listLevelNumber\", {\n        get: function () {\n            return this.getPropertyValue('listLevelNumber');\n        },\n        set: function (value) {\n            this.setPropertyValue('listLevelNumber', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListFormat.prototype, \"listLevel\", {\n        get: function () {\n            var list = undefined;\n            if (!isNullOrUndefined(this.list)) {\n                list = this.list;\n            }\n            else {\n                /* tslint:disable-next-line:no-any */\n                var baseListStyle = this.baseStyle;\n                while (!isNullOrUndefined(baseListStyle)) {\n                    if (baseListStyle.paragraphFormat.listFormat.list) {\n                        list = baseListStyle.paragraphFormat.listFormat.list;\n                        break;\n                    }\n                    else {\n                        baseListStyle = baseListStyle.basedOn;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(list)) {\n                return list.getListLevel(this.listLevelNumber);\n            }\n            else {\n                return undefined;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WListFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            if (this.baseStyle instanceof WParagraphStyle) {\n                /* tslint:disable-next-line:no-any */\n                var baseStyle = this.baseStyle;\n                while (!isNullOrUndefined(baseStyle)) {\n                    if (baseStyle.paragraphFormat.listFormat.hasValue(property)) {\n                        break;\n                    }\n                    else {\n                        baseStyle = baseStyle.basedOn;\n                    }\n                }\n                if (!isNullOrUndefined(baseStyle)) {\n                    var propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n                    return baseStyle.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(propertyType);\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueListFormat) && this.uniqueListFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueListFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WListFormat.getPropertyDefaultValue(property);\n    };\n    WListFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WListFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueListFormat)) {\n            this.initializeUniqueListFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListFormat.uniqueFormatType, property);\n            if (this.uniqueListFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueListFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueListFormat = WListFormat.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat, property, value);\n        }\n    };\n    WListFormat.prototype.initializeUniqueListFormat = function (property, propValue) {\n        var uniqueListFormatTemp = new Dictionary();\n        this.addUniqueListFormat('listId', property, propValue, uniqueListFormatTemp);\n        this.addUniqueListFormat('listLevelNumber', property, propValue, uniqueListFormatTemp);\n        this.uniqueListFormat = WListFormat.uniqueListFormats.addUniqueFormat(uniqueListFormatTemp, WListFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WListFormat.prototype.addUniqueListFormat = function (property, modifiedProperty, propValue, uniqueListFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueListFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WListFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'listId':\n                value = -1;\n                break;\n            case 'listLevelNumber':\n                value = 0;\n                break;\n        }\n        return value;\n    };\n    WListFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueListFormat)) {\n                this.listId = format.listId;\n                this.listLevelNumber = format.listLevelNumber;\n            }\n            if (!isNullOrUndefined(format.baseStyle)) {\n                this.baseStyle = format.baseStyle;\n            }\n            if (!isNullOrUndefined(format.list)) {\n                this.list = format.list;\n            }\n        }\n    };\n    WListFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueListFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListFormat.uniqueFormatType, property);\n            return this.uniqueListFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WListFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.uniqueListFormat) && this.uniqueListFormat.referenceCount === 0) {\n            WListFormat.uniqueListFormats.remove(this.uniqueListFormat);\n        }\n        this.uniqueListFormat = undefined;\n        this.list = undefined;\n    };\n    WListFormat.prototype.destroy = function () {\n        this.clearFormat();\n    };\n    WListFormat.clear = function () {\n        this.uniqueListFormats.clear();\n    };\n    WListFormat.prototype.ApplyStyle = function (baseStyle) {\n        this.baseStyle = baseStyle;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WListFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WListFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('listId'))) {\n            this.listId = format.getValue('listId');\n        }\n        if (isNullOrUndefined(this.getValue('listLevelNumber'))) {\n            this.listLevelNumber = format.getValue('listLevelNumber');\n        }\n        if (!isNullOrUndefined(format.list)) {\n            if (isNullOrUndefined(this.list)) {\n                this.list = new WList();\n            }\n            this.list.mergeList(format.list);\n        }\n    };\n    WListFormat.uniqueListFormats = new WUniqueFormats();\n    WListFormat.uniqueFormatType = 7;\n    return WListFormat;\n}());\nexport { WListFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WListFormat } from './list-format';\nimport { WParagraphStyle } from './style';\n/**\n * @private\n */\nvar WTabStop = /** @class */ (function () {\n    function WTabStop() {\n    }\n    Object.defineProperty(WTabStop.prototype, \"position\", {\n        get: function () {\n            return this.positionIn;\n        },\n        set: function (value) {\n            this.positionIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"deletePosition\", {\n        get: function () {\n            return this.deletePositionIn;\n        },\n        set: function (value) {\n            this.deletePositionIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"tabJustification\", {\n        get: function () {\n            return this.justification;\n        },\n        set: function (value) {\n            this.justification = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"tabLeader\", {\n        get: function () {\n            return this.leader;\n        },\n        set: function (value) {\n            this.leader = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WTabStop.prototype.destroy = function () {\n        this.position = undefined;\n        this.deletePosition = undefined;\n        this.tabJustification = undefined;\n        this.leader = undefined;\n    };\n    return WTabStop;\n}());\nexport { WTabStop };\n/**\n * @private\n */\nvar WParagraphFormat = /** @class */ (function () {\n    function WParagraphFormat(node) {\n        this.uniqueParagraphFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseStyle = undefined;\n        this.tabs = undefined;\n        this.ownerBase = node;\n        this.listFormat = new WListFormat(this);\n        this.tabs = [];\n    }\n    WParagraphFormat.prototype.getUpdatedTabs = function () {\n        var inTabs = [];\n        if (!isNullOrUndefined(this.baseStyle)) {\n            /* tslint:disable-next-line:no-any */\n            var baseStyle = this.baseStyle;\n            var tabStops = new Dictionary();\n            while (!isNullOrUndefined(baseStyle)) {\n                for (var _i = 0, _a = baseStyle.paragraphFormat.tabs; _i < _a.length; _i++) {\n                    var tab = _a[_i];\n                    if (!tabStops.containsKey(tab.position)) {\n                        tabStops.add(tab.position, tab);\n                    }\n                }\n                baseStyle = baseStyle.basedOn;\n            }\n            for (var _b = 0, _c = tabStops.keys; _b < _c.length; _b++) {\n                var key = _c[_b];\n                if (!this.hasTabStop(key)) {\n                    inTabs.push(tabStops.get(key));\n                }\n            }\n            inTabs = inTabs.concat(this.tabs.filter(function (a) { return (a.position !== 0 && a.deletePosition === 0); }));\n            inTabs = inTabs.sort(function (a, b) { return a.position - b.position; });\n        }\n        return inTabs;\n    };\n    WParagraphFormat.prototype.hasTabStop = function (position) {\n        for (var i = 0; i < this.tabs.length; i++) {\n            if (this.tabs[i].deletePosition === position) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Object.defineProperty(WParagraphFormat.prototype, \"leftIndent\", {\n        get: function () {\n            return this.getPropertyValue('leftIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"rightIndent\", {\n        get: function () {\n            return this.getPropertyValue('rightIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"firstLineIndent\", {\n        get: function () {\n            return this.getPropertyValue('firstLineIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('firstLineIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"beforeSpacing\", {\n        get: function () {\n            return this.getPropertyValue('beforeSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('beforeSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"afterSpacing\", {\n        get: function () {\n            return this.getPropertyValue('afterSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('afterSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"lineSpacing\", {\n        get: function () {\n            return this.getPropertyValue('lineSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"lineSpacingType\", {\n        get: function () {\n            return this.getPropertyValue('lineSpacingType');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineSpacingType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"textAlignment\", {\n        get: function () {\n            return this.getPropertyValue('textAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('textAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"outlineLevel\", {\n        get: function () {\n            return this.getPropertyValue('outlineLevel');\n        },\n        set: function (value) {\n            this.setPropertyValue('outlineLevel', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WParagraphFormat.prototype.getListFormatParagraphFormat = function (property) {\n        if (this.listFormat.listId > -1 && this.listFormat.listLevelNumber > -1) {\n            var level = this.listFormat.listLevel;\n            var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(level) && !isNullOrUndefined(level.paragraphFormat.uniqueParagraphFormat) && level.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n                return level.paragraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    WParagraphFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            var ifListFormat = this.getListFormatParagraphFormat(property);\n            if (!isNullOrUndefined(ifListFormat)) {\n                return ifListFormat;\n            }\n            else {\n                if (this.baseStyle instanceof WParagraphStyle) {\n                    /* tslint:disable-next-line:no-any */\n                    var baseStyle = this.baseStyle;\n                    while (!isNullOrUndefined(baseStyle)) {\n                        if (baseStyle.paragraphFormat.hasValue(property)) {\n                            break;\n                        }\n                        else {\n                            baseStyle = baseStyle.basedOn;\n                        }\n                    }\n                    if (!isNullOrUndefined(baseStyle)) {\n                        var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n                        return baseStyle.paragraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n                    }\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueParagraphFormat) && this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueParagraphFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return this.getDefaultValue(property);\n    };\n    WParagraphFormat.prototype.getDefaultValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n        var docParagraphFormat = this.documentParagraphFormat();\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(docParagraphFormat) && !isNullOrUndefined(docParagraphFormat.uniqueParagraphFormat) && docParagraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n            return docParagraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n        }\n        else {\n            return WParagraphFormat.getPropertyDefaultValue(property);\n        }\n    };\n    WParagraphFormat.prototype.documentParagraphFormat = function () {\n        var docParagraphFormat;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.bodyWidget)) {\n                docParagraphFormat = this.ownerBase.bodyWidget.page.viewer.paragraphFormat;\n            }\n        }\n        return docParagraphFormat;\n    };\n    WParagraphFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WParagraphFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueParagraphFormat)) {\n            this.initializeUniqueParagraphFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType, property);\n            if (this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueParagraphFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat, property, value);\n        }\n    };\n    WParagraphFormat.prototype.initializeUniqueParagraphFormat = function (property, propValue) {\n        var uniqueParaFormatTemp = new Dictionary();\n        this.addUniqueParaFormat('leftIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('rightIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('firstLineIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('textAlignment', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('beforeSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('afterSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('lineSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('lineSpacingType', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('outlineLevel', property, propValue, uniqueParaFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.addUniqueFormat(uniqueParaFormatTemp, WParagraphFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WParagraphFormat.prototype.addUniqueParaFormat = function (property, modifiedProperty, propValue, uniqueParaFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueParaFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WParagraphFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'leftIndent':\n                value = 0;\n                break;\n            case 'rightIndent':\n                value = 0;\n                break;\n            case 'firstLineIndent':\n                value = 0;\n                break;\n            case 'textAlignment':\n                value = 'Left';\n                break;\n            case 'beforeSpacing':\n                value = 0;\n                break;\n            case 'afterSpacing':\n                value = 0;\n                break;\n            case 'lineSpacing':\n                value = 1;\n                break;\n            case 'lineSpacingType':\n                value = 'Multiple';\n                break;\n            case 'styleName':\n                value = 'Normal';\n                break;\n            case 'outlineLevel':\n                value = 'BodyText';\n                break;\n        }\n        return value;\n    };\n    WParagraphFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.listFormat)) {\n            this.listFormat.clearFormat();\n        }\n        if (!isNullOrUndefined(this.uniqueParagraphFormat) && this.uniqueParagraphFormat.referenceCount === 0) {\n            WParagraphFormat.uniqueParagraphFormats.remove(this.uniqueParagraphFormat);\n        }\n        this.uniqueParagraphFormat = undefined;\n        this.baseStyle = undefined;\n    };\n    WParagraphFormat.prototype.destroy = function () {\n        this.clearFormat();\n        if (!isNullOrUndefined(this.listFormat)) {\n            this.listFormat.destroy();\n        }\n        this.listFormat = undefined;\n        if (this.tabs !== undefined) {\n            for (var i = 0; i < this.tabs.length; i++) {\n                this.tabs[i].destroy();\n            }\n            this.tabs = undefined;\n        }\n    };\n    WParagraphFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueParagraphFormat)) {\n                this.updateUniqueParagraphFormat(format);\n            }\n            if (!isNullOrUndefined(format.listFormat)) {\n                this.listFormat.copyFormat(format.listFormat);\n            }\n            if (!isNullOrUndefined(format.baseStyle)) {\n                this.baseStyle = format.baseStyle;\n            }\n            if (!isNullOrUndefined(format.tabs)) {\n                for (var i = 0; i < format.tabs.length; i++) {\n                    this.tabs[i] = format.tabs[i];\n                }\n            }\n        }\n    };\n    WParagraphFormat.prototype.updateUniqueParagraphFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueParagraphFormat) {\n            hash = this.uniqueParagraphFormat.mergeProperties(format.uniqueParagraphFormat);\n            if (this.uniqueParagraphFormat.referenceCount === 0) {\n                WParagraphFormat.uniqueParagraphFormats.remove(this.uniqueParagraphFormat);\n                this.uniqueParagraphFormat = undefined;\n            }\n        }\n        this.uniqueParagraphFormat = new WUniqueFormat(WParagraphFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueParagraphFormat.mergeProperties(format.uniqueParagraphFormat);\n        }\n        this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.addUniqueFormat(hash, WParagraphFormat.uniqueFormatType);\n    };\n    WParagraphFormat.prototype.cloneFormat = function () {\n        var format = new WParagraphFormat(undefined);\n        format.uniqueParagraphFormat = this.uniqueParagraphFormat;\n        format.baseStyle = this.baseStyle;\n        if (isNullOrUndefined(this.listFormat)) {\n            format.listFormat = undefined;\n        }\n        else {\n            format.listFormat = new WListFormat();\n            format.listFormat.listId = this.listFormat.listId;\n            format.listFormat.listLevelNumber = this.listFormat.listLevelNumber;\n        }\n        return format;\n    };\n    WParagraphFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueParagraphFormat) && !isNullOrUndefined(this.uniqueParagraphFormat.propertiesHash)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType, property);\n            return this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WParagraphFormat.clear = function () {\n        this.uniqueParagraphFormats.clear();\n    };\n    WParagraphFormat.prototype.ApplyStyle = function (baseStyle) {\n        this.baseStyle = baseStyle;\n        this.listFormat.ApplyStyle(this.baseStyle);\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WParagraphFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WParagraphFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('leftIndent'))) {\n            this.leftIndent = format.getValue('leftIndent');\n        }\n        if (isNullOrUndefined(this.getValue('rightIndent'))) {\n            this.rightIndent = format.getValue('rightIndent');\n        }\n        if (isNullOrUndefined(this.getValue('firstLineIndent'))) {\n            this.firstLineIndent = format.getValue('firstLineIndent');\n        }\n        if (isNullOrUndefined(this.getValue('beforeSpacing'))) {\n            this.beforeSpacing = format.getValue('beforeSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('afterSpacing'))) {\n            this.afterSpacing = format.getValue('afterSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('lineSpacing'))) {\n            this.lineSpacing = format.getValue('lineSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('lineSpacingType'))) {\n            this.lineSpacingType = format.getValue('lineSpacingType');\n        }\n        if (isNullOrUndefined(this.getValue('textAlignment'))) {\n            this.textAlignment = format.getValue('textAlignment');\n        }\n        if (isNullOrUndefined(this.getValue('outlineLevel'))) {\n            this.outlineLevel = format.getValue('outlineLevel');\n        }\n        if (isNullOrUndefined(this.listFormat)) {\n            this.listFormat.mergeFormat(format.listFormat);\n        }\n    };\n    WParagraphFormat.uniqueParagraphFormats = new WUniqueFormats();\n    WParagraphFormat.uniqueFormatType = 3;\n    return WParagraphFormat;\n}());\nexport { WParagraphFormat };\n","import { ParagraphWidget } from '../viewer/page';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WParagraphStyle } from './style';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WCharacterFormat = /** @class */ (function () {\n    function WCharacterFormat(node) {\n        this.uniqueCharacterFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseCharStyle = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WCharacterFormat.prototype, \"bold\", {\n        get: function () {\n            return this.getPropertyValue('bold');\n        },\n        set: function (value) {\n            this.setPropertyValue('bold', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"italic\", {\n        get: function () {\n            return this.getPropertyValue('italic');\n        },\n        set: function (value) {\n            this.setPropertyValue('italic', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontSize\", {\n        get: function () {\n            return this.getPropertyValue('fontSize');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontSize', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontFamily\", {\n        get: function () {\n            return this.getPropertyValue('fontFamily');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontFamily', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"underline\", {\n        get: function () {\n            return this.getPropertyValue('underline');\n        },\n        set: function (value) {\n            this.setPropertyValue('underline', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"strikethrough\", {\n        get: function () {\n            return this.getPropertyValue('strikethrough');\n        },\n        set: function (value) {\n            this.setPropertyValue('strikethrough', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"baselineAlignment\", {\n        get: function () {\n            return this.getPropertyValue('baselineAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('baselineAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"highlightColor\", {\n        get: function () {\n            return this.getPropertyValue('highlightColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('highlightColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontColor\", {\n        get: function () {\n            return this.getPropertyValue('fontColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WCharacterFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            var charStyleValue = this.checkCharacterStyle(property);\n            if (!isNullOrUndefined(charStyleValue)) {\n                return charStyleValue;\n            }\n            else {\n                var baseStyleValue = this.checkBaseStyle(property);\n                if (!isNullOrUndefined(baseStyleValue)) {\n                    return baseStyleValue;\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueCharacterFormat) && this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueCharacterFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return this.getDefaultValue(property);\n    };\n    WCharacterFormat.prototype.getDefaultValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n        var docCharacterFormat = this.documentCharacterFormat();\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(docCharacterFormat) && !isNullOrUndefined(docCharacterFormat.uniqueCharacterFormat) && docCharacterFormat.uniqueCharacterFormat.propertiesHash.containsKey(propertyType)) {\n            return docCharacterFormat.uniqueCharacterFormat.propertiesHash.get(propertyType);\n        }\n        else {\n            return WCharacterFormat.getPropertyDefaultValue(property);\n        }\n    };\n    WCharacterFormat.prototype.documentCharacterFormat = function () {\n        var docCharacterFormat;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.paragraph)) {\n                docCharacterFormat = this.ownerBase.paragraph.bodyWidget.page.viewer.characterFormat;\n            }\n            else {\n                if (!isNullOrUndefined(this.ownerBase.bodyWidget)) {\n                    docCharacterFormat = this.ownerBase.bodyWidget.page.viewer.characterFormat;\n                }\n            }\n        }\n        return docCharacterFormat;\n    };\n    WCharacterFormat.prototype.checkBaseStyle = function (property) {\n        /* tslint:disable-next-line:no-any */\n        var baseStyle;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.paragraph)) {\n                baseStyle = this.ownerBase.paragraph.paragraphFormat.baseStyle;\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if ((this.ownerBase instanceof ParagraphWidget) && !isNullOrUndefined(this.ownerBase.paragraphFormat)) {\n                    baseStyle = this.ownerBase.paragraphFormat.baseStyle;\n                }\n                else {\n                    if (!isNullOrUndefined(this.ownerBase instanceof WParagraphStyle)) {\n                        baseStyle = this.ownerBase.basedOn;\n                    }\n                }\n            }\n        }\n        while (!isNullOrUndefined(baseStyle)) {\n            if (baseStyle.characterFormat.hasValue(property)) {\n                break;\n            }\n            else {\n                baseStyle = baseStyle.basedOn;\n            }\n        }\n        if (!isNullOrUndefined(baseStyle)) {\n            var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n            return baseStyle.characterFormat.uniqueCharacterFormat.propertiesHash.get(propertyType);\n        }\n        return undefined;\n    };\n    WCharacterFormat.prototype.checkCharacterStyle = function (property) {\n        /* tslint:disable-next-line:no-any */\n        var baseStyle = this.baseCharStyle;\n        if (!isNullOrUndefined(baseStyle)) {\n            while (!isNullOrUndefined(baseStyle) && baseStyle.name !== 'Default Paragraph Font') {\n                var hasKey = baseStyle.characterFormat.hasValue(property);\n                if (hasKey) {\n                    var returnPropertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n                    return baseStyle.characterFormat.uniqueCharacterFormat.propertiesHash.get(returnPropertyType);\n                }\n                else {\n                    baseStyle = baseStyle.basedOn;\n                }\n            }\n        }\n        return undefined;\n    };\n    WCharacterFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WCharacterFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueCharacterFormat)) {\n            this.initializeUniqueCharacterFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType, property);\n            if (this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType) &&\n                // tslint:disable-next-line:max-line-length\n                this.uniqueCharacterFormat.propertiesHash.get(propertyType) === value) { //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat, property, value);\n        }\n    };\n    WCharacterFormat.prototype.initializeUniqueCharacterFormat = function (property, propValue) {\n        var uniqueCharFormatTemp = new Dictionary();\n        this.addUniqueCharacterFormat('fontColor', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('fontFamily', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('fontSize', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('bold', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('italic', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('underline', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('strikethrough', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('baselineAlignment', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('highlightColor', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('styleName', property, propValue, uniqueCharFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.addUniqueFormat(uniqueCharFormatTemp, WCharacterFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WCharacterFormat.prototype.addUniqueCharacterFormat = function (property, modifiedProperty, propValue, uniqueCharFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCharFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WCharacterFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'bold':\n                value = false;\n                break;\n            case 'italic':\n                value = false;\n                break;\n            case 'fontSize':\n                value = 11;\n                break;\n            case 'underline':\n                value = 'None';\n                break;\n            case 'strikethrough':\n                value = 'None';\n                break;\n            case 'baselineAlignment':\n                value = 'Normal';\n                break;\n            case 'highlightColor':\n                value = 'NoColor';\n                break;\n            case 'fontColor':\n                value = '#000000';\n                break;\n            case 'fontFamily':\n                value = 'Calibri';\n                break;\n            case 'styleName':\n                value = 'Default Paragraph Font';\n                break;\n        }\n        return value;\n    };\n    WCharacterFormat.prototype.isEqualFormat = function (format) {\n        return (this.fontSize === format.fontSize\n            && this.fontFamily === format.fontFamily\n            && this.bold === format.bold\n            && this.italic === format.italic\n            && this.baselineAlignment === format.baselineAlignment\n            && this.underline === format.underline\n            && this.fontColor === format.fontColor\n            && this.strikethrough === format.strikethrough\n            && this.highlightColor === format.highlightColor);\n    };\n    WCharacterFormat.prototype.isSameFormat = function (format) {\n        return this.baseCharStyle === format.baseCharStyle &&\n            this.uniqueCharacterFormat === format.uniqueCharacterFormat;\n    };\n    WCharacterFormat.prototype.cloneFormat = function () {\n        var format = new WCharacterFormat(undefined);\n        format.uniqueCharacterFormat = this.uniqueCharacterFormat;\n        format.baseCharStyle = this.baseCharStyle;\n        return format;\n    };\n    WCharacterFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueCharacterFormat) && !isNullOrUndefined(this.uniqueCharacterFormat.propertiesHash)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType, property);\n            return this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WCharacterFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.uniqueCharacterFormat) && this.uniqueCharacterFormat.referenceCount === 0) {\n            WCharacterFormat.uniqueCharacterFormats.remove(this.uniqueCharacterFormat);\n        }\n        this.uniqueCharacterFormat = undefined;\n        this.baseCharStyle = undefined;\n    };\n    WCharacterFormat.prototype.destroy = function () {\n        this.clearFormat();\n    };\n    WCharacterFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueCharacterFormat) && format.uniqueCharacterFormat.propertiesHash) {\n                this.updateUniqueCharacterFormat(format);\n            }\n            if (!isNullOrUndefined(format.baseCharStyle)) {\n                this.baseCharStyle = format.baseCharStyle;\n            }\n        }\n    };\n    WCharacterFormat.prototype.updateUniqueCharacterFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueCharacterFormat) {\n            hash = this.uniqueCharacterFormat.mergeProperties(format.uniqueCharacterFormat);\n            if (this.uniqueCharacterFormat.referenceCount === 0) {\n                WCharacterFormat.uniqueCharacterFormats.remove(this.uniqueCharacterFormat);\n                this.uniqueCharacterFormat = undefined;\n            }\n        }\n        this.uniqueCharacterFormat = new WUniqueFormat(WCharacterFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueCharacterFormat.mergeProperties(format.uniqueCharacterFormat);\n        }\n        this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.addUniqueFormat(hash, WCharacterFormat.uniqueFormatType);\n    };\n    WCharacterFormat.clear = function () {\n        this.uniqueCharacterFormats.clear();\n    };\n    WCharacterFormat.prototype.ApplyStyle = function (baseCharStyle) {\n        this.baseCharStyle = baseCharStyle;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WCharacterFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WCharacterFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('bold'))) {\n            this.bold = format.getValue('bold');\n        }\n        if (isNullOrUndefined(this.getValue('italic'))) {\n            this.italic = format.getValue('italic');\n        }\n        if (isNullOrUndefined(this.getValue('fontSize'))) {\n            this.fontSize = format.getValue('fontSize');\n        }\n        if (isNullOrUndefined(this.getValue('fontFamily'))) {\n            this.fontFamily = format.getValue('fontFamily');\n        }\n        if (isNullOrUndefined(this.getValue('underline'))) {\n            this.underline = format.getValue('underline');\n        }\n        if (isNullOrUndefined(this.getValue('strikethrough'))) {\n            this.strikethrough = format.getValue('strikethrough');\n        }\n        if (isNullOrUndefined(this.getValue('baselineAlignment'))) {\n            this.baselineAlignment = format.getValue('baselineAlignment');\n        }\n        if (isNullOrUndefined(this.getValue('highlightColor'))) {\n            this.highlightColor = format.getValue('highlightColor');\n        }\n        if (isNullOrUndefined(this.getValue('fontColor'))) {\n            this.fontColor = format.getValue('fontColor');\n        }\n    };\n    WCharacterFormat.uniqueCharacterFormats = new WUniqueFormats();\n    WCharacterFormat.uniqueFormatType = 2;\n    return WCharacterFormat;\n}());\nexport { WCharacterFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { FieldElementBox } from '../viewer/page';\n/**\n * @private\n */\nvar HelperMethods = /** @class */ (function () {\n    function HelperMethods() {\n    }\n    /**\n     * Inserts text at specified index in string.\n     * @param {string} spanText\n     * @param {number} index\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.insert = function (spanText, index, text) {\n        if (index >= 0) {\n            return [spanText.slice(0, index) + text + spanText.slice(index)].join('');\n        }\n        else {\n            return text + this;\n        }\n    };\n    /**\n     * Removes text from specified index in string.\n     * @param {string} text\n     * @param {number} index\n     * @param {number} length\n     * @private\n     */\n    HelperMethods.remove = function (text, index, length) {\n        if (index === 0) {\n            return text.substring(index + 1, text.length);\n        }\n        else {\n            return text.substring(0, index) + text.substring(index + 1, text.length);\n        }\n    };\n    /**\n     * Returns the index of word split character in a string.\n     * @param {string} text\n     * @param {string[]} wordSplitCharacter\n     * @private\n     */\n    /* tslint:disable:no-any */\n    HelperMethods.indexOfAny = function (text, wordSplitCharacter) {\n        var index = undefined;\n        for (var j = 0; j < wordSplitCharacter.length; j++) {\n            var temp = text.indexOf(wordSplitCharacter[j]);\n            if (temp !== -1 && isNullOrUndefined(index)) {\n                index = temp;\n            }\n            else if (temp !== -1 && temp < index) {\n                index = temp;\n            }\n        }\n        return isNullOrUndefined(index) ? -1 : index;\n    };\n    /**\n     * Returns the last index of word split character in a string.\n     * @param {string} text\n     * @param {string[]} wordSplitCharacter\n     * @private\n     */\n    HelperMethods.lastIndexOfAny = function (text, wordSplitCharacter) {\n        for (var i = text.length - 1; i >= 0; i--) {\n            for (var j = 0; j <= wordSplitCharacter.length - 1; j++) {\n                if (text[i] === wordSplitCharacter[j]) {\n                    return i;\n                }\n            }\n        }\n        return -1;\n    };\n    /**\n     * Adds css styles to document header.\n     * @param {string} css\n     * @private\n     */\n    HelperMethods.addCssStyle = function (css) {\n        var style = document.createElement('style');\n        if (style.style.cssText) {\n            style.style.cssText = css;\n        }\n        else {\n            style.appendChild(document.createTextNode(css));\n        }\n        document.getElementsByTagName('head')[0].appendChild(style);\n    };\n    /**\n     * Gets highlight color code.\n     * @param {HighlightColor} highlightColor\n     * @private\n     */\n    HelperMethods.getHighlightColorCode = function (highlightColor) {\n        var color = '#ffffff';\n        switch (highlightColor) {\n            case 'Yellow':\n                color = '#ffff00';\n                break;\n            case 'BrightGreen':\n                color = '#00ff00';\n                break;\n            case 'Turquoise':\n                color = '#00ffff';\n                break;\n            case 'Pink':\n                color = '#ff00ff';\n                break;\n            case 'Blue':\n                color = '#0000ff';\n                break;\n            case 'Red':\n                color = '#ff0000';\n                break;\n            case 'DarkBlue':\n                color = '#000080';\n                break;\n            case 'Teal':\n                color = '#008080';\n                break;\n            case 'Green':\n                color = '#008000';\n                break;\n            case 'Violet':\n                color = '#800080';\n                break;\n            case 'DarkRed':\n                color = '#800000';\n                break;\n            case 'DarkYellow':\n                color = '#808000';\n                break;\n            case 'Gray50':\n                color = '#808080';\n                break;\n            case 'Gray25':\n                color = '#c0c0c0';\n                break;\n            case 'Black':\n                color = '#000000';\n                break;\n        }\n        return color;\n    };\n    /**\n     * Converts point to pixel.\n     * @param {number} point\n     * @private\n     */\n    HelperMethods.convertPointToPixel = function (point) {\n        var pixel = HelperMethods.round((point * 96 / 72), 5);\n        return pixel;\n    };\n    /**\n     * Converts pixel to point.\n     * @param {number} pixel\n     * @private\n     */\n    HelperMethods.convertPixelToPoint = function (pixel) {\n        var point = HelperMethods.round((pixel * 72 / 96), 5);\n        return point;\n    };\n    /**\n     * Return true if field linked\n     * @private\n     */\n    HelperMethods.isLinkedFieldCharacter = function (inline) {\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            return !isNullOrUndefined(inline.fieldEnd);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            return !isNullOrUndefined(inline.fieldBegin) && !isNullOrUndefined(inline.fieldEnd);\n        }\n        else {\n            return !isNullOrUndefined(inline.fieldBegin);\n        }\n    };\n    /**\n     * Removes white space in a string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.removeSpace = function (text) {\n        if (!isNullOrUndefined(text) && text.length !== 0) {\n            for (var i = 0; i < text.length; i++) {\n                if (text.charAt(i) === ' ') {\n                    //replace the space by empty string in string\n                    text = text.replace(' ', '');\n                }\n            }\n        }\n        return text;\n    };\n    /**\n     * Trims white space at start of the string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.trimStart = function (text) {\n        var i = 0;\n        for (i; i < text.length; i++) {\n            if (text[i] !== ' ') {\n                break;\n            }\n        }\n        return text.substring(i, text.length);\n    };\n    /**\n     * Trims white space at end of the string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.trimEnd = function (text) {\n        var i = text.length - 1;\n        for (i; i >= 0; i--) {\n            if (text[i] !== ' ') {\n                break;\n            }\n        }\n        return text.substring(0, i + 1);\n    };\n    /**\n     * Checks whether string ends with whitespace.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.endsWith = function (text) {\n        if (!isNullOrUndefined(text) && text.length !== 0) {\n            return text[text.length - 1] === ' ';\n        }\n        return false;\n    };\n    /**\n     * @private\n     * Write Characterformat\n     * @param {any} characterFormat\n     * @param {boolean} isInline\n     * @param {WCharacterFormat} format\n     */\n    HelperMethods.writeCharacterFormat = function (characterFormat, isInline, format) {\n        characterFormat.bold = isInline ? format.bold : format.getValue('bold');\n        characterFormat.italic = isInline ? format.italic : format.getValue('italic');\n        characterFormat.fontSize = isInline ? format.fontSize : format.getValue('fontSize');\n        characterFormat.fontFamily = isInline ? format.fontFamily : format.getValue('fontFamily');\n        characterFormat.underline = isInline ? format.underline : format.getValue('underline');\n        characterFormat.strikethrough = isInline ? format.strikethrough : format.getValue('strikethrough');\n        characterFormat.baselineAlignment = isInline ? format.baselineAlignment : format.getValue('baselineAlignment');\n        characterFormat.highlightColor = isInline ? format.highlightColor : format.getValue('highlightColor');\n        characterFormat.fontColor = isInline ? format.fontColor : format.getValue('fontColor');\n        characterFormat.styleName = !isNullOrUndefined(format.baseCharStyle) ? format.baseCharStyle.name : undefined;\n    };\n    /* tslint:enable:no-any */\n    /**\n     * Rounds the values with specified decimal digits.\n     * @param {number} value\n     * @param {number} decimalDigits\n     * @private\n     */\n    HelperMethods.round = function (value, decimalDigits) {\n        var temp = value;\n        for (var i = 0; i < decimalDigits; i++) {\n            temp = temp * 10;\n        }\n        temp = Math.round(temp);\n        for (var i = 0; i < decimalDigits; i++) {\n            temp = temp / 10;\n        }\n        return temp;\n    };\n    /**\n     * @private\n     */\n    HelperMethods.wordBefore = '\\\\b';\n    /**\n     * @private\n     */\n    HelperMethods.wordAfter = '\\\\b';\n    /**\n     * @private\n     */\n    HelperMethods.wordSplitCharacters = [' ', ',', '.', ':', ';', '<', '>', '=',\n        '+', '-', '_', '{', '}', '[', ']', '`', '~', '!', '@', '#', '$', '%', '^', '&',\n        '*', '(', ')', '\"', '?', '/', '|', '\\\\', '”'];\n    return HelperMethods;\n}());\nexport { HelperMethods };\n/**\n * @private\n */\nvar Point = /** @class */ (function () {\n    function Point(xPosition, yPosition) {\n        this.xIn = 0;\n        this.yIn = 0;\n        this.xIn = xPosition;\n        this.yIn = yPosition;\n    }\n    Object.defineProperty(Point.prototype, \"x\", {\n        /**\n         * Gets or sets x value.\n         * @private\n         */\n        get: function () {\n            return this.xIn;\n        },\n        set: function (value) {\n            this.xIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Point.prototype, \"y\", {\n        /**\n         * Gets or sets y value.\n         * @private\n         */\n        get: function () {\n            return this.yIn;\n        },\n        set: function (value) {\n            this.yIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Point.prototype.copy = function (point) {\n        this.xIn = point.xIn;\n        this.yIn = point.yIn;\n    };\n    /**\n     * Destroys the internal objects maintained.\n     * @returns void\n     */\n    Point.prototype.destroy = function () {\n        this.xIn = undefined;\n        this.yIn = undefined;\n    };\n    return Point;\n}());\nexport { Point };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { WParagraphFormat } from './paragraph-format';\nimport { WCharacterFormat } from './character-format';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WStyle = /** @class */ (function () {\n    function WStyle() {\n    }\n    return WStyle;\n}());\nexport { WStyle };\n/**\n * @private\n */\nvar WParagraphStyle = /** @class */ (function (_super) {\n    __extends(WParagraphStyle, _super);\n    function WParagraphStyle(node) {\n        var _this = _super.call(this) || this;\n        _this.ownerBase = node;\n        _this.paragraphFormat = new WParagraphFormat(_this);\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    WParagraphStyle.prototype.destroy = function () {\n        this.characterFormat.destroy();\n        this.paragraphFormat.destroy();\n    };\n    WParagraphStyle.prototype.copyStyle = function (paraStyle) {\n        this.name = paraStyle.name;\n        this.ownerBase = paraStyle.ownerBase;\n        this.type = paraStyle.type;\n        this.next = paraStyle.next;\n        this.basedOn = paraStyle.basedOn;\n        this.link = paraStyle.link;\n        this.characterFormat.copyFormat(paraStyle.characterFormat);\n        this.paragraphFormat.copyFormat(paraStyle.paragraphFormat);\n    };\n    return WParagraphStyle;\n}(WStyle));\nexport { WParagraphStyle };\n/**\n * @private\n */\nvar WCharacterStyle = /** @class */ (function (_super) {\n    __extends(WCharacterStyle, _super);\n    function WCharacterStyle(node) {\n        var _this = _super.call(this) || this;\n        _this.ownerBase = node;\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    WCharacterStyle.prototype.destroy = function () {\n        this.characterFormat.destroy();\n    };\n    WCharacterStyle.prototype.copyStyle = function (charStyle) {\n        this.name = charStyle.name;\n        this.ownerBase = charStyle.ownerBase;\n        this.type = charStyle.type;\n        this.next = charStyle.next;\n        this.basedOn = charStyle.basedOn;\n        this.characterFormat.copyFormat(charStyle.characterFormat);\n    };\n    return WCharacterStyle;\n}(WStyle));\nexport { WCharacterStyle };\n/**\n * @private\n */\nvar WStyles = /** @class */ (function () {\n    function WStyles() {\n        this.collection = [];\n        /* tslint:enable:no-any */\n    }\n    Object.defineProperty(WStyles.prototype, \"length\", {\n        get: function () {\n            return this.collection.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WStyles.prototype.remove = function (item) {\n        this.collection = this.collection.filter(function (a) { return (a.name !== item.name); });\n    };\n    WStyles.prototype.push = function (item) {\n        if (item != null && item !== undefined) {\n            this.collection.push(item);\n        }\n        return 1;\n    };\n    WStyles.prototype.getItem = function (index) {\n        if (this.collection.length > index) {\n            return this.collection[index];\n        }\n        return null;\n    };\n    WStyles.prototype.indexOf = function (item) {\n        return this.collection.indexOf(item);\n    };\n    WStyles.prototype.contains = function (item) {\n        var index = this.collection.indexOf(item);\n        return index > -1 && index < this.collection.length;\n    };\n    WStyles.prototype.clear = function () {\n        while (this.collection.length > 0) {\n            this.collection.pop();\n        }\n    };\n    WStyles.prototype.findByName = function (name, type) {\n        var returnStyle;\n        for (var _i = 0, _a = this.collection; _i < _a.length; _i++) {\n            var value = _a[_i];\n            if (value.name === name) {\n                returnStyle = value;\n                if (!isNullOrUndefined(type) && value.type === type) {\n                    returnStyle = value;\n                }\n            }\n        }\n        return returnStyle;\n    };\n    WStyles.prototype.getStyleNames = function (type) {\n        return this.collection.filter(function (a) { return (a.type === type); }).map(function (a) { return a.name; });\n    };\n    /* tslint:disable:no-any */\n    WStyles.prototype.getStyles = function (type) {\n        var styles = this.collection.filter(function (a) { return (a.type === type); }).map(function (a) { return a; });\n        var styleObjects = [];\n        for (var _i = 0, styles_1 = styles; _i < styles_1.length; _i++) {\n            var style = styles_1[_i];\n            var returnStyle = {};\n            var returnStyleObject = {};\n            returnStyleObject.characterFormat = {};\n            HelperMethods.writeCharacterFormat(returnStyleObject.characterFormat, true, style.characterFormat);\n            returnStyle.name = style.name;\n            returnStyle.style = JSON.stringify(returnStyleObject);\n            styleObjects.push(returnStyle);\n        }\n        return styleObjects;\n    };\n    return WStyles;\n}());\nexport { WStyles };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WBorder = /** @class */ (function () {\n    function WBorder(node) {\n        this.uniqueBorderFormat = undefined;\n        this.ownerBase = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WBorder.prototype, \"color\", {\n        get: function () {\n            return this.getPropertyValue('color');\n        },\n        set: function (value) {\n            this.setPropertyValue('color', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"lineStyle\", {\n        get: function () {\n            return this.getPropertyValue('lineStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"lineWidth\", {\n        get: function () {\n            return this.getPropertyValue('lineWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"shadow\", {\n        get: function () {\n            return this.getPropertyValue('shadow');\n        },\n        set: function (value) {\n            this.setPropertyValue('shadow', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"space\", {\n        get: function () {\n            return this.getPropertyValue('space');\n        },\n        set: function (value) {\n            this.setPropertyValue('space', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"hasNoneStyle\", {\n        get: function () {\n            return this.getPropertyValue('hasNoneStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('hasNoneStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WBorder.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WBorder.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueBorderFormat) && this.uniqueBorderFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueBorderFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WBorder.getPropertyDefaultValue(property);\n    };\n    WBorder.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WBorder.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueBorderFormat)) {\n            this.initializeUniqueBorder(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueBorderFormat.uniqueFormatType, property);\n            if (this.uniqueBorderFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueBorderFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueBorderFormat = WBorder.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat, property, value);\n        }\n    };\n    WBorder.prototype.initializeUniqueBorder = function (property, propValue) {\n        var uniqueBorderFormatTemp = new Dictionary();\n        this.addUniqueBorderFormat('color', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('lineStyle', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('lineWidth', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('shadow', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('space', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('hasNoneStyle', property, propValue, uniqueBorderFormatTemp);\n        this.uniqueBorderFormat = WBorder.uniqueBorderFormats.addUniqueFormat(uniqueBorderFormatTemp, WBorder.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WBorder.prototype.addUniqueBorderFormat = function (property, modifiedProperty, propValue, uniqueBorderFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WBorder.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueBorderFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueBorderFormatTemp.add(propertyType, WBorder.getPropertyDefaultValue(property));\n        }\n    };\n    WBorder.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'color':\n                value = '#000000';\n                break;\n            case 'lineStyle':\n                value = 'None';\n                break;\n            case 'lineWidth':\n                value = 0;\n                break;\n            case 'shadow':\n                value = false;\n                break;\n            case 'space':\n                value = 0;\n                break;\n            case 'hasNoneStyle':\n                value = false;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.getLineWidth = function () {\n        /* tslint:disable */\n        switch (this.lineStyle) {\n            case 'None':\n            case 'Cleared':\n                return 0;\n            case 'Triple':\n            case 'Double':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n            case 'Emboss3D':\n            case 'Engrave3D':\n                {\n                    var lineArray = this.getBorderLineWidthArray(this.lineStyle, this.lineWidth);\n                    var width = 0;\n                    for (var i = 0; i < lineArray.length; i++) {\n                        width += lineArray[i];\n                    }\n                    return width;\n                }\n            case 'Single':\n            case 'DashLargeGap':\n            case 'DashSmallGap':\n            case 'Dot':\n            case 'DashDot':\n            case 'DashDotDot':\n            case 'Thick':\n                return this.lineWidth;\n            case 'SingleWavy':\n                return (this.lineWidth === 1.5 ? 3 : 2.5); //Double wave border only draw with the fixed width\n            case 'DoubleWavy':\n                return (6.75); //Double wave border only draw with the fixed width\n            case 'DashDotStroked':\n            case 'Outset':\n                return this.lineWidth;\n        }\n        return this.lineWidth;\n        /* tslint:enable */\n    };\n    WBorder.prototype.getBorderLineWidthArray = function (lineStyle, lineWidth) {\n        var borderLineArray = [lineWidth];\n        switch (lineStyle) {\n            case 'Double':\n                borderLineArray = [1, 1, 1];\n                break;\n            case 'ThinThickSmallGap':\n                borderLineArray = [1, -0.75, -0.75];\n                break;\n            case 'ThickThinSmallGap':\n                borderLineArray = [-0.75, -0.75, 1];\n                break;\n            case 'ThinThickMediumGap':\n                borderLineArray = [1, 0.5, 0.5];\n                break;\n            case 'ThickThinMediumGap':\n                borderLineArray = [0.5, 0.5, 1];\n                break;\n            case 'ThinThickLargeGap':\n                borderLineArray = [-1.5, 1, -0.75];\n                break;\n            case 'ThickThinLargeGap':\n                borderLineArray = [-0.75, 1, -1.5];\n                break;\n            case 'Triple':\n                borderLineArray = [1, 1, 1, 1, 1];\n                break;\n            case 'ThinThickThinSmallGap':\n                borderLineArray = [-0.75, -0.75, 1, -0.75, -0.75];\n                break;\n            case 'ThinThickThinMediumGap':\n                borderLineArray = [0.5, 0.5, 1, 0.5, 0.5];\n                break;\n            case 'ThinThickThinLargeGap':\n                borderLineArray = [-0.75, 1, -1.5, 1, -0.75];\n                break;\n            case 'Emboss3D':\n            case 'Engrave3D':\n                borderLineArray = [0.25, 0, 1, 0, 0.25];\n                break;\n        }\n        if (borderLineArray.length === 1) {\n            return [lineWidth];\n        }\n        for (var i = 0; i < borderLineArray.length; i++) {\n            if (borderLineArray[i] >= 0) {\n                borderLineArray[i] = borderLineArray[i] * lineWidth;\n            }\n            else {\n                borderLineArray[i] = Math.abs(borderLineArray[i]);\n            }\n        }\n        return borderLineArray;\n    };\n    WBorder.prototype.getBorderWeight = function () {\n        var weight = 0;\n        var numberOfLines = this.getNumberOfLines();\n        var borderNumber = this.getBorderNumber();\n        switch (this.lineStyle) {\n            case 'Single':\n            case 'DashSmallGap':\n            case 'DashDot':\n            case 'DashDotDot':\n            case 'Double':\n            case 'Triple':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n            case 'SingleWavy':\n            case 'DoubleWavy':\n            case 'DashDotStroked':\n            case 'Emboss3D':\n            case 'Engrave3D':\n            case 'Outset':\n            case 'Inset':\n            case 'Thick':\n                weight = numberOfLines * borderNumber;\n                break;\n            case 'Dot':\n            case 'DashLargeGap':\n                weight = 1;\n                break;\n        }\n        return weight;\n    };\n    WBorder.prototype.getBorderNumber = function () {\n        var borderNumber = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n                borderNumber = 1;\n                break;\n            case 'Thick':\n                borderNumber = 2;\n                break;\n            case 'Double':\n                borderNumber = 3;\n                break;\n            case 'Dot':\n                borderNumber = 4;\n                break;\n            case 'DashLargeGap': //dashed.\n                borderNumber = 5;\n                break;\n            case 'DashDot':\n                borderNumber = 6;\n                break;\n            case 'DashDotDot':\n                borderNumber = 7;\n                break;\n            case 'Triple':\n                borderNumber = 8;\n                break;\n            case 'ThinThickSmallGap':\n                borderNumber = 9;\n                break;\n            case 'ThickThinSmallGap':\n                borderNumber = 10;\n                break;\n            case 'ThinThickThinSmallGap':\n                borderNumber = 11;\n                break;\n            case 'ThinThickMediumGap':\n                borderNumber = 12;\n                break;\n            case 'ThickThinMediumGap':\n                borderNumber = 13;\n                break;\n            case 'ThinThickThinMediumGap':\n                borderNumber = 14;\n                break;\n            case 'ThinThickLargeGap':\n                borderNumber = 15;\n                break;\n            case 'ThickThinLargeGap':\n                borderNumber = 16;\n                break;\n            case 'ThinThickThinLargeGap':\n                borderNumber = 17;\n                break;\n            case 'SingleWavy': //wave.\n                borderNumber = 18;\n                break;\n            case 'DoubleWavy':\n                borderNumber = 19;\n                break;\n            case 'DashSmallGap':\n                borderNumber = 20;\n                break;\n            case 'DashDotStroked':\n                borderNumber = 21;\n                break;\n            case 'Emboss3D':\n                borderNumber = 22;\n                break;\n            case 'Engrave3D':\n                borderNumber = 23;\n                break;\n            case 'Outset':\n                borderNumber = 24;\n                break;\n            case 'Inset':\n                borderNumber = 25;\n                break;\n        }\n        return borderNumber;\n    };\n    WBorder.prototype.getNumberOfLines = function () {\n        //ToDo: Need to analyze more on this.\n        var value = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n            case 'Dot':\n            case 'DashSmallGap':\n            case 'DashLargeGap':\n            case 'DashDot':\n            case 'DashDotDot':\n                value = 1;\n                break;\n            case 'Double':\n                value = 3;\n                break;\n            case 'Triple':\n                value = 5;\n                break;\n            case 'ThinThickSmallGap':\n                value = 3;\n                break;\n            case 'ThickThinSmallGap':\n                value = 3;\n                break;\n            case 'ThinThickThinSmallGap':\n                value = 5;\n                break;\n            case 'ThinThickMediumGap':\n                value = 3;\n                break;\n            case 'ThickThinMediumGap':\n                value = 3;\n                break;\n            case 'ThinThickThinMediumGap':\n                value = 5;\n                break;\n            case 'ThinThickLargeGap':\n                value = 3;\n                break;\n            case 'ThickThinLargeGap':\n                value = 3;\n                break;\n            case 'ThinThickThinLargeGap':\n                value = 5;\n                break;\n            case 'SingleWavy':\n                value = 1;\n                break;\n            case 'DoubleWavy':\n                value = 2;\n                break;\n            case 'DashDotStroked':\n                value = 1;\n                break;\n            case 'Emboss3D':\n            case 'Engrave3D':\n                value = 3;\n                break;\n            case 'Outset':\n            case 'Inset':\n            case 'Thick':\n                value = 1;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.getPrecedence = function () {\n        var value = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n                value = 1;\n                break;\n            case 'Thick':\n                value = 2;\n                break;\n            case 'Double':\n                value = 3;\n                break;\n            case 'Dot':\n                value = 4;\n                break;\n            case 'DashLargeGap': //dashed.\n                value = 5;\n                break;\n            case 'DashDot':\n                value = 6;\n                break;\n            case 'DashDotDot':\n                value = 7;\n                break;\n            case 'Triple':\n                value = 8;\n                break;\n            case 'ThinThickSmallGap':\n                value = 9;\n                break;\n            case 'ThickThinSmallGap':\n                value = 10;\n                break;\n            case 'ThinThickThinSmallGap':\n                value = 11;\n                break;\n            case 'ThinThickMediumGap':\n                value = 12;\n                break;\n            case 'ThickThinMediumGap':\n                value = 13;\n                break;\n            case 'ThinThickThinMediumGap':\n                value = 14;\n                break;\n            case 'ThinThickLargeGap':\n                value = 15;\n                break;\n            case 'ThickThinLargeGap':\n                value = 16;\n                break;\n            case 'ThinThickThinLargeGap':\n                value = 17;\n                break;\n            case 'SingleWavy': //wave.\n                value = 18;\n                break;\n            case 'DoubleWavy':\n                value = 19;\n                break;\n            case 'DashSmallGap':\n                value = 20;\n                break;\n            case 'DashDotStroked':\n                value = 21;\n                break;\n            case 'Emboss3D':\n                value = 22;\n                break;\n            case 'Engrave3D':\n                value = 23;\n                break;\n            case 'Outset':\n                value = 24;\n                break;\n            case 'Inset':\n                value = 25;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueBorderFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueBorderFormat.uniqueFormatType, property);\n            return this.uniqueBorderFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WBorder.prototype.cloneFormat = function () {\n        var border = new WBorder(undefined);\n        border.color = this.color;\n        border.lineStyle = this.lineStyle;\n        border.lineWidth = this.lineWidth;\n        border.shadow = this.shadow;\n        border.space = this.space;\n        return border;\n    };\n    WBorder.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueBorderFormat)) {\n            WBorder.uniqueBorderFormats.remove(this.uniqueBorderFormat);\n        }\n        this.uniqueBorderFormat = undefined;\n    };\n    WBorder.prototype.copyFormat = function (border) {\n        if (!isNullOrUndefined(border) && !isNullOrUndefined(border.uniqueBorderFormat)) {\n            this.color = border.color;\n            this.lineStyle = border.lineStyle;\n            this.lineWidth = border.lineWidth;\n            this.shadow = border.shadow;\n            this.space = border.space;\n        }\n    };\n    WBorder.clear = function () {\n        this.uniqueBorderFormats.clear();\n    };\n    WBorder.uniqueBorderFormats = new WUniqueFormats();\n    WBorder.uniqueFormatType = 1;\n    return WBorder;\n}());\nexport { WBorder };\n","import { WBorder } from './border';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WBorders = /** @class */ (function () {\n    function WBorders(node) {\n        this.leftIn = new WBorder(this);\n        this.rightIn = new WBorder(this);\n        this.topIn = new WBorder(this);\n        this.bottomIn = new WBorder(this);\n        this.horizontalIn = new WBorder(this);\n        this.verticalIn = new WBorder(this);\n        this.diagonalUpIn = new WBorder(this);\n        this.diagonalDownIn = new WBorder(this);\n        this.lineWidthIn = 0;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WBorders.prototype, \"left\", {\n        get: function () {\n            return this.leftIn;\n        },\n        set: function (value) {\n            this.leftIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"right\", {\n        get: function () {\n            return this.rightIn;\n        },\n        set: function (value) {\n            this.rightIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"top\", {\n        get: function () {\n            return this.topIn;\n        },\n        set: function (value) {\n            this.topIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"bottom\", {\n        get: function () {\n            return this.bottomIn;\n        },\n        set: function (value) {\n            this.bottomIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"horizontal\", {\n        get: function () {\n            return this.horizontalIn;\n        },\n        set: function (value) {\n            this.horizontalIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"vertical\", {\n        get: function () {\n            return this.verticalIn;\n        },\n        set: function (value) {\n            this.verticalIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"diagonalUp\", {\n        get: function () {\n            return this.diagonalUpIn;\n        },\n        set: function (value) {\n            this.diagonalUpIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"diagonalDown\", {\n        get: function () {\n            return this.diagonalDownIn;\n        },\n        set: function (value) {\n            this.diagonalDownIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WBorders.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.left)) {\n            this.left.destroy();\n        }\n        if (!isNullOrUndefined(this.top)) {\n            this.top.destroy();\n        }\n        if (!isNullOrUndefined(this.bottom)) {\n            this.bottom.destroy();\n        }\n        if (!isNullOrUndefined(this.right)) {\n            this.right.destroy();\n        }\n        if (!isNullOrUndefined(this.horizontal)) {\n            this.horizontal.destroy();\n        }\n        if (!isNullOrUndefined(this.vertical)) {\n            this.vertical.destroy();\n        }\n        if (!isNullOrUndefined(this.diagonalDown)) {\n            this.diagonalDown.destroy();\n        }\n        if (!isNullOrUndefined(this.diagonalUp)) {\n            this.diagonalUp.destroy();\n        }\n        this.topIn = undefined;\n        this.bottomIn = undefined;\n        this.leftIn = undefined;\n        this.rightIn = undefined;\n        this.horizontalIn = undefined;\n        this.verticalIn = undefined;\n        this.diagonalDownIn = undefined;\n        this.diagonalUpIn = undefined;\n        this.lineWidthIn = undefined;\n        this.valueIn = undefined;\n    };\n    WBorders.prototype.cloneFormat = function () {\n        var borders = new WBorders(undefined);\n        borders.top = isNullOrUndefined(this.top) ? undefined : this.top.cloneFormat();\n        borders.bottom = isNullOrUndefined(this.bottom) ? undefined : this.bottom.cloneFormat();\n        borders.left = isNullOrUndefined(this.left) ? undefined : this.left.cloneFormat();\n        borders.right = isNullOrUndefined(this.right) ? undefined : this.right.cloneFormat();\n        borders.horizontal = isNullOrUndefined(this.horizontal) ? undefined : this.horizontal.cloneFormat();\n        borders.vertical = isNullOrUndefined(this.vertical) ? undefined : this.vertical.cloneFormat();\n        borders.diagonalUp = isNullOrUndefined(this.diagonalUp) ? undefined : this.diagonalUp.cloneFormat();\n        borders.diagonalDown = isNullOrUndefined(this.diagonalDown) ? undefined : this.diagonalDown.cloneFormat();\n        return borders;\n    };\n    WBorders.prototype.copyFormat = function (borders) {\n        if (!isNullOrUndefined(borders.left) && borders.left instanceof WBorder) {\n            this.left = new WBorder(this);\n            this.left.copyFormat(borders.left);\n        }\n        if (!isNullOrUndefined(borders.right) && borders.right instanceof WBorder) {\n            this.right = new WBorder(this);\n            this.right.copyFormat(borders.right);\n        }\n        if (!isNullOrUndefined(borders.top) && borders.top instanceof WBorder) {\n            this.top = new WBorder(this);\n            this.top.copyFormat(borders.top);\n        }\n        if (!isNullOrUndefined(borders.bottom) && borders.bottom instanceof WBorder) {\n            this.bottom = new WBorder(this);\n            this.bottom.copyFormat(borders.bottom);\n        }\n        if (!isNullOrUndefined(borders.horizontal) && borders.horizontal instanceof WBorder) {\n            this.horizontal = new WBorder(this);\n            this.horizontal.copyFormat(borders.horizontal);\n        }\n        if (!isNullOrUndefined(borders.vertical) && borders.vertical instanceof WBorder) {\n            this.vertical = new WBorder(this);\n            this.vertical.copyFormat(borders.vertical);\n        }\n        if (!isNullOrUndefined(borders.diagonalDown) && borders.diagonalDown instanceof WBorder) {\n            this.diagonalDown = new WBorder(this);\n            this.diagonalDown.copyFormat(borders.diagonalDown);\n        }\n        if (!isNullOrUndefined(borders.diagonalUp) && borders.diagonalUp instanceof WBorder) {\n            this.diagonalUp = new WBorder(this);\n            this.diagonalUp.copyFormat(borders.diagonalUp);\n        }\n    };\n    return WBorders;\n}());\nexport { WBorders };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { Dictionary } from '../../base/dictionary';\n/**\n * @private\n */\nvar WShading = /** @class */ (function () {\n    function WShading(node) {\n        this.uniqueShadingFormat = undefined;\n        this.ownerBase = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WShading.prototype, \"backgroundColor\", {\n        get: function () {\n            return this.getPropertyValue('backgroundColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('backgroundColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WShading.prototype, \"foregroundColor\", {\n        get: function () {\n            return this.getPropertyValue('foregroundColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('foregroundColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WShading.prototype, \"textureStyle\", {\n        get: function () {\n            return this.getPropertyValue('textureStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('textureStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WShading.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WShading.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueShadingFormat) && this.uniqueShadingFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueShadingFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WShading.getPropertyDefaultValue(property);\n    };\n    WShading.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WShading.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueShadingFormat)) {\n            this.initializeUniqueShading(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueShadingFormat.uniqueFormatType, property);\n            if (this.uniqueShadingFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueShadingFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueShadingFormat = WShading.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat, property, value);\n        }\n    };\n    WShading.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'backgroundColor':\n                value = '#ffffff';\n                break;\n            case 'foregroundColor':\n                value = 'empty';\n                break;\n            case 'textureStyle':\n                value = 'TextureNone';\n                break;\n        }\n        return value;\n    };\n    WShading.prototype.initializeUniqueShading = function (property, propValue) {\n        var uniqueShadingTemp = new Dictionary();\n        this.addUniqueShading('backgroundColor', property, propValue, uniqueShadingTemp);\n        this.addUniqueShading('foregroundColor', property, propValue, uniqueShadingTemp);\n        this.addUniqueShading('textureStyle', property, propValue, uniqueShadingTemp);\n        // tslint:disable-next-line:max-line-length        \n        this.uniqueShadingFormat = WShading.uniqueShadingFormats.addUniqueFormat(uniqueShadingTemp, WShading.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WShading.prototype.addUniqueShading = function (property, modifiedProperty, propValue, uniqueShadingTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WShading.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueShadingTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueShadingTemp.add(propertyType, WShading.getPropertyDefaultValue(property));\n        }\n    };\n    WShading.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueShadingFormat)) {\n            WShading.uniqueShadingFormats.remove(this.uniqueShadingFormat);\n        }\n        this.uniqueShadingFormat = undefined;\n    };\n    WShading.prototype.cloneFormat = function () {\n        var shading = new WShading(undefined);\n        shading.backgroundColor = this.backgroundColor;\n        shading.foregroundColor = this.foregroundColor;\n        shading.textureStyle = this.textureStyle;\n        return shading;\n    };\n    WShading.prototype.copyFormat = function (shading) {\n        if (!isNullOrUndefined(shading) && !isNullOrUndefined(shading.uniqueShadingFormat)) {\n            this.backgroundColor = shading.backgroundColor;\n            this.foregroundColor = shading.foregroundColor;\n            this.textureStyle = shading.textureStyle;\n        }\n    };\n    WShading.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueShadingFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueShadingFormat.uniqueFormatType, property);\n            return this.uniqueShadingFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WShading.clear = function () {\n        this.uniqueShadingFormats.clear();\n    };\n    WShading.uniqueShadingFormats = new WUniqueFormats();\n    WShading.uniqueFormatType = 5;\n    return WShading;\n}());\nexport { WShading };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\nimport { WShading } from './shading';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WTableFormat = /** @class */ (function () {\n    function WTableFormat(owner) {\n        this.uniqueTableFormat = undefined;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n        this.ownerBase = undefined;\n        this.ownerBase = owner;\n        this.assignTableMarginValue(5.4, 0, 5.4, 0);\n    }\n    Object.defineProperty(WTableFormat.prototype, \"cellSpacing\", {\n        get: function () {\n            return this.getPropertyValue('cellSpacing');\n        },\n        set: function (value) {\n            if (value < 0 || value > 264.6) {\n                throw new RangeError('The measurement must be between 0 px and 264.6 px.');\n            }\n            this.setPropertyValue('cellSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"leftIndent\", {\n        get: function () {\n            return this.getPropertyValue('leftIndent');\n        },\n        set: function (value) {\n            if (value < -1440 || value > 1440) {\n                throw new RangeError('The measurement must be between -1440 px and 1440 px.');\n            }\n            this.setPropertyValue('leftIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"tableAlignment\", {\n        get: function () {\n            return this.getPropertyValue('tableAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('tableAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"preferredWidth\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"preferredWidthType\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WTableFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WTableFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueTableFormat) && this.uniqueTableFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueTableFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WTableFormat.getPropertyDefaultValue(property);\n    };\n    WTableFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WTableFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueTableFormat)) {\n            this.initializeUniqueTableFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueTableFormat.uniqueFormatType, property);\n            if (this.uniqueTableFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueTableFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueTableFormat = WTableFormat.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat, property, value);\n        }\n    };\n    WTableFormat.prototype.initializeUniqueTableFormat = function (property, propValue) {\n        var uniqueTableFormatTemp = new Dictionary();\n        this.addUniqueTableFormat('cellSpacing', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('leftMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('topMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('bottomMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('rightMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('leftIndent', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('tableAlignment', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('preferredWidth', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('preferredWidthType', property, propValue, uniqueTableFormatTemp);\n        this.uniqueTableFormat = WTableFormat.uniqueTableFormats.addUniqueFormat(uniqueTableFormatTemp, WTableFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WTableFormat.prototype.addUniqueTableFormat = function (property, modifiedProperty, propValue, uniqueTableFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WTableFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueTableFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WTableFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'cellSpacing':\n                value = 0;\n                break;\n            case 'leftMargin':\n                value = 5.4;\n                break;\n            case 'topMargin':\n                value = 0;\n                break;\n            case 'bottomMargin':\n                value = 0;\n                break;\n            case 'rightMargin':\n                value = 5.4;\n                break;\n            case 'leftIndent':\n                value = 0;\n                break;\n            case 'tableAlignment':\n                value = 'Left';\n                break;\n            case 'preferredWidth':\n                value = 0;\n                break;\n            case 'preferredWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WTableFormat.prototype.assignTableMarginValue = function (left, top, right, bottom) {\n        this.leftMargin = left;\n        this.topMargin = top;\n        this.rightMargin = right;\n        this.bottomMargin = bottom;\n    };\n    WTableFormat.prototype.initializeTableBorders = function () {\n        this.borders.left.lineStyle = 'Single';\n        this.borders.left.lineWidth = 0.5;\n        this.borders.right.lineStyle = 'Single';\n        this.borders.right.lineWidth = 0.5;\n        this.borders.top.lineStyle = 'Single';\n        this.borders.top.lineWidth = 0.5;\n        this.borders.bottom.lineStyle = 'Single';\n        this.borders.bottom.lineWidth = 0.5;\n        this.borders.horizontal.lineStyle = 'Single';\n        this.borders.horizontal.lineWidth = 0.5;\n        this.borders.vertical.lineStyle = 'Single';\n        this.borders.vertical.lineWidth = 0.5;\n    };\n    WTableFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.shading)) {\n            this.shading.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueTableFormat)) {\n            WTableFormat.uniqueTableFormats.remove(this.uniqueTableFormat);\n        }\n        this.uniqueTableFormat = undefined;\n        this.borders = undefined;\n        this.shading = undefined;\n    };\n    WTableFormat.prototype.cloneFormat = function () {\n        var tableFormat = new WTableFormat(undefined);\n        tableFormat.leftIndent = this.leftIndent;\n        tableFormat.tableAlignment = this.tableAlignment;\n        tableFormat.cellSpacing = this.cellSpacing;\n        tableFormat.leftMargin = this.leftMargin;\n        tableFormat.rightMargin = this.rightMargin;\n        tableFormat.topMargin = this.topMargin;\n        tableFormat.bottomMargin = this.bottomMargin;\n        tableFormat.preferredWidth = this.preferredWidth;\n        tableFormat.preferredWidthType = this.preferredWidthType;\n        tableFormat.borders = isNullOrUndefined(this.borders) ? undefined : this.borders.cloneFormat();\n        tableFormat.shading = isNullOrUndefined(this.shading) ? undefined : this.shading.cloneFormat();\n        return tableFormat;\n    };\n    WTableFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueTableFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueTableFormat.uniqueFormatType, property);\n            return this.uniqueTableFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WTableFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueTableFormat)) {\n                this.cellSpacing = format.cellSpacing;\n                this.leftMargin = format.leftMargin;\n                this.topMargin = format.topMargin;\n                this.rightMargin = format.rightMargin;\n                this.bottomMargin = format.bottomMargin;\n                this.leftIndent = format.leftIndent;\n                this.tableAlignment = format.tableAlignment;\n                this.preferredWidth = format.preferredWidth;\n                this.preferredWidthType = format.preferredWidthType;\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.copyFormat(format.borders);\n            }\n            if (!isNullOrUndefined(format.shading)) {\n                this.shading = new WShading(this);\n                this.shading.copyFormat(format.shading);\n            }\n        }\n    };\n    WTableFormat.clear = function () {\n        this.uniqueTableFormats.clear();\n    };\n    WTableFormat.uniqueTableFormats = new WUniqueFormats();\n    WTableFormat.uniqueFormatType = 8;\n    return WTableFormat;\n}());\nexport { WTableFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\n/**\n * @private\n */\nvar WRowFormat = /** @class */ (function () {\n    function WRowFormat(node) {\n        this.uniqueRowFormat = undefined;\n        /**\n         * @private\n         */\n        this.borders = new WBorders(this);\n        /**\n         * @private\n         */\n        this.ownerBase = undefined;\n        /**\n         * @private\n         */\n        this.beforeWidth = 0;\n        /**\n         * @private\n         */\n        this.afterWidth = 0;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WRowFormat.prototype, \"gridBefore\", {\n        get: function () {\n            return this.getPropertyValue('gridBefore');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBefore', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridBeforeWidth\", {\n        get: function () {\n            return this.getPropertyValue('gridBeforeWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBeforeWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridBeforeWidthType\", {\n        get: function () {\n            return this.getPropertyValue('gridBeforeWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBeforeWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfter\", {\n        get: function () {\n            return this.getPropertyValue('gridAfter');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfter', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfterWidth\", {\n        get: function () {\n            return this.getPropertyValue('gridAfterWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfterWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfterWidthType\", {\n        get: function () {\n            return this.getPropertyValue('gridAfterWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfterWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"allowBreakAcrossPages\", {\n        get: function () {\n            return this.getPropertyValue('allowBreakAcrossPages');\n        },\n        set: function (value) {\n            this.setPropertyValue('allowBreakAcrossPages', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"isHeader\", {\n        get: function () {\n            return this.getPropertyValue('isHeader');\n        },\n        set: function (value) {\n            this.setPropertyValue('isHeader', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"height\", {\n        get: function () {\n            return this.getPropertyValue('height');\n        },\n        set: function (value) {\n            if (value === 0 && (this.heightType === 'AtLeast' || this.heightType === 'Exactly')) {\n                value = 1;\n            }\n            else if (this.heightType === 'Auto') {\n                value = 0;\n            }\n            this.setPropertyValue('height', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"heightType\", {\n        get: function () {\n            return this.getPropertyValue('heightType');\n        },\n        set: function (value) {\n            if (value === 'AtLeast' || value === 'Exactly') {\n                this.height = 1;\n            }\n            else {\n                this.height = 0;\n            }\n            this.setPropertyValue('heightType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WRowFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WRowFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueRowFormat) && this.uniqueRowFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueRowFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WRowFormat.getPropertyDefaultValue(property);\n    };\n    WRowFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WRowFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueRowFormat)) {\n            this.initializeUniqueRowFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueRowFormat.uniqueFormatType, property);\n            if (this.uniqueRowFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueRowFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueRowFormat = WRowFormat.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat, property, value);\n        }\n    };\n    WRowFormat.prototype.initializeUniqueRowFormat = function (property, propValue) {\n        var uniqueRowFormatTemp = new Dictionary();\n        this.addUniqueRowFormat('allowBreakAcrossPages', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('isHeader', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('height', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('heightType', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBefore', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidthType', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridAfter', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridAfterWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridgridAfterWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidthType', property, propValue, uniqueRowFormatTemp);\n        this.uniqueRowFormat = WRowFormat.uniqueRowFormats.addUniqueFormat(uniqueRowFormatTemp, WRowFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WRowFormat.prototype.addUniqueRowFormat = function (property, modifiedProperty, propValue, uniqueRowFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WRowFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueRowFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WRowFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'allowBreakAcrossPages':\n                value = true;\n                break;\n            case 'isHeader':\n                value = false;\n                break;\n            case 'height':\n                value = 0;\n                break;\n            case 'heightType':\n                value = 'Auto';\n                break;\n            case 'gridBefore':\n                value = 0;\n                break;\n            case 'gridBeforeWidth':\n                value = 0;\n                break;\n            case 'gridBeforeWidthType':\n                value = 'Point';\n                break;\n            case 'gridAfter':\n                value = 0;\n                break;\n            case 'gridAfterWidth':\n                value = 0;\n                break;\n            case 'gridAfterWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WRowFormat.prototype.cloneFormat = function () {\n        var format = new WRowFormat();\n        format.allowBreakAcrossPages = this.allowBreakAcrossPages;\n        format.heightType = this.heightType;\n        format.height = this.height;\n        format.isHeader = this.isHeader;\n        format.gridBefore = this.gridBefore;\n        format.gridBeforeWidth = this.gridBeforeWidth;\n        format.gridBeforeWidthType = this.gridBeforeWidthType;\n        format.gridAfter = this.gridAfter;\n        format.gridAfterWidth = this.gridAfterWidth;\n        format.gridAfterWidthType = this.gridAfterWidthType;\n        return format;\n    };\n    WRowFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueRowFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueRowFormat.uniqueFormatType, property);\n            return this.uniqueRowFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WRowFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueRowFormat)) {\n                this.allowBreakAcrossPages = format.allowBreakAcrossPages;\n                this.isHeader = format.isHeader;\n                this.heightType = format.heightType;\n                this.height = format.height;\n                this.gridBefore = format.gridBefore;\n                this.gridBeforeWidth = format.gridBeforeWidth;\n                this.gridBeforeWidthType = format.gridBeforeWidthType;\n                this.gridAfter = format.gridAfter;\n                this.gridAfterWidth = format.gridAfterWidth;\n                this.gridAfterWidthType = format.gridAfterWidthType;\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.ownerBase = format;\n                this.borders.copyFormat(format.borders);\n            }\n        }\n    };\n    WRowFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueRowFormat)) {\n            WRowFormat.uniqueRowFormats.remove(this.uniqueRowFormat);\n        }\n        this.beforeWidth = undefined;\n        this.afterWidth = undefined;\n        this.borders = undefined;\n        this.uniqueRowFormat = undefined;\n    };\n    WRowFormat.clear = function () {\n        this.uniqueRowFormats.clear();\n    };\n    WRowFormat.uniqueRowFormats = new WUniqueFormats();\n    WRowFormat.uniqueFormatType = 6;\n    return WRowFormat;\n}());\nexport { WRowFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\nimport { WShading } from './shading';\n/**\n * @private\n */\nvar WCellFormat = /** @class */ (function () {\n    function WCellFormat(node) {\n        this.uniqueCellFormat = undefined;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n        this.ownerBase = node;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n    }\n    Object.defineProperty(WCellFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"cellWidth\", {\n        get: function () {\n            return this.getPropertyValue('cellWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('cellWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"columnSpan\", {\n        get: function () {\n            return this.getPropertyValue('columnSpan');\n        },\n        set: function (value) {\n            this.setPropertyValue('columnSpan', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"rowSpan\", {\n        get: function () {\n            return this.getPropertyValue('rowSpan');\n        },\n        set: function (value) {\n            this.setPropertyValue('rowSpan', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"preferredWidth\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"verticalAlignment\", {\n        get: function () {\n            return this.getPropertyValue('verticalAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('verticalAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"preferredWidthType\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WCellFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WCellFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueCellFormat) && this.uniqueCellFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueCellFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WCellFormat.getPropertyDefaultValue(property);\n    };\n    WCellFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WCellFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueCellFormat)) {\n            this.initializeUniqueCellFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCellFormat.uniqueFormatType, property);\n            if (this.uniqueCellFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueCellFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueCellFormat = WCellFormat.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat, property, value);\n        }\n    };\n    WCellFormat.prototype.initializeUniqueCellFormat = function (property, propValue) {\n        var uniqueCellFormatTemp = new Dictionary();\n        this.addUniqueCellFormat('leftMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('topMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('bottomMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('rightMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('cellWidth', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('columnSpan', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('rowSpan', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('preferredWidth', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('verticalAlignment', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('preferredWidthType', property, propValue, uniqueCellFormatTemp);\n        this.uniqueCellFormat = WCellFormat.uniqueCellFormats.addUniqueFormat(uniqueCellFormatTemp, WCellFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WCellFormat.prototype.addUniqueCellFormat = function (property, modifiedProperty, propValue, uniqueCellFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WCellFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCellFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WCellFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'leftMargin':\n                value = undefined;\n                break;\n            case 'topMargin':\n                value = undefined;\n                break;\n            case 'bottomMargin':\n                value = undefined;\n                break;\n            case 'rightMargin':\n                value = undefined;\n                break;\n            case 'cellWidth':\n                value = 0;\n                break;\n            case 'columnSpan':\n                value = 1;\n                break;\n            case 'rowSpan':\n                value = 1;\n                break;\n            case 'preferredWidth':\n                value = 0;\n                break;\n            case 'verticalAlignment':\n                value = 'Top';\n                break;\n            case 'preferredWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WCellFormat.prototype.containsMargins = function () {\n        return (!isNullOrUndefined(this.leftMargin)\n            || !isNullOrUndefined(this.rightMargin)\n            || !isNullOrUndefined(this.bottomMargin)\n            || !isNullOrUndefined(this.topMargin));\n    };\n    WCellFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.shading)) {\n            this.shading.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueCellFormat)) {\n            WCellFormat.uniqueCellFormats.remove(this.uniqueCellFormat);\n        }\n        this.uniqueCellFormat = undefined;\n        this.borders = undefined;\n        this.shading = undefined;\n    };\n    WCellFormat.prototype.cloneFormat = function () {\n        var format = new WCellFormat(undefined);\n        format.verticalAlignment = this.verticalAlignment;\n        format.leftMargin = this.leftMargin;\n        format.rightMargin = this.rightMargin;\n        format.topMargin = this.topMargin;\n        format.bottomMargin = this.bottomMargin;\n        format.preferredWidth = this.preferredWidth;\n        format.preferredWidthType = this.preferredWidthType;\n        format.cellWidth = this.cellWidth;\n        format.borders = isNullOrUndefined(this.borders) ? undefined : this.borders.cloneFormat();\n        format.shading = isNullOrUndefined(this.shading) ? undefined : this.shading.cloneFormat();\n        return format;\n    };\n    WCellFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueCellFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCellFormat.uniqueFormatType, property);\n            return this.uniqueCellFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WCellFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueCellFormat)) {\n                this.cellWidth = format.cellWidth;\n                this.leftMargin = format.leftMargin;\n                this.topMargin = format.topMargin;\n                this.rightMargin = format.rightMargin;\n                this.bottomMargin = format.bottomMargin;\n                this.preferredWidth = format.preferredWidth;\n                this.columnSpan = format.columnSpan;\n                this.rowSpan = format.rowSpan;\n                this.preferredWidthType = format.preferredWidthType;\n                this.verticalAlignment = format.verticalAlignment;\n            }\n            if (!isNullOrUndefined(format.shading)) {\n                this.shading = new WShading(this);\n                this.shading.copyFormat(format.shading);\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.copyFormat(format.borders);\n            }\n        }\n    };\n    WCellFormat.clear = function () {\n        this.uniqueCellFormats.clear();\n    };\n    WCellFormat.uniqueCellFormats = new WUniqueFormats();\n    WCellFormat.uniqueFormatType = 4;\n    return WCellFormat;\n}());\nexport { WCellFormat };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { WTableFormat, WRowFormat, WCellFormat } from '../format/index';\nimport { WParagraphFormat, WCharacterFormat, WBorder, WBorders } from '../format/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar Rect = /** @class */ (function () {\n    function Rect(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n    Object.defineProperty(Rect.prototype, \"right\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.x + this.width;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Rect.prototype, \"bottom\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.y + this.height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Rect;\n}());\nexport { Rect };\n/**\n * @private\n */\nvar Margin = /** @class */ (function () {\n    function Margin(leftMargin, topMargin, rightMargin, bottomMargin) {\n        this.left = leftMargin;\n        this.top = topMargin;\n        this.right = rightMargin;\n        this.bottom = bottomMargin;\n    }\n    /**\n     * @private\n     */\n    Margin.prototype.clone = function () {\n        return new Margin(this.left, this.top, this.right, this.bottom);\n    };\n    /**\n     * @private\n     */\n    Margin.prototype.destroy = function () {\n        this.left = undefined;\n        this.right = undefined;\n        this.top = undefined;\n        this.bottom = undefined;\n    };\n    return Margin;\n}());\nexport { Margin };\n/**\n * @private\n */\nvar Widget = /** @class */ (function () {\n    function Widget() {\n        /**\n         * @private\n         */\n        this.childWidgets = [];\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        /**\n         * @private\n         */\n        this.index = 0;\n    }\n    Object.defineProperty(Widget.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this instanceof BodyWidget && this.page) {\n                return this.page.bodyWidgets.indexOf(this);\n            }\n            else if (this.containerWidget && this.containerWidget.childWidgets) {\n                return this.containerWidget.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"firstChild\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.childWidgets.length > 0 ? this.childWidgets[0] : undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"lastChild\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.childWidgets) {\n                return this.childWidgets.length > 0 ?\n                    this.childWidgets[this.childWidgets.length - 1] : undefined;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (widget instanceof BodyWidget) {\n                widget = index > 0 ? widget.page.bodyWidgets[index - 1] : undefined;\n            }\n            else {\n                widget = index > 0 ? widget.containerWidget.childWidgets[index - 1] : undefined;\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index === -1) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                widget = index < widget.page.bodyWidgets.length - 1 ?\n                    widget.page.bodyWidgets[index + 1] : undefined;\n            }\n            else {\n                widget = index < widget.containerWidget.childWidgets.length - 1 ?\n                    widget.containerWidget.childWidgets[index + 1] : undefined;\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousRenderedWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index < 0) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                if (index > 0) {\n                    widget = widget.page.bodyWidgets[index - 1];\n                }\n                else {\n                    var page = widget.page.previousPage;\n                    widget = page && page.bodyWidgets.length > 0 ? page.bodyWidgets[page.bodyWidgets.length - 1] : undefined;\n                }\n            }\n            else {\n                if (index > 0) {\n                    widget = widget.containerWidget.childWidgets[index - 1];\n                }\n                else {\n                    var previousContainer = undefined;\n                    if (widget.containerWidget instanceof TableCellWidget) {\n                        previousContainer = widget.containerWidget.getPreviousSplitWidget();\n                    }\n                    else if (!(widget.containerWidget instanceof TableRowWidget\n                        || widget.containerWidget instanceof HeaderFooterWidget)) {\n                        // Since cells are lay outed left to right, we should not navigate to previous row.\n                        previousContainer = widget.containerWidget.previousRenderedWidget;\n                    }\n                    while (previousContainer && previousContainer.childWidgets.length === 0) {\n                        previousContainer = previousContainer.previousRenderedWidget;\n                        if (isNullOrUndefined(previousContainer)) {\n                            break;\n                        }\n                    }\n                    widget = previousContainer && previousContainer.constructor === widget.containerWidget.constructor ?\n                        previousContainer.lastChild : undefined;\n                }\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextRenderedWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index < 0) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                if (index < widget.page.bodyWidgets.length - 1) {\n                    widget = widget.page.bodyWidgets[index + 1];\n                }\n                else {\n                    var page = widget.page.nextPage;\n                    widget = page && page.bodyWidgets.length > 0 ? page.bodyWidgets[0] : undefined;\n                }\n            }\n            else {\n                if (index < widget.containerWidget.childWidgets.length - 1) {\n                    widget = widget.containerWidget.childWidgets[index + 1];\n                }\n                else {\n                    var nextContainer = undefined;\n                    if (widget.containerWidget instanceof TableCellWidget) {\n                        nextContainer = widget.containerWidget.getNextSplitWidget();\n                    }\n                    else if (!(widget.containerWidget instanceof TableRowWidget\n                        || widget.containerWidget instanceof HeaderFooterWidget)) {\n                        // Since cells are lay outed left to right, we should not navigate to next row.\n                        nextContainer = widget.containerWidget.nextRenderedWidget;\n                    }\n                    while (nextContainer && nextContainer.childWidgets.length === 0 && !(nextContainer instanceof TableCellWidget)) {\n                        nextContainer = nextContainer.nextRenderedWidget;\n                        if (isNullOrUndefined(nextContainer)) {\n                            break;\n                        }\n                    }\n                    widget = nextContainer && nextContainer.constructor === widget.containerWidget.constructor ?\n                        nextContainer.firstChild : undefined;\n                }\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousSplitWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            if (widget instanceof TableCellWidget) {\n                return widget.getPreviousSplitWidget();\n            }\n            else {\n                var previous = widget.previousRenderedWidget;\n                if (widget instanceof BodyWidget && previous instanceof BodyWidget && widget.equals(previous)) {\n                    return previous;\n                }\n                else if (previous instanceof BlockWidget && widget.index === previous.index && widget.equals(previous)) {\n                    return previous;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextSplitWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            if (widget instanceof TableCellWidget) {\n                return widget.getNextSplitWidget();\n            }\n            else {\n                var next = widget.nextRenderedWidget;\n                if (widget instanceof BodyWidget && next instanceof BodyWidget && widget.equals(next)) {\n                    return next;\n                }\n                else if (next instanceof BlockWidget && widget.index === next.index && widget.equals(next)) {\n                    return next;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Widget.prototype.getPreviousSplitWidgets = function () {\n        var widgets = [];\n        var widget = this.previousSplitWidget;\n        while (widget) {\n            widgets.unshift(widget);\n            widget = widget.previousSplitWidget;\n        }\n        return widgets;\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.getSplitWidgets = function () {\n        var widgets = this.getPreviousSplitWidgets();\n        var widget = this;\n        while (widget) {\n            widgets.push(widget);\n            widget = widget.nextSplitWidget;\n        }\n        return widgets;\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.combineWidget = function (viewer) {\n        var root = this;\n        var widgets = this.getSplitWidgets();\n        if (widgets.length > 1) {\n            root = widgets.shift();\n            while (widgets.length > 0) {\n                var splitWidget = widgets.shift();\n                root.combine(splitWidget, viewer);\n            }\n        }\n        if (root instanceof TableWidget) {\n            root.combineRows(viewer);\n        }\n        return root;\n    };\n    Widget.prototype.combine = function (widget, viewer) {\n        if (widget.childWidgets.length > 0) {\n            var lastChild = this.lastChild;\n            if (lastChild instanceof TableWidget) {\n                lastChild.combineWidget(viewer);\n            }\n            else {\n                var firstChild = widget.firstChild;\n                if (!(widget instanceof TableWidget) && lastChild instanceof Widget && firstChild instanceof Widget &&\n                    lastChild.index === firstChild.index) {\n                    lastChild.combine(widget.childWidgets.shift(), viewer);\n                }\n            }\n            this.addWidgets(widget.childWidgets);\n            widget.childWidgets = [];\n        }\n        widget.destroyInternal(viewer);\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.addWidgets = function (childWidgets) {\n        while (childWidgets.length > 0) {\n            var widget = childWidgets.shift();\n            if (widget instanceof LineWidget && this instanceof ParagraphWidget) {\n                widget.paragraph = this;\n                this.height += widget.height;\n            }\n            else if (widget instanceof Widget) {\n                var lastChild = this.lastChild;\n                widget.containerWidget = this;\n                widget.y = lastChild instanceof Widget ? lastChild.y + lastChild.height : this.y;\n                this.height += widget.height;\n            }\n            this.childWidgets.push(widget);\n        }\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.removeChild = function (index) {\n        if (index > -1 && index < this.childWidgets.length) {\n            this.childWidgets.splice(index, 1);\n        }\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.destroy = function () {\n        if (this.childWidgets) {\n            while (this.childWidgets.length > 0) {\n                var child = this.childWidgets.pop();\n                if (child instanceof LineWidget || child instanceof Widget) {\n                    child.destroy();\n                }\n            }\n        }\n        this.childWidgets = undefined;\n        if (this.containerWidget) {\n            this.containerWidget.removeChild(this.indexInOwner);\n        }\n        this.containerWidget = undefined;\n        // if (this.margin) {\n        //     this.margin.destroy();\n        // }\n        this.margin = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n        this.index = undefined;\n    };\n    return Widget;\n}());\nexport { Widget };\n/**\n * @private\n */\nvar BlockContainer = /** @class */ (function (_super) {\n    __extends(BlockContainer, _super);\n    function BlockContainer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        /**\n         * @private\n         */\n        _this.sectionFormatIn = undefined;\n        return _this;\n    }\n    Object.defineProperty(BlockContainer.prototype, \"sectionFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var container = this;\n            if (container instanceof BodyWidget) {\n                return container.sectionFormatIn;\n            }\n            else if (container.page) {\n                return container.page.bodyWidgets[0].sectionFormat;\n            }\n            return undefined;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (this instanceof BodyWidget) {\n                this.sectionFormatIn = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockContainer.prototype, \"sectionIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var container = this;\n            var index = 0;\n            if (container instanceof BodyWidget) {\n                index = container.index;\n            }\n            else if (container.page) {\n                index = container.page.bodyWidgets[0].index;\n            }\n            return index;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    BlockContainer.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var viewer = undefined;\n        var node = this;\n        if (node instanceof BodyWidget) {\n            hierarchicalIndex = node.index + ';' + hierarchicalIndex;\n        }\n        else {\n            if (node.headerFooterType.indexOf('Header') !== -1) {\n                hierarchicalIndex = 'H' + ';' + hierarchicalIndex;\n            }\n            else {\n                hierarchicalIndex = 'F' + ';' + hierarchicalIndex;\n            }\n        }\n        if (!isNullOrUndefined(node.page)) {\n            viewer = this.page.viewer;\n            var pageIndex = viewer.pages.indexOf(this.page);\n            return pageIndex + ';' + hierarchicalIndex;\n        }\n        return hierarchicalIndex;\n    };\n    return BlockContainer;\n}(Widget));\nexport { BlockContainer };\n/**\n * @private\n */\nvar BodyWidget = /** @class */ (function (_super) {\n    __extends(BodyWidget, _super);\n    /**\n     * Initialize the constructor of BodyWidget\n     */\n    function BodyWidget() {\n        return _super.call(this) || this;\n    }\n    /**\n     * @private\n     */\n    BodyWidget.prototype.equals = function (widget) {\n        return widget instanceof BodyWidget && widget.sectionFormat === this.sectionFormat;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var viewer = undefined;\n        var node = this;\n        hierarchicalIndex = node.index + ';' + hierarchicalIndex;\n        if (!isNullOrUndefined(node.page)) {\n            viewer = this.page.viewer;\n            var pageIndex = viewer.pages.indexOf(this.page);\n            return pageIndex + ';' + hierarchicalIndex;\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.getTableCellWidget = function (touchPoint) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= touchPoint.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= touchPoint.y) {\n                return this.childWidgets[i].getTableCellWidget(touchPoint);\n            }\n        }\n        var tableCellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].y <= touchPoint.y) {\n                tableCellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(touchPoint);\n            }\n            else {\n                tableCellWidget = this.childWidgets[0].getTableCellWidget(touchPoint);\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var n = 0; n < this.childWidgets.length; n++) {\n                var chilgWidget = this.childWidgets[n];\n                if (chilgWidget instanceof ParagraphWidget) {\n                    chilgWidget.destroyInternal(viewer);\n                }\n                else {\n                    chilgWidget.destroyInternal(viewer);\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                n--;\n            }\n            this.childWidgets = undefined;\n        }\n        // if (this instanceof HeaderFooterWidget && ((this as HeaderFooterWidget).currentNode ))) {\n        //     if (((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets )) {\n        //         let index: number = ((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets.indexOf(this);\n        //         ((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets.splice(index, 1);\n        //     }\n        //     this.currentNode = undefined;\n        /* tslint:disable: one-line */\n        if (!isNullOrUndefined(this.page)) {\n            var index = this.indexInOwner;\n            if (this.indexInOwner > -1) {\n                this.page.bodyWidgets.splice(index, 1);\n                if (this.page.bodyWidgets.length === 0) {\n                    this.page.destroy();\n                    // }\n                }\n                else if ((this instanceof HeaderFooterWidget)\n                    && this.page.headerWidget === this) {\n                    this.page.headerWidget = undefined;\n                }\n                else if ((this instanceof HeaderFooterWidget)\n                    && this.page.footerWidget === this) {\n                    this.page.footerWidget = undefined;\n                }\n                this.page = undefined;\n            }\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.destroy = function () {\n        // if (this.sectionFormat) {\n        //     this.sectionFormat.destroy();\n        // }\n        this.sectionFormat = undefined;\n        this.page = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return BodyWidget;\n}(BlockContainer));\nexport { BodyWidget };\n/**\n * @private\n */\nvar HeaderFooterWidget = /** @class */ (function (_super) {\n    __extends(HeaderFooterWidget, _super);\n    function HeaderFooterWidget(type) {\n        var _this = _super.call(this) || this;\n        _this.headerFooterType = type;\n        return _this;\n    }\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.getTableCellWidget = function (point) {\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.equals = function (widget) {\n        // Todo: Need to work\n        return widget instanceof HeaderFooterWidget\n            && widget.containerWidget === this.containerWidget;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.clone = function () {\n        var headerFooter = new HeaderFooterWidget(this.headerFooterType);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var block = this.childWidgets[i].clone();\n            headerFooter.childWidgets.push(block);\n            block.index = i;\n            block.containerWidget = headerFooter;\n        }\n        headerFooter.x = this.x;\n        headerFooter.y = this.y;\n        headerFooter.height = 0;\n        headerFooter.width = 0;\n        return headerFooter;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.destroyInternal = function (viewer) {\n        this.page = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return HeaderFooterWidget;\n}(BlockContainer));\nexport { HeaderFooterWidget };\n/**\n * @private\n */\nvar BlockWidget = /** @class */ (function (_super) {\n    __extends(BlockWidget, _super);\n    function BlockWidget() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(BlockWidget.prototype, \"bodyWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            while (widget.containerWidget) {\n                if (widget.containerWidget instanceof BlockContainer) {\n                    return widget.containerWidget;\n                }\n                widget = widget.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"leftIndent\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var blockAdv = this;\n            if (blockAdv instanceof ParagraphWidget && blockAdv.paragraphFormat instanceof WParagraphFormat) {\n                return blockAdv.paragraphFormat.leftIndent;\n            }\n            else if (blockAdv instanceof TableWidget && blockAdv.tableFormat instanceof WTableFormat) {\n                return blockAdv.tableFormat.leftIndent;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"rightIndent\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var blockAdv = this;\n            if (blockAdv instanceof ParagraphWidget && blockAdv.paragraphFormat instanceof WParagraphFormat) {\n                return blockAdv.paragraphFormat.rightIndent;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"isInsideTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.containerWidget instanceof TableCellWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"isInHeaderFooter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.bodyWidget instanceof HeaderFooterWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"associatedCell\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableCellWidget) {\n                return this.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Check whether the paragraph contains only page break.\n     * @private\n     */\n    BlockWidget.prototype.isPageBreak = function () {\n        var isPageBreak = false;\n        if (this instanceof ParagraphWidget) {\n            var paragraph = this;\n            if (paragraph != null && paragraph.childWidgets.length === 1 &&\n                paragraph.firstChild.children.length === 1) {\n                var pageBreak = paragraph.firstChild.children[0];\n                isPageBreak = pageBreak.isPageBreak;\n            }\n        }\n        return isPageBreak;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var node = this;\n        hierarchicalIndex = node.containerWidget.childWidgets.indexOf(node) + ';' + hierarchicalIndex;\n        if (!isNullOrUndefined(node.containerWidget)) {\n            if (node.containerWidget instanceof BlockWidget) {\n                return node.containerWidget.getHierarchicalIndex(hierarchicalIndex);\n            }\n            else if (node.containerWidget instanceof BlockContainer) {\n                hierarchicalIndex = node.containerWidget.getHierarchicalIndex(hierarchicalIndex);\n            }\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getIndex = function () {\n        if (this instanceof ParagraphWidget || this instanceof TableWidget) {\n            return this.containerWidget.childWidgets.indexOf(this);\n        }\n        else if (this instanceof TableRowWidget) {\n            return this.ownerTable.childWidgets.indexOf(this);\n        }\n        else if (this instanceof TableCellWidget) {\n            return this.ownerRow.childWidgets.indexOf(this);\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getContainerWidth = function () {\n        if (this.isInsideTable) {\n            return this.associatedCell.cellFormat.cellWidth - (this.associatedCell.margin.left + this.associatedCell.margin.right);\n        }\n        else {\n            var bodyWidget = this.bodyWidget;\n            var sectionFormat = bodyWidget.sectionFormat;\n            return sectionFormat.pageWidth - (sectionFormat.leftMargin + sectionFormat.rightMargin);\n        }\n    };\n    return BlockWidget;\n}(Widget));\nexport { BlockWidget };\n/**\n * @private\n */\nvar ParagraphWidget = /** @class */ (function (_super) {\n    __extends(ParagraphWidget, _super);\n    /**\n     * Initialize the constructor of ParagraphWidget\n     */\n    function ParagraphWidget() {\n        var _this = _super.call(this) || this;\n        _this.paragraphFormat = new WParagraphFormat(_this);\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(ParagraphWidget.prototype, \"isEndsWithPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.childWidgets.length > 0) {\n                return this.lastChild.isEndsWithPageBreak;\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.equals = function (widget) {\n        return widget instanceof ParagraphWidget && widget.paragraphFormat === this.paragraphFormat;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.isEmpty = function () {\n        if (isNullOrUndefined(this.childWidgets) || this.childWidgets.length === 0) {\n            return true;\n        }\n        for (var j = 0; j < this.childWidgets.length; j++) {\n            var inlineElement = this.childWidgets[j];\n            for (var i = 0; i < inlineElement.children.length; i++) {\n                var inline = inlineElement.children[i];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox || inline instanceof BookmarkElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getInline = function (offset, indexInInline) {\n        var inline = undefined;\n        var count = 0;\n        var isStarted = false;\n        var splittedWidget = this.getSplitWidgets();\n        for (var k = 0; k < splittedWidget.length; k++) {\n            var widget = splittedWidget[k];\n            for (var j = 0; j < widget.childWidgets.length; j++) {\n                var line = widget.childWidgets[j];\n                for (var i = 0; i < line.children.length; i++) {\n                    inline = line.children[i];\n                    if (inline instanceof ListTextElementBox) {\n                        continue;\n                    }\n                    if (!isStarted && (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                        || inline instanceof BookmarkElementBox || inline instanceof FieldElementBox\n                        && HelperMethods.isLinkedFieldCharacter(inline))) {\n                        isStarted = true;\n                    }\n                    if (isStarted && offset <= count + inline.length) {\n                        indexInInline = (offset - count);\n                        return { 'element': inline, 'index': indexInInline };\n                    }\n                    count += inline.length;\n                }\n            }\n        }\n        if (offset > count) {\n            indexInInline = isNullOrUndefined(inline) ? offset : inline.length;\n        }\n        return { 'element': inline, 'index': indexInInline };\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getLength = function () {\n        var length = 0;\n        for (var j = 0; j < this.childWidgets.length; j++) {\n            var line = this.childWidgets[j];\n            for (var i = 0; i < line.children.length; i++) {\n                var element = line.children[i];\n                if (element instanceof ListTextElementBox) {\n                    continue;\n                }\n                length += element.length;\n            }\n        }\n        return length;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getTableCellWidget = function (point) {\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.clone = function () {\n        var paragraph = new ParagraphWidget();\n        paragraph.paragraphFormat.copyFormat(this.paragraphFormat);\n        paragraph.characterFormat.copyFormat(this.characterFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var line = this.childWidgets[i];\n            var cloneLine = line.clone();\n            paragraph.childWidgets.push(cloneLine);\n            cloneLine.paragraph = paragraph;\n        }\n        paragraph.x = this.x;\n        paragraph.y = this.y;\n        paragraph.height = this.height;\n        paragraph.width = this.width;\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                widget.destroy();\n                if (this.childWidgets.length === 1 && isNullOrUndefined(this.childWidgets[0].children)) {\n                    this.childWidgets = undefined;\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget) && !isNullOrUndefined(this.containerWidget.childWidgets)\n            && this.containerWidget.childWidgets.indexOf(this) !== -1) {\n            this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n            this.containerWidget.height -= height;\n            // if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n            //     && this.containerWidget instanceof BodyWidget) {\n            //     // (this.containerWidget as BodyWidget).destroyInternal(viewer);\n            // }\n            this.containerWidget = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.destroy = function () {\n        // if (this.paragraphFormat) {\n        //     this.paragraphFormat.destroy();\n        // }\n        this.paragraphFormat = undefined;\n        // if (this.characterFormat) {\n        //     this.characterFormat.destroy();\n        // }\n        this.characterFormat = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ParagraphWidget;\n}(BlockWidget));\nexport { ParagraphWidget };\n/**\n * @private\n */\nvar TableWidget = /** @class */ (function (_super) {\n    __extends(TableWidget, _super);\n    function TableWidget() {\n        var _this = _super.call(this) || this;\n        _this.flags = 0;\n        /**\n         * @private\n         */\n        _this.leftMargin = 0;\n        /**\n         * @private\n         */\n        _this.topMargin = 0;\n        /**\n         * @private\n         */\n        _this.rightMargin = 0;\n        /**\n         * @private\n         */\n        _this.bottomMargin = 0;\n        _this.margin = new Margin(_this.leftMargin, _this.topMargin, _this.rightMargin, _this.bottomMargin);\n        _this.leftBorderWidth = 0;\n        _this.rightBorderWidth = 0;\n        _this.topBorderWidth = 0;\n        _this.bottomBorderWidth = 0;\n        _this.tableFormat = new WTableFormat(_this);\n        _this.tableHolder = new WTableHolder();\n        _this.spannedRowCollection = new Dictionary();\n        return _this;\n    }\n    Object.defineProperty(TableWidget.prototype, \"isGridUpdated\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return ((this.flags & 0x4) >> 2) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFB) | ((value ? 1 : 0) << 2));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableWidget.prototype, \"continueHeader\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return ((this.flags & 0x2) >> 1) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFD) | ((value ? 1 : 0) << 1));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableWidget.prototype, \"header\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return (this.flags & 0x1) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFE) | (value ? 1 : 0));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableWidget.prototype.equals = function (widget) {\n        return widget instanceof TableWidget && widget.tableFormat === this.tableFormat;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.combineRows = function (viewer) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            if (row.childWidgets.length === 0) {\n                row.destroy();\n                i--;\n            }\n            else {\n                row.combineCells(viewer);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.contains = function (tableCell) {\n        if (this.equals(tableCell.ownerTable)) {\n            return true;\n        }\n        while (tableCell.ownerTable.isInsideTable) {\n            if (this.equals(tableCell.ownerTable)) {\n                return true;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return this.equals(tableCell.ownerTable);\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getOwnerWidth = function (isBasedOnViewer) {\n        var width = this.getContainerWidth();\n        // Left and right indents should be neglected.\n        width = width - this.leftIndent - this.rightIndent;\n        return width >= 0 ? width : 0;\n    };\n    TableWidget.prototype.getTableWidth = function () {\n        var width = 0;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var rowWidth = 0;\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                rowWidth += row.childWidgets[j].cellFormat.cellWidth;\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getTableClientWidth = function (clientWidth) {\n        var tableWidth = clientWidth;\n        if (this.tableFormat.preferredWidthType === 'Point'\n            && this.tableFormat.preferredWidth > 0) {\n            tableWidth = this.tableFormat.preferredWidth;\n        }\n        else {\n            if (this.tableFormat.preferredWidthType === 'Percent'\n                && this.tableFormat.preferredWidth > 0) {\n                tableWidth = tableWidth * this.tableFormat.preferredWidth / 100;\n            }\n            else {\n                //By default, if Table preferred widthType is auto , width is set based on ClientWidth and type is set as 'Point'\n                this.tableFormat.preferredWidthType = 'Point';\n                this.tableFormat.preferredWidth = tableWidth;\n            }\n        }\n        return tableWidth;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getCellWidth = function (preferredWidth, preferredWidthType, containerWidth, cell) {\n        var cellWidth = preferredWidth;\n        if (preferredWidthType === 'Percent') {\n            cellWidth = (preferredWidth * containerWidth) / 100;\n        }\n        else if (preferredWidthType === 'Point') {\n            cellWidth = preferredWidth;\n        }\n        // For grid before and grid after with auto width, no need to calculate minimum preferred width.\n        else if (!isNullOrUndefined(cell)) {\n            cellWidth = cell.getMinimumPreferredWidth();\n        }\n        return cellWidth;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.fitCellsToClientArea = function (clientWidth) {\n        var tableWidth = this.getTableWidth();\n        var factor = clientWidth / tableWidth;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            row.rowFormat.gridAfterWidth *= factor;\n            row.rowFormat.gridBeforeWidth *= factor;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                row.childWidgets[j].cellFormat.cellWidth *= factor;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getTableCellWidget = function (point) {\n        var tableCellWidget = undefined;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= point.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= point.y) {\n                tableCellWidget = this.childWidgets[i].getTableCellWidget(point);\n                break;\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    TableWidget.prototype.calculateGrid = function () {\n        var tempGrid = [];\n        var spannedCells = [];\n        var containerWidth = this.getOwnerWidth(true);\n        var tableWidth = this.getTableClientWidth(containerWidth);\n        this.tableCellInfo = new Dictionary();\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowCellInfo = new Dictionary();\n            var rowFormat = row.rowFormat;\n            var cellWidth = 0;\n            var columnSpan = row.rowFormat.gridBefore;\n            var currOffset = 0;\n            if (tempGrid.indexOf(currOffset) < 0) {\n                tempGrid.push(currOffset);\n            }\n            //Converts the row grid before width from point to twips point by 15 factor.\n            cellWidth = this.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, tableWidth, null);\n            currOffset += cellWidth;\n            var startOffset = Math.round(currOffset);\n            if (tempGrid.indexOf(startOffset) < 0) {\n                tempGrid.push(startOffset);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < spannedCells.length; k++) {\n                    if (spannedCells[k].columnIndex < columnSpan) {\n                        continue;\n                    }\n                    var rowSpan = spannedCells[k].cellFormat.rowSpan;\n                    var removeSpannedCell = true;\n                    if (spannedCells[k].columnIndex > columnSpan) {\n                        {\n                            removeSpannedCell = false;\n                            // If the cell is the last cell in the row and the row has grid after value..\n                            if (j === row.childWidgets.length - 1 && row.rowFormat.gridAfter > 0) {\n                                // tslint:disable-next-line:max-line-length\n                                cellWidth = this.getCellWidth(spannedCells[k].cellFormat.preferredWidth, spannedCells[k].cellFormat.preferredWidthType, tableWidth, null);\n                                currOffset += cellWidth;\n                            }\n                        }\n                    }\n                    else {\n                        // If the table gird alone calculted then column index of the rowspanned cell will be directly taken. \n                        // If the gird calculation is done from the UI level opearations such as resizing then table holder \n                        // will have the columns at that time we can get the column index from the table holder.\n                        //Converts the cell width from point to twips point by 15 factor.\n                        // tslint:disable-next-line:max-line-length\n                        cellWidth = this.getCellWidth(spannedCells[k].cellFormat.preferredWidth, spannedCells[k].cellFormat.preferredWidthType, tableWidth, null);\n                        currOffset += cellWidth;\n                        columnSpan = spannedCells[k].columnIndex + spannedCells[k].cellFormat.columnSpan;\n                    }\n                    if (!removeSpannedCell && j === row.childWidgets.length - 1) {\n                        removeSpannedCell = true;\n                    }\n                    if (removeSpannedCell && i - spannedCells[k].ownerRow.rowIndex === rowSpan - 1) {\n                        spannedCells.splice(k, 1);\n                        k--;\n                    }\n                }\n                // At the start of each row, we will process the row spanned cells to get the start column index.\n                // To calculate grid properly, we need the items in the spanned cells collection in the order of their column index\n                if (cell.cellFormat.rowSpan > 1) {\n                    if (spannedCells.length === 0 || spannedCells[spannedCells.length - 1].columnIndex <= columnSpan) {\n                        spannedCells.push(cell);\n                    }\n                    else {\n                        for (var m = spannedCells.length; m > 0; m--) {\n                            if (spannedCells[m - 1].columnIndex > columnSpan) {\n                                spannedCells.splice(m - 1, 0, cell);\n                            }\n                        }\n                    }\n                }\n                // Add start offset of each cell based on its index\n                if (!rowCellInfo.containsKey(cell.cellIndex)) {\n                    rowCellInfo.add(cell.cellIndex, Math.round(currOffset - startOffset));\n                }\n                columnSpan += cell.cellFormat.columnSpan;\n                //Converts the cell width from pixel to twips point by 15 factor.\n                cellWidth = this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, tableWidth, null);\n                currOffset += cellWidth;\n                var offset = Math.round(currOffset);\n                if (tempGrid.indexOf(offset) < 0) {\n                    tempGrid.push(offset);\n                }\n                if (j === row.childWidgets.length - 1 && rowFormat.gridAfter > 0) {\n                    cellWidth = this.getCellWidth(rowFormat.gridAfterWidth, 'Point', tableWidth, null);\n                    currOffset += cellWidth;\n                    if (tempGrid.indexOf(Math.round(currOffset)) < 0) {\n                        tempGrid.push(Math.round(currOffset));\n                    }\n                    columnSpan += rowFormat.gridAfter;\n                }\n                // Add rowindex and its cells info for each row\n                if (!this.tableCellInfo.containsKey(row.rowIndex)) {\n                    this.tableCellInfo.add(row.rowIndex, rowCellInfo);\n                }\n            }\n        }\n        tempGrid.sort(function (a, b) { return a - b; });\n        if (tempGrid.length - 1 !== this.tableHolder.columns.length) {\n            this.updateColumnSpans(tempGrid, tableWidth);\n        }\n        this.tableCellInfo.clear();\n        this.tableCellInfo = undefined;\n    };\n    TableWidget.prototype.updateColumnSpans = function (tempGrid, containerWidth) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            if (row.rowFormat.gridBeforeWidth >= 0) {\n                row.rowFormat.gridBefore = row.getGridCount(tempGrid, undefined, -1, containerWidth);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var columnSpan = row.getGridCount(tempGrid, cell, cell.getIndex(), containerWidth);\n                if (columnSpan > 0 && cell.cellFormat.columnSpan !== columnSpan) {\n                    cell.cellFormat.columnSpan = columnSpan;\n                }\n            }\n            if (row.rowFormat.gridAfterWidth >= 0) {\n                row.rowFormat.gridAfter = row.getGridCount(tempGrid, undefined, row.childWidgets.length, containerWidth);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.buildTableColumns = function () {\n        if (this.isGridUpdated) {\n            return;\n        }\n        // Clear existing columns in order to start creating columns freshly.\n        this.tableHolder.resetColumns();\n        var containerWidth = 0;\n        var tableWidth = 0;\n        var rowSpannedCells = [];\n        var isAutoWidth = this.tableFormat.preferredWidthType === 'Auto';\n        // For continuous layout, window width should be considered. \n        // If preferred width exceeds this limit, it can take upto maximum of 2112 pixels (1584 points will be assigned by Microsoft Word).\n        containerWidth = this.getOwnerWidth(true);\n        tableWidth = this.getTableClientWidth(containerWidth);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowFormat = row.rowFormat;\n            var columnSpan = 0;\n            var cellWidth = 0;\n            var offset = 0;\n            if (rowFormat.gridBefore > 0) {\n                cellWidth = this.getCellWidth(rowFormat.gridBeforeWidth, row.rowFormat.gridAfterWidthType, tableWidth, null);\n                this.tableHolder.addColumns(columnSpan, columnSpan = rowFormat.gridBefore, cellWidth, cellWidth, offset = cellWidth);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                if (rowSpannedCells.length === 0) {\n                    cell.columnIndex = columnSpan;\n                }\n                for (var k = 0; k < rowSpannedCells.length; k++) {\n                    var rowSpannedCell = rowSpannedCells[k];\n                    if (rowSpannedCell.columnIndex < columnSpan) {\n                        cell.columnIndex = columnSpan;\n                        continue;\n                    }\n                    var rowSpan = 1;\n                    var removeSpannedCell = true;\n                    rowSpan = rowSpannedCell.cellFormat.rowSpan;\n                    if (rowSpannedCell.columnIndex > columnSpan) {\n                        cell.columnIndex = columnSpan;\n                        removeSpannedCell = false;\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        cellWidth = this.getCellWidth(rowSpannedCell.cellFormat.preferredWidth, rowSpannedCell.cellFormat.preferredWidthType, tableWidth, rowSpannedCell);\n                        var minWidth_1 = rowSpannedCell.getMinimumPreferredWidth();\n                        // If the table gird alone calculted then column index of the rowspanned cell will be directly taken. \n                        // tslint:disable-next-line:max-line-length\n                        // If the gird calculation is done from the UI level opearations such as resizing then table holder will have the columns at that time we can get the column index from the table holder.\n                        // tslint:disable-next-line:max-line-length\n                        if (this.tableHolder.columns.length > 0) {\n                            this.tableHolder.addColumns(columnSpan, columnSpan = this.tableHolder.columns.indexOf(rowSpannedCell.ownerColumn) + rowSpannedCell.cellFormat.columnSpan, cellWidth, minWidth_1, offset += cellWidth);\n                            cell.columnIndex = columnSpan;\n                        }\n                        else {\n                            // tslint:disable-next-line:max-line-length\n                            this.tableHolder.addColumns(columnSpan, columnSpan = rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan, cellWidth, minWidth_1, offset += cellWidth);\n                            cell.columnIndex = columnSpan;\n                        }\n                    }\n                    if (!removeSpannedCell && j === row.childWidgets.length - 1) {\n                        removeSpannedCell = true;\n                    }\n                    if (removeSpannedCell && i - rowSpannedCell.ownerRow.rowIndex === rowSpan - 1) {\n                        rowSpannedCells.splice(k, 1);\n                        k--;\n                    }\n                }\n                // At the start of each row, we will process the row spanned cells to get the start column index.\n                // To calculate grid properly, we need the items in the spanned cells collection in the order of their column index\n                if (cell.cellFormat.rowSpan > 1) {\n                    if (rowSpannedCells.length === 0 || rowSpannedCells[rowSpannedCells.length - 1].columnIndex <= columnSpan) {\n                        rowSpannedCells.push(cell);\n                    }\n                    else {\n                        for (var m = rowSpannedCells.length; m > 0; m--) {\n                            if (rowSpannedCells[m - 1].columnIndex > columnSpan) {\n                                rowSpannedCells.splice(m - 1, 0, cell);\n                            }\n                        }\n                    }\n                }\n                cellWidth = this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, tableWidth, cell);\n                var minWidth = cell.getMinimumPreferredWidth();\n                this.tableHolder.addColumns(columnSpan, columnSpan += cell.cellFormat.columnSpan, cellWidth, minWidth, offset += cellWidth);\n                if (j === row.childWidgets.length - 1 && rowFormat.gridAfterWidth > 0) {\n                    cellWidth = this.getCellWidth(rowFormat.gridAfterWidth, 'Point', tableWidth, null);\n                    this.tableHolder.addColumns(columnSpan, columnSpan += rowFormat.gridAfter, cellWidth, cellWidth, offset += cellWidth);\n                }\n            }\n        }\n        this.tableHolder.validateColumnWidths();\n        // Fits the column width based on preferred width. i.e. Fixed layout.\n        this.tableHolder.fitColumns(containerWidth, tableWidth, isAutoWidth);\n        //Sets the width to cells\n        this.setWidthToCells(tableWidth, isAutoWidth);\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.setWidthToCells = function (tableWidth, isAutoWidth) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var rw = this.childWidgets[i];\n            var rowFormat = rw.rowFormat;\n            if (rowFormat.gridBefore > 0) {\n                rowFormat.beforeWidth = this.tableHolder.getCellWidth(0, rowFormat.gridBefore, tableWidth, isAutoWidth);\n            }\n            for (var j = 0; j < rw.childWidgets.length; j++) {\n                var cell = rw.childWidgets[j];\n                // tslint:disable-next-line:max-line-length\n                cell.cellFormat.cellWidth = this.tableHolder.getCellWidth(cell.columnIndex, cell.cellFormat.columnSpan, tableWidth, isAutoWidth);\n                //By default, if cell preferred widthType is auto , width set based on table width and type is changed to 'Point'\n                if (cell.cellFormat.preferredWidthType !== 'Percent') {\n                    cell.cellFormat.preferredWidth = cell.cellFormat.cellWidth;\n                    cell.cellFormat.preferredWidthType = 'Point';\n                }\n            }\n            if (rowFormat.gridAfter > 0) {\n                rowFormat.afterWidth = this.tableHolder.getCellWidth(0, rowFormat.gridAfter, tableWidth, isAutoWidth);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getMaxRowWidth = function (clientWidth) {\n        var width = 0;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowWidth = 0;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                rowWidth += this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, clientWidth, cell);\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.updateWidth = function (dragValue) {\n        var totalPreferredWidth = this.tableHolder.getTotalWidth();\n        var containerWidth = this.getTableClientWidth(this.getOwnerWidth(true));\n        if (containerWidth <= totalPreferredWidth) {\n            if (this.tableFormat.preferredWidthType === 'Auto') {\n                this.tableFormat.preferredWidthType = 'Point';\n            }\n        }\n        if (this.tableFormat.preferredWidthType !== 'Auto') {\n            if (this.tableFormat.preferredWidthType === 'Point') {\n                this.tableFormat.preferredWidth = this.getMaxRowWidth(containerWidth);\n            }\n            // else\n            // {   //ToDo:Need to anzlyze more the Percentage calculation for table width.\n            //     let value:number = ConvertPixelToPercent(GetMaxRowWidth(containerWidth));\n            //     this.tableFormat.preferredWidth = value;\n            // }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.convertPointToPercent = function (tablePreferredWidth, ownerWidth) {\n        var value = 0;\n        value = (tablePreferredWidth / ownerWidth) * 100;\n        value = Math.round(value);\n        return value < 100 ? value : 100; // The value should be lesser than or equal to 100%;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.clone = function () {\n        var table = new TableWidget();\n        table.tableHolder = this.tableHolder.clone();\n        table.tableFormat.copyFormat(this.tableFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i].clone();\n            table.childWidgets.push(row);\n            row.containerWidget = table;\n            row.index = i;\n        }\n        table.x = this.x;\n        table.y = this.y;\n        table.height = this.height;\n        table.width = this.width;\n        table.containerWidget = this.containerWidget;\n        return table;\n    };\n    /**\n     * @private\n     */\n    TableWidget.getTableOf = function (node) {\n        if (node instanceof WBorders) {\n            var row = TableRowWidget.getRowOf(node);\n            if (!isNullOrUndefined(row)) {\n                return row.ownerTable;\n            }\n            else if (node.ownerBase instanceof WTableFormat && node.ownerBase.ownerBase instanceof TableWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.fitChildToClientArea = function () {\n        var clientWidth = this.getContainerWidth();\n        if (Math.round(clientWidth) < Math.round(this.getTableWidth())) {\n            this.fitCellsToClientArea(clientWidth);\n        }\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < cell.childWidgets.length; k++) {\n                    if (cell.childWidgets[k] instanceof TableWidget) {\n                        cell.childWidgets[k].fitChildToClientArea();\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getColumnCellsForSelection = function (startCell, endCell) {\n        var cells = [];\n        var start = startCell.columnIndex;\n        var end = endCell.columnIndex + endCell.cellFormat.columnSpan;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var columnIndex = cell.columnIndex;\n                var columnSpan = cell.cellFormat.columnSpan;\n                if ((columnIndex + columnSpan > start && columnIndex + columnSpan < end) || (columnIndex > start && columnIndex < end)) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n                else if ((columnIndex > start && columnIndex < end && columnIndex + columnSpan < end)\n                    || (columnIndex < start && columnIndex + columnSpan > end)) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n                else if (columnIndex === start || columnIndex + columnSpan === end) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * Splits width equally for all the cells.\n     * @param tableClientWidth\n     * @private\n     */\n    TableWidget.prototype.splitWidthToTableCells = function (tableClientWidth) {\n        for (var row = 0; row < this.childWidgets.length; row++) {\n            this.childWidgets[row].splitWidthToRowCells(tableClientWidth);\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.insertTableRowsInternal = function (tableRows, startIndex) {\n        for (var i = 0; i < tableRows.length; i++) {\n            var row = tableRows.splice(i, 1)[0];\n            row.containerWidget = this;\n            this.childWidgets.splice(startIndex, 0, row);\n            i--;\n        }\n        this.updateRowIndex(startIndex);\n        this.isGridUpdated = false;\n        this.buildTableColumns();\n        this.isGridUpdated = true;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.updateRowIndex = function (startIndex) {\n        for (var i = startIndex; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            row.index = i;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                row.childWidgets[j].index = j;\n                row.childWidgets[j].rowIndex = row.rowIndex;\n            }\n            startIndex++;\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getCellStartOffset = function (cell) {\n        var offset = 0;\n        if (cell && this.tableCellInfo) {\n            if (this.tableCellInfo.containsKey(cell.ownerRow.rowIndex)) {\n                var rowCellInfo = this.tableCellInfo.get(cell.ownerRow.rowIndex);\n                if (rowCellInfo.containsKey(cell.cellIndex)) {\n                    offset = rowCellInfo.get(cell.cellIndex);\n                }\n            }\n        }\n        return offset;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var j = 0; j < this.childWidgets.length; j++) {\n                var widget = undefined;\n                var childWidget = this.childWidgets[j];\n                widget = childWidget;\n                if (!isNullOrUndefined(widget)) {\n                    widget.destroyInternal(viewer);\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                j--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget)) {\n            if (!isNullOrUndefined(this.containerWidget.childWidgets)) {\n                if (this.containerWidget.childWidgets.indexOf(this) !== -1) {\n                    this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n                }\n                this.containerWidget.height -= height;\n                // if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n                //     && this.containerWidget instanceof BodyWidget) {\n                //     // (this.containerWidget as BodyWidget).destroyInternal(viewer);\n                // }\n            }\n            this.containerWidget = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.destroy = function () {\n        // if (this.tableFormat) {\n        //     this.tableFormat.destroy();\n        // }\n        this.tableFormat = undefined;\n        // if (this.spannedRowCollection) {\n        //     this.spannedRowCollection.destroy();\n        // }\n        this.spannedRowCollection = undefined;\n        this.tableGrids = [];\n        this.tableGrids = undefined;\n        // if (this.tableHolder) {\n        //     this.tableHolder.destroy();\n        // }\n        this.tableHolder = undefined;\n        this.flags = undefined;\n        this.leftMargin = undefined;\n        this.topMargin = undefined;\n        this.rightMargin = undefined;\n        this.bottomMargin = undefined;\n        this.headerHeight = undefined;\n        this.description = undefined;\n        this.title = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableWidget;\n}(BlockWidget));\nexport { TableWidget };\n/**\n * @private\n */\nvar TableRowWidget = /** @class */ (function (_super) {\n    __extends(TableRowWidget, _super);\n    function TableRowWidget() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.spannedRowCollection = [];\n        _this.topBorderWidth = 0;\n        _this.bottomBorderWidth = 0;\n        _this.rowFormat = new WRowFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(TableRowWidget.prototype, \"rowIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget) {\n                return this.containerWidget.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableRowWidget.prototype, \"ownerTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableWidget) {\n                return this.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableRowWidget.prototype, \"nextRow\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > -1 && index < this.ownerTable.childWidgets.length - 1) {\n                return this.ownerTable.childWidgets[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.equals = function (widget) {\n        return widget instanceof TableRowWidget && widget.rowFormat === this.rowFormat;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.combineCells = function (viewer) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i];\n            cell.combineWidget(viewer);\n            if (cell.cellFormat.rowSpan === 1) {\n                var cellHeight = cell.height + cell.margin.top + cell.margin.bottom;\n                if ((this.height - this.ownerTable.tableFormat.cellSpacing) < cell.height) {\n                    this.height = this.ownerTable.tableFormat.cellSpacing + cell.height;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.getRowOf = function (node) {\n        if (node instanceof WBorders) {\n            var cell = TableCellWidget.getCellOf(node);\n            if (!isNullOrUndefined(cell)) {\n                return cell.ownerRow;\n            }\n            else if (node.ownerBase instanceof WRowFormat && node.ownerBase.ownerBase instanceof TableRowWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getCell = function (rowIndex, cellIndex) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i];\n            if (cell.rowIndex === rowIndex && cell.index === cellIndex) {\n                return cell;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.splitWidthToRowCells = function (tableClientWidth) {\n        var cells = this.childWidgets;\n        var cellWidth = tableClientWidth / cells.length;\n        for (var cell = 0; cell < cells.length; cell++) {\n            cells[cell].cellFormat.preferredWidth = cellWidth;\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getGridCount = function (tableGrid, cell, index, containerWidth) {\n        var prevOffset = 0;\n        var width = 0;\n        var ownerTable = this.ownerTable;\n        var rowFormat = this.rowFormat;\n        if (index === -1) {\n            width = ownerTable.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, containerWidth, null);\n        }\n        else {\n            prevOffset += ownerTable.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, containerWidth, null);\n            if (index >= 0) {\n                prevOffset += ownerTable.getCellStartOffset(cell);\n            }\n            if (index < this.childWidgets.length) {\n                width = ownerTable.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, containerWidth, null);\n            }\n            else {\n                width = ownerTable.getCellWidth(rowFormat.gridAfterWidth, rowFormat.gridAfterWidthType, containerWidth, null);\n            }\n        }\n        var gridStartIndex = this.getOffsetIndex(tableGrid, prevOffset);\n        var gridEndIndex = this.getOffsetIndex(tableGrid, prevOffset + width);\n        return gridEndIndex - gridStartIndex;\n    };\n    TableRowWidget.prototype.getOffsetIndex = function (tableGrid, offset) {\n        offset = Math.round(offset);\n        var index = 0;\n        if (tableGrid.indexOf(offset) >= 0) {\n            index = tableGrid.indexOf(offset);\n        }\n        else {\n            for (var i = 0; i < tableGrid.length; i++) {\n                if (tableGrid[i] > offset) {\n                    return i;\n                }\n            }\n            index = tableGrid.length - 1;\n        }\n        return index;\n    };\n    TableRowWidget.prototype.getCellOffset = function (index, containerWidth) {\n        var prevOffset = 0;\n        var ownerTable = this.ownerTable;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cellFormat = this.childWidgets[i].cellFormat;\n            if (i === index) {\n                break;\n            }\n            prevOffset += ownerTable.getCellWidth(cellFormat.preferredWidth, cellFormat.preferredWidthType, containerWidth, null);\n        }\n        return prevOffset;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.updateRowBySpannedCells = function () {\n        var rowSpannedCells = this.getPreviousRowSpannedCells();\n        var currentRowIndex = this.rowIndex;\n        for (var i = 0; i < rowSpannedCells.length; i++) {\n            var spannedCell = rowSpannedCells[i];\n            var rowSpanEnd = spannedCell.ownerRow.rowIndex + spannedCell.cellFormat.rowSpan - 1;\n            // If current row is row span end or includes spanned cells. then, decrease the rowspan\n            if (rowSpanEnd >= currentRowIndex) {\n                spannedCell.cellFormat.rowSpan -= 1;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getPreviousRowSpannedCells = function (include) {\n        var rowSpannedCells = [];\n        var row = include ? this : this.previousWidget;\n        while (!isNullOrUndefined(row)) {\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                var cell = row.childWidgets[i];\n                if (cell.cellFormat.rowSpan > 1) {\n                    rowSpannedCells.splice(0, 0, cell);\n                }\n            }\n            row = row.previousWidget;\n        }\n        return rowSpannedCells;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getTableCellWidget = function (point) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var x = Math.round(this.childWidgets[i].x);\n            if (x - this.childWidgets[i].margin.left - 1 <= point.x\n                && (x + this.childWidgets[i].width) >= point.x) {\n                return this.childWidgets[i];\n            }\n            else if (i === this.childWidgets.length - 1\n                && (this.childWidgets[i].x + this.childWidgets[i].width) + 1 <= point.x) {\n                return this.childWidgets[i];\n            }\n        }\n        var cellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].x <= point.x) {\n                cellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(point);\n            }\n            else {\n                cellWidget = this.childWidgets[0].getTableCellWidget(point);\n            }\n        }\n        return cellWidget;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                widget.destroyInternal(viewer);\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget)) {\n            if (!isNullOrUndefined(this.containerWidget.childWidgets)) {\n                this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n                if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n                    && this.containerWidget instanceof TableWidget) {\n                    this.containerWidget.destroyInternal(viewer);\n                }\n                else if (this.containerWidget.containerWidget instanceof BodyWidget) {\n                    this.containerWidget.containerWidget.height -= height;\n                }\n                this.containerWidget.height -= height;\n            }\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.clone = function () {\n        var row = new TableRowWidget();\n        row.rowFormat.copyFormat(this.rowFormat);\n        row.topBorderWidth = this.topBorderWidth;\n        row.bottomBorderWidth = this.bottomBorderWidth;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i].clone();\n            row.childWidgets.push(cell);\n            cell.containerWidget = row;\n            cell.index = i;\n            cell.rowIndex = this.rowIndex;\n        }\n        row.x = this.x;\n        row.y = this.y;\n        row.height = this.height;\n        row.width = this.width;\n        return row;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.destroy = function () {\n        // if (this.rowFormat) {\n        //     this.rowFormat.destroy();\n        // }\n        this.rowFormat = undefined;\n        this.rowFormat = undefined;\n        this.spannedRowCollection = [];\n        this.spannedRowCollection = undefined;\n        this.topBorderWidth = undefined;\n        this.bottomBorderWidth = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableRowWidget;\n}(BlockWidget));\nexport { TableRowWidget };\n/**\n * @private\n */\nvar TableCellWidget = /** @class */ (function (_super) {\n    __extends(TableCellWidget, _super);\n    function TableCellWidget() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.rowIndex = -1;\n        _this.margin = new Margin(_this.leftMargin, _this.topMargin, _this.rightMargin, _this.bottomMargin);\n        _this.leftBorderWidth = 0;\n        _this.rightBorderWidth = 0;\n        _this.cellFormat = new WCellFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(TableCellWidget.prototype, \"ownerColumn\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerTable.tableHolder.columns[this.columnIndex];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"leftMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.leftMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.leftMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"topMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.topMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.topMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"rightMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.rightMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.rightMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"bottomMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.bottomMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.bottomMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"cellIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.ownerRow) {\n                return this.ownerRow.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"ownerTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableRowWidget) {\n                return this.containerWidget.ownerTable;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"ownerRow\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.containerWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.equals = function (widget) {\n        return widget instanceof TableCellWidget && widget.cellFormat === this.cellFormat;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getContainerTable = function () {\n        var table = this.ownerTable;\n        while (table instanceof TableWidget && table.associatedCell instanceof TableCellWidget) {\n            table = table.associatedCell.getContainerTable();\n        }\n        return table;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousSplitWidget = function () {\n        if (this.containerWidget instanceof TableRowWidget) {\n            var row = this.containerWidget;\n            do {\n                row = row.previousRenderedWidget;\n                if (isNullOrUndefined(row) || row.index < this.rowIndex) {\n                    break;\n                }\n                var previousCell = row.getCell(this.rowIndex, this.index);\n                if (previousCell && this.equals(previousCell)) {\n                    return previousCell;\n                }\n            } while (row);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getNextSplitWidget = function () {\n        var rowSpan = this.cellFormat.rowSpan;\n        if (this.containerWidget instanceof TableRowWidget) {\n            var row = this.containerWidget;\n            do {\n                row = row.nextRenderedWidget;\n                if (isNullOrUndefined(row) || row.index > this.rowIndex + rowSpan) {\n                    break;\n                }\n                var nextCell = row.getCell(this.rowIndex, this.index);\n                if (nextCell && this.equals(nextCell)) {\n                    return nextCell;\n                }\n            } while (row);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getTableCellWidget = function (point) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= point.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= point.y) {\n                return this.childWidgets[i].getTableCellWidget(point);\n            }\n        }\n        var tableCellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].y <= point.y) {\n                tableCellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(point);\n            }\n            else {\n                tableCellWidget = this.childWidgets[0].getTableCellWidget(point);\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.updateWidth = function (preferredWidth) {\n        if (this.cellFormat.preferredWidthType === 'Auto') {\n            this.cellFormat.preferredWidth = preferredWidth;\n            this.cellFormat.preferredWidthType = 'Point';\n        }\n        else if (this.cellFormat.preferredWidthType === 'Point') {\n            this.cellFormat.preferredWidth = preferredWidth;\n        }\n        else if (this.cellFormat.preferredWidthType === 'Percent') {\n            this.cellFormat.preferredWidth = this.convertPointToPercent(preferredWidth);\n        }\n        this.cellFormat.cellWidth = preferredWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.convertPointToPercent = function (cellPreferredWidth) {\n        var value = 0;\n        var clientWidth = this.ownerTable.getOwnerWidth(true);\n        var tableWidth = this.ownerTable.getTableClientWidth(clientWidth);\n        value = (cellPreferredWidth / tableWidth) * 100;\n        value = Math.round(value);\n        return value < 100 ? value : 100; // The value should be lesser than or equal to 100%;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellLeftBorder = function (tableCell) {\n        var leftBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.left)) {\n            leftBorder = cellBorder.left;\n        }\n        if (isNullOrUndefined(leftBorder)) {\n            leftBorder = tableCell.getLeftBorderToRenderByHierarchy(leftBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            leftBorder = tableCell.getLeftBorderToRenderByHierarchy(leftBorder, rowBorders, tableBorders);\n        }\n        else {\n            var prevCell = undefined;\n            if (!isNullOrUndefined(tableCell.previousWidget)) {\n                // if the border is shared then choose the border based on Conflict Resolution algorithm.\n                prevCell = tableCell.previousWidget;\n            }\n            else if ((tableCell.cellFormat.columnSpan > 1 || tableCell.columnIndex > 1) && tableCell.ownerRow.rowIndex > 0) {\n                var previousRow = tableCell.ownerRow.previousWidget;\n                while (!isNullOrUndefined(previousRow) && previousRow.childWidgets.length > 0) {\n                    for (var i = 0; i < previousRow.childWidgets.length; i++) {\n                        var prevRowCell = previousRow.childWidgets[i];\n                        if (prevRowCell.columnIndex + prevRowCell.cellFormat.columnSpan === tableCell.columnIndex) {\n                            prevCell = previousRow.childWidgets[i];\n                            break;\n                        }\n                    }\n                    if (!isNullOrUndefined(prevCell)) {\n                        break;\n                    }\n                    previousRow = previousRow.previousWidget;\n                }\n            }\n            leftBorder = tableCell.getPreviousCellLeftBorder(leftBorder, prevCell);\n        }\n        if (isNullOrUndefined(leftBorder)) {\n            leftBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return leftBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getLeftBorderWidth = function () {\n        var borderWidth = 0;\n        //let ownerTable = this.ownerTable;\n        //Added null condition check for asynchronous loading.\n        // if (this.cellFormat !== null && this.cellFormat.borders !== null) {\n        // update the margins values respect to layouting of borders.\n        //For normal table cells only left border is rendred. for last cell left and right border is rendred.\n        // this border widths are not included in margins.\n        //     boderWidth = this.cellFormat.borders.GetRightBorderToRender(this).GetLineWidth();\n        //need to render rightBorder specifically for all the cells when the cellSpacing is greater than zero or for last cell of each row.\n        // }\n        return borderWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getRightBorderWidth = function () {\n        var borderWidth = 0;\n        var ownerTable = this.ownerTable;\n        //Added null condition check for asynchronous loading.\n        // if (this.cellFormat !== null && this.cellFormat.borders !== null) {\n        ///need to render right border specifically for all the cells when the cell spacing is \n        //greater than zero or for last cell of each row.\n        //     let isLastCell: boolean = false;\n        //     isLastCell = this.cellIndex === 0;\n        //     if (ownerTable.tableFormat.cellSpacing > 0 || isLastCell) {\n        //         boderWidth = this.cellFormat.borders.getLeftBorderToRender(this).GetLineWidth();\n        //     }\n        // }\n        return borderWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getCellSpacing = function () {\n        var actualCellSpacing = this.ownerTable && this.ownerTable.tableFormat ? this.ownerTable.tableFormat.cellSpacing : 0;\n        var cellSpacingToLayout = actualCellSpacing;\n        // Considers the left, right margins and border widths(only available for Layouted table) for Minimum width.\n        if (this.ownerRow.childWidgets.length === 1) {\n            cellSpacingToLayout = actualCellSpacing * 2;\n        }\n        else if (this.cellIndex === 0 || this.cellIndex === this.ownerRow.childWidgets.length - 1) {\n            cellSpacingToLayout = actualCellSpacing + (actualCellSpacing / 2);\n        }\n        else {\n            cellSpacingToLayout = actualCellSpacing;\n        }\n        return cellSpacingToLayout;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getMinimumPreferredWidth = function () {\n        var defaultWidth = 0;\n        defaultWidth = this.leftMargin + this.rightMargin + this.getLeftBorderWidth() + this.getRightBorderWidth() + this.getCellSpacing();\n        return defaultWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousCellLeftBorder = function (leftBorder, previousCell) {\n        // tslint:disable-next-line:max-line-length\n        if ((isNullOrUndefined(previousCell) || (!isNullOrUndefined(leftBorder) && (leftBorder.lineStyle === 'None' && !leftBorder.hasNoneStyle)))) {\n            if (!isNullOrUndefined(leftBorder) && !(leftBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getLeftBorderToRenderByHierarchy(leftBorder, TableRowWidget.getRowOf(leftBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(leftBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var prevCellRightBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(previousCell.cellFormat.borders) && !isNullOrUndefined(previousCell.cellFormat.borders.right) && previousCell.cellFormat.borders.right.lineStyle !== 'None') {\n                prevCellRightBorder = previousCell.cellFormat.borders.right;\n            }\n            if (!isNullOrUndefined(prevCellRightBorder) && prevCellRightBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(prevCellRightBorder, leftBorder);\n            }\n            else if (!isNullOrUndefined(leftBorder) && !(leftBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getLeftBorderToRenderByHierarchy(leftBorder, TableRowWidget.getRowOf(leftBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(leftBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return leftBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getBorderBasedOnPriority = function (border, adjacentBorder) {\n        // If the cell and its adjacent cell defined different borders then based on this algorithm the border choose to render.\n        // Reference link :https://msdn.microsoft.com/en-us/library/office/documentformat.openxml.wordprocessing.tablecellborders.aspx\n        if (isNullOrUndefined(border)) {\n            return adjacentBorder;\n        }\n        else if (isNullOrUndefined(adjacentBorder)) {\n            return border;\n        }\n        var borderWeight = border.getBorderWeight();\n        var adjacentBorderWeight = adjacentBorder.getBorderWeight();\n        //the border with higher wight  shall be displayed.\n        if (borderWeight === adjacentBorderWeight) {\n            //if the border is equal weight the based on the priority the border will be choosen to render.\n            var borderPriority = border.getPrecedence();\n            var adjacentBorderPriority = adjacentBorder.getPrecedence();\n            if (borderPriority === adjacentBorderPriority) {\n                //The color with the smaller brightness value shall be displayed.\n                var borderColInRGB = this.convertHexToRGB(border.color);\n                var R1 = borderColInRGB.r;\n                var G1 = borderColInRGB.g;\n                var B1 = borderColInRGB.b;\n                var adjacentBorderColInRGB = this.convertHexToRGB(adjacentBorder.color);\n                var R2 = adjacentBorderColInRGB.r;\n                var G2 = adjacentBorderColInRGB.g;\n                var B2 = adjacentBorderColInRGB.b;\n                var borderBrightness = (R1 + B1 + (2 * G1));\n                var adjacentBorderBrightness = (R2 + B2 + (2 * G2));\n                if (borderBrightness === adjacentBorderBrightness) {\n                    borderBrightness = (B1 + (2 * G1));\n                    adjacentBorderBrightness = (B2 + (2 * G2));\n                    if (borderBrightness === adjacentBorderBrightness) {\n                        if (G1 === G2) {\n                            return border;\n                        }\n                        else if (G1 > G2) {\n                            return adjacentBorder;\n                        }\n                        else {\n                            return border;\n                        }\n                    }\n                    else if (borderBrightness > adjacentBorderBrightness) {\n                        return adjacentBorder;\n                    }\n                    else {\n                        return border;\n                    }\n                }\n                else if (borderBrightness > adjacentBorderBrightness) {\n                    return adjacentBorder;\n                }\n                else {\n                    return border;\n                }\n            }\n            else if (borderPriority > adjacentBorderPriority) {\n                return border;\n            }\n            else {\n                return adjacentBorder;\n            }\n        }\n        else if (borderWeight > adjacentBorderWeight) {\n            return border;\n        }\n        else {\n            return adjacentBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getLeftBorderToRenderByHierarchy = function (leftBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(leftBorder) && (leftBorder.lineStyle !== 'None' || (leftBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(leftBorder.lineStyle === 'None' && leftBorder.lineWidth === 0 && leftBorder.color === '#000000')))) {\n            return leftBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(leftBorder) && (leftBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(leftBorder.ownerBase).columnIndex === 0) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.left)) {\n                leftBorder = tableBorders.left;\n            }\n            return leftBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.vertical) && rowBorders.vertical.lineStyle !== 'None') {\n            return leftBorder = rowBorders.vertical;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.vertical) && tableBorders.vertical.lineStyle !== 'None') {\n            return leftBorder = tableBorders.vertical;\n        }\n        else {\n            return leftBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellRightBorder = function (tableCell) {\n        var rightBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.right)) {\n            rightBorder = cellBorder.right;\n        }\n        if (isNullOrUndefined(rightBorder)) {\n            rightBorder = tableCell.getRightBorderToRenderByHierarchy(rightBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            rightBorder = tableCell.getRightBorderToRenderByHierarchy(rightBorder, rowBorders, tableBorders);\n        }\n        else {\n            var nextCell = undefined;\n            if (!isNullOrUndefined(tableCell.nextWidget)) {\n                nextCell = tableCell.nextWidget;\n            }\n            // if the border is shared then choose the border based on Conflict Resolution algorithm.\n            rightBorder = tableCell.getAdjacentCellRightBorder(rightBorder, nextCell);\n        }\n        if (isNullOrUndefined(rightBorder)) {\n            rightBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return rightBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getAdjacentCellRightBorder = function (rightBorder, nextCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(nextCell) || (!isNullOrUndefined(rightBorder) && (rightBorder.lineStyle === 'None' && !rightBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(rightBorder) && !(rightBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getRightBorderToRenderByHierarchy(rightBorder, TableRowWidget.getRowOf(rightBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(rightBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var nextCellLeftBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(nextCell.cellFormat.borders) && !isNullOrUndefined(nextCell.cellFormat.borders.left) && nextCell.cellFormat.borders.left.lineStyle !== 'None') {\n                nextCellLeftBorder = nextCell.cellFormat.borders.left;\n            }\n            if (!isNullOrUndefined(nextCellLeftBorder) && nextCellLeftBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(rightBorder, nextCellLeftBorder);\n            }\n            else if (!isNullOrUndefined(rightBorder) && !(rightBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getRightBorderToRenderByHierarchy(rightBorder, TableRowWidget.getRowOf(rightBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(rightBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return rightBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getRightBorderToRenderByHierarchy = function (rightBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(rightBorder) && (rightBorder.lineStyle !== 'None' || (rightBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(rightBorder.lineStyle === 'None' && rightBorder.lineWidth === 0 && rightBorder.color === '#000000')))) {\n            return rightBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(rightBorder) && (rightBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(rightBorder.ownerBase).columnIndex === TableCellWidget.getCellOf(rightBorder.ownerBase).ownerRow.childWidgets.length - 1) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.right)) {\n                rightBorder = tableBorders.right;\n            }\n            return rightBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.vertical) && rowBorders.vertical.lineStyle !== 'None') {\n            return rightBorder = rowBorders.vertical;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.vertical) && tableBorders.vertical.lineStyle !== 'None') {\n            return rightBorder = tableBorders.vertical;\n        }\n        else {\n            return rightBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellTopBorder = function (tableCell) {\n        var topBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.top)) {\n            topBorder = cellBorder.top;\n        }\n        if (isNullOrUndefined(topBorder)) {\n            topBorder = tableCell.getTopBorderToRenderByHierarchy(topBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            topBorder = tableCell.getTopBorderToRenderByHierarchy(topBorder, rowBorders, tableBorders);\n        }\n        else {\n            var prevTopCell = undefined;\n            //ToDo: Need to analyze more to get the previous cell.\n            var prevRow = tableCell.ownerRow.previousWidget;\n            while (!isNullOrUndefined(prevRow) && prevRow.childWidgets.length > 0) {\n                for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                    var prevRowCell = prevRow.childWidgets[i];\n                    if (prevRowCell.columnIndex + prevRowCell.cellFormat.columnSpan - 1 >= tableCell.columnIndex) {\n                        prevTopCell = prevRow.childWidgets[i];\n                        break;\n                    }\n                }\n                if (!isNullOrUndefined(prevTopCell)) {\n                    break;\n                }\n                prevRow = prevRow.previousWidget;\n                //If all the previous rows checked and the previous top cell is null\n                // then TableCell previus row matched column index cell is taken for border calculation.\n                if (isNullOrUndefined(prevRow) && isNullOrUndefined(prevTopCell)) {\n                    prevRow = tableCell.ownerRow.previousWidget;\n                    if (tableCell.columnIndex < prevRow.childWidgets.length) {\n                        for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                            var prevRowCell = prevRow.childWidgets[i];\n                            if (prevRowCell.columnIndex === tableCell.columnIndex) {\n                                prevTopCell = prevRow.childWidgets[i];\n                                break;\n                            }\n                        }\n                        //If table cell Column index is greater than previous row cells count then last cell is taken as previous top cell.\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        prevTopCell = tableCell.ownerRow.previousWidget.childWidgets[tableCell.ownerRow.previousWidget.childWidgets.length - 1];\n                    }\n                }\n            }\n            //If the border is shared then choose the border based on Conflict Resolution algorithm.\n            topBorder = tableCell.getPreviousCellTopBorder(topBorder, prevTopCell);\n        }\n        if (isNullOrUndefined(topBorder)) {\n            topBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return topBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousCellTopBorder = function (topBorder, previousTopCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(previousTopCell) || (!isNullOrUndefined(topBorder) && (topBorder.lineStyle === 'None' && !topBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(topBorder) && !(topBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getTopBorderToRenderByHierarchy(topBorder, TableRowWidget.getRowOf(topBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(topBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var prevTopCellBottomBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(previousTopCell.cellFormat.borders) && !isNullOrUndefined(previousTopCell.cellFormat.borders.bottom) && previousTopCell.cellFormat.borders.bottom.lineStyle !== 'None') {\n                prevTopCellBottomBorder = previousTopCell.cellFormat.borders.bottom;\n            }\n            if (!isNullOrUndefined(prevTopCellBottomBorder) && prevTopCellBottomBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(topBorder, prevTopCellBottomBorder);\n            }\n            else if (!isNullOrUndefined(topBorder) && !(topBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getTopBorderToRenderByHierarchy(topBorder, TableRowWidget.getRowOf(topBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(topBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return topBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getTopBorderToRenderByHierarchy = function (topBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(topBorder) && (topBorder.lineStyle !== 'None' || (topBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(topBorder.lineStyle === 'None' && topBorder.lineWidth === 0 && topBorder.color === '#000000')))) {\n            return topBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(topBorder) && (topBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(topBorder.ownerBase).ownerRow.rowIndex === 0) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.top)) {\n                topBorder = tableBorders.top;\n            }\n            return topBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.horizontal) && rowBorders.horizontal.lineStyle !== 'None') {\n            return topBorder = rowBorders.horizontal;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.horizontal) && tableBorders.horizontal.lineStyle !== 'None') {\n            return topBorder = tableBorders.horizontal;\n        }\n        else {\n            return topBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellBottomBorder = function (tableCell) {\n        var bottomBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.bottom)) {\n            bottomBorder = cellBorder.bottom;\n        }\n        if (isNullOrUndefined(bottomBorder)) {\n            // tslint:disable-next-line:max-line-length\n            bottomBorder = tableCell.getBottomBorderToRenderByHierarchy(bottomBorder, rowBorders, tableBorders); // select the left border based on heirarchy.\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            bottomBorder = tableCell.getBottomBorderToRenderByHierarchy(bottomBorder, rowBorders, tableBorders);\n        }\n        else {\n            var nextBottomCell = undefined;\n            var nextRow = tableCell.ownerRow.nextWidget;\n            if (!isNullOrUndefined(nextRow) && tableCell.columnIndex < nextRow.childWidgets.length) {\n                nextBottomCell = nextRow.childWidgets[tableCell.columnIndex];\n            }\n            //If the border is shared then choose the border based on Conflict Resolution algorithm.\n            bottomBorder = tableCell.getAdjacentCellBottomBorder(bottomBorder, nextBottomCell);\n        }\n        if (isNullOrUndefined(bottomBorder)) {\n            bottomBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return bottomBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getAdjacentCellBottomBorder = function (bottomBorder, nextBottomCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(nextBottomCell) || (!isNullOrUndefined(bottomBorder) && (bottomBorder.lineStyle === 'None' && !bottomBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(bottomBorder) && !(bottomBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getBottomBorderToRenderByHierarchy(bottomBorder, TableRowWidget.getRowOf(bottomBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(bottomBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var prevBottomCellTopBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(nextBottomCell.cellFormat.borders) && !isNullOrUndefined(nextBottomCell.cellFormat.borders.top) && nextBottomCell.cellFormat.borders.top.lineStyle !== 'None') {\n                prevBottomCellTopBorder = nextBottomCell.cellFormat.borders.top;\n            }\n            if (!isNullOrUndefined(prevBottomCellTopBorder) && prevBottomCellTopBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(bottomBorder, prevBottomCellTopBorder);\n            }\n            else if (!isNullOrUndefined(bottomBorder) && !(bottomBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getBottomBorderToRenderByHierarchy(bottomBorder, TableRowWidget.getRowOf(bottomBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(bottomBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return bottomBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getBottomBorderToRenderByHierarchy = function (bottomBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(bottomBorder) && (bottomBorder.lineStyle !== 'None' || (bottomBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(bottomBorder.lineStyle === 'None' && bottomBorder.lineWidth === 0 && bottomBorder.color === '#000000')))) {\n            return bottomBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(bottomBorder) && (bottomBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(bottomBorder.ownerBase).ownerRow.rowIndex + TableCellWidget.getCellOf(bottomBorder.ownerBase).cellFormat.rowSpan === TableCellWidget.getCellOf(bottomBorder.ownerBase).ownerTable.childWidgets.length) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.bottom)) {\n                bottomBorder = tableBorders.bottom;\n            }\n            return bottomBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.horizontal) && rowBorders.horizontal.lineStyle !== 'None') {\n            return bottomBorder = rowBorders.horizontal;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.horizontal) && tableBorders.horizontal.lineStyle !== 'None') {\n            return bottomBorder = tableBorders.horizontal;\n        }\n        else {\n            return bottomBorder;\n        }\n    };\n    TableCellWidget.prototype.convertHexToRGB = function (colorCode) {\n        if (colorCode) {\n            colorCode = colorCode.replace(/[^0-9A-â€Œâ€‹F]/gi, ''); // To remove # from color code string.\n            var colCodeNo = parseInt(colorCode, 16);\n            var r = (colCodeNo >> 16) & 255;\n            var g = (colCodeNo >> 8) & 255;\n            var b = colCodeNo & 255;\n            return { 'r': r, 'g': g, 'b': b };\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellOf = function (node) {\n        if (node instanceof WBorders) {\n            if (node.ownerBase instanceof WCellFormat && node.ownerBase.ownerBase instanceof TableCellWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.destroyInternal = function (viewer) {\n        // let viewer: LayoutViewer = undefined;\n        // let page: Page = this.getPage();\n        // if (!isNullOrUndefined(page ))\n        //     viewer = page.viewer;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                if (widget instanceof ParagraphWidget) {\n                    widget.destroyInternal(viewer);\n                }\n                else {\n                    widget.destroyInternal(viewer);\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.clone = function () {\n        var cell = new TableCellWidget();\n        cell.cellFormat.copyFormat(this.cellFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var block = this.childWidgets[i].clone();\n            cell.childWidgets.push(block);\n            block.containerWidget = cell;\n            block.index = i;\n        }\n        cell.leftBorderWidth = this.leftBorderWidth;\n        cell.rightBorderWidth = this.rightBorderWidth;\n        if (this.margin) {\n            cell.margin = this.margin.clone();\n        }\n        cell.columnIndex = this.columnIndex;\n        cell.x = this.x;\n        cell.y = this.y;\n        cell.height = this.height;\n        cell.width = this.width;\n        return cell;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.destroy = function () {\n        // if (this.cellFormat) {\n        //     this.cellFormat.destroy();\n        // }\n        this.cellFormat = undefined;\n        this.rowIndex = undefined;\n        this.columnIndex = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableCellWidget;\n}(BlockWidget));\nexport { TableCellWidget };\n/**\n * @private\n */\nvar LineWidget = /** @class */ (function () {\n    /**\n     * Initialize the constructor of LineWidget\n     */\n    function LineWidget(paragraphWidget) {\n        /**\n         * @private\n         */\n        this.children = [];\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        this.paragraph = paragraphWidget;\n    }\n    Object.defineProperty(LineWidget.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.paragraph && this.paragraph.childWidgets) {\n                return this.paragraph.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"nextLine\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var paragraph = this.paragraph;\n            var lineIndex = this.indexInOwner;\n            if (lineIndex <= paragraph.childWidgets.length - 2) {\n                return paragraph.childWidgets[lineIndex + 1];\n            }\n            else if (paragraph.nextSplitWidget) {\n                var line = paragraph.nextSplitWidget.firstChild;\n                if (line instanceof LineWidget && line.paragraph.equals(this.paragraph)) {\n                    return line;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"previousLine\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var paragraph = this.paragraph;\n            var lineIndex = this.indexInOwner;\n            var splitParagraph = paragraph.previousSplitWidget;\n            if (lineIndex > 0) {\n                return paragraph.childWidgets[lineIndex - 1];\n            }\n            else if (splitParagraph instanceof ParagraphWidget) {\n                var line = splitParagraph.lastChild;\n                if (line instanceof LineWidget && line.paragraph.equals(this.paragraph)) {\n                    return line;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"isEndsWithPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.children.length > 0) {\n                var lastElement = this.children[this.children.length - 1];\n                if (lastElement instanceof TextElementBox) {\n                    return lastElement.isPageBreak;\n                }\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    LineWidget.prototype.isFirstLine = function () {\n        var index = this.indexInOwner;\n        if (index > -1 && this.paragraph.previousSplitWidget === undefined) {\n            return index === 0;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.isLastLine = function () {\n        var index = this.indexInOwner;\n        if (index > -1 && this.paragraph.nextSplitWidget === undefined) {\n            return index === this.paragraph.childWidgets.length - 1;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getOffset = function (inline, index) {\n        if (isNullOrUndefined(inline)) {\n            return index;\n        }\n        var textIndex = index;\n        var line = inline.line;\n        var lineIndex = inline.line.paragraph.childWidgets.indexOf(inline.line);\n        for (var i = 0; i < line.children.length; i++) {\n            var inlineElement = line.children[i];\n            if (inline === inlineElement) {\n                break;\n            }\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            textIndex += inlineElement.length;\n        }\n        return textIndex;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getEndOffset = function () {\n        var startOffset = 0;\n        var count = 0;\n        for (var i = 0; i < this.children.length; i++) {\n            var inlineElement = this.children[i];\n            if (inlineElement.length === 0) {\n                continue;\n            }\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            if (inlineElement instanceof TextElementBox || inlineElement instanceof ImageElementBox\n                || inlineElement instanceof BookmarkElementBox || (inlineElement instanceof FieldElementBox\n                && HelperMethods.isLinkedFieldCharacter(inlineElement))) {\n                startOffset = count + inlineElement.length;\n            }\n            count += inlineElement.length;\n        }\n        return startOffset;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getInline = function (offset, indexInInline) {\n        var inlineElement = undefined;\n        var count = 0;\n        var isStarted = false;\n        if (this.children.length === 0) {\n            if (this.previousLine) {\n                var elementBox = this.previousLine.children[this.previousLine.children.length - 1];\n                if (elementBox instanceof TextElementBox && elementBox.text === '\\v') {\n                    inlineElement = this.previousLine.children[this.previousLine.children.length - 1];\n                    indexInInline = 1;\n                    return { 'element': inlineElement, 'index': indexInInline };\n                }\n            }\n        }\n        for (var i = 0; i < this.children.length; i++) {\n            inlineElement = this.children[i];\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            if (!isStarted && (inlineElement instanceof TextElementBox || inlineElement instanceof ImageElementBox\n                || inlineElement instanceof BookmarkElementBox\n                || inlineElement instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inlineElement))) {\n                isStarted = true;\n            }\n            if (isStarted && offset <= count + inlineElement.length) {\n                indexInInline = (offset - count);\n                return { 'element': inlineElement, 'index': indexInInline };\n            }\n            count += inlineElement.length;\n        }\n        if (offset > count) {\n            indexInInline = isNullOrUndefined(inlineElement) ? offset : inlineElement.length;\n        }\n        return { 'element': inlineElement, 'index': indexInInline };\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var node = this;\n        hierarchicalIndex = node.paragraph.childWidgets.indexOf(node) + ';' + hierarchicalIndex;\n        if (node.paragraph instanceof BlockWidget) {\n            return node.paragraph.getHierarchicalIndex(hierarchicalIndex);\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.clone = function () {\n        var line = new LineWidget(undefined);\n        for (var j = 0; j < this.children.length; j++) {\n            var element = this.children[j];\n            var clone = element.clone();\n            line.children.push(clone);\n            clone.line = line;\n        }\n        line.width = this.width;\n        line.height = this.height;\n        return line;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.children)) {\n            for (var i = 0; i < this.children.length; i++) {\n                this.children[i].destroy();\n            }\n            this.children = [];\n        }\n        this.children = undefined;\n        if (this.paragraph) {\n            this.paragraph.removeChild(this.indexInOwner);\n        }\n        this.paragraph = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n    };\n    return LineWidget;\n}());\nexport { LineWidget };\n/**\n * @private\n */\nvar ElementBox = /** @class */ (function () {\n    /**\n     * Initialize the constructor of ElementBox\n     */\n    function ElementBox() {\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        /**\n         * @private\n         */\n        this.margin = new Margin(0, 0, 0, 0);\n        /**\n         * @private\n         */\n        this.characterFormat = undefined;\n        this.characterFormat = new WCharacterFormat(this);\n        this.margin = new Margin(0, 0, 0, 0);\n    }\n    Object.defineProperty(ElementBox.prototype, \"isPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this instanceof TextElementBox) {\n                return this.text === '\\f';\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldCharacter = function (viewer) {\n        if (!(this instanceof FieldElementBox)) {\n            return;\n        }\n        if (this.fieldType === 0) {\n            var fieldBegin = this;\n            if (isNullOrUndefined(fieldBegin.fieldEnd)) {\n                this.linkFieldTraversingForward(this.line, fieldBegin, fieldBegin);\n                if (viewer.fields.indexOf(fieldBegin) === -1) {\n                    viewer.fields.push(fieldBegin);\n                }\n            }\n        }\n        else if (this.fieldType === 2) {\n            var fieldSeparator = this;\n            //Links the field begin for the current separator.\n            if (isNullOrUndefined(fieldSeparator.fieldBegin)) {\n                this.linkFieldTraversingBackwardSeparator(this.line, fieldSeparator, fieldSeparator);\n            }\n            fieldSeparator.fieldBegin.fieldSeparator = fieldSeparator;\n            if (!isNullOrUndefined(fieldSeparator.fieldBegin)) {\n                //Links to field end traversing from field separator.\n                var isFieldEnd = this.linkFieldTraversingForward(this.line, fieldSeparator.fieldBegin, fieldSeparator);\n                if (isNullOrUndefined(fieldSeparator.fieldEnd) && isFieldEnd) {\n                    fieldSeparator.fieldEnd = fieldSeparator.fieldBegin.fieldEnd;\n                }\n                if (fieldSeparator.fieldEnd) {\n                    fieldSeparator.fieldEnd.fieldSeparator = fieldSeparator;\n                }\n            }\n        }\n        else {\n            var fieldEnd = this;\n            //Links the field begin and separator for the current end.\n            if (isNullOrUndefined(fieldEnd.fieldBegin)) {\n                this.linkFieldTraversingBackward(this.line, fieldEnd, fieldEnd);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingBackward = function (line, fieldEnd, previousNode) {\n        var k = line.children.length - 1;\n        if (line.children.indexOf(previousNode) > -1) {\n            k = line.children.indexOf(previousNode) - 1;\n        }\n        for (var j = k; j >= 0; j--) {\n            var childNode = line.children[j];\n            if (childNode instanceof FieldElementBox) {\n                if (childNode.fieldType === 0) {\n                    if (isNullOrUndefined(childNode.fieldEnd)) {\n                        fieldEnd.fieldBegin = childNode;\n                        if (isNullOrUndefined(childNode.fieldEnd)) {\n                            childNode.fieldEnd = fieldEnd;\n                        }\n                        if (fieldEnd.fieldSeparator && isNullOrUndefined(fieldEnd.fieldSeparator.fieldBegin)) {\n                            fieldEnd.fieldSeparator.fieldBegin = childNode;\n                            if (isNullOrUndefined(childNode.fieldSeparator)) {\n                                childNode.fieldSeparator = fieldEnd.fieldSeparator;\n                            }\n                        }\n                    }\n                    return !isNullOrUndefined(fieldEnd.fieldBegin);\n                }\n                else if (childNode.fieldType === 2 && isNullOrUndefined(childNode.fieldEnd)) {\n                    fieldEnd.fieldSeparator = childNode;\n                    childNode.fieldEnd = fieldEnd;\n                    if (!isNullOrUndefined(childNode.fieldBegin)) {\n                        fieldEnd.fieldBegin = childNode.fieldBegin;\n                    }\n                }\n            }\n        }\n        if (line.previousLine) {\n            this.linkFieldTraversingBackward(line.previousLine, fieldEnd, this);\n        }\n        else if (line.paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n            var prevParagraph = line.paragraph.previousRenderedWidget;\n            // tslint:disable-next-line:max-line-length\n            this.linkFieldTraversingBackward(prevParagraph.childWidgets[prevParagraph.childWidgets.length - 1], fieldEnd, this);\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingForward = function (line, fieldBegin, previousNode) {\n        var i = 0;\n        if (line.children.indexOf(previousNode) > -1) {\n            i = line.children.indexOf(previousNode) + 1;\n        }\n        for (var j = i; j < line.children.length; j++) {\n            var node = line.children[j];\n            if (node instanceof FieldElementBox) {\n                if (node.fieldType === 1) {\n                    if (isNullOrUndefined(node.fieldBegin)) {\n                        fieldBegin.fieldEnd = node;\n                    }\n                    if (fieldBegin.fieldEnd && isNullOrUndefined(fieldBegin.fieldEnd.fieldBegin)) {\n                        fieldBegin.fieldEnd.fieldBegin = fieldBegin;\n                    }\n                    return true;\n                }\n                else if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    if (node.fieldType === 2 && isNullOrUndefined(node.fieldBegin)) {\n                        fieldBegin.fieldSeparator = node;\n                        if (!isNullOrUndefined(node.fieldEnd)) {\n                            fieldBegin.fieldEnd = node.fieldEnd;\n                            return true;\n                        }\n                    }\n                    else {\n                        return false;\n                    }\n                }\n            }\n        }\n        if (line.nextLine) {\n            this.linkFieldTraversingForward(line.nextLine, fieldBegin, this);\n        }\n        else if (line.paragraph.nextRenderedWidget instanceof ParagraphWidget) {\n            this.linkFieldTraversingForward(line.paragraph.nextRenderedWidget.childWidgets[0], fieldBegin, this);\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingBackwardSeparator = function (line, fieldSeparator, previousNode) {\n        var index = line.children.length - 1;\n        if (line.children.indexOf(previousNode) > -1) {\n            index = line.children.indexOf(previousNode) - 1;\n        }\n        for (var i = index; i >= 0; i--) {\n            var childElement = line.children[i];\n            if (childElement instanceof FieldElementBox) {\n                if (childElement instanceof FieldElementBox && childElement.fieldType === 0) {\n                    if (isNullOrUndefined(childElement.fieldSeparator)) {\n                        fieldSeparator.fieldBegin = childElement;\n                    }\n                    return !isNullOrUndefined(fieldSeparator.fieldBegin);\n                }\n            }\n        }\n        if (line.previousLine) {\n            this.linkFieldTraversingBackwardSeparator(line.previousLine, fieldSeparator, this);\n        }\n        else if (line.paragraph.nextRenderedWidget instanceof ParagraphWidget) {\n            // tslint:disable-next-line:max-line-length\n            line = line.paragraph.previousRenderedWidget.childWidgets[line.paragraph.previousRenderedWidget.childWidgets.length - 1];\n            this.linkFieldTraversingBackwardSeparator(line, fieldSeparator, this);\n        }\n        else {\n            return true;\n        }\n        return true;\n    };\n    Object.defineProperty(ElementBox.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.getLength();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.line instanceof LineWidget && this.line.children ? this.line.children.indexOf(this) : -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"previousElement\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > 0 && index < this.line.children.length) {\n                return this.line.children[index - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"nextElement\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > -1 && index < this.line.children.length - 1) {\n                return this.line.children[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"nextNode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.line.children.indexOf(this);\n            var lineIndex = this.line.paragraph.childWidgets.indexOf(this.line);\n            if (index < this.line.children.length - 1) {\n                return this.line.children[index + 1];\n            }\n            else if (lineIndex < this.line.paragraph.childWidgets.length - 1) {\n                return this.line.paragraph.childWidgets[lineIndex + 1].children[0];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"previousNode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.line.children.indexOf(this);\n            var lineIndex = this.line.paragraph.childWidgets.indexOf(this.line);\n            if (index > 0) {\n                return this.line.children[index - 1];\n            }\n            else if (lineIndex > 0) {\n                var lineWidget = this.line.paragraph.childWidgets[lineIndex - 1];\n                return lineWidget.children[lineWidget.children.length - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"paragraph\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.line) {\n                return this.line.paragraph;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ElementBox.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.line) && this.line.children && this.line.children.indexOf(this) > -1) {\n            var index = this.line.children.indexOf(this);\n            this.line.children.splice(index, 1);\n        }\n        this.line = undefined;\n        if (this.characterFormat) {\n            this.characterFormat.destroy();\n        }\n        this.characterFormat = undefined;\n        if (this.margin) {\n            this.margin.destroy();\n        }\n        this.margin = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n    };\n    /**\n     * @private\n     */\n    ElementBox.objectCharacter = String.fromCharCode(65532);\n    return ElementBox;\n}());\nexport { ElementBox };\n/**\n * @private\n */\nvar FieldElementBox = /** @class */ (function (_super) {\n    __extends(FieldElementBox, _super);\n    function FieldElementBox(type) {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.fieldType = 0;\n        /**\n         * @private\n         */\n        _this.hasFieldEnd = false;\n        _this.fieldBeginInternal = undefined;\n        _this.fieldSeparatorInternal = undefined;\n        _this.fieldEndInternal = undefined;\n        _this.fieldType = type;\n        return _this;\n    }\n    Object.defineProperty(FieldElementBox.prototype, \"fieldBegin\", {\n        get: function () {\n            return this.fieldBeginInternal;\n        },\n        set: function (field) {\n            this.fieldBeginInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FieldElementBox.prototype, \"fieldSeparator\", {\n        get: function () {\n            return this.fieldSeparatorInternal;\n        },\n        set: function (field) {\n            this.fieldSeparatorInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FieldElementBox.prototype, \"fieldEnd\", {\n        get: function () {\n            return this.fieldEndInternal;\n        },\n        set: function (field) {\n            this.fieldEndInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.clone = function () {\n        var field = new FieldElementBox(this.fieldType);\n        field.characterFormat.copyFormat(this.characterFormat);\n        if (this.margin) {\n            field.margin = this.margin.clone();\n        }\n        field.width = this.width;\n        field.height = this.height;\n        return field;\n    };\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.destroy = function () {\n        this.fieldType = undefined;\n        this.hasFieldEnd = undefined;\n        this.fieldBeginInternal = undefined;\n        this.fieldEndInternal = undefined;\n        this.fieldSeparatorInternal = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return FieldElementBox;\n}(ElementBox));\nexport { FieldElementBox };\n/**\n * @private\n */\nvar TextElementBox = /** @class */ (function (_super) {\n    __extends(TextElementBox, _super);\n    function TextElementBox() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.baselineOffset = 0;\n        /**\n         * @private\n         */\n        _this.text = '';\n        return _this;\n    }\n    /**\n     * @private\n     */\n    TextElementBox.prototype.getLength = function () {\n        return this.text ? this.text.length : 0;\n    };\n    /**\n     * @private\n     */\n    TextElementBox.prototype.clone = function () {\n        var span = new TextElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    /**\n     * @private\n     */\n    TextElementBox.prototype.destroy = function () {\n        this.text = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TextElementBox;\n}(ElementBox));\nexport { TextElementBox };\n/**\n * @private\n */\nvar FieldTextElementBox = /** @class */ (function (_super) {\n    __extends(FieldTextElementBox, _super);\n    function FieldTextElementBox() {\n        var _this = _super.call(this) || this;\n        _this.fieldText = '';\n        return _this;\n    }\n    Object.defineProperty(FieldTextElementBox.prototype, \"text\", {\n        get: function () {\n            return this.fieldText;\n        },\n        set: function (value) {\n            this.fieldText = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FieldTextElementBox.prototype.clone = function () {\n        var span = new FieldTextElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.fieldBegin = this.fieldBegin;\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return FieldTextElementBox;\n}(TextElementBox));\nexport { FieldTextElementBox };\n/**\n * @private\n */\nvar TabElementBox = /** @class */ (function (_super) {\n    __extends(TabElementBox, _super);\n    function TabElementBox() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.tabText = '';\n        /**\n         * @private\n         */\n        _this.tabLeader = 'None';\n        return _this;\n    }\n    /**\n     * @private\n     */\n    TabElementBox.prototype.destroy = function () {\n        this.tabText = undefined;\n        this.tabLeader = undefined;\n    };\n    /**\n     * @private\n     */\n    TabElementBox.prototype.clone = function () {\n        var span = new TabElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.tabText = this.tabText;\n        span.tabLeader = this.tabLeader;\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return TabElementBox;\n}(TextElementBox));\nexport { TabElementBox };\n/**\n * @private\n */\nvar BookmarkElementBox = /** @class */ (function (_super) {\n    __extends(BookmarkElementBox, _super);\n    function BookmarkElementBox(type) {\n        var _this = _super.call(this) || this;\n        _this.bookmarkTypeIn = 0;\n        _this.refereneceIn = undefined;\n        _this.nameIn = '';\n        _this.bookmarkTypeIn = type;\n        return _this;\n    }\n    Object.defineProperty(BookmarkElementBox.prototype, \"bookmarkType\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.bookmarkTypeIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BookmarkElementBox.prototype, \"name\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.nameIn;\n        },\n        /**\n         * @private\n         */\n        set: function (name) {\n            this.nameIn = name;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BookmarkElementBox.prototype, \"reference\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.refereneceIn;\n        },\n        /**\n         * @private\n         */\n        set: function (reference) {\n            this.refereneceIn = reference;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.destroy = function () {\n        this.name = undefined;\n        this.reference = undefined;\n        this.bookmarkTypeIn = undefined;\n    };\n    /**\n     * Clones the bookmark element box.\n     * @param element - book mark element\n     */\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.clone = function () {\n        var span = new BookmarkElementBox(this.bookmarkType);\n        span.name = this.name;\n        span.reference = this.reference;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return BookmarkElementBox;\n}(ElementBox));\nexport { BookmarkElementBox };\n/**\n * @private\n */\nvar ImageElementBox = /** @class */ (function (_super) {\n    __extends(ImageElementBox, _super);\n    function ImageElementBox(isInlineImage) {\n        var _this = _super.call(this) || this;\n        _this.imageStr = '';\n        _this.imgElement = undefined;\n        _this.isInlineImageIn = true;\n        /**\n         * @private\n         */\n        _this.isMetaFile = false;\n        _this.isInlineImageIn = isInlineImage;\n        return _this;\n    }\n    Object.defineProperty(ImageElementBox.prototype, \"isInlineImage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isInlineImageIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"element\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.imgElement)) {\n                this.imgElement = document.createElement('img');\n            }\n            return this.imgElement;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"imageString\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.imageStr;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.imageStr = value;\n            if (!isNullOrUndefined(value)) {\n                this.element.src = this.imageStr;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.clone = function () {\n        var image = new ImageElementBox(this.isInlineImage);\n        image.characterFormat.copyFormat(this.characterFormat);\n        image.imageString = this.imageString;\n        image.isMetaFile = this.isMetaFile;\n        image.width = this.width;\n        image.height = this.height;\n        if (this.margin) {\n            image.margin = this.margin.clone();\n        }\n        return image;\n    };\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.destroy = function () {\n        this.imgElement = undefined;\n        this.imageString = undefined;\n        this.isInlineImageIn = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ImageElementBox;\n}(ElementBox));\nexport { ImageElementBox };\n/**\n * @private\n */\nvar ListTextElementBox = /** @class */ (function (_super) {\n    __extends(ListTextElementBox, _super);\n    function ListTextElementBox(listLevel, isListFollowCharacter) {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.baselineOffset = 0;\n        /**\n         * @private\n         */\n        _this.isFollowCharacter = false;\n        _this.listLevel = listLevel;\n        _this.isFollowCharacter = isListFollowCharacter;\n        return _this;\n    }\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.getLength = function () {\n        return this.text ? this.text.length : 0;\n    };\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.clone = function () {\n        var list = new ListTextElementBox(this.listLevel, this.isFollowCharacter);\n        list.text = this.text;\n        list.baselineOffset = this.baselineOffset;\n        if (this.margin) {\n            list.margin = this.margin.clone();\n        }\n        list.width = this.width;\n        list.height = this.height;\n        return list;\n    };\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.destroy = function () {\n        this.text = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ListTextElementBox;\n}(ElementBox));\nexport { ListTextElementBox };\n/**\n * @private\n */\nvar Page = /** @class */ (function () {\n    /**\n     * Initialize the constructor of Page\n     */\n    function Page() {\n        /**\n         * Specifies the Bonding Rectangle\n         * @private\n         */\n        this.boundingRectangle = new Rect(96, 96, 816, 1056);\n        /**\n         * @private\n         */\n        this.repeatHeaderRowTableWidget = false;\n        /**\n         * Specifies the bodyWidgets\n         * @default []\n         * @private\n         */\n        this.bodyWidgets = [];\n        /**\n         * @private\n         */\n        this.headerWidget = undefined;\n        /**\n         * @private\n         */\n        this.footerWidget = undefined;\n        // let text: string = 'DocumentEditor';\n    }\n    Object.defineProperty(Page.prototype, \"index\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.viewer) {\n                return this.viewer.pages.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"previousPage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.index;\n            if (index > 0) {\n                return this.viewer.pages[index - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"nextPage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.index;\n            if (index < this.viewer.pages.length - 1) {\n                return this.viewer.pages[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"sectionIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.bodyWidgets.length > 0) {\n                return this.bodyWidgets[0].index;\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Page.prototype.destroy = function () {\n        if (this.headerWidget) {\n            if (this.viewer && this.viewer.owner.editor) {\n                this.viewer.owner.editor.removeFieldInWidget(this.headerWidget);\n            }\n            this.headerWidget.destroy();\n        }\n        this.headerWidget = undefined;\n        if (this.footerWidget) {\n            if (this.viewer && this.viewer.owner.editor) {\n                this.viewer.owner.editor.removeFieldInWidget(this.footerWidget);\n            }\n            this.footerWidget.destroy();\n        }\n        this.footerWidget = undefined;\n        this.bodyWidgets = [];\n        this.bodyWidgets = undefined;\n        if (!isNullOrUndefined(this.viewer)) {\n            if (!isNullOrUndefined(this.viewer.pages)) {\n                this.viewer.removePage(this);\n            }\n        }\n        this.viewer = undefined;\n    };\n    return Page;\n}());\nexport { Page };\n/**\n * @private\n */\nvar WTableHolder = /** @class */ (function () {\n    function WTableHolder() {\n        this.tableColumns = [];\n        /**\n         * @private\n         */\n        this.tableWidth = 0;\n    }\n    Object.defineProperty(WTableHolder.prototype, \"columns\", {\n        get: function () {\n            return this.tableColumns;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    WTableHolder.prototype.resetColumns = function () {\n        for (var i = 0; i < this.tableColumns.length; i++) {\n            this.tableColumns[i].destroy();\n        }\n        this.tableColumns = [];\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getPreviousSpannedCellWidth = function (previousColumnIndex, curColumnIndex) {\n        var width = 0;\n        for (var i = previousColumnIndex; i < curColumnIndex; i++) {\n            width += this.tableColumns[i].preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.addColumns = function (currentColumnIndex, columnSpan, width, minWidth, offset) {\n        for (var i = this.columns.length; i < columnSpan; i++) {\n            this.columns.push(new WColumn());\n        }\n        var availableWidth = 0;\n        for (var j = currentColumnIndex; j < columnSpan; j++) {\n            availableWidth += this.columns[j].preferredWidth;\n        }\n        // If width to add is greater than preferred width, then preferred width will be increased.\n        // In case of Gridspan > 1, only last grid column width will be updated.\n        var gridSpan = columnSpan - currentColumnIndex;\n        if (!(gridSpan > 1) && availableWidth < width) {\n            this.columns[columnSpan - 1].preferredWidth += (width - availableWidth);\n        }\n        if (minWidth > this.columns[columnSpan - 1].minWidth) {\n            this.columns[columnSpan - 1].minWidth = minWidth;\n        }\n        if (offset > this.columns[columnSpan - 1].endOffset) {\n            this.columns[columnSpan - 1].endOffset = offset;\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getTotalWidth = function () {\n        var width = 0;\n        for (var i = 0; i < this.columns.length; i++) {\n            var column = this.columns[i];\n            width += column.preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.isFitColumns = function (containerWidth, preferredTableWidth, isAutoWidth) {\n        // Gets total preferred width.\n        var totalColumnWidth = this.getTotalWidth();\n        // If auto table width, based on total column widths, minimum value will be updated.\n        if (isAutoWidth) {\n            this.tableWidth = preferredTableWidth > totalColumnWidth ? totalColumnWidth : preferredTableWidth;\n        }\n        else {\n            this.tableWidth = preferredTableWidth;\n        }\n        // If total columns width doesn't match table width, then all grid column widths will be updated by even factor.\n        // If totalColumnWidth < TableWidth, all grid columns are enlarged. Otherwise shrinked.\n        if (totalColumnWidth !== this.tableWidth) {\n            var factor = this.tableWidth / totalColumnWidth;\n            factor = isNaN(factor) ? 1 : factor;\n            for (var i = 0; i < this.columns.length; i++) {\n                var column = this.columns[i];\n                //column.PreferredWidth = factor * column.PreferredWidth;\n                if (factor * column.preferredWidth < column.minWidth) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        else {\n            return true;\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.fitColumns = function (containerWidth, preferredTableWidth, isAutoWidth) {\n        // Gets total preferred width.\n        var totalColumnWidth = this.getTotalWidth();\n        // If auto table width, based on total column widths, minimum value will be updated.\n        if (isAutoWidth) {\n            this.tableWidth = preferredTableWidth > totalColumnWidth ? totalColumnWidth : preferredTableWidth;\n        }\n        else {\n            this.tableWidth = preferredTableWidth;\n        }\n        // If total columns width doesn't match table width, then all grid column widths will be updated by even factor.\n        // If totalColumnWidth < TableWidth, all grid columns are enlarged. Otherwise shrinked.\n        if (totalColumnWidth !== this.tableWidth) {\n            var factor = this.tableWidth / totalColumnWidth;\n            for (var i = 0; i < this.columns.length; i++) {\n                var column = this.columns[i];\n                column.preferredWidth = factor * column.preferredWidth;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getCellWidth = function (columnIndex, columnSpan, preferredTableWidth, isAutoWidth) {\n        var width = 0;\n        for (var i = 0; i < columnSpan; i++) {\n            width += this.tableColumns[i + columnIndex].preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.validateColumnWidths = function () {\n        for (var i = 0; i < this.columns.length; i++) {\n            if (i === 0) {\n                if (this.columns[i].preferredWidth !== this.columns[i].endOffset) {\n                    this.columns[i].preferredWidth = this.columns[i].endOffset;\n                }\n            }\n            else {\n                // If Previous column offset + current column preferred width is less than current column offset, \n                // Then current column preferred width is set to current column offset - previous column offset.\n                if (this.columns[i - 1].endOffset + this.columns[i].preferredWidth < this.columns[i].endOffset) {\n                    this.columns[i].preferredWidth = this.columns[i].endOffset - this.columns[i - 1].endOffset;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.clone = function () {\n        var tableHolder = new WTableHolder();\n        tableHolder.tableWidth = this.tableWidth;\n        for (var i = 0; i < this.columns.length; i++) {\n            tableHolder.columns.push(this.columns[i].clone());\n        }\n        return tableHolder;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.tableColumns)) {\n            for (var i = 0; i < this.tableColumns.length; i++) {\n                var column = this.tableColumns[i];\n                column.destroy();\n            }\n        }\n        this.tableColumns = [];\n        this.tableColumns = undefined;\n        this.tableWidth = undefined;\n    };\n    return WTableHolder;\n}());\nexport { WTableHolder };\n/**\n * @private\n */\nvar WColumn = /** @class */ (function () {\n    function WColumn() {\n        /**\n         * @private\n         */\n        this.preferredWidth = 0;\n        /**\n         * @private\n         */\n        this.minWidth = 0;\n        /**\n         * @private\n         */\n        this.maxWidth = 0;\n        /**\n         * @private\n         */\n        this.endOffset = 0;\n    }\n    /**\n     * @private\n     */\n    WColumn.prototype.clone = function () {\n        var column = new WColumn();\n        column.preferredWidth = this.preferredWidth;\n        column.minWidth = this.minWidth;\n        column.maxWidth = this.maxWidth;\n        return column;\n    };\n    /**\n     * @private\n     */\n    WColumn.prototype.destroy = function () {\n        this.preferredWidth = undefined;\n        this.minWidth = undefined;\n        this.maxWidth = undefined;\n    };\n    return WColumn;\n}());\nexport { WColumn };\n","import { ContextMenu as Menu } from '@syncfusion/ej2-navigations';\nimport { isNullOrUndefined, L10n, setCulture, classList } from '@syncfusion/ej2-base';\nimport { FieldElementBox } from './viewer/page';\nvar CONTEXTMENU_COPY = '_contextmenu_copy';\nvar CONTEXTMENU_CUT = '_contextmenu_cut';\nvar CONTEXTMENU_PASTE = '_contextmenu_paste';\nvar CONTEXTMENU_UPDATE_FIELD = '_contextmenu_update_field';\nvar CONTEXTMENU_EDIT_FIELD = '_contextmenu_edit_field';\nvar CONTEXTMENU_HYPERLINK = '_contextmenu_hyperlink';\nvar CONTEXTMENU_OPEN_HYPERLINK = '_contextmenu_open_hyperlink';\nvar CONTEXTMENU_COPY_HYPERLINK = '_contextmenu_copy_hyperlink';\nvar CONTEXTMENU_REMOVE_HYPERLINK = '_contextmenu_remove_hyperlink';\nvar CONTEXTMENU_EDIT_HYPERLINK = '_contextmenu_edit_hyperlink';\nvar CONTEXTMENU_FONT_DIALOG = '_contextmenu_font_dialog';\nvar CONTEXTMENU_PARAGRAPH = '_contextmenu_paragraph_dialog';\nvar CONTEXTMENU_TABLE = '_contextmenu_table_dialog';\nvar CONTEXTMENU_INSERT_TABLE = '_contextmenu_insert_table';\nvar CONTEXTMENU_DELETE_TABLE = '_contextmenu_delete_table';\nvar CONTEXTMENU_INSERT_ABOVE = '_contextmenu_insert_above';\nvar CONTEXTMENU_INSERT_BELOW = '_contextmenu_insert_below';\nvar CONTEXTMENU_INSERT_RIGHT = '_contextmenu_insert_right';\nvar CONTEXTMENU_INSERT_LEFT = '_contextmenu_insert_left';\nvar CONTEXTMENU_COMPLETE_DELETE_TABLE = '_contextmenu_complete_table_delete';\nvar CONTEXTMENU_DELETE_ROW = '_contextmenu_delete_row';\nvar CONTEXTMENU_DELETE_COLUMN = '_contextmenu_delete_column';\nvar CONTEXTMENU_MERGE_CELL = '_contextmenu_merge_cell';\nvar CONTEXTMENU_CONTINUE_NUMBERING = '_contextmenu_continue_numbering';\nvar CONTEXTMENU_RESTART_AT = '_contextmenu_restart_at';\n/**\n * Context Menu class\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ContextMenu(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.contextMenuInstance = undefined;\n        /**\n         * Handles on context menu key pressed.\n         * @param  {PointerEvent} event\n         * @private\n         */\n        this.onContextMenuInternal = function (event) {\n            if (_this.showHideElements(_this.viewer.selection)) {\n                _this.contextMenuInstance.open(event.y, event.x);\n                event.preventDefault();\n            }\n        };\n        this.viewer = viewer;\n        var locale = new L10n('documenteditor', this.viewer.owner.defaultLocale);\n        locale.setLocale(this.viewer.owner.locale);\n        setCulture(this.viewer.owner.locale);\n        this.initContextMenu(locale);\n    }\n    /**\n     * Gets module name.\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'ContextMenu';\n    };\n    /**\n     * Initialize context menu.\n     * @param localValue Localize value.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    ContextMenu.prototype.initContextMenu = function (localValue) {\n        var _this = this;\n        var id = this.viewer.owner.element.id;\n        this.contextMenu = document.createElement('div');\n        this.contextMenu.id = this.viewer.owner.containerId + 'e-de-contextmenu';\n        document.body.appendChild(this.contextMenu);\n        var ul = document.createElement('ul');\n        ul.style.width = 'auto';\n        ul.id = this.viewer.owner.containerId + 'e-de-contextmenu-list';\n        ul.style.listStyle = 'none';\n        ul.style.margin = '0px';\n        ul.style.padding = '0px';\n        ul.style.maxHeight = 'auto';\n        ul.oncontextmenu = this.disableBrowserContextmenu;\n        this.contextMenu.appendChild(ul);\n        var menuItems = [\n            {\n                text: localValue.getConstant('Cut'),\n                iconCss: 'e-icons e-de-cut',\n                id: id + CONTEXTMENU_CUT\n            },\n            {\n                text: localValue.getConstant('Copy'),\n                iconCss: 'e-icons e-de-copy',\n                id: id + CONTEXTMENU_COPY\n            },\n            {\n                text: localValue.getConstant('Paste'),\n                iconCss: 'e-icons e-de-paste',\n                id: id + CONTEXTMENU_PASTE\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Update Field'),\n                iconCss: 'e-icons e-de-update_field',\n                id: id + CONTEXTMENU_UPDATE_FIELD\n            },\n            {\n                text: localValue.getConstant('Edit Field'),\n                iconCss: 'e-icons e-de-edit_field',\n                id: id + CONTEXTMENU_EDIT_FIELD\n            },\n            {\n                text: localValue.getConstant('Continue Numbering'),\n                iconCss: 'e-icons e-de-continue-numbering',\n                id: id + CONTEXTMENU_CONTINUE_NUMBERING\n            },\n            {\n                text: localValue.getConstant('Restart At') + ' 1',\n                iconCss: 'e-icons e-de-restart-at',\n                id: id + CONTEXTMENU_RESTART_AT\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Hyperlink'),\n                iconCss: 'e-icons e-de-insertlink',\n                id: id + CONTEXTMENU_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Edit Hyperlink') + '...',\n                iconCss: 'e-icons e-de-edit-hyperlink',\n                id: id + CONTEXTMENU_EDIT_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Open Hyperlink'),\n                iconCss: 'e-icons e-de-open-hyperlink',\n                id: id + CONTEXTMENU_OPEN_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Copy Hyperlink'),\n                iconCss: 'e-icons e-de-copy-hyperlink',\n                id: id + CONTEXTMENU_COPY_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Remove Hyperlink'),\n                iconCss: 'e-icons e-de-remove-hyperlink',\n                id: id + CONTEXTMENU_REMOVE_HYPERLINK\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Font'),\n                iconCss: 'e-icons e-de-fonts',\n                id: id + CONTEXTMENU_FONT_DIALOG\n            },\n            {\n                text: localValue.getConstant('Paragraph'),\n                iconCss: 'e-icons e-de-paragraph',\n                id: id + CONTEXTMENU_PARAGRAPH\n            },\n            {\n                separator: true,\n            },\n            {\n                text: localValue.getConstant('Table Properties'),\n                id: id + CONTEXTMENU_TABLE,\n                iconCss: 'e-icons e-de-table'\n            },\n            {\n                text: localValue.getConstant('Merge Cells'),\n                id: id + CONTEXTMENU_MERGE_CELL,\n                iconCss: 'e-icons e-de-icon-table-merge-cells'\n            },\n            {\n                text: localValue.getConstant('Insert'),\n                id: id + CONTEXTMENU_INSERT_TABLE,\n                iconCss: 'e-icons',\n                items: [\n                    {\n                        text: localValue.getConstant('Insert Above'),\n                        id: id + CONTEXTMENU_INSERT_ABOVE,\n                        iconCss: 'e-icons e-de-insertabove'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Below'),\n                        id: id + CONTEXTMENU_INSERT_BELOW,\n                        iconCss: 'e-icons e-de-insertbelow'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Left'),\n                        id: id + CONTEXTMENU_INSERT_LEFT,\n                        iconCss: 'e-icons e-de-insertleft'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Right'),\n                        id: id + CONTEXTMENU_INSERT_RIGHT,\n                        iconCss: 'e-icons e-de-insertright'\n                    }\n                ]\n            },\n            {\n                text: localValue.getConstant('Delete'),\n                id: id + CONTEXTMENU_DELETE_TABLE,\n                iconCss: 'e-icons',\n                items: [\n                    {\n                        text: localValue.getConstant('Delete Table'),\n                        id: id + CONTEXTMENU_COMPLETE_DELETE_TABLE,\n                        iconCss: 'e-icons e-de-delete-table'\n                    },\n                    {\n                        text: localValue.getConstant('Delete Row'),\n                        id: id + CONTEXTMENU_DELETE_ROW,\n                        iconCss: 'e-icons e-de-deleterow'\n                    },\n                    {\n                        text: localValue.getConstant('Delete Column'),\n                        id: id + CONTEXTMENU_DELETE_COLUMN,\n                        iconCss: 'e-icons e-de-deletecolumn'\n                    }\n                ]\n            },\n        ];\n        var menuOptions = {\n            target: '#' + this.viewer.owner.containerId + 'e-de-contextmenu',\n            items: menuItems,\n            select: function (args) {\n                var item = args.element.id;\n                _this.handleContextMenuItem(item);\n            },\n        };\n        this.contextMenuInstance = new Menu(menuOptions, '#' + this.viewer.owner.containerId + 'e-de-contextmenu-list');\n        this.contextMenuInstance.beforeOpen = function () {\n            if (_this.viewer && _this.viewer.selection) {\n                classList(_this.viewer.selection.caret, [], ['e-de-cursor-animation']);\n                _this.viewer.selection.showCaret();\n            }\n        };\n        this.contextMenuInstance.onClose = function () {\n            if (_this.viewer && _this.viewer.selection) {\n                classList(_this.viewer.selection.caret, ['e-de-cursor-animation'], []);\n                _this.viewer.updateFocus();\n            }\n        };\n    };\n    /**\n     * Disable browser context menu.\n     */\n    ContextMenu.prototype.disableBrowserContextmenu = function () {\n        return false;\n    };\n    /**\n     * Handles context menu items.\n     * @param  {string} item Specifies which item is selected.\n     * @private\n     */\n    ContextMenu.prototype.handleContextMenuItem = function (item) {\n        var id = this.viewer.owner.element.id;\n        switch (item) {\n            case id + CONTEXTMENU_COPY:\n                this.viewer.selection.copy();\n                break;\n            case id + CONTEXTMENU_CUT:\n                this.viewer.owner.editor.cut();\n                break;\n            case id + CONTEXTMENU_PASTE:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.editorModule.pasteInternal(undefined);\n                }\n                break;\n            case id + CONTEXTMENU_UPDATE_FIELD:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.editorModule.updateToc();\n                }\n                break;\n            case id + CONTEXTMENU_EDIT_FIELD:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.tableOfContentsDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_FONT_DIALOG:\n                if (this.viewer.owner.fontDialogModule) {\n                    this.viewer.owner.fontDialogModule.showFontDialog();\n                }\n                break;\n            case id + CONTEXTMENU_OPEN_HYPERLINK:\n                this.viewer.selection.navigateHyperlink();\n                break;\n            case id + CONTEXTMENU_COPY_HYPERLINK:\n                this.viewer.selection.copyHyperlink();\n                break;\n            case id + CONTEXTMENU_EDIT_HYPERLINK:\n            case id + CONTEXTMENU_HYPERLINK:\n                if (this.viewer.owner.hyperlinkDialogModule) {\n                    this.viewer.owner.hyperlinkDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_REMOVE_HYPERLINK:\n                this.viewer.owner.editor.removeHyperlink();\n                break;\n            case id + CONTEXTMENU_PARAGRAPH:\n                if (this.viewer.owner.paragraphDialogModule) {\n                    this.viewer.owner.paragraphDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_TABLE:\n                this.viewer.owner.tablePropertiesDialogModule.show();\n                break;\n            case id + CONTEXTMENU_MERGE_CELL:\n                this.viewer.owner.editor.mergeCells();\n                break;\n            case id + CONTEXTMENU_INSERT_ABOVE:\n                this.viewer.owner.editor.insertRow(true);\n                break;\n            case id + CONTEXTMENU_INSERT_BELOW:\n                this.viewer.owner.editor.insertRow(false);\n                break;\n            case id + CONTEXTMENU_INSERT_LEFT:\n                this.viewer.owner.editor.insertColumn(true);\n                break;\n            case id + CONTEXTMENU_INSERT_RIGHT:\n                this.viewer.owner.editor.insertColumn(false);\n                break;\n            case id + CONTEXTMENU_COMPLETE_DELETE_TABLE:\n                this.viewer.owner.editor.deleteTable();\n                break;\n            case id + CONTEXTMENU_DELETE_ROW:\n                this.viewer.owner.editor.deleteRow();\n                break;\n            case id + CONTEXTMENU_DELETE_COLUMN:\n                this.viewer.owner.editor.deleteColumn();\n                break;\n            case id + CONTEXTMENU_CONTINUE_NUMBERING:\n                this.viewer.owner.editorModule.applyContinueNumbering(this.viewer.selection);\n                break;\n            case id + CONTEXTMENU_RESTART_AT:\n                this.viewer.owner.editorModule.applyRestartNumbering(this.viewer.selection);\n                break;\n        }\n    };\n    ContextMenu.prototype.showHideElements = function (selection) {\n        var owner = this.viewer.owner;\n        var id = owner.element.id;\n        var copy = document.getElementById(id + CONTEXTMENU_COPY);\n        var cut = document.getElementById(id + CONTEXTMENU_CUT);\n        var paste = document.getElementById(id + CONTEXTMENU_PASTE);\n        var updateField = document.getElementById(id + CONTEXTMENU_UPDATE_FIELD);\n        var editField = document.getElementById(id + CONTEXTMENU_EDIT_FIELD);\n        var font = document.getElementById(id + CONTEXTMENU_FONT_DIALOG);\n        var paragraph = document.getElementById(id + CONTEXTMENU_PARAGRAPH);\n        var tableProperties = document.getElementById(id + CONTEXTMENU_TABLE);\n        var insertTable = document.getElementById(id + CONTEXTMENU_INSERT_TABLE);\n        var deleteTable = document.getElementById(id + CONTEXTMENU_DELETE_TABLE);\n        var mergeCells = document.getElementById(id + CONTEXTMENU_MERGE_CELL);\n        var hyperlink = document.getElementById(id + CONTEXTMENU_HYPERLINK);\n        var openHyperlink = document.getElementById(id + CONTEXTMENU_OPEN_HYPERLINK);\n        var editHyperlink = document.getElementById(id + CONTEXTMENU_EDIT_HYPERLINK);\n        var copyHyperlink = document.getElementById(id + CONTEXTMENU_COPY_HYPERLINK);\n        var removeHyperlink = document.getElementById(id + CONTEXTMENU_REMOVE_HYPERLINK);\n        var continueNumbering = document.getElementById(id + CONTEXTMENU_CONTINUE_NUMBERING);\n        var restartAt = document.getElementById(id + CONTEXTMENU_RESTART_AT);\n        cut.style.display = 'none';\n        paste.style.display = 'none';\n        paste.nextSibling.style.display = 'none';\n        hyperlink.style.display = 'none';\n        openHyperlink.style.display = 'none';\n        copyHyperlink.style.display = 'none';\n        editHyperlink.style.display = 'none';\n        removeHyperlink.style.display = 'none';\n        removeHyperlink.nextSibling.style.display = 'none';\n        mergeCells.style.display = 'none';\n        font.style.display = 'none';\n        paragraph.style.display = 'none';\n        paragraph.nextSibling.style.display = 'none';\n        insertTable.style.display = 'none';\n        deleteTable.style.display = 'none';\n        tableProperties.style.display = 'none';\n        updateField.style.display = 'none';\n        editField.style.display = 'none';\n        continueNumbering.style.display = 'none';\n        restartAt.style.display = 'none';\n        restartAt.nextSibling.style.display = 'none';\n        if (isNullOrUndefined(selection)) {\n            return false;\n        }\n        selection.hideToolTip();\n        if (selection.isEmpty) {\n            cut.classList.add('e-disabled');\n            copy.classList.add('e-disabled');\n        }\n        else {\n            cut.classList.remove('e-disabled');\n            copy.classList.remove('e-disabled');\n        }\n        if (owner.isReadOnlyMode) {\n            return true;\n        }\n        cut.style.display = 'block';\n        paste.style.display = 'block';\n        paste.nextSibling.style.display = 'block';\n        insertTable.classList.add('e-blankicon');\n        deleteTable.classList.add('e-blankicon');\n        updateField.classList.add('e-blankicon');\n        editField.classList.add('e-blankicon');\n        if (owner.enableLocalPaste && !isNullOrUndefined(owner.editor.copiedData)) {\n            paste.classList.remove('e-disabled');\n        }\n        else {\n            paste.classList.add('e-disabled');\n        }\n        if (selection.contextType === 'TableOfContents') {\n            updateField.style.display = 'block';\n            editField.style.display = 'block';\n            restartAt.nextSibling.style.display = 'block';\n        }\n        else {\n            var start = selection.start;\n            var end = selection.end;\n            if (selection.contextType === 'List'\n                && owner.editorModule.getListLevel(start.paragraph).listLevelPattern !== 'Bullet') {\n                continueNumbering.style.display = 'block';\n                restartAt.style.display = 'block';\n                restartAt.nextSibling.style.display = 'block';\n            }\n            var isCellOrRowSelected = start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n                || start.paragraph.associatedCell !== end.paragraph.associatedCell\n                || selection.isCellSelected(start.paragraph.associatedCell, start, end));\n            if (isCellOrRowSelected) {\n                hyperlink.classList.add('e-disabled');\n            }\n            else {\n                if (hyperlink.classList.contains('e-disabled')) {\n                    hyperlink.classList.remove('e-disabled');\n                }\n            }\n            var field = selection.getHyperlinkField();\n            if (field instanceof FieldElementBox && !selection.isImageField()) {\n                openHyperlink.style.display = 'block';\n                copyHyperlink.style.display = 'block';\n                if (owner.hyperlinkDialogModule) {\n                    editHyperlink.style.display = 'block';\n                }\n                removeHyperlink.style.display = 'block';\n                removeHyperlink.nextSibling.style.display = 'block';\n            }\n            else {\n                if (owner.hyperlinkDialogModule) {\n                    hyperlink.style.display = 'block';\n                }\n            }\n        }\n        if (this.viewer.owner.selection.start.paragraph.isInsideTable\n            && this.viewer.owner.selection.end.paragraph.isInsideTable) {\n            paragraph.nextSibling.style.display = 'block';\n            if (owner.tablePropertiesDialogModule) {\n                tableProperties.style.display = 'block';\n            }\n            insertTable.style.display = 'block';\n            deleteTable.style.display = 'block';\n            if (this.viewer.owner.editor.canMergeCells()) {\n                mergeCells.style.display = 'block';\n            }\n        }\n        else {\n            if (this.viewer.owner.fontDialogModule) {\n                font.style.display = 'block';\n                font.previousSibling.style.display = 'block';\n            }\n            if (this.viewer.owner.paragraphDialogModule) {\n                paragraph.style.display = 'block';\n            }\n        }\n        if (selection.contextType === 'Image') {\n            font.style.display = 'none';\n            paragraph.style.display = 'none';\n            removeHyperlink.nextSibling.style.display = 'none';\n        }\n        return true;\n    };\n    /**\n     * Disposes the internal objects which are maintained.\n     * @private\n     */\n    ContextMenu.prototype.destroy = function () {\n        if (this.contextMenuInstance) {\n            this.contextMenuInstance.destroy();\n        }\n        if (this.contextMenu) {\n            if (this.contextMenu.parentElement) {\n                this.contextMenu.parentElement.removeChild(this.contextMenu);\n            }\n            this.contextMenu.innerHTML = '';\n        }\n        this.contextMenu = undefined;\n        this.contextMenuInstance = undefined;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WAbstractList = /** @class */ (function () {\n    function WAbstractList() {\n        this.abstractListIdIn = -1;\n        this.levels = [];\n    }\n    Object.defineProperty(WAbstractList.prototype, \"abstractListId\", {\n        get: function () {\n            return this.abstractListIdIn;\n        },\n        set: function (abstractListId) {\n            this.abstractListIdIn = abstractListId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WAbstractList.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.levels)) {\n            for (var i = 0; i < this.levels.length; i++) {\n                var listLevel = this.levels[i];\n                listLevel.destroy();\n                this.levels.splice(this.levels.indexOf(listLevel), 1);\n                i--;\n            }\n            this.levels = [];\n        }\n        this.levels = undefined;\n    };\n    return WAbstractList;\n}());\nexport { WAbstractList };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WCharacterFormat } from '../format/character-format';\nimport { WParagraphFormat } from '../format/paragraph-format';\nimport { WAbstractList } from './abstract-list';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WListLevel = /** @class */ (function () {\n    function WListLevel(node) {\n        this.uniqueListLevel = undefined;\n        this.paragraphFormat = undefined;\n        this.characterFormat = undefined;\n        if (node instanceof WAbstractList) {\n            this.ownerBase = node;\n        }\n        else {\n            this.ownerBase = node;\n        }\n        this.characterFormat = new WCharacterFormat(undefined);\n        this.paragraphFormat = new WParagraphFormat(undefined);\n    }\n    Object.defineProperty(WListLevel.prototype, \"listLevelPattern\", {\n        get: function () {\n            return this.getPropertyValue('listLevelPattern');\n        },\n        set: function (listLevelPattern) {\n            this.setPropertyValue('listLevelPattern', listLevelPattern);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"followCharacter\", {\n        get: function () {\n            return this.getPropertyValue('followCharacter');\n        },\n        set: function (followCharacter) {\n            this.setPropertyValue('followCharacter', followCharacter);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"startAt\", {\n        get: function () {\n            return this.getPropertyValue('startAt');\n        },\n        set: function (startAt) {\n            this.setPropertyValue('startAt', startAt);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"numberFormat\", {\n        get: function () {\n            return this.getPropertyValue('numberFormat');\n        },\n        set: function (numberFormat) {\n            this.setPropertyValue('numberFormat', numberFormat);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"restartLevel\", {\n        get: function () {\n            return this.getPropertyValue('restartLevel');\n        },\n        set: function (restartLevel) {\n            this.setPropertyValue('restartLevel', restartLevel);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WListLevel.prototype.getPropertyValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WListLevel.uniqueFormatType, property);\n        if (!isNullOrUndefined(this.uniqueListLevel) && this.uniqueListLevel.propertiesHash.containsKey(propertyType)) {\n            return this.uniqueListLevel.propertiesHash.get(propertyType);\n        }\n        return WListLevel.getPropertyDefaultValue(property);\n    };\n    WListLevel.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WListLevel.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueListLevel)) {\n            this.initializeUniqueWListLevel(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListLevel.uniqueFormatType, property);\n            if (this.uniqueListLevel.propertiesHash.containsKey(propertyType) &&\n                // tslint:disable-next-line:max-line-length\n                this.uniqueListLevel.propertiesHash.get(propertyType) === value) { //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueListLevel = WListLevel.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel, property, value);\n        }\n    };\n    WListLevel.prototype.initializeUniqueWListLevel = function (property, propValue) {\n        var uniqueListLevelTemp = new Dictionary();\n        this.addUniqueWListLevel('listLevelPattern', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('startAt', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('followCharacter', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('numberFormat', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('restartLevel', property, propValue, uniqueListLevelTemp);\n        // tslint:disable-next-line:max-line-length    \n        this.uniqueListLevel = WListLevel.uniqueListLevels.addUniqueFormat(uniqueListLevelTemp, WListLevel.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WListLevel.prototype.addUniqueWListLevel = function (property, modifiedProperty, propValue, uniqueCharFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WListLevel.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCharFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueCharFormatTemp.add(propertyType, WListLevel.getPropertyDefaultValue(property));\n        }\n    };\n    WListLevel.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'listLevelPattern':\n                value = 'Arabic';\n                break;\n            case 'startAt':\n                value = 0;\n                break;\n            case 'followCharacter':\n                value = 'Tab';\n                break;\n            case 'numberFormat':\n                value = '';\n                break;\n            case 'restartLevel':\n                value = 0;\n                break;\n        }\n        return value;\n    };\n    WListLevel.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.characterFormat)) {\n            this.characterFormat.destroy();\n        }\n        if (!isNullOrUndefined(this.paragraphFormat)) {\n            this.paragraphFormat.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueListLevel)) {\n            WListLevel.uniqueListLevels.remove(this.uniqueListLevel);\n        }\n        this.uniqueListLevel = undefined;\n        this.characterFormat = undefined;\n        this.paragraphFormat = undefined;\n    };\n    WListLevel.clear = function () {\n        this.uniqueListLevels.clear();\n    };\n    WListLevel.dotBullet = '\\uf0b7';\n    WListLevel.squareBullet = '\\uf0a7'; //Symbol font \\u25aa.\n    WListLevel.arrowBullet = '\\u27a4';\n    WListLevel.circleBullet = '\\uf06f' + '\\u0020';\n    WListLevel.uniqueListLevels = new WUniqueFormats();\n    WListLevel.uniqueFormatType = 9;\n    return WListLevel;\n}());\nexport { WListLevel };\n","import { Dictionary } from '../../base/dictionary';\nimport { WListLevel } from '../list/list-level';\nimport { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WBorder } from '../format/index';\nimport { PageLayoutViewer } from './viewer';\nimport { LineWidget, Rect, Widget, Margin, ParagraphWidget, BodyWidget, TextElementBox, ElementBox, ListTextElementBox, TableCellWidget, TableRowWidget, TableWidget, FieldElementBox, BlockWidget, HeaderFooterWidget, BlockContainer, BookmarkElementBox, FieldTextElementBox, TabElementBox } from './page';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Layout = /** @class */ (function () {\n    /**\n     * viewer definition\n     */\n    function Layout(viewer) {\n        /**\n         * @private\n         */\n        this.allowLayout = true;\n        /**\n         * @private\n         */\n        this.isInitialLoad = true;\n        this.fieldBegin = undefined;\n        this.maxTextHeight = 0;\n        this.maxBaseline = 0;\n        this.maxTextBaseline = 0;\n        this.isFieldCode = false;\n        this.viewer = viewer;\n    }\n    /**\n     * @private\n     */\n    Layout.prototype.layout = function () {\n        // Todo: Need to handle complete document layout(relayout).\n        var page = this.viewer.pages[0];\n        var body = page.bodyWidgets[0];\n    };\n    /**\n     * Releases un-managed and - optionally - managed resources.\n     */\n    Layout.prototype.destroy = function () {\n        this.viewer = undefined;\n        this.value = undefined;\n        this.allowLayout = undefined;\n        this.isInitialLoad = undefined;\n        this.fieldBegin = undefined;\n        this.maxTextHeight = undefined;\n        this.maxBaseline = undefined;\n        this.maxTextBaseline = undefined;\n        this.isFieldCode = undefined;\n    };\n    /**\n     * Layouts the items\n     * @private\n     */\n    Layout.prototype.layoutItems = function (sections) {\n        var _this = this;\n        var page;\n        for (var i = 0; i < sections.length; i++) {\n            var section = sections[i];\n            page = this.viewer.createNewPage(section);\n            this.addBodyWidget(this.viewer.clientActiveArea, section);\n            if (this.viewer.pages.length > 1) {\n                var pageIndex = 0;\n                for (var i_1 = 0; i_1 < this.viewer.pages.length; i_1++) {\n                    var prevPage = this.viewer.pages[i_1];\n                    var prevSectionIndex = prevPage.sectionIndex;\n                    var index = section.index;\n                    if (prevSectionIndex > index || prevPage === page) {\n                        break;\n                    }\n                    pageIndex++;\n                }\n                if (pageIndex < this.viewer.pages.length - 1) {\n                    this.viewer.insertPage(pageIndex, page);\n                }\n            }\n            this.layoutSection(section, 0, this.viewer);\n        }\n        this.updateFieldElements();\n        setTimeout(function () {\n            if (_this.viewer) {\n                _this.viewer.updateScrollBars();\n                _this.isInitialLoad = false;\n            }\n        });\n    };\n    /**\n     * Layouts the items\n     * @param section\n     * @param viewer\n     * @private\n     */\n    Layout.prototype.layoutSection = function (section, index, viewer, ownerWidget) {\n        var block = section.firstChild;\n        var nextBlock;\n        do {\n            this.viewer.updateClientAreaForBlock(block, true);\n            nextBlock = this.layoutBlock(block, index);\n            index = 0;\n            this.viewer.updateClientAreaForBlock(block, false);\n            block = nextBlock;\n        } while (block);\n    };\n    /**\n     * Layouts the header footer items\n     * @param section\n     * @param viewer\n     * @private\n     */\n    Layout.prototype.layoutHeaderFooter = function (section, viewer, page) {\n        //Header layout\n        var headerFooterWidget = viewer.getCurrentPageHeaderFooter(section, true);\n        if (headerFooterWidget) {\n            var header = headerFooterWidget.clone();\n            header.page = page;\n            viewer.updateHFClientArea(section.sectionFormat, true);\n            page.headerWidget = this.layoutHeaderFooterItems(viewer, header);\n            this.updateHeaderFooterToParent(header);\n        }\n        //Footer Layout\n        headerFooterWidget = viewer.getCurrentPageHeaderFooter(section, false);\n        if (headerFooterWidget) {\n            var footer = headerFooterWidget.clone();\n            footer.page = page;\n            viewer.updateHFClientArea(section.sectionFormat, false);\n            page.footerWidget = this.layoutHeaderFooterItems(viewer, footer);\n            this.updateHeaderFooterToParent(footer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateHeaderFooterToParent = function (node) {\n        var sectionIndex = node.page.sectionIndex;\n        var typeIndex = this.viewer.getHeaderFooter(node.headerFooterType);\n        var clone = node.clone();\n        this.viewer.headersFooters[sectionIndex][typeIndex] = clone;\n        for (var j = 0; j < clone.childWidgets.length; j++) {\n            var child = clone.childWidgets[j];\n            if (child instanceof TableWidget) {\n                this.clearTableWidget(child, false, true);\n            }\n        }\n        return clone;\n    };\n    Layout.prototype.linkFieldInHeaderFooter = function (widget) {\n        var firstChild = widget.firstChild;\n        do {\n            if (firstChild instanceof ParagraphWidget) {\n                this.linkFieldInParagraph(firstChild);\n            }\n            else {\n                this.linkFieldInTable(firstChild);\n            }\n            //tslint:disable:no-conditional-assignment\n        } while (firstChild = firstChild.nextWidget);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.linkFieldInParagraph = function (widget) {\n        for (var j = 0; j < widget.childWidgets.length; j++) {\n            var line = widget.childWidgets[j];\n            for (var i = 0; i < line.children.length; i++) {\n                var element = line.children[i];\n                if (element instanceof FieldElementBox && element.fieldType !== 0) {\n                    element.linkFieldCharacter(this.viewer);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.linkFieldInTable = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var row = widget.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < cell.childWidgets.length; k++) {\n                    var block = cell.childWidgets[k];\n                    if (block instanceof ParagraphWidget) {\n                        this.linkFieldInParagraph(block);\n                    }\n                    else {\n                        this.linkFieldInTable(block);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Layouts the header footer items.\n     * @param viewer\n     * @param hfModule\n     * @private\n     */\n    Layout.prototype.layoutHeaderFooterItems = function (viewer, widget) {\n        this.viewer.updateClientAreaLocation(widget, viewer.clientActiveArea);\n        if (widget.childWidgets.length === 0) {\n            var pargaraph = new ParagraphWidget();\n            var line = new LineWidget(pargaraph);\n            pargaraph.childWidgets.push(line);\n            widget.childWidgets.push(pargaraph);\n            pargaraph.containerWidget = widget;\n        }\n        this.linkFieldInHeaderFooter(widget);\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var block = widget.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            this.layoutBlock(block, 0);\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        var type = widget.headerFooterType;\n        if (type === 'OddFooter' || type === 'EvenFooter' || type === 'FirstPageFooter') {\n            this.shiftChildLocation(viewer.clientArea.y - viewer.clientActiveArea.y, widget);\n        }\n        return widget;\n    };\n    /**\n     * Shifts the child location\n     * @param shiftTop\n     * @param bodyWidget\n     */\n    Layout.prototype.shiftChildLocation = function (shiftTop, bodyWidget) {\n        var widgetTop = bodyWidget.y + shiftTop;\n        var footerMaxHeight = bodyWidget.page.boundingRectangle.height - (bodyWidget.page.boundingRectangle.height / 100) * 40;\n        widgetTop = Math.max(widgetTop, footerMaxHeight);\n        shiftTop = widgetTop - bodyWidget.y;\n        bodyWidget.y = widgetTop;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var childWidget = bodyWidget.childWidgets[i];\n            if (childWidget instanceof ParagraphWidget) {\n                childWidget.x = childWidget.x;\n                childWidget.y = childWidget.y + shiftTop;\n            }\n            else {\n                this.shiftChildLocationForTableWidget(childWidget, shiftTop);\n            }\n        }\n    };\n    /**\n     * Shifts the child location for table widget.\n     * @param tableWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableWidget = function (tableWidget, shiftTop) {\n        tableWidget.y = tableWidget.y + shiftTop;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var childWidget = tableWidget.childWidgets[i];\n            if (childWidget instanceof TableRowWidget) {\n                this.shiftChildLocationForTableRowWidget(childWidget, shiftTop);\n            }\n        }\n    };\n    /**\n     * Shifts the child location for table row widget.\n     * @param rowWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableRowWidget = function (rowWidget, shiftTop) {\n        rowWidget.y = rowWidget.y + shiftTop;\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            this.shiftChildLocationForTableCellWidget(rowWidget.childWidgets[i], shiftTop);\n        }\n    };\n    /**\n     * Shifts the child location for table cell widget.\n     * @param cellWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableCellWidget = function (cellWidget, shiftTop) {\n        cellWidget.y = cellWidget.y + shiftTop;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                cellWidget.childWidgets[i].x = cellWidget.childWidgets[i].x;\n                cellWidget.childWidgets[i].y = cellWidget.childWidgets[i].y + shiftTop;\n            }\n            else {\n                this.shiftChildLocationForTableWidget(cellWidget.childWidgets[i], shiftTop);\n            }\n        }\n    };\n    /**\n     * Layouts specified block.\n     * @param block\n     * @private\n     */\n    Layout.prototype.layoutBlock = function (block, index, moveToLine) {\n        var nextBlock;\n        if (block instanceof ParagraphWidget) {\n            nextBlock = this.layoutParagraph(block, index);\n        }\n        else {\n            nextBlock = this.layoutTable(block, index);\n        }\n        return nextBlock.nextRenderedWidget;\n    };\n    /**\n     * Adds paragraph widget.\n     * @param area\n     */\n    Layout.prototype.addParagraphWidget = function (area, paragraphWidget) {\n        var ownerParaWidget = undefined;\n        if (paragraphWidget.isEmpty() && !isNullOrUndefined(paragraphWidget.paragraphFormat) &&\n            (paragraphWidget.paragraphFormat.textAlignment === 'Center' || paragraphWidget.paragraphFormat.textAlignment === 'Right') &&\n            paragraphWidget.paragraphFormat.listFormat.listId === -1) {\n            var top_1 = 0;\n            var bottom = 0;\n            var width = this.viewer.textHelper.getParagraphMarkWidth(paragraphWidget.characterFormat);\n            var left = area.x;\n            if (paragraphWidget.paragraphFormat.textAlignment === 'Center') {\n                left += (area.width - width) / 2;\n            }\n            else {\n                left += area.width - width;\n            }\n            paragraphWidget.width = width;\n            paragraphWidget.x = left;\n            paragraphWidget.y = area.y;\n        }\n        else {\n            paragraphWidget.width = area.width;\n            paragraphWidget.x = area.x;\n            paragraphWidget.y = area.y;\n        }\n        return paragraphWidget;\n    };\n    /**\n     * Adds line widget.\n     * @param paragraph\n     */\n    Layout.prototype.addLineWidget = function (paragraphWidget) {\n        var line = undefined;\n        line = new LineWidget(paragraphWidget);\n        line.width = paragraphWidget.width;\n        paragraphWidget.childWidgets.push(line);\n        line.paragraph = paragraphWidget;\n        return line;\n    };\n    /**\n     * Layouts specified paragraph.\n     * @private\n     * @param paragraph\n     */\n    Layout.prototype.layoutParagraph = function (paragraph, lineIndex) {\n        this.addParagraphWidget(this.viewer.clientActiveArea, paragraph);\n        this.layoutListItems(paragraph);\n        if (paragraph.isEmpty()) {\n            this.layoutEmptyLineWidget(paragraph, true);\n        }\n        else {\n            var line = lineIndex < paragraph.childWidgets.length ?\n                paragraph.childWidgets[lineIndex] : undefined;\n            while (line instanceof LineWidget) {\n                if (line.isFirstLine() && isNullOrUndefined(this.fieldBegin)) {\n                    if (!isNullOrUndefined(paragraph.paragraphFormat)) {\n                        // tslint:disable-next-line:max-line-length\n                        var firstLineIndent = -HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                        this.viewer.updateClientWidth(firstLineIndent);\n                    }\n                }\n                line = this.layoutLine(line, 0);\n                paragraph = line.paragraph;\n                line = line.nextLine;\n            }\n        }\n        this.updateWidgetToPage(this.viewer, paragraph);\n        return paragraph;\n    };\n    Layout.prototype.clearLineMeasures = function () {\n        this.maxBaseline = 0;\n        this.maxTextBaseline = 0;\n        this.maxTextHeight = 0;\n    };\n    Layout.prototype.moveElementFromNextLine = function (line) {\n        var nextLine = line.nextLine;\n        while (nextLine instanceof LineWidget) {\n            if (nextLine.children.length > 0) {\n                var element = nextLine.children.splice(0, 1)[0];\n                line.children.push(element);\n                element.line = line;\n                break;\n            }\n            else {\n                if (nextLine.paragraph.childWidgets.length === 1) {\n                    nextLine.paragraph.destroy();\n                }\n                else {\n                    nextLine.destroy();\n                }\n                nextLine = line.nextLine;\n            }\n        }\n    };\n    Layout.prototype.layoutLine = function (line, count) {\n        var paragraph = line.paragraph;\n        if (line.children.length === 0) {\n            this.moveElementFromNextLine(line);\n        }\n        var element = line.children[count];\n        this.clearLineMeasures();\n        while (element instanceof ElementBox) {\n            this.layoutElement(element, paragraph);\n            line = element.line;\n            element = element.nextElement;\n        }\n        return line;\n    };\n    // tslint:disable:max-func-body-length\n    Layout.prototype.layoutElement = function (element, paragraph) {\n        var line = element.line;\n        var text = '';\n        var index = element.indexInOwner;\n        if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0 && this.viewer.fields.indexOf(element) === -1) {\n                this.viewer.fields.push(element);\n            }\n            this.layoutFieldCharacters(element);\n            if (element.line.isLastLine() && isNullOrUndefined(element.nextNode) && !this.isFieldCode) {\n                if (isNullOrUndefined(element.fieldSeparator)) {\n                    this.layoutEmptyLineWidget(paragraph, false, element.line);\n                }\n                this.moveToNextLine(line);\n            }\n            else if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            else if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width === 0) {\n                this.moveToNextLine(line);\n                if (line.paragraph.lastChild === line && !isNullOrUndefined(line.nextLine) &&\n                    this.viewer.clientActiveArea.height >= 0) {\n                    this.moveFromNextPage(line);\n                }\n            }\n            return;\n        }\n        if (element instanceof ListTextElementBox || this.isFieldCode || element instanceof BookmarkElementBox) {\n            if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            if (element.line.isLastLine() && isNullOrUndefined(element.nextElement)) {\n                if (this.hasValidElement(line.paragraph)) {\n                    this.moveToNextLine(line);\n                }\n                else {\n                    this.layoutEmptyLineWidget(line.paragraph, false, line, false);\n                }\n            }\n            return;\n        }\n        var width = element.width;\n        if (element instanceof FieldTextElementBox) {\n            text = this.viewer.getFieldResult(element.fieldBegin, element.paragraph.bodyWidget.page);\n            if (text !== '') {\n                element.text = text;\n            }\n            else {\n                text = element.text;\n            }\n        }\n        else if (element instanceof TextElementBox) {\n            this.checkAndSplitTabOrLineBreakCharacter(element.text, element);\n            text = element.text;\n        }\n        // Here field code width and height update need to skipped based on the hidden property.\n        if (element instanceof TextElementBox) {\n            width = this.viewer.textHelper.getTextSize(element, element.characterFormat);\n            if (element.text === '\\t') {\n                element.width = this.getTabWidth(paragraph, this.viewer, index, line, element);\n            }\n        }\n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, line);\n            if (element instanceof FieldTextElementBox) {\n                this.updateFieldText(element);\n            }\n            if (element.previousElement) {\n                this.cutClientWidth(element.previousElement);\n            }\n        }\n        if (width < this.viewer.clientActiveArea.width || !this.viewer.textWrap) {\n            //Fits the text in current line.\n            this.addElementToLine(paragraph, element);\n            if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            else if (!element.line.isLastLine() && isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width === 0) {\n                this.moveToNextLine(line);\n                if (line.paragraph.lastChild === line && this.viewer.clientActiveArea.height >= 0) {\n                    this.moveFromNextPage(line);\n                }\n            }\n        }\n        else if (element instanceof TextElementBox) {\n            if (element.text === '\\t') {\n                var currentLine = element.line;\n                this.addSplittedLineWidget(currentLine, currentLine.children.indexOf(element));\n                this.moveToNextLine(currentLine);\n                // Recalculates tab width based on new client active area X position\n                element.width = this.getTabWidth(paragraph, this.viewer, index, line, element);\n                this.addElementToLine(paragraph, element);\n            }\n            else {\n                //Splits the text and arrange line by line, till end of text.\n                do {\n                    line = element.line;\n                    this.splitTextForClientArea(line, element, element.text, element.width, element.characterFormat);\n                    this.checkLineWidgetWithClientArea(line, element);\n                    if (element instanceof FieldTextElementBox) {\n                        this.updateFieldText(element);\n                    }\n                } while (element.line !== line && this.cutClientWidth(element));\n            }\n        }\n        else {\n            do {\n                line = element.line;\n                this.splitElementForClientArea(paragraph, element);\n                this.checkLineWidgetWithClientArea(line, element);\n                if (element instanceof FieldTextElementBox) {\n                    this.updateFieldText(element);\n                }\n            } while (element.line !== line && this.cutClientWidth(element));\n        }\n        if (text === '\\v' || text === '\\f') {\n            var elementIndex = line.children.indexOf(element);\n            if (elementIndex > -1) {\n                this.addSplittedLineWidget(line, elementIndex);\n            }\n        }\n        if (element.line.isLastLine() && isNullOrUndefined(element.nextElement) || text === '\\v' || text === '\\f') {\n            this.moveToNextLine(element.line);\n            if (text === '\\v' && isNullOrUndefined(element.nextNode)) {\n                this.layoutEmptyLineWidget(paragraph, true, line, true);\n            }\n            else if (text === '\\f') {\n                if (isNullOrUndefined(element.nextNode)) {\n                    this.moveToNextPage(this.viewer, element.line, true);\n                }\n                else {\n                    this.moveToNextPage(this.viewer, element.line.nextLine, false);\n                }\n            }\n        }\n    };\n    /**\n     * Return true if paragraph has valid inline\n     * @private\n     */\n    Layout.prototype.hasValidElement = function (paragraph) {\n        var line = paragraph.firstChild;\n        if (line && !isNullOrUndefined(this.viewer.selection)) {\n            var elementBox = line.children[0];\n            while (elementBox) {\n                if (elementBox instanceof FieldElementBox) {\n                    elementBox = this.viewer.selection.getNextValidElementForField(elementBox);\n                    if (!elementBox.line.paragraph.equals(paragraph)) {\n                        return false;\n                    }\n                }\n                if (elementBox instanceof TextElementBox) {\n                    return true;\n                }\n                elementBox = elementBox.nextNode;\n            }\n        }\n        return false;\n    };\n    Layout.prototype.updateFieldText = function (element) {\n        // tslint:disable-next-line:max-line-length\n        var text = this.viewer.getFieldResult(element.fieldBegin, element.paragraph.bodyWidget.page);\n        if (text !== '') {\n            element.text = text;\n            this.viewer.textHelper.getTextSize(element, element.characterFormat);\n        }\n    };\n    Layout.prototype.checkLineWidgetWithClientArea = function (line, element) {\n        if (line !== element.line || element.line === line && isNullOrUndefined(element.nextElement)\n            && !element.line.isLastLine()) {\n            this.moveToNextLine(line);\n        }\n        if (element.line !== line && this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height &&\n            this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, element.line);\n        }\n        else if (element.line === line && isNullOrUndefined(element.nextElement)\n            && line.paragraph.lastChild === line && !line.isLastLine() && this.viewer.clientActiveArea.height >= 0) {\n            this.moveFromNextPage(line);\n        }\n    };\n    Layout.prototype.checkAndSplitTabOrLineBreakCharacter = function (text, element) {\n        var char = ['\\t', '\\v', '\\f'];\n        var index = HelperMethods.indexOfAny(text, char);\n        if (index > -1) {\n            var character = text[index];\n            if ((character === '\\t' && text !== '\\t') || (character === '\\v' && text !== '\\v')\n                || (character === '\\f' && text !== '\\f')) {\n                this.splitByLineBreakOrTab(this.viewer, element, index, character);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.moveFromNextPage = function (line) {\n        var nextLine = line.nextLine;\n        if (nextLine && line.paragraph.childWidgets.indexOf(nextLine) === -1) {\n            nextLine.paragraph.childWidgets.splice(nextLine.indexInOwner, 1);\n            line.paragraph.childWidgets.push(nextLine);\n            nextLine.paragraph = line.paragraph;\n        }\n    };\n    Layout.prototype.cutClientWidth = function (currentElement) {\n        this.clearLineMeasures();\n        var line = currentElement.line;\n        var width = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            width += element.width;\n            if (currentElement === element) {\n                break;\n            }\n        }\n        var splitCurrentWidget = this.viewer.clientActiveArea.width - width < 0;\n        if (!splitCurrentWidget) {\n            this.viewer.cutFromLeft(this.viewer.clientActiveArea.x + width);\n            if (currentElement.line.paragraph.paragraphFormat.textAlignment === 'Justify' &&\n                currentElement instanceof TextElementBox) {\n                this.splitTextElementWordByWord(currentElement);\n            }\n            if (isNullOrUndefined(currentElement.nextElement) && this.viewer.clientActiveArea.width > 0\n                && !currentElement.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n        }\n        else if (currentElement.previousElement) {\n            this.cutClientWidth(currentElement.previousElement);\n        }\n        return splitCurrentWidget;\n    };\n    Layout.prototype.layoutFieldCharacters = function (element) {\n        if (element.fieldType === 0) {\n            if (!this.isFieldCode && (!isNullOrUndefined(element.fieldEnd) || element.hasFieldEnd)) {\n                this.viewer.fieldStacks.push(element);\n                this.isFieldCode = true;\n                element.hasFieldEnd = true;\n            }\n        }\n        else if (this.viewer.fieldStacks.length > 0) {\n            if (element.fieldType === 2) {\n                var field = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                if (field.fieldSeparator === element && (!isNullOrUndefined(field.fieldEnd) || field.hasFieldEnd)) {\n                    this.isFieldCode = false;\n                }\n            }\n            else {\n                var field = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                if (element === field.fieldEnd) {\n                    this.viewer.fieldStacks.pop();\n                    this.isFieldCode = false;\n                }\n            }\n        }\n    };\n    /**\n     * Layouts empty line widget.\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.layoutEmptyLineWidget = function (paragraph, isEmptyLine, line, isShiftEnter) {\n        isShiftEnter = isNullOrUndefined(isShiftEnter) ? false : isShiftEnter;\n        //Calculate line height and descent based on formatting defined in paragraph.\n        var paragraphMarkSize = this.viewer.textHelper.getParagraphMarkSize(paragraph.characterFormat);\n        var maxHeight = paragraphMarkSize.Height;\n        var beforeSpacing = this.getBeforeSpacing(paragraph);\n        var lineWidget;\n        if (paragraph.childWidgets.length > 0 && !isShiftEnter) {\n            lineWidget = paragraph.childWidgets[0];\n        }\n        else {\n            lineWidget = isEmptyLine ? this.addLineWidget(paragraph) : line;\n        }\n        //isNullOrUndefined(this.viewer.currentHeaderFooter) && \n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < beforeSpacing + maxHeight\n            && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, lineWidget);\n        }\n        //Gets line spacing.\n        var lineSpacing = this.getLineSpacing(paragraph, maxHeight);\n        var maxDescent = maxHeight - paragraphMarkSize.BaselineOffset;\n        //Calculate the bottom position of current line - max height + line spacing.\n        if (!isNaN(this.maxTextHeight)\n            && maxHeight < this.maxTextHeight) {\n            maxHeight = this.maxTextHeight;\n            maxDescent = maxHeight - this.maxTextBaseline;\n        }\n        var topMargin = 0;\n        var bottomMargin = 0;\n        var leftMargin = 0;\n        var height = maxHeight;\n        var lineSpacingType = paragraph.paragraphFormat.lineSpacingType;\n        if (lineSpacingType === 'Multiple') {\n            if (lineSpacing > maxHeight) {\n                bottomMargin += lineSpacing - maxHeight;\n            }\n            else {\n                topMargin += lineSpacing - maxHeight;\n            }\n        }\n        else if (lineSpacingType === 'Exactly') {\n            topMargin += lineSpacing - (topMargin + height + bottomMargin);\n        }\n        else if (lineSpacing > topMargin + height + bottomMargin) {\n            topMargin += lineSpacing - (topMargin + height + bottomMargin);\n        }\n        topMargin += beforeSpacing;\n        bottomMargin += HelperMethods.convertPointToPixel(paragraph.paragraphFormat.afterSpacing);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var element = lineWidget.children[i];\n            if (element instanceof ListTextElementBox) {\n                var textAlignment = paragraph.paragraphFormat.textAlignment;\n                if (textAlignment === 'Right') { //Aligns the text as right justified.\n                    leftMargin = this.viewer.clientArea.width - element.width;\n                }\n                else if (textAlignment === 'Center') { //Aligns the text as center justified.\n                    leftMargin = (this.viewer.clientArea.width - element.width) / 2;\n                }\n                element.margin = new Margin(leftMargin, topMargin, 0, bottomMargin);\n                element.line = lineWidget;\n                lineWidget.height = topMargin + height + bottomMargin;\n            }\n        }\n        lineWidget.height = topMargin + height + bottomMargin;\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + lineWidget.height);\n        //Clears the previous line elements from collection.     \n    };\n    /**\n     * @private\n     */\n    Layout.prototype.layoutListItems = function (paragraph) {\n        if (!this.isFieldCode) {\n            if (!isNullOrUndefined(paragraph.paragraphFormat)\n                && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)\n                && !isNullOrUndefined(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId)) &&\n                paragraph.paragraphFormat.listFormat.listLevelNumber >= 0\n                && paragraph.paragraphFormat.listFormat.listLevelNumber < 9) {\n                this.clearListElementBox(paragraph);\n                this.layoutList(paragraph, this.viewer);\n            }\n            else if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId === -1) {\n                this.clearListElementBox(paragraph);\n            }\n        }\n    };\n    /**\n     * Layouts list.\n     * @param viewer\n     */\n    Layout.prototype.layoutList = function (paragraph, viewer) {\n        var list = viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n        viewer.updateClientWidth(-HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent));\n        var currentListLevel = this.getListLevel(list, paragraph.paragraphFormat.listFormat.listLevelNumber);\n        // if (isNullOrUndefined(currentListLevel)) {\n        //     return;\n        // }\n        var lineWidget = paragraph.childWidgets[0];\n        if (isNullOrUndefined(lineWidget)) {\n            lineWidget = new LineWidget(paragraph);\n            paragraph.childWidgets.push(lineWidget);\n        }\n        var element = new ListTextElementBox(currentListLevel, false);\n        element.line = lineWidget;\n        if (currentListLevel.listLevelPattern === 'Bullet') {\n            element.text = currentListLevel.numberFormat;\n        }\n        else {\n            element.text = this.getListNumber(paragraph.paragraphFormat.listFormat);\n        }\n        viewer.textHelper.updateTextSize(element, paragraph);\n        var moveToNextPage;\n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            moveToNextPage = true;\n        }\n        viewer.cutFromLeft(viewer.clientActiveArea.x + element.width);\n        //Adds the text element to the line\n        lineWidget.children.splice(0, 0, element);\n        if (currentListLevel.followCharacter !== 'None') {\n            element = new ListTextElementBox(currentListLevel, true);\n            if (currentListLevel.followCharacter === 'Tab') {\n                element.text = '\\t';\n                var index = lineWidget.children.indexOf(element);\n                element.width = this.getTabWidth(paragraph, viewer, index, lineWidget, undefined);\n            }\n            else {\n                element.text = ' ';\n                viewer.textHelper.updateTextSize(element, paragraph);\n            }\n            viewer.cutFromLeft(viewer.clientActiveArea.x + element.width);\n            //Adds the tabSpace to the line\n            lineWidget.children.splice(1, 0, element);\n            element.line = lineWidget;\n        }\n        if (moveToNextPage) {\n            this.moveToNextPage(this.viewer, lineWidget);\n            this.cutClientWidth(element);\n            return;\n        }\n        if (currentListLevel.followCharacter !== 'None') {\n            viewer.updateClientWidth(HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent));\n        }\n    };\n    /**\n     * Adds body widget.\n     * @param area\n     * @param section\n     * @private\n     */\n    Layout.prototype.addBodyWidget = function (area, widget) {\n        var bodyWidget;\n        if (widget) {\n            bodyWidget = widget;\n        }\n        else {\n            bodyWidget = new BodyWidget();\n        }\n        bodyWidget.width = area.width;\n        bodyWidget.x = area.x;\n        bodyWidget.y = area.y;\n        // this.addSectionInDictionary(this.viewer, section, bodyWidget);\n        return bodyWidget;\n    };\n    /**\n     * Adds list level.\n     * @param abstractList\n     */\n    Layout.prototype.addListLevels = function (abstractList) {\n        for (var i = abstractList.levels.length; i < 9; i++) {\n            var listLevel = new WListLevel(abstractList);\n            var val = i % 3;\n            if (abstractList.levels[0].listLevelPattern === 'Bullet') {\n                listLevel.listLevelPattern = 'Bullet';\n                listLevel.numberFormat = val === 0 ? '\\uf0b7' : val === 1 ? '\\uf0a7' : '\\uf0d8';\n                listLevel.characterFormat.fontFamily = listLevel.numberFormat === '\\uf0a7' || '\\uf0d8' ? 'Wingdings' : 'Symbol';\n            }\n            else {\n                listLevel.listLevelPattern = this.getListLevelPattern(val);\n                listLevel.numberFormat = '%' + (i + 1).toString() + '.';\n                listLevel.startAt = 1;\n                listLevel.restartLevel = i;\n            }\n            listLevel.paragraphFormat = new WParagraphFormat(undefined);\n            listLevel.paragraphFormat.leftIndent = 48 * (i + 1);\n            listLevel.paragraphFormat.firstLineIndent = -24;\n            abstractList.levels.push(listLevel);\n        }\n    };\n    Layout.prototype.addSplittedLineWidget = function (lineWidget, elementIndex, splittedElementBox) {\n        var paragraph = lineWidget.paragraph;\n        var movedElementBox = [];\n        var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n        if (!isNullOrUndefined(splittedElementBox)) {\n            movedElementBox.push(splittedElementBox);\n        }\n        var newLineWidget = undefined;\n        //Move Next element box to temp collection\n        for (var i = elementIndex + 1; i < lineWidget.children.length; i++) {\n            movedElementBox.push(lineWidget.children[i]);\n        }\n        if (movedElementBox.length > 0) {\n            if (lineIndex === paragraph.childWidgets.length - 1) {\n                newLineWidget = new LineWidget(paragraph);\n            }\n            else {\n                newLineWidget = paragraph.childWidgets[lineIndex + 1];\n            }\n            for (var j = 0; j < movedElementBox.length; j++) {\n                movedElementBox[j].line = newLineWidget;\n            }\n            lineWidget.children.splice(elementIndex + 1, lineWidget.children.length - 1);\n            newLineWidget.children = movedElementBox.concat(newLineWidget.children);\n            if (paragraph.childWidgets.indexOf(newLineWidget) === -1) {\n                paragraph.childWidgets.splice(lineIndex + 1, 0, newLineWidget);\n            }\n        }\n    };\n    /**\n     * Adds element to line.\n     * @param element\n     */\n    Layout.prototype.addElementToLine = function (paragraph, element) {\n        this.viewer.cutFromLeft(this.viewer.clientActiveArea.x + element.width);\n        if (paragraph.paragraphFormat.textAlignment === 'Justify' && element instanceof TextElementBox) {\n            this.splitTextElementWordByWord(element);\n        }\n    };\n    /**\n     * Splits element for client area.\n     * @param element\n     */\n    Layout.prototype.splitElementForClientArea = function (paragraph, element) {\n        var line = element.line;\n        if (element.line.children.length > 0) {\n            var previousElement = element.previousElement;\n            var index = element.indexInOwner;\n            // if line widget contain only single image element box need to skip this from splitting\n            // else move element to next line\n            if (element.line.children.length > 1) {\n                if (previousElement && this.viewer.clientActiveArea.x !== this.viewer.clientArea.x) {\n                    index -= 1;\n                }\n            }\n            this.addSplittedLineWidget(element.line, index);\n        }\n    };\n    /**\n     * Splits by word\n     * @param elementBox\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitByWord = function (lineWidget, paragraph, elementBox, text, width, characterFormat) {\n        var index = this.getSplitIndexByWord(this.viewer.clientActiveArea.width, text, width, characterFormat);\n        if (index > 0 && index < elementBox.length) {\n            var indexOf = lineWidget.children.indexOf(elementBox);\n            var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n            var splittedElementBox = new TextElementBox();\n            text = text.substring(index);\n            splittedElementBox.text = text;\n            if (text[0] === ' ') {\n                var prevLength = text.length;\n                text = HelperMethods.trimStart(text); //To trim white space at starting of the text.\n                index += prevLength - text.length;\n            }\n            splittedElementBox.characterFormat.copyFormat(elementBox.characterFormat);\n            splittedElementBox.width = this.viewer.textHelper.getWidth(splittedElementBox.text, characterFormat);\n            elementBox.text = elementBox.text.substr(0, index);\n            elementBox.width -= splittedElementBox.width;\n            splittedElementBox.height = elementBox.height;\n            splittedElementBox.baselineOffset = elementBox.baselineOffset;\n            this.addSplittedLineWidget(lineWidget, indexOf, splittedElementBox);\n            this.addElementToLine(paragraph, elementBox);\n            if (elementBox.width === 0) {\n                lineWidget.children.splice(indexOf, 1);\n            }\n        }\n    };\n    /**\n     * Splits by character.\n     * @param textElement\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitByCharacter = function (lineWidget, textElement, text, width, characterFormat) {\n        var paragraph = lineWidget.paragraph;\n        // tslint:disable-next-line:max-line-length\n        var index = this.getTextSplitIndexByCharacter(this.viewer.clientArea.width, this.viewer.clientActiveArea.width, text, width, characterFormat);\n        var splitWidth = 0;\n        if (index < textElement.length) {\n            splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.substring(0, index), characterFormat);\n            text = text.substring(index);\n        }\n        if (splitWidth > this.viewer.clientActiveArea.width && textElement.indexInOwner > 0) {\n            this.addSplittedLineWidget(lineWidget, textElement.indexInOwner - 1);\n            return;\n        }\n        var indexOf = lineWidget.children.indexOf(textElement);\n        if (index < textElement.length) {\n            var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n            var splittedElement = new TextElementBox();\n            splittedElement.text = text;\n            textElement.text = textElement.text.substr(0, index);\n            splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n            splittedElement.width = this.viewer.textHelper.getWidth(splittedElement.text, characterFormat);\n            textElement.width -= splittedElement.width;\n            splittedElement.height = textElement.height;\n            splittedElement.baselineOffset = textElement.baselineOffset;\n            lineWidget.children.splice(textElement.indexInOwner + 1, 0, splittedElement);\n            this.addSplittedLineWidget(lineWidget, indexOf);\n            this.addElementToLine(paragraph, textElement);\n            if (textElement.width === 0) {\n                lineWidget.children.splice(indexOf, 1);\n            }\n        }\n        else {\n            //Adds the last text element on inline to line elements collection. \n            this.addSplittedLineWidget(lineWidget, indexOf);\n            this.addElementToLine(paragraph, textElement);\n        }\n    };\n    /**\n     * Splits text element word by word.\n     * @param textElement\n     */\n    Layout.prototype.splitTextElementWordByWord = function (textElement) {\n        var lineWidget = textElement.line;\n        var indexOf = lineWidget.children.indexOf(textElement);\n        var text = textElement.text;\n        var format;\n        var characterUptoWs = text.trim().indexOf(' ');\n        if (characterUptoWs >= 0) {\n            lineWidget.children.splice(indexOf, 1);\n            format = textElement.characterFormat;\n            var fontSize = format.fontSize;\n            var index = textElement.length - HelperMethods.trimStart(text).length; //Trim start\n            while (index < textElement.length) {\n                index = this.getTextIndexAfterSpace(text, index);\n                if (index === 0 || index === textElement.length) {\n                    break;\n                }\n                if (index < textElement.length) {\n                    var splittedElement = new TextElementBox();\n                    var splittedText = text.substring(0, index);\n                    text = text.substring(index);\n                    if (text.substring(0, 1) === ' ') {\n                        // start of the text is trimmed and its length is reduced from text length.                        \n                        index += text.length - HelperMethods.trimStart(text).length;\n                    }\n                    splittedElement.text = splittedText;\n                    splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n                    splittedElement.line = lineWidget;\n                    splittedElement.width = this.viewer.textHelper.getWidth(splittedElement.text, format);\n                    splittedElement.height = textElement.height;\n                    splittedElement.baselineOffset = textElement.baselineOffset;\n                    lineWidget.children.splice(indexOf, 0, splittedElement);\n                    textElement.text = text;\n                    textElement.width -= splittedElement.width;\n                    if (textElement.width === 0) {\n                        lineWidget.children.splice(lineWidget.children.indexOf(textElement), 1);\n                    }\n                    index = 0;\n                    indexOf++;\n                }\n            }\n            textElement.text = text;\n            lineWidget.children.splice(indexOf, 0, textElement);\n        }\n    };\n    /**\n     * Splits text for client area.\n     * @param element\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitTextForClientArea = function (lineWidget, element, text, width, characterFormat) {\n        var paragraph = lineWidget.paragraph;\n        var isSplitByWord = true;\n        var index = -1;\n        if (!(text.substring(0, 1) === ' ')) {\n            var textWidth = width;\n            var characterUptoWS = 0;\n            characterUptoWS = HelperMethods.trimEnd(text).indexOf(' ') + 1;\n            index = characterUptoWS;\n            //Checks whether text not starts with white space. If starts with white space, no need to check previous text blocks.\n            if (index > 0) {\n                textWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.slice(0, index), characterFormat);\n            }\n            if (this.viewer.clientActiveArea.width < textWidth) {\n                //Check and split the previous text elements to next line.            \n                isSplitByWord = this.checkPreviousElement(lineWidget, lineWidget.children.indexOf(element), characterFormat);\n                if (isSplitByWord) {\n                    //lineWidget = paragraph.childWidgets[paragraph.childWidgets.indexOf(lineWidget) + 1] as LineWidget;\n                    //isSplitByWord = textWidth <= this.viewer.clientActiveArea.width;\n                    return;\n                }\n            }\n        }\n        else {\n            index = 1;\n        }\n        if (width <= this.viewer.clientActiveArea.width) {\n            //Fits the text in current line.\n            this.addElementToLine(paragraph, element);\n        }\n        else if (isSplitByWord && (index > 0 || text.indexOf(' ') !== -1)) {\n            this.splitByWord(lineWidget, paragraph, element, text, width, characterFormat);\n        }\n        else {\n            this.splitByCharacter(lineWidget, element, text, width, characterFormat);\n        }\n    };\n    /**\n     * Handle tab or line break character splitting\n     * @param  {LayoutViewer} viewer\n     * @param  {TextElementBox} span\n     * @param  {number} index\n     * @param  {string} spiltBy\n     * @private\n     */\n    Layout.prototype.splitByLineBreakOrTab = function (viewer, span, index, spiltBy) {\n        // Splits tab character to separate SpanAdv\n        var inlineIndex = span.line.children.indexOf(span);\n        var value = span.text;\n        var remainder = value.substring(index);\n        var newSpan = spiltBy === '\\t' ? new TabElementBox() : new TextElementBox();\n        newSpan.line = span.line;\n        newSpan.characterFormat.copyFormat(span.characterFormat);\n        span.line.children.splice(inlineIndex + 1, 0, newSpan);\n        if (index > 0 && remainder.length === 1) {\n            newSpan.text = value.substring(index);\n            span.text = value.substring(0, index);\n        }\n        else if (index > 0) {\n            newSpan.text = spiltBy;\n            var newText = new TextElementBox();\n            newText.line = span.line;\n            newText.text = value.substring(index + 1);\n            newText.characterFormat.copyFormat(span.characterFormat);\n            span.line.children.splice(inlineIndex + 2, 0, newText);\n            span.text = value.substring(0, index);\n        }\n        else if (remainder !== '') {\n            newSpan.text = value.substring(index + 1);\n            span.text = spiltBy;\n        }\n    };\n    /**\n     * Moves to next line.\n     */\n    Layout.prototype.moveToNextLine = function (line) {\n        var paragraph = line.paragraph;\n        var paraFormat = paragraph.paragraphFormat;\n        var isParagraphStart = line.isFirstLine();\n        var isParagraphEnd = line.isLastLine();\n        var height = 0;\n        var maxDescent = 0;\n        var afterSpacing = 0;\n        var beforeSpacing = 0;\n        var lineSpacing = 0;\n        var firstLineIndent = 0;\n        this.updateLineWidget(line);\n        height = this.maxTextHeight;\n        maxDescent = height - this.maxTextBaseline;\n        //Updates before spacing at the top of Paragraph first line.\n        if (isParagraphStart) {\n            beforeSpacing = this.getBeforeSpacing(paragraph);\n            firstLineIndent = HelperMethods.convertPointToPixel(paraFormat.firstLineIndent);\n        }\n        //Updates after spacing at the bottom of Paragraph last line.\n        if (isParagraphEnd) {\n            afterSpacing = HelperMethods.convertPointToPixel(paraFormat.afterSpacing);\n        }\n        if (isNaN(this.maxTextHeight)) {\n            //Calculate line height and descent based on formatting defined in paragraph.\n            var measurement = this.viewer.textHelper.measureText('a', paragraph.characterFormat);\n            height = measurement.Height;\n            maxDescent = height - measurement.BaselineOffset;\n        }\n        else {\n            height = this.maxTextHeight;\n            maxDescent = height - this.maxTextBaseline;\n        }\n        // Gets line spacing.\n        lineSpacing = this.getLineSpacing(paragraph, height);\n        if (paraFormat.lineSpacingType === 'Exactly'\n            && lineSpacing < maxDescent + this.maxBaseline) {\n            lineSpacing = maxDescent + this.maxBaseline;\n        }\n        var subWidth = 0;\n        var whiteSpaceCount = 0;\n        var textAlignment = paraFormat.textAlignment;\n        //Calculates the sub width, for text alignments - Center, Right, Justify.\n        if (textAlignment !== 'Left' && this.viewer.textWrap && !(textAlignment === 'Justify' && isParagraphEnd)) {\n            // tslint:disable-next-line:max-line-length\n            var getWidthAndSpace = this.getSubWidth(line, textAlignment === 'Justify', whiteSpaceCount, firstLineIndent);\n            subWidth = getWidthAndSpace.subWidth;\n            whiteSpaceCount = getWidthAndSpace.spaceCount;\n        }\n        var addSubWidth = false;\n        var lineSpacingType = paraFormat.lineSpacingType;\n        for (var i = 0; i < line.children.length; i++) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var leftMargin = 0;\n            var elementBox = line.children[i];\n            // tslint:disable-next-line:max-line-length\n            var alignElements = this.alignLineElements(elementBox, topMargin, bottomMargin, maxDescent, addSubWidth, subWidth, textAlignment, whiteSpaceCount, i === line.children.length - 1);\n            topMargin = alignElements.topMargin;\n            bottomMargin = alignElements.bottomMargin;\n            addSubWidth = alignElements.addSubWidth;\n            whiteSpaceCount = alignElements.whiteSpaceCount;\n            //Updates line spacing, paragraph after/ before spacing and aligns the text to base line offset.\n            if (lineSpacingType === 'Multiple') {\n                if (lineSpacing > height) {\n                    bottomMargin += lineSpacing - height;\n                }\n                else {\n                    topMargin += lineSpacing - height;\n                }\n            }\n            else if (lineSpacingType === 'Exactly') {\n                topMargin += lineSpacing - (topMargin + elementBox.height + bottomMargin);\n            }\n            else if (lineSpacing > topMargin + elementBox.height + bottomMargin) {\n                topMargin += lineSpacing - (topMargin + elementBox.height + bottomMargin);\n            }\n            topMargin += beforeSpacing;\n            bottomMargin += afterSpacing;\n            if (i === 0) {\n                line.height = topMargin + elementBox.height + bottomMargin;\n                if (textAlignment === 'Right') {\n                    //Aligns the text as right justified.\n                    leftMargin = subWidth;\n                }\n                else if (textAlignment === 'Center') {\n                    //Aligns the text as center justified.\n                    leftMargin = subWidth / 2;\n                }\n            }\n            elementBox.margin = new Margin(leftMargin, topMargin, 0, bottomMargin);\n            elementBox.line = line;\n        }\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + line.height);\n    };\n    Layout.prototype.updateLineWidget = function (line) {\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n                if (this.maxTextHeight < element.height) {\n                    this.maxTextHeight = element.height;\n                    this.maxTextBaseline = element.baselineOffset;\n                }\n                if (this.maxBaseline < this.maxTextBaseline) {\n                    this.maxBaseline = this.maxTextBaseline;\n                }\n            }\n            else if (this.maxBaseline < element.height) {\n                this.maxBaseline = element.height;\n            }\n        }\n    };\n    /**\n     * @param viewer\n     */\n    Layout.prototype.moveToNextPage = function (viewer, line, isPageBreak) {\n        var paragraphWidget = line.paragraph;\n        var index = 0;\n        if (!isNullOrUndefined(line)) {\n            index = paragraphWidget.childWidgets.indexOf(line);\n            if (index > 0 || isPageBreak) {\n                paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            }\n        }\n        var nextBody = this.moveBlocksToNextPage(paragraphWidget);\n        this.viewer.updateClientArea(nextBody.sectionFormat, nextBody.page);\n        this.viewer.updateClientAreaForBlock(paragraphWidget, true);\n        if (index > 0) {\n            if (line.isLastLine() && isPageBreak) {\n                return;\n            }\n            var nextParagraph = void 0;\n            if (nextBody.firstChild instanceof ParagraphWidget && nextBody.firstChild.equals(paragraphWidget)) {\n                nextParagraph = nextBody.firstChild;\n            }\n            else {\n                nextParagraph = new ParagraphWidget();\n            }\n            nextParagraph = this.addParagraphWidget(this.viewer.clientActiveArea, nextParagraph);\n            nextParagraph.index = paragraphWidget.index;\n            var insertIndex = 0;\n            for (var i = index; i < paragraphWidget.childWidgets.length; i++) {\n                var lineWidget = paragraphWidget.childWidgets[i];\n                lineWidget.paragraph = nextParagraph;\n                nextParagraph.childWidgets.splice(insertIndex, 0, lineWidget);\n                lineWidget.paragraph = nextParagraph;\n                insertIndex++;\n            }\n            nextParagraph.paragraphFormat = paragraphWidget.paragraphFormat;\n            nextParagraph.characterFormat = paragraphWidget.characterFormat;\n            paragraphWidget.childWidgets.splice(index);\n            paragraphWidget = nextParagraph;\n        }\n        else if (!isPageBreak) {\n            paragraphWidget.containerWidget.removeChild(paragraphWidget.indexInOwner);\n        }\n        if (!isPageBreak) {\n            if (nextBody.childWidgets.indexOf(paragraphWidget) === -1) {\n                nextBody.childWidgets.splice(0, 0, paragraphWidget);\n            }\n            paragraphWidget.containerWidget = nextBody;\n            this.viewer.updateClientAreaLocation(paragraphWidget, this.viewer.clientActiveArea);\n        }\n    };\n    /**\n     * Aligns line elements\n     * @param element\n     * @param topMargin\n     * @param bottomMargin\n     * @param maxDescent\n     * @param addSubWidth\n     * @param subWidth\n     * @param textAlignment\n     * @param whiteSpaceCount\n     * @param isLastElement\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.alignLineElements = function (element, topMargin, bottomMargin, maxDescent, addSubWidth, subWidth, textAlignment, whiteSpaceCount, isLastElement) {\n        if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n            var textElement = element instanceof TextElementBox ? element : undefined;\n            //Updates the text to base line offset.\n            // tslint:disable-next-line:max-line-length\n            var baselineOffset = element instanceof TextElementBox ? textElement.baselineOffset : element.baselineOffset;\n            topMargin += this.maxBaseline - baselineOffset;\n            bottomMargin += maxDescent - (element.height - baselineOffset);\n            //Updates the text to base line offset.\n            if (!isNullOrUndefined(textElement) && textAlignment === 'Justify' && whiteSpaceCount > 0) {\n                //Aligns the text as Justified.\n                var width = textElement.width;\n                var text = textElement.text;\n                if (!addSubWidth) {\n                    text = HelperMethods.trimStart(text); // trim start\n                    addSubWidth = (text.length > 0);\n                }\n                if (addSubWidth) {\n                    var spaceCount = text.length - HelperMethods.removeSpace(text).length;\n                    if (isLastElement) {\n                        spaceCount -= text.length - HelperMethods.trimEnd(text).length;\n                    }\n                    if (whiteSpaceCount < spaceCount) {\n                        width = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text, textElement.characterFormat);\n                        spaceCount = whiteSpaceCount;\n                    }\n                    if (spaceCount > 0) {\n                        textElement.width = width + subWidth * spaceCount;\n                        whiteSpaceCount -= spaceCount;\n                    }\n                }\n            }\n        }\n        else {\n            addSubWidth = true;\n            //Updates the Image/UIElement to base line offset.\n            topMargin += this.maxBaseline - element.height;\n            bottomMargin += maxDescent;\n        }\n        return { 'topMargin': topMargin, 'bottomMargin': bottomMargin, 'addSubWidth': addSubWidth, 'whiteSpaceCount': whiteSpaceCount };\n    };\n    /**\n     * Updates widget to page.\n     * @param viewer\n     * @param block\n     * @private\n     */\n    Layout.prototype.updateWidgetToPage = function (viewer, paragraphWidget) {\n        if (paragraphWidget.isInsideTable) {\n            var cellWidget = paragraphWidget.associatedCell;\n            paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            // if (viewer instanceof PageLayoutViewer) {\n            if (isNullOrUndefined(paragraphWidget.associatedCell) || isNullOrUndefined(paragraphWidget.associatedCell.ownerRow)\n                || isNullOrUndefined(paragraphWidget.associatedCell.ownerRow.rowFormat)) {\n                return;\n            }\n            if (paragraphWidget.associatedCell.ownerRow.rowFormat.heightType === 'Exactly') {\n                cellWidget.height = HelperMethods.convertPointToPixel(paragraphWidget.associatedCell.ownerRow.rowFormat.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if ([cellWidget].length <= 1 && paragraphWidget.associatedCell.ownerRow.rowFormat.heightType === 'AtLeast') {\n                    cellWidget.height = Math.max(HelperMethods.convertPointToPixel(paragraphWidget.associatedCell.ownerRow.rowFormat.height), this.getCellContentHeight(cellWidget));\n                }\n                else {\n                    cellWidget.height = cellWidget.height + paragraphWidget.height;\n                }\n            }\n            // } else {\n            //     cellWidget.height = cellWidget.height + paragraphWidget.height;\n            // }\n            // cellWidget.childWidgets.push(paragraphWidget);\n            paragraphWidget.containerWidget = cellWidget;\n        }\n        else {\n            if (!paragraphWidget.isEndsWithPageBreak) {\n                paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            }\n            //Adds the paragraph widget to the Header Footer/ Body widget.\n            // this.updateWidgetsToBody(paragraphWidget, viewer, paragraphWidget);\n            //For canvas no need to render paragraph widget here. In case of div, need to render paragraph here.\n            // tslint:disable-next-line:max-line-length             \n            // this.render.renderParagraphWidget((paragraphWidget.containerWidget as BodyWidget).page, paragraphWidget);\n        }\n        if (paragraphWidget.bodyWidget instanceof HeaderFooterWidget) {\n            if (!paragraphWidget.isInsideTable) {\n                paragraphWidget.containerWidget.height += paragraphWidget.height;\n            }\n            if (this.viewer.owner.enableHeaderAndFooter && paragraphWidget.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n                this.shiftFooterChildLocation(paragraphWidget.bodyWidget, this.viewer);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftFooterChildLocation = function (widget, viewer) {\n        var pageHeight = widget.page.bodyWidgets[0].sectionFormat.pageHeight;\n        if (widget.headerFooterType.indexOf('Footer') !== -1) {\n            var footerDistance = widget.page.bodyWidgets[0].sectionFormat.footerDistance;\n            var height = HelperMethods.convertPointToPixel(pageHeight - footerDistance);\n            var top_2;\n            if (widget.y + widget.height > height) {\n                top_2 = height - (widget.y + widget.height);\n            }\n            else if (widget.y + widget.height < height) {\n                top_2 = (widget.y + widget.height) - height;\n            }\n            if (!isNullOrUndefined(top_2)) {\n                top_2 = height - (widget.y + widget.height);\n                this.shiftChildLocation(top_2, widget);\n                viewer.clientActiveArea.y += top_2;\n            }\n        }\n    };\n    /**\n     * Checks previous element.\n     * @param characterFormat\n     */\n    Layout.prototype.checkPreviousElement = function (line, index, characterFormat) {\n        var paragraph = line.paragraph;\n        var isSplitByWord = false;\n        var lastTextElement = 0;\n        for (var i = index - 1; i >= 0; i--) {\n            var textElement = line.children[i];\n            if (textElement instanceof TextElementBox) {\n                var text = textElement.text;\n                lastTextElement = i;\n                if (text.length > 0 && text[text.length - 1] === ' ') {\n                    if (i === index - 1) {\n                        this.addSplittedLineWidget(line, index - 1);\n                        return true;\n                    }\n                    isSplitByWord = true;\n                    break;\n                }\n                else if (text === '\\t') {\n                    return false;\n                }\n                else if (text.indexOf(' ') >= 0) {\n                    isSplitByWord = true;\n                    var index_1 = text.lastIndexOf(' ') + 1;\n                    //Splits the text element by space.\n                    var splittedElement = new TextElementBox();\n                    splittedElement.text = text.substr(index_1);\n                    splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n                    textElement.text = text.substr(0, index_1);\n                    this.viewer.textHelper.getTextSize(splittedElement, characterFormat);\n                    textElement.width -= splittedElement.width;\n                    textElement.height = splittedElement.height;\n                    if (textElement.width === 0) {\n                        line.children.splice(i, 1);\n                    }\n                    //Adds the text element to the line\n                    line.children.splice(i + 1, 0, splittedElement);\n                    break;\n                }\n            }\n            else if (!(textElement instanceof ListTextElementBox)) {\n                //Handled for inline images/UIelements.\n                lastTextElement = i;\n                isSplitByWord = true;\n                break;\n            }\n        }\n        if (isSplitByWord) {\n            lastTextElement++;\n            if (lastTextElement < line.children.length) {\n                var splitWidth = 0;\n                for (var i = lastTextElement; i < line.children.length; i++) {\n                    splitWidth += line.children[i].width;\n                    this.addSplittedLineWidget(line, i - 1);\n                    i--;\n                }\n                this.viewer.updateClientWidth(splitWidth);\n            }\n        }\n        return isSplitByWord;\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearListElementBox = function (paragraph) {\n        if (paragraph.childWidgets.length === 0) {\n            return;\n        }\n        var line = paragraph.childWidgets[0];\n        if (isNullOrUndefined(line.children)) {\n            return;\n        }\n        for (var i = 0; i < line.children.length; i++) {\n            if (line.children[i] instanceof ListTextElementBox) {\n                line.children.splice(i, 1);\n                i--;\n            }\n            else {\n                break;\n            }\n        }\n    };\n    /**\n     * Gets list number.\n     * @param listFormat\n     * @param document\n     * @private\n     */\n    Layout.prototype.getListNumber = function (listFormat) {\n        var list = this.viewer.getListById(listFormat.listId);\n        var levelNumber = listFormat.listLevelNumber;\n        var listLevel = this.getListLevel(list, listFormat.listLevelNumber);\n        // tslint:disable-next-line:max-line-length\n        var levelOverride = !isNullOrUndefined(list.levelOverrides) ? list.levelOverrides[levelNumber] : undefined;\n        // If LevelOverride exists and have either override list level or StartAtOverride, then only list numbering will be restarted.\n        // tslint:disable-next-line:max-line-length\n        // if (!isNullOrUndefined(levelOverride) && !(document.renderedLevelOverrides.indexOf(levelOverride) > -1) && isNullOrUndefined(levelOverride.overrideListLevel)) {\n        //     //Add List Override style\n        //     document.renderedLevelOverrides.push(list.levelOverrides.getItem(levelNumber) as WLevelOverride);\n        //     if (document.renderedLists.containsKey((list.wordDocument as WordDocument).getAbstractListById(list.abstractListId))) {\n        // tslint:disable-next-line:max-line-length\n        //         let levels: Dictionary<number, number> = document.renderedLists.get((list.wordDocument as WordDocument).getAbstractListById(list.abstractListId));\n        //         if (levels.containsKey(levelNumber)) {\n        //             levels.remove(levelNumber);\n        //         }\n        //     }\n        // }\n        this.updateListValues(list, levelNumber);\n        return this.getListText(list, levelNumber, listLevel);\n    };\n    /**\n     * Gets list start value\n     * @param listLevelNumber\n     * @param list\n     * @private\n     */\n    Layout.prototype.getListStartValue = function (listLevelNumber, list) {\n        // tslint:disable-next-line:max-line-length\n        var levelOverride = !isNullOrUndefined(list.levelOverrides) ? list.levelOverrides[listLevelNumber] : undefined;\n        if (!isNullOrUndefined(levelOverride) && isNullOrUndefined(levelOverride.overrideListLevel)) {\n            return levelOverride.startAt;\n        }\n        var listLevel = this.getListLevel(list, listLevelNumber);\n        if (isNullOrUndefined(listLevel)) {\n            return 0;\n        }\n        else {\n            return listLevel.startAt;\n        }\n    };\n    /**\n     * Updates list values.\n     * @param list\n     * @param listLevelNumber\n     * @param document\n     */\n    Layout.prototype.updateListValues = function (list, listLevelNumber) {\n        if (!this.viewer.renderedLists.containsKey(this.viewer.getAbstractListById(list.abstractListId))) {\n            var startVal = new Dictionary();\n            this.viewer.renderedLists.add(this.viewer.getAbstractListById(list.abstractListId), startVal);\n            var listLevel = this.getListLevel(list, listLevelNumber);\n            for (var i = 0; i <= listLevelNumber; i++) {\n                startVal.add(i, this.getListStartValue(i, list));\n            }\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            var levels = this.viewer.renderedLists.get(this.viewer.getAbstractListById(list.abstractListId));\n            if (levels.containsKey(listLevelNumber)) {\n                var startAt = levels.get(listLevelNumber);\n                levels.set(listLevelNumber, startAt + 1);\n                var levelNumber = listLevelNumber + 1;\n                while (levelNumber < this.viewer.getAbstractListById(list.abstractListId).levels.length) {\n                    var listLevel = this.getListLevel(list, levelNumber);\n                    // if (!isNullOrUndefined(listLevel)) {\n                    if (levels.containsKey(levelNumber) && listLevel.restartLevel > listLevelNumber) {\n                        levels.remove(levelNumber);\n                        // if (document.renderedListLevels.indexOf(listLevel) > -1) {\n                        //     document.renderedListLevels.pop();\n                        // }\n                    }\n                    // }\n                    levelNumber++;\n                }\n            }\n            else {\n                var levelNumber = listLevelNumber;\n                while (!levels.containsKey(levelNumber - 1) && levelNumber > 0) {\n                    var listLevel = this.getListLevel(list, levelNumber - 1);\n                    // if (!isNullOrUndefined(listLevel)) {\n                    levels.add(levelNumber - 1, this.getListStartValue(levelNumber - 1, list));\n                    // if (document.renderedListLevels.indexOf(listLevel) !== -1) {\n                    //     document.renderedListLevels.push(listLevel);\n                    // }\n                    // }\n                    levelNumber--;\n                }\n                var startAt = this.getListStartValue(listLevelNumber, list);\n                levels.add(listLevelNumber, startAt);\n            }\n        }\n    };\n    /**\n     * Gets list text\n     * @param listAdv\n     * @param listLevelNumber\n     * @param currentListLevel\n     * @param document\n     */\n    Layout.prototype.getListText = function (listAdv, listLevelNumber, currentListLevel) {\n        var listText = currentListLevel.numberFormat;\n        // tslint:disable-next-line:max-line-length\n        if (this.viewer.renderedLists.containsKey(this.viewer.getAbstractListById(listAdv.abstractListId))) {\n            var levels = this.viewer.renderedLists.get(this.viewer.getAbstractListById(listAdv.abstractListId));\n            var keys = levels.keys;\n            for (var i = 0; i < keys.length; i++) {\n                var levelNumber = keys[i];\n                var levelKey = '%' + (levelNumber + 1).toString();\n                var listLevel = this.getListLevel(listAdv, levelNumber);\n                if (listText.match(levelKey)) {\n                    if (levelNumber > listLevelNumber) {\n                        return '';\n                    }\n                    else if (levels.containsKey(levelNumber) && !isNullOrUndefined(listLevel)) {\n                        listText = listText.replace(levelKey, this.getListTextListLevel(listLevel, levels.get(levelNumber)));\n                    }\n                    else {\n                        listText = listText.replace(levelKey, '0');\n                    }\n                }\n            }\n        }\n        return listText;\n    };\n    /**\n     * Gets the roman letter.\n     * @param number\n     * @private\n     */\n    Layout.prototype.getAsLetter = function (number) {\n        // if (number <= 0) {\n        //     return '';\n        // }\n        var quotient = number / 26;\n        var remainder = number % 26;\n        if (remainder === 0) {\n            //If number denotes the factor of 26, then reduce quotient by 1 and set remainder as 26.\n            remainder = 26;\n            quotient--;\n        }\n        //Index of A char in the ASCII table.     \n        var letter = String.fromCharCode(65 - 1 + remainder);\n        var listValue = '';\n        while (quotient >= 0) {\n            listValue = listValue + letter.toString();\n            quotient--;\n        }\n        return listValue;\n    };\n    /**\n     * Gets list text using list level pattern.\n     * @param listLevel\n     * @param listValue\n     * @private\n     */\n    Layout.prototype.getListTextListLevel = function (listLevel, listValue) {\n        switch (listLevel.listLevelPattern) {\n            case 'UpRoman':\n                return this.getAsRoman(listValue).toUpperCase();\n            case 'LowRoman':\n                return this.getAsRoman(listValue).toLowerCase();\n            case 'UpLetter':\n                return this.getAsLetter(listValue).toUpperCase();\n            case 'LowLetter':\n                return this.getAsLetter(listValue).toLowerCase();\n            case 'Arabic':\n                return (listValue).toString();\n            case 'LeadingZero':\n                return this.getAsLeadingZero(listValue);\n            case 'Number':\n                return (listValue).toString();\n            case 'OrdinalText':\n                return (listValue).toString();\n            case 'Ordinal':\n                return (listValue).toString();\n            case 'FarEast':\n                return (listValue).toString();\n            case 'Special':\n                return (listValue).toString();\n            default:\n                return '';\n        }\n    };\n    /**\n     * Generate roman number for the specified number.\n     * @param number\n     * @param magnitude\n     * @param letter\n     */\n    Layout.prototype.generateNumber = function (number, magnitude, letter) {\n        var numberstring = '';\n        while (number >= magnitude) {\n            number -= magnitude;\n            numberstring += letter;\n            this.value = number;\n        }\n        return numberstring.toString();\n    };\n    /**\n     * Gets list value prefixed with zero, if less than 10\n     * @param listValue\n     */\n    Layout.prototype.getAsLeadingZero = function (listValue) {\n        if (listValue < 10) {\n            return '0' + listValue.toString();\n        }\n        else {\n            return listValue.toString();\n        }\n    };\n    /**\n     * Gets the roman number\n     * @param number\n     * @private\n     */\n    Layout.prototype.getAsRoman = function (number) {\n        var retval = '';\n        this.value = number;\n        retval += this.generateNumber(this.value, 1000, 'M');\n        retval += this.generateNumber(this.value, 900, 'CM');\n        retval += this.generateNumber(this.value, 500, 'D');\n        retval += this.generateNumber(this.value, 400, 'CD');\n        retval += this.generateNumber(this.value, 100, 'C');\n        retval += this.generateNumber(this.value, 90, 'XC');\n        retval += this.generateNumber(this.value, 50, 'L');\n        retval += this.generateNumber(this.value, 40, 'XL');\n        retval += this.generateNumber(this.value, 10, 'X');\n        retval += this.generateNumber(this.value, 9, 'IX');\n        retval += this.generateNumber(this.value, 5, 'V');\n        retval += this.generateNumber(this.value, 4, 'IV');\n        retval += this.generateNumber(this.value, 1, 'I');\n        return retval.toString();\n    };\n    /**\n     * Gets the list level\n     * @param list\n     * @param listLevelNumber\n     * @private\n     */\n    Layout.prototype.getListLevel = function (list, listLevelNumber) {\n        if (!isNullOrUndefined(list)) {\n            var abstractList = this.viewer.getAbstractListById(list.abstractListId);\n            if (!isNullOrUndefined(list) && abstractList.levels.length <= listLevelNumber\n                && listLevelNumber >= 0 && listLevelNumber < 9) {\n                this.addListLevels(abstractList);\n            }\n            var levelOverrideAdv = undefined;\n            var level = false;\n            level = (!isNullOrUndefined(list.levelOverrides))\n                && !isNullOrUndefined(((levelOverrideAdv = list.levelOverrides[listLevelNumber])))\n                && (!isNullOrUndefined(levelOverrideAdv.overrideListLevel));\n            if (level) {\n                return levelOverrideAdv.overrideListLevel;\n            }\n            else if (!isNullOrUndefined(abstractList) && listLevelNumber >= 0 && listLevelNumber < abstractList.levels.length) {\n                return abstractList.levels[listLevelNumber];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Gets tab width\n     * @param paragraph\n     * @param viewer\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getTabWidth = function (paragraph, viewer, index, lineWidget, element) {\n        var fposition = 0;\n        var isCustomTab = false;\n        var tabs = paragraph.paragraphFormat.getUpdatedTabs();\n        //  Calculate hanging width\n        if (viewer.clientActiveArea.x < viewer.clientArea.x) {\n            return viewer.clientArea.x - viewer.clientActiveArea.x;\n        }\n        // Calculates tabwidth based on pageleftmargin and defaulttabwidth property\n        var position = viewer.clientActiveArea.x -\n            (viewer.clientArea.x - HelperMethods.convertPointToPixel(paragraph.paragraphFormat.leftIndent));\n        var defaultTabWidth = HelperMethods.convertPointToPixel(viewer.defaultTabWidth);\n        if (tabs.length === 0 && (position === 0 || defaultTabWidth === 0)) {\n            return defaultTabWidth;\n        }\n        else {\n            if (tabs.length > 0) {\n                for (var i = 0; i < tabs.length; i++) {\n                    var tabPosition = HelperMethods.convertPointToPixel(tabs[i].position);\n                    if (tabs[i].tabJustification === 'Left' && position < tabPosition) {\n                        fposition = tabPosition;\n                        isCustomTab = true;\n                        if (!isNullOrUndefined(element)) {\n                            element.tabLeader = tabs[i].tabLeader;\n                            element.tabText = '';\n                        }\n                        break;\n                    }\n                    else if (tabs[i].tabJustification === 'Right' && position < tabPosition) {\n                        var tabwidth = tabPosition - position;\n                        var width = this.getRightTabWidth(index + 1, lineWidget, paragraph);\n                        if (width < tabwidth) {\n                            defaultTabWidth = tabwidth - width;\n                        }\n                        else {\n                            defaultTabWidth = 0;\n                        }\n                        fposition = position;\n                        isCustomTab = true;\n                        if (!isNullOrUndefined(element)) {\n                            element.tabLeader = tabs[i].tabLeader;\n                            element.tabText = '';\n                        }\n                        break;\n                    }\n                }\n            }\n            if (!isCustomTab) {\n                var diff = ((Math.round(position) * 100) % (Math.round(defaultTabWidth) * 100)) / 100;\n                var cnt = (Math.round(position) - diff) / Math.round(defaultTabWidth);\n                fposition = (cnt + 1) * defaultTabWidth;\n            }\n            return (fposition - position) > 0 ? fposition - position : defaultTabWidth;\n        }\n    };\n    /**\n     * Returns the right tab width\n     * @param index - index of starting inline\n     * @param lineWidget - current line widget\n     * @param paragraph - current paragraph widget\n     */\n    Layout.prototype.getRightTabWidth = function (index, lineWidget, paragraph) {\n        var width = 0;\n        var isFieldCode = false;\n        while (index < lineWidget.children.length) {\n            var elementBox = lineWidget.children[index];\n            if ((elementBox instanceof FieldElementBox) || (elementBox instanceof BookmarkElementBox) || isFieldCode) {\n                if (elementBox instanceof FieldElementBox) {\n                    if (elementBox.fieldType === 0) {\n                        isFieldCode = true;\n                    }\n                    else if (elementBox.fieldType === 2) {\n                        isFieldCode = false;\n                    }\n                }\n                elementBox.width = 0;\n            }\n            else {\n                this.viewer.textHelper.getTextSize(elementBox, elementBox.characterFormat);\n            }\n            if (elementBox instanceof TextElementBox && elementBox.text === '\\t') {\n                return width;\n            }\n            else {\n                width = width + elementBox.width;\n            }\n            index++;\n        }\n        return width;\n    };\n    /**\n     * Gets split index by word.\n     * @param clientActiveWidth\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    Layout.prototype.getSplitIndexByWord = function (clientActiveWidth, text, width, characterFormat) {\n        var index = 0;\n        var length = text.length;\n        while (index < length) {\n            var nextIndex = this.getTextIndexAfterSpace(text, index);\n            if (nextIndex === 0 || nextIndex === length) {\n                nextIndex = length - 1;\n            }\n            var splitWidth = width;\n            if ((nextIndex < length - 1 || (nextIndex === length - 1 && text[nextIndex - 1] === ' ')) && index !== nextIndex) {\n                splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.slice(0, nextIndex), characterFormat);\n            }\n            if (splitWidth <= clientActiveWidth) {\n                index = nextIndex;\n            }\n            else {\n                if (index === 0 && text[0] === ' ') {\n                    index = this.getTextIndexAfterSpace(text, 0);\n                }\n                break;\n            }\n        }\n        return index;\n    };\n    /**\n     * Gets split index by character\n     * @param totalClientWidth\n     * @param clientActiveAreaWidth\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getTextSplitIndexByCharacter = function (totalClientWidth, clientActiveAreaWidth, text, width, characterFormat) {\n        var length = text.length;\n        for (var i = 0; i < length; i++) {\n            var splitWidth = width;\n            if (i + 1 < length) {\n                splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.substring(0, i + 1), characterFormat);\n            }\n            if (splitWidth > clientActiveAreaWidth) {\n                if (i === 0 && splitWidth > totalClientWidth) {\n                    //Handle for cell/section having client width less than a character's width.\n                    return (length > 1 && text[1] === ' ') ? this.getTextIndexAfterSpace(text, 1) : 1;\n                }\n                return i;\n            }\n        }\n        return 0;\n    };\n    /**\n     * Gets sub width.\n     * @param justify\n     * @param spaceCount\n     * @param firstLineIndent\n     */\n    Layout.prototype.getSubWidth = function (lineWidget, justify, spaceCount, firstLineIndent) {\n        var width = 0;\n        var trimSpace = true;\n        var lineText = '';\n        for (var i = lineWidget.children.length - 1; i >= 0; i--) {\n            var element = lineWidget.children[i];\n            if (element instanceof TextElementBox) {\n                var elementText = element.text;\n                lineText = elementText + lineText;\n                if (trimSpace && (elementText.trim() !== '' || elementText === '\\t')) {\n                    if (HelperMethods.endsWith(elementText)) {\n                        width += this.viewer.textHelper.measureTextExcludingSpaceAtEnd(elementText, element.characterFormat);\n                    }\n                    else {\n                        width += element.width;\n                    }\n                    trimSpace = false;\n                }\n                else if (!trimSpace) {\n                    width += element.width;\n                }\n            }\n            else {\n                lineText = 'a' + lineText;\n                trimSpace = false;\n                width += element.width;\n            }\n            if (!justify) {\n                width = Math.round(width);\n            }\n        }\n        lineText = lineText.trim();\n        spaceCount = lineText.length - HelperMethods.removeSpace(lineText).length;\n        var subWidth = (this.viewer.clientArea.width - firstLineIndent - width);\n        if (subWidth <= 0 || (spaceCount === 0 && justify)) {\n            spaceCount = 0;\n            subWidth = 0;\n        }\n        else if (justify) {\n            subWidth = subWidth / spaceCount;\n        }\n        return { 'subWidth': subWidth, 'spaceCount': spaceCount };\n    };\n    /**\n     * Gets before spacing.\n     * @param paragraph\n     * @private\n     */\n    Layout.prototype.getBeforeSpacing = function (paragraph) {\n        var beforeSpacing = 0;\n        if (paragraph.previousWidget instanceof ParagraphWidget) {\n            if (paragraph.previousWidget.paragraphFormat.afterSpacing < paragraph.paragraphFormat.beforeSpacing) {\n                // tslint:disable-next-line:max-line-length\n                beforeSpacing = paragraph.paragraphFormat.beforeSpacing - paragraph.previousWidget.paragraphFormat.afterSpacing;\n            }\n        }\n        else {\n            beforeSpacing = paragraph.paragraphFormat.beforeSpacing;\n        }\n        return beforeSpacing;\n    };\n    /**\n     * Gets line spacing.\n     * @param paragraph\n     * @param maxHeight\n     * @private\n     */\n    Layout.prototype.getLineSpacing = function (paragraph, maxHeight) {\n        if (isNullOrUndefined(paragraph.paragraphFormat)) {\n            return 0;\n        }\n        var lineSpacing = 0;\n        switch (paragraph.paragraphFormat.lineSpacingType) {\n            case 'AtLeast':\n            case 'Exactly':\n                lineSpacing = paragraph.paragraphFormat.lineSpacing;\n                break;\n            default:\n                lineSpacing = paragraph.paragraphFormat.lineSpacing * maxHeight;\n                break;\n        }\n        return lineSpacing;\n    };\n    /**\n     * Checks whether current line is first line in a paragraph.\n     * @param paragraph\n     */\n    Layout.prototype.isParagraphFirstLine = function (paragraph, line) {\n        var widget = paragraph;\n        if (isNullOrUndefined(widget.childWidgets) || widget.childWidgets.indexOf(line) === 0) {\n            //If the line elements conatins the elements from previous paragraph then need to retun false.\n            //Example scenario, Field start and field end in different paragraphs.\n            if (line.children.length > 0 && !isNullOrUndefined(paragraph.previousWidget)\n                && paragraph.previousWidget instanceof ParagraphWidget) {\n                return line.paragraph.index !== paragraph.previousWidget.index;\n            }\n            return true; //If the line elements count is zero then also need to return true.\n        }\n        return false;\n    };\n    /**\n     * Checks whether current line is last line in a paragraph.\n     * @param paragraph\n     */\n    Layout.prototype.isParagraphLastLine = function (element) {\n        var paragraph = element.line.paragraph;\n        var lastLineWidget = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n        var lastInline = lastLineWidget.children[lastLineWidget.children.length - 1];\n        if (element === lastInline) {\n            // tslint:disable-next-line:max-line-length            \n            return (lastInline instanceof FieldElementBox) || ((!(lastInline instanceof TextElementBox && lastInline.text === '\\v')));\n        }\n        return false;\n    };\n    /**\n     * Gets text index after space.\n     * @param text\n     * @param startIndex\n     */\n    Layout.prototype.getTextIndexAfterSpace = function (text, startIndex) {\n        var length = text.length;\n        var index = 0;\n        index = text.indexOf(' ', startIndex) + 1;\n        var nextIndex = index;\n        if (nextIndex === 0 || nextIndex === length) {\n            return nextIndex;\n        }\n        while (text[nextIndex] === ' ') {\n            nextIndex++;\n            if (nextIndex === length) {\n                break;\n            }\n        }\n        return nextIndex;\n    };\n    //#region Table\n    /**\n     * @private\n     */\n    Layout.prototype.moveNextWidgetsToTable = function (tableWidget, rowWidgets, moveFromNext) {\n        var currentRow = moveFromNext ? rowWidgets[rowWidgets.length - 2] : rowWidgets[rowWidgets.length - 1];\n        var rowIndex = currentRow.indexInOwner;\n        var currentTable = tableWidget[tableWidget.length - 1];\n        if (moveFromNext) {\n            rowIndex += 1;\n        }\n        var nextWidgets = currentRow.containerWidget.childWidgets.splice(rowIndex);\n        for (var i = 0; i < nextWidgets.length; i++) {\n            currentTable.childWidgets.push(nextWidgets[i]);\n            nextWidgets[i].containerWidget = currentTable;\n        }\n    };\n    /**\n     * Adds table cell widget.\n     * @param cell\n     * @param area\n     * @param maxCellMarginTop\n     * @param maxCellMarginBottom\n     */\n    Layout.prototype.addTableCellWidget = function (cell, area, maxCellMarginTop, maxCellMarginBottom) {\n        //let tableCellWidget: TableCellWidget = new TableCellWidget(cell);\n        var prevColumnIndex = 0;\n        var cellspace = 0;\n        var left = 0;\n        var top = maxCellMarginTop;\n        var right = 0;\n        var bottom = maxCellMarginBottom;\n        if (!isNullOrUndefined(cell.cellFormat)) {\n            if (cell.cellFormat.containsMargins()) {\n                // tslint:disable-next-line:max-line-length\n                left = isNullOrUndefined(cell.cellFormat.leftMargin) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.leftMargin) : HelperMethods.convertPointToPixel(cell.cellFormat.leftMargin);\n                right = isNullOrUndefined(cell.cellFormat.rightMargin) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.rightMargin) : HelperMethods.convertPointToPixel(cell.cellFormat.rightMargin);\n            }\n            else {\n                left = HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.leftMargin);\n                right = HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.rightMargin);\n            }\n        }\n        cell.margin = new Margin(left, top, right, bottom);\n        cell.width = HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n        if (!isNullOrUndefined(cell.previousWidget)) {\n            // tslint:disable-next-line:max-line-length\n            prevColumnIndex = cell.previousWidget.columnIndex + cell.previousWidget.cellFormat.columnSpan;\n        }\n        // tslint:disable-next-line:max-line-length\n        cellspace = !isNullOrUndefined(cell.ownerTable) && !isNullOrUndefined(cell.ownerTable.tableFormat) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing) : 0;\n        var prevSpannedCellWidth = 0;\n        if (prevColumnIndex < cell.columnIndex) {\n            // tslint:disable-next-line:max-line-length\n            prevSpannedCellWidth = HelperMethods.convertPointToPixel(cell.ownerTable.tableHolder.getPreviousSpannedCellWidth(prevColumnIndex, cell.columnIndex));\n            if (prevColumnIndex === 0) {\n                prevSpannedCellWidth = prevSpannedCellWidth - cellspace / 2;\n            }\n        }\n        cell.x = area.x + prevSpannedCellWidth + cell.margin.left;\n        cell.y = area.y + cell.margin.top + cellspace;\n        cell.width = cell.width - cell.margin.left - cell.margin.right;\n        if (cellspace > 0) {\n            cell.x += cellspace;\n            if (cell.ownerTable.tableHolder.columns.length === 1) {\n                cell.width -= cellspace * 2;\n            }\n            else if (cell.columnIndex === 0 || cell.columnIndex === cell.ownerTable.tableHolder.columns.length - 1) {\n                cell.width -= ((cellspace * 2) - cellspace / 2);\n            }\n            else {\n                cell.width -= cellspace;\n            }\n        }\n        // update the margins values respect to layouting of borders.\n        // tslint:disable-next-line:max-line-length\n        //For normal table cells only left border is rendred. for last cell left and right border is rendred. this border widths are not included in margins.\n        cell.leftBorderWidth = HelperMethods.convertPointToPixel(TableCellWidget.getCellLeftBorder(cell).getLineWidth());\n        cell.x += cell.leftBorderWidth;\n        cell.width -= cell.leftBorderWidth;\n        if (cellspace > 0 || cell.cellIndex === cell.ownerRow.childWidgets.length - 1) {\n            cell.rightBorderWidth = TableCellWidget.getCellRightBorder(cell).getLineWidth();\n            cell.width -= cell.rightBorderWidth;\n        }\n        //Add the border widths to respective margin side.\n        cell.margin.left = cell.margin.left + cell.leftBorderWidth;\n        cell.margin.right = cell.margin.right + cell.rightBorderWidth;\n        //cell.ownerWidget = owner;\n        return cell;\n    };\n    /**\n     * Adds specified row widget to table.\n     * @param viewer\n     * @param tableRowWidget\n     * @param row\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.addWidgetToTable = function (viewer, tableCollection, rowCollection, row, endRowWidget) {\n        //Adds table row widget to owner table widget.\n        var tableWidget = tableCollection[0];\n        var index = tableWidget.childWidgets.length;\n        var prevWidget = undefined;\n        var rowWidgetIndex = rowCollection.indexOf(row);\n        if (rowWidgetIndex > 0) {\n            prevWidget = rowCollection[rowWidgetIndex - 1];\n            // Need to update on this further\n        }\n        else if (row.previousRenderedWidget instanceof TableRowWidget &&\n            row.previousRenderedWidget.ownerTable.equals(row.ownerTable)) {\n            // Need to update on this further\n            prevWidget = row.previousRenderedWidget;\n        }\n        if (!isNullOrUndefined(prevWidget)) {\n            tableWidget = prevWidget.containerWidget;\n            // index = tableWidget.childWidgets.length;\n            index = tableWidget.childWidgets.indexOf(prevWidget) + 1;\n            if (Math.round(row.y) !== Math.round(prevWidget.y + prevWidget.height)) {\n                var prevIndex = tableCollection.indexOf(tableWidget);\n                if (prevIndex + 1 >= tableCollection.length) {\n                    //Creates new table widget for splitted rows.\n                    this.addTableWidget(viewer.clientActiveArea, tableCollection, true);\n                }\n                tableWidget = tableCollection[prevIndex + 1];\n                index = tableWidget.childWidgets.length;\n            }\n            if (rowWidgetIndex > 0) {\n                index = 0;\n            }\n        }\n        this.updateRowHeightBySpannedCell(tableWidget, row, index);\n        this.updateRowHeightByCellSpacing(tableCollection, row, viewer);\n        //Remove widget from previous container after splitteing\n        if (row.containerWidget && row.containerWidget !== tableWidget &&\n            row.containerWidget.childWidgets.indexOf(row) !== -1) {\n            row.containerWidget.childWidgets.splice(row.containerWidget.childWidgets.indexOf(row), 1);\n        }\n        if (tableWidget.childWidgets.indexOf(row) === -1) {\n            tableWidget.childWidgets.splice(index, 0, row);\n        }\n        row.containerWidget = tableWidget;\n        tableWidget.height = tableWidget.height + row.height;\n        if (!isNullOrUndefined(tableWidget.containerWidget)\n            && tableWidget.containerWidget.childWidgets.indexOf(tableWidget) >= 0 &&\n            !(tableWidget.containerWidget instanceof HeaderFooterWidget)) {\n            tableWidget.containerWidget.height += row.height;\n        }\n        this.updateHeightForRowWidget(viewer, false, tableCollection, rowCollection, row, false, endRowWidget);\n        viewer.cutFromTop(row.y + row.height);\n    };\n    /**\n     * Updates row height by spanned cell.\n     * @param tableWidget\n     * @param rowWidget\n     * @param insertIndex\n     * @param row\n     * @private\n     */\n    Layout.prototype.updateRowHeightBySpannedCell = function (tableWidget, row, insertIndex) {\n        var rowSpan = 1;\n        if (tableWidget.childWidgets.length === 0 || insertIndex === 0) {\n            this.updateRowHeight(row, row);\n            return;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cellWidget = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan : cellWidget.cellFormat.rowSpan;\n            this.updateSpannedRowCollection(rowSpan, row);\n        }\n        if (!isNullOrUndefined(row.ownerTable)) {\n            for (var i = 0; i < row.ownerTable.spannedRowCollection.length; i++) {\n                if (row.ownerTable.spannedRowCollection.keys[i] === row.index) {\n                    // Back track to previous table row widgets and update it height if vertical merge ends with this row.\n                    for (var j = 0; j < insertIndex; j++) {\n                        var prevRowWidget = tableWidget.childWidgets[j];\n                        this.updateRowHeight(prevRowWidget, row);\n                    }\n                    row.ownerTable.spannedRowCollection.remove(row.ownerTable.spannedRowCollection.keys[i]);\n                    break;\n                }\n            }\n        }\n    };\n    /**\n     * Updates row height.\n     * @param prevRowWidget\n     * @param rowWidget\n     * @param row\n     */\n    Layout.prototype.updateRowHeight = function (prevRowWidget, row) {\n        var rowIndex = row.index;\n        var rowSpan = 1;\n        for (var i = 0; i < prevRowWidget.childWidgets.length; i++) {\n            var cellWidget = prevRowWidget.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan : cellWidget.cellFormat.rowSpan;\n            //To update Row height- if row has row span value greater than 1, need to add it in spannedRowCollection            \n            this.updateSpannedRowCollection(rowSpan, row);\n            if (rowIndex - cellWidget.rowIndex === rowSpan - 1) {\n                var mergedCellHeight = cellWidget.y + cellWidget.height + cellWidget.margin.bottom - row.y;\n                if (row.height < mergedCellHeight) {\n                    row.height = mergedCellHeight;\n                }\n            }\n        }\n    };\n    //if row has row span value greater than 1, need to add it in spannedRowCollection\n    Layout.prototype.updateSpannedRowCollection = function (rowSpan, row) {\n        if (rowSpan > 1 && !isNullOrUndefined(row.ownerTable)) {\n            //Checks the rowspan is already exist in the list\n            if (!row.ownerTable.spannedRowCollection.containsKey(row.index + rowSpan - 1)) {\n                row.ownerTable.spannedRowCollection.add(row.index + rowSpan - 1, row.index);\n            }\n        }\n    };\n    /**\n     * Updates row height by cell spacing\n     * @param rowWidget\n     * @param viewer\n     * @param row\n     */\n    Layout.prototype.updateRowHeightByCellSpacing = function (tableCollection, row, viewer) {\n        if (row.ownerTable.tableFormat.cellSpacing > 0) {\n            // In the Case of tableWidget is greater than one and rowWidget is start at the Top Position of the page. \n            // In such case we have update the row height with half of cell spacing.\n            // Remaining cases we have to update the entire hight\n            // tslint:disable-next-line:max-line-length\n            if (tableCollection.length > 1 && row.y === viewer.clientArea.y && viewer instanceof PageLayoutViewer) {\n                row.height = row.height - HelperMethods.convertPointToPixel(row.ownerTable.tableFormat.cellSpacing) / 2;\n            }\n        }\n    };\n    /**\n     * Checks whether row span is end.\n     * @param row\n     * @param viewer\n     */\n    Layout.prototype.isRowSpanEnd = function (row, viewer) {\n        var rowIndex = row.index;\n        var rowSpan = 1;\n        for (var i = 0; i < viewer.splittedCellWidgets.length; i++) {\n            var splittedCell = viewer.splittedCellWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(splittedCell) || isNullOrUndefined(splittedCell.cellFormat)) ? rowSpan : splittedCell.cellFormat.rowSpan;\n            if (rowIndex - splittedCell.rowIndex === rowSpan - 1) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Checks whether vertical merged cell to continue or not.\n     * @param row\n     * @private\n     */\n    Layout.prototype.isVerticalMergedCellContinue = function (row) {\n        var colIndex = 0;\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            if (colIndex < cell.columnIndex) {\n                return true;\n            }\n            colIndex += cell.cellFormat.columnSpan;\n        }\n        return colIndex < row.ownerTable.tableHolder.columns.length;\n    };\n    /**\n     * Splits widgets.\n     * @param tableRowWidget\n     * @param viewer\n     * @param splittedWidget\n     * @param row\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitWidgets = function (tableRowWidget, viewer, tableCollection, rowCollection, splittedWidget, isLastRow) {\n        if (this.isFirstLineFitForRow(viewer.clientArea.bottom, tableRowWidget) && tableRowWidget.childWidgets.length > 0) {\n            splittedWidget = this.getSplittedWidgetForRow(viewer.clientArea.bottom, tableCollection, rowCollection, tableRowWidget);\n            if (viewer.splittedCellWidgets.length > 0 || splittedWidget !== tableRowWidget) {\n                if (isLastRow) {\n                    for (var i = 0; i < splittedWidget.childWidgets.length; i++) {\n                        var cell = splittedWidget.childWidgets[i];\n                        if (cell.rowIndex !== splittedWidget.index) {\n                            splittedWidget.childWidgets.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                //Adds the splitted widget of a vertical merged cell, to next row widget in the next page.\n                this.insertSplittedCellWidgets(viewer, tableCollection, splittedWidget, tableRowWidget.indexInOwner - 1);\n            }\n        }\n        else {\n            //Adds the splitted widget of a vertical merged cell, to next row widget in the next page.\n            this.insertSplittedCellWidgets(viewer, tableCollection, splittedWidget, tableRowWidget.indexInOwner - 1);\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets splitted widget for row.\n     * @param bottom\n     * @param tableRowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidgetForRow = function (bottom, tableCollection, rowCollection, tableRowWidget) {\n        var splittedWidget = undefined;\n        var rowIndex = tableRowWidget.index;\n        for (var i = 0; i < tableRowWidget.childWidgets.length; i++) {\n            var cellWidget = tableRowWidget.childWidgets[i];\n            var splittedCell = this.getSplittedWidget(bottom, true, tableCollection, rowCollection, cellWidget);\n            if (!isNullOrUndefined(splittedCell)) {\n                if (splittedCell === cellWidget) {\n                    //Returns if the whole content of the row does not fit in current page.\n                    return tableRowWidget;\n                }\n                if (tableRowWidget.childWidgets.indexOf(splittedCell) !== -1) {\n                    tableRowWidget.childWidgets.splice(tableRowWidget.childWidgets.indexOf(splittedCell), 1);\n                }\n                if (i === 0 || tableRowWidget.height < cellWidget.height + cellWidget.margin.top + cellWidget.margin.bottom) {\n                    tableRowWidget.height = cellWidget.height + cellWidget.margin.top + cellWidget.margin.bottom;\n                }\n                if (isNullOrUndefined(splittedWidget)) {\n                    //Creates new widget, to hold the splitted contents.\n                    splittedWidget = new TableRowWidget();\n                    splittedWidget.containerWidget = tableRowWidget.containerWidget;\n                    splittedWidget.index = tableRowWidget.index;\n                    splittedWidget.rowFormat = tableRowWidget.rowFormat;\n                    this.updateWidgetLocation(tableRowWidget, splittedWidget);\n                    splittedWidget.height = 0;\n                    rowCollection.push(splittedWidget);\n                }\n                var rowSpan = 1;\n                // tslint:disable-next-line:max-line-length\n                rowSpan = (isNullOrUndefined(splittedCell) || isNullOrUndefined(splittedCell.cellFormat)) ? rowSpan : splittedCell.cellFormat.rowSpan;\n                if (rowIndex - splittedCell.rowIndex === rowSpan - 1\n                    && splittedWidget.height < splittedCell.height + splittedCell.margin.top + splittedCell.margin.bottom) {\n                    splittedWidget.height = splittedCell.height + splittedCell.margin.top + splittedCell.margin.bottom;\n                }\n                splittedWidget.childWidgets.push(splittedCell);\n                splittedCell.containerWidget = splittedWidget;\n            }\n        }\n        return splittedWidget;\n    };\n    /**\n     * Updates widget to table.\n     * @param row\n     * @param viewer\n     */\n    /* tslint:disable */\n    Layout.prototype.updateWidgetsToTable = function (tableWidgets, rowWidgets, row) {\n        var rowHeight = this.getRowHeight(row, [row]);\n        var viewer = this.viewer;\n        //initializing row properties with default values.\n        var isHeader = row.rowFormat.isHeader;\n        var isAllowBreakAcrossPages = row.rowFormat.allowBreakAcrossPages;\n        var heightType = row.rowFormat.heightType;\n        var cellSpacing = 0;\n        var count = 0;\n        var tableRowWidget = row;\n        var moveRowToNextTable = false;\n        if (row.ownerTable.continueHeader && !isHeader) {\n            row.ownerTable.continueHeader = false;\n        }\n        var isLastRow = false;\n        cellSpacing = (!isNullOrUndefined(row.ownerTable) && !isNullOrUndefined(row.ownerTable.tableFormat)) ? HelperMethods.convertPointToPixel(row.ownerTable.tableFormat.cellSpacing) : 0;\n        while (count < rowWidgets.length) {\n            count = rowWidgets.length;\n            if (row.ownerTable.isInsideTable || (viewer.splittedCellWidgets.length === 0 && tableRowWidget.y + tableRowWidget.height + cellSpacing <= viewer.clientArea.bottom)) {\n                this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                if (viewer.splittedCellWidgets.length > 0 && isNullOrUndefined(rowWidgets[rowWidgets.length - 1].nextRow)) {\n                    count--;\n                    isLastRow = true;\n                }\n            }\n            else {\n                //Split widget for next page\n                if (viewer.splittedCellWidgets.length > 0 && tableRowWidget.y + tableRowWidget.height <= viewer.clientArea.bottom) {\n                    var isRowSpanEnd = this.isRowSpanEnd(row, viewer);\n                    if (!isRowSpanEnd) {\n                        if (this.isVerticalMergedCellContinue(row) && tableRowWidget.y == viewer.clientArea.y) {\n                            this.insertSplittedCellWidgets(viewer, tableWidgets, tableRowWidget, tableRowWidget.indexInOwner - 1);\n                        }\n                        this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                        continue;\n                    }\n                }\n                var splittedWidget = tableRowWidget;\n                var tableWidget = tableWidgets[tableWidgets.length - 1];\n                if (rowHeight + tableRowWidget.y > viewer.clientArea.bottom) {\n                    // tslint:disable-next-line:max-line-length\n                    if (!isAllowBreakAcrossPages || (isHeader && row.ownerTable.continueHeader) || (heightType === 'AtLeast' && HelperMethods.convertPointToPixel(row.rowFormat.height) < viewer.clientArea.bottom)) {\n                        // tslint:disable-next-line:max-line-length\n                        if ((heightType === 'AtLeast' && HelperMethods.convertPointToPixel(row.rowFormat.height) < viewer.clientActiveArea.height && isAllowBreakAcrossPages) || (heightType !== 'Exactly' && tableRowWidget.y === viewer.clientArea.y) || (heightType === 'Auto' && isAllowBreakAcrossPages)) {\n                            splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                        }\n                        if (heightType === 'Exactly' && tableRowWidget.y === viewer.clientArea.y) {\n                            this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                            count++;\n                        }\n                        if (isHeader && row.ownerTable.continueHeader) {\n                            row.ownerTable.header = false;\n                            row.ownerTable.continueHeader = false;\n                            row.ownerTable.headerHeight = 0;\n                            var pages = undefined;\n                            // if (viewer instanceof PageLayoutViewer) {\n                            pages = viewer.pages;\n                            // }\n                            if (!isNullOrUndefined(pages)) {\n                                for (var i = 0; i < pages.length; i++) {\n                                    if (pages[i].repeatHeaderRowTableWidget) {\n                                        pages[i].repeatHeaderRowTableWidget = false;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    else {\n                        if ((heightType === 'Auto' || heightType === 'AtLeast') && isAllowBreakAcrossPages) {\n                            // tslint:disable-next-line:max-line-length\n                            if (!(HelperMethods.convertPointToPixel(row.rowFormat.height) > viewer.clientArea.bottom) || tableRowWidget.y === viewer.clientArea.y) {\n                                splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                            }\n                        }\n                        else if (heightType === 'Exactly' && tableRowWidget.y === viewer.clientArea.y) {\n                            this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                            count++;\n                        }\n                    }\n                }\n                else {\n                    var isInsertSplittedWidgets = false;\n                    // Splitting handled for the merged cell with allowRowBreakAcross pages. \n                    if (this.isVerticalMergedCellContinue(row) && (isAllowBreakAcrossPages ||\n                        (isInsertSplittedWidgets = tableRowWidget.y == viewer.clientArea.y))) {\n                        if (isInsertSplittedWidgets) {\n                            this.insertSplittedCellWidgets(viewer, tableWidgets, splittedWidget, tableRowWidget.indexInOwner - 1);\n                        }\n                        else {\n                            splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                        }\n                    }\n                    else if (isLastRow && !isAllowBreakAcrossPages) {\n                        splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                    }\n                }\n                //Create New table for splitted widget\n                if (!isNullOrUndefined(splittedWidget)) {\n                    if (splittedWidget !== tableRowWidget) {\n                        this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget, tableRowWidget.nextRow);\n                        //Updates the fitted table rows to current page.\n                        this.updateWidgetsToPage(tableWidgets, rowWidgets, row.ownerTable, tableRowWidget.nextRow);\n                        var index_2 = tableWidgets.indexOf(tableRowWidget.containerWidget);\n                        if (index_2 + 1 >= tableWidgets.length) {\n                            //Creates new table widget for splitted rows.\n                            this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                        }\n                        tableRowWidget = splittedWidget;\n                    }\n                    else {\n                        if (row.index > 0) {\n                            //Updates the fitted table rows to current page.\n                            this.updateWidgetsToPage(tableWidgets, rowWidgets, row.ownerTable, row);\n                            // Need to update on this further\n                            if (row.previousRenderedWidget instanceof TableRowWidget) {\n                                // Need to update on this further\n                                var prevWidget = row.previousRenderedWidget;\n                                if (HelperMethods.round(tableRowWidget.y, 2) === HelperMethods.round(prevWidget.y + prevWidget.height, 2)) {\n                                    var prevIndex = tableWidgets.indexOf(prevWidget.containerWidget);\n                                    if (prevIndex + 1 >= tableWidgets.length) {\n                                        //Creates new table widget for splitted rows.\n                                        this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                                    }\n                                }\n                                else {\n                                    //Creates new table widget for splitted rows.\n                                    this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                                }\n                            }\n                            else {\n                                //Creates new table widget for splitted rows.\n                                this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                            }\n                        }\n                        moveRowToNextTable = true;\n                        count--;\n                    }\n                    tableWidget = tableWidgets[tableWidgets.length - 1];\n                    var prevBodyWidget = undefined;\n                    if (tableWidgets.length > 1) {\n                        //Get Previous Splitted Widget container\n                        prevBodyWidget = tableWidgets[tableWidgets.length - 2].containerWidget;\n                    }\n                    else {\n                        var previousBlock = row.ownerTable.previousRenderedWidget;\n                        prevBodyWidget = previousBlock.containerWidget;\n                    }\n                    var pageIndex = 0;\n                    if (!isNullOrUndefined(prevBodyWidget)) {\n                        pageIndex = viewer.pages.indexOf(prevBodyWidget.page);\n                    }\n                    var index = row.ownerTable.containerWidget.index;\n                    var bodyWidget = void 0;\n                    var block = void 0;\n                    if (moveRowToNextTable && tableWidgets.length === 1) {\n                        block = tableWidgets[tableWidgets.length - 1];\n                    }\n                    else {\n                        block = tableWidgets[tableWidgets.length - 2];\n                    }\n                    bodyWidget = this.moveBlocksToNextPage(block);\n                    var curretTable = tableWidgets[tableWidgets.length - 1];\n                    //Move Next RowWidge to next page\n                    if (moveRowToNextTable) {\n                        // tslint:disable-next-line:max-line-length\n                        if (row.index === 0 && curretTable.containerWidget && curretTable.containerWidget.childWidgets.indexOf(curretTable) !== -1) {\n                            curretTable.containerWidget.childWidgets.splice(curretTable.containerWidget.childWidgets.indexOf(curretTable), 1);\n                        }\n                    }\n                    if (bodyWidget.childWidgets.indexOf(curretTable) !== -1) {\n                        bodyWidget.childWidgets.splice(bodyWidget.childWidgets.indexOf(curretTable), 1);\n                    }\n                    bodyWidget.childWidgets.unshift(curretTable);\n                    curretTable.containerWidget = bodyWidget;\n                    if (moveRowToNextTable && row.index > 0 || rowWidgets.length > 1) {\n                        this.moveNextWidgetsToTable(tableWidgets, rowWidgets, !moveRowToNextTable);\n                    }\n                    moveRowToNextTable = false;\n                    if (row.ownerTable.header && tableRowWidget.height < viewer.clientArea.bottom) {\n                        // if (viewer instanceof PageLayoutViewer) {\n                        viewer.currentRenderingPage.repeatHeaderRowTableWidget = true;\n                        // }\n                        //Updates table widgets location.\n                        viewer.updateClientAreaForBlock(row.ownerTable, true, tableWidgets);\n                        // tslint:disable-next-line:max-line-length\n                        //Update splitted row widget location. if header is repeated update the y position of splitted widget to header height.\n                        splittedWidget.x = splittedWidget.x;\n                        splittedWidget.y = tableWidget.y + row.ownerTable.headerHeight;\n                        // let cellspace: number = viewer instanceof PageLayoutViewer ? cellspacing / 2 : cellspacing;\n                        var cellspace = cellSpacing / 2;\n                        this.updateChildLocationForRow(tableWidget.y + row.ownerTable.headerHeight - cellspace, splittedWidget);\n                    }\n                    else {\n                        //Updates table widgets location.\n                        viewer.updateClientAreaForBlock(row.ownerTable, true, tableWidgets);\n                        // tslint:disable-next-line:max-line-length\n                        //Update splitted row widget location. if header is repeated update the y position of splitted widget to header height.\n                        splittedWidget.x = splittedWidget.x;\n                        splittedWidget.y = tableWidget.y;\n                        // let cellspace: number = viewer instanceof PageLayoutViewer ? cellspacing / 2 : cellspacing;\n                        var cellspace = cellSpacing / 2;\n                        this.updateChildLocationForRow(tableWidget.y - cellspace, splittedWidget);\n                    }\n                }\n                isLastRow = false;\n            }\n            if (isHeader && row.ownerTable.continueHeader) {\n                row.ownerTable.header = true;\n                row.ownerTable.headerHeight = rowHeight + row.ownerTable.headerHeight;\n            }\n            if (isHeader && !isNullOrUndefined(this.getHeader(row.ownerTable)) && row.index === this.getHeader(row.ownerTable).index) {\n                var headerHeight = this.getHeaderHeight(row.ownerTable, row, rowWidgets);\n                if (headerHeight > row.ownerTable.headerHeight || headerHeight > row.ownerTable.headerHeight) {\n                    row.ownerTable.headerHeight = headerHeight;\n                }\n                if (row.ownerTable.headerHeight > viewer.clientArea.height) {\n                    row.ownerTable.header = false;\n                    row.ownerTable.continueHeader = false;\n                    row.ownerTable.headerHeight = 0;\n                    var pages = viewer.pages;\n                    for (var i = 0; i < pages.length; i++) {\n                        if (pages[i].repeatHeaderRowTableWidget) {\n                            pages[i].repeatHeaderRowTableWidget = false;\n                        }\n                    }\n                }\n            }\n            if (tableWidgets.length > 2 && row.ownerTable.header && tableRowWidget.height < viewer.clientActiveArea.bottom &&\n                !viewer.currentRenderingPage.repeatHeaderRowTableWidget) {\n                viewer.currentRenderingPage.repeatHeaderRowTableWidget = true;\n            }\n        }\n    };\n    /* tslint:enable */\n    /**\n     * Gets header.\n     * @param table\n     * @private\n     */\n    Layout.prototype.getHeader = function (table) {\n        var header = undefined;\n        var flag = true;\n        table = table.getSplitWidgets()[0];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.rowFormat.isHeader) {\n                header = row;\n            }\n            else {\n                flag = false;\n            }\n            if (!flag) {\n                break;\n            }\n        }\n        return header;\n    };\n    /**\n     * Gets header height.\n     * @param ownerTable\n     * @param row\n     */\n    Layout.prototype.getHeaderHeight = function (ownerTable, row, rowCollection) {\n        var height = 0;\n        if (row.ownerTable.childWidgets.length > 0 && ownerTable.childWidgets[0].rowFormat.isHeader) {\n            for (var i = 0; i < ownerTable.childWidgets.length; i++) {\n                var row_1 = ownerTable.childWidgets[i];\n                if (row_1.rowFormat.isHeader) {\n                    height = height + this.getRowHeight(row_1, rowCollection);\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        return height;\n    };\n    /**\n     * Updates widgets to row.\n     * @param cell\n     */\n    Layout.prototype.updateWidgetToRow = function (cell) {\n        var viewer = this.viewer;\n        //Adds table cell widget to owner row widget.\n        var rowWidget = cell.ownerRow;\n        var cellLeft = rowWidget.x;\n        if (rowWidget.childWidgets.length > 0) {\n            var lastWidget = rowWidget.childWidgets[rowWidget.childWidgets.length - 1];\n            cellLeft = lastWidget.x + lastWidget.width + lastWidget.margin.right;\n        }\n        // rowWidget.childWidgets.push(cell);\n        cell.containerWidget = rowWidget;\n        //If the row height is set as Atleast then height is set to atleast height for the first cell of the row.\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(cell.ownerRow) && cell.ownerRow.rowFormat.heightType !== 'Exactly' && HelperMethods.convertPointToPixel(cell.ownerRow.rowFormat.height) > 0 && cell.cellIndex === 0) {\n            rowWidget.height = rowWidget.height + HelperMethods.convertPointToPixel(cell.ownerRow.rowFormat.height);\n        }\n        //Add condition not cell merged vertically.\n        if (cell.cellFormat.rowSpan === 1) {\n            var cellHeight = cell.height + cell.margin.top + cell.margin.bottom;\n            if (rowWidget.height - HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing) < cellHeight) {\n                rowWidget.height = cellHeight + HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n            }\n        }\n    };\n    /**\n     * Updates height for row widget.\n     * @param viewer\n     * @param isUpdateVerticalPosition\n     * @param rowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForRowWidget = function (viewer, isUpdateVerticalPosition, tableCollection, rowCollection, rowWidget, isLayouted, endRowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellspacing = 0;\n            var cellWidget = undefined;\n            var childWidget = rowWidget.childWidgets[i];\n            // if (childWidget instanceof TableCellWidget) {\n            cellWidget = childWidget;\n            // }\n            var rowSpan = 1;\n            rowSpan = cellWidget.cellFormat.rowSpan;\n            cellspacing = HelperMethods.convertPointToPixel(cellWidget.ownerTable.tableFormat.cellSpacing);\n            if (rowSpan > 1) {\n                var currentRowWidgetIndex = rowWidget.containerWidget.childWidgets.indexOf(rowWidget);\n                // tslint:disable-next-line:max-line-length\n                var rowSpanWidgetEndIndex = currentRowWidgetIndex + rowSpan - 1 - (rowWidget.index - cellWidget.rowIndex);\n                if (viewer.clientArea.bottom < cellWidget.y + cellWidget.height + cellWidget.margin.bottom\n                    || rowSpanWidgetEndIndex >= currentRowWidgetIndex + 1) {\n                    this.splitSpannedCellWidget(cellWidget, tableCollection, rowCollection, viewer);\n                }\n                var spanEndRowWidget = rowWidget;\n                if (rowSpanWidgetEndIndex > 0) {\n                    if (rowSpanWidgetEndIndex < rowWidget.containerWidget.childWidgets.length) {\n                        var childWidget_1 = rowWidget.containerWidget.childWidgets[rowSpanWidgetEndIndex];\n                        if (childWidget_1 instanceof TableRowWidget) {\n                            spanEndRowWidget = childWidget_1;\n                            if (spanEndRowWidget === endRowWidget) {\n                                spanEndRowWidget = rowWidget;\n                            }\n                        }\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        spanEndRowWidget = rowWidget.containerWidget.childWidgets[rowWidget.containerWidget.childWidgets.length - 1];\n                    }\n                }\n                if (cellWidget.y + cellWidget.height + cellWidget.margin.bottom < spanEndRowWidget.y + spanEndRowWidget.height) {\n                    cellWidget.height = spanEndRowWidget.y + spanEndRowWidget.height - cellWidget.y - cellWidget.margin.bottom;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (isLayouted && spanEndRowWidget && (spanEndRowWidget.y !== 0 && spanEndRowWidget.height !== 0) && cellWidget.y + cellWidget.height + cellWidget.margin.bottom > spanEndRowWidget.y + spanEndRowWidget.height) {\n                    spanEndRowWidget.height = cellWidget.y + cellWidget.height + cellWidget.margin.bottom - spanEndRowWidget.y;\n                    // tslint:disable-next-line:max-line-length\n                    //Update the next rowlayout widget location. Reason for the updation is previous row height is updated when cell height is greater. So already layouted next row location has to be updated again.\n                    // if (rowWidget === spanEndRowWidget && rowWidget.nextWidget instanceof TableRowWidget) {\n                    //     let nextRow: TableRowWidget = rowWidget.nextWidget as TableRowWidget;\n                    //     // Need to update on this further\n                    //     // if (viewer.renderedElements.containsKey(nextRow)) {\n                    //     //     let nextWidget: TableRowWidget[] = viewer.renderedElements.get(nextRow) as TableRowWidget[];\n                    //     //     if (nextWidget.length > 0) {\n                    //     //         nextWidget[0].x = nextWidget[0].x;\n                    //     //         nextWidget[0].y = rowWidget.y + rowWidget.height;\n                    //     //     }\n                    //     // }\n                    // }\n                }\n            }\n            else {\n                if (cellspacing > 0) {\n                    // In the Case of tableWidget is greater than one and rowWidget is start at the Top Position of the page. \n                    // In such case we have update the cell height with half of cell spacing.\n                    // Remaining cases we have to update the entire hight\n                    // tslint:disable-next-line:max-line-length\n                    if (tableCollection.length > 1 && rowWidget.y === viewer.clientArea.y && viewer instanceof PageLayoutViewer) {\n                        cellspacing = cellspacing / 2;\n                    }\n                }\n                cellWidget.height = rowWidget.height - cellWidget.margin.top - cellWidget.margin.bottom - cellspacing;\n            }\n            this.updateHeightForCellWidget(viewer, tableCollection, rowCollection, cellWidget);\n            var widget = rowWidget.containerWidget;\n            while (widget.containerWidget instanceof Widget) {\n                widget = widget.containerWidget;\n            }\n            var page = undefined;\n            if (widget instanceof BodyWidget) {\n                page = widget.page;\n            }\n            // tslint:disable-next-line:max-line-length\n            if ((viewer instanceof PageLayoutViewer && viewer.visiblePages.indexOf(page) !== -1) || isUpdateVerticalPosition) {\n                this.updateCellVerticalPosition(cellWidget, false, false);\n            }\n            //Renders the current table row contents, after relayout based on editing.\n            // if (viewer instanceof PageLayoutViewer && (viewer as PageLayoutViewer).visiblePages.indexOf(page) !== -1) {\n            //     //Added proper undefined condition check for Asynchronous operation.\n            //     if (!isNullOrUndefined(rowWidget.tableRow) && !isNullOrUndefined(rowWidget.tableRow.rowFormat)) {\n            //         this.viewer.updateScrollBars();\n            //         //this.render.renderTableCellWidget(page, cellWidget);\n            //     }\n            // }\n        }\n    };\n    /**\n     * Updates height for cell widget.\n     * @param viewer\n     * @param cellWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForCellWidget = function (viewer, tableWidget, rowCollection, cellWidget) {\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof TableWidget) {\n                this.updateHeightForTableWidget(tableWidget, rowCollection, cellWidget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * Gets row height.\n     * @param row\n     * @private\n     */\n    Layout.prototype.getRowHeight = function (row, rowCollection) {\n        var height = 0;\n        if (row.rowFormat.heightType === 'Exactly') {\n            height = row.rowFormat.height;\n        }\n        else {\n            for (var i = 0; i < rowCollection.length; i++) {\n                if (rowCollection[i] instanceof TableRowWidget) {\n                    height = rowCollection[i].height + height;\n                }\n            }\n            height = Math.max(height, row.rowFormat.height);\n        }\n        return height;\n    };\n    /**\n     * splits spanned cell widget.\n     * @param cellWidget\n     * @param viewer\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitSpannedCellWidget = function (cellWidget, tableCollection, rowCollection, viewer) {\n        var splittedCell = this.getSplittedWidget(viewer.clientArea.bottom, false, tableCollection, rowCollection, cellWidget);\n        if (!isNullOrUndefined(splittedCell)) {\n            //Adds the splitted contents of a vertical merged cell, in order preserve in next page.\n            viewer.splittedCellWidgets.push(splittedCell);\n        }\n    };\n    /**\n     * Inserts splitted cell widgets.\n     * @param viewer\n     * @param rowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.insertSplittedCellWidgets = function (viewer, tableCollection, rowWidget, previousRowIndex) {\n        var left = rowWidget.x;\n        var tableWidth = 0;\n        tableWidth = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableHolder.tableWidth);\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            if (Math.round(left) < Math.round(cellWidget.x - cellWidget.margin.left)) {\n                if (this.insertRowSpannedWidget(rowWidget, viewer, left, i)) {\n                    i--;\n                    continue;\n                }\n                var length_1 = rowWidget.childWidgets.length;\n                this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, i, previousRowIndex);\n                if (length_1 < rowWidget.childWidgets.length) {\n                    i--;\n                    continue;\n                }\n            }\n            left += cellWidget.margin.left + cellWidget.width + cellWidget.margin.right;\n            if (i === rowWidget.childWidgets.length - 1 && Math.round(left) < Math.round(rowWidget.x + tableWidth)) {\n                if (this.insertRowSpannedWidget(rowWidget, viewer, left, i + 1)) {\n                    continue;\n                }\n                this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, i + 1, previousRowIndex);\n                continue;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        // Special case: when the child widgets of row is equal to 0 then the splitted widgets in the viewer is added in the table row widgets. \n        if ((isNullOrUndefined(rowWidget.childWidgets) || rowWidget.childWidgets.length === 0) && viewer.splittedCellWidgets.length > 0) {\n            for (var j = 0; j < viewer.splittedCellWidgets.length; j++) {\n                var widget = viewer.splittedCellWidgets[j];\n                if (Math.round(left) <= Math.round(widget.x - widget.margin.left)) {\n                    if (this.insertRowSpannedWidget(rowWidget, viewer, left, j)) {\n                        j--;\n                        continue;\n                    }\n                    var count = rowWidget.childWidgets.length;\n                    this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, j, previousRowIndex);\n                    if (count < rowWidget.childWidgets.length) {\n                        j--;\n                        continue;\n                    }\n                }\n                left += widget.margin.left + widget.width + widget.margin.right;\n                if (j === rowWidget.childWidgets.length - 1 && Math.round(left) <\n                    Math.round(rowWidget.x + tableWidth)) {\n                    if (this.insertRowSpannedWidget(rowWidget, viewer, left, j + 1)) {\n                        continue;\n                    }\n                    this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, j + 1, previousRowIndex);\n                    continue;\n                }\n            }\n        }\n        if (viewer.splittedCellWidgets.length > 0) {\n            viewer.splittedCellWidgets = [];\n        }\n    };\n    /**\n     * Inserts spanned row widget.\n     * @param rowWidget\n     * @param viewer\n     * @param left\n     * @param index\n     */\n    Layout.prototype.insertRowSpannedWidget = function (rowWidget, viewer, left, index) {\n        var cellSpacing = 0;\n        if (rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            cellSpacing = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n        }\n        for (var i = 0; i < viewer.splittedCellWidgets.length; i++) {\n            var splittedCell = viewer.splittedCellWidgets[i];\n            if (Math.round(left) === Math.round(splittedCell.x - splittedCell.margin.left)) {\n                rowWidget.childWidgets.splice(index, 0, splittedCell);\n                splittedCell.containerWidget = rowWidget;\n                //If the splitted cell location differs from expected location update the location of row child widgets.\n                if (splittedCell.y !== rowWidget.y + splittedCell.margin.top + cellSpacing) {\n                    this.updateChildLocationForRow(rowWidget.y, rowWidget);\n                }\n                viewer.splittedCellWidgets = [];\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Inserts empty splitted cell widgets.\n     * @param rowWidget\n     * @param left\n     * @param index\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.insertEmptySplittedCellWidget = function (currentRow, tableCollection, left, index, previousRowIndex) {\n        var tableWidget = tableCollection[tableCollection.length - 1];\n        for (var i = previousRowIndex; i >= 0; i--) {\n            var rowWidget = tableWidget.childWidgets[i];\n            var previousLeft = rowWidget.x;\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                var rowSpan = 1;\n                var cellWidget = rowWidget.childWidgets[j];\n                if (Math.round(left) === Math.round(previousLeft)) {\n                    rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan :\n                        cellWidget.cellFormat.rowSpan;\n                    if (rowSpan > 1) {\n                        var emptyCellWidget = this.createCellWidget(cellWidget);\n                        currentRow.childWidgets.splice(index, 0, emptyCellWidget);\n                        emptyCellWidget.containerWidget = currentRow;\n                    }\n                    return;\n                }\n                previousLeft += cellWidget.margin.left + cellWidget.width + cellWidget.margin.right;\n            }\n        }\n    };\n    /**\n     * Gets spllited widget.\n     * @param bottom\n     * @param splitMinimalWidget\n     * @param cellWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidget = function (bottom, splitMinimalWidget, tableCollection, rowCollection, cellWidget) {\n        var splittedWidget = undefined;\n        if (cellWidget.y + cellWidget.height > bottom - cellWidget.margin.bottom) {\n            for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n                if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                    var paragraphWidget = cellWidget.childWidgets[i];\n                    var splittedPara = this.getSplittedWidgetForPara(bottom - cellWidget.margin.bottom, paragraphWidget);\n                    if (!isNullOrUndefined(splittedPara)) {\n                        if (i === 0 && splittedPara === paragraphWidget) {\n                            //Returns if the whole content of the cell does not fit in current page.\n                            return cellWidget;\n                        }\n                        if (cellWidget.childWidgets.indexOf(splittedPara) !== -1) {\n                            cellWidget.childWidgets.splice(cellWidget.childWidgets.indexOf(splittedPara), 1);\n                            i--;\n                        }\n                        cellWidget.height -= splittedPara.height;\n                        if (isNullOrUndefined(splittedWidget)) {\n                            //Creates new widget, to hold the splitted contents.\n                            splittedWidget = this.createCellWidget(cellWidget);\n                        }\n                        splittedWidget.height += splittedPara.height;\n                        splittedWidget.childWidgets.push(splittedPara);\n                        splittedPara.containerWidget = splittedWidget;\n                    }\n                }\n                else {\n                    var tableWidget = cellWidget.childWidgets[i];\n                    var tableCol = [tableWidget];\n                    //Check for nested table.\n                    if (bottom - cellWidget.margin.bottom < tableWidget.y + tableWidget.height) {\n                        var tableHeight = tableWidget.height;\n                        // tslint:disable-next-line:max-line-length\n                        var splittedTable = this.getSplittedWidgetForTable(bottom - cellWidget.margin.bottom, tableCol, tableWidget);\n                        if (!isNullOrUndefined(splittedTable)) {\n                            if (i === 0 && splittedTable === tableWidget) {\n                                //Returns if the whole table does not fit in current page.\n                                return cellWidget;\n                            }\n                            if (cellWidget.childWidgets.indexOf(splittedTable) !== -1) {\n                                cellWidget.childWidgets.splice(cellWidget.childWidgets.indexOf(splittedTable), 1);\n                                i--;\n                                cellWidget.height -= splittedTable.height;\n                            }\n                            else {\n                                cellWidget.height -= tableHeight - tableWidget.height;\n                            }\n                            if (isNullOrUndefined(splittedWidget)) {\n                                //Creates new widget, to hold the splitted contents.\n                                splittedWidget = this.createCellWidget(cellWidget);\n                            }\n                            splittedWidget.height += splittedTable.height;\n                            splittedWidget.childWidgets.push(splittedTable);\n                            splittedTable.containerWidget = splittedWidget;\n                        }\n                    }\n                }\n            }\n        }\n        if (isNullOrUndefined(splittedWidget) && splitMinimalWidget) {\n            //Creates new widget, to hold the splitted contents.\n            splittedWidget = this.createCellWidget(cellWidget);\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets list level pattern\n     * @param value\n     * @private\n     */\n    Layout.prototype.getListLevelPattern = function (value) {\n        switch (value) {\n            case 0:\n                return 'Arabic';\n            case 1:\n                return 'UpRoman';\n            case 2:\n                return 'LowRoman';\n            case 3:\n                return 'UpLetter';\n            case 4:\n                return 'LowLetter';\n            case 5:\n                return 'Ordinal';\n            case 6:\n                return 'Number';\n            case 7:\n                return 'OrdinalText';\n            case 8:\n                return 'LeadingZero';\n            case 9:\n                return 'Bullet';\n            case 10:\n                return 'FarEast';\n            case 11:\n                return 'Special';\n            default:\n                return 'None';\n        }\n    };\n    /**\n     * Creates cell widget.\n     * @param cell\n     */\n    Layout.prototype.createCellWidget = function (cell) {\n        var cellWidget = new TableCellWidget();\n        cellWidget.cellFormat = cell.cellFormat;\n        cellWidget.index = cell.index;\n        cellWidget.rowIndex = cell.rowIndex;\n        cellWidget.columnIndex = cell.columnIndex;\n        cellWidget.containerWidget = cell.containerWidget;\n        this.updateWidgetLocation(cell, cellWidget);\n        cellWidget.margin = cell.margin;\n        cellWidget.leftBorderWidth = HelperMethods.convertPointToPixel(cell.leftBorderWidth);\n        cellWidget.rightBorderWidth = HelperMethods.convertPointToPixel(cell.rightBorderWidth);\n        return cellWidget;\n    };\n    /**\n     * Create Table Widget\n     */\n    Layout.prototype.createTableWidget = function (table) {\n        var newTable = new TableWidget();\n        if (table.header) {\n            newTable.header = table.header;\n            newTable.headerHeight = table.headerHeight;\n        }\n        newTable.index = table.index;\n        newTable.tableFormat = table.tableFormat;\n        newTable.tableHolder = table.tableHolder;\n        newTable.isGridUpdated = table.isGridUpdated;\n        return newTable;\n    };\n    /**\n     * Gets splitted widget for paragraph.\n     * @param bottom\n     * @param paragraphWidget\n     */\n    Layout.prototype.getSplittedWidgetForPara = function (bottom, paragraphWidget) {\n        var lineBottom = paragraphWidget.y;\n        var splittedWidget = undefined;\n        for (var i = 0; i < paragraphWidget.childWidgets.length; i++) {\n            var lineWidget = paragraphWidget.childWidgets[i];\n            if (bottom < lineBottom + lineWidget.height) {\n                if (i === 0) {\n                    if (lineWidget.paragraph.containerWidget instanceof TableCellWidget) {\n                        //checks first line of the page is exceed the page height\n                        if (lineWidget.paragraph.containerWidget.y === paragraphWidget.y) {\n                            lineBottom += lineWidget.height;\n                            continue;\n                        }\n                    }\n                    splittedWidget = paragraphWidget;\n                    break;\n                }\n                if (paragraphWidget.childWidgets.indexOf(lineWidget) !== -1) {\n                    paragraphWidget.childWidgets.splice(paragraphWidget.childWidgets.indexOf(lineWidget), 1);\n                    i--;\n                }\n                paragraphWidget.height -= lineWidget.height;\n                if (isNullOrUndefined(splittedWidget)) {\n                    //Creates new widget, to hold the splitted contents.\n                    splittedWidget = new ParagraphWidget();\n                    splittedWidget.characterFormat = paragraphWidget.characterFormat;\n                    splittedWidget.paragraphFormat = paragraphWidget.paragraphFormat;\n                    splittedWidget.index = paragraphWidget.index;\n                    this.updateWidgetLocation(paragraphWidget, splittedWidget);\n                    splittedWidget.height = lineWidget.height;\n                }\n                else {\n                    splittedWidget.height += lineWidget.height;\n                }\n                splittedWidget.childWidgets.push(lineWidget);\n                lineWidget.paragraph = splittedWidget;\n            }\n            lineBottom += lineWidget.height;\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets splitted table widget.\n     * @param bottom\n     * @param tableWidget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidgetForTable = function (bottom, tableCollection, tableWidget) {\n        var rowBottom = tableWidget.y;\n        var splittedWidget = undefined;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = undefined;\n            var childWidget = tableWidget.childWidgets[i];\n            // if (childWidget instanceof TableRowWidget) {\n            rowWidget = childWidget;\n            // }\n            var rowHeight = rowWidget.height;\n            if (bottom < rowBottom + rowHeight || !isNullOrUndefined(splittedWidget)) {\n                //ToDo: Check whether row included in vertical merge or AllowRowSplitbyPage is true, if so split row.\n                //Checks if atleast first line fits in the client area.                \n                var splittedRow = undefined;\n                var allowRowBreakAcrossPages = true;\n                if (!isNullOrUndefined(rowWidget) && !isNullOrUndefined(rowWidget.rowFormat)) {\n                    allowRowBreakAcrossPages = rowWidget.rowFormat.allowBreakAcrossPages;\n                }\n                if (allowRowBreakAcrossPages) {\n                    // tslint:disable-next-line:max-line-length\n                    splittedRow = (isNullOrUndefined(splittedWidget) && this.isFirstLineFitForRow(bottom, rowWidget)) ? this.getSplittedWidgetForRow(bottom, tableCollection, [rowWidget], rowWidget) : rowWidget;\n                }\n                if (!isNullOrUndefined(splittedRow)) {\n                    if (i === 0 && splittedRow === rowWidget) {\n                        //Returns if the whole table does not fit in current page.\n                        return tableWidget;\n                    }\n                    if (tableWidget.childWidgets.indexOf(splittedRow) !== -1) {\n                        tableWidget.childWidgets.splice(tableWidget.childWidgets.indexOf(splittedRow), 1);\n                        i--;\n                        tableWidget.height -= splittedRow.height;\n                    }\n                    else {\n                        tableWidget.height -= rowHeight - rowWidget.height;\n                    }\n                    if (isNullOrUndefined(splittedWidget)) {\n                        //Creates new widget, to hold the splitted contents.\n                        splittedWidget = this.createTableWidget(tableWidget);\n                        this.updateWidgetLocation(tableWidget, splittedWidget);\n                        splittedWidget.height = splittedRow.height;\n                    }\n                    else {\n                        splittedWidget.height += splittedRow.height;\n                    }\n                    splittedWidget.childWidgets.push(splittedRow);\n                    splittedRow.containerWidget = splittedWidget;\n                }\n            }\n            rowBottom += rowWidget.height;\n        }\n        return splittedWidget;\n    };\n    /**\n     * Checks whether first line fits for paragraph or not.\n     * @param bottom\n     * @param paraWidget\n     */\n    Layout.prototype.isFirstLineFitForPara = function (bottom, paraWidget) {\n        var lineWidget = paraWidget.childWidgets[0];\n        var cellwidget = lineWidget.paragraph.containerWidget;\n        // let document: WordDocument = undefined;\n        // if (!isNullOrUndefined(lineWidget.paragraph.currentNode) && !isNullOrUndefined(cellwidget.containerWidget)) {\n        //     document = WordDocument.getDocumentOf(lineWidget.paragraph.currentNode);\n        // }\n        //checks first line of the page is exceed the page height\n        if (this.viewer.isFirstLineFitInShiftWidgets) {\n            if (this.viewer.clientActiveArea.y === this.viewer.clientArea.y && paraWidget.y + lineWidget.height >= bottom) {\n                return true;\n            }\n        }\n        else {\n            // For nested tables,\n            if (cellwidget.ownerTable.isInsideTable) {\n                // Gets the container cell widgets, consider it as client area for the cell widget.\n                var containerCellWidget = undefined;\n                if (cellwidget.containerWidget instanceof TableRowWidget &&\n                    cellwidget.containerWidget.containerWidget instanceof TableWidget\n                    && cellwidget.containerWidget.containerWidget.containerWidget instanceof TableCellWidget) {\n                    containerCellWidget = cellwidget.containerWidget.containerWidget.containerWidget;\n                }\n                if (!isNullOrUndefined(containerCellWidget) && cellwidget.containerWidget.y === containerCellWidget.y\n                    && paraWidget.y + lineWidget.height >= bottom) {\n                    return true;\n                }\n            }\n            else if (cellwidget.containerWidget.y === this.viewer.clientArea.y && paraWidget.y + lineWidget.height >= bottom) {\n                return true;\n            }\n        }\n        return (paraWidget.y + lineWidget.height <= bottom);\n    };\n    /**\n     * Checks whether first line fits for table or not.\n     * @param bottom\n     * @param tableWidget\n     * @private\n     */\n    Layout.prototype.isFirstLineFitForTable = function (bottom, tableWidget) {\n        var rowWidget = undefined;\n        var isFit = false;\n        var childWidget = tableWidget.childWidgets[0];\n        // if (childWidget instanceof TableRowWidget) {\n        rowWidget = childWidget;\n        // }\n        if (!isNullOrUndefined(rowWidget)) {\n            isFit = this.isFirstLineFitForRow(bottom, rowWidget);\n        }\n        return isFit;\n    };\n    /**\n     * Checks whether first line fits for row or not.\n     * @param bottom\n     * @param rowWidget\n     */\n    Layout.prototype.isFirstLineFitForRow = function (bottom, rowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            if (!this.isFirstLineFitForCell(bottom, cellWidget)) {\n                return false;\n            }\n        }\n        return true;\n    };\n    /**\n     * Checks whether first line fits for cell or not.\n     * @param bottom\n     * @param cellWidget\n     */\n    Layout.prototype.isFirstLineFitForCell = function (bottom, cellWidget) {\n        if (cellWidget.childWidgets.length === 0) {\n            return true;\n        }\n        if (cellWidget.childWidgets[0] instanceof ParagraphWidget) {\n            var paraWidget = cellWidget.childWidgets[0];\n            return this.isFirstLineFitForPara(bottom - cellWidget.margin.bottom, paraWidget);\n        }\n        else {\n            var tableWidget = cellWidget.childWidgets[0];\n            return this.isFirstLineFitForTable(bottom - cellWidget.margin.bottom, tableWidget);\n        }\n    };\n    /**\n     * Updates widget location.\n     * @param widget\n     * @param table\n     */\n    Layout.prototype.updateWidgetLocation = function (widget, table) {\n        table.x = widget.x;\n        table.y = widget.y;\n        table.width = widget.width;\n    };\n    /**\n     * Updates child location for table.\n     * @param top\n     * @param tableWidget\n     * @private\n     */\n    Layout.prototype.updateChildLocationForTable = function (top, tableWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            rowWidget.x = rowWidget.x;\n            rowWidget.y = top;\n            this.updateChildLocationForRow(top, rowWidget);\n            top += rowWidget.height;\n        }\n    };\n    /**\n     * Updates child location for row.\n     * @param top\n     * @param rowWidget\n     * @private\n     */\n    Layout.prototype.updateChildLocationForRow = function (top, rowWidget) {\n        var spacing = 0;\n        if (rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            spacing = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n        }\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            cellWidget.x = cellWidget.x;\n            cellWidget.y = top + cellWidget.margin.top + spacing;\n            this.updateChildLocationForCell(cellWidget.y, cellWidget);\n        }\n    };\n    /**\n     * Updates child location for cell.\n     * @param top\n     * @param cellWidget\n     */\n    Layout.prototype.updateChildLocationForCell = function (top, cellWidget) {\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            cellWidget.childWidgets[i].x = cellWidget.childWidgets[i].x;\n            cellWidget.childWidgets[i].y = top;\n            if (cellWidget.childWidgets[i] instanceof TableWidget) {\n                this.updateChildLocationForTable(top, cellWidget.childWidgets[i]);\n            }\n            top += cellWidget.childWidgets[i].height;\n        }\n    };\n    /**\n     * Updates cell vertical position.\n     * @param cellWidget\n     * @param isUpdateToTop\n     * @param isInsideTable\n     * @private\n     */\n    Layout.prototype.updateCellVerticalPosition = function (cellWidget, isUpdateToTop, isInsideTable) {\n        if (cellWidget.ownerTable.containerWidget instanceof BodyWidget || isInsideTable) {\n            var displacement = this.getDisplacement(cellWidget, isUpdateToTop);\n            //Update Y position alone for the child widget of cell\n            this.updateCellContentVerticalPosition(cellWidget, displacement, isUpdateToTop);\n        }\n    };\n    /**\n     * Updates cell content vertical position.\n     * @param cellWidget\n     * @param displacement\n     * @param isUpdateToTop\n     */\n    Layout.prototype.updateCellContentVerticalPosition = function (cellWidget, displacement, isUpdateToTop) {\n        if (displacement === 0) {\n            return;\n        }\n        var location = cellWidget.y + displacement;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                cellWidget.childWidgets[i].y = location;\n            }\n            else {\n                location = this.updateTableWidgetLocation(cellWidget.childWidgets[i], location, isUpdateToTop);\n            }\n            location = location + cellWidget.childWidgets[i].height;\n        }\n    };\n    /**\n     * Updates table widget location.\n     * @param tableWidget\n     * @param location\n     * @param isUpdateToTop\n     */\n    Layout.prototype.updateTableWidgetLocation = function (tableWidget, location, isUpdateToTop) {\n        tableWidget.y = location = location + tableWidget.topBorderWidth;\n        var cellSpacing = 0;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            rowWidget.y = location;\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                var cellWidget = rowWidget.childWidgets[j];\n                cellWidget.y = location + cellWidget.margin.top + cellSpacing;\n                this.updateCellVerticalPosition(cellWidget, isUpdateToTop, true);\n            }\n            location = location + rowWidget.height;\n        }\n        return location;\n    };\n    /**\n     * Gets displacement.\n     * @param cellWidget\n     * @param isUpdateToTop\n     */\n    Layout.prototype.getDisplacement = function (cellWidget, isUpdateToTop) {\n        //Gets the height of row\n        var rowHeight = 0;\n        var rowWidget = cellWidget.containerWidget;\n        var padding = cellWidget.margin.top + cellWidget.margin.bottom;\n        if (!isNullOrUndefined(cellWidget.cellFormat) && cellWidget.cellFormat.rowSpan > 1) {\n            rowHeight = cellWidget.height;\n        }\n        else {\n            rowHeight = ((!isNullOrUndefined(rowWidget) ? rowWidget.height : 0) - padding);\n        }\n        //Gets the height of content within the cell\n        var cellContentHeight = this.getCellContentHeight(cellWidget);\n        //Displacement field holds the value which has reduced from rowHeight and cellContentHeight\n        var displacement = 0;\n        if (rowHeight > cellContentHeight) {\n            displacement = rowHeight - cellContentHeight;\n            if (cellWidget.cellFormat.verticalAlignment === 'Center') {\n                displacement = displacement / 2;\n            }\n            else if ((cellWidget.cellFormat.verticalAlignment === 'Top' || isUpdateToTop)) {\n                displacement = 0;\n            }\n        }\n        return displacement;\n    };\n    /**\n     * Gets cell content height.\n     * @param cellWidget\n     */\n    Layout.prototype.getCellContentHeight = function (cellWidget) {\n        if (isNullOrUndefined(cellWidget.childWidgets)) {\n            return 0;\n        }\n        var contentHeight = 0;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                contentHeight += cellWidget.childWidgets[i].height;\n            }\n            else {\n                contentHeight += cellWidget.childWidgets[i].height;\n            }\n        }\n        return contentHeight;\n    };\n    /**\n     * Gets table left borders.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableLeftBorder = function (borders) {\n        if (!isNullOrUndefined(borders.left)) {\n            return borders.left;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Gets table right border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableRightBorder = function (borders) {\n        if (!isNullOrUndefined(borders.right)) {\n            return borders.right;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Get table top border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableTopBorder = function (borders) {\n        if (!isNullOrUndefined(borders.top)) {\n            return borders.top;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Gets table bottom border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableBottomBorder = function (borders) {\n        if (!isNullOrUndefined(borders.bottom)) {\n            return borders.bottom;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Get diagonal cell up border.\n     * @param tableCell\n     * @private\n     */\n    Layout.prototype.getCellDiagonalUpBorder = function (tableCell) {\n        var diagonalUpBorder = undefined;\n        var cellBorder = undefined;\n        cellBorder = tableCell.cellFormat.borders;\n        diagonalUpBorder = cellBorder.diagonalUp;\n        return diagonalUpBorder;\n    };\n    /**\n     * Gets diagonal cell down border\n     * @param tableCell\n     * @private\n     */\n    Layout.prototype.getCellDiagonalDownBorder = function (tableCell) {\n        var diagonalDownBorder = undefined;\n        var cellBorder = undefined;\n        cellBorder = tableCell.cellFormat.borders;\n        diagonalDownBorder = cellBorder.diagonalDown;\n        return diagonalDownBorder;\n    };\n    /**\n     * Gets table width.\n     * @param table\n     * @private\n     */\n    Layout.prototype.getTableWidth = function (table) {\n        var width = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowWidth = 0;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                rowWidth += HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    //#region shifting\n    /**\n     * @private\n     */\n    Layout.prototype.layoutNextItemsBlock = function (blockAdv, viewer) {\n        var sectionIndex = blockAdv.bodyWidget.sectionIndex;\n        var block = blockAdv;\n        var splittedWidget = block.getSplitWidgets();\n        var nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        if (isNullOrUndefined(nextBlock) || this.viewer.blockToShift === block) {\n            this.viewer.blockToShift = undefined;\n        }\n        var updateNextBlockList = true;\n        while (nextBlock instanceof BlockWidget && nextBlock.bodyWidget.sectionIndex === sectionIndex) {\n            var currentWidget = undefined;\n            var blocks = block.getSplitWidgets();\n            currentWidget = blocks[blocks.length - 1];\n            // if (viewer.fieldEndParagraph === block) {\n            //     //Sets field end paragraph to undefined, inorder to hold reLayouting with this paragraph.\n            //     viewer.fieldEndParagraph = undefined;\n            // }\n            block = nextBlock;\n            if (viewer.blockToShift === block) {\n                viewer.blockToShift = undefined;\n            }\n            updateNextBlockList = false;\n            var nextWidget = undefined;\n            nextWidget = block.getSplitWidgets()[0];\n            // tslint:disable-next-line:max-line-length\n            if (viewer.fieldStacks.length === 0 && !isNullOrUndefined(nextWidget) && currentWidget.containerWidget === nextWidget.containerWidget\n                && (HelperMethods.round(nextWidget.y, 2) === HelperMethods.round(currentWidget.y + currentWidget.height, 2))) {\n                if (!isNullOrUndefined(viewer.blockToShift)) {\n                    viewer.blockToShift = block;\n                    break;\n                }\n                if (isNullOrUndefined(nextWidget.nextWidget)) {\n                    break;\n                }\n            }\n            updateNextBlockList = true;\n            if (viewer.owner.isShiftingEnabled && viewer.fieldStacks.length === 0) {\n                viewer.blockToShift = block;\n                break;\n            }\n            else if (isNullOrUndefined(this.viewer.owner.editorModule) || !this.viewer.owner.editorModule.isInsertingTOC) {\n                block = block.combineWidget(this.viewer);\n                var paragraph = void 0;\n                if (currentWidget.containerWidget !== block.containerWidget) {\n                    if (!(currentWidget instanceof ParagraphWidget) ||\n                        (currentWidget instanceof ParagraphWidget) && !currentWidget.isEndsWithPageBreak) {\n                        // tslint:disable-next-line:max-line-length\n                        this.updateContainerWidget(block, currentWidget.containerWidget, currentWidget.indexInOwner + 1, false);\n                    }\n                }\n                if (block instanceof TableWidget) {\n                    this.clearTableWidget(block, true, true);\n                    block.isGridUpdated = false;\n                    paragraph = this.viewer.selection.getFirstParagraphInFirstCell(block);\n                }\n                else {\n                    paragraph = block;\n                }\n                if ((this.viewer.owner.isDocumentLoaded) && this.viewer.owner.editorModule) {\n                    this.viewer.owner.editorModule.updateWholeListItems(paragraph);\n                }\n                viewer.updateClientAreaForBlock(block, true);\n                this.viewer.layout.layoutBlock(block, 0);\n                viewer.updateClientAreaForBlock(block, false);\n            }\n            splittedWidget = nextBlock.getSplitWidgets();\n            nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        }\n        if (!viewer.owner.isShiftingEnabled || this.viewer.blockToShift !== block) {\n            this.viewer.owner.editorModule.updateListItemsTillEnd(block, updateNextBlockList);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateClientAreaForLine = function (paragraph, startLineWidget, elementIndex) {\n        //Clears the line widget starting from current line.\n        var top = this.viewer.selection.getTop(startLineWidget);\n        var left = this.viewer.clientArea.x;\n        this.viewer.cutFromTop(top);\n        this.viewer.cutFromLeft(left);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.getParentTable = function (block) {\n        var widget = block;\n        while (widget.containerWidget) {\n            if (widget.containerWidget instanceof BlockContainer) {\n                return widget;\n            }\n            widget = widget.containerWidget;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.reLayoutParagraph = function (paragraphWidget, lineIndex, elementBoxIndex) {\n        if (this.viewer.blockToShift === paragraphWidget) {\n            this.layoutBodyWidgetCollection(paragraphWidget.index, paragraphWidget.containerWidget, paragraphWidget, false);\n        }\n        // let isElementMoved: boolean = elementBoxIndex > 0;\n        if (paragraphWidget.isInsideTable) {\n            this.reLayoutTable(paragraphWidget);\n        }\n        else {\n            this.reLayoutLine(paragraphWidget, lineIndex);\n        }\n        if (paragraphWidget.bodyWidget instanceof HeaderFooterWidget &&\n            paragraphWidget.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n            this.shiftFooterChildLocation(paragraphWidget.bodyWidget, this.viewer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.reLayoutTable = function (block) {\n        //Get Top level owner of block\n        var table = this.getParentTable(block);\n        //Combine splitted table in to single table\n        // this.combineTableWidgets(this.viewer, table, undefined);\n        //Get Parent table\n        var currentTable = table.combineWidget(this.viewer);\n        currentTable.isGridUpdated = false;\n        currentTable.buildTableColumns();\n        currentTable.isGridUpdated = true;\n        var bodyWidget = currentTable.containerWidget;\n        if (this.viewer.owner.enableHeaderAndFooter || block.isInHeaderFooter) {\n            bodyWidget.height -= currentTable.height;\n            // tslint:disable-next-line:max-line-length\n            this.viewer.updateHCFClientAreaWithTop(table.bodyWidget.sectionFormat, this.viewer.isBlockInHeader(table), bodyWidget.page);\n        }\n        else {\n            this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n        }\n        //Clear Hieght for all the content \n        if (this.viewer.owner.isDocumentLoaded && this.viewer.owner.editorModule) {\n            var block_1 = this.viewer.selection.getFirstParagraphInFirstCell(currentTable);\n            this.viewer.owner.editorModule.updateWholeListItems(block_1);\n        }\n        this.viewer.updateClientAreaForBlock(currentTable, true);\n        //Remove border width\n        currentTable.x -= currentTable.leftBorderWidth;\n        currentTable.y -= currentTable.topBorderWidth;\n        //Update Client area for current position\n        this.viewer.cutFromTop(currentTable.y);\n        this.clearTableWidget(currentTable, true, true);\n        this.layoutBlock(currentTable, 0, true);\n        this.viewer.updateClientAreaForBlock(currentTable, false);\n        this.layoutNextItemsBlock(currentTable, this.viewer);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearTableWidget = function (table, clearPosition, clearHeight) {\n        table.height = 0;\n        if (clearPosition) {\n            table.y = 0;\n            table.x = 0;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            this.clearRowWidget(row, clearPosition, clearHeight);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearRowWidget = function (row, clearPosition, clearHeight) {\n        row.height = 0;\n        if (clearPosition) {\n            row.y = 0;\n            row.x = 0;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            this.clearCellWidget(cell, clearPosition, clearHeight);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearCellWidget = function (cell, clearPosition, clearHeight) {\n        cell.height = 0;\n        if (clearPosition) {\n            cell.y = 0;\n            cell.x = 0;\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                if (clearHeight) {\n                    block.height = 0;\n                }\n            }\n            else {\n                this.clearTableWidget(block, clearPosition, clearHeight);\n            }\n        }\n    };\n    /**\n     * @param blockIndex\n     * @param bodyWidget\n     * @param block\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.layoutBodyWidgetCollection = function (blockIndex, bodyWidget, block, shiftNextWidget) {\n        if (!isNullOrUndefined(this.viewer.owner)\n            && this.viewer.owner.isLayoutEnabled) {\n            if (bodyWidget instanceof BlockContainer) {\n                var curretBlock = this.checkAndGetBlock(bodyWidget, blockIndex);\n                if (isNullOrUndefined(curretBlock)) {\n                    return;\n                }\n                if (bodyWidget instanceof HeaderFooterWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    this.viewer.updateHCFClientAreaWithTop(bodyWidget.sectionFormat, bodyWidget.headerFooterType.indexOf('Header') !== -1, bodyWidget.page);\n                    curretBlock.containerWidget.height -= curretBlock.height;\n                }\n                else {\n                    this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n                }\n                if (blockIndex > 0) {\n                    var prevWidget = curretBlock.getSplitWidgets()[0].previousRenderedWidget;\n                    if (!(prevWidget instanceof ParagraphWidget) ||\n                        (prevWidget instanceof ParagraphWidget) && !prevWidget.isEndsWithPageBreak) {\n                        this.viewer.cutFromTop(prevWidget.y + prevWidget.height);\n                        if (curretBlock.containerWidget !== prevWidget.containerWidget) {\n                            // tslint:disable-next-line:max-line-length\n                            this.updateContainerWidget(curretBlock, prevWidget.containerWidget, prevWidget.indexInOwner + 1, false);\n                        }\n                    }\n                    else if (prevWidget instanceof ParagraphWidget && prevWidget.isEndsWithPageBreak &&\n                        prevWidget.containerWidget === curretBlock.containerWidget) {\n                        this.moveBlocksToNextPage(prevWidget);\n                    }\n                }\n                var currentParagraph = void 0;\n                curretBlock = curretBlock.combineWidget(this.viewer);\n                if (curretBlock instanceof TableWidget) {\n                    this.clearTableWidget(curretBlock, true, true);\n                    curretBlock.isGridUpdated = false;\n                    currentParagraph = this.viewer.selection.getFirstParagraphInFirstCell(curretBlock);\n                }\n                else {\n                    currentParagraph = curretBlock;\n                }\n                if ((this.viewer.owner.isDocumentLoaded) && this.viewer.owner.editorModule) {\n                    this.viewer.owner.editorModule.updateWholeListItems(currentParagraph);\n                }\n                this.viewer.updateClientAreaForBlock(curretBlock, true);\n                this.viewer.layout.layoutBlock(curretBlock, 0, true);\n                this.viewer.updateClientAreaForBlock(curretBlock, false);\n                if (shiftNextWidget) {\n                    this.shiftNextWidgets(curretBlock);\n                }\n                else {\n                    this.layoutNextItemsBlock(curretBlock, this.viewer);\n                }\n            }\n            else if (bodyWidget instanceof TableCellWidget) {\n                var table = this.viewer.layout.getParentTable(bodyWidget.ownerTable.getSplitWidgets()[0]);\n                this.reLayoutTable(bodyWidget.ownerTable);\n                this.layoutNextItemsBlock(table, this.viewer);\n            }\n        }\n    };\n    Layout.prototype.checkAndGetBlock = function (containerWidget, blockIndex) {\n        var sectionIndex = containerWidget.index;\n        while (containerWidget && containerWidget.index === sectionIndex) {\n            if (containerWidget.childWidgets.length > 0 && containerWidget.firstChild.index <= blockIndex &&\n                containerWidget.lastChild.index >= blockIndex) {\n                for (var i = 0; i < containerWidget.childWidgets.length; i++) {\n                    var block = containerWidget.childWidgets[i];\n                    if (block.index === blockIndex) {\n                        return block;\n                    }\n                }\n            }\n            if (containerWidget instanceof BodyWidget) {\n                containerWidget = containerWidget.nextRenderedWidget;\n            }\n            else {\n                break;\n            }\n        }\n        return undefined;\n    };\n    //#endregion\n    //#region Table\n    /**\n     * Layouts table.\n     * @param table\n     * @private\n     */\n    Layout.prototype.layoutTable = function (table, startIndex) {\n        if (!table.isGridUpdated) {\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n        }\n        var tableView = [table];\n        this.addTableWidget(this.viewer.clientActiveArea, tableView);\n        this.viewer.updateClientAreaTopOrLeft(table, true);\n        var isHeader = table.childWidgets[0].rowFormat.isHeader;\n        if (table.childWidgets.length > 0) {\n            table.header = isHeader;\n            table.continueHeader = isHeader;\n            table.headerHeight = 0;\n        }\n        var row = table.childWidgets[startIndex];\n        while (row) {\n            row = this.layoutRow(tableView, row);\n            row = row.nextRow;\n        }\n        this.updateWidgetsToPage(tableView, [], table);\n        return tableView[tableView.length - 1];\n    };\n    /**\n     * Adds table widget.\n     * @param area\n     * @param table\n     * @private\n     */\n    Layout.prototype.addTableWidget = function (area, table, create) {\n        var tableWidget = table[table.length - 1];\n        if (create) {\n            tableWidget = this.createTableWidget(tableWidget);\n            table.push(tableWidget);\n        }\n        tableWidget.width = area.width;\n        tableWidget.x = area.x;\n        tableWidget.y = area.y;\n        //Update the table height of tableWidget when cell spacing has been defined. \n        if (tableWidget.tableFormat.cellSpacing > 0) {\n            tableWidget.height = tableWidget.height + HelperMethods.convertPointToPixel(tableWidget.tableFormat.cellSpacing);\n            // tslint:disable-next-line:max-line-length\n            tableWidget.leftBorderWidth = HelperMethods.convertPointToPixel(this.getTableLeftBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.rightBorderWidth = HelperMethods.convertPointToPixel(this.getTableRightBorder(tableWidget.tableFormat.borders).getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            tableWidget.topBorderWidth = HelperMethods.convertPointToPixel(this.getTableTopBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(this.getTableBottomBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.x += tableWidget.leftBorderWidth;\n            tableWidget.y += tableWidget.topBorderWidth;\n            tableWidget.width -= tableWidget.leftBorderWidth;\n            tableWidget.width -= tableWidget.rightBorderWidth;\n            tableWidget.height += tableWidget.bottomBorderWidth;\n        }\n        return tableWidget;\n    };\n    /**\n     * Updates widget to page.\n     * @param table\n     * @private\n     */\n    Layout.prototype.updateWidgetsToPage = function (tables, rows, table, endRowWidget) {\n        var viewer = this.viewer;\n        var tableWidget = tables[tables.length - 1];\n        if (!table.isInsideTable) {\n            this.updateHeightForTableWidget(tables, rows, tableWidget, endRowWidget);\n            if (tableWidget.childWidgets.length > 0 && tableWidget.y !== tableWidget.childWidgets[0].y) {\n                tableWidget.y = tableWidget.childWidgets[0].y;\n            }\n            // Need to update on this further\n            //Adds the table widget to owner cell widget.\n            // tslint:disable-next-line:max-line-length\n            // (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).childWidgets.push(tableWidget);\n            // tableWidget.containerWidget = viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as BodyWidget;\n            // tslint:disable-next-line:max-line-length\n            // (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).height = (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).height + tableWidget.height;\n        }\n        if (table.tableFormat.cellSpacing > 0) {\n            // tslint:disable-next-line:max-line-length\n            if (tableWidget.y + tableWidget.height + HelperMethods.convertPointToPixel(table.tableFormat.cellSpacing) > viewer.clientArea.bottom && viewer instanceof PageLayoutViewer) {\n                //update the table height when split to next page. Which is equivalent Ms Word Behaviour. \n                //In Ms Word if the Table Split to next page the bottom spacing of the table will be half of the current spacing.\n                //And the Remaining space will be used in next page top of the table.\n                tableWidget.height = tableWidget.height - HelperMethods.convertPointToPixel(table.tableFormat.cellSpacing) / 2;\n            }\n            //Update the current Y position of current clientactivearea.\n            viewer.cutFromTop(tableWidget.y + tableWidget.height);\n        }\n        if (table.bodyWidget instanceof HeaderFooterWidget) {\n            table.containerWidget.height += table.height;\n            if (this.viewer.owner.enableHeaderAndFooter && table.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n                this.shiftFooterChildLocation(table.bodyWidget, this.viewer);\n            }\n        }\n    };\n    /**\n     * Updates height for table widget.\n     * @param viewer\n     * @param tableWidget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForTableWidget = function (tables, rows, tableWidget, endRowWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            if (rowWidget === endRowWidget) {\n                break;\n            }\n            this.updateHeightForRowWidget(this.viewer, true, tables, rows, rowWidget, true, endRowWidget);\n        }\n    };\n    //#endregion\n    //#region Row\n    /**\n     * Layouts table row.\n     * @param row\n     * @private\n     */\n    Layout.prototype.layoutRow = function (tableWidget, row) {\n        var viewer = this.viewer;\n        var rowWidgets = [row];\n        var widget = this.addTableRowWidget(viewer.clientActiveArea, rowWidgets);\n        viewer.updateClientAreaForRow(row, true);\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            this.layoutCell(cell, this.getMaxTopOrBottomCellMargin(row, 0) + row.topBorderWidth, this.getMaxTopOrBottomCellMargin(row, 1) + row.bottomBorderWidth, widget);\n        }\n        viewer.updateClientAreaForRow(row, false);\n        var rows = [row];\n        this.updateWidgetsToTable(tableWidget, rows, row);\n        return rows[rows.length - 1];\n    };\n    /**\n     * @param area\n     * @param row\n     */\n    Layout.prototype.addTableRowWidget = function (area, row) {\n        var rowWidget = row[row.length - 1];\n        rowWidget.x = area.x + rowWidget.rowFormat.gridBeforeWidth;\n        rowWidget.y = area.y;\n        rowWidget.width = area.width;\n        var borderWidth = 0;\n        if (!isNullOrUndefined(rowWidget.ownerTable) && !isNullOrUndefined(rowWidget.ownerTable.tableFormat)\n            && rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            rowWidget.height = rowWidget.height + HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n            //Update the table height with the border width to layout the border when the cell spacing is defined..\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                if (!isNullOrUndefined(rowWidget.childWidgets[j].cellFormat)\n                    && !isNullOrUndefined(rowWidget.childWidgets[j].cellFormat.borders)) {\n                    // tslint:disable-next-line:max-line-length\n                    var width = TableCellWidget.getCellBottomBorder(rowWidget.childWidgets[j]).getLineWidth();\n                    if (width > borderWidth) {\n                        borderWidth = width;\n                    }\n                }\n            }\n            //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n            rowWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n            if (rowWidget.index > 0 && !isNullOrUndefined(rowWidget.previousWidget)) {\n                var prevRow = rowWidget.previousWidget;\n                borderWidth = 0;\n                for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                    // tslint:disable-next-line:max-line-length\n                    if (!isNullOrUndefined(prevRow.childWidgets[i].cellFormat) && !isNullOrUndefined(prevRow.childWidgets[i].cellFormat.borders)) {\n                        var value = TableCellWidget.getCellBottomBorder(prevRow.childWidgets[i]).getLineWidth();\n                        if (value > borderWidth) {\n                            borderWidth = value;\n                        }\n                    }\n                }\n                //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n                rowWidget.topBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n            }\n        }\n        if (!isNullOrUndefined(rowWidget.childWidgets)) {\n            for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(rowWidget.childWidgets[i].cellFormat) && !isNullOrUndefined(rowWidget.childWidgets[i].cellFormat.borders)) {\n                    var value = TableCellWidget.getCellTopBorder(rowWidget.childWidgets[i]).getLineWidth();\n                    if (value > borderWidth) {\n                        borderWidth = value;\n                    }\n                }\n            }\n        }\n        //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n        rowWidget.topBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n        //Update the table height of tableWidget when cell spacing has been defined. \n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(rowWidget.ownerTable) && !isNullOrUndefined(rowWidget.ownerTable.tableFormat) && rowWidget.ownerTable.tableFormat.cellSpacing <= 0 && rowWidget.rowIndex === rowWidget.ownerTable.childWidgets.length - 1) {\n            // Update the bottom width for last row .\n            for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(rowWidget.childWidgets[i].cellFormat) && !isNullOrUndefined(rowWidget.childWidgets[i].cellFormat.borders)) {\n                    var value = TableCellWidget.getCellBottomBorder(rowWidget.childWidgets[i]).getLineWidth();\n                    if (value > borderWidth) {\n                        borderWidth = value;\n                    }\n                }\n            }\n            //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n            rowWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n        }\n        //tableRowWidget.ownerWidget = owner;\n        return rowWidget;\n    };\n    /**\n     * Gets maximum top or bottom cell margin.\n     * @param row\n     * @param topOrBottom\n     */\n    Layout.prototype.getMaxTopOrBottomCellMargin = function (row, topOrBottom) {\n        if (isNullOrUndefined(row.childWidgets)) {\n            return 0;\n        }\n        var value = 0;\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            if (row.childWidgets.length > 0) {\n                var cellFormat = row.childWidgets[i].cellFormat;\n                if (cellFormat.containsMargins()) {\n                    if (topOrBottom === 0 && !isNullOrUndefined(cellFormat.topMargin) &&\n                        HelperMethods.convertPointToPixel(cellFormat.topMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(cellFormat.topMargin);\n                    }\n                    else if (topOrBottom === 1 && !isNullOrUndefined(cellFormat.bottomMargin) &&\n                        HelperMethods.convertPointToPixel(cellFormat.bottomMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(cellFormat.bottomMargin);\n                    }\n                }\n                else {\n                    var tableFormat = row.childWidgets[i].ownerTable.tableFormat;\n                    if (topOrBottom === 0 && HelperMethods.convertPointToPixel(tableFormat.topMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(tableFormat.topMargin);\n                    }\n                    else if (topOrBottom === 1 && HelperMethods.convertPointToPixel(tableFormat.bottomMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(tableFormat.bottomMargin);\n                    }\n                }\n            }\n        }\n        return value;\n    };\n    //#endregion Row\n    //#region cell\n    /**\n     * Layouts cell\n     * @param cell\n     * @param maxCellMarginTop\n     * @param maxCellMarginBottom\n     */\n    Layout.prototype.layoutCell = function (cell, maxCellMarginTop, maxCellMarginBottom, owner) {\n        var viewer = this.viewer;\n        this.addTableCellWidget(cell, viewer.clientActiveArea, maxCellMarginTop, maxCellMarginBottom);\n        viewer.updateClientAreaForCell(cell, true);\n        if (cell.childWidgets.length === 0) {\n            var paragraphWidget = new ParagraphWidget();\n            paragraphWidget.characterFormat = new WCharacterFormat();\n            paragraphWidget.paragraphFormat = new WParagraphFormat();\n            paragraphWidget.index = 0;\n            var lineWidget = new LineWidget(undefined);\n            paragraphWidget.childWidgets.push(lineWidget);\n            cell.childWidgets.push(paragraphWidget);\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            block.containerWidget = cell;\n            this.layoutBlock(block, 0);\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        this.updateWidgetToRow(cell);\n        viewer.updateClientAreaForCell(cell, false);\n    };\n    //endregion cell\n    //#region Shifting\n    /**\n     * @private\n     */\n    Layout.prototype.shiftLayoutedItems = function () {\n        if (isNullOrUndefined(this.viewer.blockToShift) || isNullOrUndefined(this.viewer.blockToShift.containerWidget)) {\n            this.viewer.blockToShift = undefined;\n            return;\n        }\n        var block = this.viewer.blockToShift;\n        var sectionIndex = block.bodyWidget.index;\n        this.reLayoutOrShiftWidgets(block, this.viewer);\n        var updateNextBlockList = true;\n        // If flow layout, then all sections are in single page. Hence need to update till last block of last section.\n        // Todo: For page layout and section break continuous, need to handle the same.\n        var splittedWidget = block.getSplitWidgets();\n        var nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        while (nextBlock instanceof BlockWidget && nextBlock.bodyWidget.index === sectionIndex) {\n            var currentWidget = undefined;\n            var blocks = block.getSplitWidgets();\n            currentWidget = blocks[blocks.length - 1];\n            block = nextBlock;\n            updateNextBlockList = false;\n            var nextWidget = undefined;\n            blocks = block.getSplitWidgets();\n            if (block instanceof ParagraphWidget) {\n                nextWidget = blocks[0];\n            }\n            else {\n                if (block instanceof TableWidget) {\n                    nextWidget = blocks[0];\n                }\n            }\n            if (currentWidget.containerWidget === nextWidget.containerWidget\n                && (HelperMethods.round(nextWidget.y, 2) === HelperMethods.round(this.viewer.clientActiveArea.y, 2)) &&\n                isNullOrUndefined(nextWidget.nextWidget)) {\n                break;\n            }\n            updateNextBlockList = true;\n            this.reLayoutOrShiftWidgets(block, this.viewer);\n            splittedWidget = block.getSplitWidgets();\n            nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        }\n        if (this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateListItemsTillEnd(block, updateNextBlockList);\n        }\n        this.viewer.blockToShift = undefined;\n        var viewer = this.viewer;\n        // if (viewer instanceof PageLayoutViewer) {\n        viewer.removeEmptyPages();\n        this.updateFieldElements();\n        viewer.updateScrollBars();\n        // }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateFieldElements = function () {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            var fieldBegin = this.viewer.fields[i];\n            if (!isNullOrUndefined(this.viewer.selection)) {\n                var fieldCode = this.viewer.selection.getFieldCode(fieldBegin);\n                if (!isNullOrUndefined(fieldCode) && fieldCode.toLowerCase().match('numpages')) {\n                    var textElement = fieldBegin.fieldSeparator.nextNode;\n                    if (!isNullOrUndefined(textElement)) {\n                        textElement.text = this.viewer.pages.length.toString();\n                        var paragraph = fieldBegin.line.paragraph;\n                        if (!isNullOrUndefined(paragraph.bodyWidget) && !isNullOrUndefined(paragraph.bodyWidget.page)) {\n                            var lineIndex = paragraph.childWidgets.indexOf(fieldBegin.line);\n                            var elementIndex = fieldBegin.line.children.indexOf(textElement);\n                            this.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Layout.prototype.reLayoutOrShiftWidgets = function (blockAdv, viewer) {\n        var reLayoutItems = false;\n        var block = blockAdv;\n        // if (block instanceof ParagraphWidget) {\n        //     reLayoutItems = viewer.renderedElements.get(block as ParagraphWidget).length === 0;\n        // } else {\n        //     reLayoutItems = viewer.renderedElements.get(block as TableWidget).length === 0;\n        // }\n        // if (reLayoutItems) {\n        //     //Handle layouting the block.\n        //     viewer.updateClientAreaForBlock(block, true);\n        //     this.layoutMod.layoutBlock(block);\n        //     viewer.updateClientAreaForBlock(block, false);\n        // } else {\n        //Handled to check client area and shift layouted widget.\n        this.shiftWidgetsBlock(block, viewer);\n        //Updates the list value of the rendered paragraph.\n        if (this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateRenderedListItems(block);\n        }\n        // }\n    };\n    Layout.prototype.shiftWidgetsBlock = function (block, viewer) {\n        if (block instanceof ParagraphWidget) {\n            this.shiftWidgetsForPara(block, viewer);\n        }\n        else if (block instanceof TableWidget) {\n            this.shiftWidgetsForTable(block, viewer);\n        }\n    };\n    Layout.prototype.shiftWidgetsForPara = function (paragraph, viewer) {\n        var prevBodyObj = this.getBodyWidgetOfPreviousBlock(paragraph, 0);\n        var prevBodyWidget = prevBodyObj.bodyWidget;\n        var index = prevBodyObj.index;\n        var prevWidget = undefined;\n        for (var i = 0; i < paragraph.getSplitWidgets().length; i++) {\n            var widget = paragraph.getSplitWidgets()[i];\n            if (!isNullOrUndefined(prevWidget)) {\n                var isPageBreak = prevWidget.lastChild ? prevWidget.lastChild.isEndsWithPageBreak : false;\n                this.shiftToPreviousWidget(widget, viewer, prevWidget, isPageBreak);\n                if ((isNullOrUndefined(widget.childWidgets) || widget.childWidgets.length === 0) && !isPageBreak) {\n                    i--;\n                    continue;\n                }\n                prevWidget = undefined;\n                if (prevBodyWidget !== widget.containerWidget) {\n                    prevBodyWidget = widget.containerWidget;\n                    if (isPageBreak) {\n                        viewer.updateClientAreaByWidget(widget);\n                    }\n                }\n            }\n            if (this.isFitInClientArea(widget, viewer)) {\n                //Check whether this widget is moved to previous container widget.\n                prevWidget = widget;\n                widget.y = viewer.clientActiveArea.y;\n                viewer.cutFromTop(viewer.clientActiveArea.y + widget.height);\n                //Moves the paragraph widget to previous body widget.\n                if (!isNullOrUndefined(prevBodyWidget) && prevBodyWidget !== widget.containerWidget) {\n                    index++;\n                    if (!prevBodyWidget.lastChild.isEndsWithPageBreak) {\n                        this.updateContainerWidget(widget, prevBodyWidget, index, true);\n                    }\n                }\n                if (widget.isEndsWithPageBreak) {\n                    var nextBodyWidget = this.createOrGetNextBodyWidget(prevBodyWidget, this.viewer);\n                    nextBodyWidget = this.moveBlocksToNextPage(widget);\n                    viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n                }\n            }\n            else {\n                var previousBlock = widget.previousRenderedWidget;\n                var isPageBreak = false;\n                if (previousBlock instanceof ParagraphWidget && previousBlock.isEndsWithPageBreak) {\n                    isPageBreak = true;\n                }\n                var isSplittedToNewPage = this.splitWidget(widget, viewer, prevBodyWidget, index + 1, isPageBreak);\n                prevWidget = undefined;\n                if (prevBodyWidget !== widget.containerWidget) {\n                    prevBodyWidget = widget.containerWidget;\n                    i--;\n                }\n                index = prevBodyWidget.childWidgets.indexOf(widget);\n                if (isSplittedToNewPage) {\n                    prevBodyWidget = paragraph.getSplitWidgets()[i + 1].containerWidget;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftTableWidget = function (table, viewer) {\n        var tables = [table];\n        this.addTableWidget(this.viewer.clientActiveArea, tables);\n        this.viewer.updateClientAreaTopOrLeft(table, true);\n        var row = table.childWidgets[0];\n        while (row) {\n            row = this.shiftRowWidget(tables, row);\n            row = row.nextRow;\n        }\n        this.updateWidgetsToPage(tables, [], table);\n        return tables[tables.length - 1];\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftRowWidget = function (tables, row) {\n        var viewer = this.viewer;\n        var rows = [row];\n        var widget = this.addTableRowWidget(viewer.clientActiveArea, rows);\n        viewer.updateClientAreaForRow(row, true);\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            this.shiftCellWidget(cell, this.getMaxTopOrBottomCellMargin(row, 0) + row.topBorderWidth, this.getMaxTopOrBottomCellMargin(row, 1) + row.bottomBorderWidth);\n        }\n        viewer.updateClientAreaForRow(row, false);\n        this.updateWidgetsToTable(tables, rows, row);\n        return rows[rows.length - 1];\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftCellWidget = function (cell, maxCellMarginTop, maxCellMarginBottom) {\n        var viewer = this.viewer;\n        this.addTableCellWidget(cell, viewer.clientActiveArea, maxCellMarginTop, maxCellMarginBottom);\n        viewer.updateClientAreaForCell(cell, true);\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            if (block instanceof ParagraphWidget) {\n                this.shiftParagraphWidget(block);\n            }\n            else {\n                this.shiftTableWidget(block, viewer);\n            }\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        this.updateWidgetToRow(cell);\n        viewer.updateClientAreaForCell(cell, false);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftParagraphWidget = function (paragraph) {\n        this.addParagraphWidget(this.viewer.clientActiveArea, paragraph);\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + paragraph.height);\n        this.updateWidgetToPage(this.viewer, paragraph);\n    };\n    Layout.prototype.shiftWidgetsForTable = function (table, viewer) {\n        var prevObj = this.getBodyWidgetOfPreviousBlock(table, 0);\n        var prevBodyWidget = prevObj.bodyWidget;\n        var index = prevObj.index;\n        var isPageBreak = prevBodyWidget.lastChild.lastChild.isEndsWithPageBreak;\n        if (prevBodyWidget !== table.containerWidget) {\n            if (!isPageBreak) {\n                this.updateContainerWidget(table, prevBodyWidget, index + 1, true);\n            }\n            else {\n                viewer.updateClientArea(table.bodyWidget.sectionFormat, table.bodyWidget.page);\n            }\n        }\n        if (table.isInHeaderFooter) {\n            table.containerWidget.height -= table.height;\n        }\n        table.y = this.viewer.clientActiveArea.y;\n        this.updateVerticalPositionToTop(table, true);\n        var isPageLayout = viewer instanceof PageLayoutViewer;\n        var combinedTable = table.combineWidget(this.viewer);\n        this.viewer.layout.updateChildLocationForTable(combinedTable.y, combinedTable);\n        this.clearTableWidget(combinedTable, true, false);\n        this.shiftTableWidget(combinedTable, this.viewer);\n        this.updateVerticalPositionToTop(table, false);\n    };\n    Layout.prototype.updateVerticalPositionToTop = function (table, isUpdateTop) {\n        //Iterate the tableWidgets counts\n        for (var i = 0; i < table.getSplitWidgets().length; i++) {\n            var tablewidget = table.getSplitWidgets()[i];\n            //Iterate the tableWidget child items\n            for (var j = 0; j < tablewidget.childWidgets.length; j++) {\n                var rowWidget = tablewidget.childWidgets[j];\n                //Iterate the RowWidgets child items\n                for (var k = 0; k < rowWidget.childWidgets.length; k++) {\n                    var cellWidget = rowWidget.childWidgets[k];\n                    //Iterate the RowWidgets child items\n                    this.viewer.layout.updateCellVerticalPosition(cellWidget, isUpdateTop, false);\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitWidget = function (paragraphWidget, viewer, previousBodyWidget, index, isPageBreak) {\n        var firstLine = paragraphWidget.childWidgets[0];\n        var maxElementHeight = this.getMaxElementHeight(firstLine, viewer);\n        var paragraphView = paragraphWidget.getSplitWidgets();\n        var nextBodyWidget = paragraphWidget.containerWidget;\n        if (viewer.clientActiveArea.height >= maxElementHeight && !isPageBreak) {\n            var splittedWidget = undefined;\n            var widgetIndex = paragraphView.indexOf(paragraphWidget);\n            if (widgetIndex < (paragraphView.length - 1)) {\n                splittedWidget = paragraphView[widgetIndex + 1];\n                nextBodyWidget = splittedWidget.containerWidget;\n            }\n            else {\n                splittedWidget = new ParagraphWidget();\n                splittedWidget.index = paragraphWidget.index;\n                splittedWidget.characterFormat = paragraphWidget.characterFormat;\n                splittedWidget.paragraphFormat = paragraphWidget.paragraphFormat;\n                splittedWidget.width = paragraphWidget.width;\n                splittedWidget.x = paragraphWidget.x;\n                splittedWidget.y = paragraphWidget.y;\n                paragraphView.push(splittedWidget);\n            }\n            if (previousBodyWidget !== paragraphWidget.containerWidget) {\n                this.updateContainerWidget(paragraphWidget, previousBodyWidget, index, true);\n            }\n            for (var i = paragraphWidget.childWidgets.length - 1; i > 0; i--) {\n                if (this.isFitInClientArea(paragraphWidget, viewer)) {\n                    break;\n                }\n                else {\n                    var line = paragraphWidget.childWidgets[i];\n                    //Moves the line widget to next widget.\n                    this.updateParagraphWidgetInternal(line, splittedWidget, 0);\n                }\n            }\n            if (isNullOrUndefined(splittedWidget.containerWidget) && splittedWidget.childWidgets.length > 0) {\n                var y = viewer.clientActiveArea.y;\n                // tslint:disable-next-line:max-line-length\n                var clientArea = new Rect(viewer.clientArea.x, viewer.clientArea.y, viewer.clientArea.width, viewer.clientArea.height);\n                var activeArea = new Rect(viewer.clientActiveArea.x, viewer.clientActiveArea.y, viewer.clientActiveArea.width, viewer.clientActiveArea.height);\n                //Checks whether next node exists, else adds new page.\n                nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                // nextBodyWidget = this.createOrGetNextBodyWidget(previousBodyWidget, viewer);\n                nextBodyWidget.childWidgets.splice(0, 0, splittedWidget);\n                nextBodyWidget.height += splittedWidget.height;\n                splittedWidget.containerWidget = nextBodyWidget;\n                if (nextBodyWidget.childWidgets.length === 1 && nextBodyWidget.firstChild instanceof ParagraphWidget &&\n                    nextBodyWidget.firstChild.equals(paragraphWidget)) {\n                    paragraphWidget.x = paragraphWidget.x;\n                    paragraphWidget.y = y;\n                    return true;\n                }\n                else {\n                    //Resetting Client area\n                    viewer.clientArea = clientArea;\n                    viewer.clientActiveArea = activeArea;\n                }\n            }\n        }\n        else {\n            nextBodyWidget = this.createOrGetNextBodyWidget(previousBodyWidget, this.viewer);\n            if (paragraphWidget.containerWidget !== nextBodyWidget) {\n                nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                this.updateContainerWidget(paragraphWidget, nextBodyWidget, 0, true);\n            }\n        }\n        if (previousBodyWidget === paragraphWidget.containerWidget) {\n            paragraphWidget.y = viewer.clientActiveArea.y;\n            viewer.cutFromTop(viewer.clientActiveArea.y + paragraphWidget.height);\n        }\n        else {\n            //Updates client area based on next body widget.\n            viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n        }\n        return false;\n    };\n    Layout.prototype.getMaxElementHeight = function (lineWidget, viewer) {\n        var height = 0;\n        // tslint:disable-next-line:max-line-length\n        if (lineWidget.children.length === 0 || ((lineWidget.children.length === 1 && lineWidget.children[0] instanceof ListTextElementBox) || (lineWidget.children.length === 2 && lineWidget.children[0] instanceof ListTextElementBox && lineWidget.children[1] instanceof ListTextElementBox))) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            height = viewer.selection.getParagraphMarkSize(lineWidget.paragraph, topMargin, bottomMargin).height;\n            height += topMargin;\n            if (lineWidget.children.length > 0) {\n                var element = lineWidget.children[0];\n                if (height < element.margin.top + element.height) {\n                    height = element.margin.top + element.height;\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < lineWidget.children.length; i++) {\n                var element = lineWidget.children[i];\n                if (height < element.margin.top + element.height) {\n                    height = element.margin.top + element.height;\n                }\n            }\n        }\n        return height;\n    };\n    Layout.prototype.createOrGetNextBodyWidget = function (bodyWidget, viewer) {\n        var nextBodyWidget = undefined;\n        var pageIndex = 0;\n        pageIndex = viewer.pages.indexOf(bodyWidget.page);\n        var page = undefined;\n        var index = undefined;\n        index = bodyWidget.index;\n        if (pageIndex === viewer.pages.length - 1\n            || viewer.pages[pageIndex + 1].sectionIndex !== index) {\n            var currentWidget = new BodyWidget();\n            currentWidget.sectionFormat = bodyWidget.sectionFormat;\n            currentWidget.index = bodyWidget.index;\n            page = viewer.createNewPage(currentWidget);\n            if (viewer.pages[pageIndex + 1].sectionIndex !== index) {\n                viewer.insertPage(pageIndex + 1, page);\n            }\n            nextBodyWidget = page.bodyWidgets[0];\n        }\n        else {\n            page = viewer.pages[pageIndex + 1];\n            nextBodyWidget = page.bodyWidgets[0];\n        }\n        return nextBodyWidget;\n    };\n    Layout.prototype.isFitInClientArea = function (paragraphWidget, viewer) {\n        var lastLine = paragraphWidget.childWidgets[paragraphWidget.childWidgets.length - 1];\n        var height = paragraphWidget.height;\n        var maxElementHeight = this.getMaxElementHeight(lastLine, viewer);\n        if (lastLine.height > maxElementHeight) {\n            height -= lastLine.height - maxElementHeight;\n        }\n        return viewer.clientActiveArea.height >= height;\n    };\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.shiftToPreviousWidget = function (paragraphWidget, viewer, previousWidget, isPageBreak) {\n        for (var i = 0; i < paragraphWidget.childWidgets.length; i++) {\n            var line = paragraphWidget.childWidgets[i];\n            var maxElementHeight = this.getMaxElementHeight(line, viewer);\n            if (viewer.clientActiveArea.height >= maxElementHeight && !isPageBreak) {\n                //Moves the line widget to previous widget.\n                this.updateParagraphWidgetInternal(line, previousWidget, previousWidget.childWidgets.length);\n                i--;\n                viewer.cutFromTop(viewer.clientActiveArea.y + line.height);\n                if (isNullOrUndefined(paragraphWidget.childWidgets)) {\n                    break;\n                }\n            }\n            else {\n                var bodyWidget = previousWidget.containerWidget;\n                var nextBodyWidget = this.createOrGetNextBodyWidget(bodyWidget, viewer);\n                if (paragraphWidget.containerWidget !== nextBodyWidget) {\n                    nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                }\n                if (bodyWidget !== nextBodyWidget) {\n                    this.updateContainerWidget(paragraphWidget, nextBodyWidget, 0, true);\n                }\n                //Updates client area based on next page.\n                viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n                break;\n            }\n        }\n    };\n    Layout.prototype.updateParagraphWidgetInternal = function (lineWidget, newParagraphWidget, index) {\n        if (!isNullOrUndefined(lineWidget.paragraph)) {\n            lineWidget.paragraph.childWidgets.splice(lineWidget.paragraph.childWidgets.indexOf(lineWidget), 1);\n            lineWidget.paragraph.height -= lineWidget.height;\n            if (!isNullOrUndefined(lineWidget.paragraph.containerWidget)) {\n                lineWidget.paragraph.containerWidget.height -= lineWidget.height;\n            }\n            // tslint:disable-next-line:max-line-length\n            if (isNullOrUndefined(lineWidget.paragraph.childWidgets) || lineWidget.paragraph.childWidgets.length === 0) {\n                lineWidget.paragraph.destroyInternal(this.viewer);\n            }\n        }\n        newParagraphWidget.childWidgets.splice(index, 0, lineWidget);\n        lineWidget.paragraph = newParagraphWidget;\n        newParagraphWidget.height += lineWidget.height;\n        if (!isNullOrUndefined(newParagraphWidget.containerWidget)) {\n            newParagraphWidget.containerWidget.height += lineWidget.height;\n        }\n    };\n    Layout.prototype.shiftNextWidgets = function (blockAdv) {\n        var block = blockAdv;\n        while (block.nextWidget instanceof BlockWidget) {\n            block = block.nextWidget;\n            this.reLayoutOrShiftWidgets(block, this.viewer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateContainerWidget = function (widget, bodyWidget, index, destroyAndScroll) {\n        if (!isNullOrUndefined(widget.containerWidget)) {\n            widget.containerWidget.childWidgets.splice(widget.containerWidget.childWidgets.indexOf(widget), 1);\n            widget.containerWidget.height -= bodyWidget.height;\n            if ((isNullOrUndefined(widget.containerWidget.childWidgets) || widget.containerWidget.childWidgets.length === 0)\n                && widget.containerWidget instanceof BodyWidget && widget.containerWidget !== bodyWidget && destroyAndScroll) {\n                var page = widget.containerWidget.page;\n                if (this.viewer.pages[this.viewer.pages.length - 1] === page &&\n                    this.viewer.visiblePages.indexOf(page) !== -1) {\n                    this.viewer.scrollToBottom();\n                }\n                if (isNullOrUndefined(page.nextPage) || page.nextPage.bodyWidgets[0].index !== widget.containerWidget.index) {\n                    widget.containerWidget.destroyInternal(this.viewer);\n                }\n            }\n        }\n        bodyWidget.childWidgets.splice(index, 0, widget);\n        bodyWidget.height += bodyWidget.height;\n        widget.containerWidget = bodyWidget;\n    };\n    Layout.prototype.getBodyWidgetOfPreviousBlock = function (block, index) {\n        index = 0;\n        var prevBodyWidget = undefined;\n        var previousBlock = block.previousRenderedWidget;\n        prevBodyWidget = (previousBlock && previousBlock.containerWidget.equals(block.containerWidget)) ?\n            previousBlock.containerWidget : block.containerWidget;\n        index = previousBlock && previousBlock.containerWidget.equals(block.containerWidget) ?\n            prevBodyWidget.childWidgets.indexOf(previousBlock) : block.containerWidget.childWidgets.indexOf(block);\n        return { bodyWidget: prevBodyWidget, index: index };\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.moveBlocksToNextPage = function (block) {\n        var body = block.bodyWidget;\n        var page = body.page;\n        var pageIndex = page.index + 1;\n        var nextPage = undefined;\n        var nextBody = undefined;\n        var insertPage = false;\n        if (this.viewer.pages.length > pageIndex) {\n            nextPage = this.viewer.pages[pageIndex];\n            if (nextPage.bodyWidgets.length === 0 || !body.equals(nextPage.bodyWidgets[0])) {\n                nextPage = undefined;\n                insertPage = true;\n            }\n            else {\n                nextBody = nextPage.bodyWidgets[0];\n                this.viewer.updateClientArea(nextBody.sectionFormat, nextBody.page);\n            }\n        }\n        if (isNullOrUndefined(nextPage)) {\n            nextBody = this.createSplitBody(body);\n            nextPage = this.viewer.createNewPage(nextBody, pageIndex);\n            if (insertPage) {\n                this.viewer.insertPage(pageIndex, nextPage);\n            }\n        }\n        //tslint:disable :no-constant-condition\n        do {\n            var lastBlock = body.lastChild;\n            if (block === lastBlock) {\n                break;\n            }\n            body.childWidgets.pop();\n            nextBody.childWidgets.splice(0, 0, lastBlock);\n            lastBlock.containerWidget = nextBody;\n            nextBody.height += lastBlock.height;\n        } while (true);\n        return nextBody;\n    };\n    Layout.prototype.createSplitBody = function (body) {\n        var newBody = this.addBodyWidget(this.viewer.clientActiveArea);\n        newBody.sectionFormat = body.sectionFormat;\n        newBody.index = body.index;\n        return newBody;\n    };\n    //endregion\n    //#region Relayout Parargaph \n    /**\n     * Relayout Paragraph from specified line widget\n     * @param paragraph Paragraph to reLayout\n     * @param lineIndex start line index to reLayout\n     * @private\n     */\n    Layout.prototype.reLayoutLine = function (paragraph, lineIndex) {\n        if (this.viewer.owner.isDocumentLoaded && this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateWholeListItems(paragraph);\n        }\n        var lineWidget;\n        if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n            lineWidget = paragraph.getSplitWidgets()[0].firstChild;\n        }\n        else {\n            lineWidget = paragraph.childWidgets[lineIndex];\n        }\n        var lineToLayout = lineWidget.previousLine;\n        if (isNullOrUndefined(lineToLayout)) {\n            lineToLayout = lineWidget;\n        }\n        var currentParagraph = lineToLayout.paragraph;\n        var bodyWidget = paragraph.containerWidget;\n        bodyWidget.height -= paragraph.height;\n        if (this.viewer.owner.enableHeaderAndFooter || paragraph.isInHeaderFooter) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.updateHCFClientAreaWithTop(paragraph.bodyWidget.sectionFormat, this.viewer.isBlockInHeader(paragraph), bodyWidget.page);\n        }\n        else {\n            this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n        }\n        this.viewer.updateClientAreaForBlock(paragraph, true);\n        if (lineToLayout.paragraph.isEmpty()) {\n            this.viewer.cutFromTop(paragraph.y);\n            this.layoutParagraph(paragraph, 0);\n        }\n        else {\n            this.updateClientAreaForLine(lineToLayout.paragraph, lineToLayout, 0);\n            this.layoutListItems(lineToLayout.paragraph);\n            if (lineToLayout.isFirstLine() && !isNullOrUndefined(paragraph.paragraphFormat)) {\n                var firstLineIndent = -HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                this.viewer.updateClientWidth(firstLineIndent);\n            }\n            do {\n                lineToLayout = this.layoutLine(lineToLayout, 0);\n                paragraph = lineToLayout.paragraph;\n                lineToLayout = lineToLayout.nextLine;\n            } while (lineToLayout);\n            this.updateWidgetToPage(this.viewer, paragraph);\n            this.viewer.updateClientAreaForBlock(paragraph, false);\n        }\n        this.layoutNextItemsBlock(paragraph, this.viewer);\n    };\n    return Layout;\n}());\nexport { Layout };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Rect, ImageElementBox, ParagraphWidget, ListTextElementBox, TableRowWidget, TableWidget, TableCellWidget, FieldElementBox, TabElementBox } from './page';\nimport { Layout } from './layout';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar Renderer = /** @class */ (function () {\n    function Renderer(viewer) {\n        this.isPrinting = false;\n        this.pageLeft = 0;\n        this.pageTop = 0;\n        this.isFieldCode = false;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(Renderer.prototype, \"pageCanvas\", {\n        /**\n         * Gets page canvas.\n         * @private\n         */\n        get: function () {\n            if (this.isPrinting) {\n                if (isNullOrUndefined(this.pageCanvasIn)) {\n                    this.pageCanvasIn = document.createElement('canvas');\n                    this.pageCanvasIn.getContext('2d').save();\n                }\n                return this.pageCanvasIn;\n            }\n            return isNullOrUndefined(this.viewer) ? undefined : this.viewer.containerCanvas;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"selectionCanvas\", {\n        /**\n         * Gets selection canvas.\n         */\n        get: function () {\n            return isNullOrUndefined(this.viewer) ? undefined : this.viewer.selectionCanvas;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"pageContext\", {\n        /**\n         * Gets page context.\n         */\n        get: function () {\n            return this.pageCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"selectionContext\", {\n        /**\n         * Gets selection context.\n         */\n        get: function () {\n            return this.selectionCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets the color.\n     * @private\n     */\n    Renderer.prototype.getColor = function (color) {\n        if (color.length > 0) {\n            if (color[0] === '#') {\n                if (color.length > 7) {\n                    return color.substr(0, 7);\n                }\n            }\n        }\n        return color;\n    };\n    /**\n     * Renders widgets.\n     * @param {Page} page\n     * @param {number} left\n     * @param {number} top\n     * @param {number} width\n     * @param {number} height\n     * @private\n     */\n    Renderer.prototype.renderWidgets = function (page, left, top, width, height) {\n        if (isNullOrUndefined(this.pageCanvas) || isNullOrUndefined(page)) {\n            return;\n        }\n        this.pageContext.fillStyle = this.getColor(this.viewer.backgroundColor);\n        this.pageContext.beginPath();\n        this.pageContext.fillRect(left, top, width, height);\n        this.pageContext.closePath();\n        this.pageContext.strokeStyle = this.viewer.owner.pageOutline;\n        this.pageContext.strokeRect(left, top, width, height);\n        this.pageLeft = left;\n        this.pageTop = top;\n        if (this.isPrinting) {\n            this.setPageSize(page);\n        }\n        else {\n            this.pageContext.beginPath();\n            this.pageContext.save();\n            this.pageContext.rect(left, top, width, height);\n            this.pageContext.clip();\n        }\n        if (page.headerWidget) {\n            this.renderHFWidgets(page, page.headerWidget, width, true);\n        }\n        if (page.footerWidget) {\n            this.renderHFWidgets(page, page.footerWidget, width, false);\n        }\n        for (var i = 0; i < page.bodyWidgets.length; i++) {\n            this.render(page, page.bodyWidgets[i]);\n        }\n        if (this.viewer.owner.enableHeaderAndFooter && !this.isPrinting) {\n            this.renderHeaderSeparator(page, this.pageLeft, this.pageTop, page.headerWidget);\n        }\n        this.pageLeft = 0;\n        this.pageTop = 0;\n        this.pageContext.restore();\n    };\n    /**\n     * Sets page size.\n     * @param {Page} page\n     */\n    Renderer.prototype.setPageSize = function (page) {\n        this.pageContext.clearRect(0, 0, this.pageCanvas.width, this.pageCanvas.height);\n        this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        this.pageContext.restore();\n        this.selectionContext.restore();\n        var width = page.boundingRectangle.width;\n        var height = page.boundingRectangle.height;\n        var dpr = Math.max(1, window.devicePixelRatio || 1);\n        if (this.pageCanvas.width !== width * dpr || this.pageCanvas.height !== height * dpr) {\n            this.pageCanvas.height = height * dpr;\n            this.pageCanvas.width = width * dpr;\n            this.pageCanvas.style.height = height + 'px';\n            this.pageCanvas.style.width = width + 'px';\n            this.pageContext.globalAlpha = 1;\n            this.pageContext.scale(dpr, dpr);\n        }\n    };\n    /**\n     * Renders header footer widget.\n     * @param {Page} page\n     * @param {HeaderFooterWidget} headFootWidget\n     */\n    Renderer.prototype.renderHFWidgets = function (page, widget, width, isHeader) {\n        this.pageContext.globalAlpha = this.viewer.owner.enableHeaderAndFooter ? 1 : 0.65;\n        var cliped = false;\n        if (isHeader) {\n            var topMargin = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin);\n            var widgetHeight = Math.max((widget.y + widget.height), topMargin);\n            var headerFooterHeight = page.boundingRectangle.height / 100 * 40;\n            if (widgetHeight > headerFooterHeight) {\n                cliped = true;\n                this.pageContext.beginPath();\n                this.pageContext.save();\n                this.pageContext.rect(this.pageLeft, this.pageTop, width, this.getScaledValue(headerFooterHeight));\n                this.pageContext.clip();\n            }\n        }\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var block = widget.childWidgets[i];\n            this.renderWidget(page, block);\n        }\n        if (cliped) {\n            this.pageContext.restore();\n        }\n        this.pageContext.globalAlpha = this.viewer.owner.enableHeaderAndFooter ? 0.65 : 1;\n    };\n    Renderer.prototype.renderHeaderSeparator = function (page, left, top, widget) {\n        //Header Widget\n        var topMargin = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin);\n        var y = this.getScaledValue(Math.max((widget.y + widget.height), topMargin));\n        var pageWidth = this.getScaledValue(page.boundingRectangle.width);\n        var ctx = this.pageContext;\n        ctx.save();\n        ctx.globalAlpha = 0.65;\n        var headerFooterHeight = (this.getScaledValue(page.boundingRectangle.height) / 100) * 40;\n        //Maximum header height limit       \n        y = Math.min(y, headerFooterHeight);\n        //Dash line Separator\n        this.renderDashLine(ctx, left, top + y, pageWidth, '#000000', false);\n        var type = this.getHeaderFooterType(page, true);\n        ctx.font = '9pt Arial';\n        var width = ctx.measureText(type).width;\n        this.renderHeaderFooterMark(ctx, left + 5, top + y, width + 10, 20);\n        this.renderHeaderFooterMarkText(ctx, type, left + 10, y + top + 15);\n        if (page.footerWidget) {\n            //Footer Widget\n            var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n            // tslint:disable-next-line:max-line-length\n            var footerHeight = this.getScaledValue(page.boundingRectangle.height) -\n                this.getScaledValue(Math.max(page.footerWidget.height + footerDistance, HelperMethods.convertPointToPixel(page.footerWidget.sectionFormat.bottomMargin)));\n            //Maximum footer height limit     \n            footerHeight = Math.max((this.getScaledValue(page.boundingRectangle.height) - headerFooterHeight), footerHeight);\n            this.renderDashLine(ctx, left, top + footerHeight, pageWidth, '#000000', false);\n            type = this.getHeaderFooterType(page, false);\n            width = ctx.measureText(type).width;\n            this.renderHeaderFooterMark(ctx, left + 5, top + footerHeight - 20, width + 10, 20);\n            this.renderHeaderFooterMarkText(ctx, type, left + 10, top + footerHeight - 5);\n            ctx.restore();\n        }\n    };\n    Renderer.prototype.getHeaderFooterType = function (page, isHeader) {\n        var type;\n        type = isHeader ? 'Header' : 'Footer';\n        if (page.bodyWidgets[0].sectionFormat.differentFirstPage && this.viewer.pages.indexOf(page) === 0) {\n            type = isHeader ? 'First Page Header' : 'First Page Footer';\n        }\n        else if (page.bodyWidgets[0].sectionFormat.differentOddAndEvenPages) {\n            if ((this.viewer.pages.indexOf(page) + 1) % 2 === 0) {\n                type = isHeader ? 'Even Page Header' : 'Even Page Footer';\n            }\n            else {\n                type = isHeader ? 'Odd Page Header' : 'Odd Page Footer';\n            }\n        }\n        return type;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderDashLine = function (ctx, x, y, width, fillStyle, isSmallDash) {\n        ctx.beginPath();\n        ctx.strokeStyle = fillStyle;\n        ctx.lineWidth = 1;\n        if (isSmallDash) {\n            ctx.setLineDash([3, 2]);\n        }\n        else {\n            ctx.setLineDash([6, 4]);\n        }\n        ctx.moveTo(x, y);\n        ctx.lineTo(x + width, y);\n        ctx.stroke();\n        ctx.setLineDash([]);\n        ctx.closePath();\n    };\n    Renderer.prototype.renderHeaderFooterMark = function (ctx, x, y, w, h) {\n        ctx.beginPath();\n        ctx.fillStyle = 'lightgray';\n        ctx.fillRect(x, y, w, h);\n        ctx.strokeStyle = 'black';\n        ctx.strokeRect(x, y, w, h);\n        ctx.closePath();\n    };\n    Renderer.prototype.renderHeaderFooterMarkText = function (ctx, content, x, y) {\n        ctx.beginPath();\n        ctx.fillStyle = '#000000';\n        ctx.textBaseline = 'alphabetic';\n        ctx.fillText(content, x, y);\n        ctx.closePath();\n    };\n    /**\n     * Renders body widget.\n     * @param {Page} page\n     * @param {BodyWidget} bodyWidget\n     */\n    Renderer.prototype.render = function (page, bodyWidget) {\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var widget = bodyWidget.childWidgets[i];\n            if (i === 0 && bodyWidget.childWidgets[0] instanceof TableWidget && page.repeatHeaderRowTableWidget) {\n                // tslint:disable-next-line:max-line-length\n                this.renderHeader(page, widget, this.viewer.layout.getHeader(bodyWidget.childWidgets[0]));\n            }\n            this.renderWidget(page, widget);\n        }\n    };\n    /**\n     * Renders block widget.\n     * @param {Page} page\n     * @param {Widget} widget\n     */\n    Renderer.prototype.renderWidget = function (page, widget) {\n        if (widget instanceof ParagraphWidget) {\n            this.renderParagraphWidget(page, widget);\n        }\n        else {\n            this.renderTableWidget(page, widget);\n        }\n    };\n    /**\n     * Renders header.\n     * @param {Page} page\n     * @param {TableWidget} widget\n     * @param {WRow} header\n     * @private\n     */\n    Renderer.prototype.renderHeader = function (page, widget, header) {\n        if (isNullOrUndefined(header)) {\n            return;\n        }\n        var top = page.viewer.clientArea.y;\n        for (var i = 0; i <= header.rowIndex; i++) {\n            if (header.ownerTable.getSplitWidgets()[0].childWidgets.length === 0) {\n                return;\n            }\n            var row = header.ownerTable.getSplitWidgets()[0].childWidgets[0];\n            var headerWidget = row.clone();\n            headerWidget.containerWidget = row.containerWidget;\n            // tslint:disable-next-line:max-line-length\n            page.viewer.updateClientAreaLocation(headerWidget, new Rect(page.viewer.clientArea.x, top, headerWidget.width, headerWidget.height));\n            page.viewer.layout.updateChildLocationForRow(top, headerWidget);\n            var cell = undefined;\n            //Renders table cell outline rectangle - Border and background color.\n            for (var j = 0; j < headerWidget.childWidgets.length; j++) {\n                cell = headerWidget.childWidgets[j];\n                this.renderTableCellWidget(page, cell);\n            }\n            top += headerWidget.height;\n        }\n        if (widget.y !== top) {\n            //this.Location.Y = top;\n            page.viewer.layout.updateChildLocationForTable(top, widget);\n        }\n    };\n    /**\n     * Renders paragraph widget.\n     * @param {Page} page\n     * @param {ParagraphWidget} paraWidget\n     */\n    Renderer.prototype.renderParagraphWidget = function (page, paraWidget) {\n        var top = paraWidget.y;\n        var left = paraWidget.x;\n        for (var i = 0; i < paraWidget.childWidgets.length; i++) {\n            var widget = paraWidget.childWidgets[i];\n            this.renderLine(widget, page, left, top);\n            top += widget.height;\n        }\n    };\n    /**\n     * Renders table widget.\n     * @param {Page} page\n     * @param {TableWidget} tableWidget\n     */\n    Renderer.prototype.renderTableWidget = function (page, tableWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var widget = tableWidget.childWidgets[i];\n            this.renderTableRowWidget(page, widget);\n            if (tableWidget.tableFormat.cellSpacing > 0) {\n                this.renderTableOutline(tableWidget);\n            }\n        }\n    };\n    /**\n     * Renders table row widget.\n     * @param {Page} page\n     * @param {Widget} rowWidget\n     */\n    Renderer.prototype.renderTableRowWidget = function (page, rowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var widget = rowWidget.childWidgets[i];\n            this.renderTableCellWidget(page, widget);\n        }\n    };\n    /**\n     * Renders table cell widget.\n     * @param {Page} page\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderTableCellWidget = function (page, cellWidget) {\n        if (!this.isPrinting) {\n            if (this.getScaledValue(cellWidget.y, 2) + cellWidget.height * this.viewer.zoomFactor < 0 ||\n                this.getScaledValue(cellWidget.y, 2) > this.viewer.visibleBounds.height) {\n                return;\n            }\n        }\n        var widgetHeight = 0;\n        if (!this.isPrinting && page.viewer.owner.selection && page.viewer.owner.selection.selectedWidgets.length > 0) {\n            page.viewer.owner.selection.addSelectionHighlightTable(this.selectionContext, cellWidget);\n        }\n        this.renderTableCellOutline(page.viewer, cellWidget);\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            var widget = cellWidget.childWidgets[i];\n            var width = cellWidget.width + cellWidget.margin.left - cellWidget.leftBorderWidth;\n            this.clipRect(cellWidget.x, cellWidget.y, this.getScaledValue(width), this.getScaledValue(cellWidget.height));\n            this.renderWidget(page, widget);\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Renders line widget.\n     * @param {LineWidget} lineWidget\n     * @param {Page} page\n     * @param {number} left\n     * @param {number} top\n     */\n    Renderer.prototype.renderLine = function (lineWidget, page, left, top) {\n        if (!this.isPrinting && page.viewer.owner.selection && page.viewer.owner.selection.selectedWidgets.length > 0) {\n            page.viewer.owner.selection.addSelectionHighlight(this.selectionContext, lineWidget, top);\n        }\n        if (lineWidget.isFirstLine()) {\n            left += HelperMethods.convertPointToPixel(lineWidget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        if (this.viewer.owner.searchModule) {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(page.viewer.owner.searchModule.searchHighlighters) && page.viewer.owner.searchModule.searchHighlighters.containsKey(lineWidget)) {\n                var widgetInfo = page.viewer.owner.searchModule.searchHighlighters.get(lineWidget);\n                for (var i = 0; i < widgetInfo.length; i++) {\n                    this.pageContext.fillStyle = '#ffe97f';\n                    // tslint:disable-next-line:max-line-length\n                    this.pageContext.fillRect(this.getScaledValue(widgetInfo[i].left, 1), this.getScaledValue(top, 2), this.getScaledValue(widgetInfo[i].width), this.getScaledValue(lineWidget.height));\n                }\n            }\n        }\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var elementBox = lineWidget.children[i];\n            if (elementBox instanceof FieldElementBox || this.isFieldCode ||\n                (elementBox.width === 0 && elementBox.height === 0)) {\n                if (this.isFieldCode) {\n                    elementBox.width = 0;\n                }\n                left += elementBox.width + elementBox.margin.left;\n                this.toSkipFieldCode(elementBox);\n                continue;\n            }\n            var underlineY = this.getUnderlineYPosition(lineWidget);\n            if (!this.isPrinting) {\n                if (this.getScaledValue(top + elementBox.margin.top, 2) + elementBox.height * this.viewer.zoomFactor < 0 ||\n                    this.getScaledValue(top + elementBox.margin.top, 2) > this.viewer.visibleBounds.height) {\n                    left += elementBox.width + elementBox.margin.left;\n                    continue;\n                }\n            }\n            if (elementBox instanceof ListTextElementBox) {\n                this.renderListTextElementBox(elementBox, left, top, underlineY);\n            }\n            else if (elementBox instanceof ImageElementBox) {\n                this.renderImageElementBox(elementBox, left, top, underlineY);\n            }\n            else {\n                this.renderTextElementBox(elementBox, left, top, underlineY);\n            }\n            left += elementBox.width + elementBox.margin.left;\n        }\n    };\n    Renderer.prototype.toSkipFieldCode = function (element) {\n        if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0) {\n                if ((!isNullOrUndefined(element.fieldEnd) || element.hasFieldEnd)) {\n                    this.isFieldCode = true;\n                }\n            }\n            else if (element.fieldType === 2 || element.fieldType === 1) {\n                this.isFieldCode = false;\n            }\n        }\n    };\n    /**\n     * Gets underline y position.\n     * @param {LineWidget} lineWidget\n     * @private\n     */\n    Renderer.prototype.getUnderlineYPosition = function (lineWidget) {\n        var height = 0;\n        var lineHeight = 0;\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            if (lineWidget.children[i] instanceof FieldElementBox ||\n                (lineWidget.children[i].width === 0 && lineWidget.children[i].height === 0)) {\n                continue;\n            }\n            if (height < lineWidget.children[i].height + lineWidget.children[i].margin.top) {\n                height = lineWidget.children[i].margin.top + lineWidget.children[i].height;\n                lineHeight = lineWidget.children[i].height / 20;\n            }\n        }\n        return height - 2 * lineHeight;\n    };\n    /**\n     * Renders list element box\n     * @param {ListTextElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    Renderer.prototype.renderListTextElementBox = function (elementBox, left, top, underlineY) {\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        var format = elementBox.listLevel.characterFormat;\n        var breakCharacterFormat = elementBox.line.paragraph.characterFormat;\n        var color = format.fontColor === '#000000' ? breakCharacterFormat.fontColor : format.fontColor;\n        this.pageContext.textBaseline = 'top';\n        var bold = '';\n        var italic = '';\n        var fontFamily = format.fontFamily === 'Verdana' ? breakCharacterFormat.fontFamily : format.fontFamily;\n        var fontSize = format.fontSize === 11 ? breakCharacterFormat.fontSize : format.fontSize;\n        // tslint:disable-next-line:max-line-length\n        var baselineAlignment = format.baselineAlignment === 'Normal' ? breakCharacterFormat.baselineAlignment : format.baselineAlignment;\n        bold = format.bold ? 'bold' : breakCharacterFormat.bold ? 'bold' : '';\n        italic = format.italic ? 'italic' : breakCharacterFormat.italic ? 'italic' : '';\n        fontSize = fontSize === 0 ? 0.5 : fontSize / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var strikethrough = format.strikethrough === 'None' ? breakCharacterFormat.strikethrough : format.strikethrough;\n        var highlightColor = format.highlightColor === 'NoColor' ? breakCharacterFormat.highlightColor :\n            format.highlightColor;\n        if (highlightColor !== 'NoColor') {\n            if (highlightColor.substring(0, 1) !== '#') {\n                this.pageContext.fillStyle = HelperMethods.getHighlightColorCode(highlightColor);\n            }\n            else {\n                this.pageContext.fillStyle = this.getColor(highlightColor);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        this.pageContext.font = bold + ' ' + italic + ' ' + fontSize * this.viewer.zoomFactor + 'pt' + ' ' + fontFamily;\n        if (baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - elementBox.height / 1.5;\n        }\n        this.pageContext.fillStyle = this.getColor(color);\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillText(elementBox.text, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width));\n        if (format.underline !== 'None' && !isNullOrUndefined(format.underline)) {\n            this.renderUnderline(elementBox, left, top, underlineY, color, format.underline, baselineAlignment);\n        }\n        if (strikethrough !== 'None') {\n            this.renderStrikeThrough(elementBox, left, top, format.strikethrough, color, baselineAlignment);\n        }\n    };\n    /**\n     * Renders text element box.\n     * @param {TextElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderTextElementBox = function (elementBox, left, top, underlineY) {\n        var isHeightType = false;\n        var containerWidget = elementBox.line.paragraph.containerWidget;\n        if (containerWidget instanceof TableCellWidget) {\n            isHeightType = (containerWidget.ownerRow.rowFormat.heightType === 'Exactly');\n        }\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        if (isHeightType) {\n            // tslint:disable-next-line:max-line-length\n            this.clipRect(containerWidget.x, containerWidget.y, this.getScaledValue(containerWidget.width), this.getScaledValue(containerWidget.height));\n        }\n        var format = elementBox.characterFormat;\n        if (format.highlightColor !== 'NoColor') {\n            if (format.highlightColor.substring(0, 1) !== '#') {\n                this.pageContext.fillStyle = HelperMethods.getHighlightColorCode(format.highlightColor);\n            }\n            else {\n                this.pageContext.fillStyle = this.getColor(format.highlightColor);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        var color = format.fontColor;\n        this.pageContext.textBaseline = 'top';\n        var bold = '';\n        var italic = '';\n        var fontSize = 11;\n        bold = format.bold ? 'bold' : '';\n        italic = format.italic ? 'italic' : '';\n        fontSize = format.fontSize === 0 ? 0.5 : format.fontSize / (format.baselineAlignment === 'Normal' ? 1 : 1.5);\n        this.pageContext.font = bold + ' ' + italic + ' ' + fontSize * this.viewer.zoomFactor + 'pt' + ' ' + format.fontFamily;\n        if (format.baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - elementBox.height / 1.5;\n        }\n        this.pageContext.fillStyle = this.getColor(color);\n        var scaledWidth = this.getScaledValue(elementBox.width);\n        var text = elementBox.text;\n        // tslint:disable-next-line:max-line-length\n        if (elementBox instanceof TabElementBox) {\n            var tabElement = elementBox;\n            if (tabElement.tabText === '' && !isNullOrUndefined(tabElement.tabLeader) && tabElement.tabLeader !== 'None') {\n                text = this.getTabLeader(elementBox);\n                tabElement.tabText = text;\n            }\n            else if (tabElement.tabText !== '') {\n                text = tabElement.tabText;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillText(text, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), scaledWidth);\n        if (format.underline !== 'None' && !isNullOrUndefined(format.underline)) {\n            // tslint:disable-next-line:max-line-length\n            this.renderUnderline(elementBox, left, top, underlineY, color, format.underline, format.baselineAlignment);\n        }\n        if (format.strikethrough !== 'None' && !isNullOrUndefined(format.strikethrough)) {\n            this.renderStrikeThrough(elementBox, left, top, format.strikethrough, color, format.baselineAlignment);\n        }\n        if (isHeightType) {\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Returns tab leader\n     */\n    Renderer.prototype.getTabLeader = function (elementBox) {\n        var textWidth = 0;\n        var tabString = this.getTabLeaderString(elementBox.tabLeader);\n        var tabText = tabString;\n        textWidth = this.viewer.textHelper.getWidth(tabText, elementBox.characterFormat);\n        var count = Math.floor(elementBox.width / textWidth);\n        for (var i = 0; i <= count; i++) {\n            tabText += tabString;\n        }\n        return tabText.slice(0, -1);\n    };\n    /**\n     * Returns tab leader string.\n     */\n    Renderer.prototype.getTabLeaderString = function (tabLeader) {\n        var tabString = '';\n        switch (tabLeader) {\n            case 'Dot':\n                tabString = '.';\n                break;\n            case 'Hyphen':\n                tabString = '-';\n                break;\n            case 'Underscore':\n                tabString = '_';\n                break;\n        }\n        return tabString;\n    };\n    /**\n     * Clips the rectangle with specified position.\n     * @param {number} xPos\n     * @param {number} yPos\n     * @param {number} width\n     * @param {number} height\n     */\n    Renderer.prototype.clipRect = function (xPos, yPos, width, height) {\n        this.pageContext.beginPath();\n        this.pageContext.save();\n        this.pageContext.rect(this.getScaledValue(xPos, 1), this.getScaledValue(yPos, 2), width, height);\n        this.pageContext.clip();\n    };\n    /**\n     * Renders underline.\n     * @param {ElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     * @param {string} color\n     * @param {Underline} underline\n     * @param {BaselineAlignment} baselineAlignment\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderUnderline = function (elementBox, left, top, underlineY, color, underline, baselineAlignment) {\n        var renderedHeight = elementBox.height / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var topMargin = elementBox.margin.top;\n        var underlineHeight = renderedHeight / 20;\n        var y = 0;\n        if (baselineAlignment === 'Subscript' || elementBox instanceof ListTextElementBox) {\n            y = (renderedHeight - 2 * underlineHeight) + top;\n            topMargin += elementBox.height - renderedHeight;\n            y += topMargin > 0 ? topMargin : 0;\n        }\n        else {\n            y = underlineY + top;\n        }\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillRect(this.getScaledValue(left + elementBox.margin.left, 1), this.getScaledValue(y, 2), this.getScaledValue(elementBox.width), this.getScaledValue(underlineHeight));\n    };\n    /**\n     * Renders strike through.\n     * @param {ElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {Strikethrough} strikethrough\n     * @param {string} color\n     * @param {BaselineAlignment} baselineAlignment\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderStrikeThrough = function (elementBox, left, top, strikethrough, color, baselineAlignment) {\n        var renderedHeight = elementBox.height / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var topMargin = elementBox.margin.top;\n        if (baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - renderedHeight;\n        }\n        top += topMargin > 0 ? topMargin : 0;\n        var lineHeight = renderedHeight / 20;\n        var y = (renderedHeight / 2) + (0.5 * lineHeight);\n        var lineCount = 0;\n        if (strikethrough === 'DoubleStrike') {\n            y -= lineHeight;\n        }\n        while (lineCount < (strikethrough === 'DoubleStrike' ? 2 : 1)) {\n            lineCount++;\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + elementBox.margin.left, 1), this.getScaledValue(y + top, 2), this.getScaledValue(elementBox.width), this.getScaledValue(lineHeight));\n            y += 2 * lineHeight;\n        }\n    };\n    /**\n     * Renders image element box.\n     * @param {ImageElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderImageElementBox = function (elementBox, left, top, underlineY) {\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        var color = 'black';\n        this.pageContext.textBaseline = 'top';\n        var widgetWidth = 0;\n        var isClipped = false;\n        if (topMargin < 0 || elementBox.line.paragraph.width < elementBox.width) {\n            var containerWid = elementBox.line.paragraph.containerWidget;\n            // if (containerWid instanceof BodyWidget) {\n            //     widgetWidth = containerWid.width + containerWid.x;\n            // } else \n            if (containerWid instanceof TableCellWidget) {\n                var leftIndent = 0;\n                if (containerWid.childWidgets[0] instanceof ParagraphWidget) {\n                    var paraAdv = containerWid.childWidgets[0];\n                    leftIndent = paraAdv.paragraphFormat.leftIndent;\n                }\n                widgetWidth = containerWid.width + containerWid.margin.left - containerWid.leftBorderWidth - leftIndent;\n                isClipped = true;\n                // tslint:disable-next-line:max-line-length\n                this.clipRect(left + leftMargin, top + topMargin, this.getScaledValue(widgetWidth), this.getScaledValue(containerWid.height));\n            }\n        }\n        if (elementBox.isMetaFile) {\n            /* tslint:disable:no-empty */\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.drawImage(elementBox.element, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        if (isClipped) {\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Renders table outline.\n     * @param {TableWidget} tableWidget\n     */\n    Renderer.prototype.renderTableOutline = function (tableWidget) {\n        var layout = new Layout(this.viewer);\n        var table = tableWidget;\n        tableWidget.width = this.viewer.layout.getTableWidth(table);\n        var border = layout.getTableTopBorder(table.tableFormat.borders);\n        var lineWidth = 0;\n        //ToDo: Need to draw the borders based on the line style.\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth / 2, tableWidget.y, tableWidget.x - tableWidget.margin.left - lineWidth / 2, tableWidget.y + tableWidget.height, lineWidth);\n        // }\n        border = layout.getTableTopBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth, tableWidget.y - lineWidth / 2, tableWidget.x + tableWidget.width + lineWidth + tableWidget.margin.right, tableWidget.y - lineWidth / 2, lineWidth);\n        // }\n        border = layout.getTableRightBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x + tableWidget.width + tableWidget.margin.right + lineWidth / 2, tableWidget.y, tableWidget.x + tableWidget.width + tableWidget.margin.right + lineWidth / 2, tableWidget.y + tableWidget.height, lineWidth);\n        // }\n        border = layout.getTableBottomBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth, tableWidget.y + tableWidget.height - lineWidth / 2, tableWidget.x + tableWidget.width + lineWidth + tableWidget.margin.right, tableWidget.y + tableWidget.height - lineWidth / 2, lineWidth);\n        // }\n    };\n    /**\n     * Renders table cell outline.\n     * @param {LayoutViewer} viewer\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderTableCellOutline = function (viewer, cellWidget) {\n        var layout = viewer.layout;\n        var borders = undefined;\n        var tableCell = cellWidget;\n        var cellTopMargin = 0;\n        var cellBottomMargin = 0;\n        var cellLeftMargin = 0;\n        var cellRightMargin = 0;\n        var height = 0;\n        borders = tableCell.cellFormat.borders;\n        if (cellWidget.containerWidget instanceof TableRowWidget) {\n            cellBottomMargin = cellWidget.margin.bottom - cellWidget.containerWidget.bottomBorderWidth;\n            cellTopMargin = cellWidget.margin.top - cellWidget.containerWidget.topBorderWidth;\n        }\n        cellLeftMargin = cellWidget.margin.left - cellWidget.leftBorderWidth;\n        cellRightMargin = cellWidget.margin.right - cellWidget.rightBorderWidth;\n        if (!isNullOrUndefined(tableCell.ownerRow) && tableCell.ownerRow.rowFormat.heightType === 'Exactly') {\n            height = HelperMethods.convertPointToPixel(tableCell.ownerRow.rowFormat.height) + cellTopMargin + cellBottomMargin;\n        }\n        else {\n            if (!isNullOrUndefined(tableCell.ownerRow) && [tableCell.ownerRow].length <= 1) {\n                // tslint:disable-next-line:max-line-length\n                height = Math.max(HelperMethods.convertPointToPixel(tableCell.ownerRow.rowFormat.height), cellWidget.height) + cellTopMargin + cellBottomMargin;\n            }\n            else {\n                height = cellWidget.height + cellTopMargin + cellBottomMargin;\n            }\n        }\n        this.renderCellBackground(height, cellWidget);\n        var border = TableCellWidget.getCellLeftBorder(tableCell);\n        var lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {       \n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth()); //Renders the cell left border.\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, cellWidget.x - cellLeftMargin - lineWidth, cellWidget.y - cellTopMargin, cellWidget.x - cellLeftMargin - lineWidth, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n        // }\n        border = TableCellWidget.getCellTopBorder(tableCell);\n        // if (!isNullOrUndefined(border )) { //Renders the cell top border.        \n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, cellWidget.x - cellWidget.margin.left, cellWidget.y - cellWidget.margin.top + lineWidth / 2, cellWidget.x + cellWidget.width + cellWidget.margin.right, cellWidget.y - cellWidget.margin.top + lineWidth / 2, lineWidth);\n        // }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0 || tableCell.cellIndex === tableCell.ownerRow.childWidgets.length - 1) {\n            border = TableCellWidget.getCellRightBorder(tableCell);\n            // if (!isNullOrUndefined(border )) { //Renders the cell right border.           \n            lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x + cellWidget.width + cellWidget.margin.right - lineWidth / 2, cellWidget.y - cellTopMargin, cellWidget.x + cellWidget.width + cellWidget.margin.right - lineWidth / 2, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n            // }\n        }\n        var nextRow = tableCell.ownerRow.nextWidget;\n        //Specifies the next row is within the current table widget.\n        //True means current row is not rendered at page end; Otherwise False.\n        var nextRowIsInCurrentTableWidget = false;\n        if (!isNullOrUndefined(nextRow)) {\n            var nextRowWidget = undefined;\n            // if (viewer.renderedElements.containsKey(nextRow) && viewer.renderedElements.get(nextRow).length > 0) {\n            nextRowWidget = nextRow;\n            // }\n            if (nextRowWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                if (cellWidget.containerWidget instanceof TableRowWidget && cellWidget.containerWidget.containerWidget instanceof TableWidget) {\n                    nextRowIsInCurrentTableWidget = cellWidget.containerWidget.containerWidget.childWidgets.indexOf(nextRowWidget) !== -1;\n                }\n            }\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0 || tableCell.ownerRow.rowIndex === tableCell.ownerTable.childWidgets.length - 1\n            || (tableCell.cellFormat.rowSpan > 1\n                && tableCell.ownerRow.rowIndex + tableCell.cellFormat.rowSpan === tableCell.ownerTable.childWidgets.length) ||\n            !nextRowIsInCurrentTableWidget) {\n            // tslint:disable-next-line:max-line-length\n            border = (tableCell.cellFormat.rowSpan > 1 && tableCell.ownerRow.rowIndex + tableCell.cellFormat.rowSpan === tableCell.ownerTable.childWidgets.length) ?\n                //true part for vertically merged cells specifically.\n                tableCell.getBorderBasedOnPriority(tableCell.cellFormat.borders.bottom, TableCellWidget.getCellBottomBorder(tableCell))\n                //false part for remaining cases that has been handled inside method. \n                : TableCellWidget.getCellBottomBorder(tableCell);\n            // if (!isNullOrUndefined(border )) {\n            //Renders the cell bottom border.\n            lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellWidget.margin.left, cellWidget.y + cellWidget.height + cellBottomMargin + lineWidth / 2, cellWidget.x + cellWidget.width + cellWidget.margin.right, cellWidget.y + cellWidget.height + cellBottomMargin + lineWidth / 2, lineWidth);\n            // }\n        }\n        border = layout.getCellDiagonalUpBorder(tableCell);\n        // if (!isNullOrUndefined(border )) {\n        //Renders the cell diagonal up border.\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        if (lineWidth > 0) {\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellLeftMargin, cellWidget.y + cellWidget.height + cellBottomMargin, cellWidget.x + cellWidget.width + cellRightMargin, cellWidget.y - cellTopMargin, lineWidth);\n            // }\n        }\n        border = layout.getCellDiagonalDownBorder(tableCell);\n        // if (!isNullOrUndefined(border )) {\n        //Renders the cell diagonal down border.\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        if (lineWidth > 0) {\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellLeftMargin, cellWidget.y - cellTopMargin, cellWidget.x + cellWidget.width + cellRightMargin, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n        }\n        // }\n    };\n    /**\n     * Renders cell background.\n     * @param {number} height\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderCellBackground = function (height, cellWidget) {\n        var cellFormat = cellWidget.cellFormat;\n        var bgColor = cellFormat.shading.backgroundColor === '#ffffff' ?\n            cellWidget.ownerTable.tableFormat.shading.backgroundColor : cellFormat.shading.backgroundColor;\n        this.pageContext.beginPath();\n        if (bgColor !== 'empty') {\n            this.pageContext.fillStyle = this.getColor(bgColor);\n            var left = cellWidget.x - cellWidget.margin.left + cellWidget.leftBorderWidth;\n            var top_1 = cellWidget.y - HelperMethods.convertPointToPixel(cellWidget.topMargin);\n            // tslint:disable-next-line:max-line-length\n            var width = cellWidget.width + cellWidget.margin.left + cellWidget.margin.right - cellWidget.leftBorderWidth - cellWidget.rightBorderWidth;\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left, 1), this.getScaledValue(top_1, 2), this.getScaledValue(width), this.getScaledValue(height));\n            this.pageContext.closePath();\n        }\n    };\n    /**\n     * Renders single border.\n     * @param {WBorder} border\n     * @param {number} startX\n     * @param {number} startY\n     * @param {number} endX\n     * @param {number} endY\n     * @param {number} lineWidth\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderSingleBorder = function (border, startX, startY, endX, endY, lineWidth) {\n        this.pageContext.beginPath();\n        this.pageContext.moveTo(this.getScaledValue(startX, 1), this.getScaledValue(startY, 2));\n        this.pageContext.lineTo(this.getScaledValue(endX, 1), this.getScaledValue(endY, 2));\n        this.pageContext.lineWidth = this.getScaledValue(lineWidth);\n        // set line color\n        this.pageContext.strokeStyle = border.color;\n        if (lineWidth > 0) {\n            this.pageContext.stroke();\n        }\n        this.pageContext.closePath();\n    };\n    /**\n     * Gets scaled value.\n     * @param {number} value\n     * @param {number} type\n     * @private\n     */\n    Renderer.prototype.getScaledValue = function (value, type) {\n        if (this.isPrinting) {\n            return value;\n        }\n        if (isNullOrUndefined(type)) {\n            type = 0;\n        }\n        var x = value * this.viewer.zoomFactor;\n        return x + (type === 1 ? this.pageLeft : (type === 2 ? this.pageTop : 0));\n    };\n    /**\n     * Destroys the internal objects which is maintained.\n     */\n    Renderer.prototype.destroy = function () {\n        this.viewer = undefined;\n        if (!isNullOrUndefined(this.pageCanvasIn)) {\n            this.pageCanvasIn.innerHTML = '';\n        }\n        this.pageCanvasIn = undefined;\n    };\n    return Renderer;\n}());\nexport { Renderer };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WCharacterFormat } from '../index';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar TextHelper = /** @class */ (function () {\n    function TextHelper(viewer) {\n        this.owner = viewer;\n        if (!isNullOrUndefined(viewer)) {\n            this.context = viewer.containerContext;\n        }\n    }\n    Object.defineProperty(TextHelper.prototype, \"paragraphMark\", {\n        get: function () {\n            return '¶';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextHelper.prototype, \"lineBreakMark\", {\n        get: function () {\n            return '↲';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TextHelper.prototype.getParagraphMarkWidth = function (characterFormat) {\n        return this.getWidth(this.paragraphMark, characterFormat);\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getParagraphMarkSize = function (characterFormat) {\n        // Gets the text element's width;\n        var width = this.getWidth(this.paragraphMark, characterFormat);\n        var height = 0;\n        var baselineOffset = 0;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        return {\n            'Width': width, 'Height': textHelper.Height, 'BaselineOffset': textHelper.BaselineOffset\n        };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getTextSize = function (elementBox, characterFormat) {\n        // Gets the text element's width;\n        var textTrimEndWidth = 0;\n        textTrimEndWidth = this.getWidth(elementBox.text, characterFormat);\n        elementBox.width = textTrimEndWidth;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        elementBox.height = textHelper.Height;\n        elementBox.baselineOffset = textHelper.BaselineOffset;\n        if (elementBox.text[elementBox.text.length - 1] === ' ') {\n            textTrimEndWidth = this.getWidth(HelperMethods.trimEnd(elementBox.text), characterFormat);\n        }\n        return textTrimEndWidth;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getHeight = function (characterFormat) {\n        // Get character format property as  below predefined structure to make it easy to check and retrieve\n        // Predefined static structure `[FontName];[FontSize];bold;italic` to maintain as key in the collection \n        var key = this.getFormatText(characterFormat);\n        if (!isNullOrUndefined(this.owner.heightInfoCollection[key])) {\n            return this.owner.heightInfoCollection[key];\n        }\n        var sizeInfo = this.getHeightInternal(characterFormat);\n        this.owner.heightInfoCollection[key] = sizeInfo;\n        return sizeInfo;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getFormatText = function (characterFormat) {\n        var formatText = characterFormat.fontFamily.toLocaleLowerCase();\n        formatText += ';' + characterFormat.fontSize;\n        if (characterFormat.bold) {\n            formatText += ';' + 'bold';\n        }\n        if (characterFormat.italic) {\n            formatText += ';' + 'italic';\n        }\n        return formatText;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getHeightInternal = function (characterFormat) {\n        var textHeight = 0;\n        var baselineOffset = 0;\n        var spanElement = document.createElement('span');\n        spanElement.id = 'tempSpan';\n        spanElement.style.whiteSpace = 'nowrap';\n        spanElement.innerText = 'm';\n        this.applyStyle(spanElement, characterFormat);\n        var body = document.getElementsByTagName('body');\n        var parentDiv = document.createElement('div');\n        parentDiv.style.display = 'inline-block';\n        var tempDiv = document.createElement('div');\n        tempDiv.setAttribute('style', 'display:inline-block;width: 1px; height: 0px;vertical-align: baseline;');\n        parentDiv.appendChild(spanElement);\n        parentDiv.appendChild(tempDiv);\n        document.body.appendChild(parentDiv);\n        // Sets the text element's height.\n        textHeight = spanElement.offsetHeight;\n        // Calculate the text element's baseline offset.\n        var textTopVal = spanElement.offsetTop;\n        var tempDivTopVal = tempDiv.offsetTop;\n        baselineOffset = tempDivTopVal - textTopVal;\n        document.body.removeChild(parentDiv);\n        return { 'Height': textHeight, 'BaselineOffset': baselineOffset };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.measureTextExcludingSpaceAtEnd = function (text, characterFormat) {\n        return this.getWidth(HelperMethods.trimEnd(text), characterFormat);\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getWidth = function (text, characterFormat) {\n        if (text.match('\\v')) {\n            text.replace('\\v', this.lineBreakMark);\n        }\n        var bold = '';\n        var italic = '';\n        var fontFamily = '';\n        var fontSize = characterFormat.fontSize;\n        bold = characterFormat.bold ? 'bold' : '';\n        italic = characterFormat.italic ? 'italic' : '';\n        fontFamily = characterFormat.fontFamily;\n        fontSize = fontSize === 0 ? 0.5 : fontSize / (characterFormat.baselineAlignment === 'Normal' ? 1 : 1.5);\n        this.context.font = bold + ' ' + italic + ' ' + fontSize + 'pt' + ' ' + fontFamily;\n        return this.context.measureText(text).width;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.applyStyle = function (spanElement, characterFormat) {\n        if (!isNullOrUndefined(spanElement) && !isNullOrUndefined(characterFormat)) {\n            if (characterFormat.fontFamily !== '') {\n                spanElement.style.fontFamily = characterFormat.fontFamily;\n            }\n            var fontSize = characterFormat.fontSize;\n            if (fontSize <= 0.5) {\n                fontSize = 0.5;\n            }\n            spanElement.style.fontSize = fontSize.toString() + 'pt';\n            if (characterFormat.bold) {\n                spanElement.style.fontWeight = 'bold';\n            }\n            if (characterFormat.italic) {\n                spanElement.style.fontStyle = 'italic';\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.measureText = function (text, characterFormat) {\n        // Gets the text element's width;\n        var width = this.getWidth(text, characterFormat);\n        var height = 0;\n        var baselineOffset = 0;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        return {\n            'Width': width, 'Height': textHelper.Height, 'BaselineOffset': textHelper.BaselineOffset\n        };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.updateTextSize = function (elementBox, paragraph) {\n        var format = new WCharacterFormat(undefined);\n        var listCharacterFormat = elementBox.listLevel.characterFormat;\n        var breakCharacterFormat = paragraph.characterFormat;\n        format.fontSize = listCharacterFormat.fontSize === 11 ? breakCharacterFormat.fontSize : listCharacterFormat.fontSize;\n        format.fontFamily = listCharacterFormat.fontFamily === 'Verdana' ? breakCharacterFormat.fontFamily\n            : listCharacterFormat.fontFamily;\n        var bold = '';\n        var italic = '';\n        var baselineAlignment = listCharacterFormat.baselineAlignment === 'Normal' ?\n            breakCharacterFormat.baselineAlignment : listCharacterFormat.baselineAlignment;\n        bold = listCharacterFormat.bold ? 'bold' : breakCharacterFormat.bold ? 'bold' : '';\n        italic = listCharacterFormat.italic ? 'italic' : breakCharacterFormat.italic ? 'italic' : '';\n        format.baselineAlignment = baselineAlignment;\n        if (bold) {\n            format.bold = true;\n        }\n        if (italic) {\n            format.italic = true;\n        }\n        elementBox.width = this.getWidth(elementBox.text, format);\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(format);\n        elementBox.height = textHelper.Height;\n        elementBox.baselineOffset = textHelper.BaselineOffset;\n    };\n    TextHelper.prototype.destroy = function () {\n        this.owner = undefined;\n        this.context = undefined;\n    };\n    return TextHelper;\n}());\nexport { TextHelper };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Zoom = /** @class */ (function () {\n    function Zoom(viewer) {\n        var _this = this;\n        this.onMouseWheelInternal = function (event) {\n            if (event.ctrlKey === true) {\n                event.preventDefault();\n                var pageX = event.pageX - _this.viewer.viewerContainer.offsetLeft;\n                if (pageX < _this.viewer.pageContainer.offsetWidth) {\n                    var wheel = navigator.userAgent.match('Firefox') ? event.detail < 0 : event.wheelDelta > 0;\n                    var zoomFactor = _this.viewer.zoomFactor;\n                    if (wheel) {\n                        if (zoomFactor <= 4.90) {\n                            zoomFactor += .10;\n                        }\n                        else {\n                            zoomFactor = 5.00;\n                        }\n                    }\n                    else {\n                        if (zoomFactor >= .20) {\n                            zoomFactor -= .10;\n                        }\n                        else {\n                            zoomFactor = 0.10;\n                        }\n                    }\n                    _this.viewer.zoomFactor = zoomFactor;\n                }\n            }\n        };\n        this.viewer = viewer;\n    }\n    Zoom.prototype.setZoomFactor = function (value) {\n        this.onZoomFactorChanged();\n        if (!isNullOrUndefined(this.viewer.selection)) {\n            this.viewer.selection.updateCaretPosition();\n        }\n        this.viewer.updateTouchMarkPosition();\n        if (!isNullOrUndefined(this.viewer.owner.imageResizerModule)) {\n            this.viewer.owner.imageResizerModule.updateImageResizerPosition();\n        }\n        this.viewer.owner.fireZoomFactorChange();\n    };\n    //Zoom Implementation Starts\n    Zoom.prototype.onZoomFactorChanged = function () {\n        if (this.viewer.zoomFactor > 5) {\n            this.viewer.zoomFactor = 5;\n        }\n        else if (this.viewer.zoomFactor < 0.1) {\n            this.viewer.zoomFactor = 0.1;\n        }\n        this.zoom();\n    };\n    Zoom.prototype.zoom = function () {\n        var viewer = this.viewer;\n        viewer.clearContent();\n        viewer.handleZoom();\n        viewer.updateFocus();\n    };\n    return Zoom;\n}());\nexport { Zoom };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Dictionary } from '../../base/dictionary';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { WCharacterFormat, WParagraphFormat, WStyles } from '../format/index';\nimport { Layout } from './layout';\nimport { Renderer } from './render';\nimport { createElement, Browser } from '@syncfusion/ej2-base';\nimport { Page, Rect, ListTextElementBox, ParagraphWidget, HeaderFooterWidget } from './page';\nimport { LineWidget, TableWidget } from './page';\nimport { HelperMethods, Point } from '../editor/editor-helper';\nimport { TextHelper } from './text-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Zoom } from './zooming';\nimport { Dialog } from '@syncfusion/ej2-popups';\n/**\n * @private\n */\nvar LayoutViewer = /** @class */ (function () {\n    //#endregion\n    function LayoutViewer(owner) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.textWrap = true;\n        /**\n         * @private\n         */\n        this.currentPage = undefined;\n        this.selectionStartPageIn = undefined;\n        this.selectionEndPageIn = undefined;\n        /**\n         * @private\n         */\n        this.fieldStacks = [];\n        /**\n         * @private\n         */\n        this.splittedCellWidgets = [];\n        /**\n         * @private\n         */\n        this.tableLefts = [];\n        this.tapCount = 0;\n        this.timer = -1;\n        this.isTimerStarted = false;\n        /**\n         * @private\n         */\n        this.isFirstLineFitInShiftWidgets = false;\n        /**\n         * @private\n         */\n        this.preZoomFactor = 0;\n        /**\n         * @private\n         */\n        this.preDifference = -1;\n        /**\n         * @private\n         */\n        this.fieldEndParagraph = undefined;\n        /**\n         * @private\n         */\n        this.fieldToLayout = undefined;\n        /**\n         * @private\n         */\n        this.backgroundColor = '#FFFFFF';\n        /**\n         * @private\n         */\n        this.containerTop = 0;\n        /**\n         * @private\n         */\n        this.containerLeft = 0;\n        // Event \n        /**\n         * @private\n         */\n        this.isMouseDown = false;\n        /**\n         * @private\n         */\n        this.isSelectionChangedOnMouseMoved = false;\n        /**\n         * @private\n         */\n        this.isControlPressed = false;\n        /**\n         * @private\n         */\n        this.isTouchInput = false;\n        /**\n         * @private\n         */\n        this.useTouchSelectionMark = false;\n        /**\n         * @private\n         */\n        this.touchDownOnSelectionMark = 0;\n        /**\n         * @private\n         */\n        this.isComposingIME = false;\n        /**\n         * @private\n         */\n        this.lastComposedText = '';\n        /**\n         * @private\n         */\n        this.isCompositionStart = false;\n        /**\n         * @private\n         */\n        this.isCompositionUpdated = false;\n        /**\n         * @private\n         */\n        this.isCompositionCanceled = false;\n        /**\n         * @private\n         */\n        this.isCompositionEnd = false;\n        /**\n         * @private\n         */\n        this.prefix = '';\n        /**\n         * @private\n         */\n        this.suffix = '';\n        /**\n         * @private\n         */\n        this.fields = [];\n        /**\n         * @private\n         */\n        this.heightInfoCollection = {};\n        /**\n         * @private\n         */\n        this.defaultTabWidth = 36;\n        /**\n         * @private\n         */\n        this.lists = [];\n        /**\n         * @private\n         */\n        this.abstractLists = [];\n        /**\n         * @private\n         */\n        this.styles = new WStyles();\n        /**\n         * @private\n         */\n        this.preDefinedStyles = undefined;\n        /**\n         * @private\n         */\n        this.isRowOrCellResizing = false;\n        this.isMouseDownInFooterRegion = false;\n        this.pageFitTypeIn = 'None';\n        /**\n         * @private\n         */\n        this.fieldCollection = [];\n        /**\n         * @private\n         */\n        this.isPageField = false;\n        /**\n         * @private\n         */\n        this.mouseDownOffset = new Point(0, 0);\n        this.zoomFactorInternal = 1;\n        /**\n         * @private\n         */\n        this.onTextInput = function (event) {\n            if (!_this.isComposingIME) {\n                event.preventDefault();\n                var text = event.data;\n                _this.owner.editor.handleTextInput(text);\n            }\n        };\n        //#region Composition Event\n        /**\n         * Fires when composition starts.\n         * @private\n         */\n        this.compositionStart = function (event) {\n            if (!Browser.isDevice && !_this.owner.isReadOnlyMode) {\n                _this.isComposingIME = true;\n                _this.positionEditableTarget();\n                if (_this.owner.editorHistory) {\n                    _this.owner.editor.initComplexHistory('IMEInput');\n                }\n            }\n            _this.isCompositionStart = true;\n        };\n        /**\n         * Fires on every input during composition.\n         * @private\n         */\n        this.compositionUpdated = function (event) {\n            if (_this.isComposingIME && !_this.owner.isReadOnlyMode) {\n                /* tslint:disable:align */\n                setTimeout(function () {\n                    _this.owner.editor.insertIMEText(_this.getEditableDivTextContent(), true);\n                }, 0);\n            }\n            _this.isCompositionUpdated = true;\n        };\n        /**\n         * Fires when user selects a character/word and finalizes the input.\n         * @private\n         */\n        this.compositionEnd = function (event) {\n            if (_this.isComposingIME && !_this.owner.isReadOnlyMode) {\n                var text = _this.getEditableDivTextContent();\n                if (text !== '') {\n                    _this.owner.editor.insertIMEText(text, false);\n                }\n                _this.isComposingIME = false;\n                _this.lastComposedText = '';\n                _this.iframe.setAttribute('style', 'pointer-events:none;position:absolute;top:-10000px');\n                _this.editableDiv.innerHTML = '';\n                if (_this.owner.editorHistory) {\n                    _this.owner.editorHistory.updateComplexHistory();\n                    if (text === '') {\n                        // tslint:disable-next-line:max-line-length\n                        //When the composition in live. The Undo operation will terminate the composition and empty text will be return from text box.\n                        //At that time the the history should be updated. Undo the operation and clear the redo stack. This undo operation will not be saved for redo operation.\n                        _this.owner.editorHistory.undo();\n                        _this.owner.editorHistory.redoStack.pop();\n                    }\n                }\n            }\n            event.preventDefault();\n            _this.isCompositionUpdated = false;\n            _this.isCompositionEnd = true;\n        };\n        // tslint:disable:no-any \n        this.onImageResizer = function (args) {\n            if (!isNullOrUndefined(_this.owner.imageResizerModule) && _this.owner.imageResizerModule.isImageResizerVisible\n                && _this.owner.imageResizerModule.isImageResizing) {\n                if (args instanceof MouseEvent) {\n                    _this.onMouseUpInternal(args);\n                }\n                else if (args instanceof TouchEvent) {\n                    _this.onTouchUpInternal(args);\n                }\n            }\n        };\n        // tslint:enable:no-any \n        this.onKeyPressInternal = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                var key = event.keyCode || event.charCode;\n                var char = '';\n                if (key) {\n                    char = String.fromCharCode(key);\n                }\n                else if (event.key) {\n                    char = event.key;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (char !== 'Spacebar' && char !== '\\r' && char !== '\\b' && char !== '\\u001B' && !_this.owner.isReadOnlyMode && event.ctrlKey === false) {\n                    _this.owner.editorModule.handleTextInput(char);\n                }\n                else if (char === 'Spacebar') {\n                    _this.owner.editorModule.handleTextInput(' ');\n                }\n                event.preventDefault();\n            }\n        };\n        this.onTextInputInternal = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.owner.editorModule.onTextInputInternal(event);\n            }\n            else {\n                _this.editableDiv.innerText = '';\n            }\n        };\n        /**\n         * Fired on paste.\n         * @param {ClipboardEvent} event\n         * @private\n         */\n        this.onPaste = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.owner.editorModule.pasteInternal(event);\n            }\n            _this.editableDiv.innerText = '';\n            event.preventDefault();\n        };\n        /**\n         * Fires when editable div loses focus.\n         * @private\n         */\n        this.onFocusOut = function () {\n            if (!isNullOrUndefined(_this.selection)) {\n                if (_this.owner.contextMenuModule && _this.owner.contextMenuModule.contextMenuInstance &&\n                    _this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n                    return;\n                }\n                _this.selection.hideCaret();\n            }\n        };\n        /**\n         * Updates focus to editor area.\n         * @private\n         */\n        this.updateFocus = function () {\n            if (_this.selection) {\n                _this.editableDiv.focus();\n                _this.selection.showCaret();\n            }\n        };\n        /**\n         * Fires on scrolling.\n         */\n        this.scrollHandler = function () {\n            _this.clearContent();\n            _this.updateScrollBars();\n            var vtHeight = _this.containerTop + _this.visibleBounds.height;\n            if (vtHeight > _this.pageContainer.offsetHeight) {\n                _this.viewerContainer.scrollTop = _this.containerTop - (vtHeight - _this.pageContainer.offsetHeight);\n            }\n            var viewer = _this;\n            if (viewer instanceof PageLayoutViewer && !isNullOrUndefined(_this.owner)) {\n                _this.owner.fireViewChange();\n            }\n        };\n        /**\n         * Fires when the window gets resized.\n         * @private\n         */\n        this.onWindowResize = function () {\n            var viewer = _this;\n            var resizeTimer;\n            /* tslint:disable:align */\n            resizeTimer = setTimeout(function () {\n                if (!isNullOrUndefined(viewer.owner) && !isNullOrUndefined(_this.owner.element)) {\n                    viewer.updateViewerSizeInternal(document.getElementById(viewer.owner.element.id));\n                    viewer.updateScrollBars();\n                    if (!isNullOrUndefined(_this.selection)) {\n                        _this.selection.updateCaretPosition();\n                    }\n                    viewer.updateTouchMarkPosition();\n                    if (viewer.owner.contextMenuModule && viewer.owner.contextMenuModule.contextMenuInstance) {\n                        viewer.owner.contextMenuModule.contextMenuInstance.close();\n                    }\n                    if (resizeTimer) {\n                        clearTimeout(resizeTimer);\n                    }\n                }\n            }, 100);\n        };\n        /**\n         * @private\n         */\n        this.onContextMenu = function (event) {\n            if (_this.owner.contextMenuModule) {\n                _this.owner.contextMenuModule.onContextMenuInternal(event);\n            }\n        };\n        /**\n         * Called on mouse down.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseDownInternal = function (event) {\n            if (_this.isTouchInput || event.offsetX > (_this.visibleBounds.width - (_this.visibleBounds.width - _this.viewerContainer.clientWidth))\n                || event.offsetY > (_this.visibleBounds.height - (_this.visibleBounds.height - _this.viewerContainer.clientHeight))) {\n                return;\n            }\n            if (!isNullOrUndefined(_this.selection)) {\n                _this.updateCursor(event);\n                // tslint:disable-next-line:max-line-length\n                if (_this.isLeftButtonPressed(event) && !_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n                    _this.owner.imageResizerModule.isImageResizing = true;\n                }\n                event.preventDefault();\n                if (!_this.isTouchInput) {\n                    _this.selection.hideCaret();\n                }\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.findFocusedPage(cursorPoint, true);\n                _this.mouseDownOffset.x = touchPoint.x;\n                _this.mouseDownOffset.y = touchPoint.y;\n                // tslint:disable-next-line:max-line-length\n                _this.isMouseDownInFooterRegion = _this.selection.isCursorInsidePageRect(cursorPoint, _this.currentPage) && _this.selection.isCursorInFooterRegion(cursorPoint, _this.currentPage);\n                _this.isSelectionChangedOnMouseMoved = false;\n                if (!_this.owner.isReadOnlyMode && (_this.owner.editorModule.tableResize.isInCellResizerArea(touchPoint) ||\n                    _this.owner.editorModule.tableResize.isInRowResizerArea(touchPoint))) {\n                    _this.selection.hideCaret();\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    if (_this.isLeftButtonPressed(event)) {\n                        _this.owner.editorModule.tableResize.startingPoint.x = touchPoint.x;\n                        _this.owner.editorModule.tableResize.startingPoint.y = touchPoint.y;\n                        _this.owner.editorModule.tableResize.handleResize(touchPoint);\n                    }\n                    return;\n                }\n                if (event.ctrlKey) {\n                    _this.isControlPressed = true;\n                }\n                if (_this.owner.selection.isEmpty) {\n                    _this.useTouchSelectionMark = false;\n                }\n                if (event.which === 3 && !_this.owner.selection.isEmpty\n                    && _this.selection.checkCursorIsInSelection(_this.getLineWidget(touchPoint), touchPoint)) {\n                    event.preventDefault();\n                    return;\n                }\n                _this.isTouchInput = false;\n                _this.isMouseDown = true;\n                _this.updateFocus();\n                /* tslint:disable:align */\n                _this.timer = setTimeout(function () {\n                    _this.tapCount++;\n                    if (_this.tapCount === 4) {\n                        _this.tapCount = 1;\n                    }\n                }, 200);\n            }\n        };\n        /**\n         * Called on mouse move.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseMoveInternal = function (event) {\n            event.preventDefault();\n            if (!isNullOrUndefined(_this.selection)) {\n                //For image Resizing\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode\n                    && _this.owner.imageResizerModule.isImageResizing) {\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnMouse(event);\n                    }\n                    return;\n                }\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n                if (_this.isMouseDown) {\n                    if (!isNullOrUndefined(_this.currentPage)) {\n                        var xPosition = touchPoint.x;\n                        var yPosition = touchPoint.y;\n                        if (!_this.owner.isReadOnlyMode && _this.isRowOrCellResizing) {\n                            _this.owner.editorModule.tableResize.handleResizing(touchPoint);\n                        }\n                        else {\n                            if (!(_this.isTouchInput || _this.isSelectionChangedOnMouseMoved || _this.touchDownOnSelectionMark > 0)) {\n                                _this.updateTextPositionForSelection(touchPoint, 1);\n                            }\n                            if (_this.isLeftButtonPressed(event)) {\n                                event.preventDefault();\n                                var touchY = yPosition;\n                                var textPosition = _this.owner.selection.end;\n                                var touchPoint_1 = new Point(xPosition, touchY);\n                                if (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizerVisible) {\n                                    _this.owner.selection.moveTextPosition(touchPoint_1, textPosition);\n                                }\n                                _this.isSelectionChangedOnMouseMoved = true;\n                            }\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n                if (!_this.isRowOrCellResizing && !_this.isSelectionChangedOnMouseMoved) {\n                    _this.updateCursor(event);\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.selection.hideCaret();\n                }\n            }\n        };\n        /**\n         * Fired on double tap.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onDoubleTap = function (event) {\n            if (!isNullOrUndefined(_this.selection)) {\n                _this.isTouchInput = false;\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                if (_this.selection.checkAndEnableHeaderFooter(cursorPoint, _this.findFocusedPage(cursorPoint, true))) {\n                    return;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.selection.isEmpty && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)) {\n                    _this.owner.selection.selectCurrentWord();\n                    _this.selection.checkForCursorVisibility();\n                    _this.tapCount = 2;\n                }\n            }\n        };\n        /**\n         * Called on mouse up.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseUpInternal = function (event) {\n            event.preventDefault();\n            _this.isListTextSelected = false;\n            var cursorPoint = new Point(event.offsetX, event.offsetY);\n            var touchPoint = _this.findFocusedPage(cursorPoint, true);\n            if (!isNullOrUndefined(_this.selection)) {\n                var tapCount = 1;\n                if (!Browser.isIE) {\n                    if (event.detail > 2) {\n                        tapCount = event.detail;\n                    }\n                }\n                else {\n                    tapCount = _this.tapCount;\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.owner.editorModule.tableResize.updateResizingHistory(touchPoint);\n                }\n                if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved\n                    && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)\n                    && (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizing)) {\n                    if (_this.touchDownOnSelectionMark === 0 && !_this.isRowOrCellResizing) {\n                        _this.updateTextPositionForSelection(touchPoint, tapCount);\n                        if (Browser.isIE && tapCount === 2) {\n                            _this.selection.checkAndEnableHeaderFooter(cursorPoint, touchPoint);\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n                if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)\n                    && (_this.owner.selection.isEmpty || _this.owner.selection.isImageSelected) &&\n                    (((event.ctrlKey && _this.owner.useCtrlClickToFollowHyperlink ||\n                        !_this.owner.useCtrlClickToFollowHyperlink) && _this.isLeftButtonPressed(event) === true))) {\n                    _this.selection.navigateHyperLinkOnEvent(touchPoint, false);\n                }\n                if (!_this.owner.isReadOnlyMode && _this.isSelectionInListText(touchPoint)) {\n                    _this.selection.selectListText();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.scrollToPosition(_this.owner.selection.start, _this.owner.selection.end);\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                    _this.owner.imageResizerModule.updateHistoryForImageResizer();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && !isNullOrUndefined(_this.selection.caret)) {\n                    _this.selection.caret.style.display = 'none';\n                }\n                _this.isMouseDown = false;\n                _this.isSelectionChangedOnMouseMoved = false;\n                _this.isTouchInput = false;\n                _this.useTouchSelectionMark = true;\n                _this.isControlPressed = false;\n                _this.updateFocus();\n                if (_this.isListTextSelected) {\n                    _this.selection.hideCaret();\n                }\n                if (_this.owner.enableImageResizerMode) {\n                    var imageResizer = _this.owner.imageResizerModule;\n                    imageResizer.isImageResizing = false;\n                    imageResizer.isImageMoveToNextPage = false;\n                    imageResizer.leftValue = undefined;\n                    imageResizer.topValue = undefined;\n                }\n                _this.isMouseDownInFooterRegion = false;\n            }\n        };\n        /**\n         * Fired on touch start.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchStartInternal = function (event) {\n            if (_this.selection) {\n                _this.isCompositionStart = false;\n                _this.isCompositionEnd = false;\n                _this.isCompositionUpdated = false;\n                _this.isCompositionCanceled = true;\n                _this.isTouchInput = true;\n                if (_this.isTimerStarted) {\n                    if (_this.tapCount === 1) {\n                        _this.tapCount = 2;\n                    }\n                    else {\n                        _this.tapCount = 3;\n                        _this.isTimerStarted = false;\n                    }\n                }\n                else {\n                    _this.isTimerStarted = true;\n                    _this.tapCount = 1;\n                }\n                if (event.touches.length === 1) {\n                    _this.zoomX = event.touches[0].clientX;\n                    _this.zoomY = event.touches[0].clientY;\n                    if (_this.owner.selection.isEmpty) {\n                        _this.useTouchSelectionMark = false;\n                    }\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    var point = void 0;\n                    if (_this.isMouseDown) {\n                        point = _this.getTouchOffsetValue(event);\n                    }\n                    point = _this.findFocusedPage(point, true);\n                    if (_this.owner.enableImageResizerMode) {\n                        var resizeObj = _this.owner.imageResizerModule.getImagePointOnTouch(point);\n                        _this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n                    }\n                    // tslint:disable-next-line:max-line-length\n                    if (_this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n                        _this.owner.imageResizerModule.isImageResizing = true;\n                    }\n                    var x = _this.owner.selection.end.location.x;\n                    var y = _this.selection.getCaretBottom(_this.owner.selection.end, _this.owner.selection.isEmpty) + 9;\n                    //TouchDownOnSelectionMark will be 2 when touch end is pressed\n                    _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                        && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 1 : 0;\n                    if (!_this.owner.selection.isEmpty && _this.touchDownOnSelectionMark === 0) {\n                        x = _this.owner.selection.start.location.x;\n                        y = _this.selection.getCaretBottom(_this.owner.selection.start, false) + 9;\n                        //TouchDownOnSelectionMark will be 1 when touch start is pressed\n                        _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                            && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 2 : 0;\n                    }\n                }\n                if (!isNullOrUndefined(_this.owner.contextMenuModule) && _this.owner.contextMenuModule.contextMenuInstance) {\n                    _this.owner.contextMenuModule.contextMenuInstance.close();\n                }\n                if (_this.touchDownOnSelectionMark || event.touches.length > 1) {\n                    event.preventDefault();\n                }\n                _this.timer = setTimeout(function () {\n                    _this.isTimerStarted = false;\n                }, 200);\n            }\n        };\n        /**\n         * Fired on touch move.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchMoveInternal = function (event) {\n            var touch = event.touches;\n            var cursorPoint;\n            if (!isNullOrUndefined(_this.selection)) {\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.editorModule && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    event.preventDefault();\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnTouch(event);\n                        _this.selection.caret.style.display = 'none';\n                    }\n                    return;\n                }\n                if (_this.isMouseDown) {\n                    cursorPoint = _this.getTouchOffsetValue(event);\n                    var touchPoint = _this.findFocusedPage(cursorPoint, true);\n                    if (_this.touchDownOnSelectionMark > 0 /*|| !this.useTouchSelectionMark*/) {\n                        event.preventDefault();\n                        var touchY = touchPoint.y;\n                        var textPosition = _this.owner.selection.end;\n                        var touchPointer = void 0;\n                        if (touchPoint.y <= 26) {\n                            touchY -= touchPoint.y < 0 ? 0 : touchPoint.y + 0.5;\n                        }\n                        else {\n                            touchY -= 36.5;\n                        }\n                        textPosition = _this.touchDownOnSelectionMark === 2 ? _this.selection.start : _this.selection.end;\n                        touchPoint = new Point(touchPoint.x, touchY);\n                        _this.owner.selection.moveTextPosition(touchPoint, textPosition);\n                        _this.isSelectionChangedOnMouseMoved = true;\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n            }\n            if (touch.length > 1) {\n                event.preventDefault();\n                _this.isMouseDown = false;\n                _this.zoomX = (touch[0].clientX + touch[1].clientX) / 2;\n                _this.zoomY = (touch[0].clientY + touch[1].clientY) / 2;\n                // tslint:disable-next-line:max-line-length\n                var currentDiff = Math.sqrt(Math.pow((touch[0].clientX - touch[1].clientX), 2) + Math.pow((touch[0].clientY - touch[1].clientY), 2));\n                if (_this.preDifference > -1) {\n                    if (currentDiff > _this.preDifference) {\n                        _this.onPinchOutInternal(event);\n                    }\n                    else if (currentDiff < _this.preDifference) {\n                        _this.onPinchInInternal(event);\n                    }\n                }\n                else if (_this.zoomFactor < 2) {\n                    if (_this.preDifference !== -1) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                else if (_this.preDifference === -1) {\n                    if (_this.zoomFactor > 2) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                _this.preDifference = currentDiff;\n            }\n        };\n        /**\n         * Fired on touch up.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchUpInternal = function (event) {\n            if (!isNullOrUndefined(_this.selection)) {\n                var point = _this.getTouchOffsetValue(event);\n                var touchPoint = _this.findFocusedPage(point, true);\n                if (event.changedTouches.length === 1) {\n                    _this.zoomX = undefined;\n                    _this.zoomY = undefined;\n                    // tslint:disable-next-line:max-line-length\n                    if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)) {\n                        if (_this.touchDownOnSelectionMark === 0) {\n                            _this.updateTextPositionForSelection(new Point(touchPoint.x, touchPoint.y), _this.tapCount);\n                            if (_this.tapCount === 2) {\n                                _this.selection.checkAndEnableHeaderFooter(point, touchPoint);\n                            }\n                        }\n                        if (_this.owner.selection.isEmpty) {\n                            _this.selection.updateCaretPosition();\n                        }\n                        _this.selection.checkForCursorVisibility();\n                    }\n                    if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.selection.start)\n                        && !_this.isSelectionChangedOnMouseMoved && (_this.selection.isEmpty ||\n                        _this.selection.isImageField() && (!_this.owner.enableImageResizerMode ||\n                            _this.owner.enableImageResizerMode && !_this.owner.imageResizerModule.isImageResizing))) {\n                        _this.selection.navigateHyperLinkOnEvent(touchPoint, true);\n                    }\n                    _this.isMouseDown = false;\n                    _this.touchDownOnSelectionMark = 0;\n                    _this.useTouchSelectionMark = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                }\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                    _this.owner.imageResizerModule.isImageMoveToNextPage = false;\n                    _this.scrollToPosition(_this.owner.selection.start, _this.owner.selection.end);\n                    _this.owner.imageResizerModule.updateHistoryForImageResizer();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && _this.isTouchInput) {\n                    _this.touchStart.style.display = 'none';\n                    _this.touchEnd.style.display = 'none';\n                }\n                // if (!this.owner.isReadOnlyMode && this.isSelectionInListText(touchPoint)) {\n                //     this.selection.selectListText();\n                // }\n                event.preventDefault();\n            }\n            _this.preDifference = -1;\n            _this.isTouchInput = false;\n            if (!_this.isTimerStarted) {\n                _this.tapCount = 1;\n            }\n            if (_this.isListTextSelected) {\n                _this.selection.hideCaret();\n            }\n        };\n        /**\n         * Fired on keyup event.\n         * @private\n         */\n        this.onKeyUpInternal = function (event) {\n            if (Browser.isDevice) {\n                if (window.getSelection().anchorOffset !== _this.prefix.length) {\n                    _this.selection.setEditableDivCaretPosition(_this.editableDiv.innerText.length);\n                }\n            }\n            if (event.ctrlKey || (event.keyCode === 17 || event.which === 17)) {\n                _this.isControlPressed = false;\n            }\n        };\n        /**\n         * Fired on keydown.\n         * @private\n         */\n        this.onKeyDownInternal = function (event) {\n            var isHandled = false;\n            var keyEventArgs = { 'event': event, 'isHandled': false, source: _this.owner };\n            _this.owner.trigger('keyDown', keyEventArgs);\n            if (keyEventArgs.isHandled) {\n                return;\n            }\n            var key = event.which || event.keyCode;\n            var ctrl = (event.ctrlKey || event.metaKey) ? true : ((key === 17) ? true : false); // ctrl detection       \n            var shift = event.shiftKey ? event.shiftKey : ((key === 16) ? true : false); // Shift Key detection        \n            var alt = event.altKey ? event.altKey : ((key === 18) ? true : false); // alt key detection\n            if (ctrl && !shift && !alt) {\n                switch (key) {\n                    case 80:\n                        event.preventDefault();\n                        _this.owner.print();\n                        isHandled = true;\n                        break;\n                    case 83:\n                        event.preventDefault();\n                        _this.owner.save(_this.owner.documentName === '' ? 'sample' : _this.owner.documentName, 'Sfdt');\n                        isHandled = true;\n                        break;\n                }\n            }\n            if (!isHandled && !isNullOrUndefined(_this.selection)) {\n                _this.selection.onKeyDownInternal(event, ctrl, shift, alt);\n            }\n            if (isHandled) {\n                event.preventDefault();\n            }\n        };\n        this.owner = owner;\n        this.pages = [];\n        this.render = new Renderer(this);\n        this.lists = [];\n        this.abstractLists = [];\n        this.characterFormat = new WCharacterFormat(this);\n        this.paragraphFormat = new WParagraphFormat(this);\n        this.renderedLists = new Dictionary();\n        this.headersFooters = [];\n        this.styles = new WStyles();\n        this.preDefinedStyles = new Dictionary();\n        this.initalizeStyles();\n        this.bookmarks = new Dictionary();\n    }\n    Object.defineProperty(LayoutViewer.prototype, \"containerCanvas\", {\n        //#region Properties\n        /**\n         * Gets container canvas.\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.containerCanvasIn)) {\n                this.containerCanvasIn = document.createElement('canvas');\n                this.containerCanvasIn.getContext('2d').save();\n            }\n            if (!isNullOrUndefined(this.pageContainer)\n                && this.containerCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.containerCanvasIn);\n            }\n            return this.containerCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionCanvas\", {\n        /**\n         * Gets selection canvas.\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.selectionCanvasIn)) {\n                this.selectionCanvasIn = document.createElement('canvas');\n                this.selectionCanvas.getContext('2d').save();\n            }\n            if (!isNullOrUndefined(this.pageContainer)\n                && this.selectionCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.selectionCanvasIn);\n            }\n            return this.selectionCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"containerContext\", {\n        /**\n         * Gets container context.\n         * @private\n         */\n        get: function () {\n            return this.containerCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionContext\", {\n        /**\n         * Gets selection context.\n         * @private\n         */\n        get: function () {\n            return this.selectionCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"currentRenderingPage\", {\n        /**\n         * Gets the current rendering page.\n         */\n        get: function () {\n            if (this.pages.length === 0) {\n                return undefined;\n            }\n            return this.pages[this.pages.length - 1];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"visibleBounds\", {\n        /**\n         * Gets visible bounds.\n         * @private\n         */\n        get: function () {\n            return this.visibleBoundsIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"zoomFactor\", {\n        /**\n         * Gets or sets zoom factor.\n         * @private\n         */\n        get: function () {\n            return this.zoomFactorInternal;\n        },\n        set: function (value) {\n            if (this.zoomFactorInternal !== value) {\n                this.preZoomFactor = this.zoomFactor;\n                this.zoomFactorInternal = value;\n                this.zoomModule.setZoomFactor(value);\n                this.owner.zoomFactor = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selection\", {\n        /**\n         * Gets the selection.\n         * @private\n         */\n        get: function () {\n            return this.owner.selection;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionStartPage\", {\n        /**\n         * Gets or sets selection start page.\n         * @private\n         */\n        get: function () {\n            return this.selectionStartPageIn;\n        },\n        set: function (value) {\n            this.selectionStartPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionEndPage\", {\n        /**\n         * Gets or sets selection end page.\n         * @private\n         */\n        get: function () {\n            return this.selectionEndPageIn;\n        },\n        set: function (value) {\n            this.selectionEndPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"dialog\", {\n        /**\n         * Gets the initialized default dialog.\n         * @private\n         */\n        get: function () {\n            if (!this.dialogInternal) {\n                this.initDialog();\n            }\n            return this.dialogInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"dialog2\", {\n        /**\n         * Gets the initialized default dialog.\n         * @private\n         */\n        get: function () {\n            if (!this.dialogInternal2) {\n                this.initDialog2();\n            }\n            return this.dialogInternal2;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"pageFitType\", {\n        /**\n         * Gets or sets page fit type.\n         * @private\n         */\n        get: function () {\n            return this.pageFitTypeIn;\n        },\n        set: function (value) {\n            this.pageFitTypeIn = value;\n            this.onPageFitTypeChanged(this.pageFitTypeIn);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    LayoutViewer.prototype.initalizeStyles = function () {\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Normal', '{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 1', '{\"type\":\"Paragraph\",\"name\":\"Heading 1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 1 Char\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":12.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level1\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 2', '{\"type\":\"Paragraph\",\"name\":\"Heading 2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 2 Char\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level2\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 3', '{\"type\":\"Paragraph\",\"name\":\"Heading 3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 3 Char\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level3\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 4', '{\"type\":\"Paragraph\",\"name\":\"Heading 4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 4 Char\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level4\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 5', '{\"type\":\"Paragraph\",\"name\":\"Heading 5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 5 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level5\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 6', '{\"type\":\"Paragraph\",\"name\":\"Heading 6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 6 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level6\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Default Paragraph Font', '{\"type\":\"Character\",\"name\":\"Default Paragraph Font\"}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 1 Char', '{\"type\":\"Character\",\"name\":\"Heading 1 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 2 Char', '{\"type\":\"Character\",\"name\":\"Heading 2 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 3 Char', '{\"type\":\"Character\",\"name\":\"Heading 3 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\": \"#1F3763\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 4 Char', '{\"type\":\"Character\",\"name\":\"Heading 4 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 5 Char', '{\"type\":\"Character\",\"name\":\"Heading 5 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 6 Char', '{\"type\":\"Character\",\"name\":\"Heading 6 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Hyperlink', '{\"type\":\"Character\",\"name\":\"Hyperlink\",\"basedOn\":\"Default Paragraph Font\",\"next\":\"Normal\",\"characterFormat\":{\"fontColor\":\"#0563C1\",\"underline\": \"Single\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc1', '{\"type\":\"Paragraph\",\"name\":\"Toc1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc2', '{\"type\":\"Paragraph\",\"name\":\"Toc2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :11.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc3', '{\"type\":\"Paragraph\",\"name\":\"Toc3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :22.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc4', '{\"type\":\"Paragraph\",\"name\":\"Toc4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :33.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc5', '{\"type\":\"Paragraph\",\"name\":\"Toc5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :44.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc6', '{\"type\":\"Paragraph\",\"name\":\"Toc6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :55.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc7', '{\"type\":\"Paragraph\",\"name\":\"Toc7\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :66.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc8', '{\"type\":\"Paragraph\",\"name\":\"Toc8\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :77.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc9', '{\"type\":\"Paragraph\",\"name\":\"Toc9\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :88.0,\"afterSpacing\":5.0}}');\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.clearDocumentItems = function () {\n        this.headersFooters = [];\n        this.fields = [];\n        this.bookmarks.clear();\n        this.styles.clear();\n        this.characterFormat.clearFormat();\n        this.paragraphFormat.clearFormat();\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getAbstractListById = function (id) {\n        if (isNullOrUndefined(this.abstractLists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.abstractLists.length; i++) {\n            var abstractList = this.abstractLists[i];\n            if (abstractList instanceof WAbstractList && abstractList.abstractListId === id) {\n                return abstractList;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getListById = function (id) {\n        if (isNullOrUndefined(this.lists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.lists.length; i++) {\n            if (!isNullOrUndefined(this.lists[i]) && this.lists[i].listId === id) {\n                return this.lists[i];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.getListLevelNumber = function (listLevel) {\n        if (listLevel.ownerBase instanceof WLevelOverride) {\n            return listLevel.ownerBase.levelNumber;\n        }\n        else if (listLevel.ownerBase instanceof WAbstractList && !isNullOrUndefined(listLevel.ownerBase.levels)) {\n            return listLevel.ownerBase.levels.indexOf(listLevel);\n        }\n        else {\n            return -1;\n        }\n    };\n    /**\n     * Gets the bookmarks.\n     * @private\n     */\n    LayoutViewer.prototype.getBookmarks = function (includeHidden) {\n        var bookmarks = [];\n        for (var i = 0; i < this.bookmarks.keys.length; i++) {\n            var bookmark = this.bookmarks.keys[i];\n            if (includeHidden || bookmark.indexOf('_') !== 0) {\n                bookmarks.push(bookmark);\n            }\n        }\n        return bookmarks;\n    };\n    /**\n     * Initializes components.\n     * @private\n     */\n    LayoutViewer.prototype.initializeComponents = function () {\n        var element = this.owner.element;\n        if (isNullOrUndefined(element)) {\n            return;\n        }\n        var viewer = this;\n        this.optionsPaneContainer = createElement('div', {\n            className: 'e-documenteditor-optionspane'\n        });\n        element.appendChild(this.optionsPaneContainer);\n        this.viewerContainer = createElement('div', { id: this.owner.containerId + '_viewerContainer' });\n        this.viewerContainer.style.cssText = 'position:relative;backgroundColor:#FBFBFB;overflow:auto';\n        this.optionsPaneContainer.appendChild(this.viewerContainer);\n        this.viewerContainer.tabIndex = 0;\n        this.viewerContainer.style.outline = 'none';\n        this.pageContainer = createElement('div', { id: this.owner.containerId + '_pageContainer', className: 'e-de-background' });\n        this.viewerContainer.appendChild(this.pageContainer);\n        this.pageContainer.style.top = '0px';\n        this.pageContainer.style.left = '0px';\n        this.pageContainer.style.position = 'relative';\n        this.pageContainer.style.pointerEvents = 'none';\n        if (Browser.isDevice) {\n            this.createEditableDiv(element);\n        }\n        else {\n            this.createEditableIFrame();\n        }\n        if (this.owner.enableImageResizerMode) {\n            this.owner.imageResizerModule.initializeImageResizer();\n        }\n        this.updateViewerSizeInternal(element);\n        this.layout = new Layout(this);\n        this.textHelper = new TextHelper(this);\n        this.zoomModule = new Zoom(this);\n        // let locale: L10n = new L10n('documenteditor', this.owner.defaultLocale);\n        // locale.setLocale(this.owner.locale);\n        // setCulture(this.owner.locale);\n        this.initTouchEllipse();\n        this.wireEvent();\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.createEditableDiv = function (element) {\n        this.editableDiv = document.createElement('div');\n        this.editableDiv.contentEditable = 'true';\n        this.editableDiv.style.position = 'fixed';\n        this.editableDiv.style.left = '-150em';\n        this.editableDiv.style.width = '100%';\n        this.editableDiv.style.height = '100%';\n        this.editableDiv.id = element.id + '_editableDiv';\n        document.body.appendChild(this.editableDiv);\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.createEditableIFrame = function () {\n        this.iframe = createElement('iframe', {\n            attrs: {\n                'scrolling': 'no', 'src': 'javascript:false',\n                'style': 'pointer-events:none;position:absolute;top:-10000px'\n            },\n            className: 'e-de-text-target'\n        });\n        var innerHtml = '<!DOCTYPE html>'\n            + '<html><head></head>'\n            + '<body spellcheck=\"false\"style=\"background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;\" >'\n            + '<div contenteditable=\"true\" style=\"background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;\"></div>'\n            + '</body>'\n            + '</html>';\n        this.viewerContainer.appendChild(this.iframe);\n        this.iframe.contentDocument.open();\n        this.iframe.contentDocument.write(innerHtml);\n        this.iframe.contentDocument.close();\n        this.editableDiv = this.iframe.contentDocument.body.children[0];\n    };\n    /**\n     * Wires events and methods.\n     */\n    LayoutViewer.prototype.wireEvent = function () {\n        if (!isNullOrUndefined(this.selection)) {\n            this.selection.initCaret();\n        }\n        this.editableDiv.addEventListener('paste', this.onPaste);\n        if (!Browser.isDevice) {\n            this.editableDiv.addEventListener('keypress', this.onKeyPressInternal);\n            if (Browser.info.name === 'chrome') {\n                this.editableDiv.addEventListener('textInput', this.onTextInput);\n            }\n        }\n        else {\n            this.editableDiv.addEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.addEventListener('blur', this.onFocusOut);\n        this.editableDiv.addEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.addEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.addEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.addEventListener('compositionend', this.compositionEnd);\n        this.viewerContainer.addEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.addEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.addEventListener('keydown', this.onKeyDownInternal);\n        this.viewerContainer.addEventListener('mousemove', this.onMouseMoveInternal);\n        this.viewerContainer.addEventListener('contextmenu', this.onContextMenu);\n        this.viewerContainer.addEventListener('dblclick', this.onDoubleTap);\n        this.viewerContainer.addEventListener('mouseup', this.onMouseUpInternal);\n        window.addEventListener('resize', this.onWindowResize);\n        window.addEventListener('keyup', this.onKeyUpInternal);\n        window.addEventListener('mouseup', this.onImageResizer);\n        window.addEventListener('touchend', this.onImageResizer);\n        this.viewerContainer.addEventListener('touchstart', this.onTouchStartInternal);\n        this.viewerContainer.addEventListener('touchmove', this.onTouchMoveInternal);\n        this.viewerContainer.addEventListener('touchend', this.onTouchUpInternal);\n        if (navigator.userAgent.match('Firefox')) {\n            this.viewerContainer.addEventListener('DOMMouseScroll', this.zoomModule.onMouseWheelInternal);\n        }\n        this.viewerContainer.addEventListener('mousewheel', this.zoomModule.onMouseWheelInternal);\n    };\n    LayoutViewer.prototype.getEditableDivTextContent = function () {\n        return this.editableDiv.textContent;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.positionEditableTarget = function () {\n        var point = this.selection.getRect(this.selection.start);\n        var page = this.selection.getSelectionPage(this.selection.start);\n        var caretInfo = this.selection.updateCaretSize(this.owner.selection.start);\n        var sectionFormat = page.bodyWidgets[0].sectionFormat;\n        var left = page.boundingRectangle.x + (HelperMethods.convertPointToPixel(sectionFormat.leftMargin) * this.zoomFactor);\n        var top = point.y;\n        var pageWidth = sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin;\n        var iframeStyle = 'left:' + left + 'px;';\n        iframeStyle += 'top:' + top + 'px;';\n        iframeStyle += 'width:' + (HelperMethods.convertPointToPixel(pageWidth) * this.zoomFactor) + 'px;';\n        iframeStyle += 'height:250px;outline-style:none;position:absolute';\n        this.iframe.setAttribute('style', iframeStyle);\n        var style = 'background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;';\n        style += 'text-indent:' + (point.x - left) + 'px;';\n        style += 'color:transparent;pointer-events:none;outline-style:none;';\n        style += 'font-size:' + (HelperMethods.convertPointToPixel(this.selection.characterFormat.fontSize) * this.zoomFactor) + 'px;';\n        style += 'font-family' + this.selection.characterFormat.fontFamily + ';';\n        style += 'overflow:hidden;text-decoration:none;white-space:normal;';\n        this.editableDiv.setAttribute('style', style);\n    };\n    /**\n     * Initializes dialog template.\n     */\n    LayoutViewer.prototype.initDialog = function () {\n        if (!this.dialogInternal) {\n            this.dialogTarget = createElement('div', { className: 'e-de-dlg-target' });\n            document.body.appendChild(this.dialogTarget);\n            this.dialogInternal = new Dialog({\n                target: document.body, showCloseIcon: true,\n                allowDragging: true, visible: false, width: '1px', isModal: true, position: { X: 'center', Y: 'center' }, zIndex: 20\n            });\n            this.dialogInternal.open = this.selection.hideCaret;\n            this.dialogInternal.beforeClose = this.updateFocus;\n            this.dialogInternal.appendTo(this.dialogTarget);\n        }\n    };\n    /**\n     * Initializes dialog template.\n     */\n    LayoutViewer.prototype.initDialog2 = function () {\n        if (!this.dialogInternal2) {\n            var target = createElement('div', { className: 'e-de-dlg-target' });\n            document.body.appendChild(target);\n            this.dialogInternal2 = new Dialog({\n                target: document.body, showCloseIcon: true,\n                allowDragging: true, visible: false, width: '1px', isModal: true, position: { X: 'center', Y: 'Top' }, zIndex: 10\n            });\n            this.dialogInternal2.appendTo(target);\n        }\n    };\n    /**\n     * Clears the context.\n     * @private\n     */\n    LayoutViewer.prototype.clearContent = function () {\n        this.containerContext.clearRect(0, 0, this.containerCanvas.width, this.containerCanvas.height);\n        this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n    };\n    /**\n     * Fired when the document gets changed.\n     * @param {WordDocument} document\n     */\n    LayoutViewer.prototype.onDocumentChanged = function (sections) {\n        this.clearContent();\n        if (this.owner.editorModule) {\n            this.owner.editorModule.tocStyles = {};\n            this.owner.editorModule.tocBookmarkId = 0;\n        }\n        this.heightInfoCollection = {};\n        this.owner.isDocumentLoaded = false;\n        for (var i = 0; i < this.pages.length; i++) {\n            this.pages[i].bodyWidgets[0].destroy();\n        }\n        this.pages = [];\n        if (!isNullOrUndefined(this.renderedLists)) {\n            this.renderedLists.clear();\n        }\n        if (!isNullOrUndefined(this.owner.editorHistory)) {\n            this.owner.editorHistory.destroy();\n        }\n        this.owner.isDocumentLoaded = true;\n        this.layout.isInitialLoad = true;\n        this.layout.layoutItems(sections);\n        if (this.owner.selection) {\n            this.owner.selection.selectRange(this.owner.documentStart, this.owner.documentStart);\n        }\n        if (this.owner.optionsPaneModule) {\n            this.owner.optionsPaneModule.showHideOptionsPane(false);\n        }\n        this.owner.fireDocumentChange();\n    };\n    /**\n     * Initialize touch ellipse.\n     */\n    LayoutViewer.prototype.initTouchEllipse = function () {\n        var style = 'height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5';\n        // tslint:disable-next-line:max-line-length\n        var ellipse = ' height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;';\n        this.touchStart = createElement('div', { className: 'e-touch-ellipse', styles: style });\n        var start = createElement('div', { styles: ellipse });\n        this.touchEnd = createElement('div', { className: 'e-touch-ellipse', styles: style });\n        this.touchStart.style.display = 'none';\n        var end = createElement('div', { styles: ellipse });\n        this.touchStart.appendChild(start);\n        this.touchEnd.appendChild(end);\n        this.touchEnd.style.display = 'none';\n        this.viewerContainer.appendChild(this.touchStart);\n        this.viewerContainer.appendChild(this.touchEnd);\n    };\n    /**\n     * Updates touch mark position.\n     * @private\n     */\n    LayoutViewer.prototype.updateTouchMarkPosition = function () {\n        if (this.touchStart.style.display !== 'none' && !isNullOrUndefined(this.selection)) {\n            if (!this.selection.isEmpty) {\n                var y = this.selection.getCaretBottom(this.selection.start, false);\n                var page = this.selection.getPage(this.selection.start.paragraph);\n                var viewer = this;\n                // tslint:disable-next-line:max-line-length\n                var pageTop = (page.boundingRectangle.y - viewer.pageGap * (this.pages.indexOf(page) + 1)) * this.zoomFactor + viewer.pageGap * (this.pages.indexOf(page) + 1);\n                // tslint:disable-next-line:max-line-length\n                this.touchStart.style.left = page.boundingRectangle.x + (Math.round(this.selection.start.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchStart.style.top = pageTop + ((y) * this.zoomFactor) + 'px';\n                if (!this.selection.isEmpty) {\n                    y = this.selection.getCaretBottom(this.selection.end, false);\n                    page = this.selection.getPage(this.selection.end.paragraph);\n                }\n                // tslint:disable-next-line:max-line-length\n                this.touchEnd.style.left = page.boundingRectangle.x + (Math.round(this.selection.end.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchEnd.style.top = pageTop + (y * this.zoomFactor) + 'px';\n            }\n            else {\n                this.selection.updateCaretPosition();\n            }\n        }\n    };\n    LayoutViewer.prototype.isSelectionInListText = function (cursorPoint) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget) && widget.children[0] instanceof ListTextElementBox) {\n            var left = this.getLeftValue(widget);\n            var width = widget.children[0].width;\n            var height = widget.children[0].height;\n            if (this.isInsideRect(left, widget.paragraph.y, width, height, cursorPoint)) {\n                this.selectionLineWidget = widget;\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Check whether touch point is inside the rectangle or not.\n     * @param x\n     * @param y\n     * @param width\n     * @param height\n     * @param touchPoint\n     * @private\n     */\n    LayoutViewer.prototype.isInsideRect = function (x, y, width, height, touchPoint) {\n        if ((touchPoint.x > x && touchPoint.x <= x + width) && (touchPoint.y > y && touchPoint.y <= y + height)) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getLeftValue = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.selection.isParagraphFirstLine(widget)) {\n            if (paragraphFormat.textAlignment === 'Right') {\n                left -= HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n                left -= HelperMethods.convertPointToPixel(paragraphFormat.leftIndent);\n            }\n            else {\n                left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n            }\n        }\n        var element = widget.children[0];\n        if (element instanceof ListTextElementBox) {\n            left += element.margin.left;\n        }\n        return left;\n    };\n    /**\n     * Checks whether left mouse button is pressed or not.\n     */\n    LayoutViewer.prototype.isLeftButtonPressed = function (event) {\n        this.isTouchInput = false;\n        var button = event.which || event.button;\n        return button === 1;\n    };\n    /**\n     * Gets touch offset value.\n     */\n    LayoutViewer.prototype.getTouchOffsetValue = function (event) {\n        var targetElement = this.viewerContainer;\n        var offset = targetElement.getBoundingClientRect();\n        var touchOffsetValues = event.touches[0];\n        if (isNullOrUndefined(touchOffsetValues)) {\n            touchOffsetValues = event.changedTouches[0];\n        }\n        var offsetX = touchOffsetValues.pageX - offset.left;\n        var offsetY = touchOffsetValues.pageY - offset.top;\n        return new Point(offsetX, offsetY);\n    };\n    /**\n     * Fired on pinch zoom in.\n     * @param {TouchEvent} event\n     */\n    LayoutViewer.prototype.onPinchInInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor - 0.01;\n        if (updatedZoomFactor < 5 && updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor - 0.01;\n        }\n        if (updatedZoomFactor < 0.1) {\n            updatedZoomFactor = 0.1;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    /**\n     * Fired on pinch zoom out.\n     * @param {TouchEvent} event\n     */\n    LayoutViewer.prototype.onPinchOutInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor + 0.01;\n        if (updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor + 0.01;\n        }\n        if (updatedZoomFactor > 5) {\n            updatedZoomFactor = 5;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    /**\n     * Gets page width.\n     * @private\n     */\n    LayoutViewer.prototype.getPageWidth = function (page) {\n        var width = page.boundingRectangle.width;\n        return width;\n    };\n    /**\n     * Removes specified page.\n     * @private\n     */\n    LayoutViewer.prototype.removePage = function (page) {\n        if (this.currentPage === page) {\n            this.currentPage = undefined;\n        }\n        var index = this.pages.indexOf(page);\n        // if (index > -1) {\n        this.pages.splice(index, 1);\n        // }        \n        //this.removeRenderedPages();\n        var viewer = this;\n        if (!isNullOrUndefined(viewer.visiblePages)) {\n            if ((viewer.visiblePages).indexOf(page) > -1) {\n                var pageIndex = (viewer.visiblePages).indexOf(page);\n                (viewer.visiblePages).splice(pageIndex, 1);\n            }\n        }\n        //(viewer as PageLayoutViewer).visiblePages.remove(page);\n        var height = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            height = height + this.pages[i].boundingRectangle.height;\n        }\n        //Updates the vertical height.\n        height -= page.boundingRectangle.height + 20;\n        //ToDo:Update horizontal width, if removed page has max width.\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        if (index !== -1) {\n            for (var i = index; i < this.pages.length; i++) {\n                //Update bounding rectangle of next pages in collection.\n                page = this.pages[i];\n                // tslint:disable-next-line:max-line-length\n                page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n                top = page.boundingRectangle.bottom + 20;\n                page.repeatHeaderRowTableWidget = false;\n            }\n        }\n    };\n    // private removeRenderedPages(): void {\n    //     for (let i: number = 0; i < this.pages.length; i++) {\n    //         this.clearContainer(this.pages[i]);\n    //     }\n    // }\n    /**\n     * Updates viewer size on window resize.\n     * @private\n     */\n    LayoutViewer.prototype.updateViewerSize = function () {\n        var viewer = this;\n        var element = this.owner.getDocumentEditorElement();\n        viewer.updateViewerSizeInternal(element);\n        viewer.updateScrollBars();\n        if (!isNullOrUndefined(this.selection)) {\n            this.selection.updateCaretPosition();\n        }\n    };\n    /**\n     * Updates viewer size.\n     */\n    LayoutViewer.prototype.updateViewerSizeInternal = function (element) {\n        if (!isNullOrUndefined(element)) {\n            var rect = element.getBoundingClientRect();\n            var width = 0;\n            var height = 0;\n            height = rect.height > 0 ? rect.height : 200;\n            if (this.owner.optionsPaneModule && this.owner.optionsPaneModule.isOptionsPaneShow) {\n                var optionsRect = this.owner.optionsPaneModule.optionsPane.getBoundingClientRect();\n                width = (rect.width - optionsRect.width) > 0 ? (rect.width - optionsRect.width) : 200;\n            }\n            else {\n                width = rect.width > 0 ? rect.width : 200;\n            }\n            this.viewerContainer.style.height = height.toString() + 'px';\n            this.viewerContainer.style.width = Math.ceil(width) + 'px';\n            this.visibleBoundsIn = new Rect(0, 0, width, height);\n            this.containerCanvas.width = width;\n            this.containerCanvas.height = height;\n            this.selectionCanvas.width = width;\n            this.selectionCanvas.height = height;\n        }\n    };\n    /**\n     * Updates client area for block.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForBlock = function (block, beforeLayout, tableCollection) {\n        var leftIndent = HelperMethods.convertPointToPixel(block.leftIndent);\n        var rightIndent = HelperMethods.convertPointToPixel(block.rightIndent);\n        if (beforeLayout) {\n            if (block instanceof TableWidget && tableCollection) {\n                var tableWidget = tableCollection[0];\n                this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n                this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n                //Updates the location of last item.\n                tableWidget = tableCollection[tableCollection.length - 1];\n                tableWidget.x = this.clientActiveArea.x;\n                tableWidget.y = this.clientActiveArea.y;\n                this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n                // tslint:disable-next-line:max-line-length\n                this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if (block instanceof TableWidget && !isNullOrUndefined(block.tableFormat) && block.tableFormat.tableAlignment !== 'Left') {\n                    if (!block.isGridUpdated) {\n                        block.buildTableColumns();\n                        block.isGridUpdated = true;\n                    }\n                    var tableWidth = block.getMaxRowWidth(block.getTableClientWidth(block.getOwnerWidth(false)));\n                    // Fore resizing table, the tableholder table width taken for updated width. \n                    // Since, the columns will be cleared if we performed resizing.\n                    if (this.owner.editor && this.owner.editor.tableResize.currentResizingTable === block\n                        && this.owner.editor.tableResize.resizerPosition === 0) {\n                        tableWidth = block.tableHolder.tableWidth;\n                    }\n                    tableWidth = HelperMethods.convertPointToPixel(tableWidth);\n                    if (block.tableFormat.tableAlignment === 'Center') {\n                        leftIndent = (this.clientArea.width - tableWidth) / 2;\n                    }\n                    else {\n                        leftIndent = this.clientArea.width - tableWidth;\n                    }\n                    this.tableLefts.push(leftIndent);\n                }\n                this.clientActiveArea.x = this.clientArea.x = this.clientArea.x + leftIndent;\n                var width = this.clientArea.width - (leftIndent + rightIndent);\n                this.clientActiveArea.width = this.clientArea.width = width > 0 ? width : 0;\n                // tslint:disable-next-line:max-line-length\n                this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n                // tslint:disable-next-line:max-line-length\n                this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n            }\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            if (block instanceof TableWidget && block.tableFormat.tableAlignment !== 'Left' && this.tableLefts.length > 0) {\n                leftIndent = this.tableLefts.pop();\n            }\n            this.clientActiveArea.x = this.clientArea.x = this.clientArea.x - leftIndent;\n            var width = this.clientArea.width + leftIndent + rightIndent;\n            this.clientActiveArea.width = this.clientArea.width = width > 0 ? width : 0;\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates client active area left.\n     * @private\n     */\n    LayoutViewer.prototype.cutFromLeft = function (x) {\n        if (x < this.clientActiveArea.x) {\n            x = this.clientActiveArea.x;\n        }\n        if (x > this.clientActiveArea.right && this.textWrap) {\n            x = this.clientActiveArea.right;\n        }\n        this.clientActiveArea.width = this.clientActiveArea.right > x ? this.clientActiveArea.right - x : 0;\n        this.clientActiveArea.x = x;\n    };\n    /**\n     * Updates client active area top.\n     * @private\n     */\n    LayoutViewer.prototype.cutFromTop = function (y) {\n        if (y < this.clientActiveArea.y) {\n            y = this.clientActiveArea.y;\n        }\n        if (y > this.clientActiveArea.bottom) {\n            y = this.clientActiveArea.bottom;\n        }\n        this.clientActiveArea.height = this.clientActiveArea.bottom - y;\n        this.clientActiveArea.x = this.clientArea.x;\n        this.clientActiveArea.width = this.clientArea.width;\n        this.clientActiveArea.y = y;\n    };\n    /**\n     * Updates client width.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientWidth = function (width) {\n        this.clientActiveArea.x -= width;\n        if (this.clientActiveArea.width + width > 0) {\n            this.clientActiveArea.width += width;\n        }\n        else {\n            this.clientActiveArea.width = 0;\n        }\n    };\n    /**\n     * Inserts page in specified index.\n     * @private\n     */\n    LayoutViewer.prototype.insertPage = function (index, page) {\n        if (this.pages.indexOf(page) > -1) {\n            this.pages.splice(this.pages.indexOf(page), 1);\n        }\n        this.pages.splice(index, 0, page);\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        for (var i = index; i < this.pages.length; i++) {\n            //Update bounding rectangle of next pages in collection.\n            page = this.pages[i];\n            page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n            top = page.boundingRectangle.bottom + 20;\n        }\n    };\n    /**\n     * Updates client area.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientArea = function (sectionFormat, page) {\n        var top = 0;\n        var headerDistance = 48;\n        var footerDistance = 48;\n        var pageHeight = HelperMethods.convertPointToPixel(sectionFormat.pageHeight);\n        var bottomMargin = HelperMethods.convertPointToPixel(sectionFormat.bottomMargin);\n        if (!isNullOrUndefined(sectionFormat)) {\n            top = HelperMethods.convertPointToPixel(sectionFormat.topMargin);\n            headerDistance = HelperMethods.convertPointToPixel(sectionFormat.headerDistance);\n            footerDistance = HelperMethods.convertPointToPixel(sectionFormat.footerDistance);\n        }\n        if (!isNullOrUndefined(page.headerWidget)) {\n            top = Math.min(Math.max(headerDistance + page.headerWidget.height, top), pageHeight / 100 * 40);\n        }\n        var bottom = 0.667 + bottomMargin;\n        if (!isNullOrUndefined(page.footerWidget)) {\n            bottom = 0.667 + Math.min(pageHeight / 100 * 40, Math.max(footerDistance + page.footerWidget.height, bottomMargin));\n        }\n        var width = 0;\n        var height = 0;\n        if (!isNullOrUndefined(sectionFormat)) {\n            width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n            height = pageHeight - top - bottom;\n        }\n        if (width < 0) {\n            width = 0;\n        }\n        this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), top, width, pageHeight - top - bottom);\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    /**\n     * Updates client area left or top position.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaTopOrLeft = function (tableWidget, beforeLayout) {\n        if (beforeLayout) {\n            this.clientActiveArea.y = this.clientActiveArea.y + tableWidget.topBorderWidth;\n            this.clientActiveArea.x = this.clientActiveArea.x + tableWidget.leftBorderWidth;\n        }\n    };\n    /**\n     * Updates client area for table.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForTable = function (tableWidget) {\n        this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n        this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n    };\n    /**\n     * Updates client area for row.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForRow = function (row, beforeLayout) {\n        // tslint:disable-next-line:max-line-length\n        var tableWidget = row.ownerTable;\n        if (beforeLayout) {\n            //tslint:disable:no-empty\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n            this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates client area for cell.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForCell = function (cell, beforeLayout) {\n        // tslint:disable-next-line:max-line-length\n        var rowWidget = cell.ownerRow;\n        var cellWidget = cell;\n        if (beforeLayout) {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x;\n            this.clientActiveArea.y = cellWidget.y;\n            this.clientActiveArea.width = this.clientArea.width = cellWidget.width > 0 ? cellWidget.width : 0;\n            if (this instanceof PageLayoutViewer) {\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x + cellWidget.width + cellWidget.margin.right;\n            if (rowWidget.x + rowWidget.width - this.clientArea.x < 0) {\n                this.clientActiveArea.width = this.clientArea.width = 0;\n            }\n            else {\n                this.clientActiveArea.width = this.clientArea.width = rowWidget.x + rowWidget.width - this.clientArea.x;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea.y = cellWidget.y - cellWidget.margin.top - HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n            if (!cell.ownerTable.isInsideTable) {\n                this.clientActiveArea.height = this.clientArea.bottom - rowWidget.y > 0 ? this.clientArea.bottom - rowWidget.y : 0;\n            }\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates the client area based on widget.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaByWidget = function (widget) {\n        this.clientArea.x = widget.x;\n        this.clientArea.y = widget.y;\n        this.clientActiveArea.x = widget.x;\n        this.clientActiveArea.y = widget.y;\n    };\n    //Widget\n    /**\n     * Updates client area location.\n     * @param widget\n     * @param area\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaLocation = function (widget, area) {\n        widget.x = area.x;\n        widget.y = area.y;\n        widget.width = area.width;\n    };\n    /**\n     * Updates text position for selection.\n     * @param cursorPoint\n     * @param tapCount\n     * @param clearMultiSelection\n     * @private\n     */\n    LayoutViewer.prototype.updateTextPositionForSelection = function (cursorPoint, tapCount) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget)) {\n            this.selection.updateTextPosition(widget, cursorPoint);\n        }\n        if (tapCount > 1) {\n            this.isMouseDown = false;\n            this.useTouchSelectionMark = false;\n            if (this.pages.length === 0) {\n                return;\n            }\n            //Double tap/triple tap selection\n            if (!isNullOrUndefined(this.currentPage) && !isNullOrUndefined(this.owner.selection.start)) {\n                if (tapCount % 2 === 0) {\n                    this.owner.selection.selectCurrentWord();\n                }\n                else {\n                    this.owner.selection.selectCurrentParagraph();\n                }\n            }\n        }\n    };\n    /**\n     * Scrolls to specified position.\n     * @param startPosition\n     * @param endPosition\n     * @private\n     */\n    LayoutViewer.prototype.scrollToPosition = function (startPosition, endPosition) {\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizing\n            || this.isMouseDownInFooterRegion || this.isRowOrCellResizing) {\n            return;\n        }\n        var lineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, true);\n        if (isNullOrUndefined(lineWidget)) {\n            return;\n        }\n        var top = this.selection.getTop(lineWidget);\n        if (this.isMouseDown) {\n            var prevLineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, false);\n            var prevTop = this.selection.getTop(prevLineWidget);\n            if (prevLineWidget !== lineWidget && endPosition.location.y >= prevTop) {\n                lineWidget = prevLineWidget;\n            }\n        }\n        var height = lineWidget.height;\n        //Gets current page.\n        var endPage = this.selection.getPage(lineWidget.paragraph);\n        this.currentPage = endPage;\n        var x = 0;\n        var y = 0;\n        var viewer = this;\n        var horizontalWidth = 0;\n        var isPageLayout = viewer instanceof PageLayoutViewer;\n        if (isPageLayout) {\n            var pageLayout = viewer;\n            if (isNullOrUndefined(endPage)) {\n                return;\n            }\n            var pageWidth = endPage.boundingRectangle.width;\n            x = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n            if (x < 30) {\n                x = 30;\n            }\n            // tslint:disable-next-line:max-line-length\n            y = endPage.boundingRectangle.y * this.zoomFactor + (this.pages.indexOf(endPage) + 1) * viewer.pageGap * (1 - this.zoomFactor);\n        }\n        var scrollTop = this.containerTop;\n        var scrollLeft = this.containerLeft;\n        var pageHeight = this.visibleBounds.height;\n        var caretInfo = this.selection.updateCaretSize(this.owner.selection.end, true);\n        var topMargin = caretInfo.topMargin;\n        var caretHeight = caretInfo.height;\n        x += (endPosition.location.x) * this.zoomFactor;\n        y += (endPosition.location.y + topMargin) * this.zoomFactor;\n        //vertical scroll bar update\n        if ((scrollTop + 20) > y) {\n            this.viewerContainer.scrollTop = (y - 10);\n        }\n        else if (scrollTop + pageHeight < y + caretHeight) {\n            this.viewerContainer.scrollTop = y + caretHeight - pageHeight + 10;\n        }\n        else {\n            this.selection.updateCaretToPage(startPosition, endPage);\n        }\n        this.selection.updateCaretToPage(startPosition, endPage);\n        var scrollBarWidth = this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n        if (scrollLeft > x) {\n            this.viewerContainer.scrollLeft = x - (viewer.pageContainer.offsetWidth / 100) * 20;\n        }\n        else if (scrollLeft + this.visibleBounds.width < x + scrollBarWidth) {\n            this.viewerContainer.scrollLeft = scrollLeft + (viewer.pageContainer.offsetWidth / 100) * 15 + scrollBarWidth;\n        }\n    };\n    /**\n     * Gets line widget using cursor point.\n     * @private\n     */\n    LayoutViewer.prototype.getLineWidget = function (cursorPoint) {\n        return this.getLineWidgetInternal(cursorPoint, false);\n    };\n    /**\n     * Gets line widget.\n     * @private\n     */\n    LayoutViewer.prototype.getLineWidgetInternal = function (cursorPoint, isMouseDragged) {\n        var widget = undefined;\n        if (!isNullOrUndefined(this.currentPage)) {\n            var childWidgets = void 0;\n            if (this.owner.enableHeaderAndFooter) {\n                var page = this.currentPage;\n                var pageTop = this.selection.getPageTop(page);\n                var pageBottom = page.boundingRectangle.height;\n                var headerHeight = Math.max((page.headerWidget.y + page.headerWidget.height), HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin)) * this.zoomFactor;\n                var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n                var footerHeight = (page.boundingRectangle.height -\n                    Math.max(page.footerWidget.height + footerDistance, footerDistance * 2));\n                if (isMouseDragged) {\n                    if (this.isBlockInHeader(this.selection.start.paragraph)) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                    else {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                }\n                else {\n                    if (cursorPoint.y <= pageBottom && cursorPoint.y >= footerHeight) {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                    else if ((cursorPoint.y) >= 0 && (cursorPoint.y) <= headerHeight) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                }\n                if (isNullOrUndefined(childWidgets)) {\n                    return undefined;\n                }\n                return this.selection.getLineWidgetBodyWidget(childWidgets, cursorPoint);\n            }\n            else {\n                for (var i = 0; i < this.currentPage.bodyWidgets.length; i++) {\n                    var bodyWidgets = this.currentPage.bodyWidgets[i];\n                    widget = this.selection.getLineWidgetBodyWidget(bodyWidgets, cursorPoint);\n                    if (!isNullOrUndefined(widget)) {\n                        break;\n                    }\n                }\n            }\n        }\n        return widget;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.isBlockInHeader = function (block) {\n        while (!(block.containerWidget instanceof HeaderFooterWidget)) {\n            if (!block.containerWidget) {\n                return false;\n            }\n            block = block.containerWidget;\n        }\n        return block.containerWidget.headerFooterType.indexOf('Header') !== -1;\n    };\n    /**\n     * Clears selection highlight.\n     * @private\n     */\n    LayoutViewer.prototype.clearSelectionHighlight = function () {\n        var canClear = true;\n        canClear = (!this.isControlPressed || !this.isMouseDown);\n        // if (this.owner.selection.selectionRanges.length > 0 && canClear) {\n        if (this.owner.selection.clearSelectionHighlightInSelectedWidgets()) {\n            this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        }\n        // } else if (!isNullOrUndefined(this.owner.selection.currentSelectionRange) && this.isMouseDown) {\n        //     this.owner.selection.currentSelectionRange.clearSelectionHighlight();\n        // }\n        //this.renderVisiblePages();\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.removeEmptyPages = function () {\n        var scrollToLastPage = false;\n        var viewer = this;\n        for (var j = 0; j < this.pages.length; j++) {\n            var page = this.pages[j];\n            if (page.bodyWidgets.length === 0 || page.bodyWidgets[0].childWidgets.length === 0) {\n                // tslint:disable-next-line:max-line-length\n                if (j === this.pages.length - 1 && viewer instanceof PageLayoutViewer && viewer.visiblePages.indexOf(this.pages[j]) !== -1) {\n                    scrollToLastPage = true;\n                }\n                this.removePage(this.pages[j]);\n                j--;\n            }\n        }\n        if (scrollToLastPage) {\n            this.scrollToBottom();\n        }\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.scrollToBottom = function () {\n        if (this.selection.start.paragraph && this.selection.start.paragraph.bodyWidget) {\n            var page = this.selection.start.paragraph.bodyWidget.page;\n            var containerHeight = this.visibleBounds.height;\n            this.viewerContainer.scrollTop = page.boundingRectangle.bottom - containerHeight;\n        }\n    };\n    /**\n     * Returns the field code result.\n     * @private\n     */\n    LayoutViewer.prototype.getFieldResult = function (fieldBegin, page) {\n        if (!isNullOrUndefined(page) && !isNullOrUndefined(this.selection)) {\n            var fieldCode = this.selection.getFieldCode(fieldBegin);\n            var fieldCodes = fieldCode.split('\\*');\n            if (fieldCodes.length > 1) {\n                var fieldCategory = fieldCodes[0].replace(/[^\\w\\s]/gi, '').trim().toLowerCase();\n                var fieldPattern = fieldCodes[1].replace(/[^\\w\\s]/gi, '').trim();\n                switch (fieldCategory) {\n                    case 'page':\n                        return this.getFieldText(fieldPattern, (page.index + 1));\n                    case 'numpages':\n                        return this.getFieldText(fieldPattern, page.viewer.pages.length);\n                    default:\n                        break;\n                }\n            }\n        }\n        return '';\n    };\n    /**\n     * Returns field text.\n     */\n    LayoutViewer.prototype.getFieldText = function (pattern, value) {\n        switch (pattern) {\n            case 'ALPHABETIC':\n                return this.layout.getAsLetter(value).toUpperCase();\n            case 'alphabetic':\n                return this.layout.getAsLetter(value).toLowerCase();\n            case 'roman':\n                return this.layout.getAsRoman(value).toLowerCase();\n            case 'ROMAN':\n                return this.layout.getAsRoman(value).toUpperCase();\n            default:\n                return value.toString();\n        }\n    };\n    /**\n     * Destroys the internal objects maintained for control.\n     */\n    LayoutViewer.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.owner)) {\n            this.unWireEvent();\n        }\n        this.pages = [];\n        this.pages = undefined;\n        this.fieldStacks = [];\n        this.fieldStacks = undefined;\n        this.splittedCellWidgets = [];\n        this.splittedCellWidgets = undefined;\n        this.fields = [];\n        this.fields = undefined;\n        if (this.layout) {\n            this.layout.destroy();\n        }\n        this.layout = undefined;\n        if (!isNullOrUndefined(this.render)) {\n            this.render.destroy();\n        }\n        this.render = undefined;\n        if (this.dialogInternal) {\n            this.dialogInternal.destroy();\n        }\n        this.dialogInternal = undefined;\n        if (this.dialogTarget && this.dialogTarget.parentElement) {\n            this.dialogTarget.parentElement.removeChild(this.dialogTarget);\n        }\n        this.dialogTarget = undefined;\n        if (!isNullOrUndefined(this.touchStart)) {\n            this.touchStart.innerHTML = '';\n        }\n        if (this.textHelper) {\n            this.textHelper.destroy();\n        }\n        this.textHelper = undefined;\n        this.touchStart = undefined;\n        if (!isNullOrUndefined(this.touchEnd)) {\n            this.touchEnd.innerHTML = '';\n        }\n        this.touchEnd = undefined;\n        if (!isNullOrUndefined(this.containerCanvasIn)) {\n            this.containerCanvasIn.innerHTML = '';\n        }\n        this.containerCanvasIn = undefined;\n        if (!isNullOrUndefined(this.selectionCanvasIn)) {\n            this.selectionCanvasIn.innerHTML = '';\n        }\n        this.selectionCanvasIn = undefined;\n        if (!isNullOrUndefined(this.editableDiv)) {\n            this.editableDiv.innerHTML = '';\n            this.editableDiv.parentElement.removeChild(this.editableDiv);\n        }\n        this.editableDiv = undefined;\n        if (!isNullOrUndefined(this.pageContainer)) {\n            this.pageContainer.innerHTML = '';\n        }\n        this.pageContainer = undefined;\n        if (!isNullOrUndefined(this.viewerContainer)) {\n            this.viewerContainer.innerHTML = '';\n        }\n        this.viewerContainer = undefined;\n        this.owner = undefined;\n        this.heightInfoCollection = undefined;\n    };\n    /**\n     * Un-Wires events and methods\n     */\n    LayoutViewer.prototype.unWireEvent = function () {\n        this.viewerContainer.removeEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.removeEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.removeEventListener('mousemove', this.onMouseMoveInternal);\n        if (!Browser.isDevice) {\n            this.editableDiv.removeEventListener('keypress', this.onKeyPressInternal);\n            if (Browser.info.name === 'chrome') {\n                this.editableDiv.removeEventListener('textInput', this.onTextInput);\n            }\n        }\n        else {\n            this.editableDiv.removeEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.removeEventListener('paste', this.onPaste);\n        this.viewerContainer.removeEventListener('contextmenu', this.onContextMenu);\n        this.editableDiv.removeEventListener('blur', this.onFocusOut);\n        this.editableDiv.removeEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.removeEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.removeEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.removeEventListener('compositionend', this.compositionEnd);\n        this.viewerContainer.removeEventListener('mouseup', this.onMouseUpInternal);\n        this.viewerContainer.removeEventListener('dblclick', this.onDoubleTap);\n        window.removeEventListener('resize', this.onWindowResize);\n        window.removeEventListener('keyup', this.onKeyUpInternal);\n        window.removeEventListener('mouseup', this.onImageResizer);\n        window.removeEventListener('touchend', this.onImageResizer);\n    };\n    return LayoutViewer;\n}());\nexport { LayoutViewer };\n/**\n * @private\n */\nvar PageLayoutViewer = /** @class */ (function (_super) {\n    __extends(PageLayoutViewer, _super);\n    /**\n     * Initialize the constructor of PageLayoutViewer\n     */\n    function PageLayoutViewer(owner) {\n        var _this = _super.call(this, owner) || this;\n        _this.pageLeft = 30;\n        /**\n         * @private\n         */\n        _this.pageGap = 20;\n        /**\n         * @private\n         */\n        _this.visiblePages = [];\n        if (isNullOrUndefined(owner) || isNullOrUndefined(owner.element)) {\n            return _this;\n        }\n        return _this;\n    }\n    /**\n     * Creates new page.\n     * @private\n     */\n    PageLayoutViewer.prototype.createNewPage = function (section, index) {\n        var viewer = this;\n        var yPos = this.pageGap;\n        if (this.pages.length > 0) {\n            yPos = this.pages[this.pages.length - 1].boundingRectangle.bottom + this.pageGap;\n        }\n        var page = new Page();\n        page.viewer = this;\n        // tslint:disable-next-line:max-line-length\n        var pageWidth = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth) : 816;\n        // tslint:disable-next-line:max-line-length\n        var pageHeight = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight) : 1056;\n        var xPos = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n        if (xPos < this.pageLeft) {\n            xPos = this.pageLeft;\n        }\n        page.boundingRectangle = new Rect(xPos, yPos, pageWidth, pageHeight);\n        if (isNullOrUndefined(index)) {\n            this.pages.push(page);\n        }\n        else {\n            this.pages.splice(index, 0, page);\n        }\n        this.updateClientArea(section.sectionFormat, page);\n        page.bodyWidgets.push(section);\n        page.bodyWidgets[page.bodyWidgets.length - 1].page = page;\n        this.layout.layoutHeaderFooter(section, viewer, page);\n        this.updateClientArea(section.sectionFormat, page);\n        return page;\n    };\n    /**\n     * Updates cursor.\n     */\n    PageLayoutViewer.prototype.updateCursor = function (event) {\n        var hyperlinkField = undefined;\n        var div = this.viewerContainer;\n        var point = new Point(event.offsetX, event.offsetY);\n        var touchPoint = this.findFocusedPage(point, true);\n        var widget = this.getLineWidget(touchPoint);\n        var widgetInfo;\n        var left;\n        var top;\n        var editor = !this.owner.isReadOnlyMode ? this.owner.editorModule : undefined;\n        var isRowResize = editor ? editor.tableResize.isInRowResizerArea(touchPoint) : false;\n        var isCellResize = editor ? editor.tableResize.isInCellResizerArea(touchPoint) : false;\n        var resizePosition = '';\n        if (this.owner.enableImageResizerMode) {\n            var resizeObj = this.owner.imageResizerModule.getImagePoint(touchPoint);\n            this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n            resizePosition = resizeObj.resizePosition;\n        }\n        var lineLeft = 0;\n        if (!isNullOrUndefined(widget)) {\n            lineLeft = this.selection.getLineStartLeft(widget);\n            hyperlinkField = this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint);\n            widgetInfo = this.selection.updateTextPositionIn(widget, undefined, 0, touchPoint, true);\n            left = this.selection.getLeft(widget);\n            top = this.selection.getTop(widget);\n            this.selection.setHyperlinkContentToToolTip(hyperlinkField, widget, touchPoint.x);\n        }\n        if (!isNullOrUndefined(hyperlinkField) && (event.ctrlKey &&\n            this.owner.useCtrlClickToFollowHyperlink || !this.owner.useCtrlClickToFollowHyperlink)) {\n            div.style.cursor = 'pointer';\n            return;\n        }\n        else if (touchPoint.x >= lineLeft &&\n            event.offsetX < (this.visibleBounds.width - (this.visibleBounds.width - this.viewerContainer.clientWidth)) &&\n            event.offsetY < (this.visibleBounds.height - (this.visibleBounds.height - this.viewerContainer.clientHeight))) {\n            if (this.selection.isEmpty) {\n                div.style.cursor = 'text';\n            }\n            else {\n                div.style.cursor = this.selection.checkCursorIsInSelection(widget, touchPoint) ? 'default' : 'text';\n            }\n        }\n        else {\n            div.style.cursor = 'default';\n        }\n        if (!isNullOrUndefined(resizePosition) && resizePosition !== '') {\n            div.style.cursor = resizePosition;\n        }\n        else if (!isNullOrUndefined(widgetInfo) && widgetInfo.isImageSelected && left < touchPoint.x && top < touchPoint.y &&\n            left + widget.width > touchPoint.x && top + widget.height > touchPoint.y) {\n            div.style.cursor = 'move';\n        }\n        if (isRowResize) {\n            div.style.cursor = 'row-resize';\n        }\n        else if (isCellResize) {\n            div.style.cursor = 'col-resize';\n        }\n    };\n    /**\n     * Finds focused page.\n     * @private\n     */\n    PageLayoutViewer.prototype.findFocusedPage = function (currentPoint, updateCurrentPage) {\n        var point = new Point(currentPoint.x, currentPoint.y);\n        point.x += this.viewerContainer.scrollLeft;\n        point.y += this.viewerContainer.scrollTop;\n        for (var i = 0; i < this.pages.length; i++) {\n            var page = this.pages[i];\n            var pageTop = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            var pageHeight = (page.boundingRectangle.height * this.zoomFactor) + this.pageGap;\n            var pageLeft = page.boundingRectangle.x;\n            var pageRight = ((page.boundingRectangle.right - pageLeft) * this.zoomFactor) + pageLeft;\n            if (pageTop <= point.y && pageTop + pageHeight >= point.y) {\n                if (updateCurrentPage) {\n                    this.currentPage = page;\n                }\n                point.y = (point.y - (pageTop)) / this.zoomFactor;\n                if (point.x > pageRight) {\n                    point.x = page.boundingRectangle.right;\n                }\n                else if (point.x < pageLeft) {\n                    point.x = 0;\n                }\n                else {\n                    point.x = (point.x - pageLeft) / this.zoomFactor;\n                }\n                return point;\n            }\n        }\n        return point;\n    };\n    /**\n     * Fired when page fit type changed.\n     * @private\n     */\n    PageLayoutViewer.prototype.onPageFitTypeChanged = function (pageFitType) {\n        var width = this.visibleBounds.width;\n        var height = this.visibleBounds.height;\n        var section = this.visiblePages[0].bodyWidgets[0];\n        var pageWidth = HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth);\n        var pageHeight = HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight);\n        switch (pageFitType) {\n            case 'FitOnePage':\n                if (height > 0 && pageHeight > 0) {\n                    var zoomFactor = (this.visibleBounds.height - 2 * this.pageGap - (this.pageGap - 2)) / pageHeight;\n                    if (zoomFactor === this.zoomFactor) {\n                        if (!isNullOrUndefined(this.owner.selection) && !isNullOrUndefined(this.owner.selection.start) &&\n                            !isNullOrUndefined(this.owner.selection.end)) {\n                            this.scrollToPosition(this.owner.selection.start, this.owner.selection.end);\n                        }\n                    }\n                    else {\n                        this.zoomFactor = zoomFactor;\n                    }\n                }\n                break;\n            case 'FitPageWidth':\n                if (width > 0 && pageWidth > 0) {\n                    this.zoomFactor = (this.visibleBounds.width - 80) / pageWidth;\n                }\n                break;\n            default:\n                this.zoomFactor = 100 / 100;\n                break;\n        }\n    };\n    /**\n     * @private\n     */\n    PageLayoutViewer.prototype.handleZoom = function () {\n        var prevScaleFactor = this.preZoomFactor;\n        var page = null;\n        var verticalHeight = 0;\n        var scrollToPosition = false;\n        if (this.selection && isNullOrUndefined(this.zoomX && isNullOrUndefined(this.zoomY))) {\n            var x = 0;\n            var y = 0;\n            var endPage = this.selection.getPage(this.selection.end.currentWidget.paragraph);\n            x = (this.visibleBounds.width - endPage.boundingRectangle.width * prevScaleFactor) / 2;\n            if (x < 30) {\n                x = 30;\n            }\n            // tslint:disable-next-line:max-line-length\n            y = endPage.boundingRectangle.y * prevScaleFactor + (this.pages.indexOf(endPage) + 1) * this.pageGap * (1 - prevScaleFactor);\n            var caretInfo = this.selection.updateCaretSize(this.owner.selection.end, true);\n            var topMargin = caretInfo.topMargin;\n            var caretHeight = caretInfo.height;\n            x += (this.selection.end.location.x) * prevScaleFactor;\n            y += (this.selection.end.location.y + topMargin) * prevScaleFactor;\n            if (x >= this.containerLeft && x <= this.visibleBounds.width &&\n                y >= this.containerTop && y <= this.containerTop + this.visibleBounds.height) {\n                scrollToPosition = true;\n            }\n        }\n        for (var i = 0; i < this.pages.length; i++) {\n            verticalHeight = verticalHeight + this.pages[i].boundingRectangle.height;\n        }\n        var horizontalWidth = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            if (horizontalWidth < this.pages[i].boundingRectangle.width) {\n                horizontalWidth = this.pages[i].boundingRectangle.width;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        var height = (verticalHeight * this.zoomFactor + (this.pages.length + 1) * this.pageGap * (1 - this.zoomFactor)) - this.visibleBounds.height;\n        var horWidth = horizontalWidth * this.zoomFactor - this.visibleBounds.width;\n        if (this.visibleBounds.width - horizontalWidth * this.zoomFactor < 60) {\n            horWidth += 60;\n        }\n        //Update Vertical Scroll bar\n        if (height > 0) {\n            var value = this.containerTop;\n            if (this.visiblePages.length > 0) {\n                page = this.visiblePages[0];\n                // tslint:disable-next-line:max-line-length\n                var prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                var zoomY = this.zoomY;\n                if (isNullOrUndefined) {\n                    zoomY = this.visibleBounds.height / 2;\n                }\n                var prevY = value + zoomY;\n                while (prevY > prevPageTop + (page.boundingRectangle.height * prevScaleFactor)) {\n                    var pageIndex = page.index + 1;\n                    if (pageIndex === this.pages.length) {\n                        break;\n                    }\n                    page = this.pages[pageIndex];\n                    // tslint:disable-next-line:max-line-length\n                    prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                }\n                // tslint:disable-next-line:max-line-length\n                var currentY = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * this.zoomFactor + (page.index + 1) * this.pageGap\n                    + ((prevY - prevPageTop) < 0 ? prevY - prevPageTop : (prevY - prevPageTop) * (this.zoomFactor / prevScaleFactor));\n                value = currentY - zoomY;\n                zoomY = this.visibleBounds.height / 2;\n            }\n            this.viewerContainer.scrollTop = value;\n        }\n        else {\n            this.viewerContainer.scrollTop = 0;\n        }\n        // update Horizontal Scroll Bar\n        if (horWidth > 0) {\n            var value = this.containerLeft;\n            if (this.visiblePages.length > 0) {\n                if (page === null) {\n                    page = this.visiblePages[0];\n                }\n                var zoomX = this.zoomX;\n                if (isNullOrUndefined(zoomX)) {\n                    zoomX = this.visibleBounds.width / 2;\n                }\n                var prevValue = (page.boundingRectangle.width * prevScaleFactor) / page.boundingRectangle.width;\n                var prevX = value + zoomX;\n                // tslint:disable-next-line:max-line-length\n                var currentX = page.boundingRectangle.x\n                    + ((prevX - page.boundingRectangle.x) < 0 ? prevX - page.boundingRectangle.x : (prevX - page.boundingRectangle.x) * (this.zoomFactor / prevValue));\n                value = currentX - zoomX;\n                zoomX = this.visibleBounds.width / 2;\n            }\n            this.viewerContainer.scrollLeft = value;\n        }\n        else {\n            this.viewerContainer.scrollLeft = 0;\n        }\n        this.updateScrollBars();\n        if (scrollToPosition) {\n            this.scrollToPosition(this.selection.start, this.selection.end);\n        }\n    };\n    /**\n     * Gets current page header footer.\n     * @private\n     */\n    PageLayoutViewer.prototype.getCurrentPageHeaderFooter = function (section, isHeader) {\n        return this.getCurrentHeaderFooter(this.getHeaderFooterType(section, isHeader), section.index);\n    };\n    /**\n     * Get header footer type\n     * @private\n     */\n    PageLayoutViewer.prototype.getHeaderFooterType = function (section, isHeader) {\n        var type;\n        type = isHeader ? 'OddHeader' : 'OddFooter';\n        // tslint:disable-next-line:max-line-length\n        if (section.sectionFormat.differentFirstPage && (this.pages.length === 1 || this.pages[this.pages.length - 1].bodyWidgets[0].index !== section.index)) {\n            type = isHeader ? 'FirstPageHeader' : 'FirstPageFooter';\n        }\n        else if (section.sectionFormat.differentOddAndEvenPages && this.pages.length % 2 === 0) {\n            type = isHeader ? 'EvenHeader' : 'EvenFooter';\n        }\n        return type;\n    };\n    /**\n     * Gets current header footer.\n     * @param type\n     * @param section\n     * @private\n     */\n    PageLayoutViewer.prototype.getCurrentHeaderFooter = function (type, sectionIndex) {\n        if (this.headersFooters[sectionIndex]) {\n            var index = this.getHeaderFooter(type);\n            var headerFooter = this.headersFooters[sectionIndex][index];\n            if (!headerFooter) {\n                headerFooter = this.createHeaderFooterWidget(type);\n                this.headersFooters[sectionIndex][index] = headerFooter;\n            }\n            return headerFooter;\n        }\n        else if (sectionIndex > 0) {\n            return this.getCurrentHeaderFooter(type, sectionIndex - 1);\n        }\n        return undefined;\n    };\n    PageLayoutViewer.prototype.createHeaderFooterWidget = function (type) {\n        var headerFooter = new HeaderFooterWidget(type);\n        var paragraph = new ParagraphWidget();\n        paragraph.childWidgets.push(new LineWidget(paragraph));\n        return headerFooter;\n    };\n    /**\n     * Gets header footer.\n     * @param type\n     * @private\n     */\n    PageLayoutViewer.prototype.getHeaderFooter = function (type) {\n        switch (type) {\n            case 'OddHeader':\n                return 0;\n            case 'OddFooter':\n                return 1;\n            case 'EvenHeader':\n                return 2;\n            case 'EvenFooter':\n                return 3;\n            case 'FirstPageHeader':\n                return 4;\n            case 'FirstPageFooter':\n                return 5;\n        }\n    };\n    /**\n     * Updates header footer client area.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateHFClientArea = function (sectionFormat, isHeader) {\n        // tslint:disable-next-line:max-line-length\n        var width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n        if (width < 0) {\n            width = 0;\n        }\n        if (isHeader) {\n            // tslint:disable-next-line:max-line-length\n            this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.headerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.pageHeight - sectionFormat.footerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    /**\n     * @private\n     */\n    PageLayoutViewer.prototype.updateHCFClientAreaWithTop = function (sectionFormat, isHeader, page) {\n        this.updateHFClientArea(sectionFormat, isHeader);\n        if (!isHeader) {\n            if (page.footerWidget.y < this.clientActiveArea.y) {\n                this.clientActiveArea.y = page.footerWidget.y;\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n        }\n    };\n    /**\n     * Scrolls to the specified page\n     * @private\n     */\n    PageLayoutViewer.prototype.scrollToPage = function (pageIndex) {\n        var top = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            top = this.pages[i].boundingRectangle.y - (this.pageGap / 2);\n            if (i === pageIndex) {\n                break;\n            }\n        }\n        this.viewerContainer.scrollTop = top;\n        this.updateScrollBars();\n    };\n    /**\n     * Updates scroll bars.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateScrollBars = function () {\n        var height = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            height = height + this.pages[i].boundingRectangle.height;\n        }\n        var width = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            if (width < this.pages[i].boundingRectangle.width) {\n                width = this.pages[i].boundingRectangle.width;\n            }\n        }\n        var containerWidth = (width * this.zoomFactor) + (this.pageLeft * 2);\n        var containerHeight = (height * this.zoomFactor) + (this.pages.length + 1) * this.pageGap;\n        var viewerWidth = this.visibleBounds.width;\n        var viewerHeight = this.visibleBounds.height;\n        if (this.visibleBounds.width !== this.viewerContainer.clientWidth) {\n            viewerWidth -= (this.visibleBounds.width - this.viewerContainer.clientWidth);\n        }\n        else if (containerHeight > viewerHeight) {\n            viewerWidth -= this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n        }\n        if (containerWidth > viewerWidth) {\n            viewerHeight -= (this.visibleBounds.height - this.viewerContainer.clientHeight);\n        }\n        width = containerWidth > viewerWidth ? containerWidth : viewerWidth;\n        height = containerHeight > viewerHeight ? containerHeight : viewerHeight;\n        if (parseInt(this.pageContainer.style.width.replace('px', ''), 10) !== width ||\n            parseInt(this.pageContainer.style.height.replace('px', ''), 10) !== width) {\n            this.pageContainer.style.width = width.toString() + 'px';\n            this.pageContainer.style.height = height.toString() + 'px';\n        }\n        // if (!isNullOrUndefined(this.selection) && !this.selection.isEmpty) {\n        //     this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        // }\n        var displayPixelRatio = Math.max(1, window.devicePixelRatio || 1);\n        if (this.containerCanvas.width !== Math.floor(viewerWidth * displayPixelRatio)\n            || this.containerCanvas.height !== Math.floor(viewerHeight * displayPixelRatio)) {\n            this.containerCanvas.width = viewerWidth * displayPixelRatio;\n            this.containerCanvas.height = viewerHeight * displayPixelRatio;\n            this.containerCanvas.style.width = viewerWidth + 'px';\n            this.containerCanvas.style.height = viewerHeight + 'px';\n            this.containerContext.scale(displayPixelRatio, displayPixelRatio);\n            this.selectionCanvas.width = viewerWidth * displayPixelRatio;\n            this.selectionCanvas.height = viewerHeight * displayPixelRatio;\n            this.selectionCanvas.style.width = viewerWidth + 'px';\n            this.selectionCanvas.style.height = viewerHeight + 'px';\n            this.selectionContext.scale(displayPixelRatio, displayPixelRatio);\n        }\n        this.containerContext.globalAlpha = 1;\n        this.selectionContext.globalAlpha = 0.4;\n        for (var i = 0; i < this.pages.length; i++) {\n            var left = (width - this.pages[i].boundingRectangle.width * this.zoomFactor) / 2;\n            if (left > this.pageLeft) {\n                // tslint:disable-next-line:max-line-length\n                this.pages[i].boundingRectangle = new Rect(left, this.pages[i].boundingRectangle.y, this.pages[i].boundingRectangle.width, this.pages[i].boundingRectangle.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                this.pages[i].boundingRectangle = new Rect(this.pageLeft, this.pages[i].boundingRectangle.y, this.pages[i].boundingRectangle.width, this.pages[i].boundingRectangle.height);\n            }\n        }\n        this.updateScrollBarPosition(containerWidth, containerHeight, viewerWidth, viewerHeight, width, height);\n    };\n    // tslint:disable-next-line:max-line-length\n    PageLayoutViewer.prototype.updateScrollBarPosition = function (containerWidth, containerHeight, viewerWidth, viewerHeight, width, height) {\n        var left = 0;\n        var viewerHeight1 = parseFloat(this.viewerContainer.style.height);\n        var containerHeight1 = parseFloat(this.pageContainer.style.height);\n        this.containerTop = this.viewerContainer.scrollTop;\n        this.containerCanvas.style.position = 'absolute';\n        this.containerCanvas.style.top = this.containerTop.toString() + 'px';\n        this.selectionCanvas.style.position = 'absolute';\n        this.selectionCanvas.style.top = this.containerTop.toString() + 'px';\n        this.containerLeft = this.viewerContainer.scrollLeft;\n        this.containerCanvas.style.left = this.containerLeft + 'px';\n        this.selectionCanvas.style.left = this.containerLeft + 'px';\n        this.updateVisiblePages();\n    };\n    /**\n     * Updates visible pages.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateVisiblePages = function () {\n        var left = 0;\n        var width = 0;\n        // Clears the container first.\n        this.visiblePages = [];\n        var height = this.visibleBounds.height;\n        var vertical = this.viewerContainer.scrollTop;\n        for (var i = 0; i < this.pages.length; i++) {\n            var page = this.pages[i];\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            var pageH = page.boundingRectangle.height * this.zoomFactor;\n            var left_1 = page.boundingRectangle.x;\n            var isTopFit = y >= vertical && y <= vertical + height;\n            var isBottomFit = y + pageH >= vertical && y + pageH <= vertical + height;\n            var isMiddleFit = y <= vertical && y + pageH >= vertical + height;\n            //UI Virtualization\n            if (isTopFit || isBottomFit || isMiddleFit) {\n                this.addVisiblePage(page, left_1, y);\n            }\n        }\n    };\n    /**\n     * Adds visible pages.\n     */\n    PageLayoutViewer.prototype.addVisiblePage = function (page, x, y) {\n        var width = page.boundingRectangle.width * this.zoomFactor;\n        var height = page.boundingRectangle.height * this.zoomFactor;\n        // tslint:disable-next-line:max-line-length\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.currentPage !== undefined && this.owner.imageResizerModule.currentPage === page && this.owner.imageResizerModule.isImageResizerVisible) {\n            this.owner.imageResizerModule.setImageResizerPositions(x, y, width, height);\n        }\n        this.visiblePages.push(page);\n        this.renderPage(page, x, y, width, height);\n    };\n    /**\n     * Render specified page widgets.\n     */\n    PageLayoutViewer.prototype.renderPage = function (page, x, y, width, height) {\n        this.render.renderWidgets(page, x - this.containerLeft, y - this.containerTop, width, height);\n    };\n    /**\n     * Renders visible pages.\n     * @private\n     */\n    PageLayoutViewer.prototype.renderVisiblePages = function () {\n        if (isNullOrUndefined(this.visiblePages) || this.visiblePages.length < 1) {\n            return;\n        }\n        this.clearContent();\n        for (var i = 0; i < this.visiblePages.length; i++) {\n            var page = this.visiblePages[i];\n            var width = page.boundingRectangle.width * this.zoomFactor;\n            var height = page.boundingRectangle.height * this.zoomFactor;\n            var x = page.boundingRectangle.x;\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            this.renderPage(page, x, y, width, height);\n        }\n    };\n    return PageLayoutViewer;\n}(LayoutViewer));\nexport { PageLayoutViewer };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WList } from '../list/list';\nimport { WListLevel } from '../list/list-level';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { WCharacterFormat, WListFormat, WParagraphFormat, WCellFormat, WTableFormat, WSectionFormat, WRowFormat } from '../format/index';\nimport { WCharacterStyle, WParagraphStyle, WTabStop } from '../format/index';\nimport { LineWidget, ParagraphWidget, ImageElementBox, BodyWidget, TextElementBox, TableCellWidget, TableRowWidget, TableWidget, FieldElementBox, HeaderFooterWidget, BookmarkElementBox, FieldTextElementBox, TabElementBox } from './page';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar SfdtReader = /** @class */ (function () {\n    function SfdtReader(viewer) {\n        /* tslint:disable:no-any */\n        this.viewer = undefined;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(SfdtReader.prototype, \"isPasting\", {\n        get: function () {\n            return this.viewer && this.viewer.owner.isPastingContent;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     * @param json\n     */\n    SfdtReader.prototype.convertJsonToDocument = function (json) {\n        var sections = [];\n        var jsonObject = JSON.parse(json);\n        this.parseCharacterFormat(jsonObject.characterFormat, this.viewer.characterFormat);\n        this.parseParagraphFormat(jsonObject.paragraphFormat, this.viewer.paragraphFormat);\n        if (!isNullOrUndefined(jsonObject.background)) {\n            this.viewer.backgroundColor = this.getColor(jsonObject.background.color);\n        }\n        if (!isNullOrUndefined(jsonObject.abstractLists)) {\n            this.parseAbstractList(jsonObject, this.viewer.abstractLists);\n        }\n        if (!isNullOrUndefined(jsonObject.lists)) {\n            this.parseList(jsonObject, this.viewer.lists);\n        }\n        if (!isNullOrUndefined(jsonObject.styles)) {\n            this.parseStyles(jsonObject, this.viewer.styles);\n        }\n        if (!isNullOrUndefined(jsonObject.sections)) {\n            this.parseSections(jsonObject.sections, sections);\n        }\n        return sections;\n    };\n    SfdtReader.prototype.parseStyles = function (data, styles) {\n        for (var i = 0; i < data.styles.length; i++) {\n            if (isNullOrUndefined(this.viewer.styles.findByName(data.styles[i].name))) {\n                this.parseStyle(data, data.styles[i], styles);\n            }\n        }\n    };\n    SfdtReader.prototype.parseStyle = function (data, style, styles) {\n        var wStyle;\n        if (!isNullOrUndefined(style.type)) {\n            if (style.type === 'Paragraph') {\n                wStyle = new WParagraphStyle();\n                wStyle.type = 'Paragraph';\n            }\n            if (style.type === 'Character') {\n                wStyle = new WCharacterStyle();\n                wStyle.type = 'Character';\n            }\n            if (!isNullOrUndefined(style.name)) {\n                wStyle.name = style.name;\n            }\n            styles.push(wStyle);\n            if (!isNullOrUndefined(style.basedOn)) {\n                var basedOn = styles.findByName(style.basedOn);\n                if (!isNullOrUndefined(basedOn)) {\n                    if (basedOn.type === wStyle.type) {\n                        wStyle.basedOn = basedOn;\n                    }\n                }\n                else {\n                    var basedStyle = this.getStyle(style.basedOn, data);\n                    var styleString = void 0;\n                    if (!isNullOrUndefined(basedStyle) && basedStyle.type === wStyle.type) {\n                        styleString = basedStyle;\n                    }\n                    else {\n                        if (wStyle.type === 'Paragraph') {\n                            styleString = JSON.parse('{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n                        }\n                        else {\n                            styleString = JSON.parse('{\"type\": \"Character\",\"name\": \"Default Paragraph Font\"}');\n                        }\n                    }\n                    this.parseStyle(data, styleString, styles);\n                    wStyle.basedOn = styles.findByName(styleString.name);\n                }\n            }\n            if (!isNullOrUndefined(style.link)) {\n                var link = styles.findByName(style.link);\n                var linkStyle = this.getStyle(style.link, data);\n                var styleString = void 0;\n                if (isNullOrUndefined(link)) {\n                    if (isNullOrUndefined(linkStyle)) {\n                        //Construct the CharacterStyle string\n                        var charaStyle = {};\n                        charaStyle.characterFormat = style.characterFormat;\n                        charaStyle.name = style.name + ' Char';\n                        charaStyle.type = 'Character';\n                        //TODO: Implement basedOn\n                        charaStyle.basedOn = style.basedOn === 'Normal' ? 'Default Paragraph Font' : (style.basedOn + ' Char');\n                        styleString = charaStyle;\n                    }\n                    else {\n                        styleString = linkStyle;\n                    }\n                    this.parseStyle(data, styleString, styles);\n                    wStyle.link = isNullOrUndefined(styles.findByName(styleString.name)) ? style.link : styles.findByName(styleString.name);\n                }\n                else {\n                    wStyle.link = link;\n                }\n            }\n            if (!isNullOrUndefined(style.characterFormat)) {\n                this.parseCharacterFormat(style.characterFormat, wStyle.characterFormat);\n            }\n            if (!isNullOrUndefined(style.paragraphFormat)) {\n                this.parseParagraphFormat(style.paragraphFormat, wStyle.paragraphFormat);\n            }\n            if (!isNullOrUndefined(style.next)) {\n                if (style.next === style.name) {\n                    wStyle.next = wStyle;\n                }\n                else {\n                    var next = styles.findByName(style.next);\n                    if (!isNullOrUndefined(next) && next.type === wStyle.type) {\n                        wStyle.next = next;\n                    }\n                    else {\n                        var nextStyleString = this.getStyle(style.next, data);\n                        if (!isNullOrUndefined(nextStyleString)) {\n                            this.parseStyle(data, nextStyleString, styles);\n                            wStyle.next = styles.findByName(nextStyleString.name);\n                        }\n                        else {\n                            wStyle.next = wStyle;\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.getStyle = function (name, data) {\n        for (var i = 0; i < data.styles.length; i++) {\n            if (data.styles[i].name === name) {\n                return data.styles[i];\n            }\n        }\n        return undefined;\n    };\n    SfdtReader.prototype.parseAbstractList = function (data, abstractLists) {\n        for (var i = 0; i < data.abstractLists.length; i++) {\n            var abstractList = new WAbstractList();\n            var abstract = data.abstractLists[i];\n            abstractLists.push(abstractList);\n            if (!isNullOrUndefined(abstract)) {\n                if (!isNullOrUndefined(abstract.abstractListId)) {\n                    abstractList.abstractListId = abstract.abstractListId;\n                }\n                if (!isNullOrUndefined(abstract.levels)) {\n                    for (var j = 0; j < abstract.levels.length; j++) {\n                        var level = abstract.levels[j];\n                        if (!isNullOrUndefined(level)) {\n                            var listLevel = this.parseListLevel(level, abstractList);\n                            abstractList.levels.push(listLevel);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.parseListLevel = function (data, owner) {\n        var listLevel = new WListLevel(owner);\n        if (data.listLevelPattern === 'Bullet') {\n            listLevel.listLevelPattern = 'Bullet';\n            listLevel.numberFormat = !isNullOrUndefined(data.numberFormat) ? data.numberFormat : '';\n        }\n        else {\n            listLevel.listLevelPattern = data.listLevelPattern;\n            listLevel.startAt = data.startAt;\n            listLevel.numberFormat = !isNullOrUndefined(data.numberFormat) ? data.numberFormat : '';\n            if (data.restartLevel >= 0) {\n                listLevel.restartLevel = data.restartLevel;\n            }\n            else {\n                listLevel.restartLevel = data.levelNumber;\n            }\n        }\n        listLevel.followCharacter = data.followCharacter;\n        this.parseCharacterFormat(data.characterFormat, listLevel.characterFormat);\n        this.parseParagraphFormat(data.paragraphFormat, listLevel.paragraphFormat);\n        return listLevel;\n    };\n    SfdtReader.prototype.parseList = function (data, listCollection) {\n        for (var i = 0; i < data.lists.length; i++) {\n            var list = new WList();\n            var lists = data.lists[i];\n            if (!isNullOrUndefined(lists.abstractListId)) {\n                list.abstractListId = lists.abstractListId;\n                list.abstractList = this.viewer.getAbstractListById(lists.abstractListId);\n            }\n            listCollection.push(list);\n            if (!isNullOrUndefined(lists.listId)) {\n                list.listId = lists.listId;\n            }\n            if (lists.hasOwnProperty('levelOverrides')) {\n                this.parseLevelOverride(lists.levelOverrides, list);\n            }\n        }\n    };\n    SfdtReader.prototype.parseLevelOverride = function (data, list) {\n        if (isNullOrUndefined(data)) {\n            return;\n        }\n        for (var i = 0; i < data.length; i++) {\n            var levelOverrides = new WLevelOverride();\n            var levelOverride = data[i];\n            levelOverrides.startAt = levelOverride.startAt;\n            levelOverrides.levelNumber = levelOverride.levelNumber;\n            if (!isNullOrUndefined(levelOverride.overrideListLevel)) {\n                levelOverrides.overrideListLevel = this.parseListLevel(levelOverride.overrideListLevel, levelOverrides);\n            }\n            list.levelOverrides.push(levelOverrides);\n        }\n    };\n    SfdtReader.prototype.parseSections = function (data, sections) {\n        for (var i = 0; i < data.length; i++) {\n            var section = new BodyWidget();\n            section.sectionFormat = new WSectionFormat(section);\n            section.index = i;\n            var item = data[i];\n            if (!isNullOrUndefined(item.sectionFormat)) {\n                this.parseSectionFormat(item.sectionFormat, section.sectionFormat);\n            }\n            if (isNullOrUndefined(item.headersFooters)) {\n                item.headersFooters = {};\n            }\n            this.viewer.headersFooters.push(this.parseHeaderFooter(item.headersFooters, this.viewer.headersFooters));\n            this.parseTextBody(item.blocks, section);\n            for (var i_1 = 0; i_1 < section.childWidgets.length; i_1++) {\n                section.childWidgets[i_1].containerWidget = section;\n            }\n            sections.push(section);\n        }\n    };\n    /**\n     * @private\n     */\n    SfdtReader.prototype.parseHeaderFooter = function (data, headersFooters) {\n        var hfs = {};\n        if (!isNullOrUndefined(data.header)) {\n            var oddHeader = new HeaderFooterWidget('OddHeader');\n            hfs[0] = oddHeader;\n            this.parseTextBody(data.header.blocks, oddHeader);\n        }\n        if (!isNullOrUndefined(data.footer)) {\n            var oddFooter = new HeaderFooterWidget('OddFooter');\n            hfs[1] = oddFooter;\n            this.parseTextBody(data.footer.blocks, oddFooter);\n        }\n        if (!isNullOrUndefined(data.evenHeader)) {\n            var evenHeader = new HeaderFooterWidget('EvenHeader');\n            hfs[2] = evenHeader;\n            this.parseTextBody(data.evenHeader.blocks, evenHeader);\n        }\n        if (!isNullOrUndefined(data.evenFooter)) {\n            var evenFooter = new HeaderFooterWidget('EvenFooter');\n            hfs[3] = evenFooter;\n            this.parseTextBody(data.evenFooter.blocks, evenFooter);\n        }\n        if (!isNullOrUndefined(data.firstPageHeader)) {\n            var firstPageHeader = new HeaderFooterWidget('FirstPageHeader');\n            hfs[4] = firstPageHeader;\n            this.parseTextBody(data.firstPageHeader.blocks, firstPageHeader);\n        }\n        if (!isNullOrUndefined(data.firstPageFooter)) {\n            var firstPageFooter = new HeaderFooterWidget('FirstPageFooter');\n            hfs[5] = firstPageFooter;\n            this.parseTextBody(data.firstPageFooter.blocks, firstPageFooter);\n        }\n        return hfs;\n    };\n    SfdtReader.prototype.parseTextBody = function (data, section) {\n        this.parseBody(data, section.childWidgets, section);\n    };\n    SfdtReader.prototype.parseBody = function (data, blocks, container) {\n        if (!isNullOrUndefined(data)) {\n            for (var i = 0; i < data.length; i++) {\n                var block = data[i];\n                if (block.hasOwnProperty('inlines')) {\n                    var writeInlineFormat = false;\n                    //writeInlineFormat = this.isPasting && i === data.length - 1;\n                    var paragraph = new ParagraphWidget();\n                    paragraph.characterFormat = new WCharacterFormat(paragraph);\n                    paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n                    this.parseCharacterFormat(block.characterFormat, paragraph.characterFormat);\n                    this.parseParagraphFormat(block.paragraphFormat, paragraph.paragraphFormat);\n                    var styleObj = void 0;\n                    if (!isNullOrUndefined(block.paragraphFormat) && !isNullOrUndefined(block.paragraphFormat.styleName)) {\n                        styleObj = this.viewer.styles.findByName(block.paragraphFormat.styleName, 'Paragraph');\n                        if (!isNullOrUndefined(styleObj)) {\n                            paragraph.paragraphFormat.ApplyStyle(styleObj);\n                        }\n                    }\n                    if (block.inlines.length > 0) {\n                        this.parseParagraph(block.inlines, paragraph, writeInlineFormat);\n                    }\n                    blocks.push(paragraph);\n                    paragraph.index = i;\n                    paragraph.containerWidget = container;\n                }\n                else if (block.hasOwnProperty('rows')) {\n                    this.parseTable(block, blocks, i, container);\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.parseTable = function (block, blocks, index, section) {\n        var table = new TableWidget();\n        table.index = index;\n        table.tableFormat = new WTableFormat(table);\n        if (!isNullOrUndefined(block.tableFormat)) {\n            this.parseTableFormat(block.tableFormat, table.tableFormat);\n        }\n        table.title = block.title;\n        table.description = block.description;\n        for (var i = 0; i < block.rows.length; i++) {\n            var row = new TableRowWidget();\n            row.rowFormat = new WRowFormat(row);\n            var tableRow = block.rows[i];\n            if (tableRow.hasOwnProperty('rowFormat')) {\n                this.parseRowFormat(tableRow.rowFormat, row.rowFormat);\n                this.parseRowGridValues(tableRow, row.rowFormat);\n                this.parseRowGridValues(tableRow.rowFormat, row.rowFormat);\n                row.index = i;\n                for (var j = 0; j < block.rows[i].cells.length; j++) {\n                    var cell = new TableCellWidget();\n                    cell.cellFormat = new WCellFormat(cell);\n                    row.childWidgets.push(cell);\n                    cell.containerWidget = row;\n                    cell.index = j;\n                    cell.rowIndex = i;\n                    if (block.rows[i].cells[j].hasOwnProperty('cellFormat')) {\n                        this.parseCellFormat(block.rows[i].cells[j].cellFormat, cell.cellFormat);\n                    }\n                    this.parseTextBody(block.rows[i].cells[j].blocks, cell);\n                }\n            }\n            table.childWidgets.push(row);\n            row.containerWidget = table;\n        }\n        table.containerWidget = section;\n        blocks.push(table);\n        table.isGridUpdated = false;\n    };\n    SfdtReader.prototype.parseRowGridValues = function (data, rowFormat) {\n        if (!isNullOrUndefined(data.gridBefore)) {\n            rowFormat.gridBefore = data.gridBefore;\n        }\n        if (!isNullOrUndefined(data.gridBeforeWidth)) {\n            rowFormat.gridBeforeWidth = data.gridBeforeWidth;\n        }\n        if (!isNullOrUndefined(data.gridBeforeWidthType)) {\n            rowFormat.gridBeforeWidthType = data.gridBeforeWidthType;\n        }\n        if (!isNullOrUndefined(data.gridAfter)) {\n            rowFormat.gridAfter = data.gridAfter;\n        }\n        if (!isNullOrUndefined(data.gridAfterWidth)) {\n            rowFormat.gridAfterWidth = data.gridAfterWidth;\n        }\n        if (!isNullOrUndefined(data.gridAfterWidthType)) {\n            rowFormat.gridAfterWidthType = data.gridAfterWidthType;\n        }\n    };\n    SfdtReader.prototype.parseParagraph = function (data, paragraph, writeInlineFormat) {\n        var lineWidget = new LineWidget(paragraph);\n        for (var i = 0; i < data.length; i++) {\n            var inline = data[i];\n            if (inline.hasOwnProperty('text')) {\n                var textElement = undefined;\n                if (this.viewer.isPageField) {\n                    textElement = new FieldTextElementBox();\n                    textElement.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                }\n                else if (inline.text === '\\t') {\n                    textElement = new TabElementBox();\n                }\n                else {\n                    textElement = new TextElementBox();\n                }\n                textElement.characterFormat = new WCharacterFormat(textElement);\n                this.parseCharacterFormat(inline.characterFormat, textElement.characterFormat, writeInlineFormat);\n                /*�tslint:disable-next-line:max-line-length */\n                if (!isNullOrUndefined(inline.characterFormat) && !isNullOrUndefined(inline.characterFormat.styleName)) {\n                    var charStyle = this.viewer.styles.findByName(inline.characterFormat.styleName, 'Character');\n                    textElement.characterFormat.ApplyStyle(charStyle);\n                }\n                textElement.text = inline.text;\n                textElement.line = lineWidget;\n                lineWidget.children.push(textElement);\n            }\n            else if (inline.hasOwnProperty('imageString')) {\n                var image = new ImageElementBox(data[i].isInlineImage);\n                image.isMetaFile = data[i].isMetaFile;\n                image.characterFormat = new WCharacterFormat(image);\n                image.line = lineWidget;\n                lineWidget.children.push(image);\n                image.imageString = inline.imageString;\n                image.width = HelperMethods.convertPointToPixel(inline.width);\n                image.height = HelperMethods.convertPointToPixel(inline.height);\n                this.parseCharacterFormat(inline.characterFormat, image.characterFormat);\n            }\n            else if (inline.hasOwnProperty('hasFieldEnd') || (inline.hasOwnProperty('fieldType') && inline.fieldType === 0)) {\n                var fieldBegin = new FieldElementBox(0);\n                fieldBegin.hasFieldEnd = inline.hasFieldEnd;\n                this.viewer.fieldStacks.push(fieldBegin);\n                fieldBegin.line = lineWidget;\n                this.viewer.fields.push(fieldBegin);\n                lineWidget.children.push(fieldBegin);\n            }\n            else if (inline.hasOwnProperty('fieldType')) {\n                var field = undefined;\n                if (inline.fieldType === 2) {\n                    field = new FieldElementBox(2);\n                    this.fieldSeparator = field;\n                    if (this.viewer.fieldStacks.length > 0) {\n                        field.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                        field.fieldBegin.fieldSeparator = field;\n                        //finds the whether the field is page filed or not\n                        var lineWidgetCount = lineWidget.children.length;\n                        if (lineWidgetCount >= 2 && (lineWidget.children[lineWidgetCount - 2] instanceof FieldElementBox)\n                            && lineWidget.children[lineWidgetCount - 2].hasFieldEnd\n                            && (lineWidget.children[lineWidgetCount - 1] instanceof TextElementBox)) {\n                            var fieldElementText = lineWidget.children[lineWidgetCount - 1].text;\n                            if (fieldElementText.match('PAGE')) {\n                                this.viewer.isPageField = true;\n                            }\n                        }\n                    }\n                }\n                else if (inline.fieldType === 1) {\n                    field = new FieldElementBox(1);\n                    //For Field End Updated begin and separator.                                      \n                    if (this.viewer.fieldStacks.length > 0) {\n                        field.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                        field.fieldBegin.fieldEnd = field;\n                    }\n                    if (!isNullOrUndefined(field.fieldBegin) && field.fieldBegin.fieldSeparator) {\n                        field.fieldSeparator = field.fieldBegin.fieldSeparator;\n                        field.fieldBegin.fieldSeparator.fieldEnd = field;\n                    }\n                    //After setting all the property clear the field values\n                    this.viewer.fieldStacks.splice(this.viewer.fieldStacks.length - 1, 1);\n                    this.fieldSeparator = undefined;\n                    this.viewer.isPageField = false;\n                    this.viewer.fieldCollection.push(field.fieldBegin);\n                }\n                field.line = lineWidget;\n                lineWidget.children.push(field);\n            }\n            else if (inline.hasOwnProperty('bookmarkType')) {\n                var bookmark = undefined;\n                bookmark = new BookmarkElementBox(inline.bookmarkType);\n                bookmark.name = inline.name;\n                lineWidget.children.push(bookmark);\n                bookmark.line = lineWidget;\n                if (inline.bookmarkType === 0) {\n                    this.viewer.bookmarks.add(bookmark.name, bookmark);\n                }\n                else if (inline.bookmarkType === 1) {\n                    if (this.viewer.bookmarks.containsKey(bookmark.name)) {\n                        var bookmarkStart = this.viewer.bookmarks.get(bookmark.name);\n                        bookmarkStart.reference = bookmark;\n                        bookmark.reference = bookmarkStart;\n                    }\n                }\n            }\n        }\n        paragraph.childWidgets.push(lineWidget);\n    };\n    SfdtReader.prototype.parseTableFormat = function (sourceFormat, tableFormat) {\n        this.parseBorders(sourceFormat.borders, tableFormat.borders);\n        if (!isNullOrUndefined(sourceFormat.cellSpacing)) {\n            tableFormat.cellSpacing = sourceFormat.cellSpacing;\n        }\n        if (!isNullOrUndefined(sourceFormat.leftMargin)) {\n            tableFormat.leftMargin = sourceFormat.leftMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.topMargin)) {\n            tableFormat.topMargin = sourceFormat.topMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.rightMargin)) {\n            tableFormat.rightMargin = sourceFormat.rightMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.bottomMargin)) {\n            tableFormat.bottomMargin = sourceFormat.bottomMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.leftIndent)) {\n            tableFormat.leftIndent = sourceFormat.leftIndent;\n        }\n        this.parseShading(sourceFormat.shading, tableFormat.shading);\n        if (!isNullOrUndefined(sourceFormat.tableAlignment)) {\n            tableFormat.tableAlignment = sourceFormat.tableAlignment;\n        }\n        if (!isNullOrUndefined(sourceFormat.preferredWidth)) {\n            tableFormat.preferredWidth = sourceFormat.preferredWidth;\n        }\n        if (!isNullOrUndefined(sourceFormat.preferredWidthType)) {\n            tableFormat.preferredWidthType = sourceFormat.preferredWidthType;\n        }\n    };\n    SfdtReader.prototype.parseCellFormat = function (sourceFormat, cellFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            this.parseBorders(sourceFormat.borders, cellFormat.borders);\n            if (!sourceFormat.isSamePaddingAsTable) {\n                //    cellFormat.ClearMargins();\n                //else\n                this.parseCellMargin(sourceFormat, cellFormat);\n            }\n            if (!isNullOrUndefined(sourceFormat.cellWidth)) {\n                cellFormat.cellWidth = sourceFormat.cellWidth;\n            }\n            if (!isNullOrUndefined(sourceFormat.columnSpan)) {\n                cellFormat.columnSpan = sourceFormat.columnSpan;\n            }\n            if (!isNullOrUndefined(sourceFormat.rowSpan)) {\n                cellFormat.rowSpan = sourceFormat.rowSpan;\n            }\n            this.parseShading(sourceFormat.shading, cellFormat.shading);\n            if (!isNullOrUndefined(sourceFormat.verticalAlignment)) {\n                cellFormat.verticalAlignment = sourceFormat.verticalAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.preferredWidthType)) {\n                cellFormat.preferredWidthType = sourceFormat.preferredWidthType;\n            }\n            if (!isNullOrUndefined(sourceFormat.preferredWidth)) {\n                cellFormat.preferredWidth = sourceFormat.preferredWidth;\n            }\n        }\n    };\n    SfdtReader.prototype.parseCellMargin = function (sourceFormat, cellFormat) {\n        if (!isNullOrUndefined(sourceFormat.leftMargin)) {\n            cellFormat.leftMargin = sourceFormat.leftMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.rightMargin)) {\n            cellFormat.rightMargin = sourceFormat.rightMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.topMargin)) {\n            cellFormat.topMargin = sourceFormat.topMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.bottomMargin)) {\n            cellFormat.bottomMargin = sourceFormat.bottomMargin;\n        }\n    };\n    SfdtReader.prototype.parseRowFormat = function (sourceFormat, rowFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (!isNullOrUndefined(sourceFormat.allowBreakAcrossPages)) {\n                rowFormat.allowBreakAcrossPages = sourceFormat.allowBreakAcrossPages;\n            }\n            if (!isNullOrUndefined(sourceFormat.isHeader)) {\n                rowFormat.isHeader = sourceFormat.isHeader;\n            }\n            if (!isNullOrUndefined(sourceFormat.heightType)) {\n                rowFormat.heightType = sourceFormat.heightType;\n            }\n            if (!isNullOrUndefined(sourceFormat.height)) {\n                rowFormat.height = sourceFormat.height;\n            }\n            this.parseBorders(sourceFormat.borders, rowFormat.borders);\n        }\n    };\n    SfdtReader.prototype.parseBorders = function (sourceBorders, destBorder) {\n        if (!isNullOrUndefined(sourceBorders)) {\n            this.parseBorder(sourceBorders.left, destBorder.left);\n            this.parseBorder(sourceBorders.right, destBorder.right);\n            this.parseBorder(sourceBorders.top, destBorder.top);\n            this.parseBorder(sourceBorders.bottom, destBorder.bottom);\n            this.parseBorder(sourceBorders.vertical, destBorder.vertical);\n            this.parseBorder(sourceBorders.horizontal, destBorder.horizontal);\n            this.parseBorder(sourceBorders.diagonalDown, destBorder.diagonalDown);\n            this.parseBorder(sourceBorders.diagonalUp, destBorder.diagonalUp);\n        }\n    };\n    SfdtReader.prototype.parseBorder = function (sourceBorder, destBorder) {\n        if (!isNullOrUndefined(sourceBorder)) {\n            if (!isNullOrUndefined(sourceBorder.color)) {\n                destBorder.color = this.getColor(sourceBorder.color);\n            }\n            if (!isNullOrUndefined(sourceBorder.lineStyle)) {\n                destBorder.lineStyle = sourceBorder.lineStyle;\n            }\n            if (!isNullOrUndefined(sourceBorder.lineWidth)) {\n                destBorder.lineWidth = sourceBorder.lineWidth;\n            }\n            if (!isNullOrUndefined(sourceBorder.hasNoneStyle)) {\n                destBorder.hasNoneStyle = sourceBorder.hasNoneStyle;\n            }\n        }\n    };\n    SfdtReader.prototype.parseShading = function (sourceShading, destShading) {\n        if (!isNullOrUndefined(sourceShading)) {\n            if (!isNullOrUndefined(sourceShading.backgroundColor)) {\n                destShading.backgroundColor = this.getColor(sourceShading.backgroundColor);\n            }\n            if (!isNullOrUndefined(sourceShading.foregroundColor)) {\n                destShading.foregroundColor = this.getColor(sourceShading.foregroundColor);\n            }\n            if (!isNullOrUndefined(sourceShading.texture) || !isNullOrUndefined(sourceShading.textureStyle)) {\n                destShading.textureStyle = !isNullOrUndefined(sourceShading.texture) ? sourceShading.texture : sourceShading.textureStyle;\n            }\n        }\n    };\n    SfdtReader.prototype.parseCharacterFormat = function (sourceFormat, characterFormat, writeInlineFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (writeInlineFormat && sourceFormat.hasOwnProperty('inlineFormat')) {\n                this.parseCharacterFormat(sourceFormat.inlineFormat, characterFormat);\n                return;\n            }\n            if (!isNullOrUndefined(sourceFormat.baselineAlignment)) {\n                characterFormat.baselineAlignment = sourceFormat.baselineAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.underline)) {\n                characterFormat.underline = sourceFormat.underline;\n            }\n            if (!isNullOrUndefined(sourceFormat.strikethrough)) {\n                characterFormat.strikethrough = sourceFormat.strikethrough;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontSize)) {\n                characterFormat.fontSize = sourceFormat.fontSize;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontFamily)) {\n                characterFormat.fontFamily = sourceFormat.fontFamily;\n            }\n            if (!isNullOrUndefined(sourceFormat.bold)) {\n                characterFormat.bold = sourceFormat.bold;\n            }\n            if (!isNullOrUndefined(sourceFormat.italic)) {\n                characterFormat.italic = sourceFormat.italic;\n            }\n            if (!isNullOrUndefined(sourceFormat.highlightColor)) {\n                characterFormat.highlightColor = sourceFormat.highlightColor;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontColor)) {\n                characterFormat.fontColor = this.getColor(sourceFormat.fontColor);\n            }\n        }\n    };\n    SfdtReader.prototype.getColor = function (color) {\n        var convertColor = color;\n        return convertColor || '#ffffff';\n    };\n    SfdtReader.prototype.parseParagraphFormat = function (sourceFormat, paragraphFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (!isNullOrUndefined(sourceFormat.leftIndent)) {\n                paragraphFormat.leftIndent = sourceFormat.leftIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.rightIndent)) {\n                paragraphFormat.rightIndent = sourceFormat.rightIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.firstLineIndent)) {\n                paragraphFormat.firstLineIndent = sourceFormat.firstLineIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.afterSpacing)) {\n                paragraphFormat.afterSpacing = sourceFormat.afterSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.beforeSpacing)) {\n                paragraphFormat.beforeSpacing = sourceFormat.beforeSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.lineSpacing)) {\n                paragraphFormat.lineSpacing = sourceFormat.lineSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.lineSpacingType)) {\n                paragraphFormat.lineSpacingType = sourceFormat.lineSpacingType;\n            }\n            if (!isNullOrUndefined(sourceFormat.textAlignment)) {\n                paragraphFormat.textAlignment = sourceFormat.textAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.outlineLevel)) {\n                paragraphFormat.outlineLevel = sourceFormat.outlineLevel;\n            }\n            paragraphFormat.listFormat = new WListFormat();\n            if (sourceFormat.hasOwnProperty('listFormat')) {\n                this.parseListFormat(sourceFormat, paragraphFormat.listFormat);\n            }\n            if (sourceFormat.hasOwnProperty('tabs')) {\n                this.parseTabStop(sourceFormat.tabs, paragraphFormat.tabs);\n            }\n        }\n    };\n    SfdtReader.prototype.parseListFormat = function (block, listFormat) {\n        if (!isNullOrUndefined(block.listFormat)) {\n            if (!isNullOrUndefined(block.listFormat.listId)) {\n                listFormat.listId = block.listFormat.listId;\n                listFormat.list = this.viewer.getListById(block.listFormat.listId);\n            }\n            if (!isNullOrUndefined(block.listFormat.listLevelNumber)) {\n                listFormat.listLevelNumber = block.listFormat.listLevelNumber;\n            }\n        }\n    };\n    SfdtReader.prototype.parseSectionFormat = function (data, sectionFormat) {\n        if (!isNullOrUndefined(data.pageWidth)) {\n            sectionFormat.pageWidth = data.pageWidth;\n        }\n        if (!isNullOrUndefined(data.pageHeight)) {\n            sectionFormat.pageHeight = data.pageHeight;\n        }\n        if (!isNullOrUndefined(data.leftMargin)) {\n            sectionFormat.leftMargin = data.leftMargin;\n        }\n        if (!isNullOrUndefined(data.topMargin)) {\n            sectionFormat.topMargin = data.topMargin;\n        }\n        if (!isNullOrUndefined(data.rightMargin)) {\n            sectionFormat.rightMargin = data.rightMargin;\n        }\n        if (!isNullOrUndefined(data.bottomMargin)) {\n            sectionFormat.bottomMargin = data.bottomMargin;\n        }\n        if (!isNullOrUndefined(data.headerDistance)) {\n            sectionFormat.headerDistance = data.headerDistance;\n        }\n        if (!isNullOrUndefined(data.footerDistance)) {\n            sectionFormat.footerDistance = data.footerDistance;\n        }\n        if (!isNullOrUndefined(data.differentFirstPage)) {\n            sectionFormat.differentFirstPage = data.differentFirstPage;\n        }\n        if (!isNullOrUndefined(data.differentOddAndEvenPages)) {\n            sectionFormat.differentOddAndEvenPages = data.differentOddAndEvenPages;\n        }\n    };\n    SfdtReader.prototype.parseTabStop = function (wTabs, tabs) {\n        for (var i = 0; i < wTabs.length; i++) {\n            var tabStop = new WTabStop();\n            tabStop.position = wTabs[i].position;\n            tabStop.tabLeader = wTabs[i].tabLeader;\n            tabStop.deletePosition = wTabs[i].deletePosition;\n            tabStop.tabJustification = wTabs[i].tabJustification;\n            tabs.push(tabStop);\n        }\n    };\n    return SfdtReader;\n}());\nexport { SfdtReader };\n","import { WShading } from '../format/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\n/**\n * Selection character format implementation\n */\nvar SelectionCharacterFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionCharacterFormat(selection) {\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.highlightColorIn = undefined;\n        this.fontSizeIn = 0;\n        this.fontColorIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontSize\", {\n        /**\n         * Gets or sets the font size of selected contents.\n         */\n        get: function () {\n            return this.fontSizeIn;\n        },\n        set: function (value) {\n            if (value === this.fontSizeIn) {\n                return;\n            }\n            this.fontSizeIn = value;\n            this.notifyPropertyChanged('fontSize');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontFamily\", {\n        /**\n         * Gets or sets the font family of selected contents.\n         */\n        get: function () {\n            return this.fontFamilyIn;\n        },\n        set: function (value) {\n            if (value === this.fontFamilyIn) {\n                return;\n            }\n            this.fontFamilyIn = value;\n            this.notifyPropertyChanged('fontFamily');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontColor\", {\n        /**\n         * Gets or sets the font color of selected contents.\n         */\n        get: function () {\n            return this.fontColorIn;\n        },\n        set: function (value) {\n            if (value === this.fontColorIn) {\n                return;\n            }\n            this.fontColorIn = value;\n            this.notifyPropertyChanged('fontColor');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"bold\", {\n        /**\n         * Gets or sets the bold formatting of selected contents.\n         */\n        get: function () {\n            return this.boldIn;\n        },\n        set: function (value) {\n            if (value === this.boldIn) {\n                return;\n            }\n            this.boldIn = value;\n            this.notifyPropertyChanged('bold');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"italic\", {\n        /**\n         * Gets or sets the italic formatting of selected contents.\n         */\n        get: function () {\n            return this.italicIn;\n        },\n        set: function (value) {\n            if (value === this.italic) {\n                return;\n            }\n            this.italicIn = value;\n            this.notifyPropertyChanged('italic');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"strikethrough\", {\n        /**\n         * Gets or sets the strikethrough property of selected contents.\n         */\n        get: function () {\n            return this.strikeThroughIn;\n        },\n        set: function (value) {\n            if (value === this.strikeThroughIn) {\n                return;\n            }\n            this.strikeThroughIn = value;\n            this.notifyPropertyChanged('strikethrough');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"baselineAlignment\", {\n        /**\n         * Gets or sets the baseline alignment property of selected contents.\n         */\n        get: function () {\n            return this.baselineAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.baselineAlignmentIn) {\n                return;\n            }\n            this.baselineAlignmentIn = value;\n            this.notifyPropertyChanged('baselineAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"underline\", {\n        /**\n         * Gets or sets the underline style of selected contents.\n         */\n        get: function () {\n            return this.underlineIn;\n        },\n        set: function (value) {\n            if (value === this.underlineIn) {\n                return;\n            }\n            this.underlineIn = value;\n            this.notifyPropertyChanged('underline');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"highlightColor\", {\n        /**\n         * Gets or sets the highlight color of selected contents.\n         */\n        get: function () {\n            return this.highlightColorIn;\n        },\n        set: function (value) {\n            if (value === this.highlightColorIn) {\n                return;\n            }\n            this.highlightColorIn = value;\n            this.notifyPropertyChanged('highlightColor');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionCharacterFormat.prototype.getPropertyValue = function (property) {\n        switch (property) {\n            case 'bold':\n                return this.bold;\n            case 'italic':\n                return this.italic;\n            case 'fontSize':\n                if (this.fontSize >= 1) {\n                    return this.fontSize;\n                }\n                return undefined;\n            case 'fontFamily':\n                return this.fontFamily;\n            case 'strikethrough':\n                return this.strikethrough;\n            case 'baselineAlignment':\n                return this.baselineAlignment;\n            case 'highlightColor':\n                return this.highlightColor;\n            case 'underline':\n                return this.underline;\n            case 'fontColor':\n                return this.fontColor;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Notifies whenever property gets changed.\n     * @param  {string} propertyName\n     */\n    SelectionCharacterFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.selection) && (this.selection.isCleared || this.selection.owner.isReadOnlyMode || !this.selection.owner.isDocumentLoaded || this.selection.owner.isPastingContent) && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var propertyValue = this.getPropertyValue(propertyName);\n            if (!isNullOrUndefined(propertyValue)) {\n                this.selection.owner.editorModule.onApplyCharacterFormat(propertyName, propertyValue);\n            }\n        }\n    };\n    /**\n     * Copies the source format.\n     * @param  {WCharacterFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.copyFormat = function (format) {\n        this.styleName = !isNullOrUndefined(format.baseCharStyle) ? format.baseCharStyle.name : 'Default Paragraph Font';\n        this.fontSize = format.fontSize;\n        this.fontFamily = format.fontFamily;\n        this.bold = format.bold;\n        this.italic = format.italic;\n        this.baselineAlignment = format.baselineAlignment;\n        this.underline = format.underline;\n        this.fontColor = format.fontColor;\n        this.highlightColor = format.highlightColor;\n        this.strikethrough = format.strikethrough;\n    };\n    /**\n     * Combines the format.\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    SelectionCharacterFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.bold) && this.bold !== format.bold) {\n            this.bold = undefined;\n        }\n        if (!isNullOrUndefined(this.italic) && this.italic !== format.italic) {\n            this.italic = undefined;\n        }\n        if (this.fontSize !== 0 && this.fontSize !== format.fontSize) {\n            this.fontSize = 0;\n        }\n        if (!isNullOrUndefined(this.fontFamily) && this.fontFamily !== format.fontFamily) {\n            this.fontFamily = undefined;\n        }\n        if (!isNullOrUndefined(this.highlightColor) && this.highlightColor !== format.highlightColor) {\n            this.highlightColor = undefined;\n        }\n        if (!isNullOrUndefined(this.baselineAlignment) && this.baselineAlignment !== format.baselineAlignment) {\n            this.baselineAlignment = undefined;\n        }\n        if (!isNullOrUndefined(this.fontColor) && (this.fontColor !== format.fontColor)) {\n            this.fontColor = undefined;\n        }\n        if (!isNullOrUndefined(this.underline) && this.underline !== format.underline) {\n            this.underline = undefined;\n        }\n        if (!isNullOrUndefined(this.strikethrough) && this.strikethrough !== format.strikethrough) {\n            this.strikethrough = undefined;\n        }\n    };\n    /**\n     * Clones the format.\n     * @param  {SelectionCharacterFormat} selectionCharacterFormat\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.cloneFormat = function (selectionCharacterFormat) {\n        this.bold = selectionCharacterFormat.bold;\n        this.italic = selectionCharacterFormat.italic;\n        this.underline = selectionCharacterFormat.underline;\n        this.strikethrough = selectionCharacterFormat.strikethrough;\n        this.baselineAlignment = selectionCharacterFormat.baselineAlignment;\n        this.highlightColor = selectionCharacterFormat.highlightColor;\n        this.fontSize = selectionCharacterFormat.fontSize;\n        this.fontFamily = selectionCharacterFormat.fontFamily;\n        this.fontColor = selectionCharacterFormat.fontColor;\n        this.styleName = selectionCharacterFormat.styleName;\n    };\n    /**\n     * Checks whether current format is equal to the source format or not.\n     * @param  {SelectionCharacterFormat} format\n     * @returns boolean\n     * @private\n     */\n    SelectionCharacterFormat.prototype.isEqualFormat = function (format) {\n        return (this.fontSize === format.fontSize\n            && this.strikethrough === format.strikethrough\n            && this.bold === format.bold\n            && this.fontFamily === format.fontFamily\n            && this.underline === format.underline\n            && this.highlightColor === format.highlightColor\n            && this.italic === format.italic\n            && this.baselineAlignment === format.baselineAlignment\n            && this.fontColor === format.fontColor);\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.clearFormat = function () {\n        this.fontSizeIn = 0;\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.fontFamilyIn = undefined;\n        this.fontColorIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.highlightColorIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.styleName = undefined;\n    };\n    /**\n     * Destroys the maintained resources.\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.destroy = function () {\n        this.fontSizeIn = undefined;\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.fontFamilyIn = undefined;\n        this.fontColorIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.highlightColorIn = undefined;\n        this.selection = undefined;\n        this.styleName = undefined;\n    };\n    return SelectionCharacterFormat;\n}());\nexport { SelectionCharacterFormat };\n/**\n * Selection paragraph format implementation\n */\nvar SelectionParagraphFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionParagraphFormat(selection, viewer) {\n        // Declaring the character format properties.\n        this.leftIndentIn = 0;\n        this.rightIndentIn = 0;\n        this.beforeSpacingIn = 0;\n        this.afterSpacingIn = 0;\n        this.textAlignmentIn = undefined;\n        this.firstLineIndentIn = 0;\n        this.lineSpacingIn = 1;\n        this.lineSpacingTypeIn = undefined;\n        this.listLevelNumberIn = -1;\n        this.selection = selection;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"leftIndent\", {\n        /**\n         * Gets or Sets the left indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.leftIndentIn;\n        },\n        set: function (value) {\n            if (value === this.leftIndentIn) {\n                return;\n            }\n            this.leftIndentIn = value;\n            this.notifyPropertyChanged('leftIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"rightIndent\", {\n        /**\n         * Gets or Sets the right indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightIndentIn;\n        },\n        set: function (value) {\n            if (value === this.rightIndentIn) {\n                return;\n            }\n            this.rightIndentIn = value;\n            this.notifyPropertyChanged('rightIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"firstLineIndent\", {\n        /**\n         * Gets or Sets the first line indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.firstLineIndentIn;\n        },\n        set: function (value) {\n            if (value === this.firstLineIndentIn) {\n                return;\n            }\n            this.firstLineIndentIn = value;\n            this.notifyPropertyChanged('firstLineIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"textAlignment\", {\n        /**\n         * Gets or Sets the text alignment for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.textAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.textAlignmentIn) {\n                return;\n            }\n            this.textAlignmentIn = value;\n            this.notifyPropertyChanged('textAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"afterSpacing\", {\n        /**\n         * Gets or Sets the after spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.afterSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.afterSpacingIn) {\n                return;\n            }\n            this.afterSpacingIn = value;\n            this.notifyPropertyChanged('afterSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"beforeSpacing\", {\n        /**\n         * Gets or Sets the before spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.beforeSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.beforeSpacingIn) {\n                return;\n            }\n            this.beforeSpacingIn = value;\n            this.notifyPropertyChanged('beforeSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"lineSpacing\", {\n        /**\n         * Gets or Sets the line spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.lineSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.lineSpacingIn) {\n                return;\n            }\n            this.lineSpacingIn = value;\n            this.notifyPropertyChanged('lineSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"lineSpacingType\", {\n        /**\n         * Gets or Sets the line spacing type for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.lineSpacingTypeIn;\n        },\n        set: function (value) {\n            if (value === this.lineSpacingTypeIn) {\n                return;\n            }\n            this.lineSpacingTypeIn = value;\n            this.notifyPropertyChanged('lineSpacingType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"listLevelNumber\", {\n        /**\n         * Gets or Sets the list level number for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.listLevelNumberIn;\n        },\n        set: function (value) {\n            if (value === this.listLevelNumberIn) {\n                return;\n            }\n            this.listLevelNumberIn = value;\n            this.notifyPropertyChanged('listLevelNumber');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"listText\", {\n        /**\n         * Gets the list text for selected paragraphs.\n         */\n        get: function () {\n            var listFormat = undefined;\n            var list = this.viewer.getListById(this.listId);\n            if (list instanceof WList && this.listLevelNumberIn > -1 && this.listLevelNumberIn < 9) {\n                var listLevel = list.getListLevel(this.listLevelNumber);\n                if (listLevel instanceof WListLevel) {\n                    if (listLevel.listLevelPattern === 'Bullet') {\n                        listFormat = listLevel.numberFormat;\n                    }\n                    else {\n                        listFormat = listLevel.numberFormat;\n                        for (var i = 0; i < 9; i++) {\n                            var levelPattern = '%' + (i + 1);\n                            if (listFormat.indexOf(levelPattern) > -1) {\n                                var level = i === this.listLevelNumberIn ? listLevel : list.getListLevel(i);\n                                var listTextElement = this.selection.getListTextElementBox(this.selection.start.paragraph);\n                                var listText = listTextElement ? listTextElement.text : '';\n                                listFormat = listText;\n                            }\n                        }\n                    }\n                }\n            }\n            return listFormat;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionParagraphFormat.prototype.getPropertyValue = function (property) {\n        switch (property) {\n            case 'leftIndent':\n                return this.leftIndent;\n            case 'rightIndent':\n                return this.rightIndent;\n            case 'firstLineIndent':\n                return this.firstLineIndent;\n            case 'beforeSpacing':\n                return this.beforeSpacing;\n            case 'afterSpacing':\n                return this.afterSpacing;\n            case 'textAlignment':\n                return this.textAlignment;\n            case 'lineSpacing':\n                return this.lineSpacing;\n            case 'lineSpacingType':\n                return this.lineSpacingType;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Notifies whenever the property gets changed.\n     * @param  {string} propertyName\n     */\n    SelectionParagraphFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        if (!isNullOrUndefined(this.selection) &&\n            (this.selection.owner.isReadOnlyMode || !this.selection.owner.isDocumentLoaded)\n            && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var editorModule = this.selection.owner.editorModule;\n            var value = this.getPropertyValue(propertyName);\n            if ((propertyName === 'leftIndent' || propertyName === 'rightIndent' || propertyName === 'firstLineIndent')\n                && !(value >= -1056 && value < 1056)) {\n                return;\n            }\n            if (propertyName === 'listLevelNumber') {\n                editorModule.onApplyListInternal(this.viewer.getListById(this.listId), this.listLevelNumber);\n            }\n            else {\n                editorModule.onApplyParagraphFormat(propertyName, value, propertyName === 'textAlignment' ? true : false, false);\n            }\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WParagraphFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.copyFormat = function (format) {\n        this.styleName = !isNullOrUndefined(format.baseStyle) ? format.baseStyle.name : 'Normal';\n        this.leftIndent = format.leftIndent;\n        this.rightIndent = format.rightIndent;\n        this.firstLineIndent = format.firstLineIndent;\n        this.afterSpacing = format.afterSpacing;\n        this.beforeSpacing = format.beforeSpacing;\n        this.lineSpacing = format.lineSpacing;\n        this.lineSpacingType = format.lineSpacingType;\n        this.textAlignment = format.textAlignment;\n        if (!isNullOrUndefined(format.listFormat) && !isNullOrUndefined(format.listFormat.listId)) {\n            this.listId = format.listFormat.listId;\n            this.listLevelNumber = format.listFormat.listLevelNumber;\n        }\n        else {\n            this.listId = undefined;\n            this.listLevelNumber = 0;\n        }\n    };\n    /**\n     * Copies to format.\n     * @param  {WParagraphFormat} format\n     * @private\n     */\n    SelectionParagraphFormat.prototype.copyToFormat = function (format) {\n        if (isNullOrUndefined(format)) {\n            return;\n        }\n        if (!isNullOrUndefined(this.afterSpacing)) {\n            format.afterSpacing = this.afterSpacing;\n        }\n        if (!isNullOrUndefined(this.beforeSpacing)) {\n            format.beforeSpacing = this.beforeSpacing;\n        }\n        if (!isNullOrUndefined(this.leftIndent)) {\n            format.leftIndent = this.leftIndent;\n        }\n        if (!isNullOrUndefined(this.rightIndent)) {\n            format.rightIndent = this.rightIndent;\n        }\n        if (!isNullOrUndefined(this.textAlignment)) {\n            format.textAlignment = this.textAlignment;\n        }\n        if (!isNullOrUndefined(this.lineSpacing)) {\n            format.lineSpacing = this.lineSpacing;\n        }\n        if (!isNullOrUndefined(this.lineSpacingType)) {\n            format.lineSpacingType = this.lineSpacingType;\n        }\n        if (!isNullOrUndefined(this.firstLineIndent)) {\n            format.firstLineIndent = this.firstLineIndent;\n        }\n    };\n    /**\n     * Combines the format.\n     * @param  {WParagraphFormat} format\n     * @private\n     */\n    SelectionParagraphFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.leftIndent) && this.leftIndent !== format.leftIndent) {\n            this.leftIndent = undefined;\n        }\n        if (!isNullOrUndefined(this.rightIndent) && this.rightIndent !== format.rightIndent) {\n            this.rightIndent = undefined;\n        }\n        if (!isNullOrUndefined(this.firstLineIndent) && this.firstLineIndent !== format.firstLineIndent) {\n            this.firstLineIndent = undefined;\n        }\n        if (this.lineSpacing !== 0 && this.lineSpacing !== format.lineSpacing) {\n            this.lineSpacing = 0;\n        }\n        if (this.beforeSpacing !== -1 && this.beforeSpacing !== format.beforeSpacing) {\n            this.beforeSpacing = -1;\n        }\n        if (this.afterSpacing !== -1 && this.afterSpacing !== format.afterSpacing) {\n            this.afterSpacing = -1;\n        }\n        if (!isNullOrUndefined(this.lineSpacingType) && this.lineSpacingType !== format.lineSpacingType) {\n            this.lineSpacingType = undefined;\n        }\n        if (!isNullOrUndefined(this.textAlignment) && this.textAlignment !== format.textAlignment) {\n            this.textAlignment = undefined;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (this.listLevelNumber >= 0 && !isNullOrUndefined(this.listId) && (isNullOrUndefined(format.listFormat) || format.listFormat.listLevelNumber !== this.listLevelNumber)) {\n            this.listLevelNumber = -1;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(format.listFormat) || isNullOrUndefined(format.listFormat.listId) || (!isNullOrUndefined(this.listId) && this.listId !== format.listFormat.listId)) {\n            this.listId = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.clearFormat = function () {\n        this.leftIndent = 0;\n        this.rightIndent = 0;\n        this.beforeSpacing = 0;\n        this.afterSpacing = 0;\n        this.firstLineIndent = 0;\n        this.lineSpacing = 1;\n        this.textAlignment = undefined;\n        this.lineSpacingType = undefined;\n        this.listId = undefined;\n        this.listLevelNumber = -1;\n        this.styleName = undefined;\n    };\n    /**\n     * Gets the clone of list at current selection.\n     * @returns WList\n     * @private\n     */\n    SelectionParagraphFormat.prototype.getList = function () {\n        var list = this.viewer.getListById(this.listId);\n        if (!isNullOrUndefined(list)) {\n            var listAdv = new WList();\n            var abstractList = new WAbstractList();\n            var currentAbstractList = this.viewer.getAbstractListById(list.abstractListId);\n            var editor = this.selection.owner.editorModule;\n            if (!isNullOrUndefined(currentAbstractList)) {\n                for (var i = 0; i < currentAbstractList.levels.length; i++) {\n                    var level = editor.cloneListLevel(currentAbstractList.levels[i]);\n                    abstractList.levels.push(level);\n                    level.ownerBase = abstractList;\n                }\n            }\n            else {\n                abstractList.levels.push(new WListLevel(abstractList));\n            }\n            if (!isNullOrUndefined(list.levelOverrides)) {\n                for (var i = 0; i < list.levelOverrides.length; i++) {\n                    var levelOverride = editor.cloneLevelOverride(list.levelOverrides[i]);\n                    listAdv.levelOverrides.push(levelOverride);\n                }\n            }\n            listAdv.abstractList = abstractList;\n            listAdv.abstractListId = abstractList.abstractListId;\n            listAdv.sourceListId = list.listId;\n            return listAdv;\n        }\n        return undefined;\n    };\n    /**\n     * Modifies the list at current selection.\n     * @param  {WList} listAdv\n     * @private\n     */\n    SelectionParagraphFormat.prototype.setList = function (listAdv) {\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        var list = this.viewer.getListById(this.listId);\n        var collection = undefined;\n        var currentAbstractList = listAdv ? this.viewer.getAbstractListById(listAdv.abstractListId) : undefined;\n        if (!isNullOrUndefined(list) && !isNullOrUndefined(listAdv)\n            && !isNullOrUndefined(currentAbstractList) && listAdv.sourceListId === list.listId) {\n            var history_1 = this.viewer.owner.editorHistory;\n            var listLevel = this.viewer.layout.getListLevel(list, 1);\n            this.selection.owner.isLayoutEnabled = false;\n            this.viewer.owner.editorModule.setOffsetValue(this.selection);\n            if (history_1) {\n                collection = history_1.updateListChangesInHistory(currentAbstractList, list);\n            }\n            this.viewer.owner.editorModule.updateListParagraphs();\n            if (history_1) {\n                history_1.applyListChanges(this.selection, collection);\n            }\n            this.selection.owner.isLayoutEnabled = true;\n            this.viewer.renderedLists.clear();\n            // this.viewer.pages = [];\n            this.viewer.owner.editorModule.layoutWholeDocument();\n            this.viewer.owner.editorModule.updateSelectionTextPosition(false);\n            if (history_1 && history_1.currentBaseHistoryInfo) {\n                if (history_1.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                    history_1.currentBaseHistoryInfo.updateSelection();\n                }\n                history_1.updateHistory();\n            }\n            this.viewer.owner.editorModule.fireContentChange();\n        }\n        else if (!isNullOrUndefined(listAdv)) {\n            this.selection.owner.isLayoutEnabled = false;\n            if (!isNullOrUndefined(currentAbstractList) && this.viewer.abstractLists.indexOf(currentAbstractList) === -1) {\n                this.viewer.abstractLists.push(currentAbstractList);\n            }\n            if (this.viewer.lists.indexOf(listAdv) === -1) {\n                this.viewer.lists.push(listAdv);\n            }\n            //currentAbstractList.listType = 'Numbering';\n            this.selection.owner.isLayoutEnabled = true;\n            this.selection.owner.editorModule.onApplyList(listAdv);\n        }\n        else {\n            this.selection.owner.editorModule.onApplyList(undefined);\n        }\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.destroy = function () {\n        this.leftIndentIn = undefined;\n        this.rightIndentIn = undefined;\n        this.beforeSpacingIn = undefined;\n        this.afterSpacingIn = undefined;\n        this.firstLineIndentIn = undefined;\n        this.lineSpacingIn = undefined;\n        this.textAlignmentIn = undefined;\n        this.lineSpacingTypeIn = undefined;\n        this.listId = undefined;\n        this.listLevelNumberIn = undefined;\n        this.viewer = undefined;\n        this.selection = undefined;\n        this.styleName = undefined;\n    };\n    return SelectionParagraphFormat;\n}());\nexport { SelectionParagraphFormat };\n/**\n * Selection section format implementation\n */\nvar SelectionSectionFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionSectionFormat(selection) {\n        this.differentFirstPageIn = undefined;\n        this.differentOddAndEvenPagesIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionSectionFormat.prototype, \"pageHeight\", {\n        /**\n         * Gets or sets the page height.\n         */\n        get: function () {\n            return this.pageHeightIn;\n        },\n        set: function (value) {\n            this.pageHeightIn = value;\n            this.notifyPropertyChanged('pageHeight');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"pageWidth\", {\n        /**\n         * Gets or sets the page width.\n         */\n        get: function () {\n            return this.pageWidthIn;\n        },\n        set: function (value) {\n            this.pageWidthIn = value;\n            this.notifyPropertyChanged('pageWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or sets the page left margin.\n         */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or sets the page bottom margin.\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or sets the page top margin.\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or sets the page right margin.\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"headerDistance\", {\n        /**\n         * Gets or sets the header distance.\n         */\n        get: function () {\n            return this.headerDistanceIn;\n        },\n        set: function (value) {\n            this.headerDistanceIn = value;\n            this.notifyPropertyChanged('headerDistance');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"footerDistance\", {\n        /**\n         * Gets or sets the footer distance.\n         */\n        get: function () {\n            return this.footerDistanceIn;\n        },\n        set: function (value) {\n            this.footerDistanceIn = value;\n            this.notifyPropertyChanged('footerDistance');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"differentFirstPage\", {\n        /**\n         * Gets or sets a value indicating whether the section has different first page.\n         */\n        get: function () {\n            return this.differentFirstPageIn;\n        },\n        set: function (value) {\n            this.differentFirstPageIn = value;\n            this.notifyPropertyChanged('differentFirstPage');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"differentOddAndEvenPages\", {\n        /**\n         * Gets or sets a value indicating whether the section has different odd and even page.\n         */\n        get: function () {\n            return this.differentOddAndEvenPagesIn;\n        },\n        set: function (value) {\n            this.differentOddAndEvenPagesIn = value;\n            this.notifyPropertyChanged('differentOddAndEvenPages');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Copies the format.\n     * @param  {WSectionFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.copyFormat = function (format) {\n        this.pageHeight = format.pageHeight;\n        this.pageWidth = format.pageWidth;\n        this.leftMargin = format.leftMargin;\n        this.topMargin = format.topMargin;\n        this.rightMargin = format.rightMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.headerDistance = format.headerDistance;\n        this.footerDistance = format.footerDistance;\n        this.differentFirstPage = format.differentFirstPage;\n        this.differentOddAndEvenPages = format.differentOddAndEvenPages;\n    };\n    SelectionSectionFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection) && (selection.isCleared || selection.owner.isPastingContent\n            || selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded)\n            && !selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(selection) && !isNullOrUndefined(selection.start) && !selection.isRetrieveFormatting) {\n            var value = this.getPropertyvalue(propertyName);\n            if (!isNullOrUndefined(value)) {\n                selection.owner.editorModule.onApplySectionFormat(propertyName, value);\n            }\n        }\n    };\n    SelectionSectionFormat.prototype.getPropertyvalue = function (propertyName) {\n        switch (propertyName) {\n            case 'pageHeight':\n                if (this.pageHeight > 0) {\n                    return this.pageHeight;\n                }\n                return undefined;\n            case 'pageWidth':\n                if (this.pageWidth > 0) {\n                    return this.pageWidth;\n                }\n                return undefined;\n            case 'leftMargin':\n                if (this.leftMargin >= 0) {\n                    return this.leftMargin;\n                }\n                return undefined;\n            case 'rightMargin':\n                if (this.rightMargin >= 0) {\n                    return this.rightMargin;\n                }\n                return undefined;\n            case 'topMargin':\n                if (this.topMargin >= 0) {\n                    return this.topMargin;\n                }\n                return undefined;\n            case 'bottomMargin':\n                if (this.bottomMargin >= 0) {\n                    return this.bottomMargin;\n                }\n                return undefined;\n            case 'differentFirstPage':\n                if (!isNullOrUndefined(this.differentFirstPage)) {\n                    return this.differentFirstPage;\n                }\n                return undefined;\n            case 'differentOddAndEvenPages':\n                if (!isNullOrUndefined(this.differentOddAndEvenPages)) {\n                    return this.differentOddAndEvenPages;\n                }\n                return undefined;\n            case 'headerDistance':\n                return this.headerDistanceIn;\n            case 'footerDistance':\n                return this.footerDistance;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Combines the format.\n     * @param  {WSectionFormat} format\n     * @private\n     */\n    SelectionSectionFormat.prototype.combineFormat = function (format) {\n        if (this.pageHeight > 0 && this.pageHeight !== format.pageHeight) {\n            this.pageHeight = 0;\n        }\n        if (this.pageWidth > 0 && this.pageWidth !== format.pageWidth) {\n            this.pageWidth = 0;\n        }\n        if (this.leftMargin > -1 && this.leftMargin !== format.leftMargin) {\n            this.leftMargin = -1;\n        }\n        if (this.topMargin > -1 && this.topMargin !== format.topMargin) {\n            this.topMargin = -1;\n        }\n        if (this.rightMargin > -1 && this.rightMargin !== format.rightMargin) {\n            this.rightMargin = -1;\n        }\n        if (this.bottomMargin > -1 && this.bottomMargin !== format.bottomMargin) {\n            this.bottomMargin = -1;\n        }\n        if (this.headerDistance !== 0 && this.headerDistance !== format.headerDistance) {\n            this.headerDistance = 0;\n        }\n        if (this.footerDistance !== 0 && this.footerDistance !== format.footerDistance) {\n            this.footerDistance = 0;\n        }\n        if (!isNullOrUndefined(this.differentFirstPage) && this.differentFirstPage !== format.differentFirstPage) {\n            this.differentFirstPage = undefined;\n        }\n        if (!isNullOrUndefined(this.differentOddAndEvenPages) && this.differentOddAndEvenPages !== format.differentOddAndEvenPages) {\n            this.differentOddAndEvenPages = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.clearFormat = function () {\n        this.headerDistance = 0;\n        this.footerDistance = 0;\n        this.pageHeight = 0;\n        this.pageWidth = 0;\n        this.leftMargin = -1;\n        this.rightMargin = -1;\n        this.topMargin = -1;\n        this.bottomMargin = -1;\n        this.differentFirstPage = undefined;\n        this.differentOddAndEvenPages = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.destroy = function () {\n        this.headerDistanceIn = undefined;\n        this.footerDistanceIn = undefined;\n        this.pageHeightIn = undefined;\n        this.pageWidthIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.differentFirstPageIn = undefined;\n        this.differentOddAndEvenPagesIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionSectionFormat;\n}());\nexport { SelectionSectionFormat };\n/**\n * Selection table format implementation\n */\nvar SelectionTableFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionTableFormat(selection) {\n        this.leftIndentIn = 0;\n        this.backgroundIn = undefined;\n        this.tableAlignmentIn = undefined;\n        this.cellSpacingIn = 0;\n        this.leftMarginIn = 0;\n        this.rightMarginIn = 0;\n        this.topMarginIn = 0;\n        this.bottomMarginIn = 0;\n        this.preferredWidthIn = 0;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionTableFormat.prototype, \"table\", {\n        /**\n         * Gets or sets the table.\n         * @private\n         */\n        get: function () {\n            return this.tableIn;\n        },\n        set: function (value) {\n            this.tableIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"leftIndent\", {\n        /**\n         * Gets or Sets the left indent for selected table.\n         * @private\n         */\n        get: function () {\n            return this.leftIndentIn;\n        },\n        set: function (value) {\n            if (value === this.leftIndentIn) {\n                return;\n            }\n            this.leftIndentIn = value;\n            this.notifyPropertyChanged('leftIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or Sets the default top margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            if (value === this.topMarginIn) {\n                return;\n            }\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"background\", {\n        /**\n         * Gets or Sets the background for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.backgroundIn;\n        },\n        set: function (value) {\n            if (value === this.backgroundIn) {\n                return;\n            }\n            this.backgroundIn = value;\n            this.notifyPropertyChanged('background');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"tableAlignment\", {\n        /**\n         * Gets or Sets the table alignment for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.tableAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.tableAlignmentIn) {\n                return;\n            }\n            this.tableAlignmentIn = value;\n            this.notifyPropertyChanged('tableAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or Sets the default left margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            if (value === this.leftMarginIn) {\n                return;\n            }\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or Sets the default bottom margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            if (value === this.bottomMarginIn) {\n                return;\n            }\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"cellSpacing\", {\n        /**\n         * Gets or Sets the cell spacing for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.cellSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.cellSpacingIn) {\n                return;\n            }\n            this.cellSpacingIn = value;\n            this.notifyPropertyChanged('cellSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or Sets the default right margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            if (value === this.rightMarginIn) {\n                return;\n            }\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"preferredWidth\", {\n        /**\n         * Gets or Sets the preferred width for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthIn) {\n                return;\n            }\n            this.preferredWidthIn = value;\n            this.notifyPropertyChanged('preferredWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"preferredWidthType\", {\n        /**\n         * Gets or Sets the preferred width type for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthTypeIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthTypeIn) {\n                return;\n            }\n            this.preferredWidthTypeIn = value;\n            this.notifyPropertyChanged('preferredWidthType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionTableFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'tableAlignment':\n                return this.tableAlignment;\n            case 'leftIndent':\n                return this.leftIndent;\n            case 'cellSpacing':\n                return this.cellSpacing;\n            case 'leftMargin':\n                return this.leftMargin;\n            case 'rightMargin':\n                return this.rightMargin;\n            case 'topMargin':\n                return this.topMargin;\n            case 'bottomMargin':\n                return this.bottomMargin;\n            case 'background':\n                var shading = new WShading();\n                shading.backgroundColor = this.background;\n                return shading;\n            case 'preferredWidth':\n                return this.preferredWidth;\n            case 'preferredWidthType':\n                return this.preferredWidthType;\n            default:\n                return undefined;\n        }\n    };\n    SelectionTableFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        if (!isNullOrUndefined(this.selection) && (this.selection.isCleared\n            || !this.selection.owner.isDocumentLoaded || this.selection.owner.isReadOnlyMode\n            || this.selection.owner.isPastingContent) && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var value = this.getPropertyValue(propertyName);\n            if (propertyName === 'background') {\n                propertyName = 'shading';\n            }\n            if (!isNullOrUndefined(value)) {\n                this.selection.owner.editorModule.onApplyTableFormat(propertyName, value);\n            }\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WTableFormat} format Format to copy.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.copyFormat = function (format) {\n        this.leftIndent = format.leftIndent;\n        this.background = format.shading.backgroundColor;\n        this.tableAlignment = format.tableAlignment;\n        this.leftMargin = format.leftMargin;\n        this.rightMargin = format.rightMargin;\n        this.topMargin = format.topMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.cellSpacing = format.cellSpacing;\n        this.preferredWidth = format.preferredWidth;\n        this.preferredWidthType = format.preferredWidthType;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.clearFormat = function () {\n        this.table = undefined;\n        this.leftIndent = 0;\n        this.background = undefined;\n        this.leftIndent = 0;\n        this.leftMargin = 0;\n        this.rightMargin = 0;\n        this.topMargin = 0;\n        this.bottomMargin = 0;\n        this.cellSpacing = 0;\n        this.tableAlignment = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.destroy = function () {\n        this.leftIndentIn = undefined;\n        this.backgroundIn = undefined;\n        this.leftIndentIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.cellSpacingIn = undefined;\n        this.tableAlignmentIn = undefined;\n        this.tableIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionTableFormat;\n}());\nexport { SelectionTableFormat };\n/**\n * Selection cell format implementation\n */\nvar SelectionCellFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionCellFormat(selection) {\n        this.verticalAlignmentIn = undefined;\n        this.leftMarginIn = 0;\n        this.rightMarginIn = 0;\n        this.topMarginIn = 0;\n        this.bottomMarginIn = 0;\n        this.backgroundIn = undefined;\n        this.preferredWidthTypeIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionCellFormat.prototype, \"verticalAlignment\", {\n        /**\n         * Gets or sets the vertical alignment of the selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.verticalAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.verticalAlignmentIn) {\n                return;\n            }\n            this.verticalAlignmentIn = value;\n            this.notifyPropertyChanged('verticalAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or Sets the left margin for selected cells.\n         * @default undefined\n         */\n        /* tslint:disable */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            if (value === this.leftMarginIn) {\n                return;\n            }\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or Sets the right margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            if (value === this.rightMarginIn) {\n                return;\n            }\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or Sets the top margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            if (value === this.topMarginIn) {\n                return;\n            }\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or Sets the bottom margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            if (value === this.bottomMarginIn) {\n                return;\n            }\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"background\", {\n        /**\n         * Gets or Sets the background for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.backgroundIn;\n        },\n        /* tslint:enable */\n        set: function (value) {\n            if (value === this.backgroundIn) {\n                return;\n            }\n            this.backgroundIn = value;\n            this.notifyPropertyChanged('background');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"preferredWidthType\", {\n        /* tslint:disable */\n        /**\n         * Gets or Sets the preferred width type for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthTypeIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthTypeIn) {\n                return;\n            }\n            this.preferredWidthTypeIn = value;\n            this.notifyPropertyChanged('preferredWidthType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"preferredWidth\", {\n        /**\n         * Gets or Sets the preferred width  for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthIn) {\n                return;\n            }\n            this.preferredWidthIn = value;\n            this.notifyPropertyChanged('preferredWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /* tslint:enable */\n    SelectionCellFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection)) {\n            if ((selection.isCleared || !selection.owner.isDocumentLoaded\n                || selection.owner.isReadOnlyMode || selection.owner.isPastingContent) && !selection.isRetrieveFormatting) {\n                return;\n            }\n            if (!isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n                var value = this.getPropertyValue(propertyName);\n                if (propertyName === 'background') {\n                    propertyName = 'shading';\n                }\n                if (!isNullOrUndefined(value)) {\n                    this.selection.owner.editorModule.onApplyTableCellFormat(propertyName, value);\n                }\n            }\n        }\n    };\n    SelectionCellFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'verticalAlignment':\n                return this.verticalAlignment;\n            case 'leftMargin':\n                return this.leftMargin;\n            case 'rightMargin':\n                return this.rightMargin;\n            case 'topMargin':\n                return this.topMargin;\n            case 'bottomMargin':\n                return this.bottomMargin;\n            case 'preferredWidth':\n                return this.preferredWidth;\n            case 'preferredWidthType':\n                return this.preferredWidthType;\n            case 'background':\n                var shading = new WShading();\n                shading.backgroundColor = this.background;\n                return shading;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WCellFormat} format Source Format to copy.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.copyFormat = function (format) {\n        this.leftMargin = format.leftMargin;\n        this.rightMargin = format.rightMargin;\n        this.topMargin = format.topMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.background = format.shading.backgroundColor;\n        this.verticalAlignment = format.verticalAlignment;\n        this.preferredWidth = format.preferredWidth;\n        this.preferredWidthType = format.preferredWidthType;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.clearCellFormat = function () {\n        this.leftMargin = undefined;\n        this.rightMargin = undefined;\n        this.topMargin = undefined;\n        this.bottomMargin = undefined;\n        this.background = undefined;\n        this.verticalAlignment = undefined;\n    };\n    /**\n     * Combines the format.\n     * @param  {WCellFormat} format\n     * @private\n     */\n    SelectionCellFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.leftMargin) && this.leftMargin !== format.leftMargin) {\n            this.leftMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.topMargin) && this.topMargin !== format.topMargin) {\n            this.topMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.rightMargin) && this.rightMargin !== format.rightMargin) {\n            this.rightMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.bottomMargin) && this.bottomMargin !== format.bottomMargin) {\n            this.bottomMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.background) && this.background !== format.shading.backgroundColor) {\n            this.background = undefined;\n        }\n        if (!isNullOrUndefined(this.verticalAlignment) && this.verticalAlignment !== format.verticalAlignment) {\n            this.verticalAlignment = undefined;\n        }\n        if (!isNullOrUndefined(this.preferredWidth) && this.preferredWidth !== format.preferredWidth) {\n            this.preferredWidth = undefined;\n        }\n        if (!isNullOrUndefined(this.preferredWidthType) && this.preferredWidthType !== format.preferredWidthType) {\n            this.preferredWidthType = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.clearFormat = function () {\n        this.background = undefined;\n        this.bottomMargin = 0;\n        this.leftMargin = 0;\n        this.rightMargin = 0;\n        this.topMargin = 0;\n        this.verticalAlignment = undefined;\n    };\n    /**\n     * Destroys the manages resources.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.destroy = function () {\n        this.backgroundIn = undefined;\n        this.verticalAlignmentIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionCellFormat;\n}());\nexport { SelectionCellFormat };\n/**\n * Selection row format implementation\n */\nvar SelectionRowFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionRowFormat(selection) {\n        this.heightIn = undefined;\n        this.heightTypeIn = undefined;\n        this.isHeaderIn = undefined;\n        this.allowRowBreakAcrossPagesIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionRowFormat.prototype, \"height\", {\n        /**\n         * Gets or Sets the height for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.heightIn;\n        },\n        set: function (value) {\n            if (value === this.heightIn) {\n                return;\n            }\n            this.heightIn = value;\n            this.notifyPropertyChanged('height');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"heightType\", {\n        /**\n         * Gets or Sets the height type for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.heightTypeIn;\n        },\n        set: function (value) {\n            if (value === this.heightTypeIn) {\n                return;\n            }\n            this.heightTypeIn = value;\n            this.notifyPropertyChanged('heightType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"isHeader\", {\n        /**\n         * Gets or Sets a value indicating whether the selected rows are header rows or not.\n         * @default undefined\n         */\n        get: function () {\n            return this.isHeaderIn;\n        },\n        set: function (value) {\n            if (value === this.isHeaderIn) {\n                return;\n            }\n            this.isHeaderIn = value;\n            this.notifyPropertyChanged('isHeader');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"allowBreakAcrossPages\", {\n        /**\n         * Gets or Sets a value indicating whether to allow break across pages for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.allowRowBreakAcrossPagesIn;\n        },\n        set: function (value) {\n            if (value === this.allowRowBreakAcrossPagesIn) {\n                return;\n            }\n            this.allowRowBreakAcrossPagesIn = value;\n            this.notifyPropertyChanged('allowBreakAcrossPages');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionRowFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection) && (selection.isCleared || selection.owner.isReadOnlyMode\n            || !selection.owner.isDocumentLoaded || selection.owner.isPastingContent) && !selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(selection) && !isNullOrUndefined(selection.start) && !selection.isRetrieveFormatting) {\n            var value = this.getPropertyValue(propertyName);\n            if (!isNullOrUndefined(value)) {\n                selection.owner.editorModule.onApplyTableRowFormat(propertyName, value);\n            }\n        }\n    };\n    SelectionRowFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'height':\n                return this.height;\n            case 'heightType':\n                return this.heightType;\n            case 'isHeader':\n                return this.isHeader;\n            case 'allowBreakAcrossPages':\n                return this.allowBreakAcrossPages;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WRowFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.copyFormat = function (format) {\n        this.height = format.height;\n        this.heightType = format.heightType;\n        this.allowBreakAcrossPages = format.allowBreakAcrossPages;\n        this.isHeader = format.isHeader;\n    };\n    /**\n     * Combines the format.\n     * @param  {WRowFormat} format\n     * @private\n     */\n    SelectionRowFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.height) && this.height !== format.height) {\n            this.height = undefined;\n        }\n        if (!isNullOrUndefined(this.heightType) && this.heightType !== format.heightType) {\n            this.heightType = undefined;\n        }\n        if (!isNullOrUndefined(this.allowBreakAcrossPages) && this.allowBreakAcrossPages !== format.allowBreakAcrossPages) {\n            this.allowBreakAcrossPages = undefined;\n        }\n        if (!isNullOrUndefined(this.isHeader) && this.isHeader !== format.isHeader) {\n            this.isHeader = undefined;\n        }\n    };\n    /**\n     * Clears the row format.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.clearRowFormat = function () {\n        this.height = undefined;\n        this.heightType = undefined;\n        this.allowBreakAcrossPages = undefined;\n        this.isHeader = undefined;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.clearFormat = function () {\n        this.height = 0;\n        this.heightType = undefined;\n        this.allowBreakAcrossPages = undefined;\n        this.isHeader = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.destroy = function () {\n        this.heightIn = undefined;\n        this.heightTypeIn = undefined;\n        this.allowRowBreakAcrossPagesIn = undefined;\n        this.isHeaderIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionRowFormat;\n}());\nexport { SelectionRowFormat };\n/**\n * Selection image format implementation\n */\nvar SelectionImageFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionImageFormat(selection) {\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionImageFormat.prototype, \"width\", {\n        /**\n         * Gets the width of the image.\n         */\n        get: function () {\n            if (this.image) {\n                return this.image.width;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionImageFormat.prototype, \"height\", {\n        /**\n         * Gets the height of the image.\n         */\n        get: function () {\n            if (this.image) {\n                return this.image.height;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Resizes the image based on given size.\n     * @param width\n     * @param height\n     */\n    SelectionImageFormat.prototype.resize = function (width, height) {\n        this.updateImageFormat(width, height);\n    };\n    /**\n     * Update image width and height\n     * @private\n     */\n    SelectionImageFormat.prototype.updateImageFormat = function (width, height) {\n        if (this.image) {\n            if (this.selection.owner.editorModule) {\n                this.selection.owner.editorModule.onImageFormat(this.image, width, height);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    SelectionImageFormat.prototype.copyImageFormat = function (image) {\n        this.image = image;\n    };\n    /**\n     * @private\n     */\n    SelectionImageFormat.prototype.clearImageFormat = function () {\n        this.image = undefined;\n    };\n    return SelectionImageFormat;\n}());\nexport { SelectionImageFormat };\n/* tslint:enable */ \n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar HtmlExport = /** @class */ (function () {\n    function HtmlExport() {\n        /* tslint:disable:no-any */\n        this.document = undefined;\n        /* tslint:disable:no-any */\n        /**\n         * @private\n         */\n        this.fieldCheck = 0;\n        /* tslint:enable:no-any */\n    }\n    /* tslint:disable:no-any */\n    /**\n     * @private\n     */\n    HtmlExport.prototype.writeHtml = function (document) {\n        this.document = document;\n        var html = '';\n        for (var i = 0; i < document.sections.length; i++) {\n            html = this.serializeSection(document.sections[i]);\n        }\n        return html;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeSection = function (section) {\n        var string = '';\n        for (var i = 0; i < section.blocks.length; i++) {\n            var block = section.blocks[i];\n            if (block.hasOwnProperty('inlines')) {\n                string += this.serializeParagraph(block);\n            }\n            else {\n                string += this.serializeTable(block);\n            }\n        }\n        return string;\n    };\n    // Serialize Paragraph \n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraph = function (paragraph) {\n        var blockStyle = '';\n        var startString = undefined;\n        var isList = false;\n        var tagAttributes = [];\n        tagAttributes.push('style=\"' + this.serializeParagraphStyle(paragraph, '', isList) + '\"');\n        blockStyle += this.createAttributesTag('p', tagAttributes);\n        if (paragraph.inlines.length === 0) {\n            //Handled to preserve non breaking space for empty paragraphs similar to MS Word behavior.\n            blockStyle += '&nbsp;';\n        }\n        else {\n            blockStyle = this.serializeInlines(paragraph, blockStyle);\n        }\n        blockStyle += this.endTag('p');\n        return blockStyle;\n    };\n    //SerializeInlines\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeInlines = function (paragraph, blockStyle) {\n        var inline = undefined;\n        var i = 0;\n        while (paragraph.inlines.length > i) {\n            inline = paragraph.inlines[i];\n            if (inline.hasOwnProperty('imageString')) {\n                blockStyle += this.serializeImageContainer(inline);\n            }\n            else if (inline.hasOwnProperty('fieldType')) {\n                if (inline.fieldType === 0) {\n                    this.fieldCheck = 1;\n                    var tagAttributes = [];\n                    tagAttributes.push('style=\"' + this.serializeInlineStyle(inline.characterFormat, '') + '\"');\n                    blockStyle += this.createAttributesTag('a', tagAttributes);\n                }\n                else if (inline.fieldType === 2) {\n                    this.fieldCheck = 2;\n                }\n                else {\n                    blockStyle += this.endTag('a');\n                    this.fieldCheck = 0;\n                }\n            }\n            else {\n                var text = isNullOrUndefined(inline.text) ? '' : inline.text;\n                if (this.fieldCheck === 0) {\n                    blockStyle += this.serializeSpan(text, inline.characterFormat);\n                }\n                if (this.fieldCheck === 1) {\n                    var hyperLink = text.replace('\\\"', '');\n                    blockStyle += ' href= \\\"' + hyperLink.replace('HYPERLINK', '').trim();\n                    blockStyle += '\\\"';\n                    blockStyle += '>';\n                }\n                if (this.fieldCheck === 2) {\n                    blockStyle += text;\n                }\n            }\n            i++;\n        }\n        return blockStyle;\n    };\n    // Serialize Span\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeSpan = function (spanText, characterFormat) {\n        var spanClass = '';\n        if (spanText.indexOf('\\v') !== -1) {\n            spanClass += '<br>';\n            return spanClass.toString();\n        }\n        var tagAttributes = [];\n        this.serializeInlineStyle(characterFormat, '');\n        tagAttributes.push('style=\"' + this.serializeInlineStyle(characterFormat, '') + '\"');\n        spanClass += this.createAttributesTag('span', tagAttributes);\n        var ignoreFirstSpace = false;\n        // Todo: Need to handle it.\n        // If the text starts with white-space, need to check whether it is a continuous space.\n        // if (characterFormat.ownerBase instanceof WInline) {\n        //     let inline: WInline = (characterFormat.ownerBase as WInline);\n        //     tslint:disable:max-line-length            \n        //     if (inline instanceof WSpan && !isNullOrUndefined(inline.text) && inline.text !== '' && (inline as WSpan).text[0] === ' ') {\n        //         Check previous inline until, it has valid rendered text.\n        //         do {\n        //             inline = WInline.getPreviousTextInline((inline as WSpan));\n        //         } while (inline instanceof WSpan && !isNullOrUndefined(inline.text));\n        //     } else {\n        //         inline = undefined;\n        //     }\n        //     If current white-space is a continuation of consecutive spaces, this will be set true.\n        //     ignoreFirstSpace = inline instanceof WSpan && !isNullOrUndefined(inline.text)\n        //         && (inline as WSpan).text[(inline as WSpan).text.length - 1] === ' ';\n        // }\n        var text = this.decodeHtmlNames(spanText.toString());\n        spanClass += text;\n        spanClass += this.endTag('span');\n        return spanClass.toString();\n    };\n    //Serialize Image\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeImageContainer = function (image) {\n        var imageStyle = '';\n        var tagAttributes = [];\n        this.serializeInlineStyle(image.characterFormat, '');\n        var imageSource = '';\n        if (!isNullOrUndefined(image.imageString)) {\n            imageSource = image.imageString;\n        }\n        var width = HelperMethods.convertPointToPixel(image.width);\n        var height = HelperMethods.convertPointToPixel(image.height);\n        tagAttributes.push('width=\"', width.toString() + '\"');\n        tagAttributes.push('height=\"', height.toString() + '\"');\n        tagAttributes.push('src=\"', imageSource + '\"');\n        imageStyle += this.createAttributesTag('img', tagAttributes);\n        imageStyle += (this.endTag('img'));\n        return imageStyle.toString();\n    };\n    // Serialize Table Cell\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCell = function (cell) {\n        var blockStyle = '';\n        var tagAttributes = [];\n        var cellHtml = '';\n        tagAttributes = [];\n        if (!isNullOrUndefined(cell.cellFormat)) {\n            //if (cell.cellFormat.shading.backgroundColor !== Color.FromArgb(0, 0, 0, 0)) {\n            tagAttributes.push('bgcolor=\"' + cell.cellFormat.shading.backgroundColor + '\"');\n            // }\n            if (cell.cellFormat.columnSpan > 1) {\n                tagAttributes.push('colspan=\"' + cell.cellFormat.columnSpan.toString() + '\"');\n            }\n            if (cell.cellFormat.rowSpan > 1) {\n                tagAttributes.push('rowspan=\"' + cell.cellFormat.rowSpan.toString() + '\"');\n            }\n            if (cell.cellFormat.cellWidth !== 0) {\n                tagAttributes.push('width=\"' + cell.cellFormat.cellWidth.toString() + '\"');\n            }\n            if (cell.cellFormat.verticalAlignment !== 'Top') {\n                tagAttributes.push('valign=\"' + cell.cellFormat.verticalAlignment.toString().toLowerCase() + '\"');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.leftMargin) && cell.cellFormat.leftMargin !== 0) {\n                cellHtml += ('padding-left:' + cell.cellFormat.leftMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.rightMargin) && cell.cellFormat.rightMargin !== 0) {\n                cellHtml += ('padding-right:' + cell.cellFormat.rightMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.topMargin) && cell.cellFormat.topMargin !== 0) {\n                cellHtml += ('padding-top:' + cell.cellFormat.topMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.bottomMargin) && cell.cellFormat.bottomMargin !== 0) {\n                cellHtml += ('padding-bottom:' + cell.cellFormat.bottomMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.borders)) {\n                cellHtml += this.serializeCellBordersStyle(cell.cellFormat.borders);\n            }\n        }\n        if (cellHtml.length !== 0) {\n            tagAttributes.push('style=\"' + cellHtml + '\"');\n        }\n        blockStyle += (this.createAttributesTag('td', tagAttributes));\n        for (var k = 0; k < cell.blocks.length; k++) {\n            var block = cell.blocks[k];\n            if (block.hasOwnProperty('rows')) {\n                blockStyle += this.serializeTable(block);\n            }\n            else {\n                blockStyle += this.serializeParagraph(block);\n            }\n        }\n        blockStyle += (this.endTag('td'));\n        return blockStyle;\n    };\n    // Serialize Table\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeTable = function (table) {\n        var html = '';\n        html += this.createTableStartTag(table);\n        for (var j = 0; j < table.rows.length; j++) {\n            html += this.serializeRow(table.rows[j]);\n        }\n        html += this.createTableEndTag();\n        return html;\n    };\n    // Serialize Row\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeRow = function (row) {\n        var html = '';\n        html += this.createRowStartTag(row);\n        for (var k = 0; k < row.cells.length; k++) {\n            html += this.serializeCell(row.cells[k]);\n        }\n        return html;\n    };\n    // Serialize Styles\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraphStyle = function (paragraph, className, isList) {\n        var paragraphClass = '';\n        paragraphClass += this.serializeCharacterFormat(paragraph.characterFormat);\n        paragraphClass += this.serializeParagraphFormat(paragraph.paragraphFormat, isList);\n        return paragraphClass;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeInlineStyle = function (characterFormat, className) {\n        return this.serializeCharacterFormat(characterFormat);\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeTableBorderStyle = function (borders) {\n        var borderStyle = '';\n        borderStyle += ('border-left-style:' + this.convertBorderLineStyle(borders.left.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-left-width:' + borders.left.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-left-color:' + borders.left.color);\n        borderStyle += ';';\n        borderStyle += ('border-right-style:' + this.convertBorderLineStyle(borders.right.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-right-width:' + borders.right.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-right-color:' + borders.right.color);\n        borderStyle += ';';\n        borderStyle += ('border-top-style:' + this.convertBorderLineStyle(borders.top.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-top-width:' + borders.top.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-top-color:' + borders.top.color);\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-style:' + this.convertBorderLineStyle(borders.bottom.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-width:' + borders.bottom.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-color:' + borders.bottom.color);\n        borderStyle += ';';\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCellBordersStyle = function (borders) {\n        var borderStyle = '';\n        borderStyle = 'border:solid 1px;';\n        // Todo: handle\n        // let border: WBorder = undefined;\n        // //LeftBorder\n        // border = WCell.getCellLeftBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'left');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-left-style:none;');\n        // }\n        // //RightBorder\n        // border = WCell.getCellRightBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'right');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-right-style:none');\n        // }\n        // //TopBorder\n        // border = WCell.getCellTopBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'top');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-top-style:none');\n        // }\n        // //BottomBorder\n        // border = WCell.getCellBottomBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'bottom');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-bottom-style:none');\n        // }\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeBorderStyle = function (border, borderPosition) {\n        var borderStyle = '';\n        borderStyle += ('border-' + borderPosition + '-style:' + this.convertBorderLineStyle(border.lineStyle));\n        borderStyle += ';';\n        if (border.lineWidth > 0) {\n            borderStyle += ('border-' + borderPosition + '-width:' + border.lineWidth.toString() + 'pt;');\n        }\n        //if (border.color !== Color.FromArgb(0, 0, 0, 0))\n        borderStyle += ('border-' + borderPosition + '-color:' + border.color + ';');\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.convertBorderLineStyle = function (lineStyle) {\n        switch (lineStyle) {\n            case 'None':\n                return 'none';\n            case 'Single':\n                return 'solid';\n            case 'Dot':\n                return 'dotted';\n            case 'DashSmallGap':\n            case 'DashLargeGap':\n            case 'DashDot':\n            case 'DashDotDot':\n                return 'dashed';\n            case 'Double':\n            case 'Triple':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n                return 'double';\n            case 'SingleWavy':\n                return 'solid';\n            case 'DoubleWavy':\n                return 'double';\n            case 'DashDotStroked':\n                return 'solid';\n            case 'Emboss3D':\n                return 'ridge';\n            case 'Engrave3D':\n                return 'groove';\n            case 'Outset':\n                return 'outset';\n            case 'Inset':\n                return 'inset';\n            default:\n                return 'solid';\n        }\n    };\n    // Serialize Format\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCharacterFormat = function (characterFormat) {\n        if (!isNullOrUndefined(characterFormat.inlineFormat)) {\n            return this.serializeCharacterFormat(characterFormat.inlineFormat);\n        }\n        var propertyValue;\n        var charStyle = '';\n        if (characterFormat.bold) {\n            charStyle += 'font-weight';\n            charStyle += ':';\n            charStyle += 'bold';\n            charStyle += ';';\n        }\n        charStyle += 'font-style';\n        charStyle += ':';\n        if (characterFormat.italic) {\n            charStyle += 'italic';\n        }\n        else {\n            charStyle += 'normal';\n        }\n        charStyle += ';';\n        // Double strike through will become Single strike through while saving HTML using MS Word.\n        if (characterFormat.strikethrough === 'SingleStrike' || characterFormat.strikethrough === 'DoubleStrike') {\n            charStyle += 'text-decoration';\n            charStyle += ':';\n            charStyle += 'line-through';\n            charStyle += ';';\n        }\n        //Text Baseline Alignment\n        // tslint:disable-next-line:max-line-length\n        if (characterFormat.baselineAlignment === 'Superscript' || characterFormat.baselineAlignment === 'Subscript') {\n            charStyle += 'vertical-align';\n            charStyle += ':';\n            charStyle += characterFormat.baselineAlignment === 'Superscript' ? 'super' : 'sub';\n            charStyle += ';';\n        }\n        //Text Foreground and Background Color \n        if (!isNullOrUndefined(characterFormat.highlightColor)) {\n            charStyle += 'background-color';\n            charStyle += ':';\n            charStyle += characterFormat.highlightColor.toString();\n            charStyle += ';';\n        }\n        //Font Color\n        propertyValue = characterFormat.fontColor;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'color';\n            charStyle += ':';\n            charStyle += propertyValue;\n            charStyle += ';';\n        }\n        if (!isNullOrUndefined(characterFormat.underline) && characterFormat.underline !== 'None') {\n            charStyle += 'text-decoration';\n            charStyle += ':';\n            charStyle += 'underline';\n            charStyle += ';';\n        }\n        propertyValue = characterFormat.fontSize;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'font-size';\n            charStyle += ':';\n            charStyle += propertyValue.toString();\n            charStyle += 'pt';\n            charStyle += ';';\n        }\n        propertyValue = characterFormat.fontFamily;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'font-family';\n            charStyle += ':';\n            charStyle += propertyValue.toString();\n            charStyle += ';';\n        }\n        return charStyle.toString();\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraphFormat = function (paragraphFormat, isList) {\n        if (!isNullOrUndefined(paragraphFormat.inlineFormat)) {\n            return this.serializeParagraphFormat(paragraphFormat.inlineFormat, isList);\n        }\n        var propertyValue;\n        var paraStyle = '';\n        propertyValue = paragraphFormat.textAlignment;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'text-align:' + propertyValue.toLowerCase() + ';';\n        }\n        propertyValue = paragraphFormat.beforeSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-top:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.rightIndent;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-right:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.afterSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-bottom:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.leftIndent;\n        if (isList) {\n            if (isNullOrUndefined(propertyValue)) {\n                propertyValue = -48;\n            }\n            else {\n                propertyValue -= 48;\n            }\n        }\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-left:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.firstLineIndent;\n        if (isList) {\n            if (isNullOrUndefined(propertyValue)) {\n                propertyValue = 24;\n            }\n            else {\n                propertyValue += 24;\n            }\n        }\n        if (!isNullOrUndefined(propertyValue) && propertyValue !== 0) {\n            paraStyle += 'text-indent:' + propertyValue.toString() + 'pt;';\n        }\n        propertyValue = paragraphFormat.lineSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            if (paragraphFormat.lineSpacingType === 'Multiple') {\n                propertyValue = (propertyValue * 100).toString() + '%;';\n            }\n            else {\n                propertyValue = propertyValue.toString() + 'pt;';\n            }\n            paraStyle += 'line-height:' + propertyValue;\n        }\n        return paraStyle.toString();\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createAttributesTag = function (tagValue, localProperties) {\n        var sb = '';\n        sb += '<';\n        sb += tagValue;\n        for (var i = 0; i < localProperties.length; i++) {\n            sb += ' ';\n            sb += localProperties[i];\n        }\n        if (tagValue !== 'a') {\n            sb += '>';\n        }\n        return sb;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTag = function (tagValue) {\n        var s = '';\n        s += '<';\n        s += tagValue;\n        s += '>';\n        return s;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.endTag = function (tagValue) {\n        var sb = '';\n        sb += '<';\n        sb += '/';\n        sb += tagValue;\n        sb += '>';\n        return sb;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTableStartTag = function (table) {\n        var blockStyle = '';\n        var tableStyle = '';\n        var tagAttributes = [];\n        tagAttributes.push('border=\"' + '1\"');\n        if (!isNullOrUndefined(table.tableFormat)) {\n            //if (table.tableFormat.shading.backgroundColor !== Color.FromArgb(0, 0, 0, 0)) {\n            tagAttributes.push('bgcolor=\"' + table.tableFormat.shading.backgroundColor + '\"');\n            //}\n            if (table.tableFormat.leftIndent !== 0) {\n                tagAttributes.push('left-indent=\"' + table.tableFormat.leftIndent.toString() + 'pt;');\n            }\n            if (table.tableFormat.cellSpacing > 0) {\n                tagAttributes.push('cellspacing=\"' + (((table.tableFormat.cellSpacing * 72) / 96) * 2).toString() + '\"');\n            }\n            else {\n                tableStyle += ('border-collapse:collapse;');\n            }\n            tagAttributes.push('cellpadding=\"' + '0\"');\n            if (!isNullOrUndefined(table.tableFormat.borders)) {\n                tableStyle += this.serializeTableBorderStyle(table.tableFormat.borders);\n            }\n        }\n        if (tableStyle.length !== 0) {\n            tagAttributes.push('style=\"', tableStyle.toString() + '\"');\n        }\n        return blockStyle += (this.createAttributesTag('table', tagAttributes));\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTableEndTag = function () {\n        var blockStyle = '';\n        blockStyle += (this.endTag('table'));\n        return blockStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createRowStartTag = function (row) {\n        var blockStyle = '';\n        var tagAttributes = [];\n        if (row.rowFormat.isHeader) {\n            blockStyle += (this.createTag('thead'));\n        }\n        if (row.rowFormat.height > 0) {\n            tagAttributes.push('height=\"' + row.rowFormat.height + '\"');\n        }\n        return blockStyle + this.createAttributesTag('tr', tagAttributes);\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createRowEndTag = function (row) {\n        var blockStyle = '';\n        blockStyle += (this.endTag('tr'));\n        if (row.rowFormat.isHeader) {\n            blockStyle += (this.endTag('thead'));\n        }\n        return blockStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.decodeHtmlNames = function (text) {\n        if (text === '\\t') {\n            return '&emsp;';\n        }\n        var splittedText = text.split(' ');\n        var htmlText = '';\n        if (splittedText.length > 0) {\n            htmlText = splittedText[0];\n            for (var i = 0; i < splittedText.length - 1; i++) {\n                htmlText += '&nbsp;' + splittedText[i + 1];\n            }\n        }\n        return htmlText;\n    };\n    return HtmlExport;\n}());\nexport { HtmlExport };\n","import { Widget, TableRowWidget, TableWidget, LineWidget, ElementBox, TextElementBox, ListTextElementBox, ImageElementBox, ParagraphWidget, TableCellWidget, FieldElementBox, BlockContainer, BookmarkElementBox } from '../index';\nimport { HelperMethods } from '../index';\nimport { Point } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar TextPosition = /** @class */ (function () {\n    function TextPosition(owner) {\n        /**\n         * @private\n         */\n        this.location = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.isUpdateLocation = true;\n        this.owner = owner;\n        this.viewer = this.owner.viewer;\n    }\n    Object.defineProperty(TextPosition.prototype, \"paragraph\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.currentWidget.paragraph;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"isAtParagraphStart\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.offset === this.owner.selection.getStartOffset(this.paragraph);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"isAtParagraphEnd\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.selection.isParagraphLastLine(this.currentWidget)\n                && this.offset === this.owner.selection.getLineLength(this.currentWidget);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"selection\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.selection;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"hierarchicalPosition\", {\n        /**\n         * Gets the hierarchical position of logical text position in the document\n         * @returns {string}\n         */\n        get: function () {\n            return this.getHierarchicalIndexInternal();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Return clone of current text position\n     * @private\n     */\n    TextPosition.prototype.clone = function () {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.currentWidget = this.currentWidget;\n        textPosition.offset = this.offset;\n        textPosition.location = this.location;\n        return textPosition;\n    };\n    /**\n     * Set text position for paragraph and inline\n     * @private\n     */\n    TextPosition.prototype.setPositionForSelection = function (line, element, index, physicalLocation) {\n        //Set the start end position\n        var isParagraphEnd = false;\n        if (isNullOrUndefined(element)) {\n            this.currentWidget = line;\n        }\n        else {\n            this.currentWidget = element.line;\n            if (element.nextNode instanceof FieldElementBox && index > element.length) {\n                isParagraphEnd = this.selection.isLastRenderedInline(element, element.length);\n            }\n        }\n        this.location = physicalLocation;\n        if (isParagraphEnd) {\n            this.offset = this.selection.getParagraphLength(this.currentWidget.paragraph) + 1;\n        }\n        else {\n            this.offset = this.currentWidget.getOffset(element, index);\n        }\n    };\n    /**\n     * Set text position\n     * @private\n     */\n    TextPosition.prototype.setPositionFromLine = function (line, offset, location) {\n        this.currentWidget = line;\n        this.offset = offset;\n        if (location instanceof Point) {\n            this.location.copy(location);\n        }\n    };\n    /**\n     * Set text position\n     * @private\n     */\n    TextPosition.prototype.setPosition = function (line, positionAtStart) {\n        this.currentWidget = line;\n        this.offset = positionAtStart ? this.selection.getStartOffset(line.paragraph)\n            : this.selection.getParagraphLength(line.paragraph) + 1;\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Set position for text position\n     * @private\n     */\n    TextPosition.prototype.setPositionInternal = function (textPosition) {\n        this.currentWidget = textPosition.currentWidget;\n        this.offset = textPosition.offset;\n        this.location = textPosition.location;\n    };\n    /**\n     * Set position for current index\n     * @private\n     */\n    TextPosition.prototype.setPositionForCurrentIndex = function (hierarchicalIndex) {\n        var index = { index: hierarchicalIndex };\n        var paragraph = this.getParagraphWidget(index); //ref hierarchicalIndex\n        this.offset = parseFloat(index.index);\n        this.setPositionParagraph(paragraph, this.offset);\n    };\n    /**\n     * Get Page\n     */\n    TextPosition.prototype.getPage = function (position) {\n        var page;\n        var index = position.index.indexOf(';');\n        var newValue = '0';\n        if (index >= 0) {\n            newValue = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        index = parseInt(newValue, 10);\n        page = this.viewer.pages[index];\n        return page;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getParagraphWidget = function (position) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        var page = this.getPage(position);\n        var child = this.getLineWidget(undefined, position, page);\n        return child;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getLineWidget = function (widget, position, page) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        var index = position.index.indexOf(';');\n        var value = '0';\n        if (index >= 0) {\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        if (value === 'H' || value === 'F') {\n            if (value === 'H') {\n                widget = page.headerWidget;\n            }\n            else {\n                widget = page.footerWidget;\n            }\n        }\n        else if (!isNullOrUndefined(page)) {\n            widget = page.bodyWidgets[0];\n        }\n        index = parseInt(value, 10);\n        if (widget instanceof BlockContainer) {\n            index = position.index.indexOf(';');\n            value = '0';\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n            index = parseInt(value, 10);\n        }\n        if (widget instanceof TableRowWidget && index >= widget.childWidgets.length) {\n            position.index = '0;0';\n            index = widget.childWidgets.length - 1;\n        }\n        if (index >= 0 && index < widget.childWidgets.length) {\n            var child = widget.childWidgets[index];\n            if (child instanceof LineWidget) {\n                if (position.index.indexOf(';') > 0) {\n                    position.index = '0';\n                }\n                return child;\n            }\n            if (child instanceof Widget) {\n                if (position.index.indexOf(';') > 0) {\n                    return this.getLineWidget(child, position);\n                }\n                else {\n                    //If table is shifted to previous text position then return the first paragraph within table.\n                    if (child instanceof TableWidget) {\n                        return this.getLineWidget(this.selection.getFirstParagraphInFirstCell(child), position);\n                    }\n                    else if (child instanceof TableRowWidget && position.index.indexOf(';') === -1) {\n                        return this.selection.getFirstParagraphInFirstCell(child.ownerTable).childWidgets[0];\n                    }\n                    return undefined;\n                }\n            }\n        }\n        else if (widget.nextRenderedWidget instanceof Widget) {\n            position.index = '0';\n            if (widget.nextRenderedWidget instanceof TableWidget) {\n                return this.selection.getFirstParagraphInFirstCell(widget.nextRenderedWidget).firstChild;\n            }\n            return this.getLineWidget(widget.nextRenderedWidget, position);\n        }\n        return undefined;\n    };\n    /**\n     * Update physical location of paragraph\n     * @private\n     */\n    TextPosition.prototype.updatePhysicalPosition = function (moveNextLine) {\n        if (this.currentWidget && this.owner.isLayoutEnabled && this.isUpdateLocation) {\n            this.location = this.selection.getPhysicalPositionInternal(this.currentWidget, this.offset, moveNextLine);\n        }\n    };\n    /**\n     * Return true if text position are in same paragraph and offset\n     * @private\n     */\n    TextPosition.prototype.isAtSamePosition = function (textPosition) {\n        return this.currentWidget === textPosition.currentWidget\n            && this.offset === textPosition.offset;\n    };\n    /**\n     * Return true if text position is in same paragraph\n     * @private\n     */\n    TextPosition.prototype.isInSameParagraph = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        return this.paragraph === textPosition.paragraph;\n    };\n    /**\n     * Return true is current text position exist before given text position\n     * @private\n     */\n    TextPosition.prototype.isExistBefore = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        if (this.currentWidget === textPosition.currentWidget) {\n            return this.offset < textPosition.offset;\n        }\n        var currentParagraph = this.currentWidget.paragraph;\n        var paragraph = textPosition.currentWidget.paragraph;\n        if (currentParagraph === paragraph) {\n            return currentParagraph.childWidgets.indexOf(this.currentWidget) < paragraph.childWidgets.indexOf(textPosition.currentWidget);\n        }\n        if (currentParagraph.containerWidget === paragraph.containerWidget) {\n            if (currentParagraph.isInsideTable) {\n                return currentParagraph.associatedCell.childWidgets.indexOf(currentParagraph) <\n                    paragraph.associatedCell.childWidgets.indexOf(paragraph);\n                //handle after header footer implementation\n                // } else if ((this.currentParagraph).owner instanceof WHeaderFooter) {\n                //     return ((this.currentParagraph).owner as WHeaderFooter).blocks.indexOf((this.currentParagraph)) <\n                //         ((textPosition.currentParagraph).owner as WHeaderFooter).blocks.indexOf((textPosition.currentParagraph));\n            }\n            else {\n                return (currentParagraph.containerWidget.childWidgets.indexOf(currentParagraph)) <\n                    (paragraph.containerWidget.childWidgets.indexOf(paragraph));\n            }\n        }\n        return this.owner.selection.isExistBefore(currentParagraph, paragraph);\n    };\n    /**\n     * Return true is current text position exist after given text position\n     * @private\n     */\n    TextPosition.prototype.isExistAfter = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        if (this.currentWidget === textPosition.currentWidget) {\n            return this.offset > textPosition.offset;\n        }\n        if (this.currentWidget.paragraph === textPosition.currentWidget.paragraph) {\n            return this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget) >\n                textPosition.currentWidget.paragraph.childWidgets.indexOf(textPosition.currentWidget);\n        }\n        var startParagraph = this.currentWidget.paragraph;\n        var endParagraph = textPosition.currentWidget.paragraph;\n        if (startParagraph.containerWidget.index === endParagraph.containerWidget.index) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) >\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n                // } else if ((this.currentParagraph).owner instanceof WHeaderFooter) {\n                //     return ((this.currentParagraph).owner as WHeaderFooter).blocks.indexOf((this.currentParagraph)) >\n                //         ((textPosition.currentParagraph).owner as WHeaderFooter).blocks.indexOf((textPosition.currentParagraph));\n            }\n            else {\n                return (startParagraph.containerWidget.childWidgets.indexOf(startParagraph) >\n                    (endParagraph.containerWidget.childWidgets.indexOf(endParagraph)));\n            }\n        }\n        return this.owner.selection.isExistAfter(startParagraph, endParagraph);\n    };\n    /**\n     * Return hierarchical index of current text position\n     * @private\n     */\n    TextPosition.prototype.getHierarchicalIndexInternal = function () {\n        return this.getHierarchicalIndex(this.currentWidget, this.offset.toString());\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getHierarchicalIndex = function (line, hierarchicalIndex) {\n        var node = line;\n        if (node) {\n            return node.getHierarchicalIndex(hierarchicalIndex);\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.setPositionParagraph = function (line, offsetInLine) {\n        this.currentWidget = line;\n        this.offset = offsetInLine;\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.setPositionForLineWidget = function (lineWidget, offset) {\n        var lineLength = this.selection.getLineLength(lineWidget);\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        if (lineWidget.isLastLine()) {\n            lineLength = lineLength + 1;\n        }\n        if (offset > lineLength) {\n            var nextLineWidget = void 0;\n            if (lineIndex >= lineWidget.paragraph.childWidgets.length - 1) {\n                var nextBlock = this.selection.getNextRenderedBlock(lineWidget.paragraph);\n                if (nextBlock && nextBlock.index === lineWidget.paragraph.index) {\n                    nextLineWidget = nextBlock.firstChild;\n                }\n            }\n            else {\n                nextLineWidget = lineWidget.paragraph.childWidgets[lineIndex + 1];\n            }\n            this.setPositionForLineWidget(nextLineWidget, offset - lineLength);\n            return;\n        }\n        else if (offset < 0) {\n            var prevLine = lineWidget.paragraph.childWidgets[lineIndex - 1];\n            var currentOffSet = this.selection.getLineLength(prevLine) + offset;\n            this.setPositionForLineWidget(prevLine, currentOffSet);\n            return;\n        }\n        else {\n            this.currentWidget = lineWidget;\n            this.offset = offset;\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * move to next text position\n     * @private\n     */\n    TextPosition.prototype.moveNextPosition = function (isNavigate) {\n        if (isNullOrUndefined(isNavigate)) {\n            isNavigate = true;\n        }\n        var inline = this.selection.getNextStartInline(this.currentWidget, this.offset);\n        if (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n            if (isNavigate) {\n                this.moveNextPositionInternal(inline);\n                this.moveNextPosition();\n                return;\n            }\n            else {\n                var line = inline.fieldEnd.line;\n                var fieldEnd = inline.fieldEnd;\n                var fieldEndOffset = line.getOffset(fieldEnd, 1);\n                var fieldEndIndex = this.getHierarchicalIndex(line, fieldEndOffset.toString());\n                if (TextPosition.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(), fieldEndIndex)) {\n                    //If field end is after selection end, extend selection end to field end.\n                    this.selection.end.moveToInline(inline.fieldEnd, 1);\n                    return;\n                }\n                this.moveToInline(inline.fieldEnd, 1);\n            }\n        }\n        var nextOffset = this.selection.getNextValidOffset(this.currentWidget, this.offset);\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        var index = 0;\n        if (nextOffset > this.offset) {\n            this.offset = nextOffset;\n            var info = this.currentWidget.getInline(this.offset, index);\n            inline = info.element;\n            index = info.index;\n            if (!isNullOrUndefined(inline) && index === inline.length && inline.nextNode instanceof FieldElementBox) {\n                var nextValidInline = this.selection.getNextValidElement(inline.nextNode);\n                //Moves to field end mark.\n                if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 1) {\n                    inline = nextValidInline;\n                    this.offset = this.currentWidget.getOffset(inline, 1);\n                }\n            }\n        }\n        else if (lineIndex + 1 < this.paragraph.childWidgets.length) {\n            var nextLineWidget = this.paragraph.childWidgets[lineIndex + 1];\n            if (nextLineWidget) {\n                this.currentWidget = nextLineWidget;\n                this.offset = this.selection.getStartLineOffset(this.currentWidget);\n            }\n            var inlineObj = this.currentWidget.getInline(this.offset, index);\n            inline = inlineObj.element;\n            index = inlineObj.index;\n            if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                this.offset++;\n            }\n        }\n        else {\n            this.updateOffsetToNextParagraph(index, false);\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move text position to previous paragraph inside table\n     * @private\n     */\n    TextPosition.prototype.moveToPreviousParagraphInTable = function (selection) {\n        var previousParagraph;\n        var currentPara = this.currentWidget.paragraph;\n        if (currentPara.isInsideTable) {\n            previousParagraph = selection.getPreviousSelectionCell(currentPara.associatedCell);\n        }\n        else {\n            previousParagraph = selection.getPreviousParagraphBlock(currentPara);\n        }\n        if (isNullOrUndefined(previousParagraph)) {\n            return;\n        }\n        this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n        this.offset = this.currentWidget.getEndOffset() + 1;\n    };\n    TextPosition.prototype.updateOffsetToNextParagraph = function (indexInInline, isHighlight) {\n        //Moves to owner and get next paragraph.\n        var inline;\n        var positionAtStart = false;\n        var nextParagraph = undefined;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        if (!isHighlight) {\n            nextParagraph = this.selection.getNextParagraphBlock(this.paragraph);\n        }\n        else if (lineIndex + 1 < this.paragraph.childWidgets.length) {\n            var nextLineWidget = this.paragraph.childWidgets[lineIndex + 1];\n            if (nextLineWidget) {\n                this.currentWidget = nextLineWidget;\n                this.offset = 0;\n            }\n        }\n        else {\n            nextParagraph = this.selection.getNextSelectionBlock(this.paragraph);\n            if (!isNullOrUndefined(nextParagraph)) {\n                if (nextParagraph.containerWidget instanceof TableCellWidget) {\n                    if (this.selection.start.paragraph.isInsideTable) {\n                        // tslint:disable-next-line:max-line-length\n                        var containerCell = this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell, nextParagraph.associatedCell);\n                        positionAtStart = !containerCell.ownerTable.contains(nextParagraph.associatedCell);\n                    }\n                    else {\n                        positionAtStart = true;\n                    }\n                }\n            }\n        }\n        if (!isNullOrUndefined(nextParagraph) && nextParagraph.childWidgets.length > 0) {\n            if (!positionAtStart) {\n                this.currentWidget = nextParagraph.firstChild;\n                this.offset = isHighlight ? 1 : this.selection.getStartLineOffset(this.currentWidget);\n            }\n            else {\n                this.currentWidget = nextParagraph.childWidgets[nextParagraph.childWidgets.length - 1];\n                this.offset = this.selection.getLineLength(this.currentWidget) + 1;\n            }\n        }\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            this.offset++;\n        }\n    };\n    TextPosition.prototype.updateOffsetToPrevPosition = function (index, isHighlight) {\n        var inlineInfo;\n        var inline;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        var prevOffset = this.selection.getPreviousValidOffset(this.currentWidget.paragraph, this.offset);\n        if (this.offset > prevOffset) {\n            this.offset = prevOffset;\n        }\n        else if (lineIndex > 0) {\n            var prevLineWidget = this.paragraph.childWidgets[lineIndex - 1];\n            if (prevLineWidget) {\n                this.currentWidget = prevLineWidget;\n                this.offset = this.currentWidget.getEndOffset();\n            }\n        }\n        else {\n            //Moves to owner and get previous paragraph.\n            var previousParagraph = undefined;\n            var positionAtStart = false;\n            if (!isHighlight) {\n                previousParagraph = this.selection.getPreviousParagraphBlock(this.paragraph);\n            }\n            else {\n                previousParagraph = this.selection.getPreviousSelectionBlock(this.paragraph);\n                if (!isNullOrUndefined(previousParagraph)) {\n                    if (previousParagraph.containerWidget instanceof TableCellWidget) {\n                        if (this.selection.start.paragraph.isInsideTable) {\n                            // tslint:disable-next-line:max-line-length\n                            var containerCell = this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell, previousParagraph.associatedCell);\n                            positionAtStart = !containerCell.ownerTable.contains(previousParagraph.associatedCell);\n                        }\n                        else {\n                            positionAtStart = true;\n                        }\n                    }\n                }\n            }\n            if (!isNullOrUndefined(previousParagraph)) {\n                if (!positionAtStart) {\n                    this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n                    this.offset = this.currentWidget.getEndOffset();\n                }\n                else {\n                    this.currentWidget = previousParagraph.firstChild;\n                    this.offset = this.selection.getStartLineOffset(this.currentWidget);\n                }\n            }\n        }\n        index = 0;\n        inlineInfo = this.currentWidget.getInline(this.offset, index);\n        inline = inlineInfo.element;\n        index = inlineInfo.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            this.offset++;\n        }\n        if (inline instanceof FieldElementBox) {\n            //Checks if field character is part of rendered field, otherwise moves to previous rendered content.\n            var previousInline = this.selection.getPreviousValidElement(inline);\n            if (!isNullOrUndefined(previousInline)) {\n                inline = previousInline;\n                this.currentWidget = inline.line;\n                this.offset = this.currentWidget.getOffset(inline, inline.length);\n                if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                    this.offset--;\n                }\n            }\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Moves the text position to start of the next paragraph.\n     */\n    TextPosition.prototype.moveToNextParagraphStartInternal = function () {\n        var paragraph = this.currentWidget.paragraph;\n        if (!isNullOrUndefined(this.selection.getNextParagraphBlock(paragraph))) {\n            // tslint:disable-next-line:max-line-length\n            this.currentWidget = this.selection.getNextParagraphBlock(paragraph).firstChild;\n            this.offset = this.selection.getStartOffset(paragraph);\n            this.updatePhysicalPosition(true);\n        }\n    };\n    /**\n     * Move to previous position\n     * @private\n     */\n    TextPosition.prototype.movePreviousPosition = function () {\n        var index = 0;\n        var inlineInfo = this.currentWidget.getInline(this.offset, index);\n        var inline = inlineInfo.element;\n        index = inlineInfo.index;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n            this.movePreviousPositionInternal(inline);\n        }\n        this.updateOffsetToPrevPosition(index, false);\n    };\n    /**\n     * Move to next position\n     * @private\n     */\n    TextPosition.prototype.moveNextPositionInternal = function (fieldBegin) {\n        var inline;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            inline = fieldBegin.fieldEnd;\n        }\n        else {\n            inline = fieldBegin.fieldSeparator;\n            this.currentWidget = inline.line;\n            // tslint:disable-next-line:max-line-length\n            if (this.currentWidget === fieldBegin.fieldEnd.line && !this.selection.hasValidInline(this.paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n        }\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, 1);\n    };\n    /**\n     * Move text position backward\n     * @private\n     */\n    TextPosition.prototype.moveBackward = function () {\n        var indexInInline = 0;\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!this.owner.selection.isEmpty && !isNullOrUndefined(inline)) {\n            var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n            if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n                var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n                // tslint:disable-next-line:max-line-length\n                var fieldEndOffset = nextInline.fieldEnd.line.getOffset(nextInline.fieldEnd, 1);\n                // tslint:disable-next-line:max-line-length\n                var fieldEndIndex = this.getHierarchicalIndex(nextInline.fieldEnd.line, fieldEndOffset.toString());\n                if (!TextPosition.isForwardSelection(fieldEndIndex, hierarchicalIndex)) {\n                    //If field end is after selection start, move selection start to field end.\n                    // tslint:disable-next-line:max-line-length\n                    this.owner.selection.start.setPositionParagraph(nextInline.fieldEnd.line, fieldEndOffset);\n                    return;\n                }\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n            var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n            var fieldEndOffset = inline.line.getOffset(inline, 1);\n            var fieldEndIndex = this.getHierarchicalIndex(inline.line, fieldEndOffset.toString());\n            if (!TextPosition.isForwardSelection(hierarchicalIndex, fieldEndIndex)) {\n                //If field end is after selection start, extend selection end to field begin.\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginOffset = inline.fieldBegin.line.getOffset(inline.fieldBegin, 0);\n                this.currentWidget = inline.fieldBegin.line;\n                this.offset = fieldBeginOffset;\n                //Updates physical position in current page.\n                this.updatePhysicalPosition(true);\n                return;\n            }\n            this.movePreviousPositionInternal(inline);\n        }\n        this.updateOffsetToPrevPosition(indexInInline, true);\n    };\n    /**\n     * Move text position forward\n     * @private\n     */\n    TextPosition.prototype.moveForward = function () {\n        var indexInInline = 0;\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!isNullOrUndefined(inline)) {\n            if (!this.owner.selection.isEmpty && indexInInline === inline.length && inline instanceof FieldElementBox\n                && inline.fieldType === 1) {\n                var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginOffset = inline.fieldBegin.line.getOffset(inline.fieldBegin, 0);\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginIndex = this.getHierarchicalIndex(inline.fieldBegin.line, fieldBeginOffset.toString());\n                if (!TextPosition.isForwardSelection(hierarchicalIndex, fieldBeginIndex)) {\n                    //If field begin is before selection start, move selection start to field begin.\n                    // tslint:disable-next-line:max-line-length\n                    this.owner.selection.start.setPositionParagraph(inline.fieldBegin.line, fieldBeginOffset);\n                    return;\n                }\n            }\n            inline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n        }\n        if (inline instanceof FieldElementBox && !isNullOrUndefined(inline.fieldEnd)) {\n            var selectionStartParagraph = this.owner.selection.start.paragraph;\n            var selectionStartIndex = 0;\n            // tslint:disable-next-line:max-line-length\n            var selectionStartInlineObj = selectionStartParagraph.getInline(this.owner.selection.start.offset, selectionStartIndex);\n            var selectionStartInline = selectionStartInlineObj.element;\n            selectionStartIndex = selectionStartInlineObj.index;\n            var nextRenderInline = this.selection.getNextRenderedElementBox(selectionStartInline, selectionStartIndex);\n            if (nextRenderInline === inline) {\n                this.moveNextPositionInternal(inline);\n            }\n            else {\n                //If selection start is before field begin, extend selection end to field end.\n                inline = inline.fieldEnd;\n                this.currentWidget = inline.line;\n                this.offset = this.currentWidget.getOffset(inline, 1);\n                //Updates physical position in current page.\n                this.updatePhysicalPosition(true);\n                return;\n            }\n        }\n        else if ((inline instanceof FieldElementBox)\n            && (inline.fieldType === 0 || inline.fieldType === 1)) {\n            this.currentWidget = inline.line;\n            this.offset = this.currentWidget.getOffset(inline, 1);\n        }\n        indexInInline = 0;\n        var nextOffset = this.selection.getNextValidOffset(this.currentWidget, this.offset);\n        var length = this.selection.getLineLength(this.currentWidget);\n        var isParagraphEnd = this.selection.isParagraphLastLine(this.currentWidget);\n        if (this.offset < nextOffset) {\n            this.offset = nextOffset;\n            var inlineObj_1 = this.currentWidget.getInline(this.offset, indexInInline);\n            inline = inlineObj_1.element;\n            indexInInline = inlineObj_1.index;\n            if (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n                var nextValidInline = this.selection.getNextValidElement(inline.nextNode);\n                //Moves to field end mark.\n                if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 1) {\n                    inline = nextValidInline;\n                    this.offset = this.currentWidget.getOffset(inline, 1);\n                }\n            }\n        }\n        else if (this.offset === nextOffset && this.offset < length + 1 && isParagraphEnd) {\n            this.offset = length + 1;\n        }\n        else {\n            this.updateOffsetToNextParagraph(indexInInline, true);\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move to given inline\n     * @private\n     */\n    TextPosition.prototype.moveToInline = function (inline, index) {\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, index);\n        //Updates physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Return true is start element exist before end element\n     * @private\n     */\n    TextPosition.isForwardSelection = function (start, end) {\n        if (start === end) {\n            return true;\n        }\n        start = start.replace(/C;/g, '');\n        end = end.replace(/C;/g, '');\n        start = start.replace(/H;/g, '');\n        end = end.replace(/H;/g, '');\n        start = start.replace(/F;/g, '');\n        end = end.replace(/F;/g, '');\n        var selectionStart = start.split(';');\n        var selectionEnd = end.split(';');\n        var length = selectionStart.length;\n        if (length > selectionEnd.length) {\n            length = selectionEnd.length - 1;\n        }\n        for (var i = 0; i < length; i++) {\n            var startOffset = parseFloat(selectionStart[i]);\n            var endOffset = parseFloat(selectionEnd[i]);\n            if (startOffset !== endOffset) {\n                return startOffset < endOffset;\n            }\n        }\n        return false;\n    };\n    /**\n     * Move to previous position offset\n     * @private\n     */\n    TextPosition.prototype.movePreviousPositionInternal = function (fieldEnd) {\n        var inline;\n        if (isNullOrUndefined(fieldEnd.fieldSeparator)) {\n            inline = this.selection.getPreviousValidElement(fieldEnd.fieldBegin);\n        }\n        else {\n            inline = this.selection.getPreviousValidElement(fieldEnd);\n        }\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, inline instanceof FieldElementBox ? 0 : inline.length);\n    };\n    /**\n     * Moves the text position to start of the word.\n     * @private\n     */\n    TextPosition.prototype.moveToWordStartInternal = function (type) {\n        var endOffset = this.currentWidget.getEndOffset();\n        var currentPara = this.currentWidget.paragraph;\n        var selection = this.selection;\n        if (type === 2 && (this.offset === endOffset || this.offset === endOffset + 1)) {\n            return;\n        }\n        if (this.offset === endOffset + 1) {\n            this.offset = endOffset;\n        }\n        else if (this.offset === selection.getStartOffset(currentPara) && this.currentWidget === currentPara.childWidgets[0]) {\n            var previousParagraph = selection.getPreviousParagraphBlock(currentPara);\n            if (isNullOrUndefined(previousParagraph)) {\n                return;\n            }\n            this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n            this.offset = this.currentWidget.getEndOffset();\n        }\n        else {\n            if (this.offset === selection.getStartLineOffset(this.currentWidget)) {\n                var lineIndex = currentPara.childWidgets.indexOf(this.currentWidget);\n                if (lineIndex - 1 >= 0) {\n                    this.currentWidget = currentPara.childWidgets[lineIndex - 1];\n                    this.offset = this.currentWidget.getEndOffset();\n                }\n            }\n            var isStarted = false;\n            var endSelection = false;\n            var indexInInline = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            // tslint:disable-next-line:max-line-length           \n            this.getPreviousWordOffset(inline, selection, indexInInline, type, (inline instanceof FieldElementBox && inline.fieldType === 1), isStarted, endSelection, this);\n        }\n        if (type === 1) {\n            this.calculateOffset();\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Get next word offset\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffset = function (inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (inline instanceof TextElementBox) {\n            this.getNextWordOffsetSpan(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof ImageElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetImage(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldBegin(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2 || inline instanceof BookmarkElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldSeperator(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldEnd(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from field begin\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldBegin = function (fieldBegin, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        var startOffset = fieldBegin.line.getOffset(fieldBegin, 0);\n        var endOffset = startOffset + fieldBegin.length;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            this.getNextWordOffsetFieldEnd(fieldBegin.fieldEnd, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (type === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldSeperator(fieldBegin.fieldSeparator, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (!isNullOrUndefined(fieldBegin.fieldEnd)) {\n            var inline = fieldBegin.fieldSeparator;\n            // tslint:disable-next-line:max-line-length\n            if (inline.line.paragraph === fieldBegin.fieldEnd.line.paragraph && !this.selection.hasValidInline(inline.line.paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffset(inline, 0, type, !(endPosition.paragraph === fieldBegin.line.paragraph && endPosition.offset === startOffset), endSelection, endPosition, excludeSpace);\n            // tslint:disable-next-line:max-line-length\n            if (endSelection && !isNullOrUndefined(fieldBegin.fieldSeparator) && (endPosition.paragraph === fieldBegin.line.paragraph) && (endPosition.offset === fieldBegin.fieldSeparator.line.getOffset(fieldBegin.fieldSeparator, fieldBegin.fieldSeparator.length))) {\n                endPosition.setPositionParagraph(fieldBegin.line, startOffset);\n                return;\n            }\n            if (!endSelection) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.setPositionParagraph(fieldBegin.fieldEnd.line, fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, fieldBegin.fieldEnd.length));\n            }\n        }\n    };\n    /**\n     * get next word offset from image\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetImage = function (image, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (isInField) {\n            endPosition.setPositionParagraph(image.line, image.line.getOffset(image, indexInInline));\n            endSelection = false;\n            return;\n        }\n        if (indexInInline === 0) {\n            var startOffset = image.line.getOffset(image, 0);\n            endSelection = true;\n            if (endPosition.offset === startOffset) {\n                if (isNullOrUndefined(image.nextNode)) {\n                    endPosition.setPositionParagraph(image.line, startOffset + image.length);\n                }\n                else {\n                    this.getNextWordOffset(image.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                }\n            }\n            else {\n                endPosition.setPositionParagraph(image.line, startOffset);\n            }\n        }\n        else if (!isNullOrUndefined(image.nextNode)) {\n            this.getNextWordOffset(image.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from span\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetSpan = function (span, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (span.text === '\\t' || span.text === '\\v') {\n            if (isInField) {\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                endSelection = false;\n                return;\n            }\n            if (indexInInline === 0) {\n                endSelection = true;\n                var startOffset = span.line.getOffset(span, 0);\n                if (endPosition.offset === startOffset) {\n                    endPosition.setPositionParagraph(span.line, startOffset + span.length);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, startOffset);\n                }\n            }\n            else if (!isNullOrUndefined(span.nextNode)) {\n                this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n            }\n        }\n        else {\n            var wordEndIndex = 0;\n            if (indexInInline === 0 && endSelection && (HelperMethods.wordSplitCharacters.indexOf(span.text[0]) === -1)) {\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                if (isInField) {\n                    return;\n                }\n            }\n            else if (indexInInline < span.length) {\n                // tslint:disable-next-line:max-line-length\n                var txt = indexInInline > 0 && span.text.length - 1 >= indexInInline ? span.text.slice(indexInInline, span.length) : span.text;\n                wordEndIndex = HelperMethods.indexOfAny(txt, HelperMethods.wordSplitCharacters);\n                if (wordEndIndex !== -1) {\n                    if (isInField) {\n                        endSelection = false;\n                        return;\n                    }\n                    var offset = span.line.getOffset(span, wordEndIndex + indexInInline);\n                    // tslint:disable-next-line:max-line-length\n                    if ((excludeSpace || txt[wordEndIndex] !== ' ') && !endSelection && span.line.paragraph === endPosition.paragraph && offset !== endPosition.offset) {\n                        endSelection = true;\n                        endPosition.setPositionParagraph(span.line, offset);\n                        return;\n                    }\n                    wordEndIndex++;\n                    while (wordEndIndex < txt.length && HelperMethods.wordSplitCharacters.indexOf(txt[wordEndIndex]) !== -1) {\n                        if (txt[wordEndIndex] !== ' ' && txt[wordEndIndex] !== '　') {\n                            break;\n                        }\n                        wordEndIndex++;\n                    }\n                    endSelection = true;\n                    if (wordEndIndex < txt.length) {\n                        // tslint:disable-next-line:max-line-length\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, wordEndIndex + indexInInline));\n                    }\n                    else if (!isNullOrUndefined(span.nextNode)) {\n                        // tslint:disable-next-line:max-line-length\n                        this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, wordEndIndex + indexInInline));\n                    }\n                }\n                else if (!isNullOrUndefined(span.nextNode)) {\n                    this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, span.line.getEndOffset());\n                }\n            }\n            else if (!isNullOrUndefined(span.nextNode)) {\n                this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n            }\n        }\n    };\n    /**\n     * get next word offset from field separator\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldSeperator = function (fieldSeparator, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (!isNullOrUndefined(fieldSeparator.nextNode)) {\n            this.getNextWordOffset(fieldSeparator.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from field end\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldEnd = function (fieldEnd, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        var startOffset = fieldEnd.line.getOffset(fieldEnd, 0);\n        var endOffset = startOffset + fieldEnd.length;\n        if (endPosition.offset === startOffset) {\n            endPosition.setPositionParagraph(fieldEnd.line, endOffset);\n            if (isNullOrUndefined(fieldEnd.nextNode)) {\n                return;\n            }\n        }\n        if (!isNullOrUndefined(fieldEnd.nextNode)) {\n            this.getNextWordOffset(fieldEnd.nextNode, 0, type, false, endSelection, endPosition, excludeSpace);\n            if (endPosition.offset === endOffset) {\n                endPosition.setPositionParagraph(fieldEnd.line, startOffset);\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(fieldEnd.line, startOffset);\n        }\n        endSelection = true;\n    };\n    /**\n     * Get previous word offset\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffset = function (inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (inline instanceof TextElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetSpan(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof ImageElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetImage(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldBegin(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldSeparator(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldEnd(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof BookmarkElementBox) {\n            this.getPreviousWordOffsetBookMark(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof ListTextElementBox && inline.previousNode) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetSpan(inline.previousNode, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetBookMark = function (bookmark, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (bookmark.previousNode) {\n            if (bookmark.previousNode instanceof TextElementBox) {\n                var inline = bookmark.previousNode;\n                if (HelperMethods.lastIndexOfAny(inline.text, HelperMethods.wordSplitCharacters) !== inline.text.length - 1) {\n                    this.getPreviousWordOffset(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                }\n                else {\n                    endPosition.setPositionParagraph(bookmark.line, bookmark.line.getOffset(bookmark, 0));\n                }\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(bookmark.line, selection.getStartLineOffset(bookmark.line));\n        }\n    };\n    /**\n     * get previous word offset from field end\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldEnd = function (fieldEnd, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        var startOffset = fieldEnd.line.getOffset(fieldEnd, 0);\n        var endOffset = startOffset + fieldEnd.length;\n        if (isNullOrUndefined(fieldEnd.fieldSeparator)) {\n            this.getPreviousWordOffsetFieldBegin(fieldEnd.fieldBegin, selection, 0, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (type === 0 && !isNullOrUndefined(fieldEnd.previousNode)) {\n            var inline = fieldEnd.previousNode;\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(inline, selection, inline.length, type, (inline instanceof FieldElementBox && inline.fieldType === 1), isStarted, endSelection, endPosition);\n        }\n        else if (!isNullOrUndefined(fieldEnd.fieldBegin) && type !== 0) {\n            var inline = fieldEnd.previousNode;\n            // tslint:disable-next-line:max-line-length\n            if (isNullOrUndefined(inline) || (inline.line.paragraph === fieldEnd.fieldBegin.line.paragraph && !selection.hasValidInline(inline.line.paragraph, inline, fieldEnd.fieldBegin))) {\n                inline = fieldEnd.fieldBegin;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(inline, selection, inline.length, type, !(endPosition.paragraph === fieldEnd.line.paragraph && endPosition.offset === endOffset), isStarted, endSelection, endPosition);\n            if (endSelection && endPosition.paragraph === fieldEnd.line.paragraph\n                && endPosition.offset === startOffset) {\n                endPosition.setPositionParagraph(fieldEnd.line, endOffset);\n                return;\n            }\n            if (!endSelection) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.setPositionParagraph(fieldEnd.fieldBegin.line, fieldEnd.fieldBegin.line.getOffset(fieldEnd.fieldBegin, 0));\n            }\n        }\n    };\n    /**\n     * get previous word offset from field separator\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldSeparator = function (fieldSeparator, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        this.getPreviousWordOffsetFieldBegin(fieldSeparator.fieldBegin, selection, fieldSeparator.fieldBegin.length, type, isInField, isStarted, endSelection, endPosition);\n    };\n    /**\n     * get previous word offset from field begin\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldBegin = function (fieldBegin, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        var startOffset = fieldBegin.line.getOffset(fieldBegin, 0);\n        var endOffset = startOffset + fieldBegin.length;\n        if (endPosition.offset === endOffset) {\n            endPosition.setPositionParagraph(fieldBegin.line, startOffset);\n        }\n        if (!isNullOrUndefined(fieldBegin.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(fieldBegin.previousNode, selection, fieldBegin.previousNode.length, type, false, isStarted, endSelection, endPosition);\n            if (endPosition.offset === startOffset) {\n                if (type !== 0 && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    // tslint:disable-next-line:max-line-length\n                    endPosition.setPositionParagraph(fieldBegin.line, fieldBegin.fieldSeparator.line.getOffset(fieldBegin.fieldSeparator, fieldBegin.fieldSeparator.length));\n                }\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(fieldBegin.line, selection.getStartLineOffset(fieldBegin.line));\n        }\n    };\n    /**\n     * get previous word offset from image\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetImage = function (image, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (isInField) {\n            endPosition.setPositionParagraph(image.line, image.line.getOffset(image, indexInInline));\n            endSelection = false;\n            return;\n        }\n        if (indexInInline === image.length) {\n            var endOffset = image.line.getOffset(image, image.length);\n            if (endOffset === endPosition.offset) {\n                endPosition.setPositionParagraph(image.line, endOffset - image.length);\n            }\n            else {\n                endPosition.setPositionParagraph(image.line, endOffset);\n            }\n        }\n        else if (!isNullOrUndefined(image.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(image.previousNode, selection, image.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n        }\n    };\n    /**\n     * Get previous word offset from span\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length   \n    TextPosition.prototype.getPreviousWordOffsetSpan = function (span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (span.text === '\\t' || span.text === '\\v') {\n            if (isInField) {\n                endSelection = false;\n                return;\n            }\n            if (indexInInline === span.length) {\n                endSelection = true;\n                var endOffset = span.line.getOffset(span, span.length);\n                if (endOffset === endPosition.offset) {\n                    endPosition.setPositionParagraph(span.line, endOffset - span.length);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, endOffset);\n                }\n            }\n            else if (!isNullOrUndefined(span.previousNode)) {\n                // tslint:disable-next-line:max-line-length\n                this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n            }\n        }\n        else {\n            var wordStartIndex = 0;\n            if (!isStarted) {\n                while (indexInInline > 0 && span.text[indexInInline - 1] === ' ') {\n                    indexInInline--;\n                }\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n            }\n            if (indexInInline > 0) {\n                isStarted = true;\n                if (indexInInline === 0 && endSelection && (HelperMethods.wordSplitCharacters.indexOf(span.text[0])) === -1) {\n                    endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                    endSelection = true;\n                    return;\n                }\n                var txt = span.text.length > indexInInline ? span.text.slice(0, indexInInline) : span.text;\n                wordStartIndex = HelperMethods.lastIndexOfAny(txt, HelperMethods.wordSplitCharacters);\n                if (wordStartIndex !== -1) {\n                    if (isInField) {\n                        endSelection = false;\n                        return;\n                    }\n                    while (wordStartIndex > 0 && endSelection && txt[wordStartIndex] !== ' '\n                        && (HelperMethods.wordSplitCharacters.indexOf(txt[wordStartIndex - 1])) !== -1) {\n                        wordStartIndex--;\n                    }\n                    if (txt[wordStartIndex] === ' ' || txt[wordStartIndex] === '　' || !endSelection) {\n                        wordStartIndex++;\n                    }\n                    endSelection = true;\n                    if (wordStartIndex > 0) {\n                        var offset = span.line.getOffset(span, wordStartIndex);\n                        if (span.line.paragraph === endPosition.paragraph && offset === endPosition.offset) {\n                            // tslint:disable-next-line:max-line-length\n                            this.getPreviousWordOffsetSpan(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                        }\n                        else {\n                            endPosition.setPositionParagraph(span.line, offset);\n                        }\n                    }\n                    else if (span.previousNode instanceof TextElementBox) {\n                        // tslint:disable-next-line:max-line-length\n                        this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n                    }\n                    else {\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, 0));\n                    }\n                }\n                else {\n                    this.setPreviousWordOffset(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                }\n            }\n            else {\n                this.setPreviousWordOffset(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n            }\n        }\n    };\n    /**\n     * set previous word offset in span\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.setPreviousWordOffset = function (span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (span.previousNode instanceof ElementBox && span.line === span.previousNode.line) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else {\n            endPosition.setPositionParagraph(span.line, selection.getStartLineOffset(span.line));\n        }\n    };\n    /**\n     * Validate if text position is in field forward\n     * @private\n     */\n    TextPosition.prototype.validateForwardFieldSelection = function (currentIndex, selectionEndIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(currentIndex);\n        textPosition.isUpdateLocation = false;\n        var isPositionMoved = false;\n        while (currentIndex !== selectionEndIndex && TextPosition.isForwardSelection(currentIndex, selectionEndIndex)) {\n            if (!isPositionMoved) {\n                textPosition.moveNextPosition(false);\n                var nextIndex = textPosition.getHierarchicalIndexInternal();\n                //Handled specifically to break infinite looping, if selection ends at last paragraph mark.\n                if (currentIndex === nextIndex) {\n                    break;\n                }\n            }\n            var indexInInline = 0;\n            var inlineObj = textPosition.currentWidget.getInline(textPosition.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                var selectionStartIndex = this.selection.start.getHierarchicalIndexInternal();\n                if (indexInInline === inline.length && inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    if (inline.line.getOffset(inline, 0) === this.offset) {\n                        return;\n                    }\n                    var lineWidget = inline.fieldBegin.line;\n                    var fieldBeginOffset = lineWidget.getOffset(inline.fieldBegin, 0);\n                    var fieldBeginIndex = this.getHierarchicalIndex(lineWidget, fieldBeginOffset.toString());\n                    if (!TextPosition.isForwardSelection(selectionStartIndex, fieldBeginIndex)) {\n                        this.selection.start.setPositionParagraph(lineWidget, fieldBeginOffset);\n                    }\n                }\n                var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n                if (!isNullOrUndefined(nextInline) && nextInline instanceof ElementBox) {\n                    inline = nextInline;\n                }\n            }\n            isPositionMoved = (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd));\n            if (isPositionMoved) {\n                if (inline.line.getOffset(inline, 0) === this.offset) {\n                    return;\n                }\n                var fieldEnd = inline.fieldEnd;\n                var paragraph = fieldEnd.line.paragraph;\n                var fieldEndOffset = fieldEnd.line.getOffset(fieldEnd, 1);\n                var fieldEndIndex = this.getHierarchicalIndex(fieldEnd.line, fieldEndOffset.toString());\n                if (!TextPosition.isForwardSelection(fieldEndIndex, selectionEndIndex)) {\n                    //If selection end is after field begin, extend selection end to field end.\n                    this.moveToInline(inline.fieldEnd, 1);\n                    return;\n                }\n                textPosition.moveToInline(inline.fieldEnd, 1);\n            }\n            currentIndex = textPosition.getHierarchicalIndexInternal();\n        }\n    };\n    /**\n     * Validate if text position is in field backward\n     * @private\n     */\n    TextPosition.prototype.validateBackwardFieldSelection = function (currentIndex, selectionEndIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(currentIndex);\n        textPosition.isUpdateLocation = false;\n        var selectionStartIndex = this.selection.start.getHierarchicalIndexInternal();\n        while (currentIndex !== selectionEndIndex && TextPosition.isForwardSelection(selectionEndIndex, currentIndex)) {\n            var indexInInline = 0;\n            var inlineObj = textPosition.currentWidget.getInline(textPosition.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n                if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n                    var paragraph = nextInline.fieldEnd.line;\n                    var fieldEndOffset = paragraph.getOffset(nextInline.fieldEnd, 1);\n                    var fieldEndIndex = this.getHierarchicalIndex(paragraph, fieldEndOffset.toString());\n                    if (!TextPosition.isForwardSelection(fieldEndIndex, selectionStartIndex)) {\n                        this.selection.start.setPositionParagraph(paragraph, fieldEndOffset);\n                        selectionStartIndex = fieldEndIndex;\n                    }\n                }\n            }\n            if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n                var line = inline.fieldBegin.line;\n                var fieldBegin = inline.fieldBegin;\n                var fieldBeginOffset = line.getOffset(fieldBegin, 0);\n                var fieldBeginIndex = this.getHierarchicalIndex(line, fieldBeginOffset.toString());\n                if (!TextPosition.isForwardSelection(selectionEndIndex, fieldBeginIndex)) {\n                    //If field begin is before selection end, extend selection end to field begin.\n                    this.moveToInline(inline.fieldBegin, 0);\n                    return;\n                }\n                textPosition.moveToInline(inline.fieldBegin, 0);\n            }\n            else {\n                textPosition.movePreviousPosition();\n            }\n            currentIndex = textPosition.getHierarchicalIndexInternal();\n        }\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.paragraphStartInternal = function (selection, moveToPreviousParagraph) {\n        var offset = selection.getStartLineOffset(this.currentWidget);\n        if (this.offset === offset && moveToPreviousParagraph) {\n            var startParagraph = this.moveToNextParagraphInTableCheck();\n            if (startParagraph) {\n                this.moveToPreviousParagraphInTable(selection);\n            }\n            else if (!isNullOrUndefined(selection.getPreviousParagraphBlock(this.currentWidget.paragraph))) {\n                var paragraphValue = selection.getPreviousParagraphBlock(this.currentWidget.paragraph);\n                this.currentWidget = paragraphValue.childWidgets[0];\n                this.offset = selection.getStartLineOffset(this.currentWidget);\n            }\n        }\n        else {\n            this.currentWidget = this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0];\n            this.offset = offset;\n        }\n        this.calculateOffset();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.calculateOffset = function () {\n        var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            this.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Moves the text position to start of the paragraph.\n     * @private\n     */\n    TextPosition.prototype.moveToParagraphStartInternal = function (selection, moveToPreviousParagraph) {\n        var startOffset = selection.getStartOffset(this.paragraph);\n        if (this.offset === startOffset && moveToPreviousParagraph) {\n            var paragraphstart = this.moveToNextParagraphInTableCheck();\n            if (paragraphstart) {\n                this.moveToPreviousParagraphInTable(selection);\n            }\n            else if (!isNullOrUndefined(selection.getPreviousParagraphBlock(this.paragraph))) {\n                this.currentWidget = selection.getPreviousParagraphBlock(this.paragraph).firstChild;\n                this.offset = selection.getStartOffset(this.paragraph);\n            }\n        }\n        else {\n            this.currentWidget = this.paragraph.firstChild;\n            this.offset = selection.getStartLineOffset(this.currentWidget);\n        }\n        var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            this.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n        }\n        this.updatePhysicalPosition(false);\n    };\n    /**\n     * Moves the text position to end of the paragraph.\n     * @private\n     */\n    TextPosition.prototype.moveToParagraphEndInternal = function (selection, moveToNextParagraph) {\n        // tslint:disable-next-line:max-line-length\n        var splittedParagraph = this.currentWidget.paragraph;\n        while (splittedParagraph.nextSplitWidget) {\n            splittedParagraph = splittedParagraph.nextSplitWidget;\n        }\n        this.currentWidget = splittedParagraph.childWidgets[splittedParagraph.childWidgets.length - 1];\n        var endOffset = this.currentWidget.getEndOffset() + 1;\n        if (this.offset === endOffset && moveToNextParagraph) {\n            var paragraphEnd = this.moveToNextParagraphInTableCheck();\n            if (paragraphEnd) {\n                this.moveToNextParagraphInTable();\n            }\n            else if (!isNullOrUndefined(selection.getNextParagraphBlock(this.currentWidget.paragraph))) {\n                var endParagraph = selection.getNextParagraphBlock(this.currentWidget.paragraph);\n                this.currentWidget = endParagraph.childWidgets[endParagraph.childWidgets.length - 1];\n                this.offset = this.currentWidget.getEndOffset() + 1;\n            }\n        }\n        else {\n            this.offset = endOffset;\n        }\n        this.calculateOffset();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveUp = function (selection, left) {\n        var paragraph = this.currentWidget.paragraph;\n        //Moves text position to start of line.\n        this.moveToLineStartInternal(selection, true);\n        //Moves previous line starting.\n        this.movePreviousPosition();\n        var prevLine = undefined;\n        var currentParagraph = this.currentWidget.paragraph;\n        if (paragraph.isInsideTable && paragraph !== currentParagraph && paragraph.associatedCell !== currentParagraph.associatedCell\n            // tslint:disable-next-line:max-line-length\n            && (!isNullOrUndefined(currentParagraph.associatedCell) && (paragraph.associatedCell.ownerRow === currentParagraph.associatedCell.ownerRow))) {\n            var ownerRow = currentParagraph.associatedCell.ownerRow;\n            if (ownerRow.previousRenderedWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getFirstCellInRegion(ownerRow.previousRenderedWidget, currentParagraph.associatedCell, left, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            else {\n                var prevBlock = ownerRow.ownerTable.previousRenderedWidget;\n                do {\n                    if (prevBlock instanceof TableWidget) {\n                        prevBlock = selection.getLastBlockInLastCell(prevBlock);\n                    }\n                } while (prevBlock instanceof TableWidget);\n                if (prevBlock instanceof ParagraphWidget) {\n                    this.setPosition(prevBlock.childWidgets[prevBlock.childWidgets.length - 1], false);\n                }\n            }\n            prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        else {\n            if (!paragraph.isInsideTable && this.currentWidget.paragraph.isInsideTable) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (paragraph.isInsideTable && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && paragraph.associatedCell.ownerRow.previousRenderedWidget !== paragraph.associatedCell.ownerRow.previousSplitWidget &&\n                paragraph.associatedCell.ownerRow.previousRenderedWidget === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        //Moves till the Up/Down selection width.\n        var top = selection.getTop(prevLine);\n        selection.updateTextPositionWidget(prevLine, new Point(left, top), this, false);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveDown = function (selection, left) {\n        //Moves text position to end of line.\n        var prevParagraph = this.currentWidget.paragraph;\n        var prevOffset = this.offset;\n        this.moveToLineEndInternal(selection, true);\n        var length = this.selection.getParagraphLength(this.currentWidget.paragraph);\n        if (this.offset > length) {\n            this.offset = length;\n        }\n        //Moves next line starting.\n        this.moveNextPosition();\n        var nextLine = undefined;\n        // tslint:disable-next-line:max-line-length\n        if (prevParagraph.isInsideTable && prevParagraph !== this.currentWidget.paragraph && prevParagraph.associatedCell !== this.currentWidget.paragraph.associatedCell && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && prevParagraph.associatedCell.ownerRow === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n            var ownerRow = this.currentWidget.paragraph.associatedCell.ownerRow;\n            // tslint:disable-next-line:max-line-length\n            if (prevParagraph.isInsideTable && this.currentWidget.paragraph.isInsideTable && prevParagraph.associatedCell.cellFormat.rowSpan > 1 && prevParagraph.associatedCell.cellFormat.rowSpan + prevParagraph.associatedCell.ownerRow.rowIndex === prevParagraph.associatedCell.ownerTable.childWidgets.length) {\n                //If the prevParagraph  owner cell is Verically merged upto the last row, then theposition moved to next column. the position moved to out of the current tabel so owner row is assigned to last row.\n                // tslint:disable-next-line:max-line-length\n                ownerRow = this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length - 1];\n            }\n            if (ownerRow.nextRenderedWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                var cell = this.selection.getLastCellInRegion(ownerRow.nextRenderedWidget, this.currentWidget.paragraph.associatedCell, left, false);\n                this.setPosition(this.selection.getFirstParagraph(cell).childWidgets[0], true);\n            }\n            else {\n                var nextBlock = this.selection.getNextRenderedBlock(ownerRow.ownerTable);\n                do {\n                    if (nextBlock instanceof TableWidget) {\n                        nextBlock = this.selection.getFirstBlockInFirstCell(nextBlock);\n                    }\n                } while (nextBlock instanceof TableWidget);\n                if (nextBlock instanceof ParagraphWidget) {\n                    this.setPosition(nextBlock.childWidgets[0], true);\n                }\n            }\n            nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        else {\n            if (!prevParagraph.isInsideTable && this.currentWidget.paragraph.isInsideTable) {\n                // tslint:disable-next-line:max-line-length\n                var cell = this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, false);\n                this.setPosition(this.selection.getFirstParagraph(cell).childWidgets[0], true);\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (prevParagraph.isInsideTable && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && prevParagraph.associatedCell.ownerRow.nextRenderedWidget !== prevParagraph.associatedCell.ownerRow.nextSplitWidget\n                && prevParagraph.associatedCell.ownerRow.nextRenderedWidget === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                this.setPosition(selection.getFirstParagraph(cell).childWidgets[0], false);\n            }\n            nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        //Moves till the Up/Down selection width.\n        var top = this.selection.getTop(nextLine);\n        this.selection.updateTextPositionWidget(nextLine, new Point(left, top), this, false);\n    };\n    /**\n     * Moves the text position to start of the line.\n     * @private\n     */\n    TextPosition.prototype.moveToLineStartInternal = function (selection, moveToPreviousLine) {\n        if (this.location.x > this.viewer.clientActiveArea.right) {\n            this.offset = this.offset - 1;\n        }\n        var currentLine = selection.getLineWidgetInternal(this.currentWidget, this.offset, moveToPreviousLine);\n        var firstElement = selection.getFirstElementInternal(currentLine);\n        var startOffset = selection.getStartOffset(this.currentWidget.paragraph);\n        if (isNullOrUndefined(firstElement) && this.offset > startOffset) {\n            var index = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, index);\n            var inline = inlineObj.element;\n            index = inlineObj.index;\n            if (inline instanceof TextElementBox && inline.text !== '\\v') {\n                this.offset = startOffset;\n            }\n        }\n        else if (!isNullOrUndefined(firstElement)) {\n            var indexInInline = selection.getIndexInInline(firstElement);\n            this.currentWidget = firstElement.line;\n            this.offset = this.currentWidget.getOffset(firstElement, indexInInline);\n            indexInInline = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (inline instanceof FieldElementBox) {\n                //Checks if field character is part of rendered field, otherwise moves to previous rendered content.\n                var prevInline = selection.getPreviousValidElement(inline);\n                if (!isNullOrUndefined(prevInline)) {\n                    inline = prevInline;\n                    this.currentWidget = inline.line;\n                    this.offset = this.currentWidget.getOffset(inline, inline.length);\n                    if (inline instanceof FieldElementBox) {\n                        this.offset--;\n                    }\n                }\n            }\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Check paragraph is inside table\n     * @private\n     */\n    TextPosition.prototype.moveToNextParagraphInTableCheck = function () {\n        if ((this.selection.start.paragraph.isInsideTable || this.paragraph.isInsideTable)\n            && (this.selection.start.paragraph.associatedCell !== this.paragraph.associatedCell\n                || this.selection.isCellSelected(this.selection.start.paragraph.associatedCell, this.selection.start, this))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Moves the text position to end of the word.\n     * @private\n     */\n    TextPosition.prototype.moveToWordEndInternal = function (type, excludeSpace) {\n        // type === 0 -------->CTRL+ARROW Navigation\n        // type === 1 -------->CTRL+SHIFT+ARROW Selection\n        // type === 2 -------->Double-tap Word Selection\n        var incrementValue = 0;\n        var endOffset = this.currentWidget.getEndOffset();\n        if (this.selection.isParagraphFirstLine(this.currentWidget)) {\n            if (this.currentWidget.children[0] instanceof ListTextElementBox) {\n                incrementValue = 1;\n            }\n            if (this.currentWidget.children[1] instanceof ListTextElementBox) {\n                incrementValue = 2;\n            }\n        }\n        if (this.offset + incrementValue === endOffset || this.offset === endOffset + 1) {\n            if (this.offset === endOffset && type !== 0) {\n                this.setPositionParagraph(this.currentWidget, endOffset + 1);\n            }\n            else {\n                var nextParagraph = this.selection.getNextParagraphBlock(this.currentWidget.paragraph);\n                if (isNullOrUndefined(nextParagraph)) {\n                    return;\n                }\n                this.currentWidget = nextParagraph.childWidgets[0];\n                this.offset = this.selection.getStartLineOffset(this.currentWidget);\n                if (type === 1) {\n                    // tslint:disable-next-line:max-line-length\n                    var nextWord = this.moveToNextParagraphInTableCheck();\n                    if (nextWord) {\n                        this.moveToNextParagraphInTable();\n                    }\n                    else {\n                        this.moveToWordEndInternal(type, excludeSpace);\n                    }\n                }\n            }\n        }\n        else {\n            var indexInInline = 0;\n            var endSelection = false;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            this.getNextWordOffset(inline, indexInInline, type, false, endSelection, this, excludeSpace);\n        }\n        if (type !== 0) {\n            var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n            var selectionEndIndex = this.getHierarchicalIndexInternal();\n            if (selectionStartIndex !== selectionEndIndex) {\n                this.validateForwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * move text position to next paragraph inside table\n     * @private\n     */\n    TextPosition.prototype.moveToNextParagraphInTable = function () {\n        var paragraph = this.currentWidget.paragraph;\n        var nextParagraph = (paragraph.isInsideTable) ? this.selection.getNextSelectionCell(paragraph.associatedCell) :\n            this.selection.getNextParagraphBlock(paragraph);\n        if (isNullOrUndefined(nextParagraph)) {\n            return;\n        }\n        this.currentWidget = nextParagraph.childWidgets[nextParagraph.childWidgets.length - 1];\n        this.offset = this.currentWidget.getEndOffset() + 1;\n    };\n    /**\n     * Moves the text position to start of the previous paragraph.\n     */\n    TextPosition.prototype.moveToPreviousParagraph = function (selection) {\n        var startOffset = selection.getStartOffset(this.currentWidget.paragraph);\n        // tslint:disable-next-line:max-line-length\n        if (this.offset === startOffset && !isNullOrUndefined(selection.getPreviousParagraphBlock(this.currentWidget.paragraph))) {\n            var previousParagraph = selection.getPreviousParagraphBlock(this.currentWidget.paragraph);\n            this.currentWidget = previousParagraph.childWidgets[0];\n            this.offset = selection.getStartOffset(this.currentWidget.paragraph);\n        }\n        else {\n            this.offset = selection.getStartOffset(this.currentWidget.paragraph);\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move to previous line from current position\n     * @private\n     */\n    TextPosition.prototype.moveToPreviousLine = function (selection, left) {\n        var currentIndex = this.getHierarchicalIndexInternal();\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        //Moves text position to start of line.\n        this.moveToLineStartInternal(selection, true);\n        if (this.currentWidget.paragraph.isInsideTable) {\n            this.moveUpInTable(selection);\n        }\n        else {\n            this.moveBackward();\n        }\n        var prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var lineStart = selection.getLeft(prevLine);\n        var lineWidth = selection.getWidth(prevLine, true);\n        //Moves till the Up/Down selection width.\n        if (lineWidth + lineStart >= left && currentLine !== prevLine) {\n            var top_1 = selection.getTop(prevLine);\n            var point = new Point(left, top_1);\n            selection.updateTextPositionWidget(prevLine, point, this, true);\n        }\n        //Checks if the current position is between field result, then move to field begin.\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        this.validateBackwardFieldSelection(currentIndex, selectionEndIndex);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveToLineEndInternal = function (selection, moveToNextLine) {\n        if (this.location.x > this.viewer.clientActiveArea.right) {\n            this.offset = this.offset - 1;\n        }\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var firstElement = selection.getFirstElementInternal(currentLine);\n        if (isNullOrUndefined(firstElement) && this.offset === selection.getStartLineOffset(this.currentWidget)) {\n            this.offset = selection.getParagraphLength(this.paragraph) + 1;\n            this.updatePhysicalPosition(true);\n        }\n        else if (!isNullOrUndefined(firstElement)) {\n            var lastElement = currentLine.children[currentLine.children.length - 1];\n            var index = 0;\n            index += lastElement instanceof TextElementBox ? lastElement.length : 1;\n            this.currentWidget = lastElement.line;\n            if (index === lastElement.length\n                && isNullOrUndefined(lastElement.nextNode) && selection.isParagraphLastLine(this.currentWidget)) {\n                var length_1 = selection.getLineLength(this.currentWidget);\n                this.offset = moveToNextLine ? length_1 + 1 : length_1;\n            }\n            else {\n                var inline = lastElement;\n                while (!isNullOrUndefined(inline) && inline.length === index && inline.nextNode instanceof FieldElementBox) {\n                    var nextInline = selection.getNextValidElement(inline.nextNode);\n                    if (inline !== nextInline) {\n                        inline = nextInline;\n                        index = 0;\n                    }\n                    if (inline instanceof FieldElementBox && inline.fieldType === 0\n                        && !isNullOrUndefined(inline.fieldEnd)) {\n                        var fieldBegin = inline;\n                        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                            inline = fieldBegin.fieldEnd;\n                        }\n                        else {\n                            inline = fieldBegin.fieldSeparator;\n                            this.currentWidget = inline.line;\n                            if (this.currentWidget === fieldBegin.fieldEnd.line\n                                && !selection.hasValidInline(this.currentWidget.paragraph, inline, fieldBegin.fieldEnd)) {\n                                inline = fieldBegin.fieldEnd;\n                            }\n                        }\n                        this.currentWidget = inline.line;\n                    }\n                    if (inline instanceof FieldElementBox) {\n                        index = 1;\n                    }\n                }\n                if (index === inline.length && isNullOrUndefined(inline.nextNode)) {\n                    index++;\n                }\n                if (!moveToNextLine && inline instanceof ElementBox && inline.text === '\\v') {\n                    index--;\n                }\n                this.offset = this.currentWidget.getOffset(inline, index);\n            }\n            this.updatePhysicalPosition(moveToNextLine);\n        }\n    };\n    /**\n     * Move to next line\n     * @private\n     */\n    TextPosition.prototype.moveToNextLine = function (left) {\n        var selection = this.selection;\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionInternal(this);\n        var currentIndex = this.getHierarchicalIndexInternal();\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var isAtLineStart = this.offset === 0 ? true : false;\n        //Moves text position to end of line.\n        this.moveToLineEndInternal(selection, true);\n        var isMoveToLineEnd = !textPosition.isAtSamePosition(this);\n        textPosition.setPositionInternal(this);\n        if (this.currentWidget.paragraph.isInsideTable) {\n            this.moveDownInTable(selection);\n        }\n        else {\n            this.moveNextPosition();\n            this.moveForward();\n        }\n        var nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var lineStart = selection.getLeft(nextLine);\n        var firstElement = selection.getFirstElementInternal(nextLine);\n        // tslint:disable-next-line:max-line-length\n        var firstItemWidth = isNullOrUndefined(firstElement) ? selection.getWidth(nextLine, true) : selection.getLeftInternal(nextLine, firstElement, 1) - lineStart;\n        //Moves till the Up/Down selection width.\n        if (lineStart < left && (firstItemWidth / 2 < left - lineStart)) {\n            var top_2 = selection.getTop(nextLine);\n            var point = new Point(left, top_2);\n            selection.updateTextPositionWidget(nextLine, point, this, true);\n            var width = selection.getWidth(nextLine, true);\n            if (width < left - lineStart) {\n                this.moveToLineEndInternal(selection, true);\n            }\n        }\n        else if (isMoveToLineEnd && this.currentWidget.paragraph.isInsideTable\n            && this.currentWidget === this.owner.selection.start.currentWidget) {\n            this.setPositionInternal(textPosition);\n        }\n        else if (!isMoveToLineEnd) {\n            this.moveToLineEndInternal(selection, true);\n        }\n        //Checks if the current position is between field result, then move to field end.\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        this.validateForwardFieldSelection(currentIndex, selectionEndIndex);\n    };\n    /**\n     * Move upward in table\n     * @private\n     */\n    TextPosition.prototype.moveUpInTable = function (selection) {\n        var isPositionUpdated = false;\n        var end = this.owner.selection.end;\n        var isBackwardSelection = !this.owner.selection.isEmpty;\n        isPositionUpdated = end.paragraph.isInsideTable;\n        if (isPositionUpdated) {\n            var startCell = this.currentWidget.paragraph.associatedCell;\n            var endCell = end.paragraph.associatedCell;\n            var containerCell = selection.getContainerCellOf(endCell, startCell);\n            isPositionUpdated = containerCell.ownerTable.contains(startCell);\n            if (isPositionUpdated) {\n                endCell = selection.getSelectedCell(endCell, containerCell);\n                startCell = selection.getSelectedCell(startCell, containerCell);\n                // tslint:disable-next-line:max-line-length\n                var isInContainerCell = selection.containsCell(containerCell, this.currentWidget.paragraph.associatedCell);\n                var isContainerCellSelected = selection.isCellSelected(containerCell, this, end);\n                if (!isContainerCellSelected) {\n                    // tslint:disable-next-line:max-line-length\n                    isContainerCellSelected = this.currentWidget.paragraph === selection.getFirstParagraph(containerCell) && this.isAtParagraphStart;\n                }\n                if ((isInContainerCell && isContainerCellSelected\n                    || !isInContainerCell) && !isNullOrUndefined(startCell.ownerRow.previousRenderedWidget)) {\n                    //Moves to cell in previous row.\n                    var row = startCell.ownerRow.previousRenderedWidget;\n                    // tslint:disable-next-line:max-line-length\n                    var cell = selection.getFirstCellInRegion(row, containerCell, this.owner.selection.upDownSelectionLength, true);\n                    var previousParagraph = selection.getLastParagraph(cell);\n                    this.setPosition(previousParagraph.childWidgets[0], true);\n                    return;\n                }\n                else if (isInContainerCell && isContainerCellSelected\n                    && isNullOrUndefined(startCell.ownerRow.previousRenderedWidget) || !isInContainerCell) {\n                    if (isBackwardSelection) {\n                        //Moves to first cell of row.\n                        startCell = startCell.ownerRow.childWidgets[0];\n                        var previousParagraph = selection.getFirstParagraph(startCell);\n                        this.setPosition(previousParagraph.childWidgets[0], true);\n                    }\n                    else {\n                        //Moves to last cell of row.\n                        startCell = startCell.ownerRow.childWidgets[startCell.ownerRow.childWidgets.length - 1];\n                        var previousParagraph = selection.getLastParagraph(startCell);\n                        this.setPosition(previousParagraph.childWidgets[0], false);\n                    }\n                }\n            }\n        }\n        if (!isPositionUpdated) {\n            //Moves to previous row / previous block.\n            var cell = selection.getContainerCell(this.currentWidget.paragraph.associatedCell);\n            if (isBackwardSelection) {\n                //Moves to first cell of row.\n                cell = cell.ownerRow.childWidgets[0];\n                var previousParagraph = selection.getFirstParagraph(cell);\n                this.setPosition(previousParagraph.childWidgets[0], true);\n            }\n            else {\n                //Moves to end of row.\n                cell = cell.ownerRow.childWidgets[cell.ownerRow.childWidgets.length - 1];\n                var previousParagraph = selection.getLastParagraph(cell);\n                this.setPosition(previousParagraph.childWidgets[0], false);\n            }\n        }\n        //Moves to previous row / previous block.\n        this.moveBackward();\n    };\n    /**\n     * Move down inside table\n     * @private\n     */\n    TextPosition.prototype.moveDownInTable = function (selection) {\n        var isPositionUpdated = false;\n        var isForwardSelection = this.owner.selection.isEmpty || this.owner.selection.isForward;\n        isPositionUpdated = this.owner.selection.start.paragraph.isInsideTable;\n        if (isPositionUpdated) {\n            var startCell = this.owner.selection.start.paragraph.associatedCell;\n            var endCell = this.currentWidget.paragraph.associatedCell;\n            var containerCell = selection.getContainerCellOf(startCell, endCell);\n            isPositionUpdated = containerCell.ownerTable.contains(endCell);\n            if (isPositionUpdated) {\n                startCell = selection.getSelectedCell(startCell, containerCell);\n                endCell = selection.getSelectedCell(endCell, containerCell);\n                // tslint:disable-next-line:max-line-length\n                var isInContainerCell = selection.containsCell(containerCell, this.currentWidget.paragraph.associatedCell);\n                var isContainerCellSelected = selection.isCellSelected(containerCell, this.owner.selection.start, this);\n                if ((isInContainerCell && isContainerCellSelected\n                    || !isInContainerCell) && !isNullOrUndefined(endCell.ownerRow.nextRenderedWidget)) {\n                    //Moves to cell in next row.\n                    var row = endCell.ownerRow.nextRenderedWidget;\n                    // tslint:disable-next-line:max-line-length\n                    var cell = selection.getLastCellInRegion(row, containerCell, this.owner.selection.upDownSelectionLength, false);\n                    var lastParagraph = selection.getLastParagraph(cell);\n                    this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                    return;\n                }\n                else if (isInContainerCell && isContainerCellSelected\n                    && isNullOrUndefined(endCell.ownerRow.nextRenderedWidget) || !isInContainerCell) {\n                    if (isForwardSelection) {\n                        //Moves to last cell of row.\n                        endCell = endCell.ownerRow.childWidgets[endCell.ownerRow.childWidgets.length - 1];\n                        var lastParagraph = selection.getLastParagraph(endCell);\n                        this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                    }\n                    else {\n                        //Moves to first cell of row.\n                        endCell = endCell.ownerRow.childWidgets[0];\n                        var lastParagraph = selection.getFirstParagraph(endCell);\n                        this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], true);\n                    }\n                }\n            }\n        }\n        if (!isPositionUpdated) {\n            //Moves to next row / next block.\n            var cell = selection.getContainerCell(this.currentWidget.paragraph.associatedCell);\n            if (isForwardSelection) {\n                //Moves to end of row.\n                cell = cell.ownerRow.childWidgets[cell.ownerRow.childWidgets.length - 1];\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            else if (cell.ownerRow.nextRenderedWidget) {\n                //Moves to first cell of row.\n                cell = cell.ownerRow.nextRenderedWidget.childWidgets[0];\n                var lastParagraph = selection.getFirstParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], true);\n            }\n        }\n        //Moves to next row / next block.\n        this.moveForward();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.destroy = function () {\n        this.offset = undefined;\n        this.isUpdateLocation = undefined;\n        if (!isNullOrUndefined(this.location)) {\n            this.location.destroy();\n        }\n        this.location = undefined;\n        this.currentWidget = undefined;\n        this.owner = undefined;\n        this.viewer = undefined;\n    };\n    return TextPosition;\n}());\nexport { TextPosition };\n/**\n * @private\n */\nvar SelectionWidgetInfo = /** @class */ (function () {\n    function SelectionWidgetInfo(left, width) {\n        this.leftIn = 0;\n        this.widthIn = 0;\n        this.leftIn = left;\n        this.widthIn = width;\n    }\n    Object.defineProperty(SelectionWidgetInfo.prototype, \"left\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.leftIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.leftIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionWidgetInfo.prototype, \"width\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.widthIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.widthIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    SelectionWidgetInfo.prototype.destroy = function () {\n        this.widthIn = undefined;\n        this.leftIn = undefined;\n    };\n    return SelectionWidgetInfo;\n}());\nexport { SelectionWidgetInfo };\n/**\n * @private\n */\nvar Hyperlink = /** @class */ (function () {\n    function Hyperlink(fieldBeginAdv, selection) {\n        this.linkInternal = '';\n        this.localRef = '';\n        this.opensNewWindow = false;\n        var fieldCode = selection.getFieldCode(fieldBeginAdv);\n        var lowercase = fieldCode.toLowerCase();\n        if (lowercase.substring(0, 9) === 'hyperlink') {\n            this.parseFieldValues(fieldCode.substring(9).trim(), selection);\n        }\n    }\n    Object.defineProperty(Hyperlink.prototype, \"navigationLink\", {\n        /**\n         * Gets navigation link.\n         * @returns string\n         * @private\n         */\n        get: function () {\n            return this.linkInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Hyperlink.prototype, \"localReference\", {\n        /**\n         * Gets the local reference if any.\n         * @returns string\n         * @private\n         */\n        get: function () {\n            return this.localRef;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Hyperlink.prototype, \"linkType\", {\n        /**\n         * Gets hyper link type.\n         * @returns HyperLinkType\n         * @private\n         */\n        get: function () {\n            return this.typeInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Parse field values\n     * @param  {string} value\n     * @returns Void\n     */\n    Hyperlink.prototype.parseFieldValues = function (value, selection) {\n        var codes = value.split(' ');\n        var isLocalRef = false;\n        for (var i = 0; i < codes.length; i++) {\n            var code = codes[i];\n            if (code.length < 1) {\n                continue;\n            }\n            if (code === '\\\\t' || code === '\\\\l') {\n                isLocalRef = true;\n            }\n            else if (code === '\\\\n') {\n                this.opensNewWindow = true;\n            }\n            else {\n                code = this.parseFieldValue(code, code[0] === '\\\"' ? '\\\"' : undefined);\n                if (isLocalRef) {\n                    this.localRef = code;\n                    isLocalRef = false;\n                }\n                else {\n                    this.linkInternal = code;\n                }\n            }\n        }\n        this.setLinkType();\n    };\n    Hyperlink.prototype.parseFieldValue = function (value, endChar) {\n        value = value.substring(1);\n        var endIndex = endChar ? value.indexOf(endChar) : -1;\n        if (endIndex < 0) {\n            endIndex = value.length;\n        }\n        return value.substring(0, endIndex).trim();\n    };\n    Hyperlink.prototype.setLinkType = function () {\n        // If only local reference.\n        if (isNullOrUndefined(this.linkInternal) || this.linkInternal.length < 1) {\n            this.typeInternal = 'Bookmark';\n            return;\n        }\n        // Validates link.\n        if (this.linkInternal.substring(0, 4) === ('www.')) {\n            this.linkInternal = 'http://' + this.navigationLink;\n        }\n        else if (this.linkInternal[0] === '@') {\n            this.linkInternal = 'mailto:' + this.navigationLink;\n        }\n        // Finds proper link type.\n        if (this.linkInternal.substring(0, 7) === 'http://'\n            || this.linkInternal.substring(0, 8) === 'https://') {\n            this.typeInternal = 'WebPage';\n        }\n        else if (this.linkInternal.substring(0, 7) === 'mailto:') {\n            this.typeInternal = 'Email';\n        }\n        else {\n            this.typeInternal = 'File';\n        }\n    };\n    /**\n     * @private\n     */\n    Hyperlink.prototype.destroy = function () {\n        this.linkInternal = undefined;\n        this.localRef = undefined;\n        this.typeInternal = undefined;\n        this.opensNewWindow = undefined;\n    };\n    return Hyperlink;\n}());\nexport { Hyperlink };\n/**\n * @private\n */\nvar ImageFormat = /** @class */ (function () {\n    /**\n     * Constructor for image format class\n     * @param imageContainer - Specifies for image width and height values.\n     */\n    function ImageFormat(imageContainer) {\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        this.width = imageContainer.width;\n        this.height = imageContainer.height;\n    }\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    ImageFormat.prototype.destroy = function () {\n        this.width = undefined;\n        this.height = undefined;\n    };\n    return ImageFormat;\n}());\nexport { ImageFormat };\n","import { Widget, BodyWidget, TableRowWidget, TableWidget, LineWidget, ElementBox, TextElementBox, ListTextElementBox, ImageElementBox, ParagraphWidget, TableCellWidget, FieldElementBox, BlockWidget, HeaderFooterWidget, BlockContainer, BookmarkElementBox } from '../viewer/page';\nimport { HelperMethods, Point } from '../editor/editor-helper';\nimport { SelectionCharacterFormat, SelectionCellFormat, SelectionParagraphFormat, SelectionRowFormat, SelectionSectionFormat, SelectionTableFormat, SelectionImageFormat } from './selection-format';\nimport { isNullOrUndefined, createElement, L10n } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WCharacterFormat, WParagraphFormat, WParagraphStyle } from '../index';\nimport { HtmlExport } from '../writer/html-export';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { TextPosition, SelectionWidgetInfo, Hyperlink } from './selection-helper';\n/**\n * Selection\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function Selection(documentEditor) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.upDownSelectionLength = 0;\n        /**\n         * @private\n         */\n        this.isSkipLayouting = false;\n        /**\n         * @private\n         */\n        this.isImageSelected = false;\n        this.contextTypeInternal = undefined;\n        /**\n         * @private\n         */\n        this.caret = undefined;\n        //Format Retrieval Field\n        /**\n         * @private\n         */\n        this.isRetrieveFormatting = false;\n        /**\n         * @private\n         */\n        this.skipFormatRetrieval = false;\n        this.isMoveDownOrMoveUp = false;\n        /**\n         * @private\n         */\n        this.selectedWidgets = undefined;\n        /**\n         * Hides caret.\n         * @private\n         */\n        this.hideCaret = function () {\n            _this.caret.style.display = 'none';\n        };\n        this.owner = documentEditor;\n        this.viewer = this.owner.viewer;\n        this.start = new TextPosition(this.owner);\n        this.end = new TextPosition(this.owner);\n        this.selectedWidgets = new Dictionary();\n        this.characterFormatIn = new SelectionCharacterFormat(this);\n        this.paragraphFormatIn = new SelectionParagraphFormat(this, this.viewer);\n        this.sectionFormatIn = new SelectionSectionFormat(this);\n        this.rowFormatIn = new SelectionRowFormat(this);\n        this.cellFormatIn = new SelectionCellFormat(this);\n        this.tableFormatIn = new SelectionTableFormat(this);\n        this.imageFormatInternal = new SelectionImageFormat(this);\n    }\n    Object.defineProperty(Selection.prototype, \"htmlWriter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.htmlWriterIn)) {\n                this.htmlWriterIn = new HtmlExport();\n            }\n            return this.htmlWriterIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"start\", {\n        /**\n         * Gets the start text position of last range in the selection\n         * @returns {TextPosition}\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.viewer)) {\n                if (isNullOrUndefined(this.startInternal)) {\n                    this.startInternal = this.owner.documentStart;\n                }\n                return this.startInternal;\n            }\n            return undefined;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.startInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"characterFormat\", {\n        //Format retrieval properties\n        /**\n         * Gets the instance of selection character format.\n         * @default undefined\n         * @return {SelectionCharacterFormat}\n         */\n        get: function () {\n            return this.characterFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"paragraphFormat\", {\n        /**\n         * Gets the instance of selection paragraph format.\n         * @default undefined\n         * @return {SelectionParagraphFormat}\n         */\n        get: function () {\n            return this.paragraphFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"sectionFormat\", {\n        /**\n         * Gets the instance of selection section format.\n         * @default undefined\n         * @return {SelectionSectionFormat}\n         */\n        get: function () {\n            return this.sectionFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"tableFormat\", {\n        /**\n         * Gets the instance of selection table format.\n         * @default undefined\n         * @return {SelectionTableFormat}\n         */\n        get: function () {\n            return this.tableFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"cellFormat\", {\n        /**\n         * Gets the instance of selection cell format.\n         * @default undefined\n         * @return {SelectionCellFormat}\n         */\n        get: function () {\n            return this.cellFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"rowFormat\", {\n        /**\n         * Gets the instance of selection row format.\n         * @default undefined\n         * @returns SelectionRowFormat\n         */\n        get: function () {\n            return this.rowFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"imageFormat\", {\n        /**\n         * Gets the instance of selection image format.\n         * @default undefined\n         * @returns SelectionImageFormat\n         */\n        get: function () {\n            return this.imageFormatInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"end\", {\n        /**\n         * Gets the start text position of selection range.\n         * @private\n         */\n        get: function () {\n            return this.endInternal;\n        },\n        /**\n         * For internal use\n         * @private\n         */\n        set: function (value) {\n            this.endInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"startPage\", {\n        /**\n         * Gets the page number where the selection ends.\n         * @private\n         */\n        get: function () {\n            if (!this.owner.isDocumentLoaded || isNullOrUndefined(this.viewer)\n                || isNullOrUndefined(this.viewer.selectionStartPage)) {\n                return 1;\n            }\n            return this.viewer.pages.indexOf(this.viewer.selectionStartPage) + 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"endPage\", {\n        /**\n         * Gets the page number where the selection ends.\n         * @private\n         */\n        get: function () {\n            if (!this.owner.isDocumentLoaded || isNullOrUndefined(this.viewer)\n                || isNullOrUndefined(this.viewer.selectionEndPage)) {\n                return 1;\n            }\n            return this.viewer.pages.indexOf(this.viewer.selectionEndPage) + 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isForward\", {\n        /**\n         * Determines whether the selection direction is forward or not.\n         * @default false\n         * @returns {boolean}\n         * @private\n         */\n        get: function () {\n            return this.start.isExistBefore(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isEmpty\", {\n        /**\n         * Determines whether the start and end positions are same or not.\n         * @default false\n         * @returns {boolean}\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.start)) {\n                return true;\n            }\n            return this.start.isAtSamePosition(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"text\", {\n        /**\n         * Gets the text within selection.\n         * @default ''\n         * @returns {string}\n         */\n        get: function () {\n            return this.getText(false);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"contextType\", {\n        /**\n         * Gets the context type of the selection.\n         */\n        get: function () {\n            return this.contextTypeInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isCleared\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return isNullOrUndefined(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Selection.prototype.getModuleName = function () {\n        return 'Selection';\n    };\n    //Public API\n    /**\n     * Moves the selection to the header of current page.\n     */\n    Selection.prototype.goToHeader = function () {\n        this.owner.enableHeaderAndFooter = true;\n        this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget);\n    };\n    /**\n     * Moves the selection to the footer of current page.\n     */\n    Selection.prototype.goToFooter = function () {\n        this.owner.enableHeaderAndFooter = true;\n        this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget);\n    };\n    /**\n     * Closes the header and footer region.\n     */\n    Selection.prototype.closeHeaderFooter = function () {\n        this.disableHeaderFooter();\n    };\n    /**\n     * Moves the selection to the start of specified page number.\n     */\n    Selection.prototype.goToPage = function (pageNumber) {\n        if (pageNumber >= 1 && pageNumber <= this.viewer.pages.length) {\n            var page = this.viewer.pages[pageNumber - 1];\n            this.updateTextPositionForBlockContainer(page.bodyWidgets[0]);\n        }\n    };\n    /**\n     * Selects the entire table if the context is within table.\n     */\n    Selection.prototype.selectTable = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableInternal();\n    };\n    /**\n     * Selects the entire row if the context is within table.\n     */\n    Selection.prototype.selectRow = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableRow();\n    };\n    /**\n     * Selects the entire column if the context is within table.\n     */\n    Selection.prototype.selectColumn = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectColumnInternal();\n    };\n    /**\n     * Selects the entire cell if the context is within table.\n     */\n    Selection.prototype.selectCell = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableCell();\n    };\n    /**\n     * Select content based on selection settings\n     */\n    Selection.prototype.select = function (selectionSettings) {\n        var point = new Point(selectionSettings.x, selectionSettings.y);\n        var pageCoordinates = this.viewer.findFocusedPage(point, true);\n        if (selectionSettings.extend) {\n            this.moveTextPosition(pageCoordinates, this.end);\n        }\n        else {\n            this.viewer.updateTextPositionForSelection(pageCoordinates, 1);\n        }\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleBold = function () {\n        if (this.owner.editorModule) {\n            this.owner.editorModule.toggleBold();\n        }\n    };\n    /**\n     * Toggles the italic property of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleItalic = function () {\n        if (this.owner.editorModule) {\n            this.owner.editorModule.toggleItalic();\n        }\n    };\n    /**\n     * Toggles the underline property of selected contents.\n     * @param underline Default value of ‘underline’ parameter is Single.\n     * @private\n     */\n    Selection.prototype.toggleUnderline = function (underline) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleUnderline(underline);\n        }\n    };\n    /**\n     * Toggles the strike through property of selected contents.\n     * @param {Strikethrough} strikethrough Default value of strikethrough parameter is SingleStrike.\n     * @private\n     */\n    Selection.prototype.toggleStrikethrough = function (strikethrough) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleStrikethrough(strikethrough);\n        }\n    };\n    /**\n     * Toggles the highlight color property of selected contents.\n     * @param {HighlightColor} highlightColor Default value of ‘underline’ parameter is Yellow.\n     * @private\n     */\n    Selection.prototype.toggleHighlightColor = function (highlightColor) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleHighlightColor(highlightColor);\n        }\n    };\n    /**\n     * Toggles the subscript formatting of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleSubscript = function () {\n        if (this.owner.editor) {\n            this.owner.editor.toggleSubscript();\n        }\n    };\n    /**\n     * Toggles the superscript formatting of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleSuperscript = function () {\n        if (this.owner.editor) {\n            this.owner.editor.toggleSuperscript();\n        }\n    };\n    /**\n     * Toggles the text alignment property of selected contents.\n     * @param {TextAlignment} textAlignment Default value of ‘textAlignment parameter is TextAlignment.Left.\n     * @private\n     */\n    Selection.prototype.toggleTextAlignment = function (textAlignment) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleTextAlignment(textAlignment);\n        }\n    };\n    /**\n     * Increases the left indent of selected paragraphs to a factor of 36 points.\n     * @private\n     */\n    Selection.prototype.increaseIndent = function () {\n        if (this.owner.editor) {\n            this.owner.editor.increaseIndent();\n        }\n    };\n    /**\n     * Decreases the left indent of selected paragraphs to a factor of 36 points.\n     * @private\n     */\n    Selection.prototype.decreaseIndent = function () {\n        if (this.owner.editor) {\n            this.owner.editor.decreaseIndent();\n        }\n    };\n    /**\n     * Fires the `requestNavigate` event if current selection context is in hyperlink.\n     */\n    Selection.prototype.navigateHyperlink = function () {\n        var fieldBegin = this.getHyperlinkField();\n        if (fieldBegin) {\n            this.fireRequestNavigate(fieldBegin);\n        }\n    };\n    /**\n     * Navigate Hyperlink\n     * @param fieldBegin\n     * @private\n     */\n    Selection.prototype.fireRequestNavigate = function (fieldBegin) {\n        var hyperlink = new Hyperlink(fieldBegin, this);\n        var eventArgs = {\n            isHandled: false,\n            navigationLink: hyperlink.navigationLink,\n            linkType: hyperlink.linkType,\n            localReference: hyperlink.localReference,\n            source: this.owner\n        };\n        this.owner.trigger('requestNavigate', eventArgs);\n        if (!eventArgs.isHandled) {\n            this.viewer.selection.navigateBookmark(hyperlink.localReference, true);\n        }\n    };\n    /**\n     * Copies the hyperlink URL if the context is within hyperlink.\n     */\n    Selection.prototype.copyHyperlink = function () {\n        var hyperLinkField = this.getHyperlinkField();\n        var linkText = this.getLinkText(hyperLinkField);\n        this.copyToClipboard(linkText);\n    };\n    //Selection add, Highlight, remove API starts\n    /**\n     * @private\n     */\n    Selection.prototype.highlightSelection = function (isSelectionChanged) {\n        if (this.owner.enableImageResizerMode) {\n            this.owner.imageResizerModule.hideImageResizer();\n        }\n        if (this.isEmpty) {\n            this.updateCaretPosition();\n        }\n        else {\n            if (this.isForward) {\n                this.highlightSelectedContent(this.start, this.end);\n            }\n            else {\n                this.highlightSelectedContent(this.end, this.start);\n            }\n            if (this.viewer.isComposingIME) {\n                this.updateCaretPosition();\n            }\n        }\n        this.viewer.updateTouchMarkPosition();\n        if (isSelectionChanged) {\n            this.viewer.scrollToPosition(this.start, this.end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.createHighlightBorder = function (lineWidget, width, left, top) {\n        if (width < 0) {\n            width = 0;\n        }\n        var page = this.getPage(lineWidget.paragraph);\n        var height = lineWidget.height;\n        var selectionWidget = undefined;\n        if (!this.selectedWidgets.containsKey(lineWidget)) {\n            selectionWidget = new SelectionWidgetInfo(left, width);\n            this.selectedWidgets.add(lineWidget, selectionWidget);\n        }\n        var viewer = this.viewer;\n        var pageTop = this.getPageTop(page);\n        var pageLeft = page.boundingRectangle.x;\n        if (viewer.containerTop <= pageTop\n            || pageTop < viewer.containerTop + viewer.selectionCanvas.height) {\n            var zoomFactor = viewer.zoomFactor;\n            this.clipSelection(page, pageTop);\n            if (this.viewer.isComposingIME) {\n                // tslint:disable-next-line:max-line-length\n                this.renderDashLine(viewer.selectionContext, page, lineWidget, (pageLeft + (left * zoomFactor)) - viewer.containerLeft, top, width * zoomFactor, height);\n            }\n            else {\n                viewer.selectionContext.fillStyle = 'gray';\n                viewer.selectionContext.globalAlpha = 0.4;\n                // tslint:disable-next-line:max-line-length\n                viewer.selectionContext.fillRect((pageLeft + (left * zoomFactor)) - viewer.containerLeft, (pageTop + (top * zoomFactor)) - viewer.containerTop, width * zoomFactor, height * zoomFactor);\n            }\n            viewer.selectionContext.restore();\n        }\n    };\n    /**\n     * Create selection highlight inside table\n     * @private\n     */\n    Selection.prototype.createHighlightBorderInsideTable = function (cellWidget) {\n        var page = this.getPage(cellWidget);\n        var selectionWidget = undefined;\n        var left = cellWidget.x - cellWidget.margin.left + cellWidget.leftBorderWidth;\n        var width = cellWidget.width + cellWidget.margin.left\n            + cellWidget.margin.right - cellWidget.leftBorderWidth - cellWidget.rightBorderWidth;\n        var top = cellWidget.y;\n        var height = cellWidget.height;\n        var pageTop = this.getPageTop(page);\n        var pageLeft = page.boundingRectangle.x;\n        var isVisiblePage = this.viewer.containerTop <= pageTop\n            || pageTop < this.viewer.containerTop + this.viewer.selectionCanvas.height;\n        if (this.selectedWidgets.containsKey(cellWidget)) {\n            selectionWidget = this.selectedWidgets.get(cellWidget);\n            if (isVisiblePage) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.selectionContext.clearRect((pageLeft + (selectionWidget.left * this.viewer.zoomFactor) - this.viewer.containerLeft), (pageTop + (top * this.viewer.zoomFactor)) - this.viewer.containerTop, selectionWidget.width * this.viewer.zoomFactor, height * this.viewer.zoomFactor);\n            }\n        }\n        selectionWidget = new SelectionWidgetInfo(left, width);\n        this.selectedWidgets.add(cellWidget, selectionWidget);\n        if (isVisiblePage) {\n            this.viewer.selectionContext.fillStyle = 'gray';\n            this.viewer.selectionContext.globalAlpha = 0.4;\n            var zoomFactor = this.viewer.zoomFactor;\n            this.clipSelection(page, pageTop);\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selectionContext.fillRect((pageLeft + (left * zoomFactor)) - this.viewer.containerLeft, (pageTop + (top * zoomFactor)) - this.viewer.containerTop, width * zoomFactor, height * zoomFactor);\n            this.viewer.selectionContext.restore();\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.clipSelection = function (page, pageTop) {\n        var viewer = this.viewer;\n        var width = page.boundingRectangle.width * viewer.zoomFactor;\n        var height = page.boundingRectangle.height * viewer.zoomFactor;\n        var left = page.boundingRectangle.x;\n        viewer.selectionContext.beginPath();\n        viewer.selectionContext.save();\n        viewer.selectionContext.rect(left - viewer.containerLeft, pageTop - viewer.containerTop, width, height);\n        viewer.selectionContext.clip();\n    };\n    /**\n     * Add selection highlight\n     * @private\n     */\n    Selection.prototype.addSelectionHighlight = function (canvasContext, widget, top) {\n        if (this.selectedWidgets.containsKey(widget)) {\n            var height = widget.height;\n            var widgetInfo = this.selectedWidgets.get(widget);\n            var width = this.viewer.render.getScaledValue(widgetInfo.width);\n            var left = this.viewer.render.getScaledValue(widgetInfo.left, 1);\n            var page = this.owner.selection.getPage(widget.paragraph);\n            this.owner.selection.clipSelection(page, this.owner.selection.getPageTop(page));\n            if (this.viewer.isComposingIME) {\n                this.renderDashLine(canvasContext, page, widget, left, top, width, height);\n            }\n            else {\n                height = this.viewer.render.getScaledValue(height);\n                canvasContext.globalAlpha = 0.4;\n                canvasContext.fillStyle = 'gray';\n                canvasContext.fillRect(left, this.viewer.render.getScaledValue(top, 2), width, height);\n            }\n            canvasContext.restore();\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.renderDashLine = function (ctx, page, widget, left, top, width, height) {\n        var fontColor = this.characterFormat.fontColor;\n        var fillColor = fontColor ? this.viewer.render.getColor(fontColor) : '#000000';\n        ctx.globalAlpha = 1;\n        // Get character format copied from selection format\n        var format = this.owner.editor.copyInsertFormat(new WCharacterFormat(), false);\n        var heightInfo = this.viewer.textHelper.getHeight(format);\n        var pageTop = this.getPageTop(page);\n        var descent = heightInfo.Height - heightInfo.BaselineOffset;\n        top = this.viewer.render.getUnderlineYPosition(widget) + top + 4 - descent;\n        // tslint:disable-next-line:max-line-length\n        this.viewer.render.renderDashLine(ctx, left, (pageTop - this.viewer.containerTop) + (top * this.viewer.zoomFactor), width, fillColor, true);\n    };\n    /**\n     * Add Selection highlight inside table\n     * @private\n     */\n    Selection.prototype.addSelectionHighlightTable = function (canvasContext, tableCellWidget) {\n        if (this.selectedWidgets.containsKey(tableCellWidget)) {\n            var selectionWidget = this.selectedWidgets.get(tableCellWidget);\n            var left = this.viewer.render.getScaledValue(selectionWidget.left, 1);\n            var top_1 = this.viewer.render.getScaledValue(tableCellWidget.y, 2);\n            var width = this.viewer.render.getScaledValue(selectionWidget.width);\n            var height = this.viewer.render.getScaledValue(tableCellWidget.height);\n            canvasContext.fillStyle = 'gray';\n            var page = this.owner.selection.getPage(tableCellWidget);\n            this.owner.selection.clipSelection(page, this.owner.selection.getPageTop(page));\n            canvasContext.fillRect(left, top_1, width, height);\n            canvasContext.restore();\n        }\n    };\n    /**\n     * Remove Selection highlight\n     * @private\n     */\n    Selection.prototype.removeSelectionHighlight = function (widget) {\n        var left = 0;\n        var top = 0;\n        var width = 0;\n        var height = 0;\n        var page = undefined;\n        if (widget instanceof LineWidget) {\n            var lineWidget = widget;\n            var currentParaWidget = lineWidget.paragraph;\n            page = !isNullOrUndefined(currentParaWidget) ?\n                this.getPage((lineWidget.paragraph)) : undefined;\n            if (isNullOrUndefined(page)) {\n                return;\n            }\n            top = this.getTop(lineWidget);\n            height = lineWidget.height;\n        }\n        else if (widget instanceof TableCellWidget) {\n            page = !isNullOrUndefined(widget) ?\n                this.getPage(widget) : undefined;\n            if (isNullOrUndefined(page)) {\n                return;\n            }\n            top = widget.y;\n            height = widget.height;\n        }\n        if (isNullOrUndefined(page)) {\n            return;\n        }\n        var widgetInfo = this.selectedWidgets.get(widget);\n        width = widgetInfo.width;\n        left = widgetInfo.left;\n        var pageRect = page.boundingRectangle;\n        var pageIndex = this.viewer.pages.indexOf(page);\n        var pageGap = this.viewer.pageGap;\n        var pageTop = (pageRect.y - pageGap * (pageIndex + 1)) * this.viewer.zoomFactor + pageGap * (pageIndex + 1);\n        var pageLeft = pageRect.x;\n        var zoomFactor = this.viewer.zoomFactor;\n        if (this.viewer.containerTop <= pageTop\n            || pageTop < this.viewer.containerTop + this.viewer.selectionCanvas.height) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selectionContext.clearRect((pageLeft + (left * zoomFactor) - this.viewer.containerLeft) - 0.5, (pageTop + (top * zoomFactor)) - this.viewer.containerTop - 0.5, width * zoomFactor + 0.5, height * zoomFactor + 0.5);\n        }\n    };\n    /**\n     * Select Current word\n     * @private\n     */\n    Selection.prototype.selectCurrentWord = function () {\n        var startPosition = this.start.clone();\n        var endPosition = this.end.clone();\n        this.selectCurrentWordRange(startPosition, endPosition, false);\n        this.selectRange(startPosition, endPosition);\n    };\n    /**\n     * Select current paragraph\n     * @private\n     */\n    Selection.prototype.selectCurrentParagraph = function () {\n        if (!isNullOrUndefined(this.start)) {\n            this.start.paragraphStartInternal(this, false);\n            this.end.moveToParagraphEndInternal(this, false);\n            this.upDownSelectionLength = this.end.location.x;\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select current word range\n     * @private\n     */\n    Selection.prototype.selectCurrentWordRange = function (startPosition, endPosition, excludeSpace) {\n        if (!isNullOrUndefined(startPosition)) {\n            if (startPosition.offset > 0) {\n                var wordStart = startPosition.clone();\n                var indexInInline = 0;\n                var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, indexInInline);\n                var inline = inlineObj.element;\n                indexInInline = inlineObj.index;\n                if (!isNullOrUndefined(inline) && inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    // tslint:disable-next-line:max-line-length\n                    if (startPosition.offset > 2 && (!isNullOrUndefined(inline.fieldSeparator) || isNullOrUndefined(inline.fieldBegin))) {\n                        wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 2);\n                        wordStart.moveToWordEndInternal(0, false);\n                        if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset - 1)) {\n                            startPosition.moveToWordStartInternal(2);\n                        }\n                    }\n                    else if (startPosition.offset > 3 && isNullOrUndefined(inline.fieldSeparator)) {\n                        wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 3);\n                        wordStart.moveToWordEndInternal(0, false);\n                        if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset)) {\n                            startPosition.moveToWordStartInternal(2);\n                        }\n                    }\n                }\n                else {\n                    wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 1);\n                    wordStart.moveToWordEndInternal(0, false);\n                    if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset)) {\n                        startPosition.moveToWordStartInternal(2);\n                    }\n                }\n            }\n            endPosition.moveToWordEndInternal(2, excludeSpace);\n        }\n    };\n    /**\n     * Extend selection to paragraph start\n     * @private\n     */\n    Selection.prototype.extendToParagraphStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.paragraphStartInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to paragraph end\n     * @private\n     */\n    Selection.prototype.extendToParagraphEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToParagraphEndInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to next text position\n     * @private\n     */\n    Selection.prototype.moveNextPosition = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (this.isEmpty) {\n            this.start.moveNextPosition();\n            this.end.setPositionInternal(this.start);\n        }\n        this.updateForwardSelection();\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to next paragraph\n     * @private\n     */\n    Selection.prototype.moveToNextParagraph = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToNextParagraphStartInternal();\n        this.start.setPositionInternal(this.end);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to previous text position\n     * @private\n     */\n    Selection.prototype.movePreviousPosition = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (this.isEmpty) {\n            this.start.movePreviousPosition();\n            this.end.setPositionInternal(this.start);\n        }\n        this.updateBackwardSelection();\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to previous paragraph\n     * @private\n     */\n    Selection.prototype.moveToPreviousParagraph = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToPreviousParagraph(this);\n        this.start.setPositionInternal(this.end);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to previous line\n     * @private\n     */\n    Selection.prototype.extendToPreviousLine = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToPreviousLine(this, this.upDownSelectionLength);\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to line end\n     * @private\n     */\n    Selection.prototype.extendToLineEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToLineEndInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend to line start\n     * @private\n     */\n    Selection.prototype.extendToLineStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToLineStartInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.moveUp = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.end.setPositionInternal(this.start);\n            }\n            else {\n                this.start.setPositionInternal(this.end);\n            }\n            this.upDownSelectionLength = this.start.location.x;\n        }\n        this.upDownSelectionLength = this.start.location.x;\n        this.start.moveUp(this, this.upDownSelectionLength);\n        this.end.setPositionInternal(this.start);\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.moveDown = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.setPositionInternal(this.end);\n            }\n            else {\n                this.end.setPositionInternal(this.start);\n            }\n            this.upDownSelectionLength = this.start.location.x;\n        }\n        this.start.moveDown(this, this.upDownSelectionLength);\n        this.end.setPositionInternal(this.start);\n        this.fireSelectionChanged(true);\n    };\n    Selection.prototype.updateForwardSelection = function () {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.setPositionInternal(this.end);\n            }\n            else {\n                this.end.setPositionInternal(this.start);\n            }\n        }\n    };\n    Selection.prototype.updateBackwardSelection = function () {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.end.setPositionInternal(this.start);\n            }\n            else {\n                this.start.setPositionInternal(this.end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlockInFirstCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var firstrow = table.childWidgets[0];\n            if (firstrow.childWidgets.length > 0) {\n                var firstcell = firstrow.childWidgets[0];\n                if (firstcell.childWidgets.length === 0) {\n                    return undefined;\n                }\n                return firstcell.childWidgets[0];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getFirstCellInRegion = function (row, startCell, selectionLength, isMovePrevious) {\n        var cellStart = this.getCellLeft(row, startCell);\n        var cellEnd = cellStart + startCell.cellFormat.cellWidth;\n        var flag = true;\n        if (cellStart <= selectionLength && selectionLength < cellEnd) {\n            for (var k = 0; k < row.childWidgets.length; k++) {\n                var left = this.getCellLeft(row, row.childWidgets[k]);\n                if (HelperMethods.round(cellStart, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(cellEnd, 2)) {\n                    flag = false;\n                    return row.childWidgets[k];\n                }\n            }\n        }\n        else {\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cellLeft = this.getCellLeft(row, row.childWidgets[j]);\n                if (cellLeft <= selectionLength && cellLeft +\n                    row.childWidgets[j].cellFormat.cellWidth > selectionLength) {\n                    flag = false;\n                    return row.childWidgets[j];\n                }\n            }\n        }\n        if (flag) {\n            if (!isNullOrUndefined(row.previousRenderedWidget) && isMovePrevious) {\n                var previousWidget = row.previousRenderedWidget;\n                return this.getFirstCellInRegion(previousWidget, startCell, selectionLength, isMovePrevious);\n            }\n            else if (!isNullOrUndefined(row.nextRenderedWidget) && !isMovePrevious) {\n                return this.getFirstCellInRegion(row.nextRenderedWidget, startCell, selectionLength, isMovePrevious);\n            }\n        }\n        return row.childWidgets[0];\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstParagraph = function (tableCell) {\n        while (tableCell.previousSplitWidget) {\n            tableCell = tableCell.previousSplitWidget;\n        }\n        var firstBlock = tableCell.firstChild;\n        return this.getFirstParagraphBlock(firstBlock);\n    };\n    /**\n     * Get last block in last cell\n     * @private\n     */\n    //Table\n    Selection.prototype.getLastBlockInLastCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastrow = table.childWidgets[table.childWidgets.length - 1];\n            var lastcell = lastrow.childWidgets[lastrow.childWidgets.length - 1];\n            return lastcell.childWidgets[lastcell.childWidgets.length - 1];\n        }\n        return undefined;\n    };\n    /**\n     * Move to line start\n     * @private\n     */\n    Selection.prototype.moveToLineStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.updateBackwardSelection();\n        this.start.moveToLineStartInternal(this, false);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to line end\n     * @private\n     */\n    Selection.prototype.moveToLineEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.updateForwardSelection();\n        this.start.moveToLineEndInternal(this, false);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Get Page top\n     * @private\n     */\n    Selection.prototype.getPageTop = function (page) {\n        // tslint:disable-next-line:max-line-length\n        return (page.boundingRectangle.y - this.viewer.pageGap * (this.viewer.pages.indexOf(page) + 1)) * this.viewer.zoomFactor + this.viewer.pageGap * (this.viewer.pages.indexOf(page) + 1);\n    };\n    /**\n     * Move text position to cursor point\n     * @private\n     */\n    Selection.prototype.moveTextPosition = function (cursorPoint, textPosition) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        //Updates the text position based on the cursor position.\n        var widget = this.viewer.getLineWidgetInternal(cursorPoint, true);\n        if (!isNullOrUndefined(widget)) {\n            this.updateTextPositionWidget(widget, cursorPoint, textPosition, true);\n        }\n        this.upDownSelectionLength = textPosition.location.x;\n        var selectionStartIndex = this.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.end.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            // Extends selection end to field begin or field end.\n            if (TextPosition.isForwardSelection(selectionStartIndex, selectionEndIndex)) {\n                textPosition.validateForwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n            else {\n                textPosition.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n        }\n        this.fireSelectionChanged(true);\n    };\n    //Helper Method Implementation \n    //Document\n    /**\n     * Get document start position\n     * @private\n     */\n    Selection.prototype.getDocumentStart = function () {\n        var textPosition = undefined;\n        var block = this.viewer.pages[0].bodyWidgets[0].childWidgets[0];\n        return this.setPositionForBlock(block, true);\n    };\n    /**\n     * Get document end position\n     * @private\n     */\n    Selection.prototype.getDocumentEnd = function () {\n        var textPosition = undefined;\n        var documentStart = this.owner.documentStart;\n        var lastPage = this.viewer.pages[this.viewer.pages.length - 1];\n        if (!isNullOrUndefined(documentStart) && lastPage.bodyWidgets[0].childWidgets.length > 0) {\n            var block = undefined;\n            var section = lastPage.bodyWidgets[0];\n            var blocks = section.childWidgets;\n            var lastBlkItem = blocks.length - 1;\n            var lastBlock = blocks[lastBlkItem];\n            if (lastBlock instanceof BlockWidget) {\n                block = lastBlock;\n            }\n            textPosition = this.setPositionForBlock(block, false);\n        }\n        return textPosition;\n    };\n    //Keyboard shortcut internal API\n    /**\n     * @private\n     * Handles control end key.\n     */\n    Selection.prototype.handleControlEndKey = function () {\n        var documentEnd = undefined;\n        if (!isNullOrUndefined(this.owner.documentEnd)) {\n            documentEnd = this.owner.documentEnd;\n        }\n        if (!isNullOrUndefined(documentEnd)) {\n            this.owner.selection.selectContent(documentEnd, true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control home key.\n     */\n    Selection.prototype.handleControlHomeKey = function () {\n        var documentStart = undefined;\n        if (!isNullOrUndefined(this.owner.documentStart)) {\n            documentStart = this.owner.documentStart;\n        }\n        if (!isNullOrUndefined(documentStart)) {\n            this.owner.selection.selectContent(documentStart, true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control left key.\n     */\n    Selection.prototype.handleControlLeftKey = function () {\n        this.extendToWordStart(true);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control right key.\n     */\n    Selection.prototype.handleControlRightKey = function () {\n        this.extendToWordEnd(true);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control down key.\n     * @private\n     */\n    Selection.prototype.handleControlDownKey = function () {\n        this.moveToNextParagraph();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control up key.\n     * @private\n     */\n    Selection.prototype.handleControlUpKey = function () {\n        this.moveToPreviousParagraph();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles shift left key.\n     */\n    Selection.prototype.handleShiftLeftKey = function () {\n        this.extendBackward();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift up key.\n     * @private\n     */\n    Selection.prototype.handleShiftUpKey = function () {\n        this.extendToPreviousLine();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift right key.\n     * @private\n     */\n    Selection.prototype.handleShiftRightKey = function () {\n        this.extendForward();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift down key.\n     * @private\n     */\n    Selection.prototype.handleShiftDownKey = function () {\n        this.extendToNextLine();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control shift left key.\n     */\n    Selection.prototype.handleControlShiftLeftKey = function () {\n        this.extendToWordStart(false);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift up key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftUpKey = function () {\n        this.extendToParagraphStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift right key\n     * @private\n     */\n    Selection.prototype.handleControlShiftRightKey = function () {\n        this.extendToWordEnd(false);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift down key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftDownKey = function () {\n        this.extendToParagraphEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles left key.\n     * @private\n     */\n    Selection.prototype.handleLeftKey = function () {\n        this.movePreviousPosition();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles up key.\n     * @private\n     */\n    Selection.prototype.handleUpKey = function () {\n        this.isMoveDownOrMoveUp = true;\n        this.moveUp();\n        this.isMoveDownOrMoveUp = false;\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles right key.\n     * @private\n     */\n    Selection.prototype.handleRightKey = function () {\n        this.moveNextPosition();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles end key.\n     * @private\n     */\n    Selection.prototype.handleEndKey = function () {\n        this.moveToLineEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles home key.\n     * @private\n     */\n    Selection.prototype.handleHomeKey = function () {\n        this.moveToLineStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles down key.\n     * @private\n     */\n    Selection.prototype.handleDownKey = function () {\n        this.isMoveDownOrMoveUp = true;\n        this.moveDown();\n        this.isMoveDownOrMoveUp = false;\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift end key.\n     * @private\n     */\n    Selection.prototype.handleShiftEndKey = function () {\n        this.extendToLineEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift home key.\n     * @private\n     */\n    Selection.prototype.handleShiftHomeKey = function () {\n        this.extendToLineStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift end key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftEndKey = function () {\n        var documentEnd = undefined;\n        if (!isNullOrUndefined(this.owner.documentEnd)) {\n            documentEnd = this.owner.documentEnd;\n        }\n        if (!isNullOrUndefined(documentEnd)) {\n            this.end.setPosition(documentEnd.currentWidget, false);\n            this.fireSelectionChanged(true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift home key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftHomeKey = function () {\n        var documentStart = undefined;\n        if (!isNullOrUndefined(this.owner.documentStart)) {\n            documentStart = this.owner.documentStart;\n        }\n        if (!isNullOrUndefined(documentStart)) {\n            this.end.setPositionInternal(documentStart);\n            this.fireSelectionChanged(true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles tab key.\n     * @param isNavigateInCell\n     * @param isShiftTab\n     * @private\n     */\n    Selection.prototype.handleTabKey = function (isNavigateInCell, isShiftTab) {\n        var start = this.start;\n        if (isNullOrUndefined(start)) {\n            return;\n        }\n        if (start.paragraph.isInsideTable && this.end.paragraph.isInsideTable && (isNavigateInCell || isShiftTab)) {\n            //Perform tab navigation\n            if (isShiftTab) {\n                this.selectPreviousCell();\n            }\n            else {\n                this.selectNextCell();\n            }\n        }\n        else if ((isNavigateInCell || isShiftTab) && !isNullOrUndefined(start) && start.offset === this.getStartOffset(start.paragraph)\n            && !isNullOrUndefined(start.paragraph.paragraphFormat) && !isNullOrUndefined(start.paragraph.paragraphFormat.listFormat)\n            && start.paragraph.paragraphFormat.listFormat.listId !== -1 && !this.owner.isReadOnlyMode) {\n            this.owner.editorModule.updateListLevel(isShiftTab ? false : true);\n        }\n        else if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.handleTextInput('\\t');\n        }\n        this.checkForCursorVisibility();\n    };\n    Selection.prototype.selectPreviousCell = function () {\n        var tableCell = this.start.paragraph.associatedCell;\n        var tableRow = tableCell.ownerRow;\n        var tableAdv = tableRow.ownerTable;\n        if (isNullOrUndefined(tableCell.previousWidget)) {\n            if (!isNullOrUndefined(tableRow.previousRenderedWidget)) {\n                //Move text selection or cursor to previous row's last cell\n                var prevRow = undefined;\n                if (tableRow.previousRenderedWidget instanceof TableRowWidget) {\n                    prevRow = tableRow.previousRenderedWidget;\n                }\n                this.selectTableCellInternal(prevRow.childWidgets[prevRow.childWidgets.length - 1], true);\n            }\n        }\n        else {\n            //Move text selection or cursor to next cell in current row\n            var prevCell = undefined;\n            if (tableCell.previousWidget instanceof TableCellWidget) {\n                prevCell = tableCell.previousWidget;\n            }\n            this.selectTableCellInternal(prevCell, true);\n        }\n    };\n    Selection.prototype.selectNextCell = function () {\n        var tableCell = this.start.paragraph.associatedCell;\n        var tableRow = tableCell.ownerRow;\n        var tableAdv = tableRow.ownerTable;\n        if (isNullOrUndefined(tableCell.nextWidget)) {\n            if (isNullOrUndefined(tableRow.nextRenderedWidget) && !this.owner.isReadOnlyMode) {\n                //Insert new row below                  \n                this.owner.editorModule.insertRow(false);\n            }\n            else {\n                //Move text selection or cursor to next row's first cell\n                var nextRow = undefined;\n                if (tableRow.nextRenderedWidget instanceof TableRowWidget) {\n                    nextRow = tableRow.nextRenderedWidget;\n                }\n                this.selectTableCellInternal(nextRow.childWidgets[0], true);\n            }\n            // }\n        }\n        else {\n            //Move text selection or cursor to next cell in current row\n            var nextCell = undefined;\n            if (tableCell.nextRenderedWidget instanceof TableCellWidget) {\n                nextCell = tableCell.nextRenderedWidget;\n            }\n            this.selectTableCellInternal(nextCell, true);\n        }\n    };\n    /**\n     * Select given table cell\n     * @private\n     */\n    Selection.prototype.selectTableCellInternal = function (tableCell, clearMultiSelection) {\n        var firstParagraph = this.getFirstParagraph(tableCell);\n        var lastParagraph = this.getLastParagraph(tableCell);\n        if (firstParagraph === lastParagraph && lastParagraph.isEmpty()) {\n            this.selectParagraph(lastParagraph, true);\n        }\n        else {\n            var firstLineWidget = lastParagraph.childWidgets[0];\n            this.start.setPosition(firstParagraph.childWidgets[0], true);\n            this.end.setPositionParagraph(firstLineWidget, firstLineWidget.getEndOffset());\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select while table\n     * @private\n     */\n    Selection.prototype.selectTableInternal = function () {\n        var start = this.start;\n        var end = this.end;\n        if (!this.isForward) {\n            start = this.end;\n            end = this.start;\n        }\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(this.getTable(start, end))) {\n            var containerCell = this.getContainerCellOf(start.paragraph.associatedCell, end.paragraph.associatedCell);\n            var table = containerCell.ownerTable;\n            var firstPara = this.getFirstParagraphBlock(table);\n            var lastPara = this.getLastParagraphBlock(table);\n            var offset = lastPara.lastChild.getEndOffset();\n            this.start.setPosition(firstPara.childWidgets[0], true);\n            this.end.setPositionParagraph(lastPara.lastChild, offset + 1);\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single column\n     * @private\n     */\n    Selection.prototype.selectColumnInternal = function () {\n        var startTextPos = this.start;\n        var endTextPos = this.end;\n        if (!this.isForward) {\n            startTextPos = this.end;\n            endTextPos = this.start;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(startTextPos) && !isNullOrUndefined(endTextPos) && !isNullOrUndefined(this.getTable(startTextPos, endTextPos))) {\n            var containerCell = this.getContainerCellOf(startTextPos.paragraph.associatedCell, endTextPos.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(endTextPos.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(startTextPos.paragraph.associatedCell, containerCell);\n                var endCell = this.getSelectedCell(endTextPos.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, endTextPos.paragraph.associatedCell)) {\n                    var row = startCell.ownerRow;\n                    var columnCells = containerCell.ownerTable.getColumnCellsForSelection(containerCell, containerCell);\n                    if (columnCells.length > 0) {\n                        var firstPara = this.getFirstParagraph(columnCells[0]);\n                        var lastPara = this.getLastParagraph(columnCells[columnCells.length - 1]);\n                        this.start.setPosition(firstPara.firstChild, true);\n                        var lastLine = lastPara.lastChild;\n                        this.end.setPositionParagraph(lastLine, lastLine.getEndOffset() + 1);\n                    }\n                }\n                else {\n                    var startCellColumnCells = containerCell.ownerTable.getColumnCellsForSelection(startCell, startCell);\n                    var endCellColumnCells = containerCell.ownerTable.getColumnCellsForSelection(endCell, endCell);\n                    if (startCellColumnCells.length > 0 && endCellColumnCells.length > 0) {\n                        var firstPara = this.getFirstParagraph(startCellColumnCells[0]);\n                        // tslint:disable-next-line:max-line-length\n                        var lastPara = this.getLastParagraph(endCellColumnCells[endCellColumnCells.length - 1]);\n                        this.start.setPosition(firstPara.firstChild, true);\n                        var lastLine = lastPara.lastChild;\n                        this.end.setPositionParagraph(lastLine, lastLine.getEndOffset() + 1);\n                    }\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single row\n     * @private\n     */\n    Selection.prototype.selectTableRow = function () {\n        var startPos = this.start;\n        var endPos = this.end;\n        if (!this.isForward) {\n            startPos = this.end;\n            endPos = this.start;\n        }\n        if (!isNullOrUndefined(startPos) && !isNullOrUndefined(endPos) && !isNullOrUndefined(this.getTable(startPos, endPos))) {\n            var containerCell = void 0;\n            containerCell = this.getContainerCellOf(startPos.paragraph.associatedCell, endPos.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(endPos.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(startPos.paragraph.associatedCell, containerCell);\n                var endCell = this.getSelectedCell(endPos.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, endPos.paragraph.associatedCell)) {\n                    var row = startCell.ownerRow;\n                    var firstPara = this.getFirstParagraph(row.childWidgets[0]);\n                    var lastPara = this.getLastParagraph(row.childWidgets[row.childWidgets.length - 1]);\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n                else {\n                    var firstPara = this.getFirstParagraph(startCell.ownerRow.childWidgets[0]);\n                    var lastPara = void 0;\n                    // tslint:disable-next-line:max-line-length\n                    lastPara = this.getLastParagraph(endCell.ownerRow.childWidgets[endCell.ownerRow.childWidgets.length - 1]);\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single cell\n     * @private\n     */\n    Selection.prototype.selectTableCell = function () {\n        var start = this.start;\n        var end = this.end;\n        if (!this.isForward) {\n            start = this.end;\n            end = this.start;\n        }\n        if (isNullOrUndefined(this.getTable(start, end))) {\n            return;\n        }\n        if (this.isEmpty) {\n            if (start.paragraph.isInsideTable && !isNullOrUndefined(start.paragraph.associatedCell)) {\n                var firstPara = this.getFirstParagraph(start.paragraph.associatedCell);\n                var lastPara = this.getLastParagraph(end.paragraph.associatedCell);\n                if (firstPara === lastPara) {\n                    this.start.setPosition(lastPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n                else {\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        else {\n            var containerCell = this.getContainerCell(start.paragraph.associatedCell);\n            // tslint:disable-next-line:max-line-length\n            if (this.containsCell(containerCell, start.paragraph.associatedCell) && this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                var firstPara = this.getFirstParagraph(containerCell);\n                var lastPara = this.getLastParagraph(containerCell);\n                if (!isNullOrUndefined(firstPara) && !isNullOrUndefined(lastPara)) {\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * @private\n     * Selects the entire document.\n     */\n    Selection.prototype.selectAll = function () {\n        var documentStart;\n        var documentEnd;\n        if (this.owner.enableHeaderAndFooter) {\n            var headerFooter = this.getContainerWidget(this.start.paragraph);\n            documentStart = this.setPositionForBlock(headerFooter.firstChild, true);\n            documentEnd = this.setPositionForBlock(headerFooter.lastChild, false);\n        }\n        else {\n            documentStart = this.owner.documentStart;\n            documentEnd = this.owner.documentEnd;\n        }\n        //Selects the entire document.        \n        if (!isNullOrUndefined(documentStart)) {\n            this.start.setPositionInternal(documentStart);\n            this.end.setPositionParagraph(documentEnd.currentWidget, documentEnd.offset + 1);\n            this.upDownSelectionLength = this.end.location.x;\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Extend selection backward\n     * @private\n     */\n    Selection.prototype.extendBackward = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveBackward();\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extent selection forward\n     * @private\n     */\n    Selection.prototype.extendForward = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveForward();\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to word start and end\n     * @private\n     */\n    Selection.prototype.extendToWordStartEnd = function () {\n        if ((this.start.paragraph.isInsideTable || this.end.paragraph.isInsideTable)\n            && (this.start.paragraph.associatedCell !== this.end.paragraph.associatedCell\n                || this.isCellSelected(this.start.paragraph.associatedCell, this.start, this.end))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Extend selection to word start\n     * @private\n     */\n    Selection.prototype.extendToWordStart = function (isNavigation) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        var isCellSelected = this.extendToWordStartEnd();\n        if (isCellSelected) {\n            this.end.moveToPreviousParagraphInTable(this);\n        }\n        else {\n            this.end.moveToWordStartInternal(isNavigation ? 0 : 1);\n        }\n        if (isNavigation) {\n            this.start.setPositionInternal(this.end);\n        }\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extent selection to word end\n     * @private\n     */\n    Selection.prototype.extendToWordEnd = function (isNavigation) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        var isCellSelect = this.extendToWordStartEnd();\n        if (isCellSelect) {\n            this.end.moveToNextParagraphInTable();\n        }\n        else {\n            this.end.moveToWordEndInternal(isNavigation ? 0 : 1, false);\n        }\n        if (isNavigation) {\n            this.start.setPositionInternal(this.end);\n        }\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to next line\n     * @private\n     */\n    Selection.prototype.extendToNextLine = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToNextLine(this.upDownSelectionLength);\n        this.fireSelectionChanged(true);\n    };\n    //Selection Text get API\n    //Selection add, Highlight, remove API enda\n    Selection.prototype.getTextPosition = function (hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(hierarchicalIndex);\n        return textPosition;\n    };\n    /**\n     * Get Selected text\n     * @private\n     */\n    Selection.prototype.getText = function (includeObject) {\n        if (isNullOrUndefined(this.start) || isNullOrUndefined(this.end)\n            || isNullOrUndefined(this.start.paragraph) || isNullOrUndefined(this.end.paragraph)) {\n            return undefined;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (startPosition.isAtSamePosition(endPosition)) {\n            return '';\n        }\n        return this.getTextInternal(startPosition, endPosition, includeObject);\n    };\n    /**\n     * Get selected text\n     * @private\n     */\n    Selection.prototype.getTextInternal = function (start, end, includeObject) {\n        if (start.isExistAfter(end)) {\n            var temp = end;\n            end = start;\n            start = temp;\n        }\n        var startPosition = start;\n        var endPosition = end;\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(start.paragraph) && !isNullOrUndefined(end.paragraph)) {\n            var startIndex = 0;\n            var endIndex = 0;\n            var startOffset = start.offset;\n            var endOffset = end.offset;\n            var startInlineObj = start.currentWidget.getInline(startOffset, startIndex);\n            startIndex = startInlineObj.index;\n            var inline = startInlineObj.element;\n            // If the start position is at the beginning of field begin that has field end, then field code should be skipped.\n            if (inline instanceof FieldElementBox && !isNullOrUndefined(inline.fieldEnd)) {\n                var elementInfo = this.getRenderedInline(inline, startIndex);\n                inline = elementInfo.element;\n                startIndex = elementInfo.index;\n            }\n            var endInlineObj = end.currentWidget.getInline(endOffset, endIndex);\n            var endInline = endInlineObj.element;\n            endIndex = endInlineObj.index;\n            var text = '';\n            // Retrieves the text from start inline.\n            if (inline instanceof ImageElementBox && includeObject && startIndex === 0) {\n                text = ElementBox.objectCharacter;\n            }\n            else if (inline instanceof TextElementBox) {\n                // tslint:disable-next-line:max-line-length\n                text = ((isNullOrUndefined(inline.text)) || (inline.text) === '') || inline.text.length < startIndex ? text : inline.text.substring(startIndex);\n            }\n            if (startPosition.paragraph === endPosition.paragraph) {\n                if (inline instanceof ElementBox) {\n                    if (inline === endInline && inline instanceof TextElementBox) {\n                        text = text.length < endIndex - startIndex ? text : text.substring(0, endIndex - startIndex);\n                    }\n                    else if (inline.nextNode instanceof ElementBox) {\n                        // tslint:disable-next-line:max-line-length\n                        text = text + this.getTextInline(inline.nextNode, endPosition.paragraph, endInline, endIndex, includeObject);\n                    }\n                }\n            }\n            else {\n                if (inline instanceof ElementBox && inline.nextNode instanceof ElementBox) {\n                    text = text + this.getTextInline(inline.nextNode, endPosition.paragraph, undefined, 0, includeObject);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    var nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(startPosition.paragraph);\n                    text = text + '\\r';\n                    while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.isEmpty()) {\n                        text = text + '\\r';\n                        if (nextParagraphWidget === endPosition.paragraph) {\n                            return text;\n                        }\n                        nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(nextParagraphWidget);\n                    }\n                    if (!isNullOrUndefined(nextParagraphWidget) && !nextParagraphWidget.isEmpty()) {\n                        // tslint:disable-next-line:max-line-length\n                        text = text + this.getTextInline(nextParagraphWidget.childWidgets[0].children[0], endPosition.paragraph, endInline, endIndex, includeObject);\n                    }\n                }\n            }\n            // If the selection includes end paragraph mark.\n            if (endOffset === (endPosition.currentWidget).getEndOffset() + 1) {\n                text = text + '\\r';\n            }\n            return text;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getListTextElementBox = function (paragarph) {\n        if (isNullOrUndefined(paragarph)) {\n            return undefined;\n        }\n        var listTextElement;\n        if (!paragarph.isEmpty()) {\n            var lineWidget = paragarph.childWidgets[0];\n            if (lineWidget.children.length > 1) {\n                if (lineWidget.children[0] instanceof ListTextElementBox) {\n                    listTextElement = lineWidget.children[0];\n                }\n            }\n        }\n        return listTextElement;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getTextInline = function (inlineElement, endParagraphWidget, endInline, endIndex, includeObject) {\n        var text = '';\n        do {\n            if (inlineElement === endInline) {\n                if (inlineElement instanceof TextElementBox) {\n                    var span = inlineElement;\n                    if (!(isNullOrUndefined(span.text) || span.text === '')) {\n                        if (span.text.length < endIndex) {\n                            text = text + span.text;\n                        }\n                        else {\n                            text = text + span.text.substring(0, endIndex);\n                        }\n                    }\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (inlineElement instanceof ImageElementBox && includeObject && endIndex === inlineElement.length) {\n                    text = text + ElementBox.objectCharacter;\n                }\n                return text;\n            }\n            if (inlineElement instanceof TextElementBox) {\n                text = text + inlineElement.text;\n            }\n            else if (inlineElement instanceof ImageElementBox && includeObject) {\n                text = text + ElementBox.objectCharacter;\n            }\n            else if (inlineElement instanceof FieldElementBox && !isNullOrUndefined(inlineElement.fieldEnd)) {\n                if (!isNullOrUndefined(inlineElement.fieldSeparator)) {\n                    inlineElement = inlineElement.fieldSeparator;\n                }\n                else {\n                    inlineElement = inlineElement.fieldEnd;\n                }\n            }\n            if (isNullOrUndefined(inlineElement.nextNode)) {\n                break;\n            }\n            inlineElement = inlineElement.nextNode;\n        } while (!isNullOrUndefined(inlineElement));\n        if (endParagraphWidget === inlineElement.line.paragraph) {\n            return text;\n        }\n        // tslint:disable-next-line:max-line-length\n        var nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(inlineElement.line.paragraph);\n        while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.isEmpty()) {\n            text = text + '\\r';\n            if (nextParagraphWidget === endParagraphWidget) {\n                return text;\n            }\n            nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(nextParagraphWidget);\n        }\n        if (!isNullOrUndefined(nextParagraphWidget) && !nextParagraphWidget.isEmpty()) {\n            var lineWidget = nextParagraphWidget.childWidgets[0];\n            // tslint:disable-next-line:max-line-length\n            text = text + '\\r' + this.getTextInline(lineWidget.children[0], endParagraphWidget, endInline, endIndex, includeObject);\n        }\n        return text;\n    };\n    /**\n     * Returns field code.\n     * @private\n     * @param fieldBegin\n     */\n    Selection.prototype.getFieldCode = function (fieldBegin) {\n        var fieldCode = '';\n        if (!(fieldBegin.fieldEnd instanceof FieldElementBox)) {\n            return fieldCode;\n        }\n        var paragraph = fieldBegin.paragraph;\n        var endParagraph = fieldBegin.fieldEnd.paragraph;\n        if (fieldBegin.fieldSeparator instanceof FieldElementBox) {\n            endParagraph = fieldBegin.fieldSeparator.paragraph;\n        }\n        var startLineIndex = fieldBegin.line.indexInOwner;\n        var startIndex = fieldBegin.indexInOwner;\n        do {\n            fieldCode += this.getFieldCodeInternal(paragraph, startLineIndex, startIndex);\n            if (paragraph === endParagraph) {\n                break;\n            }\n            paragraph = this.getNextParagraphBlock(paragraph);\n            startLineIndex = 0;\n            startIndex = 0;\n        } while (paragraph instanceof ParagraphWidget);\n        return fieldCode.trim();\n    };\n    Selection.prototype.getFieldCodeInternal = function (paragraph, startLineIndex, inlineIndex) {\n        var fieldCode = '';\n        for (var i = startLineIndex; i < paragraph.childWidgets.length; i++) {\n            var line = paragraph.childWidgets[i];\n            for (var i_1 = inlineIndex; i_1 < line.children.length; i_1++) {\n                var element = line.children[i_1];\n                if (element instanceof TextElementBox) {\n                    fieldCode += element.text;\n                }\n                if (element instanceof FieldElementBox\n                    && (element.fieldType === 2 || element.fieldType === 1)) {\n                    return fieldCode;\n                }\n            }\n            inlineIndex = 0;\n        }\n        return fieldCode;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getTocFieldInternal = function () {\n        var paragraph = this.start.paragraph;\n        if (!this.isEmpty && !this.isForward) {\n            paragraph = this.end.paragraph;\n        }\n        while (paragraph instanceof ParagraphWidget && paragraph.childWidgets.length > 0) {\n            var line = paragraph.firstChild;\n            if (line.children.length > 0) {\n                var element = line.children[0];\n                var nextElement = element.nextNode;\n                if (element instanceof FieldElementBox && element.fieldType === 0 && nextElement instanceof TextElementBox\n                    && nextElement.text.trim().toLowerCase().indexOf('toc') === 0) {\n                    return element;\n                }\n            }\n            paragraph = paragraph.previousRenderedWidget;\n        }\n        return undefined;\n    };\n    /**\n     * Get next paragraph in bodyWidget\n     * @private\n     */\n    Selection.prototype.getNextParagraph = function (section) {\n        if (section.nextRenderedWidget instanceof BodyWidget) {\n            var block = section.nextRenderedWidget.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousParagraph = function (section) {\n        if (section.previousRenderedWidget instanceof BodyWidget) {\n            var bodyWidget = section.previousRenderedWidget;\n            var block = bodyWidget.childWidgets[bodyWidget.childWidgets.length - 1];\n            return this.getLastParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in cell\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInCell = function (cell) {\n        var firstBlock = cell.childWidgets[0];\n        if (firstBlock instanceof ParagraphWidget) {\n            return firstBlock;\n        }\n        else {\n            return this.getFirstParagraphInFirstCell(firstBlock);\n        }\n    };\n    /**\n     * Get first paragraph in first cell\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInFirstCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var firstRow = table.childWidgets[0];\n            var cell = firstRow.childWidgets[0];\n            var block = cell.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in last cell\n     * @private\n     */\n    Selection.prototype.getLastParagraphInLastCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastrow = table.lastChild;\n            var lastcell = lastrow.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in first row\n     * @private\n     */\n    Selection.prototype.getLastParagraphInFirstRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var row = table.firstChild;\n            var lastcell = row.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get Next start inline\n     * @private\n     */\n    Selection.prototype.getNextStartInline = function (line, offset) {\n        var indexInInline = 0;\n        var inlineObj = line.getInline(offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement(inline.nextNode);\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                inline = nextValidInline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * Get previous text inline\n     * @private\n     */\n    Selection.prototype.getPreviousTextInline = function (inline) {\n        if (inline.previousNode instanceof TextElementBox) {\n            return inline.previousNode;\n        }\n        if (inline.previousNode instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline.previousNode)) {\n            if (inline.previousNode.fieldType === 0 || inline.previousNode.fieldType === 1) {\n                return inline.previousNode;\n            }\n            return inline.previousNode.fieldBegin;\n        }\n        if (!isNullOrUndefined(inline.previousNode)) {\n            return this.getPreviousTextInline((inline.previousNode));\n        }\n        return undefined;\n    };\n    /**\n     * Get next text inline\n     * @private\n     */\n    Selection.prototype.getNextTextInline = function (inline) {\n        if (inline.nextNode instanceof TextElementBox) {\n            return inline.nextNode;\n        }\n        if (inline.nextNode instanceof FieldElementBox && (HelperMethods.isLinkedFieldCharacter(inline.nextNode))) {\n            if (inline.nextNode.fieldType === 1 || inline.nextNode.fieldType === 0) {\n                return inline.nextNode;\n            }\n            return inline.nextNode.fieldEnd;\n        }\n        if (!isNullOrUndefined(inline.nextNode)) {\n            return this.getNextTextInline((inline.nextNode));\n        }\n        return undefined;\n    };\n    /**\n     * Get container table\n     * @private\n     */\n    Selection.prototype.getContainerTable = function (block) {\n        if (block.isInsideTable) {\n            if (block.associatedCell.ownerTable.isInsideTable) {\n                block = this.getContainerTable(block.associatedCell.ownerTable);\n            }\n            else {\n                block = block.associatedCell.ownerTable;\n            }\n        }\n        if (block instanceof TableWidget) {\n            return block;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isExistBefore = function (start, block) {\n        if (start.isInsideTable) {\n            var cell1 = start.associatedCell;\n            if (block.isInsideTable) {\n                var cell2 = block.associatedCell;\n                if (cell1 === cell2) {\n                    return cell1.childWidgets.indexOf(start) < cell1.childWidgets.indexOf(block);\n                }\n                if (cell1.ownerRow === cell2.ownerRow) {\n                    return cell1.cellIndex < cell2.cellIndex;\n                }\n                if (cell1.ownerTable === cell2.ownerTable) {\n                    return cell1.ownerRow.rowIndex < cell2.ownerRow.rowIndex;\n                }\n                //Checks if current block exists before the block.\n                var containerCell = this.getContainerCellOf(cell1, cell2);\n                if (containerCell.ownerTable.contains(cell2)) {\n                    cell1 = this.getSelectedCell(cell1, containerCell);\n                    cell2 = this.getSelectedCell(cell2, containerCell);\n                    if (cell1 === containerCell) {\n                        return this.isExistBefore(start, cell2.ownerTable);\n                    }\n                    if (cell2 === containerCell) {\n                        return this.isExistBefore(cell1.ownerTable, block);\n                    }\n                    if (containerCell.ownerRow === cell2.ownerRow) {\n                        return containerCell.cellIndex < cell2.cellIndex;\n                    }\n                    if (containerCell.ownerTable === cell2.ownerTable) {\n                        return containerCell.ownerRow.rowIndex < cell2.ownerRow.rowIndex;\n                    }\n                    return this.isExistBefore(cell1.ownerTable, cell2.ownerTable);\n                }\n                return this.isExistBefore(containerCell.ownerTable, this.getContainerTable(cell2.ownerTable));\n            }\n            else {\n                var ownerTable = this.getContainerTable(start);\n                return this.isExistBefore(ownerTable, block);\n            }\n        }\n        else if (block.isInsideTable) {\n            var ownerTable = this.getContainerTable(block);\n            return this.isExistBefore(start, ownerTable);\n        }\n        else {\n            {\n                if (start.containerWidget === block.containerWidget) {\n                    return start.index <\n                        block.index;\n                }\n                if (start.containerWidget instanceof BodyWidget && block.containerWidget instanceof BodyWidget) {\n                    //Splitted blocks                     \n                    var startPage = this.viewer.pages.indexOf(start.containerWidget.page);\n                    var endPage = this.viewer.pages.indexOf(block.containerWidget.page);\n                    return startPage < endPage;\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isExistAfter = function (start, block) {\n        if (start.isInsideTable) {\n            var cell1 = start.associatedCell;\n            //Current paragraph in cell, paragraph in cell\n            if (block.isInsideTable) {\n                var cell2 = block.associatedCell;\n                if (cell1 === cell2) {\n                    return cell1.childWidgets.indexOf(start) > cell1.childWidgets.indexOf(block);\n                }\n                if (cell1.ownerRow === cell2.ownerRow) {\n                    return cell1.cellIndex > cell2.cellIndex;\n                }\n                if (cell1.ownerTable === cell2.ownerTable) {\n                    return cell1.ownerRow.rowIndex > cell2.ownerRow.rowIndex;\n                }\n                //Checks if this block exists before block.\n                var containerCell = this.getContainerCellOf(cell1, cell2);\n                if (containerCell.ownerTable.contains(cell2)) {\n                    cell1 = this.getSelectedCell(cell1, containerCell);\n                    cell2 = this.getSelectedCell(cell2, containerCell);\n                    if (cell1 === containerCell) {\n                        return this.isExistAfter(start, cell2.ownerTable);\n                    }\n                    if (cell2 === containerCell) {\n                        return this.isExistAfter(cell1.ownerTable, block);\n                    }\n                    if (containerCell.ownerRow === cell2.ownerRow) {\n                        return containerCell.cellIndex > cell2.cellIndex;\n                    }\n                    if (containerCell.ownerTable === cell2.ownerTable) {\n                        return containerCell.ownerRow.rowIndex > cell2.ownerRow.rowIndex;\n                    }\n                    return this.isExistAfter(cell1.ownerTable, cell2.ownerTable);\n                }\n                return this.isExistAfter(containerCell.ownerTable, this.getContainerTable(cell2.ownerTable));\n            }\n            else {\n                var ownerTable = this.getContainerTable(start);\n                return this.isExistAfter(ownerTable, block);\n            }\n        }\n        else if (block.isInsideTable) {\n            var ownerTable = this.getContainerTable(block);\n            return this.isExistAfter(start, ownerTable);\n        }\n        else {\n            if (start.containerWidget === block.containerWidget) {\n                return start.index >\n                    block.index;\n            }\n            if (start.containerWidget instanceof BodyWidget && block.containerWidget instanceof BodyWidget) {\n                //Splitted blocks                     \n                var startPage = this.viewer.pages.indexOf(start.containerWidget.page);\n                var endPage = this.viewer.pages.indexOf(block.containerWidget.page);\n                return startPage > endPage;\n            }\n            //     if (start.owner instanceof WHeaderFooter) {\n            //         return (start.owner as WHeaderFooter).childWidgets.indexOf(start) \n            // > (block.owner as WHeaderFooter).childWidgets.indexOf(block);\n            //     } else if (start.section === block.section && start.section instanceof WSection) {\n            //         return (start.section as WSection).childWidgets.indexOf(start)\n            //  > (start.section as WSection).childWidgets.indexOf(block);\n            //     } else if (start.wordDocument instanceof WordDocument) {\n            // tslint:disable-next-line:max-line-length\n            //         return (start.wordDocument as WordDocument).sections.indexOf(start.section as WSection) > (start.wordDocument as WordDocument).sections.indexOf(block.section as WSection);\n        }\n        return false;\n    };\n    /**\n     * Return true if current inline in exist before inline\n     * @private\n     */\n    Selection.prototype.isExistBeforeInline = function (currentInline, inline) {\n        if (currentInline.line === inline.line) {\n            return currentInline.line.children.indexOf(currentInline) <\n                inline.line.children.indexOf(inline);\n        }\n        if (currentInline.line.paragraph === inline.line.paragraph) {\n            return currentInline.line.paragraph.childWidgets.indexOf(currentInline.line)\n                < inline.line.paragraph.childWidgets.indexOf(inline.line);\n        }\n        var startParagraph = currentInline.line.paragraph;\n        var endParagraph = inline.line.paragraph;\n        if (startParagraph.containerWidget === endParagraph.containerWidget) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) <\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n            }\n            else if (startParagraph.containerWidget instanceof HeaderFooterWidget) {\n                // return ((currentInline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(currentInline.owner as WParagraph) <\n                //     ((inline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(inline.owner as WParagraph);\n            }\n            else {\n                return startParagraph.containerWidget.childWidgets.indexOf(startParagraph) <\n                    endParagraph.containerWidget.childWidgets.indexOf(endParagraph);\n            }\n        }\n        return this.isExistBefore(startParagraph, endParagraph);\n    };\n    /**\n     * Return true id current inline is exist after inline\n     * @private\n     */\n    Selection.prototype.isExistAfterInline = function (currentInline, inline) {\n        if (currentInline.line === inline.line) {\n            return currentInline.line.children.indexOf(currentInline) >\n                inline.line.children.indexOf(inline);\n        }\n        if (currentInline.line.paragraph === inline.line.paragraph) {\n            return currentInline.line.paragraph.childWidgets.indexOf(currentInline.line)\n                > inline.line.paragraph.childWidgets.indexOf(inline.line);\n        }\n        var startParagraph = currentInline.line.paragraph;\n        var endParagraph = inline.line.paragraph;\n        if (startParagraph.containerWidget === endParagraph.containerWidget) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) >\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n            }\n            else if (startParagraph.containerWidget instanceof HeaderFooterWidget) {\n                // return ((currentInline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(currentInline.owner as WParagraph) <\n                //     ((inline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(inline.owner as WParagraph);\n            }\n            else {\n                return startParagraph.containerWidget.childWidgets.indexOf(startParagraph) >\n                    endParagraph.containerWidget.childWidgets.indexOf(endParagraph);\n            }\n        }\n        return this.isExistAfter(startParagraph, endParagraph);\n    };\n    /**\n     * Get next rendered block\n     * @private\n     */\n    Selection.prototype.getNextRenderedBlock = function (block) {\n        if (isNullOrUndefined(block.nextWidget)) {\n            return block.nextRenderedWidget;\n        }\n        return block.nextWidget;\n    };\n    /**\n     * Get next rendered block\n     * @private\n     */\n    Selection.prototype.getPreviousRenderedBlock = function (block) {\n        if (isNullOrUndefined(block.previousWidget)) {\n            return block.previousRenderedWidget;\n        }\n        return block.previousWidget;\n    };\n    /**\n     * Get Next paragraph in block\n     * @private\n     */\n    Selection.prototype.getNextParagraphBlock = function (block) {\n        if (block.nextRenderedWidget instanceof ParagraphWidget) {\n            return block.nextRenderedWidget;\n        }\n        else if (block.nextRenderedWidget instanceof TableWidget) {\n            return this.getFirstParagraphInFirstCell(block.nextRenderedWidget);\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getNextParagraphCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            var bodyWidget = block.containerWidget;\n            return this.getNextParagraph(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget && this.isMoveDownOrMoveUp) {\n            return this.getFirstBlockInNextHeaderFooter(block);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlockInNextHeaderFooter = function (block) {\n        var headerFooter = block.containerWidget;\n        var nextBlock;\n        if (headerFooter.headerFooterType.indexOf('Header') !== -1) {\n            nextBlock = headerFooter.page.footerWidget.firstChild;\n        }\n        else if (headerFooter.page.nextPage) {\n            nextBlock = headerFooter.page.nextPage.headerWidget.firstChild;\n        }\n        else {\n            return undefined;\n        }\n        if (nextBlock instanceof ParagraphWidget) {\n            return nextBlock;\n        }\n        else {\n            return this.getFirstBlockInFirstCell(nextBlock);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLastBlockInPreviousHeaderFooter = function (block) {\n        var headerFooter = block.containerWidget;\n        var previousBlock;\n        if (headerFooter.headerFooterType.indexOf('Footer') !== -1) {\n            previousBlock = headerFooter.page.headerWidget.lastChild;\n        }\n        else if (headerFooter.page.previousPage) {\n            previousBlock = headerFooter.page.previousPage.footerWidget.lastChild;\n        }\n        else {\n            return undefined;\n        }\n        if (previousBlock instanceof ParagraphWidget) {\n            return previousBlock;\n        }\n        else {\n            return this.getFirstBlockInFirstCell(previousBlock);\n        }\n    };\n    /**\n     * Get previous paragraph in block\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphBlock = function (block) {\n        if (block.previousRenderedWidget instanceof ParagraphWidget) {\n            return block.previousRenderedWidget;\n        }\n        else if (block.previousRenderedWidget instanceof TableWidget) {\n            return this.getLastParagraphInLastCell((block.previousRenderedWidget));\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getPreviousParagraphCell((block.containerWidget));\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getPreviousParagraph(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget && this.isMoveDownOrMoveUp) {\n            return this.getLastBlockInPreviousHeaderFooter(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in block\n     * @private\n     */\n    Selection.prototype.getFirstParagraphBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof TableWidget) {\n            return this.getFirstParagraphInFirstCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in block\n     * @private\n     */\n    Selection.prototype.getLastParagraphBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof TableWidget) {\n            return this.getLastParagraphInLastCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Return true if paragraph has valid inline\n     * @private\n     */\n    Selection.prototype.hasValidInline = function (paragraph, start, end) {\n        var index = paragraph.childWidgets.indexOf(start.line);\n        for (var i = index; i < paragraph.childWidgets.length; i++) {\n            for (var j = 0; j < paragraph.childWidgets[i].children.length; j++) {\n                var inline = paragraph.childWidgets[i].children[j];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (inline === end) {\n                    return false;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * Get paragraph length\n     * @private\n     */\n    Selection.prototype.getParagraphLength = function (paragraph, endLine, elementInfo) {\n        var length = 0;\n        for (var j = 0; j < paragraph.childWidgets.length; j++) {\n            var line = paragraph.childWidgets[j];\n            if (endLine instanceof LineWidget && endLine === line) {\n                if (elementInfo) {\n                    length += this.getLineLength(line, elementInfo);\n                }\n                break;\n            }\n            length += this.getLineLength(line);\n        }\n        return length;\n    };\n    /**\n     * Get Line length\n     * @private\n     */\n    Selection.prototype.getLineLength = function (line, elementInfo) {\n        var length = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            if (elementInfo && elementInfo.element instanceof ElementBox && elementInfo.element === element) {\n                length += elementInfo.index;\n                break;\n            }\n            length += element.length;\n        }\n        return length;\n    };\n    /**\n     * Get line information\n     * @private\n     */\n    Selection.prototype.getLineInfo = function (paragraph, offset) {\n        var line = undefined;\n        var length = 0;\n        var childLength = paragraph.childWidgets.length;\n        for (var j = 0; j < childLength; j++) {\n            line = paragraph.childWidgets[j];\n            length = this.getLineLength(line);\n            if (offset <= length || j === childLength - 1) {\n                break;\n            }\n            else {\n                offset = offset - length;\n            }\n        }\n        return { 'line': line, 'offset': offset };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getElementInfo = function (line, offset) {\n        var index = 0;\n        var element = undefined;\n        for (var i = 0; i < line.children.length; i++) {\n            element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset > element.length\n                && (!(offset === element.length + 1 && isNullOrUndefined(element.nextNode)))) {\n                offset = offset - element.length;\n            }\n            else {\n                break;\n            }\n        }\n        return { 'element': element, 'index': offset };\n    };\n    /**\n     * Get paragraph start offset\n     * @private\n     */\n    Selection.prototype.getStartOffset = function (paragraph) {\n        var startOffset = 0;\n        if (paragraph.childWidgets.length > 0) {\n            var childWidgets = paragraph.childWidgets[0];\n            return this.getStartLineOffset(childWidgets);\n        }\n        return startOffset;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getStartLineOffset = function (line) {\n        var startOffset = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var inline = line.children[i];\n            if (inline.length === 0) {\n                continue;\n            }\n            if (inline instanceof TextElementBox || inline instanceof ImageElementBox || inline instanceof BookmarkElementBox\n                || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                return startOffset;\n            }\n            if (inline instanceof ListTextElementBox) {\n                continue;\n            }\n            startOffset += inline.length;\n        }\n        return startOffset;\n    };\n    /**\n     * Get previous paragraph from selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionCell = function (cell) {\n        if (!isNullOrUndefined(cell.previousRenderedWidget)) {\n            if (!this.isForward) {\n                var block = cell.previousRenderedWidget.childWidgets[0];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    return this.getFirstParagraphInLastRow(block);\n                }\n            }\n            else {\n                var widgets = cell.previousRenderedWidget.childWidgets;\n                var block = widgets[widgets.length - 1];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    return this.getPreviousParagraphSelection(block.childWidgets[block.childWidgets.length - 1]);\n                }\n            }\n        }\n        return this.getPreviousSelectionRow(cell.ownerRow);\n    };\n    /**\n     * Get previous paragraph selection in selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionRow = function (row) {\n        if (!isNullOrUndefined(row.previousRenderedWidget)) {\n            if (!this.isForward) {\n                var cell = row.previousRenderedWidget.childWidgets[0];\n                var block = cell.childWidgets[0];\n                return this.getFirstParagraphBlock(block);\n            }\n            else {\n                return this.getPreviousParagraphSelection(row.previousRenderedWidget);\n            }\n        }\n        return this.getPreviousSelectionBlock(row.ownerTable);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextSelectionBlock = function (block) {\n        if (block.nextRenderedWidget instanceof ParagraphWidget) {\n            return block.nextRenderedWidget;\n        }\n        else if (block.nextRenderedWidget instanceof TableWidget) {\n            if (this.isEmpty || this.isForward) {\n                return this.getLastParagraphInFirstRow(block.nextRenderedWidget);\n            }\n            else {\n                return this.getNextParagraphSelection(block.nextRenderedWidget.childWidgets[0]);\n            }\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getNextSelectionCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getNextSelection(block.containerWidget);\n        }\n        return undefined;\n    };\n    /**\n     * Get next paragraph from selected cell\n     * @private\n     */\n    Selection.prototype.getNextSelectionCell = function (cell) {\n        if (!isNullOrUndefined(cell.nextRenderedWidget)) {\n            if (this.isEmpty || this.isForward) {\n                // tslint:disable-next-line:max-line-length\n                var block = cell.nextRenderedWidget.childWidgets[cell.nextRenderedWidget.childWidgets.length - 1];\n                return this.getLastParagraphBlock(block);\n            }\n            else {\n                //Return first paragraph in cell. \n                var block = cell.nextRenderedWidget.childWidgets[0];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    return this.getNextParagraphSelection(block.childWidgets[0]);\n                }\n            }\n        }\n        return this.getNextSelectionRow(cell.ownerRow);\n    };\n    /**\n     * Get next paragraph in selection\n     * @private\n     */\n    Selection.prototype.getNextSelectionRow = function (row) {\n        if (!isNullOrUndefined(row.nextRenderedWidget)) {\n            var isForwardSelection = this.isEmpty || this.isForward;\n            if (isForwardSelection) {\n                // tslint:disable-next-line:max-line-length\n                var cell = row.nextRenderedWidget.childWidgets[row.nextRenderedWidget.childWidgets.length - 1];\n                var block = cell.childWidgets[cell.childWidgets.length - 1];\n                return this.getLastParagraphBlock(block);\n            }\n            else {\n                return this.getNextParagraphSelection(row.nextRenderedWidget);\n            }\n        }\n        return this.getNextSelectionBlock(row.ownerTable);\n    };\n    /**\n     * Get next block with selection\n     * @private\n     */\n    Selection.prototype.getNextSelection = function (section) {\n        if (section.nextRenderedWidget instanceof BodyWidget) {\n            var block = section.nextRenderedWidget.childWidgets[0];\n            if (block instanceof ParagraphWidget) {\n                return block;\n            }\n            else {\n                if (this.isEmpty || this.isForward) {\n                    return this.getLastParagraphInFirstRow(block);\n                }\n                else {\n                    return this.getNextParagraphSelection(block.childWidgets[0]);\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextParagraphSelection = function (row) {\n        //Iterate the exact cell based on UP/Down selection length.\n        var cell = row.childWidgets[0];\n        if (this.start.paragraph.isInsideTable\n            && row.ownerTable.contains(this.start.paragraph.associatedCell)) {\n            var startCell = this.getCellInTable(row.ownerTable, this.start.paragraph.associatedCell);\n            cell = this.getFirstCellInRegion(row, startCell, this.upDownSelectionLength, false);\n        }\n        var block = cell.childWidgets[0];\n        return this.getFirstParagraphBlock(block);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionBlock = function (block) {\n        if (block.previousRenderedWidget instanceof ParagraphWidget) {\n            return block.previousRenderedWidget;\n        }\n        else if (block.previousRenderedWidget instanceof TableWidget) {\n            if (!this.isForward) {\n                return this.getFirstParagraphInLastRow(block.previousRenderedWidget);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                return this.getPreviousParagraphSelection(block.previousRenderedWidget.childWidgets[block.previousRenderedWidget.childWidgets.length - 1]);\n            }\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getPreviousSelectionCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getPreviousSelection(block.containerWidget);\n        }\n        return undefined;\n    };\n    /**\n     * Get previous paragraph in selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelection = function (section) {\n        if (section.previousRenderedWidget instanceof BodyWidget) {\n            var prevBodyWidget = section.previousRenderedWidget;\n            var block = prevBodyWidget.childWidgets[prevBodyWidget.childWidgets.length - 1];\n            if (block instanceof ParagraphWidget) {\n                return block;\n            }\n            else {\n                if (!this.isForward) {\n                    return this.getFirstParagraphInLastRow(block);\n                }\n                else {\n                    var tableWidget = block;\n                    // tslint:disable-next-line:max-line-length\n                    return this.getPreviousParagraphSelection(tableWidget.childWidgets[tableWidget.childWidgets.length - 1]);\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphSelection = function (row) {\n        //Iterate the exact cell based on UP/Down selection length.\n        var cell = row.childWidgets[row.childWidgets.length - 1];\n        if (this.start.paragraph.isInsideTable\n            && row.ownerTable.contains(this.start.paragraph.associatedCell)) {\n            var startCell = this.getCellInTable(row.ownerTable, this.start.paragraph.associatedCell);\n            cell = this.getLastCellInRegion(row, startCell, this.upDownSelectionLength, true);\n        }\n        var block = cell.childWidgets[cell.childWidgets.length - 1];\n        return this.getLastParagraphBlock(block);\n    };\n    /**\n     * Get last cell in the selected region\n     * @private\n     */\n    Selection.prototype.getLastCellInRegion = function (row, startCell, selLength, isMovePrev) {\n        var start = this.getCellLeft(row, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var flag = true;\n        if (start <= selLength && selLength < end) {\n            for (var i = row.childWidgets.length - 1; i >= 0; i--) {\n                var left = this.getCellLeft(row, row.childWidgets[i]);\n                if (HelperMethods.round(start, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(end, 2)) {\n                    flag = false;\n                    return row.childWidgets[i];\n                }\n            }\n        }\n        else {\n            for (var i = row.childWidgets.length - 1; i >= 0; i--) {\n                var left = this.getCellLeft(row, row.childWidgets[i]);\n                if (left <= selLength && left + row.childWidgets[i].cellFormat.cellWidth > selLength) {\n                    flag = false;\n                    return row.childWidgets[i];\n                }\n            }\n        }\n        if (flag) {\n            if (!isNullOrUndefined(row.previousRenderedWidget) && isMovePrev) {\n                return this.getLastCellInRegion(row.previousRenderedWidget, startCell, selLength, isMovePrev);\n            }\n            else if (!isNullOrUndefined(row.nextRenderedWidget) && !isMovePrev) {\n                return this.getLastCellInRegion(row.nextRenderedWidget, startCell, selLength, isMovePrev);\n            }\n        }\n        return row.childWidgets[row.childWidgets.length - 1];\n    };\n    /**\n     * Get Container table\n     * @private\n     */\n    Selection.prototype.getCellInTable = function (table, tableCell) {\n        while (tableCell.ownerTable.isInsideTable) {\n            if (table.equals(tableCell.ownerTable)) {\n                return tableCell;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return tableCell;\n    };\n    /**\n     * Get first paragraph in last row\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInLastRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastRow = table.childWidgets[table.childWidgets.length - 1];\n            var lastCell = lastRow.childWidgets[0];\n            var lastBlock = lastCell.childWidgets[0];\n            return this.getFirstParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get previous valid offset\n     * @private\n     */\n    Selection.prototype.getPreviousValidOffset = function (paragraph, offset) {\n        if (offset === 0) {\n            return 0;\n        }\n        var validOffset = 0;\n        var count = 0;\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var lineWidget = paragraph.childWidgets[i];\n            for (var j = 0; j < lineWidget.children.length; j++) {\n                var inline = lineWidget.children[j];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (offset <= count + inline.length) {\n                    return offset - 1 === count ? validOffset : offset - 1;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    validOffset = count + inline.length;\n                }\n                count += inline.length;\n            }\n        }\n        return offset - 1 === count ? validOffset : offset - 1;\n    };\n    /**\n     * Get next valid offset\n     * @private\n     */\n    Selection.prototype.getNextValidOffset = function (line, offset) {\n        var count = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var inline = line.children[i];\n            if (inline.length === 0 || inline instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset < count + inline.length) {\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return (offset > count ? offset : count) + 1;\n                }\n            }\n            count += inline.length;\n        }\n        return offset;\n    };\n    /**\n     * Get paragraph mark size info\n     * @private\n     */\n    Selection.prototype.getParagraphMarkSize = function (paragraph, topMargin, bottomMargin) {\n        var size = this.viewer.textHelper.getParagraphMarkSize(paragraph.characterFormat);\n        var baselineOffset = size.BaselineOffset;\n        var maxHeight = size.Height;\n        var maxBaselineOffset = baselineOffset;\n        if (paragraph instanceof ParagraphWidget) {\n            // let paragraphWidget: ParagraphWidget[] = paragraph.renderedElement() as ParagraphWidget[];\n            if (paragraph.childWidgets.length > 0) {\n                var lineWidget = paragraph.childWidgets[0];\n            }\n            //Gets line spacing.\n            var lineSpacing = this.viewer.layout.getLineSpacing(paragraph, maxHeight);\n            var beforeSpacing = this.viewer.layout.getBeforeSpacing(paragraph);\n            topMargin = maxBaselineOffset - baselineOffset;\n            bottomMargin = maxHeight - maxBaselineOffset - (size.Height - baselineOffset);\n            //Updates line spacing, paragraph after/ before spacing and aligns the text to base line offset.\n            var lineSpacingType = paragraph.paragraphFormat.lineSpacingType;\n            if (lineSpacingType === 'Multiple') {\n                if (lineSpacing > maxHeight) {\n                    bottomMargin += lineSpacing - maxHeight;\n                }\n                else {\n                    topMargin += lineSpacing - maxHeight;\n                }\n            }\n            else if (lineSpacingType === 'Exactly') {\n                topMargin += lineSpacing - (topMargin + size.Height + bottomMargin);\n            }\n            else if (lineSpacing > topMargin + size.Height + bottomMargin) {\n                topMargin += lineSpacing - (topMargin + size.Height + bottomMargin);\n            }\n            topMargin += beforeSpacing;\n            bottomMargin += paragraph.paragraphFormat.afterSpacing;\n        }\n        return { 'width': size.Width, 'height': size.Height, 'topMargin': topMargin, 'bottomMargin': bottomMargin };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPhysicalPositionInternal = function (line, offset, moveNextLine) {\n        if (line.paragraph.isEmpty()) {\n            var paragraphWidget = line.paragraph;\n            var left = paragraphWidget.x;\n            if (paragraphWidget.childWidgets.length > 0) {\n                var lineWidget = paragraphWidget.childWidgets[0];\n                left = this.getLeft(lineWidget);\n            }\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var size = this.getParagraphMarkSize(line.paragraph, topMargin, bottomMargin);\n            if (offset > 0) {\n                left += size.width;\n            }\n            return new Point(left, paragraphWidget.y + topMargin);\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = line.getInline(offset, indexInInline);\n            var inline = inlineObj.element; //return indexInInline must\n            indexInInline = inlineObj.index;\n            // tslint:disable-next-line:max-line-length\n            // if (inline.length === indexInInline && !isNullOrUndefined(inline.nextNode) && this.viewer.renderedElements.containsKey(inline) &&\n            //     this.viewer.renderedElements.get(inline).length > 0 && this.viewer.renderedElements.containsKey(inline.nextNode as WInline)\n            //     && this.viewer.renderedElements.get(inline.nextNode as WInline).length > 0 &&\n            // tslint:disable-next-line:max-line-length\n            //     (this.viewer.renderedElements.get(inline)[this.viewer.renderedElements.get(inline).length - 1] as ElementBox).line !== (this.viewer.renderedElements.get(inline.nextNode as WInline)[0] as ElementBox).line) {\n            //     //Handled specifically to move the cursor at start of next line.\n            //     inline = inline.nextNode as WInline;\n            //     indexInInline = 0;\n            // }\n            return this.getPhysicalPositionInline(inline, indexInInline, moveNextLine);\n        }\n    };\n    /**\n     * Highlight selected content\n     * @private\n     */\n    Selection.prototype.highlightSelectedContent = function (start, end) {\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || (!start.paragraph.associatedCell.equals(end.paragraph.associatedCell))\n            || this.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            this.highlightCell(start.paragraph.associatedCell, this, start, end);\n        }\n        else {\n            var inline = undefined;\n            var index = 0;\n            if (!this.owner.isReadOnlyMode && start.paragraph === end.paragraph) {\n                if (start.offset + 1 === end.offset) {\n                    var inlineObj = end.currentWidget.getInline(end.offset, index);\n                    inline = inlineObj.element; // return index value\n                    index = inlineObj.index;\n                    if (inline instanceof ImageElementBox) {\n                        var startOffset = start.currentWidget.getOffset(inline, 0);\n                        if (startOffset !== start.offset) {\n                            inline = undefined;\n                        }\n                    }\n                }\n                else {\n                    var indexInInline = 0;\n                    var startInlineObj = start.currentWidget.getInline(start.offset, indexInInline);\n                    var startInline = startInlineObj.element; //return indexInInline\n                    indexInInline = startInlineObj.index;\n                    if (indexInInline === startInline.length) {\n                        startInline = this.getNextRenderedElementBox(startInline, indexInInline);\n                    }\n                    var endInlineObj = end.currentWidget.getInline(end.offset, indexInInline);\n                    var endInline = endInlineObj.element; //return indexInInline\n                    indexInInline = endInlineObj.index;\n                    // tslint:disable-next-line:max-line-length\n                    if (startInline instanceof FieldElementBox && endInline instanceof FieldElementBox && !isNullOrUndefined(startInline.fieldSeparator)) {\n                        var fieldValue = startInline.fieldSeparator.nextNode;\n                        if (fieldValue instanceof ImageElementBox && fieldValue.nextNode === endInline) {\n                            inline = fieldValue;\n                        }\n                    }\n                }\n            }\n            if (!this.owner.isReadOnlyMode && inline instanceof ImageElementBox && this.owner.isDocumentLoaded) {\n                var elementBoxObj = this.getElementBoxInternal(inline, index);\n                var elementBox = elementBoxObj.element; //return index \n                index = elementBoxObj.index;\n                if (this.owner.enableImageResizerMode) {\n                    this.owner.imageResizerModule.positionImageResizer(elementBox);\n                    this.owner.imageResizerModule.showImageResizer();\n                }\n                if (this.viewer.isTouchInput) {\n                    this.viewer.touchStart.style.display = 'none';\n                    this.viewer.touchEnd.style.display = 'none';\n                }\n            }\n            else {\n                this.highlight(start.paragraph, start, end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.highlight = function (paragraph, start, end) {\n        var selectionStartIndex = 0;\n        var selectionEndIndex = 0;\n        var startElement = undefined;\n        var endElement = undefined;\n        var startLineWidget = undefined;\n        var endLineWidget = undefined;\n        //return start Element and selection start index\n        var startLineObj = this.getStartLineWidget(paragraph, start, startElement, selectionStartIndex);\n        startElement = startLineObj.element;\n        if (isNullOrUndefined(startElement)) {\n            startLineWidget = paragraph.childWidgets[0];\n        }\n        else {\n            startLineWidget = startElement.line;\n        }\n        selectionStartIndex = startLineObj.index;\n        var endLineObj = this.getEndLineWidget(end, endElement, selectionEndIndex);\n        endElement = endLineObj.element;\n        if (endElement) {\n            endLineWidget = endElement.line;\n        }\n        else {\n            endLineWidget = end.paragraph.childWidgets[end.paragraph.childWidgets.length - 1];\n        }\n        selectionEndIndex = endLineObj.index;\n        var top = 0;\n        var left = 0;\n        if (!isNullOrUndefined(startLineWidget)) {\n            top = this.getTop(startLineWidget);\n            left = this.getLeftInternal(startLineWidget, startElement, selectionStartIndex);\n        }\n        if (!isNullOrUndefined(startLineWidget) && startLineWidget === endLineWidget) {\n            //Selection ends in current line.\n            var right = this.getLeftInternal(endLineWidget, endElement, selectionEndIndex);\n            this.createHighlightBorder(startLineWidget, right - left, left, top);\n        }\n        else {\n            if (!isNullOrUndefined(startLineWidget)) {\n                var x = startLineWidget.paragraph.x;\n                this.createHighlightBorder(startLineWidget, this.getWidth(startLineWidget, true) - (left - x), left, top);\n                var lineIndex = startLineWidget.paragraph.childWidgets.indexOf(startLineWidget);\n                //Iterates to last item of paragraph or selection end.                                             \n                this.highlightParagraph(paragraph, lineIndex + 1, endLineWidget, endElement, selectionEndIndex);\n                if (paragraph.childWidgets.indexOf(end.currentWidget) !== -1) {\n                    return;\n                }\n            }\n            this.highlightNextBlock(paragraph, start, end);\n        }\n    };\n    Selection.prototype.highlightNextBlock = function (paragraph, start, end) {\n        var block = paragraph.nextRenderedWidget;\n        if (!isNullOrUndefined(block)) {\n            if (block instanceof ParagraphWidget) {\n                this.highlight(block, start, end);\n            }\n            else {\n                this.highlightTable(block, start, end);\n            }\n        }\n    };\n    /**\n     * Get start line widget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getStartLineWidget = function (paragraph, start, startElement, selectionStartIndex) {\n        var offset = paragraph === start.paragraph ? start.offset : this.getStartOffset(paragraph);\n        var startInlineObj = undefined;\n        if (paragraph === start.paragraph) {\n            startInlineObj = start.currentWidget.getInline(offset, selectionStartIndex);\n        }\n        else {\n            startInlineObj = paragraph.firstChild.getInline(offset, selectionStartIndex);\n        }\n        startElement = startInlineObj.element; //return selectionStartIndex\n        selectionStartIndex = startInlineObj.index;\n        if (startElement instanceof FieldElementBox) {\n            var inlineInfo = this.getRenderedInline(startElement, selectionStartIndex);\n            startElement = inlineInfo.element;\n            selectionStartIndex = inlineInfo.index;\n        }\n        if (offset === this.getParagraphLength(start.paragraph) + 1) {\n            selectionStartIndex++;\n        }\n        return {\n            'index': selectionStartIndex, 'element': startElement\n        };\n    };\n    /**\n     * Get end line widget\n     * @private\n     */\n    Selection.prototype.getEndLineWidget = function (end, endElement, selectionEndIndex) {\n        var endInlineObj = end.currentWidget.getInline(end.offset, selectionEndIndex);\n        endElement = endInlineObj.element; //return selection end index\n        selectionEndIndex = endInlineObj.index;\n        if (endElement instanceof FieldElementBox) {\n            var inlineInfo = this.getRenderedInline(endElement, selectionEndIndex);\n            endElement = inlineInfo.element;\n            selectionEndIndex = inlineInfo.index;\n        }\n        var lineIndex = end.paragraph.childWidgets.indexOf(end.currentWidget);\n        if (lineIndex === end.paragraph.childWidgets.length - 1 && end.offset === this.getLineLength(end.currentWidget) + 1) {\n            selectionEndIndex = endElement ? endElement.length + 1 : 1;\n        }\n        return { 'index': selectionEndIndex, 'element': endElement };\n    };\n    /**\n     * Get line widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetInternal = function (line, offset, moveToNextLine) {\n        var lineWidget = undefined;\n        if (line.children.length === 0 && line instanceof LineWidget) {\n            lineWidget = line;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineInfo = line.getInline(offset, indexInInline);\n            var inline = inlineInfo.element;\n            indexInInline = inlineInfo.index;\n            lineWidget = inline instanceof ElementBox ? inline.line\n                : this.getLineWidgetInternalInline(inline, indexInInline, moveToNextLine);\n        }\n        return lineWidget;\n    };\n    /**\n     * Get last line widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetParagraph = function (offset, line) {\n        var linewidget = undefined;\n        if (line.children.length === 0) {\n            linewidget = line;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineInfo = line.getInline(offset, indexInInline);\n            var inline = inlineInfo.element;\n            indexInInline = inlineInfo.index;\n            linewidget = this.getLineWidget(inline, indexInInline);\n        }\n        return linewidget;\n    };\n    /**\n     * Highlight selected cell\n     * @private\n     */\n    /* tslint:disable */\n    // tslint:disable-next-line:max-line-length    \n    Selection.prototype.highlightCells = function (table, startCell, endCell) {\n        var start = this.getCellLeft(startCell.ownerRow, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (start > endCellLeft) {\n            start = endCellLeft;\n        }\n        if (end < endCellRight) {\n            end = endCellRight;\n        }\n        if (start > this.upDownSelectionLength) {\n            start = this.upDownSelectionLength;\n        }\n        if (end < this.upDownSelectionLength) {\n            end = this.upDownSelectionLength;\n        }\n        var tableWidgetCollection = table.getSplitWidgets();\n        var startTableIndex = tableWidgetCollection.indexOf(startCell.ownerRow.ownerTable);\n        var endTableIndex = tableWidgetCollection.indexOf(endCell.ownerRow.ownerTable);\n        if (startTableIndex === endTableIndex) {\n            var count = table.childWidgets.indexOf(endCell.ownerRow);\n            for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n                this.highlightRow(table.childWidgets[i], start, end);\n            }\n        }\n        else {\n            var startRowIndex = 0;\n            var endRowIndex = 0;\n            for (var i = startTableIndex; i <= endTableIndex; i++) {\n                table = tableWidgetCollection[i];\n                if (i === startTableIndex) {\n                    startRowIndex = table.childWidgets.indexOf(startCell.ownerRow);\n                }\n                else {\n                    startRowIndex = 0;\n                }\n                if (i === endTableIndex) {\n                    endRowIndex = table.childWidgets.indexOf(endCell.ownerRow);\n                }\n                else {\n                    endRowIndex = table.childWidgets.length - 1;\n                }\n                for (var j = startRowIndex; j <= endRowIndex; j++) {\n                    this.highlightRow(table.childWidgets[j], start, end);\n                }\n            }\n        }\n    };\n    /* tslint:enable */\n    /**\n     * highlight selected table\n     * @private\n     */\n    Selection.prototype.highlightTable = function (table, start, end) {\n        this.highlightInternal(table.childWidgets[0], start, end);\n        if (!end.paragraph.isInsideTable //Selection end is outside the table cell.\n            || !table.contains(end.paragraph.associatedCell)) { //Selection end is not inside the current table.\n            this.highlightNextBlock(table, start, end);\n        }\n    };\n    /**\n     * Get cell left\n     * @private\n     */\n    Selection.prototype.getCellLeft = function (row, cell) {\n        var left = 0;\n        left += cell.x - cell.margin.left;\n        return left;\n    };\n    /**\n     * Get next paragraph for row\n     * @private\n     */\n    Selection.prototype.getNextParagraphRow = function (row) {\n        if (!isNullOrUndefined(row.nextRenderedWidget)) {\n            var cell = row.nextRenderedWidget.childWidgets[0];\n            var block = cell.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return this.getNextParagraphBlock(row.ownerTable);\n    };\n    /**\n     * Get previous paragraph from row\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphRow = function (row) {\n        if (!isNullOrUndefined(row.previousRenderedWidget)) {\n            // tslint:disable-next-line:max-line-length\n            var cell = row.previousRenderedWidget.lastChild;\n            var block = cell.lastChild ? cell.lastChild : (cell.previousSplitWidget).lastChild;\n            return this.getLastParagraphBlock(block);\n        }\n        return this.getPreviousParagraphBlock(row.ownerTable);\n    };\n    /**\n     * Return true if row contain cell\n     * @private\n     */\n    Selection.prototype.containsRow = function (row, tableCell) {\n        if (row.childWidgets.indexOf(tableCell) !== -1) {\n            return true;\n        }\n        while (tableCell.ownerTable.isInsideTable) {\n            if (row.childWidgets.indexOf(tableCell) !== -1) {\n                return true;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return row.childWidgets.indexOf(tableCell) !== -1;\n    };\n    /**\n     * Highlight selected row\n     * @private\n     */\n    Selection.prototype.highlightRow = function (row, start, end) {\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var left = this.getCellLeft(row, row.childWidgets[i]);\n            if (HelperMethods.round(start, 2) <= HelperMethods.round(left, 2) &&\n                HelperMethods.round(left, 2) < HelperMethods.round(end, 2)) {\n                this.highlightCellWidget(row.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.highlightInternal = function (row, start, end) {\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            this.highlightCellWidget(row.childWidgets[i]);\n        }\n        if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n            return;\n        }\n        else if (row.nextRenderedWidget instanceof TableRowWidget) {\n            this.highlightInternal(row.nextRenderedWidget, start, end);\n        }\n    };\n    /**\n     * Get last paragraph in cell\n     * @private\n     */\n    Selection.prototype.getLastParagraph = function (cell) {\n        while (cell.nextSplitWidget) {\n            if (cell.nextSplitWidget.childWidgets.length > 0) {\n                cell = cell.nextSplitWidget;\n            }\n            else {\n                break;\n            }\n        }\n        var lastBlock;\n        if (cell.childWidgets.length > 0) {\n            lastBlock = cell.lastChild;\n        }\n        else {\n            lastBlock = cell.previousSplitWidget.lastChild;\n        }\n        return this.getLastParagraphBlock(lastBlock);\n    };\n    /**\n     * Return true is source cell contain cell\n     * @private\n     */\n    Selection.prototype.containsCell = function (sourceCell, cell) {\n        if (sourceCell.equals(cell)) {\n            return true;\n        }\n        while (cell.ownerTable.isInsideTable) {\n            if (sourceCell.equals(cell.ownerTable.associatedCell)) {\n                return true;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return false;\n    };\n    /**\n     * Return true if cell is selected\n     * @private\n     */\n    Selection.prototype.isCellSelected = function (cell, startPosition, endPosition) {\n        var lastParagraph = this.getLastParagraph(cell);\n        // tslint:disable-next-line:max-line-length\n        var isAtCellEnd = lastParagraph === endPosition.paragraph && endPosition.offset === this.getParagraphLength(lastParagraph) + 1;\n        return isAtCellEnd || (!this.containsCell(cell, startPosition.paragraph.associatedCell) ||\n            !this.containsCell(cell, endPosition.paragraph.associatedCell));\n    };\n    /**\n     * Return Container cell\n     * @private\n     */\n    Selection.prototype.getContainerCellOf = function (cell, tableCell) {\n        while (cell.ownerTable.isInsideTable) {\n            if (cell.ownerTable.contains(tableCell)) {\n                return cell;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * Get Selected cell\n     * @private\n     */\n    Selection.prototype.getSelectedCell = function (cell, containerCell) {\n        if (cell.ownerTable.equals(containerCell.ownerTable)) {\n            return cell;\n        }\n        while (cell.ownerTable.isInsideTable) {\n            if (cell.ownerTable.associatedCell.equals(containerCell)) {\n                return cell;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getSelectedCells = function () {\n        var cells = [];\n        for (var i = 0; i < this.selectedWidgets.keys.length; i++) {\n            var widget = this.selectedWidgets.keys[i];\n            if (widget instanceof TableCellWidget) {\n                cells.push(widget);\n            }\n        }\n        return cells;\n    };\n    /**\n     * Get Next paragraph from cell\n     * @private\n     */\n    Selection.prototype.getNextParagraphCell = function (cell) {\n        if (cell.nextRenderedWidget && cell.nextRenderedWidget instanceof TableCellWidget) {\n            //Return first paragraph in cell.            \n            cell = cell.nextRenderedWidget;\n            var block = cell.firstChild;\n            if (block) {\n                return this.getFirstParagraphBlock(block);\n            }\n            else {\n                return this.getNextParagraphCell(cell);\n            }\n        }\n        return this.getNextParagraphRow(cell.containerWidget);\n    };\n    /**\n     * Get previous paragraph from cell\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphCell = function (cell) {\n        if (!isNullOrUndefined(cell.previousRenderedWidget) && cell.previousRenderedWidget instanceof TableCellWidget) {\n            cell = cell.previousRenderedWidget;\n            var block = cell.lastChild;\n            return this.getLastParagraphBlock(block);\n        }\n        return this.getPreviousParagraphRow(cell.ownerRow);\n    };\n    /**\n     * Get cell's container cell\n     * @private\n     */\n    Selection.prototype.getContainerCell = function (cell) {\n        while (!isNullOrUndefined(cell.ownerTable) && cell.ownerTable.isInsideTable) {\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * Highlight selected cell\n     * @private\n     */\n    /* tslint:disable */\n    Selection.prototype.highlightCell = function (cell, selection, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(cell, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    /* tslint:enable */\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.highlightCellWidget(containerCell);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.highlight(start.paragraph, start, end);\n                        }\n                        else {\n                            this.highlightContainer(startCell, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Selection end is not in container cell.\n                    this.highlightCellWidget(containerCell);\n                    if (containerCell.ownerRow.equals(endCell.ownerRow)) {\n                        //Highlight other selected cells in current row.\n                        startCell = containerCell;\n                        while (!isNullOrUndefined(startCell.nextRenderedWidget)) {\n                            startCell = startCell.nextRenderedWidget;\n                            this.highlightCellWidget(startCell);\n                            if (startCell === endCell) {\n                                break;\n                            }\n                        }\n                    }\n                    else {\n                        this.highlightCells(containerCell.ownerTable, containerCell, endCell);\n                    }\n                }\n            }\n            else {\n                this.highlightContainer(containerCell, start, end);\n            }\n        }\n        else {\n            var cell1 = this.getContainerCell(cell);\n            this.highlightContainer(cell1, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.highlightContainer = function (cell, start, end) {\n        this.highlightInternal(cell.containerWidget, start, end);\n        this.highlightNextBlock(cell.ownerTable, start, end);\n    };\n    /**\n     * Get previous valid element\n     * @private\n     */\n    Selection.prototype.getPreviousValidElement = function (inline) {\n        var previousValidInline = undefined;\n        while (inline instanceof FieldElementBox) {\n            if (HelperMethods.isLinkedFieldCharacter(inline)) {\n                if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                    previousValidInline = inline;\n                }\n                else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    previousValidInline = inline;\n                    if (isNullOrUndefined(inline.fieldSeparator)) {\n                        inline = inline.fieldBegin;\n                        previousValidInline = inline;\n                    }\n                }\n                else {\n                    inline = inline.fieldBegin;\n                    previousValidInline = inline;\n                }\n            }\n            inline = inline.previousNode;\n        }\n        return isNullOrUndefined(previousValidInline) ? inline : previousValidInline;\n    };\n    /**\n     * Get next valid element\n     * @private\n     */\n    Selection.prototype.getNextValidElement = function (inline) {\n        var nextValidInline = undefined;\n        while (inline instanceof FieldElementBox) {\n            if (inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n                return isNullOrUndefined(nextValidInline) ? inline : nextValidInline;\n            }\n            else if (inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n                nextValidInline = inline;\n            }\n            inline = inline.nextNode;\n        }\n        return (isNullOrUndefined(nextValidInline) ? inline : nextValidInline);\n    };\n    /**\n     * Return next valid inline with index\n     * @private\n     */\n    Selection.prototype.validateTextPosition = function (inline, index) {\n        if (inline.length === index && inline.nextNode instanceof FieldElementBox) {\n            //If inline is last item within field, then set field end as text position.\n            var nextInline = this.getNextValidElement(inline.nextNode);\n            if (nextInline instanceof FieldElementBox && nextInline.fieldType === 1) {\n                inline = nextInline;\n                index = 1;\n            }\n        }\n        else if (index === 0 && inline.previousNode instanceof FieldElementBox) {\n            var prevInline = this.getPreviousValidElement(inline.previousNode);\n            inline = prevInline;\n            index = inline instanceof FieldElementBox ? 0 : inline.length;\n            if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                index++;\n            }\n        }\n        return { 'element': inline, 'index': index };\n    };\n    /**\n     * Get inline physical location\n     * @private\n     */\n    Selection.prototype.getPhysicalPositionInline = function (inline, index, moveNextLine) {\n        var element = undefined;\n        element = this.getElementBox(inline, index, moveNextLine).element;\n        var lineWidget = undefined;\n        if (isNullOrUndefined(element) || isNullOrUndefined(element.line)) {\n            if (inline instanceof FieldElementBox || inline instanceof BookmarkElementBox) {\n                return this.getFieldCharacterPosition(inline);\n            }\n            return new Point(0, 0);\n        }\n        var margin = element.margin;\n        var top = 0;\n        var left = 0;\n        if (element instanceof TextElementBox && element.text === '\\v' && isNullOrUndefined(inline.nextNode)) {\n            lineWidget = this.getNextLineWidget(element.line.paragraph, element);\n            index = 0;\n        }\n        else {\n            lineWidget = element.line;\n        }\n        top = this.getTop(lineWidget);\n        if (element instanceof ImageElementBox) {\n            var format = element.line.paragraph.characterFormat;\n            var previousInline = this.getPreviousTextElement(inline);\n            if (!isNullOrUndefined(previousInline)) {\n                format = previousInline.characterFormat;\n            }\n            else {\n                var nextInline = this.getNextTextElement(inline);\n                if (!isNullOrUndefined(nextInline)) {\n                    format = nextInline.characterFormat;\n                }\n            }\n            var measureObj = this.viewer.textHelper.getHeight(format);\n            if (element.margin.top + element.height - measureObj.BaselineOffset > 0) {\n                top += element.margin.top + element.height - measureObj.BaselineOffset;\n            }\n        }\n        else if (!(element instanceof FieldElementBox)) {\n            top += margin.top > 0 ? margin.top : 0;\n        }\n        left = (isNullOrUndefined(element) || isNullOrUndefined(lineWidget)) ? 0 : this.getLeftInternal(lineWidget, element, index);\n        return new Point(left, top);\n    };\n    /**\n     * Get field character position\n     * @private\n     */\n    Selection.prototype.getFieldCharacterPosition = function (firstInline) {\n        var nextValidInline = this.getNextValidElementForField(firstInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var nextParagraph = firstInline.line.paragraph;\n            return this.getEndPosition(nextParagraph);\n        }\n        else {\n            return this.getPhysicalPositionInline(nextValidInline, 0, true);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextValidElementForField = function (firstInline) {\n        if (firstInline instanceof FieldElementBox && firstInline.fieldType === 0\n            && HelperMethods.isLinkedFieldCharacter(firstInline)) {\n            var fieldBegin = firstInline;\n            if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                firstInline = fieldBegin.fieldEnd;\n            }\n            else {\n                firstInline = fieldBegin.fieldSeparator;\n            }\n        }\n        var nextValidInline = undefined;\n        if (!isNullOrUndefined(firstInline.nextNode)) {\n            nextValidInline = this.getNextValidElement(firstInline.nextNode);\n        }\n        return nextValidInline;\n    };\n    /**\n     * Get paragraph end position\n     * @private\n     */\n    Selection.prototype.getEndPosition = function (widget) {\n        var left = widget.x;\n        var top = widget.y;\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            lineWidget = widget.childWidgets[widget.childWidgets.length - 1];\n            left += this.getWidth(lineWidget, false);\n        }\n        if (!isNullOrUndefined(lineWidget)) {\n            top = this.getTop(lineWidget);\n        }\n        var topMargin = 0;\n        var bottomMargin = 0;\n        var size = this.getParagraphMarkSize(widget, topMargin, bottomMargin);\n        return new Point(left, top + size.topMargin);\n    };\n    /**\n     * Get element box\n     * @private\n     */\n    Selection.prototype.getElementBox = function (currentInline, index, moveToNextLine) {\n        var elementBox = undefined;\n        if (!(currentInline instanceof FieldElementBox || currentInline instanceof BookmarkElementBox)) {\n            elementBox = currentInline;\n        }\n        return { 'element': elementBox, 'index': index };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousTextElement = function (inline) {\n        if (inline.previousNode instanceof TextElementBox) {\n            return inline.previousNode;\n        }\n        if (!isNullOrUndefined(inline.previousNode)) {\n            return this.getPreviousTextElement(inline.previousNode);\n        }\n        return undefined;\n    };\n    /**\n     * Get next text inline\n     * @private\n     */\n    Selection.prototype.getNextTextElement = function (inline) {\n        if (inline.nextNode instanceof TextElementBox) {\n            return inline.nextNode;\n        }\n        if (!isNullOrUndefined(inline.nextNode)) {\n            return this.getNextTextElement(inline.nextNode);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextRenderedElementBox = function (inline, indexInInline) {\n        if (inline instanceof FieldElementBox) {\n            var fieldBegin = inline;\n            if (fieldBegin.fieldType === 0) {\n                inline = this.getRenderedField(fieldBegin);\n                if (fieldBegin === inline) {\n                    return fieldBegin;\n                }\n            }\n            indexInInline = 1;\n        }\n        while (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement((inline.nextNode));\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                var fieldBegin = nextValidInline;\n                inline = this.getRenderedField(fieldBegin);\n                if (!isNullOrUndefined(inline) && fieldBegin === inline) {\n                    return fieldBegin;\n                }\n                indexInInline = 1;\n            }\n            else {\n                inline = nextValidInline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getElementBoxInternal = function (inline, index) {\n        var element = undefined;\n        element = inline;\n        return {\n            'element': element, 'index': index\n        };\n    };\n    /**\n     * Get Line widget\n     * @private\n     */\n    Selection.prototype.getLineWidget = function (inline, index) {\n        return this.getLineWidgetInternalInline(inline, index, true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLineWidgetInternalInline = function (inline, index, moveToNextLine) {\n        var elementObj = this.getElementBox(inline, index, moveToNextLine);\n        var element = elementObj.element; //return index\n        index = elementObj.index;\n        if (!isNullOrUndefined(element)) {\n            if (moveToNextLine && element instanceof TextElementBox && element.text === '\\v' && index === 1) {\n                return this.getNextLineWidget(element.line.paragraph, element);\n            }\n            else {\n                return element.line;\n            }\n        }\n        var startInline = inline;\n        //ToDo: Check previous inline here.\n        var nextValidInline = this.getNextValidElementForField(startInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var lineWidget = undefined;\n            var widget = startInline.line.paragraph;\n            if (widget.childWidgets.length > 0) {\n                lineWidget = widget.childWidgets[widget.childWidgets.length - 1];\n            }\n            return lineWidget;\n        }\n        else {\n            return this.getLineWidget(nextValidInline, 0);\n        }\n    };\n    /**\n     * Get next line widget\n     * @private\n     */\n    Selection.prototype.getNextLineWidget = function (paragraph, element) {\n        var lineWidget = undefined;\n        var widget = paragraph;\n        if (widget.childWidgets.length > 0) {\n            var widgetIndex = widget.childWidgets.indexOf(element.line);\n            if (widgetIndex === widget.childWidgets.length - 1) {\n                widget = paragraph;\n                // widget = paragraph.leafWidgets[paragraph.leafWidgets.length - 1];\n                widgetIndex = -1;\n            }\n            else if (widgetIndex > widget.childWidgets.length - 1) {\n                widget = this.getNextParagraphBlock(paragraph);\n                widgetIndex = -1;\n            }\n            else if (widgetIndex < 0) {\n                // widget = paragraph.leafWidgets[paragraph.leafWidgets.length - 1];\n                widget = paragraph;\n                widgetIndex = widget.childWidgets.indexOf(element.line);\n            }\n            lineWidget = widget.childWidgets[widgetIndex + 1];\n        }\n        return lineWidget;\n    };\n    /**\n     * Get Caret height\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCaretHeight = function (inline, index, format, isEmptySelection, topMargin, isItalic) {\n        var elementBoxInfo = this.getElementBox(inline, index, false);\n        var element = elementBoxInfo.element;\n        var currentInline = inline;\n        if (isNullOrUndefined(element)) {\n            if (currentInline instanceof FieldElementBox) {\n                return this.getFieldCharacterHeight(currentInline, format, isEmptySelection, topMargin, isItalic);\n            }\n            return { 'height': this.viewer.textHelper.getHeight(format).Height, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        var margin = element.margin;\n        var heightElement = element.height;\n        var maxLineHeight = 0;\n        if (element instanceof ImageElementBox) {\n            var previousInline = this.getPreviousTextElement(inline);\n            var nextInline = this.getNextTextElement(inline);\n            if (isNullOrUndefined(previousInline) && isNullOrUndefined(nextInline)) {\n                var top_2 = 0;\n                var bottom = 0;\n                var paragarph = inline.line.paragraph;\n                var sizeInfo = this.getParagraphMarkSize(paragarph, top_2, bottom);\n                top_2 = sizeInfo.topMargin;\n                bottom = sizeInfo.bottomMargin;\n                maxLineHeight = sizeInfo.height;\n                isItalic = paragarph.characterFormat.italic;\n                if (!isEmptySelection) {\n                    maxLineHeight += paragarph.paragraphFormat.afterSpacing;\n                }\n            }\n            else if (isNullOrUndefined(previousInline)) {\n                isItalic = nextInline.characterFormat.italic;\n                return this.getCaretHeight(nextInline, 0, nextInline.characterFormat, isEmptySelection, topMargin, isItalic);\n            }\n            else {\n                if (!isNullOrUndefined(nextInline) && element instanceof ImageElementBox) {\n                    //Calculates the caret size using image character format.\n                    var textSizeInfo = this.viewer.textHelper.getHeight(element.characterFormat);\n                    var charHeight = textSizeInfo.Height;\n                    var baselineOffset = textSizeInfo.BaselineOffset;\n                    // tslint:disable-next-line:max-line-length\n                    maxLineHeight = (element.margin.top < 0 && baselineOffset > element.margin.top + element.height) ? element.margin.top + element.height + charHeight - baselineOffset : charHeight;\n                    if (!isEmptySelection) {\n                        maxLineHeight += element.margin.bottom;\n                    }\n                }\n                else {\n                    isItalic = previousInline.characterFormat.italic;\n                    // tslint:disable-next-line:max-line-length\n                    return this.getCaretHeight(previousInline, previousInline.length, previousInline.characterFormat, isEmptySelection, topMargin, isItalic);\n                }\n            }\n        }\n        else {\n            var baselineAlignment = format.baselineAlignment;\n            var elementHeight = heightElement;\n            if (baselineAlignment !== 'Normal' && isEmptySelection) {\n                //Set the caret height as sub/super script text height and updates the top margin for sub script text.\n                elementHeight = elementHeight / 1.5;\n                if (baselineAlignment === 'Subscript') {\n                    topMargin = heightElement - elementHeight;\n                }\n            }\n            maxLineHeight = (margin.top < 0 ? margin.top : 0) + elementHeight;\n            if (!isEmptySelection) {\n                maxLineHeight += margin.bottom;\n            }\n        }\n        if (!isEmptySelection) {\n            return { 'height': maxLineHeight, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        var height = this.viewer.textHelper.getHeight(format).Height;\n        if (height > maxLineHeight) {\n            height = maxLineHeight;\n        }\n        return { 'height': height, 'topMargin': topMargin, 'isItalic': isItalic };\n    };\n    /**\n     * Get field characters height\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getFieldCharacterHeight = function (startInline, format, isEmptySelection, topMargin, isItalic) {\n        var nextValidInline = this.getNextValidElementForField(startInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var nextParagraph = startInline.line.paragraph;\n            var height = this.viewer.textHelper.getParagraphMarkSize(format).Height;\n            var top_3 = 0;\n            var bottom = 0;\n            var sizeInfo = this.getParagraphMarkSize(nextParagraph, top_3, bottom);\n            var maxLineHeight = sizeInfo.height;\n            top_3 = sizeInfo.topMargin;\n            bottom = sizeInfo.bottomMargin;\n            if (!isEmptySelection) {\n                maxLineHeight += bottom;\n                return { 'height': maxLineHeight, 'topMargin': topMargin, 'isItalic': isItalic };\n            }\n            if (height > maxLineHeight) {\n                height = maxLineHeight;\n            }\n            return { 'height': height, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        else {\n            return this.getCaretHeight(nextValidInline, 0, format, isEmptySelection, topMargin, isItalic);\n        }\n    };\n    /**\n     * Get rendered inline\n     * @private\n     */\n    //FieldCharacter\n    Selection.prototype.getRenderedInline = function (inline, inlineIndex) {\n        var prevInline = this.getPreviousValidElement(inline);\n        while (prevInline instanceof FieldElementBox) {\n            prevInline = this.getPreviousTextElement(prevInline);\n            if (prevInline instanceof FieldElementBox) {\n                prevInline = prevInline.previousNode;\n            }\n        }\n        if (!isNullOrUndefined(prevInline)) {\n            inlineIndex = prevInline.length;\n            return { 'element': prevInline, 'index': inlineIndex };\n        }\n        inlineIndex = 0;\n        var nextInline = this.getNextRenderedElementBox(inline, 0);\n        if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n            nextInline = nextInline.fieldSeparator;\n            nextInline = nextInline.nextNode;\n            while (nextInline instanceof FieldElementBox) {\n                if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0\n                    && HelperMethods.isLinkedFieldCharacter(nextInline)) {\n                    if (isNullOrUndefined(nextInline.fieldSeparator)) {\n                        nextInline = nextInline.fieldEnd;\n                    }\n                    else {\n                        nextInline = nextInline.fieldSeparator;\n                    }\n                }\n                nextInline = nextInline.nextNode;\n            }\n        }\n        return { 'element': nextInline, 'index': inlineIndex };\n    };\n    //Field Begin\n    /**\n     * Get rendered field\n     * @private\n     */\n    Selection.prototype.getRenderedField = function (fieldBegin) {\n        var inline = fieldBegin;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            inline = fieldBegin.fieldEnd;\n        }\n        else {\n            inline = fieldBegin.fieldSeparator;\n            var paragraph = inline.line.paragraph;\n            if (paragraph === fieldBegin.fieldEnd.line.paragraph\n                && !this.hasValidInline(paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n            else {\n                return inline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * Return true is inline is tha last inline\n     * @private\n     */\n    Selection.prototype.isLastRenderedInline = function (inline, index) {\n        while (index === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement(inline.nextNode);\n            index = 0;\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                inline = nextValidInline;\n            }\n            if (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n                var fieldBegin = inline;\n                if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    inline = fieldBegin.fieldEnd;\n                    index = 1;\n                }\n                else {\n                    inline = fieldBegin.fieldSeparator;\n                    var paragraph = inline.line.paragraph;\n                    index = 1;\n                    if (paragraph === fieldBegin.fieldEnd.line.paragraph\n                        && !this.hasValidInline(paragraph, inline, fieldBegin.fieldEnd)) {\n                        inline = fieldBegin.fieldEnd;\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n        }\n        return index === inline.length && isNullOrUndefined(inline.nextNode);\n    };\n    /**\n     * Get page\n     * @private\n     */\n    Selection.prototype.getPage = function (widget) {\n        var page = undefined;\n        if (widget.containerWidget instanceof BlockContainer) {\n            var bodyWidget = widget.containerWidget;\n            page = widget.containerWidget.page;\n        }\n        else if (!isNullOrUndefined(widget.containerWidget)) {\n            page = this.getPage(widget.containerWidget);\n        }\n        return page;\n    };\n    /**\n     * Clear Selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlightInSelectedWidgets = function () {\n        var isNonEmptySelection = false;\n        var widgets = this.selectedWidgets.keys;\n        for (var i = 0; i < widgets.length; i++) {\n            this.removeSelectionHighlight(widgets[i]);\n            isNonEmptySelection = true;\n        }\n        this.selectedWidgets.clear();\n        return isNonEmptySelection;\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearChildSelectionHighlight = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            if (widget.childWidgets[i] instanceof LineWidget) {\n                this.clearSelectionHighlightLineWidget(widget.childWidgets[i]);\n            }\n            else if (widget.childWidgets[i] instanceof TableCellWidget) {\n                this.clearSelectionHighlight(widget.childWidgets[i]);\n            }\n            else if (widget.childWidgets[i] instanceof Widget) {\n                this.clearChildSelectionHighlight(widget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * Get line widget from paragraph widget\n     * @private\n     */\n    //Body Widget\n    Selection.prototype.getLineWidgetBodyWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var childWidget = widget.childWidgets[i];\n            if (childWidget instanceof Widget && childWidget.y <= point.y\n                && (childWidget.y + childWidget.height) >= point.y) {\n                if (childWidget instanceof ParagraphWidget) {\n                    return this.getLineWidgetParaWidget(childWidget, point);\n                }\n                else {\n                    return this.getLineWidgetTableWidget(childWidget, point);\n                }\n            }\n        }\n        var line = undefined;\n        if (widget.childWidgets.length > 0) {\n            var firstChild = widget.childWidgets[0];\n            if (firstChild instanceof Widget && firstChild.y <= point.y) {\n                if (widget.childWidgets[widget.childWidgets.length - 1] instanceof ParagraphWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    line = this.getLineWidgetParaWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    line = this.getLineWidgetTableWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n            }\n            else {\n                var childWidget = undefined;\n                if (firstChild instanceof Widget) {\n                    childWidget = firstChild;\n                }\n                if (!isNullOrUndefined(childWidget)) {\n                    if (childWidget instanceof ParagraphWidget) {\n                        line = this.getLineWidgetParaWidget(firstChild, point);\n                    }\n                    else {\n                        line = this.getLineWidgetTableWidget(firstChild, point);\n                    }\n                }\n            }\n        }\n        return line;\n    };\n    //ParagraphWidget\n    /**\n     * Get line widget from paragraph widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetParaWidget = function (widget, point) {\n        var childWidgets = widget.childWidgets;\n        var top = widget.y;\n        for (var i = 0; i < childWidgets.length; i++) {\n            if (top <= point.y\n                && (top + childWidgets[i].height) >= point.y) {\n                return childWidgets[i];\n            }\n            top += childWidgets[i].height;\n        }\n        var lineWidget = undefined;\n        if (childWidgets.length > 0) {\n            if (widget.y <= point.y) {\n                lineWidget = childWidgets[childWidgets.length - 1];\n            }\n            else {\n                lineWidget = childWidgets[0];\n            }\n        }\n        return lineWidget;\n    };\n    /**\n     * highlight paragraph widget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.highlightParagraph = function (widget, startIndex, endLine, endElement, endIndex) {\n        var top = 0;\n        for (var i = startIndex; i < widget.childWidgets.length; i++) {\n            var line = widget.childWidgets[i];\n            if (i === startIndex) {\n                top = this.getTop(line);\n            }\n            var left = this.getLeft(line);\n            if (line === endLine) {\n                //Selection ends in current line.\n                var right = this.getLeftInternal(endLine, endElement, endIndex);\n                this.createHighlightBorder(line, right - left, left, top);\n                return;\n            }\n            this.createHighlightBorder(line, this.getWidth(line, true) - (left - widget.x), left, top);\n            top += line.height;\n        }\n    };\n    //Table Widget\n    /**\n     * Get line widget form table widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetTableWidget = function (widget, point) {\n        var lineWidget = undefined;\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            //Removed the height condition check to handle the vertically merged cells.\n            var childWidget = widget.childWidgets[i];\n            if (childWidget instanceof TableRowWidget && childWidget.y <= point.y) {\n                lineWidget = this.getLineWidgetRowWidget(childWidget, point);\n                var cellWidget = undefined;\n                if (!isNullOrUndefined(lineWidget) && lineWidget.paragraph.containerWidget instanceof TableCellWidget) {\n                    cellWidget = lineWidget.paragraph.containerWidget;\n                }\n                var cellSpacing = 0;\n                var rowSpan = 0;\n                if (!isNullOrUndefined(cellWidget)) {\n                    var tableWidget = cellWidget.ownerRow.containerWidget;\n                    cellSpacing = HelperMethods.convertPointToPixel(tableWidget.tableFormat.cellSpacing);\n                    rowSpan = cellWidget.cellFormat.rowSpan;\n                }\n                var leftCellSpacing = 0;\n                var rightCellSpacing = 0;\n                var topCellSpacing = 0;\n                var bottomCellSpacing = 0;\n                if (cellSpacing > 0) {\n                    leftCellSpacing = cellWidget.cellIndex === 0 ? cellSpacing : cellSpacing / 2;\n                    // tslint:disable-next-line:max-line-length\n                    rightCellSpacing = cellWidget.cellIndex === cellWidget.ownerRow.childWidgets.length - 1 ? cellSpacing : cellSpacing / 2;\n                    var rowWidget = undefined;\n                    if (cellWidget.containerWidget instanceof TableRowWidget) {\n                        rowWidget = cellWidget.containerWidget;\n                    }\n                    var tableWidget = undefined;\n                    if (cellWidget.containerWidget.containerWidget instanceof TableWidget) {\n                        tableWidget = cellWidget.containerWidget.containerWidget;\n                    }\n                    if (!isNullOrUndefined(rowWidget) && !isNullOrUndefined(tableWidget)) {\n                        topCellSpacing = cellWidget.ownerRow.rowIndex === 0 ? cellSpacing : cellSpacing / 2;\n                        if (cellWidget.ownerRow.rowIndex + rowSpan === cellWidget.ownerTable.childWidgets.length) {\n                            bottomCellSpacing = cellSpacing;\n                        }\n                        else {\n                            bottomCellSpacing = cellSpacing / 2;\n                        }\n                    }\n                }\n                if ((!isNullOrUndefined(lineWidget) && lineWidget.paragraph.x <= point.x\n                    && lineWidget.paragraph.x + lineWidget.width >= point.x\n                    && lineWidget.paragraph.y <= point.y && this.getTop(lineWidget) + lineWidget.height >= point.y)\n                    || (!isNullOrUndefined(cellWidget) && cellWidget.x - cellWidget.margin.left - leftCellSpacing <= point.x\n                        && cellWidget.x + cellWidget.width + cellWidget.margin.right + rightCellSpacing >= point.x\n                        && cellWidget.y - cellWidget.margin.top - topCellSpacing <= point.y\n                        && cellWidget.y + cellWidget.height + cellWidget.margin.bottom + bottomCellSpacing >= point.y)) {\n                    break;\n                }\n            }\n        }\n        return lineWidget;\n    };\n    //TableRowWidget\n    /**\n     * Get line widget fom row\n     * @private\n     */\n    Selection.prototype.getLineWidgetRowWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var cellSpacing = 0;\n            cellSpacing = HelperMethods.convertPointToPixel(widget.ownerTable.tableFormat.cellSpacing);\n            var leftCellSpacing = 0;\n            var rightCellSpacing = 0;\n            if (cellSpacing > 0) {\n                leftCellSpacing = widget.childWidgets[i].columnIndex === 0 ? cellSpacing : cellSpacing / 2;\n                // tslint:disable-next-line:max-line-length\n                rightCellSpacing = widget.childWidgets[i].cellIndex === widget.childWidgets[i].ownerRow.childWidgets.length - 1 ? cellSpacing : cellSpacing / 2;\n            }\n            if (widget.childWidgets[i].x -\n                // tslint:disable-next-line:max-line-length\n                widget.childWidgets[i].margin.left - leftCellSpacing <= point.x && (widget.childWidgets[i].x +\n                // tslint:disable-next-line:max-line-length\n                widget.childWidgets[i].width) + widget.childWidgets[i].margin.right + rightCellSpacing >= point.x) {\n                return this.getLineWidgetCellWidget(widget.childWidgets[i], point);\n            }\n        }\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            if (widget.childWidgets[0].x <= point.x) {\n                lineWidget = this.getLineWidgetCellWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n            }\n            else {\n                lineWidget = this.getLineWidgetCellWidget(widget.childWidgets[0], point);\n            }\n        }\n        return lineWidget;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlock = function (cell) {\n        if (cell.childWidgets.length > 0) {\n            return cell.childWidgets[0];\n        }\n        return undefined;\n    };\n    //Table Cell Widget\n    /**\n     * Highlight selected cell widget\n     * @private\n     */\n    Selection.prototype.highlightCellWidget = function (widget) {\n        var widgets = [];\n        if (widget.previousSplitWidget || widget.nextSplitWidget) {\n            widgets = widget.getSplitWidgets();\n        }\n        else {\n            widgets.push(widget);\n        }\n        for (var i = 0; i < widgets.length; i++) {\n            widget = widgets[i];\n            //Clears Selection highlight of the child widgets.\n            this.clearChildSelectionHighlight(widget);\n            //Highlights the entire cell.\n            this.createHighlightBorderInsideTable(widget);\n        }\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlight = function (widget) {\n        if (this.selectedWidgets.containsKey(widget)) {\n            this.removeSelectionHighlight(widget);\n            this.selectedWidgets.remove(widget);\n        }\n    };\n    /**\n     * Get line widget from cell widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetCellWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            if (widget.childWidgets[i].y <= point.y\n                && (widget.childWidgets[i].y + widget.childWidgets[i].height) >= point.y) {\n                if (widget.childWidgets[i] instanceof ParagraphWidget) {\n                    return this.getLineWidgetParaWidget(widget.childWidgets[i], point);\n                }\n                else {\n                    return this.getLineWidgetTableWidget(widget.childWidgets[i], point);\n                }\n            }\n        }\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            if (widget.childWidgets[0].y <= point.y) {\n                if (widget.childWidgets[widget.childWidgets.length - 1] instanceof ParagraphWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    lineWidget = this.getLineWidgetParaWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n                else {\n                    lineWidget = this.getLineWidgetTableWidget(widget.childWidgets[0], point);\n                }\n            }\n        }\n        return lineWidget;\n    };\n    //LineWidget\n    /**\n     * update text position\n     * @private\n     */\n    Selection.prototype.updateTextPosition = function (widget, point) {\n        var caretPosition = point;\n        var element = undefined;\n        var index = 0;\n        var isImageSelected = false;\n        var isImageSelectedObj = this.updateTextPositionIn(widget, element, index, point, false);\n        if (!isNullOrUndefined(isImageSelectedObj)) {\n            element = isImageSelectedObj.element;\n            index = isImageSelectedObj.index;\n            caretPosition = isImageSelectedObj.caretPosition;\n            isImageSelected = isImageSelectedObj.isImageSelected;\n            this.isImageSelected = isImageSelected;\n        }\n        if (isImageSelected) {\n            this.selectInternal(widget, element, index, caretPosition);\n            if (index === 0) {\n                this.extendForward();\n            }\n            else {\n                this.extendBackward();\n            }\n        }\n        else {\n            this.selectInternal(widget, element, index, caretPosition);\n        }\n    };\n    /**\n     * @private\n     */\n    /* tslint:disable */\n    Selection.prototype.updateTextPositionIn = function (widget, inline, index, caretPosition, includeParagraphMark) {\n        var isImageSelected = false;\n        var top = this.getTop(widget);\n        var left = widget.paragraph.x;\n        var elementValues = this.getFirstElement(widget, left);\n        var element = elementValues.element;\n        left = elementValues.left;\n        if (isNullOrUndefined(element)) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var size = this.getParagraphMarkSize(widget.paragraph, topMargin, bottomMargin);\n            topMargin = size.topMargin;\n            bottomMargin = size.bottomMargin;\n            var selectParaMark = this.viewer.mouseDownOffset.y >= top && this.viewer.mouseDownOffset.y < top + widget.height ? (this.viewer.mouseDownOffset.x < left + size.width) : true;\n            if (selectParaMark && includeParagraphMark && caretPosition.x > left + size.width / 2) {\n                left += size.width;\n                if (widget.children.length > 0) {\n                    inline = widget.children[widget.children.length - 1];\n                    index = inline.length;\n                }\n                index++;\n            }\n            caretPosition = new Point(left, topMargin > 0 ? top + topMargin : top);\n        }\n        else {\n            if (!isNullOrUndefined(element)) {\n                if (caretPosition.x > left + element.margin.left) {\n                    for (var i = widget.children.indexOf(element); i < widget.children.length; i++) {\n                        element = widget.children[i];\n                        if (caretPosition.x < left + element.margin.left + element.width || i === widget.children.length - 1) {\n                            break;\n                        }\n                        left += element.margin.left + element.width;\n                    }\n                    if (caretPosition.x > left + element.margin.left + element.width) {\n                        //Line End\n                        index = element instanceof TextElementBox ? element.length : 1;\n                        left += element.margin.left + element.width;\n                    }\n                    else if (element instanceof TextElementBox) {\n                        var x = caretPosition.x - left - element.margin.left;\n                        left += element.margin.left;\n                        var prevWidth = 0;\n                        var charIndex = 0;\n                        for (var i = 1; i <= element.length; i++) {\n                            var width = 0;\n                            if (i === element.length) {\n                                width = element.width;\n                            }\n                            else {\n                                width = this.viewer.textHelper.getWidth(element.text.substr(0, i), element.characterFormat);\n                            }\n                            if (x < width || i === element.length) {\n                                //Updates exact left position of the caret.\n                                var charWidth = width - prevWidth;\n                                if (x - prevWidth > charWidth / 2) {\n                                    left += width;\n                                    charIndex = i;\n                                }\n                                else {\n                                    left += prevWidth;\n                                    charIndex = i - 1;\n                                    if (i === 1 && element !== widget.children[0]) {\n                                        var curIndex = widget.children.indexOf(element);\n                                        if (!(widget.children[curIndex - 1] instanceof ListTextElementBox)) {\n                                            element = widget.children[curIndex - 1];\n                                            charIndex = element instanceof TextElementBox ? element.length : 1;\n                                        }\n                                    }\n                                }\n                                break;\n                            }\n                            prevWidth = width;\n                        }\n                        index = charIndex;\n                    }\n                    else {\n                        isImageSelected = element instanceof ImageElementBox;\n                        if (caretPosition.x - left - element.margin.left > element.width / 2) {\n                            index = 1;\n                            left += element.margin.left + element.width;\n                        }\n                        else if (element !== widget.children[0] && !isImageSelected) {\n                            var curIndex = widget.children.indexOf(element);\n                            if (!(widget.children[curIndex - 1] instanceof ListTextElementBox)) {\n                                element = widget.children[curIndex - 1];\n                                index = element instanceof TextElementBox ? element.length : 1;\n                            }\n                        }\n                    }\n                    if (element instanceof TextElementBox && element.text === '\\v') {\n                        index = 0;\n                    }\n                }\n                else {\n                    left += element.margin.left;\n                }\n                if (element instanceof TextElementBox) {\n                    top += element.margin.top > 0 ? element.margin.top : 0;\n                }\n                else {\n                    var textMetrics = this.viewer.textHelper.getHeight(element.characterFormat); //for ascent and descent\n                    var height = element.height;\n                    if (element instanceof BookmarkElementBox && !this.viewer.layout.hasValidElement(element.line.paragraph)) {\n                        height = textMetrics.Height; //after text helper class\n                    }\n                    top += element.margin.top + height - textMetrics.BaselineOffset;\n                }\n                inline = element;\n                var inlineObj = this.validateTextPosition(inline, index);\n                inline = inlineObj.element;\n                index = inlineObj.index;\n                var isParagraphEnd = isNullOrUndefined(inline.nextNode) && index === inline.length;\n                var isLineEnd = isNullOrUndefined(inline.nextNode)\n                    && inline instanceof TextElementBox && inline.text === '\\v';\n                if (includeParagraphMark && inline.nextNode instanceof FieldElementBox && index === inline.length) {\n                    isParagraphEnd = this.isLastRenderedInline(inline, index);\n                }\n                if (includeParagraphMark && isParagraphEnd || isLineEnd) {\n                    var width = 0;\n                    //Include width of Paragraph mark.\n                    if (isParagraphEnd) {\n                        width = this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n                        var selectParaMark = this.viewer.mouseDownOffset.y >= top && this.viewer.mouseDownOffset.y < top + widget.height ? (this.viewer.mouseDownOffset.x < left + width) : true;\n                        if (selectParaMark && caretPosition.x > left + width / 2) {\n                            left += width;\n                            index = inline.length + 1;\n                        }\n                        //Include width of line break mark.\n                    }\n                    else if (isLineEnd) {\n                        width = element.width;\n                        left += width;\n                        index = inline.length;\n                    }\n                }\n                caretPosition = new Point(left, top);\n            }\n        }\n        return {\n            'element': inline,\n            'index': index,\n            'caretPosition': caretPosition,\n            'isImageSelected': isImageSelected\n        };\n    };\n    /* tslint:enable */\n    /**\n     * Get text length if the line widget\n     * @private\n     */\n    // public getTextLength(viewer: LayoutViewer, widget: LineWidget, element: ElementBox): number {\n    //     let length: number = 0;\n    //     let count: number = widget.children.indexOf(element);\n    //     if (widget.children.length > 0 && widget.children[0] instanceof ListTextElementBox) {\n    //         if (widget.children[1] instanceof ListTextElementBox) {\n    //             count -= 2;\n    //         } else {\n    //             count -= 1;\n    //         }\n    //     }\n    //     for (let i: number = 1; i < count; i++) {\n    //         length += widget.children[i].length;\n    //     }\n    //     return length;\n    // }\n    /**\n     * Get Line widget left\n     * @private\n     */\n    Selection.prototype.getLeft = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.isParagraphFirstLine(widget) && !(paragraphFormat.textAlignment === 'Right')) {\n            left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n        }\n        for (var i = 0; i < widget.children.length; i++) {\n            var element = widget.children[i];\n            if (element instanceof ListTextElementBox) { //after list implementation\n                if (i === 0) {\n                    left += element.margin.left + element.width;\n                }\n                else {\n                    left += element.width;\n                }\n            }\n            else {\n                left += element.margin.left;\n                break;\n            }\n        }\n        return left;\n    };\n    /**\n     * Get line widget top\n     * @private\n     */\n    Selection.prototype.getTop = function (widget) {\n        var top = widget.paragraph.y;\n        var count = widget.paragraph.childWidgets.indexOf(widget);\n        for (var i = 0; i < count; i++) {\n            top += widget.paragraph.childWidgets[i].height;\n        }\n        return top;\n    };\n    /**\n     * Get first element the widget\n     * @private\n     */\n    Selection.prototype.getFirstElement = function (widget, left) {\n        var firstLineIndent = 0;\n        if (this.isParagraphFirstLine(widget)) {\n            firstLineIndent = HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        left += firstLineIndent;\n        var element = undefined;\n        for (var i = 0; i < widget.children.length; i++) {\n            element = widget.children[i];\n            if (element instanceof ListTextElementBox) {\n                left += element.margin.left + element.width;\n                element = undefined;\n                // }\n                //  else if (element instanceof FieldElementBox || element instanceof BookmarkElementBox\n                //     || (element.nextNode instanceof FieldElementBox && ((element.nextNode as FieldElementBox).fieldType === 2))) {\n                //     element = undefined;\n            }\n            else {\n                break;\n            }\n        }\n        return { 'element': element, 'left': left };\n    };\n    /**\n     * Return inline index\n     * @private\n     */\n    //ElementBox\n    Selection.prototype.getIndexInInline = function (elementBox) {\n        var indexInInline = 0;\n        if (elementBox instanceof TextElementBox) {\n            var count = elementBox.line.children.indexOf(elementBox);\n            for (var i = 0; i < count; i++) {\n                var element = elementBox.line.children[i];\n                if (element instanceof FieldElementBox || element instanceof ListTextElementBox) {\n                    continue;\n                }\n                indexInInline += element.length;\n            }\n        }\n        return indexInInline;\n    };\n    /**\n     * Return true if widget is first inline of paragraph\n     * @private\n     */\n    Selection.prototype.isParagraphFirstLine = function (widget) {\n        if (isNullOrUndefined(widget.paragraph.previousSplitWidget) &&\n            widget === widget.paragraph.firstChild) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isParagraphLastLine = function (widget) {\n        if (isNullOrUndefined(widget.paragraph.nextSplitWidget)\n            && widget === widget.paragraph.lastChild) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Return line widget width\n     * @private\n     */\n    Selection.prototype.getWidth = function (widget, includeParagraphMark) {\n        var width = 0;\n        if (this.isParagraphFirstLine(widget)) {\n            width += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        for (var i = 0; i < widget.children.length; i++) {\n            width += widget.children[i].margin.left + widget.children[i].width;\n        }\n        if (includeParagraphMark && widget.paragraph.childWidgets.indexOf(widget) === widget.paragraph.childWidgets.length - 1\n            && isNullOrUndefined(widget.paragraph.nextSplitWidget)) {\n            width += this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n        }\n        return width;\n    };\n    /**\n     * Return line widget left\n     * @private\n     */\n    Selection.prototype.getLeftInternal = function (widget, elementBox, index) {\n        var left = widget.paragraph.x;\n        if (this.isParagraphFirstLine(widget)) {\n            // tslint:disable-next-line:max-line-length\n            left += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        var count = widget.children.indexOf(elementBox);\n        if ((widget.children.length === 1 && widget.children[0] instanceof ListTextElementBox) || (widget.children.length === 2\n            && widget.children[0] instanceof ListTextElementBox && widget.children[1] instanceof ListTextElementBox)) {\n            count = widget.children.length;\n        }\n        for (var i = 0; i < count; i++) {\n            var widgetInternal = widget.children[i];\n            // if (widgetInternal instanceof FieldElementBox) {\n            //     continue;\n            // }\n            if (i === 1 && widget.children[i] instanceof ListTextElementBox) {\n                left += widget.children[i].width;\n            }\n            else {\n                left += widget.children[i].margin.left + widget.children[i].width;\n            }\n        }\n        if (!isNullOrUndefined(elementBox)) {\n            left += elementBox.margin.left;\n        }\n        if (elementBox instanceof TextElementBox) {\n            if (index === elementBox.length) {\n                left += elementBox.width;\n            }\n            else if (index > elementBox.length) {\n                // tslint:disable-next-line:max-line-length\n                left += elementBox.width + this.viewer.textHelper.getParagraphMarkWidth(elementBox.line.paragraph.characterFormat);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                left += this.viewer.textHelper.getWidth(elementBox.text.substr(0, index), elementBox.characterFormat);\n            }\n        }\n        else if (index > 0) {\n            if (!isNullOrUndefined(elementBox) && !(elementBox instanceof ListTextElementBox)) {\n                left += elementBox.width;\n                if (index === 2) {\n                    var paragraph = elementBox.line.paragraph;\n                    left += this.viewer.textHelper.getParagraphMarkWidth(paragraph.characterFormat);\n                }\n            }\n            else {\n                left += this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n            }\n        }\n        return left;\n    };\n    /**\n     * Return line widget start offset\n     * @private\n     */\n    Selection.prototype.getLineStartLeft = function (widget) {\n        var left = widget.paragraph.x;\n        if (this.isParagraphFirstLine(widget)) {\n            left += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        if (widget.children.length > 0) {\n            left += widget.children[0].margin.left;\n        }\n        return left;\n    };\n    /**\n     * Update text position\n     * @private\n     */\n    Selection.prototype.updateTextPositionWidget = function (widget, point, textPosition, includeParagraphMark) {\n        var caretPosition = point;\n        var inline = undefined;\n        var index = 0;\n        var updatePositionObj;\n        updatePositionObj = this.updateTextPositionIn(widget, inline, index, caretPosition, includeParagraphMark);\n        inline = updatePositionObj.element;\n        index = updatePositionObj.index;\n        caretPosition = updatePositionObj.caretPosition;\n        textPosition.setPositionForSelection(widget, inline, index, caretPosition);\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlightLineWidget = function (widget) {\n        if (!isNullOrUndefined(this.owner) && this.selectedWidgets.length > 0) {\n            this.clearSelectionHighlight(this);\n        }\n    };\n    /**\n     * Return first element from line widget\n     * @private\n     */\n    Selection.prototype.getFirstElementInternal = function (widget) {\n        var element = undefined;\n        for (var i = 0; i < widget.children.length; i++) {\n            element = widget.children[i];\n            if (element instanceof ListTextElementBox) {\n                element = undefined;\n            }\n            else {\n                break;\n            }\n        }\n        return element;\n    };\n    //Selection API    \n    /**\n     * Select content between given range\n     * @private\n     */\n    Selection.prototype.selectRange = function (startPosition, endPosition) {\n        this.start.setPositionInternal(startPosition);\n        this.end.setPositionInternal(endPosition);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Selects current paragraph\n     * @private\n     */\n    Selection.prototype.selectParagraph = function (paragraph, positionAtStart) {\n        var line = paragraph.firstChild;\n        if (positionAtStart) {\n            this.start.setPosition(line, positionAtStart);\n        }\n        else {\n            var endOffset = line.getEndOffset();\n            this.start.setPositionParagraph(line, endOffset);\n        }\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.setPositionForBlock = function (block, selectFirstBlock) {\n        var position;\n        if (block instanceof TableWidget) {\n            if (selectFirstBlock) {\n                block = this.getFirstParagraphInFirstCell(block);\n            }\n            else {\n                block = this.getLastParagraphInLastCell(block);\n            }\n        }\n        if (block instanceof ParagraphWidget) {\n            position = new TextPosition(this.owner);\n            if (selectFirstBlock) {\n                position.setPosition(block.firstChild, true);\n            }\n            else {\n                var line = block.lastChild;\n                position.setPositionParagraph(line, line.getEndOffset());\n            }\n        }\n        return position;\n    };\n    /**\n     * Select content in given text position\n     * @private\n     */\n    Selection.prototype.selectContent = function (textPosition, clearMultiSelection) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        this.start.setPositionInternal(textPosition);\n        this.end.setPositionInternal(textPosition);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Select paragraph\n     * @private\n     */\n    Selection.prototype.selectInternal = function (lineWidget, element, index, physicalLocation) {\n        this.start.setPositionForSelection(lineWidget, element, index, physicalLocation);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = physicalLocation.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.selects = function (lineWidget, offset, skipSelectionChange) {\n        this.viewer.clearSelectionHighlight();\n        this.start.setPositionForLineWidget(lineWidget, offset);\n        this.end.setPositionInternal(this.start);\n        if (!skipSelectionChange) {\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select content between start and end position\n     * @private\n     */\n    Selection.prototype.selectPosition = function (startPosition, endPosition) {\n        if (isNullOrUndefined(startPosition) || isNullOrUndefined(endPosition)) {\n            throw new Error('TextPosition cannot be undefined');\n        }\n        if (isNullOrUndefined(startPosition.paragraph)\n            || startPosition.offset > this.getParagraphLength(startPosition.paragraph) + 1) {\n            throw new Error('Start TextPosition is not valid.');\n        }\n        if (isNullOrUndefined(endPosition.paragraph)\n            || endPosition.offset > this.getParagraphLength(endPosition.paragraph) + 1) {\n            throw new Error('End TextPosition is not valid.');\n        }\n        if (startPosition.isAtSamePosition(endPosition)) {\n            // Select start position.\n            this.selectRange(startPosition, startPosition);\n        }\n        else {\n            // If both text position exists within same comment or outside comment, and not at same position.\n            if (startPosition.isExistBefore(endPosition)) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.validateForwardFieldSelection(startPosition.getHierarchicalIndexInternal(), endPosition.getHierarchicalIndexInternal());\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                startPosition.validateForwardFieldSelection(endPosition.getHierarchicalIndexInternal(), startPosition.getHierarchicalIndexInternal());\n            }\n            this.selectRange(startPosition, endPosition);\n        }\n    };\n    /**\n     * Notify selection change event\n     * @private\n     */\n    Selection.prototype.fireSelectionChanged = function (isSelectionChanged) {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.updatePhysicalPosition(true);\n                this.end.updatePhysicalPosition(false);\n            }\n            else {\n                this.start.updatePhysicalPosition(false);\n                this.end.updatePhysicalPosition(true);\n            }\n        }\n        if (!this.skipFormatRetrieval) {\n            this.retrieveCurrentFormatProperties();\n        }\n        this.viewer.clearSelectionHighlight();\n        this.hideToolTip();\n        if (this.owner.isLayoutEnabled && !this.owner.isShiftingEnabled) {\n            this.highlightSelection(true);\n        }\n        if (isSelectionChanged) {\n            if (this.start.paragraph.isInHeaderFooter && !this.owner.enableHeaderAndFooter) {\n                this.owner.enableHeaderAndFooter = true;\n            }\n            else if (!this.start.paragraph.isInHeaderFooter && this.owner.enableHeaderAndFooter) {\n                this.owner.enableHeaderAndFooter = false;\n            }\n            this.owner.fireSelectionChange();\n        }\n        this.viewer.updateFocus();\n    };\n    //Formats Retrieval\n    /**\n     * Retrieve all current selection format\n     * @private\n     */\n    Selection.prototype.retrieveCurrentFormatProperties = function () {\n        this.isRetrieveFormatting = true;\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        this.retrieveImageFormat(startPosition, endPosition);\n        this.retrieveCharacterFormat(startPosition, endPosition);\n        this.retrieveParagraphFormat(startPosition, endPosition);\n        this.retrieveSectionFormat(startPosition, endPosition);\n        this.retrieveTableFormat(startPosition, endPosition);\n        if (!this.isImageSelected) {\n            this.imageFormat.clearImageFormat();\n        }\n        this.isRetrieveFormatting = false;\n        this.setCurrentContextType();\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.retrieveImageFormat = function (start, end) {\n        var image;\n        if (start.currentWidget === end.currentWidget && start.offset + 1 === end.offset) {\n            var elementInfo = end.currentWidget.getInline(end.offset, 0);\n            image = elementInfo.element;\n            var index = elementInfo.index;\n            if (image instanceof ImageElementBox) {\n                var startOffset = start.currentWidget.getOffset(image, 0);\n                if (startOffset !== start.offset) {\n                    image = undefined;\n                }\n            }\n        }\n        if (image instanceof ImageElementBox) {\n            this.imageFormat.copyImageFormat(image);\n        }\n        else {\n            this.imageFormat.clearImageFormat();\n        }\n    };\n    Selection.prototype.setCurrentContextType = function () {\n        var contextIsinImage = this.imageFormat.image ? true : false;\n        var contextIsinTable = (isNullOrUndefined(this.tableFormat) || isNullOrUndefined(this.tableFormat.table)) ? false : true;\n        var style = this.start.paragraph.paragraphFormat.baseStyle;\n        if (style instanceof WParagraphStyle && style.name.toLowerCase().indexOf('toc') === 0) {\n            var tocField = this.getTocFieldInternal();\n            if (!isNullOrUndefined(tocField)) {\n                this.contextTypeInternal = 'TableOfContents';\n                return;\n            }\n        }\n        if (this.start.paragraph.isInHeaderFooter) {\n            var isInHeader = this.start.paragraph.bodyWidget.headerFooterType.indexOf('Header') !== -1;\n            if (contextIsinTable) {\n                if (contextIsinImage) {\n                    this.contextTypeInternal = isInHeader ? 'HeaderTableImage' : 'FooterTableImage';\n                }\n                else {\n                    this.contextTypeInternal = isInHeader ? 'HeaderTableText' : 'FooterTableText';\n                }\n            }\n            else {\n                if (contextIsinImage) {\n                    this.contextTypeInternal = isInHeader ? 'HeaderImage' : 'FooterImage';\n                }\n                else {\n                    this.contextTypeInternal = isInHeader ? 'HeaderText' : 'FooterText';\n                }\n            }\n        }\n        else {\n            if (contextIsinTable) {\n                this.contextTypeInternal = contextIsinImage ? 'TableImage' : 'TableText';\n            }\n            else {\n                this.contextTypeInternal = contextIsinImage ? 'Image' : 'Text';\n            }\n        }\n    };\n    //Table Format retrieval starts\n    /**\n     * Retrieve selection table format\n     * @private\n     */\n    Selection.prototype.retrieveTableFormat = function (start, end) {\n        var tableAdv = this.getTable(start, end);\n        if (!isNullOrUndefined(tableAdv)) {\n            this.tableFormat.copyFormat(tableAdv.tableFormat);\n            this.tableFormat.table = tableAdv;\n            this.retrieveCellFormat(start, end);\n            this.retrieveRowFormat(start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.tableFormat.clearFormat();\n        }\n    };\n    /**\n     * Retrieve selection cell format\n     * @private\n     */\n    Selection.prototype.retrieveCellFormat = function (start, end) {\n        if (start.paragraph.isInsideTable && end.paragraph.isInsideTable) {\n            this.cellFormat.copyFormat(start.paragraph.associatedCell.cellFormat);\n            this.getCellFormat(start.paragraph.associatedCell.ownerTable, start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.cellFormat.clearCellFormat();\n        }\n    };\n    /**\n     * Retrieve selection row format\n     * @private\n     */\n    Selection.prototype.retrieveRowFormat = function (start, end) {\n        if (start.paragraph.isInsideTable && end.paragraph.isInsideTable) {\n            this.rowFormat.copyFormat(start.paragraph.associatedCell.ownerRow.rowFormat);\n            this.getRowFormat(start.paragraph.associatedCell.ownerTable, start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.rowFormat.clearRowFormat();\n        }\n    };\n    /**\n     * Get selected cell format\n     * @private\n     */\n    Selection.prototype.getCellFormat = function (table, start, end) {\n        if (start.paragraph.associatedCell.equals(end.paragraph.associatedCell)) {\n            return;\n        }\n        var isStarted = false;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row === start.paragraph.associatedCell.ownerRow) {\n                isStarted = true;\n            }\n            if (isStarted) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (this.isCellSelected(cell, start, end)) {\n                        this.cellFormat.combineFormat(cell.cellFormat);\n                    }\n                    if (cell === end.paragraph.associatedCell) {\n                        this.cellFormat.combineFormat(cell.cellFormat);\n                        return;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Get selected row format\n     * @private\n     */\n    Selection.prototype.getRowFormat = function (table, start, end) {\n        var tableRow = start.paragraph.associatedCell.ownerRow;\n        if (tableRow === end.paragraph.associatedCell.ownerRow) {\n            return;\n        }\n        for (var i = table.childWidgets.indexOf(tableRow) + 1; i < table.childWidgets.length; i++) {\n            var tempTableRow = table.childWidgets[i];\n            this.rowFormat.combineFormat(tempTableRow.rowFormat);\n            if (tempTableRow === end.paragraph.associatedCell.ownerRow) {\n                return;\n            }\n        }\n    };\n    /**\n     * Return table with given text position\n     * @private\n     */\n    Selection.prototype.getTable = function (startPosition, endPosition) {\n        if (!isNullOrUndefined(startPosition.paragraph.associatedCell) && !isNullOrUndefined(endPosition.paragraph.associatedCell)) {\n            var startTable = startPosition.paragraph.associatedCell.ownerTable;\n            var endTable = startPosition.paragraph.associatedCell.ownerTable;\n            if (startTable === endTable) {\n                return startTable;\n            }\n            else {\n                if (startTable.contains(startPosition.paragraph.associatedCell)) {\n                    return startTable;\n                }\n                else if (endTable.contains(startPosition.paragraph.associatedCell)) {\n                    return endTable;\n                }\n                else if (!startTable.isInsideTable || !endTable.isInsideTable) {\n                    return undefined;\n                }\n                else {\n                    do {\n                        startTable = startTable.associatedCell.ownerTable;\n                        if (startTable === endTable || startTable.contains(endTable.associatedCell)) {\n                            return startTable;\n                        }\n                        else if (endTable.contains(startTable.associatedCell)) {\n                            return endTable;\n                        }\n                    } while (!isNullOrUndefined(startTable.associatedCell));\n                }\n            }\n        }\n        return undefined;\n    };\n    Selection.prototype.getContainerWidget = function (block) {\n        var bodyWidget;\n        if (block.containerWidget instanceof BlockContainer) {\n            bodyWidget = block.containerWidget;\n        }\n        else {\n            bodyWidget = block.containerWidget;\n            while (!(bodyWidget instanceof BlockContainer)) {\n                bodyWidget = bodyWidget.containerWidget;\n            }\n        }\n        return bodyWidget;\n    };\n    //Table format retrieval ends\n    //Section format retrieval starts\n    /**\n     * Retrieve selection section format\n     * @private\n     */\n    Selection.prototype.retrieveSectionFormat = function (start, end) {\n        var startParaSection = this.getContainerWidget(start.paragraph);\n        var endParaSection = this.getContainerWidget(end.paragraph);\n        if (!isNullOrUndefined(startParaSection)) {\n            this.sectionFormat.copyFormat(startParaSection.sectionFormat);\n            var startPageIndex = this.viewer.pages.indexOf(startParaSection.page);\n            var endPageIndex = this.viewer.pages.indexOf(endParaSection.page);\n            for (var i = startPageIndex + 1; i <= endPageIndex; i++) {\n                this.sectionFormat.combineFormat(this.viewer.pages[i].bodyWidgets[0].sectionFormat);\n            }\n        }\n    };\n    //section format retrieval ends.\n    //Paragraph format retrieval implementation starts.\n    /**\n     * Retrieve selection paragraph format\n     * @private\n     */\n    Selection.prototype.retrieveParagraphFormat = function (start, end) {\n        this.getParagraphFormatForSelection(start.paragraph, this, start, end);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatForSelection = function (paragraph, selection, start, end) {\n        //Selection start in cell.\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || this.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            this.getParagraphFormatInternalInCell(start.paragraph.associatedCell, start, end);\n        }\n        else {\n            this.getParagraphFormatInternalInParagraph(paragraph, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getParagraphFormatInternalInParagraph = function (paragraph, start, end) {\n        if (start.paragraph === paragraph) {\n            this.paragraphFormat.copyFormat(paragraph.paragraphFormat);\n        }\n        else {\n            this.paragraphFormat.combineFormat(paragraph.paragraphFormat);\n        }\n        if (end.paragraph === paragraph) {\n            return;\n        }\n        var block = this.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            this.getParagraphFormatInternalInBlock(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInBlock = function (block, start, end) {\n        if (block instanceof ParagraphWidget) {\n            this.getParagraphFormatInternalInParagraph(block, start, end);\n        }\n        else {\n            this.getParagraphFormatInternalInTable(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInTable = function (table, start, end) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var tableRow = table.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(tableRow.childWidgets[j]);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(tableRow, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(table);\n        //Goto the next block.\n        this.getParagraphFormatInternalInBlock(block, start, end);\n    };\n    /**\n     * Get paragraph format in cell\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInCell = function (cell) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            this.getParagraphFormatInBlock(cell.childWidgets[i]);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            this.getParagraphFormatInParagraph(block);\n        }\n        else {\n            this.getParagraphFormatInTable(block);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInTable = function (tableAdv) {\n        for (var i = 0; i < tableAdv.childWidgets.length; i++) {\n            var tableRow = tableAdv.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(tableRow.childWidgets[j]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInParagraph = function (paragraph) {\n        this.paragraphFormat.combineFormat(paragraph.paragraphFormat);\n    };\n    /**\n     * Get paragraph format in cell\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInCell = function (cellAdv, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(cellAdv, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(cellAdv, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.getParagraphFormatInCell(containerCell);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.getParagraphFormatInternalInParagraph(start.paragraph, start, end);\n                        }\n                        else {\n                            this.getParagraphFormatInRow(startCell.ownerRow, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.getParaFormatForCell(containerCell.ownerTable, containerCell, endCell);\n                }\n            }\n            else {\n                this.getParagraphFormatInRow(containerCell.ownerRow, start, end);\n            }\n        }\n        else {\n            var cell = this.getContainerCell(cellAdv);\n            this.getParagraphFormatInRow(cell.ownerRow, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParaFormatForCell = function (table, startCell, endCell) {\n        var startCellIn = this.getCellLeft(startCell.ownerRow, startCell);\n        var endCellIn = startCellIn + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (startCellIn > endCellLeft) {\n            startCellIn = endCellLeft;\n        }\n        if (endCellIn < endCellRight) {\n            endCellIn = endCellRight;\n        }\n        if (startCellIn > this.upDownSelectionLength) {\n            startCellIn = this.upDownSelectionLength;\n        }\n        if (startCellIn < this.upDownSelectionLength) {\n            startCellIn = this.upDownSelectionLength;\n        }\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var tableRow = table.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                var cell = tableRow.childWidgets[j];\n                var left = this.getCellLeft(tableRow, cell);\n                if (HelperMethods.round(startCellIn, 2) <= HelperMethods.round(left, 2)\n                    && HelperMethods.round(left, 2) < HelperMethods.round(endCellIn, 2)) {\n                    this.getParagraphFormatInCell(cell);\n                }\n            }\n        }\n    };\n    /**\n     * Get paragraph format ins row\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInRow = function (tableRow, start, end) {\n        for (var i = tableRow.rowIndex; i < tableRow.ownerTable.childWidgets.length; i++) {\n            var row = tableRow.ownerTable.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(row.childWidgets[j]);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(tableRow.ownerTable);\n        //Goto the next block.\n        this.getParagraphFormatInternalInBlock(block, start, end);\n    };\n    // paragraph format retrieval implementation ends\n    // Character format retrieval implementation starts.\n    /**\n     * Retrieve Selection character format\n     * @private\n     */\n    Selection.prototype.retrieveCharacterFormat = function (start, end) {\n        this.characterFormat.copyFormat(start.paragraph.characterFormat);\n        if (start.paragraph === end.paragraph && start.currentWidget.isLastLine()\n            && start.offset === this.getLineLength(start.currentWidget) && start.offset + 1 === end.offset) {\n            return;\n        }\n        var para = start.paragraph;\n        if (start.offset === this.getParagraphLength(para) && !this.isEmpty) {\n            para = this.getNextParagraphBlock(para);\n        }\n        while (!isNullOrUndefined(para) && para !== end.paragraph && para.isEmpty()) {\n            para = this.getNextParagraphBlock(para);\n        }\n        var offset = para === start.paragraph ? start.offset : 0;\n        var indexInInline = 0;\n        if (!isNullOrUndefined(para) && !para.isEmpty()) {\n            var position = new TextPosition(this.owner);\n            var elemInfo = start.currentWidget.getInline(offset, indexInInline);\n            var physicalLocation = this.getPhysicalPositionInternal(start.currentWidget, offset, true);\n            position.setPositionForSelection(start.currentWidget, elemInfo.element, elemInfo.index, physicalLocation);\n            this.getCharacterFormatForSelection(para, this, position, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCharacterFormatForSelection = function (paragraph, selection, startPosition, endPosition) {\n        //Selection start in cell.\n        if (startPosition.paragraph instanceof ParagraphWidget && startPosition.paragraph.isInsideTable\n            && (!endPosition.paragraph.isInsideTable\n                || startPosition.paragraph.associatedCell !== endPosition.paragraph.associatedCell\n                || this.isCellSelected(startPosition.paragraph.associatedCell, startPosition, endPosition))) {\n            this.getCharacterFormatInTableCell(startPosition.paragraph.associatedCell, selection, startPosition, endPosition);\n        }\n        else {\n            this.getCharacterFormat(paragraph, startPosition, endPosition);\n        }\n    };\n    /**\n     * Get Character format\n     * @private\n     */\n    //Format Retrieval\n    Selection.prototype.getCharacterFormatForTableRow = function (tableRowAdv, start, end) {\n        for (var i = tableRowAdv.rowIndex; i < tableRowAdv.ownerTable.childWidgets.length; i++) {\n            var tableRow = tableRowAdv.ownerTable.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getCharacterFormatForSelectionCell(tableRow.childWidgets[j], start, end);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(tableRow, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(tableRowAdv.ownerTable);\n        // //Goto the next block.\n        this.getCharacterFormatForBlock(block, start, end);\n    };\n    /**\n     * Get Character format in table\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInTableCell = function (tableCell, selection, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(tableCell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(tableCell, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.getCharacterFormatForSelectionCell(containerCell, start, end);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.getCharacterFormat(start.paragraph, start, end);\n                        }\n                        else {\n                            this.getCharacterFormatForTableRow(startCell.ownerRow, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.getCharacterFormatInternalInTable(containerCell.ownerTable, containerCell, endCell, start, end);\n                }\n            }\n            else {\n                this.getCharacterFormatForTableRow(containerCell.ownerRow, start, end);\n            }\n        }\n        else {\n            var cell = this.getContainerCell(tableCell);\n            this.getCharacterFormatForTableRow(cell.ownerRow, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCharacterFormatInternalInTable = function (table, startCell, endCell, startPosition, endPosition) {\n        var startIn = this.getCellLeft(startCell.ownerRow, startCell);\n        var endIn = startIn + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (startIn > endCellLeft) {\n            startIn = endCellLeft;\n        }\n        if (endIn < endCellRight) {\n            endIn = endCellRight;\n        }\n        if (startIn > this.upDownSelectionLength) {\n            startIn = this.upDownSelectionLength;\n        }\n        if (endIn < this.upDownSelectionLength) {\n            endIn = this.upDownSelectionLength;\n        }\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var left = this.getCellLeft(row, cell);\n                if (HelperMethods.round(startIn, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(endIn, 2)) {\n                    this.getCharacterFormatForSelectionCell(cell, startPosition, endPosition);\n                }\n            }\n        }\n    };\n    /**\n     * Get character format with in selection\n     * @private\n     */\n    Selection.prototype.getCharacterFormat = function (paragraph, start, end) {\n        if (paragraph !== start.paragraph && paragraph !== end.paragraph) {\n            this.getCharacterFormatInternal(paragraph, this);\n            return;\n        }\n        if (end.paragraph === paragraph && start.paragraph !== paragraph && end.offset === 0) {\n            return;\n        }\n        var startOffset = 0;\n        var length = this.getParagraphLength(paragraph);\n        if (paragraph === start.paragraph) {\n            startOffset = start.offset;\n            //Sets selection character format.            \n            var isUpdated = this.setCharacterFormat(paragraph, start, end, length);\n            if (isUpdated) {\n                return;\n            }\n        }\n        var startLineWidget = paragraph.childWidgets.indexOf(start.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(start.currentWidget) : 0;\n        var endLineWidget = paragraph.childWidgets.indexOf(end.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(end.currentWidget) : paragraph.childWidgets.length - 1;\n        var endOffset = end.offset;\n        if (paragraph !== end.paragraph) {\n            endOffset = length;\n        }\n        var isFieldStartSelected = false;\n        for (var i = startLineWidget; i <= endLineWidget; i++) {\n            var lineWidget = paragraph.childWidgets[i];\n            if (i !== startLineWidget) {\n                startOffset = this.getStartLineOffset(lineWidget);\n            }\n            if (lineWidget === end.currentWidget) {\n                endOffset = end.offset;\n            }\n            else {\n                endOffset = this.getLineLength(lineWidget);\n            }\n            var count = 0;\n            for (var j = 0; j < lineWidget.children.length; j++) {\n                var inline = lineWidget.children[j];\n                if (startOffset >= count + inline.length) {\n                    count += inline.length;\n                    continue;\n                }\n                if (inline instanceof FieldElementBox && inline.fieldType === 0\n                    && HelperMethods.isLinkedFieldCharacter(inline)) {\n                    var nextInline = isNullOrUndefined(inline.fieldSeparator) ?\n                        inline.fieldEnd : inline.fieldSeparator;\n                    do {\n                        count += inline.length;\n                        inline = inline.nextNode;\n                        i++;\n                    } while (!isNullOrUndefined(inline) && inline !== nextInline);\n                    isFieldStartSelected = true;\n                }\n                if (inline instanceof FieldElementBox && inline.fieldType === 1\n                    && HelperMethods.isLinkedFieldCharacter(inline) && isFieldStartSelected) {\n                    var fieldInline = inline.fieldBegin;\n                    do {\n                        this.characterFormat.combineFormat(fieldInline.characterFormat);\n                        fieldInline = fieldInline.nextNode;\n                    } while (!(fieldInline instanceof FieldElementBox));\n                }\n                if (inline instanceof TextElementBox) {\n                    this.characterFormat.combineFormat(inline.characterFormat);\n                }\n                if (isNullOrUndefined(inline) || endOffset <= count + inline.length) {\n                    break;\n                }\n                count += inline.length;\n            }\n        }\n        if (end.paragraph === paragraph) {\n            return;\n        }\n        var block = this.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            this.getCharacterFormatForBlock(block, start, end);\n        }\n    };\n    Selection.prototype.setCharacterFormat = function (para, startPos, endPos, length) {\n        var index = 0;\n        var startOffset = startPos.offset;\n        var inlineAndIndex = startPos.currentWidget.getInline(startOffset, index);\n        index = inlineAndIndex.index;\n        var inline = inlineAndIndex.element;\n        if (isNullOrUndefined(inline)) {\n            var currentLineIndex = startPos.paragraph.childWidgets.indexOf(startPos.currentWidget);\n            if (startPos.currentWidget.previousLine) {\n                inline = startPos.currentWidget.previousLine.children[startPos.currentWidget.previousLine.children.length - 1];\n                this.characterFormat.copyFormat(inline.characterFormat);\n                return true;\n            }\n        }\n        if (startOffset < length) {\n            if (this.isEmpty) {\n                if (inline instanceof TextElementBox || (inline instanceof FieldElementBox\n                    && (inline.fieldType === 0 || inline.fieldType === 1))) {\n                    var previousNode = this.getPreviousTextElement(inline);\n                    if (startOffset === 0 && previousNode) {\n                        inline = previousNode;\n                    }\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else {\n                    if (!isNullOrUndefined(this.getPreviousTextElement(inline))) {\n                        this.characterFormat.copyFormat(this.getPreviousTextElement(inline).characterFormat);\n                    }\n                    else if (!isNullOrUndefined(this.getNextTextElement(inline))) {\n                        this.characterFormat.copyFormat(this.getNextTextElement(inline).characterFormat);\n                    }\n                    else {\n                        this.characterFormat.copyFormat(para.characterFormat);\n                    }\n                }\n                return true;\n            }\n            else {\n                if (index === inline.length && !isNullOrUndefined(inline.nextNode)) {\n                    this.characterFormat.copyFormat(this.getNextValidCharacterFormat(inline));\n                }\n                else if (inline instanceof TextElementBox) {\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else if (inline instanceof FieldElementBox) {\n                    this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(inline));\n                }\n            }\n        }\n        else {\n            if (length === endPos.offset) {\n                if (inline instanceof TextElementBox || inline instanceof FieldElementBox) {\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else if (!isNullOrUndefined(inline)) {\n                    inline = this.getPreviousTextElement(inline);\n                    if (!isNullOrUndefined(inline)) {\n                        this.characterFormat.copyFormat(inline.characterFormat);\n                    }\n                }\n                else {\n                    this.characterFormat.copyFormat(para.characterFormat);\n                }\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatForBlock = function (block, start, end) {\n        if (block instanceof ParagraphWidget) {\n            this.getCharacterFormat(block, start, end);\n        }\n        else {\n            this.getCharacterFormatInTable(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInTable = function (table, start, end) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.getCharacterFormatForSelectionCell(row.childWidgets[j], start, end);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var blockAdv = this.getNextRenderedBlock(table);\n        // //Goto the next block.\n        this.getCharacterFormatForBlock(blockAdv, start, end);\n    };\n    /**\n     * Get character format in selection\n     * @private\n     */\n    Selection.prototype.getCharacterFormatForSelectionCell = function (cell, start, end) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            this.getCharacterFormatForBlock(cell.childWidgets[i], start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInternal = function (paragraph, selection) {\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var linewidget = paragraph.childWidgets[i];\n            for (var j = 0; j < linewidget.children.length; j++) {\n                var element = linewidget.children[j];\n                if (!(element instanceof ImageElementBox || element instanceof FieldElementBox)) {\n                    selection.characterFormat.combineFormat(element.characterFormat);\n                }\n            }\n        }\n    };\n    /**\n     * Get next valid character format from inline\n     * @private\n     */\n    Selection.prototype.getNextValidCharacterFormat = function (inline) {\n        var startInline = this.getNextTextElement(inline);\n        if (isNullOrUndefined(startInline)) {\n            return inline.characterFormat;\n        }\n        var fieldBegin = undefined;\n        if (startInline instanceof FieldElementBox) {\n            if (fieldBegin.fieldType === 0) {\n                fieldBegin = startInline;\n            }\n        }\n        if (isNullOrUndefined(fieldBegin)) {\n            return startInline.characterFormat;\n        }\n        else {\n            return this.getNextValidCharacterFormatOfField(fieldBegin);\n        }\n    };\n    /**\n     * Get next valid paragraph format from field\n     * @private\n     */\n    Selection.prototype.getNextValidCharacterFormatOfField = function (fieldBegin) {\n        var startInline = fieldBegin;\n        if (HelperMethods.isLinkedFieldCharacter(fieldBegin)) {\n            if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                startInline = fieldBegin.fieldEnd;\n            }\n            else {\n                startInline = fieldBegin.fieldSeparator;\n            }\n        }\n        var nextValidInline = undefined;\n        if (!isNullOrUndefined(startInline.nextNode)) {\n            //Check the next node is a valid and returns inline.\n            nextValidInline = this.getNextValidElement(startInline.nextNode);\n        }\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            return startInline.characterFormat;\n        }\n        return nextValidInline.characterFormat;\n    };\n    /**\n     * Return true if cursor point with in selection range\n     * @private\n     */\n    Selection.prototype.checkCursorIsInSelection = function (widget, point) {\n        if (isNullOrUndefined(this.start) || this.isEmpty || isNullOrUndefined(widget)) {\n            return false;\n        }\n        var isSelected = false;\n        do {\n            if (this.selectedWidgets.containsKey(widget)) {\n                var top_4 = void 0;\n                var left = void 0;\n                if (widget instanceof LineWidget) {\n                    top_4 = this.owner.selection.getTop(widget);\n                    left = this.owner.selection.getLeft(widget);\n                }\n                else {\n                    top_4 = widget.y;\n                    left = widget.x;\n                }\n                var widgetInfo = this.selectedWidgets.get(widget);\n                isSelected = widgetInfo.left <= point.x && top_4 <= point.y &&\n                    top_4 + widget.height >= point.y && widgetInfo.left + widgetInfo.width >= point.x;\n            }\n            widget = (widget instanceof LineWidget) ? widget.paragraph : widget.containerWidget;\n        } while (!isNullOrUndefined(widget) && !isSelected);\n        return isSelected;\n    };\n    /**\n     * Copy paragraph for to selection paragraph format\n     * @private\n     */\n    Selection.prototype.copySelectionParagraphFormat = function () {\n        var format = new WParagraphFormat();\n        this.paragraphFormat.copyToFormat(format);\n        return format;\n    };\n    /**\n     * Get hyperlink display text\n     * @private\n     */\n    // tslint:disable-next-line\n    Selection.prototype.getHyperlinkDisplayText = function (paragraph, fieldSeparator, fieldEnd, isNestedField, format) {\n        var para = paragraph;\n        if (para !== fieldEnd.line.paragraph) {\n            isNestedField = true;\n            return { displayText: '<<Selection in Document>>', 'isNestedField': isNestedField, 'format': format };\n        }\n        var displayText = '';\n        var lineIndex = para.childWidgets.indexOf(fieldSeparator.line);\n        var index = para.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < para.childWidgets.length; j++) {\n            var lineWidget = para.childWidgets[j];\n            if (j !== lineIndex) {\n                index = -1;\n            }\n            for (var i = index + 1; i < lineWidget.children.length; i++) {\n                var inline = lineWidget.children[i];\n                if (inline === fieldEnd) {\n                    return { 'displayText': displayText, 'isNestedField': isNestedField, 'format': format };\n                }\n                if (inline instanceof TextElementBox) {\n                    displayText += inline.text;\n                    format = inline.characterFormat;\n                }\n                else if (inline instanceof FieldElementBox) {\n                    if (inline instanceof FieldElementBox && inline.fieldType === 0\n                        && !isNullOrUndefined(inline.fieldEnd)) {\n                        if (isNullOrUndefined(inline.fieldSeparator)) {\n                            index = lineWidget.children.indexOf(inline.fieldEnd);\n                        }\n                        else {\n                            index = lineWidget.children.indexOf(inline.fieldSeparator);\n                        }\n                    }\n                }\n                else {\n                    isNestedField = true;\n                    return { 'displayText': '<<Selection in Document>>', 'isNestedField': isNestedField, 'format': format };\n                }\n            }\n        }\n        return { 'displayText': displayText, 'isNestedField': isNestedField, 'format': format };\n    };\n    /**\n     * Navigates hyperlink on mouse Event.\n     * @private\n     */\n    Selection.prototype.navigateHyperLinkOnEvent = function (cursorPoint, isTouchInput) {\n        var _this = this;\n        var widget = this.viewer.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget)) {\n            var hyperLinkField = this.getHyperLinkFieldInCurrentSelection(widget, cursorPoint);\n            //Invokes Hyperlink navigation events.\n            if (!isNullOrUndefined(hyperLinkField)) {\n                this.viewer.updateTextPositionForSelection(cursorPoint, 1);\n                this.fireRequestNavigate(hyperLinkField);\n                setTimeout(function () {\n                    if (_this.viewer) {\n                        _this.viewer.isTouchInput = isTouchInput;\n                        _this.viewer.updateFocus();\n                        _this.viewer.isTouchInput = false;\n                    }\n                });\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLinkText = function (fieldBegin) {\n        var hyperlink = new Hyperlink(fieldBegin, this);\n        var link = hyperlink.navigationLink;\n        if (hyperlink.localReference.length > 0) {\n            if (hyperlink.localReference[0] === '_' && (isNullOrUndefined(link) || link.length === 0)) {\n                link = 'Current Document';\n            }\n            else {\n                link += '#' + hyperlink.localReference;\n            }\n        }\n        hyperlink.destroy();\n        return link;\n    };\n    /**\n     * Set Hyperlink content to tool tip element\n     * @private\n     */\n    Selection.prototype.setHyperlinkContentToToolTip = function (fieldBegin, widget, xPos) {\n        if (fieldBegin) {\n            if (this.owner.contextMenuModule &&\n                this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n                return;\n            }\n            if (!this.toolTipElement) {\n                this.toolTipElement = createElement('div', { className: 'e-de-tooltip' });\n                this.viewer.viewerContainer.appendChild(this.toolTipElement);\n            }\n            this.toolTipElement.style.display = 'block';\n            var l10n = new L10n('documenteditor', this.owner.defaultLocale);\n            l10n.setLocale(this.owner.locale);\n            var toolTipText = l10n.getConstant('Click to follow link');\n            if (this.owner.useCtrlClickToFollowHyperlink) {\n                toolTipText = 'Ctrl+' + toolTipText;\n            }\n            var linkText = this.getLinkText(fieldBegin);\n            this.toolTipElement.innerHTML = linkText + '</br><b>' + toolTipText + '</b>';\n            var widgetTop = this.getTop(widget) * this.viewer.zoomFactor;\n            var page = this.getPage(widget.paragraph);\n            var containerWidth = this.viewer.viewerContainer.getBoundingClientRect().width + this.viewer.viewerContainer.scrollLeft;\n            var left = page.boundingRectangle.x + xPos * this.viewer.zoomFactor;\n            if ((left + this.toolTipElement.clientWidth + 10) > containerWidth) {\n                left = left - ((this.toolTipElement.clientWidth - (containerWidth - left)) + 15);\n            }\n            var top_5 = this.getPageTop(page) + (widgetTop - this.toolTipElement.offsetHeight);\n            top_5 = top_5 > this.viewer.viewerContainer.scrollTop ? top_5 : top_5 + widget.height + this.toolTipElement.offsetHeight;\n            this.showToolTip(left, top_5);\n            if (!isNullOrUndefined(this.toolTipField) && fieldBegin !== this.toolTipField) {\n                this.toolTipObject.position = { X: left, Y: top_5 };\n            }\n            this.toolTipObject.show();\n            this.toolTipField = fieldBegin;\n        }\n        else {\n            this.hideToolTip();\n        }\n    };\n    /**\n     * Show hyperlink tooltip\n     * @private\n     */\n    Selection.prototype.showToolTip = function (x, y) {\n        if (!this.toolTipObject) {\n            this.toolTipObject = new Popup(this.toolTipElement, {\n                height: 'auto',\n                width: 'auto',\n                relateTo: this.viewer.viewerContainer.parentElement,\n                position: { X: x, Y: y }\n            });\n        }\n    };\n    /**\n     * Hide tooltip object\n     * @private\n     */\n    Selection.prototype.hideToolTip = function () {\n        this.toolTipField = undefined;\n        if (this.toolTipObject) {\n            this.toolTipObject.hide();\n            this.toolTipObject.destroy();\n            this.toolTipObject = undefined;\n            this.toolTipElement.style.display = 'none';\n        }\n    };\n    /**\n     * Return hyperlink field\n     * @private\n     */\n    Selection.prototype.getHyperLinkFieldInCurrentSelection = function (widget, cursorPosition) {\n        var inline = undefined;\n        var top = this.getTop(widget);\n        var lineStartLeft = this.getLineStartLeft(widget);\n        if (cursorPosition.y < top || cursorPosition.y > top + widget.height\n            || cursorPosition.x < lineStartLeft || cursorPosition.x > lineStartLeft + widget.paragraph.width) {\n            return undefined;\n        }\n        var left = widget.paragraph.x;\n        var elementValues = this.getFirstElement(widget, left);\n        left = elementValues.left;\n        var element = elementValues.element;\n        if (isNullOrUndefined(element)) {\n            var width = this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n            if (cursorPosition.x <= lineStartLeft + width || cursorPosition.x >= lineStartLeft + width) {\n                //Check if paragraph is within a field result.\n                var checkedFields = [];\n                var field = this.getHyperLinkFields(widget.paragraph, checkedFields);\n                checkedFields = [];\n                checkedFields = undefined;\n                return field;\n            }\n        }\n        else {\n            if (cursorPosition.x > left + element.margin.left) {\n                for (var i = widget.children.indexOf(element); i < widget.children.length; i++) {\n                    element = widget.children[i];\n                    if (cursorPosition.x < left + element.margin.left + element.width || i === widget.children.length - 1) {\n                        break;\n                    }\n                    left += element.margin.left + element.width;\n                }\n            }\n            inline = element;\n            var width = element.margin.left + element.width;\n            if (isNullOrUndefined(inline.nextNode)) {\n                //Include width of Paragraph mark.\n                width += this.viewer.textHelper.getParagraphMarkWidth(inline.line.paragraph.characterFormat);\n            }\n            if (cursorPosition.x <= left + width) {\n                //Check if inline is within a field result.\n                var checkedFields = [];\n                var field = this.getHyperLinkFieldInternal(inline.line.paragraph, inline, checkedFields);\n                checkedFields = [];\n                checkedFields = undefined;\n                return field;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Return field if paragraph contain hyperlink field\n     * @private\n     */\n    Selection.prototype.getHyperlinkField = function () {\n        if (isNullOrUndefined(this.end)) {\n            return undefined;\n        }\n        var index = 0;\n        var currentInline = this.end.currentWidget.getInline(this.end.offset, index);\n        index = currentInline.index;\n        var inline = currentInline.element;\n        var checkedFields = [];\n        var field = undefined;\n        if (isNullOrUndefined(inline)) {\n            field = this.getHyperLinkFields(this.end.paragraph, checkedFields);\n        }\n        else {\n            var paragraph = inline.line.paragraph;\n            field = this.getHyperLinkFieldInternal(paragraph, inline, checkedFields);\n        }\n        checkedFields = [];\n        return field;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getHyperLinkFields = function (paragraph, checkedFields) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            if (checkedFields.indexOf(this.viewer.fields[i]) !== -1 || isNullOrUndefined(this.viewer.fields[i].fieldSeparator)) {\n                continue;\n            }\n            else {\n                checkedFields.push(this.viewer.fields[i]);\n            }\n            var field = this.getFieldCode(this.viewer.fields[i]);\n            field = field.trim().toLowerCase();\n            if (field.match('hyperlink ') && this.paragraphIsInFieldResult(this.viewer.fields[i], paragraph)) {\n                return this.viewer.fields[i];\n            }\n        }\n        // if (paragraph.containerWidget instanceof BodyWidget && !(paragraph instanceof WHeaderFooter)) {\n        //     return this.getHyperLinkFields((paragraph.con as WCompositeNode), checkedFields);\n        // }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getHyperLinkFieldInternal = function (paragraph, inline, fields) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            if (fields.indexOf(this.viewer.fields[i]) !== -1 || isNullOrUndefined(this.viewer.fields[i].fieldSeparator)) {\n                continue;\n            }\n            else {\n                fields.push(this.viewer.fields[i]);\n            }\n            var fieldCode = this.getFieldCode(this.viewer.fields[i]);\n            fieldCode = fieldCode.trim().toLowerCase();\n            if (fieldCode.match('hyperlink ') && (this.inlineIsInFieldResult(this.viewer.fields[i], inline) || this.isImageField())) {\n                return this.viewer.fields[i];\n            }\n        }\n        if (paragraph.containerWidget instanceof BodyWidget && !(paragraph instanceof HeaderFooterWidget)) {\n            return this.getHyperLinkFieldInternal(paragraph.containerWidget, inline, fields);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getBlock = function (currentIndex) {\n        if (currentIndex === '' || isNullOrUndefined(currentIndex)) {\n            return undefined;\n        }\n        var index = { index: currentIndex };\n        var page = this.start.getPage(index);\n        var bodyIndex = index.index.indexOf(';');\n        var value = index.index.substring(0, bodyIndex);\n        index.index = index.index.substring(bodyIndex).replace(';', '');\n        var bodyWidget = page.bodyWidgets[parseInt(value, 10)];\n        return this.getBlockInternal(bodyWidget, index.index);\n    };\n    /**\n     * Return Block relative to position\n     * @private\n     */\n    Selection.prototype.getBlockInternal = function (widget, position) {\n        if (position === '' || isNullOrUndefined(position)) {\n            return undefined;\n        }\n        var index = position.indexOf(';');\n        var value = position.substring(0, index);\n        position = position.substring(index).replace(';', '');\n        var node = widget;\n        // if (node instanceof Widget && value === 'HF') {\n        //     //Gets the block in Header footers.\n        //     let blockObj: BlockInfo = this.getBlock((node as WSection).headersFooters, position);\n        // tslint:disable-next-line:max-line-length\n        //     return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n        // }\n        index = parseInt(value, 10);\n        if (index >= 0 && index < widget.childWidgets.length) {\n            var child = widget.childWidgets[(index)];\n            if (position.indexOf(';') >= 0) {\n                if (child instanceof ParagraphWidget) {\n                    if (position.indexOf(';') >= 0) {\n                        position = '0';\n                    }\n                    return child;\n                }\n                if (child instanceof BlockWidget) {\n                    var blockObj = this.getBlockInternal(child, position);\n                    return blockObj;\n                }\n            }\n            else {\n                return child;\n            }\n        }\n        else {\n            return node;\n        }\n        return node;\n    };\n    /**\n     * Return true if inline is in field result\n     * @private\n     */\n    Selection.prototype.inlineIsInFieldResult = function (fieldBegin, inline) {\n        if (!isNullOrUndefined(fieldBegin.fieldEnd) && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            if (this.isExistBeforeInline(fieldBegin.fieldSeparator, inline)) {\n                return this.isExistAfterInline(fieldBegin.fieldEnd, inline);\n            }\n        }\n        return false;\n    };\n    /**\n     * Retrieve true if paragraph is in field result\n     * @private\n     */\n    Selection.prototype.paragraphIsInFieldResult = function (fieldBegin, paragraph) {\n        if (!isNullOrUndefined(fieldBegin.fieldEnd) && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            var fieldParagraph = fieldBegin.fieldSeparator.line.paragraph;\n            if (fieldBegin.fieldSeparator.line.paragraph === paragraph\n                || this.isExistBefore(fieldParagraph, paragraph)) {\n                var currentParagraph = fieldBegin.fieldEnd.line.paragraph;\n                return (currentParagraph !== paragraph && this.isExistAfter(fieldParagraph, paragraph));\n            }\n        }\n        return false;\n    };\n    /**\n     * Return true if image is In field\n     * @private\n     */\n    Selection.prototype.isImageField = function () {\n        if (this.start.paragraph.isEmpty() || this.end.paragraph.isEmpty()) {\n            return false;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        var indexInInline = 0;\n        var inlineInfo = startPosition.paragraph.getInline(startPosition.offset, indexInInline);\n        var inline = inlineInfo.element;\n        indexInInline = inlineInfo.index;\n        if (indexInInline === inline.length) {\n            inline = this.getNextRenderedElementBox(inline, indexInInline);\n        }\n        inlineInfo = endPosition.paragraph.getInline(endPosition.offset, indexInInline);\n        var endInline = inlineInfo.element;\n        indexInInline = inlineInfo.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0\n            && endInline instanceof FieldElementBox && endInline.fieldType === 1 && inline.fieldSeparator) {\n            var fieldValue = inline.fieldSeparator.nextNode;\n            if (fieldValue instanceof ImageElementBox && fieldValue.nextNode === endInline) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Select List Text\n     * @private\n     */\n    Selection.prototype.selectListText = function () {\n        var lineWidget = this.viewer.selectionLineWidget;\n        var endOffset = '0';\n        var selectionIndex = lineWidget.getHierarchicalIndex(endOffset);\n        var startPosition = this.getTextPosition(selectionIndex);\n        var endPosition = this.getTextPosition(selectionIndex);\n        this.selectRange(startPosition, endPosition);\n        this.highlightListText(this.viewer.selectionLineWidget);\n        this.contextTypeInternal = 'List';\n    };\n    /**\n     * Manually select the list text\n     * @private\n     */\n    Selection.prototype.highlightListText = function (linewidget) {\n        var width = linewidget.children[0].width;\n        var left = this.viewer.getLeftValue(linewidget);\n        var top = linewidget.paragraph.y;\n        this.createHighlightBorder(linewidget, width, left, top);\n        this.viewer.isListTextSelected = true;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.updateImageSize = function (imageFormat) {\n        this.owner.isShiftingEnabled = true;\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        var inline = null;\n        var index = 0;\n        var paragraph = startPosition.paragraph;\n        if (paragraph === endPosition.paragraph\n            && startPosition.offset + 1 === endPosition.offset) {\n            var inlineObj = paragraph.getInline(endPosition.offset, index);\n            inline = inlineObj.element;\n            index = inlineObj.index;\n        }\n        if (inline instanceof ImageElementBox) {\n            var width = inline.width;\n            var height = inline.height;\n            inline.width = imageFormat.width;\n            inline.height = imageFormat.height;\n            imageFormat.width = width;\n            imageFormat.height = height;\n            if (paragraph != null && paragraph.containerWidget != null && this.owner.editorModule) {\n                var lineIndex = paragraph.childWidgets.indexOf(inline.line);\n                var elementIndex = inline.line.children.indexOf(inline);\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n                this.highlightSelection(false);\n            }\n        }\n    };\n    /**\n     * Gets selected table content\n     * @private\n     */\n    Selection.prototype.getSelectedCellsInTable = function (table, startCell, endCell) {\n        var startColumnIndex = startCell.columnIndex;\n        var endColumnIndex = endCell.columnIndex + endCell.cellFormat.columnSpan - 1;\n        var startRowindex = startCell.ownerRow.index;\n        var endRowIndex = endCell.ownerRow.index;\n        var cells = [];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.index >= startRowindex && row.index <= endRowIndex) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (cell.columnIndex >= startColumnIndex && cell.columnIndex <= endColumnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n            if (row.index > endRowIndex) {\n                break;\n            }\n        }\n        return cells;\n        // return html;\n    };\n    /**\n     * Copies the selected content to clipboard.\n     */\n    Selection.prototype.copy = function () {\n        if (this.isEmpty) {\n            return;\n        }\n        this.copySelectedContent(false);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.copySelectedContent = function (isCut) {\n        if (isNullOrUndefined(this.owner.sfdtExportModule)) {\n            return;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        /* tslint:disable:no-any */\n        // tslint:disable-next-line:max-line-length\n        var document = this.owner.sfdtExportModule.write(startPosition.currentWidget, startPosition.offset, endPosition.currentWidget, endPosition.offset, true);\n        /* tslint:enable:no-any */\n        if (this.owner.editorModule) {\n            this.owner.editorModule.copiedData = JSON.stringify(document);\n        }\n        var html = this.htmlWriter.writeHtml(document);\n        this.copyToClipboard(html);\n        if (isCut && this.owner.editorModule) {\n            this.owner.editorModule.handleCut(this);\n        }\n        this.viewer.updateFocus();\n    };\n    /**\n     * Copy content to clipboard\n     * @private\n     */\n    Selection.prototype.copyToClipboard = function (htmlContent) {\n        window.getSelection().removeAllRanges();\n        var div = document.createElement('div');\n        div.style.left = '-10000px';\n        div.style.top = '-10000px';\n        div.innerHTML = htmlContent;\n        document.body.appendChild(div);\n        var range = document.createRange();\n        range.selectNodeContents(div);\n        window.getSelection().addRange(range);\n        var copySuccess = false;\n        try {\n            copySuccess = document.execCommand('copy');\n        }\n        catch (e) {\n            // Copying data to Clipboard can potentially fail - for example, if another application is holding Clipboard open.\n        }\n        finally {\n            window.getSelection().removeAllRanges();\n            div.parentNode.removeChild(div);\n            this.viewer.viewerContainer.focus();\n        }\n        return copySuccess;\n    };\n    // Caret implementation starts\n    /**\n     * Shows caret in current selection position.\n     * @private\n     */\n    Selection.prototype.showCaret = function () {\n        // tslint:disable-next-line:max-line-length\n        var page = !isNullOrUndefined(this.viewer.currentPage) ? this.viewer.currentPage : this.viewer.currentRenderingPage;\n        if (isNullOrUndefined(page) || this.viewer.isRowOrCellResizing || this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizerVisible) {\n            return;\n        }\n        var left = page.boundingRectangle.x;\n        var right = page.boundingRectangle.width * this.viewer.zoomFactor + left;\n        if (!this.owner.enableImageResizerMode || !this.owner.imageResizerModule.isImageResizerVisible) {\n            // tslint:disable-next-line:max-line-length\n            if (this.isEmpty && (!this.owner.isReadOnlyMode || this.owner.enableCursorOnReadOnly)) {\n                var caretLeft = parseInt(this.caret.style.left.replace('px', ''), 10);\n                if (caretLeft < left || caretLeft > right) {\n                    this.caret.style.display = 'none';\n                }\n                else {\n                    this.caret.style.display = 'block';\n                }\n            }\n            else if (this.isImageSelected && !this.owner.enableImageResizerMode) {\n                this.caret.style.display = 'block';\n            }\n            else {\n                if (this.caret.style.display === 'block' || isNullOrUndefined(this)) {\n                    if (!this.viewer.isComposingIME) {\n                        this.caret.style.display = 'none';\n                    }\n                }\n            }\n        }\n        if (!isNullOrUndefined(this) && this.viewer.isTouchInput && !this.owner.isReadOnlyMode) {\n            var caretStartLeft = parseInt(this.viewer.touchStart.style.left.replace('px', ''), 10) + 14;\n            var caretEndLeft = parseInt(this.viewer.touchEnd.style.left.replace('px', ''), 10) + 14;\n            var page_1 = this.getSelectionPage(this.start);\n            if (page_1) {\n                if (caretEndLeft < left || caretEndLeft > right) {\n                    this.viewer.touchEnd.style.display = 'none';\n                }\n                else {\n                    this.viewer.touchEnd.style.display = 'block';\n                }\n                if (!this.isEmpty) {\n                    left = page_1.boundingRectangle.x;\n                    right = page_1.boundingRectangle.width * this.viewer.zoomFactor + left;\n                }\n                if (caretStartLeft < left || caretStartLeft > right) {\n                    this.viewer.touchStart.style.display = 'none';\n                }\n                else {\n                    this.viewer.touchStart.style.display = 'block';\n                }\n            }\n        }\n        else {\n            this.viewer.touchStart.style.display = 'none';\n            this.viewer.touchEnd.style.display = 'none';\n        }\n    };\n    /**\n     * To set the editable div caret position\n     * @private\n     */\n    Selection.prototype.setEditableDivCaretPosition = function (index) {\n        this.viewer.editableDiv.focus();\n        var child = this.viewer.editableDiv.childNodes[this.viewer.editableDiv.childNodes.length - 1];\n        if (child) {\n            var range = document.createRange();\n            range.setStart(child, index);\n            range.collapse(true);\n            window.getSelection().removeAllRanges();\n            window.getSelection().addRange(range);\n        }\n    };\n    /**\n     * Initializes caret.\n     * @private\n     */\n    Selection.prototype.initCaret = function () {\n        this.caret = createElement('div', {\n            styles: 'position:absolute',\n            className: 'e-de-blink-cursor e-de-cursor-animation'\n        });\n        this.viewer.viewerContainer.appendChild(this.caret);\n    };\n    /**\n     * Updates caret position.\n     * @private\n     */\n    Selection.prototype.updateCaretPosition = function () {\n        var caretPosition = this.end.location;\n        var page = this.getSelectionPage(this.end);\n        if (page) {\n            this.caret.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor) + 'px';\n            var caretInfo = this.updateCaretSize(this.owner.selection.end);\n            var topMargin = caretInfo.topMargin;\n            var caretHeight = caretInfo.height;\n            var viewer = this.viewer;\n            // tslint:disable-next-line:max-line-length\n            var pageTop = (page.boundingRectangle.y - viewer.pageGap * (this.viewer.pages.indexOf(page) + 1)) * this.viewer.zoomFactor + viewer.pageGap * (this.viewer.pages.indexOf(page) + 1);\n            this.caret.style.top = pageTop + (Math.round(caretPosition.y + topMargin) * this.viewer.zoomFactor) + 'px';\n            if (this.owner.selection.characterFormat.baselineAlignment === 'Subscript') {\n                this.caret.style.top = parseFloat(this.caret.style.top) + (parseFloat(this.caret.style.height) / 2) + 'px';\n            }\n            if (this.viewer.isTouchInput || this.viewer.touchStart.style.display !== 'none') {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.touchStart.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor - 14) + 'px';\n                this.viewer.touchStart.style.top = pageTop + ((caretPosition.y + caretInfo.height) * this.viewer.zoomFactor) + 'px';\n                // tslint:disable-next-line:max-line-length\n                this.viewer.touchEnd.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor - 14) + 'px';\n                this.viewer.touchEnd.style.top = pageTop + ((caretPosition.y + caretInfo.height) * this.viewer.zoomFactor) + 'px';\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getRect = function (position) {\n        var caretPosition = position.location;\n        var page = this.getSelectionPage(position);\n        if (page) {\n            var viewer = this.viewer;\n            var left = page.boundingRectangle.x + (Math.round(caretPosition.x) * viewer.zoomFactor);\n            var pageGap = viewer.pageGap;\n            // tslint:disable-next-line:max-line-length\n            var pageTop = (page.boundingRectangle.y - pageGap * (page.index + 1)) * viewer.zoomFactor + pageGap * (page.index + 1);\n            var top_6 = pageTop + (Math.round(caretPosition.y) * viewer.zoomFactor);\n            return new Point(left, top_6);\n        }\n        return new Point(0, 0);\n    };\n    /**\n     * Gets current selected page\n     * @private\n     */\n    Selection.prototype.getSelectionPage = function (position) {\n        var lineWidget = this.getLineWidgetInternal(position.currentWidget, position.offset, true);\n        if (lineWidget) {\n            return this.getPage(lineWidget.paragraph);\n        }\n        return undefined;\n    };\n    /**\n     * Updates caret size.\n     * @private\n     */\n    Selection.prototype.updateCaretSize = function (textPosition, skipUpdate) {\n        var topMargin = 0;\n        var isItalic = false;\n        var caret;\n        var index = 0;\n        var caretHeight = 0;\n        if (this.characterFormat.italic) {\n            isItalic = this.characterFormat.italic;\n        }\n        if (textPosition.paragraph.isEmpty()) {\n            var paragraph = textPosition.paragraph;\n            var bottomMargin = 0;\n            var paragraphInfo = this.getParagraphMarkSize(paragraph, topMargin, bottomMargin);\n            topMargin = paragraphInfo.topMargin;\n            bottomMargin = paragraphInfo.bottomMargin;\n            var height = paragraphInfo.height;\n            caretHeight = topMargin < 0 ? topMargin + height : height;\n            if (!skipUpdate) {\n                this.caret.style.height = caretHeight * this.viewer.zoomFactor + 'px';\n            }\n            topMargin = 0;\n        }\n        else {\n            var inlineInfo = textPosition.currentWidget.getInline(textPosition.offset, index);\n            index = inlineInfo.index;\n            var inline = inlineInfo.element;\n            if (!isNullOrUndefined(inline)) {\n                caret = this.getCaretHeight(inline, index, inline.characterFormat, true, topMargin, isItalic);\n                caretHeight = caret.height;\n                if (!skipUpdate) {\n                    this.caret.style.height = caret.height * this.viewer.zoomFactor + 'px';\n                }\n            }\n        }\n        if (!skipUpdate) {\n            if (isItalic) {\n                this.caret.style.transform = 'rotate(13deg)';\n            }\n            else {\n                this.caret.style.transform = '';\n            }\n        }\n        return {\n            'topMargin': topMargin,\n            'height': caretHeight\n        };\n    };\n    /**\n     * Updates caret to page.\n     * @private\n     */\n    Selection.prototype.updateCaretToPage = function (startPosition, endPage) {\n        if (!isNullOrUndefined(endPage)) {\n            this.viewer.selectionEndPage = endPage;\n            if (this.owner.selection.isEmpty) {\n                this.viewer.selectionStartPage = endPage;\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                var startLineWidget = this.getLineWidgetParagraph(startPosition.offset, startPosition.paragraph.childWidgets[0]);\n                //Gets start page.\n                var startPage = this.getPage(startLineWidget.paragraph);\n                if (!isNullOrUndefined(startPage)) {\n                    this.viewer.selectionStartPage = startPage;\n                }\n            }\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Gets caret bottom position.\n     * @private\n     */\n    Selection.prototype.getCaretBottom = function (textPosition, isEmptySelection) {\n        var bottom = textPosition.location.y;\n        if (textPosition.paragraph.isEmpty()) {\n            var paragraph = textPosition.paragraph;\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var sizeInfo = this.getParagraphMarkSize(paragraph, topMargin, bottomMargin);\n            topMargin = sizeInfo.topMargin;\n            bottomMargin = sizeInfo.bottomMargin;\n            bottom += sizeInfo.height;\n            bottom += topMargin;\n            if (!isEmptySelection) {\n                bottom += bottomMargin;\n            }\n        }\n        else {\n            var index = 0;\n            var inlineInfo = textPosition.paragraph.getInline(textPosition.offset, index);\n            var inline = inlineInfo.element;\n            index = inlineInfo.index;\n            var topMargin = 0;\n            var isItalic = false;\n            // tslint:disable-next-line:max-line-length\n            var caretHeightInfo = this.getCaretHeight(inline, index, inline.characterFormat, false, topMargin, isItalic);\n            topMargin = caretHeightInfo.topMargin;\n            isItalic = caretHeightInfo.isItalic;\n            bottom += caretHeightInfo.height;\n            if (isEmptySelection) {\n                bottom -= HelperMethods.convertPointToPixel(textPosition.paragraph.paragraphFormat.afterSpacing);\n            }\n        }\n        return bottom;\n    };\n    /**\n     * Checks for cursor visibility.\n     * @param isTouch\n     * @private\n     */\n    Selection.prototype.checkForCursorVisibility = function () {\n        this.showCaret();\n    };\n    // caret implementation ends\n    /**\n     * Keyboard shortcuts\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Selection.prototype.onKeyDownInternal = function (event, ctrl, shift, alt) {\n        var key = event.which || event.keyCode;\n        if (ctrl && !shift && !alt) {\n            this.viewer.isControlPressed = true;\n            switch (key) {\n                // case 9:\n                //     event.preventDefault();\n                //     if (this.owner.acceptTab) {\n                //         this.selection.handleTabKey(false, false);\n                //     }\n                //     break;\n                case 35:\n                    this.handleControlEndKey();\n                    break;\n                case 36:\n                    this.handleControlHomeKey();\n                    break;\n                case 37:\n                    this.handleControlLeftKey();\n                    break;\n                case 38:\n                    this.handleControlUpKey();\n                    break;\n                case 39:\n                    this.handleControlRightKey();\n                    break;\n                case 40:\n                    this.handleControlDownKey();\n                    break;\n                case 65:\n                    this.owner.selection.selectAll();\n                    break;\n                case 67:\n                    event.preventDefault();\n                    this.copy();\n                    break;\n                case 70:\n                    event.preventDefault();\n                    if (!isNullOrUndefined(this.owner.optionsPaneModule)) {\n                        this.owner.optionsPaneModule.showHideOptionsPane(true);\n                    }\n                    break;\n            }\n        }\n        else if (shift && !ctrl && !alt) {\n            switch (key) {\n                case 35:\n                    this.handleShiftEndKey();\n                    event.preventDefault();\n                    break;\n                case 36:\n                    this.handleShiftHomeKey();\n                    event.preventDefault();\n                    break;\n                case 37:\n                    this.handleShiftLeftKey();\n                    event.preventDefault();\n                    break;\n                case 38:\n                    this.handleShiftUpKey();\n                    event.preventDefault();\n                    break;\n                case 39:\n                    this.handleShiftRightKey();\n                    event.preventDefault();\n                    break;\n                case 40:\n                    this.handleShiftDownKey();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        else if (shift && ctrl && !alt) {\n            switch (key) {\n                case 35:\n                    this.handleControlShiftEndKey();\n                    break;\n                case 36:\n                    this.handleControlShiftHomeKey();\n                    break;\n                case 37:\n                    this.handleControlShiftLeftKey();\n                    break;\n                case 38:\n                    this.handleControlShiftUpKey();\n                    break;\n                case 39:\n                    this.handleControlShiftRightKey();\n                    break;\n                case 40:\n                    this.handleControlShiftDownKey();\n                    break;\n            }\n        }\n        else {\n            switch (key) {\n                // case 9:\n                //     event.preventDefault();\n                //     if (this.owner.acceptTab) {\n                //         this.handleTabKey(true, false);\n                //     }\n                //     break;             \n                case 33:\n                    event.preventDefault();\n                    this.viewer.viewerContainer.scrollTop -= this.viewer.visibleBounds.height;\n                    break;\n                case 34:\n                    event.preventDefault();\n                    this.viewer.viewerContainer.scrollTop += this.viewer.visibleBounds.height;\n                    break;\n                case 35:\n                    this.handleEndKey();\n                    event.preventDefault();\n                    break;\n                case 36:\n                    this.handleHomeKey();\n                    event.preventDefault();\n                    break;\n                case 37:\n                    this.handleLeftKey();\n                    event.preventDefault();\n                    break;\n                case 38:\n                    this.handleUpKey();\n                    event.preventDefault();\n                    break;\n                case 39:\n                    this.handleRightKey();\n                    event.preventDefault();\n                    break;\n                case 40:\n                    this.handleDownKey();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onKeyDownInternal(event, ctrl, shift, alt);\n        }\n        if (this.owner.searchModule) {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(this.owner.searchModule.searchHighlighters) && this.owner.searchModule.searchHighlighters.length > 0) {\n                this.owner.searchModule.searchResults.clear();\n            }\n        }\n        if (event.keyCode === 27 || event.which === 27) {\n            if (!isNullOrUndefined(this.owner.optionsPaneModule)) {\n                this.owner.optionsPaneModule.showHideOptionsPane(false);\n            }\n            if (this.owner.enableHeaderAndFooter) {\n                this.disableHeaderFooter();\n            }\n        }\n    };\n    //#region Enable or disable Header Footer\n    /**\n     * @private\n     */\n    Selection.prototype.checkAndEnableHeaderFooter = function (point, pagePoint) {\n        var page = this.viewer.currentPage;\n        if (this.isCursorInsidePageRect(point, page)) {\n            if (this.isCursorInHeaderRegion(point, page)) {\n                if (this.owner.enableHeaderAndFooter) {\n                    return false;\n                }\n                return this.enableHeadersFootersRegion(page.headerWidget);\n            }\n            if (this.isCursorInFooterRegion(point, page)) {\n                if (this.owner.enableHeaderAndFooter) {\n                    return false;\n                }\n                return this.enableHeadersFootersRegion(page.footerWidget);\n            }\n        }\n        if (this.owner.enableHeaderAndFooter) {\n            this.owner.enableHeaderAndFooter = false;\n            this.viewer.updateTextPositionForSelection(pagePoint, 1);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInsidePageRect = function (point, page) {\n        if ((this.viewer.containerLeft + point.x) >= page.boundingRectangle.x &&\n            (this.viewer.containerLeft + point.x) <= (page.boundingRectangle.x + (page.boundingRectangle.width * this.viewer.zoomFactor))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInHeaderRegion = function (point, page) {\n        var pageTop = this.getPageTop(page);\n        var headerHeight = 0;\n        if (page.headerWidget) {\n            headerHeight = (page.headerWidget.y + page.headerWidget.height);\n        }\n        var height = Math.max(headerHeight, HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin))\n            * this.viewer.zoomFactor;\n        if ((this.viewer.containerTop + point.y) >= pageTop && (this.viewer.containerTop + point.y) <= pageTop + height) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInFooterRegion = function (point, page) {\n        var pageRect = page.boundingRectangle;\n        var pageTop = this.getPageTop(page);\n        var pageBottom = pageTop + (pageRect.height * this.viewer.zoomFactor);\n        var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n        var footerHeight = 0;\n        if (page.footerWidget) {\n            footerHeight = page.footerWidget.height;\n        }\n        // tslint:disable-next-line:max-line-length\n        var height = (pageRect.height -\n            Math.max(footerHeight + footerDistance, HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.bottomMargin))) * this.viewer.zoomFactor;\n        if ((this.viewer.containerTop + point.y) <= pageBottom && (this.viewer.containerTop + point.y) >= pageTop + height) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.enableHeadersFootersRegion = function (widget) {\n        this.owner.enableHeaderAndFooter = true;\n        this.updateTextPositionForBlockContainer(widget);\n        return true;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.updateTextPositionForBlockContainer = function (widget) {\n        var block = widget.firstChild;\n        if (block instanceof TableWidget) {\n            block = this.getFirstBlockInFirstCell(block);\n        }\n        this.selectParagraph(block, true);\n    };\n    /**\n     * Disable Header footer\n     * @private\n     */\n    Selection.prototype.disableHeaderFooter = function () {\n        var page = this.getPage(this.start.paragraph);\n        this.updateTextPositionForBlockContainer(page.bodyWidgets[0]);\n        this.owner.enableHeaderAndFooter = false;\n    };\n    //#endregion\n    /**\n     * @private\n     */\n    Selection.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.contextTypeInternal)) {\n            this.contextTypeInternal = undefined;\n        }\n        this.caret = undefined;\n        this.contextTypeInternal = undefined;\n        this.upDownSelectionLength = undefined;\n        this.viewer = undefined;\n        this.owner = undefined;\n    };\n    /**\n     * Navigates to the specified bookmark.\n     * @param name\n     * @param moveToStart\n     * @private\n     */\n    Selection.prototype.navigateBookmark = function (name, moveToStart) {\n        var bookmarks = this.viewer.bookmarks;\n        if (bookmarks.containsKey(name)) {\n            //bookmark start element\n            var bookmrkElmnt = bookmarks.get(name);\n            var offset = bookmrkElmnt.line.getOffset(bookmrkElmnt, 1);\n            var startPosition = new TextPosition(this.viewer.owner);\n            startPosition.setPositionParagraph(bookmrkElmnt.line, offset);\n            if (moveToStart) {\n                this.viewer.selection.selectRange(startPosition, startPosition);\n            }\n            else {\n                //bookmark end element\n                var bookmrkEnd = bookmrkElmnt.reference;\n                var endoffset = bookmrkEnd.line.getOffset(bookmrkEnd, 0);\n                var endPosition = new TextPosition(this.viewer.owner);\n                endPosition.setPositionParagraph(bookmrkEnd.line, endoffset);\n                //selects the bookmark range\n                this.viewer.selection.selectRange(startPosition, endPosition);\n            }\n        }\n    };\n    /**\n     * Selects the specified bookmark.\n     * @param name\n     */\n    Selection.prototype.selectBookmark = function (name) {\n        this.navigateBookmark(name);\n    };\n    /**\n     * Returns the toc field from the selection.\n     * @private\n     */\n    Selection.prototype.getTocField = function () {\n        var paragraph = this.start.paragraph;\n        var tocPara = undefined;\n        while ((paragraph !== undefined && this.isTocStyle(paragraph))) {\n            tocPara = paragraph;\n            paragraph = paragraph.previousRenderedWidget;\n        }\n        if (tocPara !== undefined) {\n            var lineWidget = tocPara.childWidgets[0];\n            if (lineWidget !== undefined) {\n                return lineWidget.children[0];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Returns true if the paragraph has toc style.\n     */\n    Selection.prototype.isTocStyle = function (paragraph) {\n        var style = paragraph.paragraphFormat.baseStyle;\n        return (style !== undefined && (style.name.toLowerCase().indexOf('toc') !== -1));\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { Dictionary } from '../../base/dictionary';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextPosition } from '../selection/selection-helper';\nimport { TextElementBox, ParagraphWidget, ListTextElementBox, FieldElementBox } from '../viewer/page';\n/**\n * @private\n */\nvar TextSearch = /** @class */ (function () {\n    function TextSearch(owner) {\n        this.wordBefore = '\\\\b';\n        this.wordAfter = '\\\\b';\n        this.isHeader = false;\n        this.isFooter = false;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearch.prototype, \"viewer\", {\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearch.prototype.find = function (pattern, findOption) {\n        return this.findNext(pattern, findOption, '0;0;0');\n    };\n    // tslint:disable-next-line:max-line-length   \n    TextSearch.prototype.findNext = function (pattern, findOption, hierarchicalPosition) {\n        if (typeof pattern === 'string') {\n            pattern = this.stringToRegex(pattern, findOption);\n        }\n        if (hierarchicalPosition === undefined) {\n            hierarchicalPosition = '0;0;0';\n        }\n        this.owner.searchModule.textSearchResults.clearResults();\n        var results = this.owner.searchModule.textSearchResults;\n        this.findDocument(results, pattern, true, findOption, hierarchicalPosition);\n        return results.length > 0, results.currentSearchResult;\n    };\n    TextSearch.prototype.stringToRegex = function (textToFind, option) {\n        if (textToFind.indexOf('\\\\') > -1) {\n            textToFind = textToFind.split('\\\\').join('\\\\\\\\');\n        }\n        if (textToFind.indexOf('.') > -1) {\n            textToFind = '\\\\' + textToFind;\n        }\n        if (option === 'WholeWord' || option === 'CaseSensitiveWholeWord') {\n            textToFind = this.wordBefore + textToFind + this.wordAfter;\n        }\n        return new RegExp(textToFind, (option === 'CaseSensitive' || option === 'CaseSensitiveWholeWord') ? 'g' : 'ig');\n    };\n    TextSearch.prototype.isPatternEmpty = function (pattern) {\n        var wordEmpty = this.wordBefore + this.wordAfter;\n        var patternRegExp = pattern.toString();\n        return (patternRegExp.length === 0 || patternRegExp === wordEmpty);\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findAll = function (pattern, findOption, hierarchicalPosition) {\n        if (typeof pattern === 'string') {\n            pattern = this.stringToRegex(pattern, findOption);\n        }\n        if (hierarchicalPosition === undefined) {\n            hierarchicalPosition = '0;0;0';\n        }\n        this.owner.searchModule.textSearchResults.clearResults();\n        var results = this.owner.searchModule.textSearchResults;\n        this.findDocument(results, pattern, false, findOption, hierarchicalPosition);\n        if (results.length > 0 && results.currentIndex < 0) {\n            results.currentIndex = 0;\n        }\n        if (!isNullOrUndefined(results.currentSearchResult)) {\n            var eventArgs = { source: this.viewer.owner };\n            this.viewer.owner.trigger('searchResultsChange', eventArgs);\n            return results;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findDocument = function (results, pattern, isFirstMatch, findOption, hierachicalPosition) {\n        if (this.isPatternEmpty(pattern)) {\n            return;\n        }\n        if (findOption === undefined) {\n            findOption = 'None';\n        }\n        var inline = undefined;\n        var selectionEnd = undefined;\n        if (hierachicalPosition !== undefined) {\n            selectionEnd = this.owner.selection.end;\n        }\n        if (hierachicalPosition !== undefined && isFirstMatch && selectionEnd !== undefined && selectionEnd.paragraph !== undefined) {\n            if (selectionEnd.paragraph instanceof ParagraphWidget) {\n                var indexInInline = 0;\n                // tslint:disable-next-line:max-line-length \n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                var inlineElement = selectionEnd.currentWidget.getInline(this.owner.selection.start.offset, indexInInline);\n                inline = inlineElement.element;\n                indexInInline = inlineElement.index;\n                if (!isNullOrUndefined(inline)) {\n                    var nextParagraphWidget = undefined;\n                    // tslint:disable-next-line:max-line-length  \n                    nextParagraphWidget = this.findInline(inline, pattern, findOption, indexInInline, isFirstMatch, results, selectionEnd);\n                    while (results.length === 0 && !isNullOrUndefined(nextParagraphWidget)) {\n                        while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.childWidgets.length === 0) {\n                            // tslint:disable-next-line:max-line-length \n                            nextParagraphWidget = this.owner.selection.getNextParagraph(nextParagraphWidget.containerWidget);\n                        }\n                        if (isNullOrUndefined(nextParagraphWidget)) {\n                            break;\n                        }\n                        var lineWidget = nextParagraphWidget.childWidgets[0];\n                        if (lineWidget.children[0] instanceof ListTextElementBox) {\n                            inline = (lineWidget.children[2] instanceof TextElementBox) ? lineWidget.children[2] : undefined;\n                        }\n                        else {\n                            inline = lineWidget.children[0];\n                        }\n                        if (isNullOrUndefined(inline)) {\n                            break;\n                        }\n                        // tslint:disable-next-line:max-line-length  \n                        nextParagraphWidget = this.findInline(inline, pattern, findOption, 0, isFirstMatch, results, selectionEnd);\n                    }\n                    if (results.length > 0) {\n                        return;\n                    }\n                }\n            }\n        }\n        var section;\n        section = this.viewer.pages[0].bodyWidgets[0];\n        while (!isNullOrUndefined(section) && section.childWidgets.length === 0) {\n            section = section.nextWidget;\n        }\n        if (isNullOrUndefined(section) || section.childWidgets.length === 0) {\n            return;\n        }\n        this.isHeader = false;\n        this.isFooter = false;\n        this.findInlineText(section, pattern, findOption, isFirstMatch, results, selectionEnd);\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var headerWidget = this.viewer.pages[i].headerWidget;\n            if (!isNullOrUndefined(headerWidget)) {\n                this.isHeader = true;\n                this.isFooter = false;\n                this.findInlineText(headerWidget, pattern, findOption, isFirstMatch, results, selectionEnd);\n            }\n        }\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var footerWidget = this.viewer.pages[i].footerWidget;\n            if (!isNullOrUndefined(footerWidget)) {\n                this.isHeader = false;\n                this.isFooter = true;\n                this.findInlineText(footerWidget, pattern, findOption, isFirstMatch, results, selectionEnd);\n            }\n        }\n        if (isFirstMatch && !isNullOrUndefined(results) && results.length > 0) {\n            return;\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TextSearch.prototype.findInlineText = function (section, pattern, findOption, isFirstMatch, results, selectionEnd) {\n        var paragraphWidget = this.owner.selection.getFirstParagraphBlock(section.childWidgets[0]);\n        // tslint:disable-next-line:max-line-length \n        while (!isNullOrUndefined(paragraphWidget) && paragraphWidget.childWidgets.length === 1 && paragraphWidget.childWidgets[0].children.length === 0) {\n            paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n        }\n        while (!isNullOrUndefined(paragraphWidget) && paragraphWidget.childWidgets.length > 0) {\n            var inlineElement = paragraphWidget.childWidgets[0];\n            var inlineEle = inlineElement.children[0];\n            if (isNullOrUndefined(inlineEle)) {\n                break;\n            }\n            this.findInline(inlineEle, pattern, findOption, 0, isFirstMatch, results, selectionEnd);\n            paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n            // tslint:disable-next-line:max-line-length \n            while (!isNullOrUndefined(paragraphWidget) && (paragraphWidget.childWidgets.length === 1) && paragraphWidget.childWidgets[0].children.length === 0) {\n                paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n            }\n        }\n        if (isFirstMatch && !isNullOrUndefined(results) && results.length > 0) {\n            return;\n        }\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findInline = function (inlineElement, pattern, option, indexInInline, isFirstMatch, results, selectionEnd) {\n        var inlines = inlineElement;\n        var stringBuilder = '';\n        var spans = new Dictionary();\n        //tslint:disable no-constant-condition\n        do {\n            // tslint:disable-next-line:max-line-length \n            if (inlineElement instanceof TextElementBox && (!isNullOrUndefined(inlineElement.text) && inlineElement.text !== '')) {\n                spans.add(inlineElement, stringBuilder.length);\n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                if (inlineElement === inlines) {\n                    stringBuilder = stringBuilder + (inlineElement.text.substring(indexInInline));\n                }\n                else {\n                    stringBuilder = stringBuilder + (inlineElement.text);\n                }\n            }\n            else if (inlineElement instanceof FieldElementBox) {\n                var fieldBegin = inlineElement;\n                if (!isNullOrUndefined(fieldBegin.fieldEnd)) {\n                    // tslint:disable-next-line:max-line-length \n                    inlineElement = isNullOrUndefined(fieldBegin.fieldSeparator) ? fieldBegin.fieldEnd : fieldBegin.fieldSeparator;\n                }\n            }\n            if (!isNullOrUndefined(inlineElement) && isNullOrUndefined(inlineElement.nextNode)) {\n                break;\n            }\n            if (!isNullOrUndefined(inlineElement)) {\n                inlineElement = inlineElement.nextNode;\n            }\n        } while (true);\n        var text = stringBuilder.toString();\n        var matches = [];\n        var matchObject;\n        //tslint:disable no-conditional-assignment\n        while (!isNullOrUndefined(matchObject = pattern.exec(text))) {\n            matches.push(matchObject);\n        }\n        for (var i = 0; i < matches.length; i++) {\n            var match = matches[i];\n            var result = results.addResult();\n            var spanKeys = spans.keys;\n            for (var i_1 = 0; i_1 < spanKeys.length; i_1++) {\n                var span = spanKeys[i_1];\n                var startIndex = spans.get(span);\n                var spanLength = span.length;\n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                if (span === inlines) {\n                    spanLength -= indexInInline;\n                }\n                if (isNullOrUndefined(result.start) && match.index < startIndex + spanLength) {\n                    var index = match.index - startIndex;\n                    // IndexInInline Handled specifically for simple find operation to start from starting point\n                    if (span === inlines) {\n                        index += indexInInline;\n                    }\n                    var offset = (span.line).getOffset(span, index);\n                    result.start = this.getTextPosition(span.line, offset.toString());\n                    result.start.location = this.owner.selection.getPhysicalPositionInternal(span.line, offset, true);\n                    result.start.setPositionParagraph(span.line, offset);\n                }\n                if (match.index + match[0].length <= startIndex + spanLength) {\n                    var index = (match.index + match[0].length) - startIndex;\n                    // IndexInInline Handled specifically for simple find operation to start from starting point\n                    if (span === inlines) {\n                        index += indexInInline;\n                    }\n                    var offset = (span.line).getOffset(span, index);\n                    result.end = this.getTextPosition(span.line, offset.toString());\n                    result.end.location = this.owner.selection.getPhysicalPositionInternal(span.line, offset, true);\n                    result.end.setPositionParagraph(span.line, offset);\n                    break;\n                }\n            }\n            result.isHeader = this.isHeader;\n            result.isFooter = this.isFooter;\n            if (isFirstMatch) {\n                results.currentIndex = 0;\n                return undefined;\n            }\n            else if (results.currentIndex < 0 && selectionEnd.isExistBefore(result.start)) {\n                results.currentIndex = results.indexOf(result);\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        var paragraphWidget = this.owner.selection.getNextParagraphBlock(inlineElement.line.paragraph);\n        return paragraphWidget;\n    };\n    TextSearch.prototype.getTextPosition = function (lineWidget, hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        var index = textPosition.getHierarchicalIndex(lineWidget, hierarchicalIndex);\n        textPosition.setPositionForCurrentIndex(index);\n        return textPosition;\n    };\n    return TextSearch;\n}());\nexport { TextSearch };\n/**\n * @private\n */\nvar SearchWidgetInfo = /** @class */ (function () {\n    function SearchWidgetInfo(left, width) {\n        this.leftInternal = 0;\n        this.widthInternal = 0;\n        this.leftInternal = left;\n        this.widthInternal = width;\n    }\n    Object.defineProperty(SearchWidgetInfo.prototype, \"left\", {\n        get: function () {\n            return this.leftInternal;\n        },\n        set: function (value) {\n            this.leftInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SearchWidgetInfo.prototype, \"width\", {\n        get: function () {\n            return this.widthInternal;\n        },\n        set: function (value) {\n            this.widthInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SearchWidgetInfo;\n}());\nexport { SearchWidgetInfo };\n","/**\n * @private\n */\nvar TextSearchResult = /** @class */ (function () {\n    function TextSearchResult(owner) {\n        this.startIn = undefined;\n        this.endIn = undefined;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearchResult.prototype, \"viewer\", {\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"start\", {\n        get: function () {\n            return this.startIn;\n        },\n        set: function (value) {\n            this.startIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"end\", {\n        get: function () {\n            return this.endIn;\n        },\n        set: function (value) {\n            this.endIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"text\", {\n        get: function () {\n            return this.viewer.selection.getTextInternal(this.start, this.end, false);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearchResult.prototype.destroy = function () {\n        this.start = undefined;\n        this.end = undefined;\n    };\n    return TextSearchResult;\n}());\nexport { TextSearchResult };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextSearchResult } from './text-search-result';\n/**\n * @private\n */\nvar TextSearchResults = /** @class */ (function () {\n    function TextSearchResults(owner) {\n        this.currentIndex = -1;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearchResults.prototype, \"length\", {\n        get: function () {\n            if (this.innerList === undefined) {\n                return 0;\n            }\n            return this.innerList.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResults.prototype, \"currentSearchResult\", {\n        get: function () {\n            if (this.innerList === undefined || this.currentIndex < 0 || this.currentIndex >= this.length) {\n                return undefined;\n            }\n            return this.innerList[this.currentIndex];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearchResults.prototype.addResult = function () {\n        var textSearchResult = new TextSearchResult(this.owner);\n        if (isNullOrUndefined(this.innerList)) {\n            this.innerList = [];\n        }\n        this.innerList.push(textSearchResult);\n        return textSearchResult;\n    };\n    TextSearchResults.prototype.clearResults = function () {\n        this.currentIndex = -1;\n        if (!isNullOrUndefined(this.innerList)) {\n            for (var i = this.innerList.length - 1; i >= 0; i--) {\n                this.innerList[i].destroy();\n                this.innerList.splice(i, 1);\n            }\n        }\n    };\n    TextSearchResults.prototype.indexOf = function (result) {\n        if (isNullOrUndefined(this.innerList)) {\n            return -1;\n        }\n        return this.innerList.indexOf(result);\n    };\n    TextSearchResults.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.innerList)) {\n            this.clearResults();\n        }\n        this.innerList = undefined;\n    };\n    return TextSearchResults;\n}());\nexport { TextSearchResults };\n","/**\n * Search Result info\n */\nvar SearchResults = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SearchResults(search) {\n        this.searchModule = search;\n    }\n    Object.defineProperty(SearchResults.prototype, \"length\", {\n        /**\n         * Gets the length of search results.\n         */\n        get: function () {\n            return this.searchModule.textSearchResults.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SearchResults.prototype, \"index\", {\n        /**\n         * Gets the index of current search result.\n         */\n        get: function () {\n            return this.searchModule.textSearchResults.currentIndex;\n        },\n        /**\n         * Set the index of current search result.\n         */\n        set: function (value) {\n            if (this.length === 0 || value < 0 || value > this.searchModule.textSearchResults.length - 1) {\n                return;\n            }\n            this.searchModule.textSearchResults.currentIndex = value;\n            this.navigate(value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Replace text in current search result.\n     * @param textToReplace text to replace\n     * @private\n     */\n    SearchResults.prototype.replace = function (textToReplace) {\n        if (this.index === -1) {\n            return;\n        }\n        this.searchModule.replaceInternal(textToReplace);\n    };\n    /**\n     * Replace all the instance of search result.\n     * @param textToReplace text to replace\n     */\n    SearchResults.prototype.replaceAll = function (textToReplace) {\n        if (this.index === -1) {\n            return;\n        }\n        this.searchModule.replaceAllInternal(textToReplace);\n    };\n    /**\n     * @private\n     */\n    SearchResults.prototype.navigate = function (index) {\n        this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult);\n        this.searchModule.highlight(this.searchModule.textSearchResults);\n    };\n    /**\n     * Clears all the instance of search result.\n     */\n    SearchResults.prototype.clear = function () {\n        this.searchModule.textSearchResults.clearResults();\n        this.searchModule.clearSearchHighlight();\n        this.searchModule.viewer.renderVisiblePages();\n    };\n    return SearchResults;\n}());\nexport { SearchResults };\n","import { Dictionary } from '../../base/dictionary';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextPosition } from '../selection/selection-helper';\nimport { TextElementBox, FieldElementBox } from '../viewer/page';\nimport { SearchWidgetInfo } from './text-search';\nimport { TextSearch } from '../search/text-search';\nimport { TextSearchResults } from '../search/text-search-results';\nimport { SearchResults } from './search-results';\n/**\n * Search module\n */\nvar Search = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function Search(owner) {\n        /**\n         * @private\n         */\n        this.searchHighlighters = undefined;\n        this.isHandledOddPageHeader = undefined;\n        this.isHandledEvenPageHeader = undefined;\n        this.isHandledOddPageFooter = undefined;\n        this.isHandledEvenPageFooter = undefined;\n        this.owner = owner;\n        this.searchHighlighters = new Dictionary();\n        this.textSearch = new TextSearch(this.owner);\n        this.textSearchResults = new TextSearchResults(this.owner);\n        this.searchResultsInternal = new SearchResults(this);\n    }\n    Object.defineProperty(Search.prototype, \"viewer\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Search.prototype, \"searchResults\", {\n        /**\n         * Gets the search results object.\n         */\n        get: function () {\n            return this.searchResultsInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Get the module name.\n     */\n    Search.prototype.getModuleName = function () {\n        return 'Search';\n    };\n    //#region Find & Find All\n    /**\n     * Finds the immediate occurrence of specified text from cursor position in the document.\n     * @param  {string} text\n     * @param  {FindOption} findOption? - Default value of ‘findOptions’ parameter is 'None'.\n     * @private\n     */\n    Search.prototype.find = function (text, findOptions) {\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var result = this.textSearch.find(text, findOptions);\n        if (!isNullOrUndefined(result)) {\n            this.navigate(result);\n        }\n    };\n    /**\n     * Finds all occurrence of specified text in the document.\n     * @param  {string} text\n     * @param  {FindOption} findOption? - Default value of ‘findOptions’ parameter is 'None'.\n     */\n    Search.prototype.findAll = function (text, findOptions) {\n        if (isNullOrUndefined(text || text === '')) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var results = this.textSearch.findAll(text, findOptions);\n        if (!isNullOrUndefined(results) && results.length > 0) {\n            this.navigate(results.innerList[results.currentIndex]);\n            this.highlight(results);\n        }\n    };\n    //#endregion\n    //#region Replace and Replace All   \n    /**\n     * Replace the searched string with specified string\n     * @param  {string} replaceText\n     * @param  {TextSearchResult} result\n     * @param  {TextSearchResults} results\n     * @private\n     */\n    Search.prototype.replace = function (replaceText, result, results) {\n        if (isNullOrUndefined(this.viewer.owner) || this.viewer.owner.isReadOnlyMode || isNullOrUndefined(results)) {\n            return 0;\n        }\n        if (!isNullOrUndefined(this.viewer)) {\n            this.clearSearchHighlight();\n        }\n        this.navigate(result);\n        var endPosition = this.viewer.selection.start;\n        var index = results.indexOf(result);\n        if (index < 0) {\n            return 0;\n        }\n        this.owner.editorModule.insertText(replaceText, true);\n        var endTextPosition = result.end;\n        var startPosition = new TextPosition(this.viewer.owner);\n        startPosition.setPositionParagraph(endTextPosition.currentWidget, endPosition.offset - replaceText.length);\n        this.viewer.selection.selectRange(endPosition, startPosition);\n        var eventArgs = { source: this.viewer.owner };\n        this.viewer.owner.trigger('searchResultsChange', eventArgs);\n        return 1;\n    };\n    /**\n     * Find the textToFind string in current document and replace the specified string.\n     * @param  {string} textToFind\n     * @param  {string} textToReplace\n     * @param  {FindOption} findOptions? - Default value of ‘findOptions’ parameter is FindOption.None.\n     * @private\n     */\n    Search.prototype.replaceInternal = function (textToReplace, findOptions) {\n        if ((textToReplace === '' || isNullOrUndefined(textToReplace))) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var textToFind = this.textSearchResults.currentSearchResult.text;\n        var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(textToFind, findOptions);\n        var index = this.owner.selection.end.getHierarchicalIndexInternal();\n        var result = this.viewer.owner.searchModule.textSearch.findNext(pattern, findOptions, index);\n        if (!isNullOrUndefined(result)) {\n            this.navigate(result);\n            this.textSearchResults.addResult();\n            this.textSearchResults.innerList[0] = result;\n            this.replace(textToReplace, result, this.textSearchResults);\n            index = this.owner.selection.end.getHierarchicalIndexInternal();\n            result = this.textSearch.findNext(textToFind, findOptions, index);\n            if (result) {\n                this.textSearchResults.addResult();\n                this.textSearchResults.innerList[0] = result;\n                this.navigate(result);\n            }\n        }\n    };\n    /**\n     * Replace all the searched string with specified string\n     * @param  {string} replaceText\n     * @param  {TextSearchResults} results\n     * @private\n     */\n    Search.prototype.replaceAll = function (replaceText, results) {\n        if (isNullOrUndefined(this.viewer.owner) || this.viewer.owner.isReadOnlyMode || isNullOrUndefined(results)) {\n            return 0;\n        }\n        if (this.owner.editorHistory) {\n            this.owner.editorHistory.initComplexHistory(this.owner.selection, 'ReplaceAll');\n        }\n        var count = results.length;\n        this.viewer.owner.isLayoutEnabled = false;\n        for (var i = count - 1; i >= 0; i--) {\n            var result = results.innerList[i];\n            this.navigate(results.innerList[i]);\n            this.owner.editorModule.insertText(replaceText, true);\n            if (result.isHeader || result.isFooter) {\n                this.viewer.layout.updateHeaderFooterToParent(this.viewer.selection.start.paragraph.bodyWidget);\n            }\n            results.innerList[i].destroy();\n        }\n        if (this.owner.editorHistory && !isNullOrUndefined(this.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.owner.editorModule.updateComplexWithoutHistory(2);\n        }\n        this.searchResults.clear();\n        return count;\n    };\n    /**\n     * Find the textToFind string in current document and replace the specified string.\n     * @param  {string} textToFind\n     * @param  {string} textToReplace\n     * @param  {FindOption} findOptions? - Default value of ‘findOptions’ parameter is FindOption.None.\n     * @private\n     */\n    Search.prototype.replaceAllInternal = function (textToReplace, findOptions) {\n        if ((textToReplace === '' || isNullOrUndefined(textToReplace))) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        if (this.textSearchResults.length > 0) {\n            this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]);\n            this.highlight(this.textSearchResults);\n            this.replaceAll(textToReplace, this.textSearchResults);\n        }\n    };\n    //#endregion\n    //#region Highlight Search Result\n    /**\n     * @private\n     */\n    Search.prototype.navigate = function (textSearchResult) {\n        if (textSearchResult) {\n            var start = textSearchResult.start;\n            var end = textSearchResult.end;\n            if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.owner.selection) && !isNullOrUndefined(start) &&\n                !isNullOrUndefined(end) && !isNullOrUndefined(start.paragraph) && !isNullOrUndefined(end.paragraph)) {\n                this.owner.selection.selectRange(start, end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Search.prototype.highlight = function (textSearchResults) {\n        this.searchHighlighters = new Dictionary();\n        for (var i = 0; i < textSearchResults.innerList.length; i++) {\n            var result = textSearchResults.innerList[i];\n            this.highlightResult(result);\n        }\n        this.viewer.renderVisiblePages();\n    };\n    /**\n     * @private\n     */\n    Search.prototype.highlightResult = function (result) {\n        this.highlightSearchResult(result.start.paragraph, result.start, result.end);\n    };\n    /**\n     * Highlight search result\n     * @private\n     */\n    Search.prototype.highlightSearchResult = function (paragraph, start, end) {\n        var selectionStartIndex = 0;\n        var selectionEndIndex = 0;\n        var startElement = null;\n        var endElement = null;\n        // tslint:disable-next-line:max-line-length\n        var lineWidget = this.viewer.selection.getStartLineWidget(paragraph, start, startElement, selectionStartIndex);\n        selectionStartIndex = lineWidget.index;\n        startElement = lineWidget.element;\n        var startLineWidget = startElement ? startElement.line : paragraph.childWidgets[0];\n        var endLine = this.viewer.selection.getEndLineWidget(end, endElement, selectionEndIndex);\n        selectionEndIndex = endLine.index;\n        endElement = endLine.element;\n        var endLineWidget = endElement ? endElement.line :\n            end.paragraph.childWidgets[end.paragraph.childWidgets.length - 1];\n        var top = this.viewer.selection.getTop(startLineWidget);\n        var left = this.viewer.selection.getLeftInternal(startLineWidget, startElement, selectionStartIndex);\n        if (!isNullOrUndefined(startLineWidget) && startLineWidget === endLineWidget) {\n            //find result ends in current line.\n            var right = this.viewer.selection.getLeftInternal(endLineWidget, endElement, selectionEndIndex);\n            this.createHighlightBorder(startLineWidget, right - left, left, top);\n        }\n        else {\n            if (!isNullOrUndefined(startLineWidget)) {\n                if (paragraph !== startLineWidget.paragraph) {\n                    paragraph = startLineWidget.paragraph;\n                }\n                // tslint:disable-next-line:max-line-length\n                this.createHighlightBorder(startLineWidget, this.viewer.selection.getWidth(startLineWidget, true) - (left - startLineWidget.paragraph.x), left, top);\n                var lineIndex = startLineWidget.paragraph.childWidgets.indexOf(startLineWidget);\n                //Iterates to last item of paragraph or search result end.\n                var startParagraphWidget = void 0;\n                for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                    if (paragraph === startLineWidget.paragraph) {\n                        lineIndex += 1;\n                    }\n                    this.highlightSearchResultParaWidget(paragraph, lineIndex, endLineWidget, endElement, selectionEndIndex);\n                    if (paragraph === endLineWidget.paragraph) {\n                        return;\n                    }\n                    else {\n                        lineIndex = 0;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Search.prototype.createHighlightBorder = function (lineWidget, width, left, top) {\n        var findHighLight = this.addSearchHighlightBorder(lineWidget);\n        var page = this.viewer.owner.selection.getPage(lineWidget.paragraph);\n        var pageTop = page.boundingRectangle.y;\n        var pageLeft = page.boundingRectangle.x;\n        findHighLight.left = Math.ceil(left);\n        top = Math.ceil(top);\n        findHighLight.width = Math.floor(width);\n        var height = Math.floor(lineWidget.height);\n        var context = this.viewer.containerContext;\n    };\n    /**\n     * Adds search highlight border.\n     * @private\n     */\n    Search.prototype.addSearchHighlightBorder = function (lineWidget) {\n        var highlighters = undefined;\n        if (this.searchHighlighters.containsKey(lineWidget)) {\n            highlighters = this.searchHighlighters.get(lineWidget);\n        }\n        else {\n            highlighters = [];\n            this.searchHighlighters.add(lineWidget, highlighters);\n        }\n        var searchHighlight = new SearchWidgetInfo(0, 0);\n        highlighters.push(searchHighlight);\n        return searchHighlight;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Search.prototype.highlightSearchResultParaWidget = function (widget, startIndex, endLine, endElement, endIndex) {\n        var top = 0;\n        for (var j = startIndex; j < widget.childWidgets.length; j++) {\n            var lineWidget = widget.childWidgets[j];\n            if (j === startIndex) {\n                top = this.viewer.selection.getTop(lineWidget);\n            }\n            var left = this.viewer.selection.getLeft(lineWidget);\n            if (lineWidget === endLine) {\n                //Search result ends in current line.\n                var right = this.viewer.selection.getLeftInternal(endLine, endElement, endIndex);\n                this.createHighlightBorder(lineWidget, right - left, left, top);\n                return;\n            }\n            this.createHighlightBorder(lineWidget, this.viewer.selection.getWidth(lineWidget, true) - (left - widget.x), left, top);\n            top += lineWidget.height;\n        }\n    };\n    //#endregion\n    //#region Get find result view\n    /**\n     * @private\n     */\n    Search.prototype.addSearchResultItems = function (result) {\n        if (isNullOrUndefined(result) || result === '') {\n            return;\n        }\n        if (isNullOrUndefined(this.owner.findResultsList)) {\n            this.owner.findResultsList = [];\n        }\n        this.owner.findResultsList.push(result);\n    };\n    /**\n     * @private\n     */\n    Search.prototype.addFindResultView = function (textSearchResults) {\n        for (var i = 0; i < textSearchResults.innerList.length; i++) {\n            var result = textSearchResults.innerList[i];\n            this.addFindResultViewForSearch(result);\n        }\n        this.isHandledOddPageHeader = true;\n        this.isHandledOddPageFooter = true;\n        this.isHandledEvenPageHeader = true;\n        this.isHandledEvenPageFooter = true;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Search.prototype.addFindResultViewForSearch = function (result) {\n        if (result.start != null && result.end != null && result.start.paragraph != null && result.end.paragraph != null) {\n            var prefixText = void 0;\n            var suffixtext = void 0;\n            var currentText = void 0;\n            var startIndex = 0;\n            var inlineObj = result.start.currentWidget.getInline(result.start.offset, startIndex);\n            var inline = inlineObj.element;\n            startIndex = inlineObj.index;\n            var prefix = '';\n            var lastIndex = 0;\n            if (inline instanceof FieldElementBox) {\n                var elementInfo = this.owner.selection.getRenderedInline(inline, startIndex);\n                if (elementInfo.element.nextNode instanceof TextElementBox) {\n                    inline = elementInfo.element.nextNode;\n                    startIndex = elementInfo.index;\n                }\n                else {\n                    inline = elementInfo.element;\n                    startIndex = elementInfo.index;\n                }\n            }\n            var boxObj = this.owner.selection.getElementBoxInternal(inline, startIndex);\n            var box = boxObj.element;\n            startIndex = boxObj.index;\n            if (box != null) {\n                if (box instanceof TextElementBox && startIndex > 0) {\n                    prefix = box.text.substring(0, startIndex);\n                }\n                var boxIndex = box.line.children.indexOf(box);\n                // tslint:disable-next-line:max-line-length\n                lastIndex = prefix.lastIndexOf(' ');\n                while (lastIndex < 0 && boxIndex > 0 && box.line.children[boxIndex - 1] instanceof TextElementBox) {\n                    prefix = box.line.children[boxIndex - 1].text + prefix;\n                    boxIndex--;\n                    lastIndex = prefix.lastIndexOf(' ');\n                }\n            }\n            var shiftIndex = prefix.lastIndexOf('\\v');\n            if (shiftIndex > 0) {\n                prefix = prefix.substring(0, shiftIndex);\n            }\n            else {\n                lastIndex = prefix.lastIndexOf(' ');\n                prefixText = lastIndex < 0 ? prefix : prefix.substring(lastIndex + 1);\n            }\n            currentText = result.text;\n            var endIndex = 0;\n            var endInlineObj = result.end.currentWidget.getInline(result.end.offset, endIndex);\n            var endInline = endInlineObj.element;\n            endIndex = endInlineObj.index;\n            suffixtext = '';\n            //Checks prefix element box is empty\n            if (boxObj != null) {\n                // Gets the element box using endIndex of the text and set as suffix\n                boxObj = this.owner.selection.getElementBoxInternal(endInline, endIndex);\n                box = boxObj.element;\n                endIndex = boxObj.index;\n            }\n            //Checks suffix element box is empty.\n            if (box != null) {\n                if (box instanceof TextElementBox && endIndex < box.length) {\n                    suffixtext = box.text.substring(endIndex);\n                }\n                var boxIndex = box.line.children.indexOf(box);\n                // tslint:disable-next-line:max-line-length\n                while (boxIndex + 1 < box.line.children.length && (box.line.children[boxIndex + 1] instanceof TextElementBox) || (box.line.children[boxIndex + 1] instanceof FieldElementBox)) {\n                    if (box.line.children[boxIndex + 1] instanceof FieldElementBox) {\n                        boxIndex = boxIndex + 2;\n                    }\n                    else {\n                        suffixtext = suffixtext + box.line.children[boxIndex + 1].text;\n                        boxIndex = boxIndex + 1;\n                    }\n                }\n            }\n            lastIndex = suffixtext.lastIndexOf(' ');\n            suffixtext = suffixtext === '\\v' ? suffixtext = '' : suffixtext;\n            var headerFooterString = '';\n            if (result.isHeader) {\n                headerFooterString = '<span class=\"e-de-header-footer-list\">' + 'Header' + ': ' + '</span>';\n            }\n            else if (result.isFooter) {\n                headerFooterString = '<span class=\"e-de-header-footer-list\">' + 'Footer' + ': ' + '</span>';\n            }\n            else {\n                headerFooterString = '';\n                headerFooterString = '';\n                this.isHandledOddPageHeader = true;\n                this.isHandledEvenPageHeader = true;\n                this.isHandledOddPageFooter = true;\n                this.isHandledEvenPageFooter = true;\n            }\n            var listElement = '';\n            var page = result.viewer.selection.getPage(result.start.paragraph);\n            if (isNullOrUndefined(this.isHandledEvenPageHeader) && isNullOrUndefined(this.isHandledEvenPageFooter)) {\n                this.isHandledEvenPageHeader = true;\n                this.isHandledEvenPageFooter = true;\n            }\n            else if (isNullOrUndefined(this.isHandledOddPageHeader) && isNullOrUndefined(this.isHandledOddPageFooter)) {\n                this.isHandledOddPageHeader = true;\n                this.isHandledOddPageFooter = true;\n            }\n            if (result.isHeader) {\n                if (page.headerWidget.headerFooterType === 'FirstPageHeader' && page.bodyWidgets[0].sectionFormat.differentFirstPage) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                }\n                else if (page.headerWidget.headerFooterType === 'EvenHeader' && this.isHandledEvenPageHeader) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledEvenPageHeader = false;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (page.headerWidget.headerFooterType === 'OddHeader' && this.isHandledOddPageHeader) {\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledOddPageHeader = false;\n                }\n            }\n            else if (result.isFooter) {\n                if (page.footerWidget.headerFooterType === 'FirstPageFooter' && page.bodyWidgets[0].sectionFormat.differentFirstPage) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                }\n                else if (page.footerWidget.headerFooterType === 'EvenFooter' && this.isHandledEvenPageFooter) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledEvenPageFooter = false;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (page.footerWidget.headerFooterType === 'OddFooter' && this.isHandledOddPageFooter) {\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledOddPageFooter = false;\n                }\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (!result.isHeader && !result.isFooter) {\n                listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n            }\n            this.addSearchResultItems(listElement);\n        }\n    };\n    //#endregion\n    /**\n     * Clears search highlight.\n     * @private\n     */\n    Search.prototype.clearSearchHighlight = function () {\n        if (!isNullOrUndefined(this.searchHighlighters)) {\n            this.searchHighlighters.clear();\n            this.searchHighlighters = undefined;\n        }\n        var eventArgs = { source: this.viewer.owner };\n        this.viewer.owner.trigger('searchResultsChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    Search.prototype.destroy = function () {\n        if (this.textSearchResults) {\n            this.textSearchResults.destroy();\n        }\n    };\n    return Search;\n}());\nexport { Search };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { Tab } from '@syncfusion/ej2-navigations';\n/**\n * Options Pane class.\n */\nvar OptionsPane = /** @class */ (function () {\n    /**\n     * Constructor for Options pane module\n     * @param {LayoutViewer} layoutViewer\n     * @private\n     */\n    function OptionsPane(layoutViewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.isOptionsPaneShow = false;\n        this.findOption = 'None';\n        this.matchCase = undefined;\n        this.wholeWord = undefined;\n        // private regular: CheckBox = undefined;\n        this.searchText = 'Navigation';\n        this.resultsText = 'Results';\n        this.messageDivText = 'No matches';\n        this.replaceButtonText = 'Replace';\n        this.replaceAllButtonText = 'Replace All';\n        this.focusedIndex = -1;\n        this.focusedElement = [];\n        this.isOptionsPane = true;\n        this.replacePaneText = 'Replace';\n        this.findPaneText = 'Find';\n        this.matchDivReplaceText = 'No matches';\n        /**\n         * @private\n         */\n        this.tabInstance = undefined;\n        /**\n         * @private\n         */\n        this.isReplace = false;\n        /**\n         * Gets selected tab item which tab is selected.\n         * @param {SelectEventArgs} args - Specifies which tab will be opened.\n         * @private\n         */\n        this.selectedTabItem = function (args) {\n            if (args.previousIndex !== args.selectedIndex) {\n                var previousTab = document.querySelector('#e-content_' + args.previousIndex);\n                var nextTab = document.querySelector('#e-content_' + args.selectedIndex);\n                nextTab.insertBefore(previousTab.firstElementChild, nextTab.firstChild);\n            }\n            if (args.selectedIndex === 0 && !isNullOrUndefined(document.querySelector('#e-content_' + args.selectedIndex))) {\n                _this.isOptionsPane = true;\n                _this.onFindPane();\n            }\n            if (args.selectedIndex === 1 && !isNullOrUndefined(document.querySelector('#e-content_' + args.selectedIndex))) {\n                _this.isOptionsPane = false;\n                _this.onReplacePane();\n            }\n        };\n        this.searchOptionChange = function () {\n            _this.clearSearchResultItems();\n            _this.viewer.owner.searchModule.clearSearchHighlight();\n            var inputText = _this.searchInput.value;\n            if (inputText === '') {\n                return;\n            }\n            var pattern = _this.viewer.owner.searchModule.textSearch.stringToRegex(inputText, _this.findOption);\n            var endSelection = _this.viewer.selection.end;\n            var selectionIndex = endSelection.getHierarchicalIndexInternal();\n            _this.results = _this.viewer.owner.searchModule.textSearch.findAll(pattern, _this.findOption, selectionIndex);\n            if (_this.results != null && _this.results.length > 0) {\n                _this.navigateSearchResult();\n            }\n            else {\n                _this.viewer.renderVisiblePages();\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n            }\n        };\n        /**\n         * Apply find option based on whole words value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        this.wholeWordsChange = function (args) {\n            if (_this.matchInput.checked && _this.wholeInput.checked) {\n                _this.findOption = 'CaseSensitiveWholeWord';\n            }\n            else if (_this.matchInput.checked && !(_this.wholeInput.checked)) {\n                _this.findOption = 'CaseSensitive';\n            }\n            else if (!(_this.matchInput.checked) && _this.wholeInput.checked) {\n                _this.findOption = 'WholeWord';\n            }\n            else {\n                _this.findOption = 'None';\n            }\n            _this.searchOptionChange();\n        };\n        /**\n         * Apply find option based on match value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        this.matchChange = function (args) {\n            if (_this.matchInput.checked && _this.wholeInput.checked) {\n                _this.findOption = 'CaseSensitiveWholeWord';\n            }\n            else if (!(_this.matchInput.checked) && _this.wholeInput.checked) {\n                _this.findOption = 'WholeWord';\n            }\n            else if (_this.matchInput.checked && !(_this.wholeInput.checked)) {\n                _this.findOption = 'CaseSensitive';\n            }\n            else {\n                _this.findOption = 'None';\n            }\n            _this.searchOptionChange();\n        };\n        /**\n         * Apply find options based on regular value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        // public regularChange = (args: ChangeEventArgs): void => {\n        //     if (args.checked) {\n        //         this.matchCase.element.parentElement.parentElement.classList.add('e-checkbox-disabled');\n        //         this.wholeWord.element.parentElement.parentElement.classList.add('e-checkbox-disabled');\n        //         this.matchCase.checked = false;\n        //         this.wholeWord.checked = false;\n        //         this.findOption = 'None';\n        //         this.onKeyDownInternal();\n        //     } else {\n        //         this.matchCase.element.parentElement.parentElement.classList.remove('e-checkbox-disabled');\n        //         this.wholeWord.element.parentElement.parentElement.classList.remove('e-checkbox-disabled');\n        //     }\n        // }\n        // tslint:enable:no-any \n        /**\n         * Binding events from the element when optins pane creation.\n         * @private\n         */\n        this.onWireEvents = function () {\n            _this.searchIcon.addEventListener('click', _this.searchIconClickInternal);\n            _this.navigateToNextResult.addEventListener('click', _this.navigateNextResultButtonClick);\n            _this.navigateToPreviousResult.addEventListener('click', _this.navigatePreviousResultButtonClick);\n            _this.searchInput.addEventListener('keydown', _this.onKeyDown);\n            _this.searchInput.addEventListener('keyup', _this.onEnableDisableReplaceButton);\n            _this.resultsListBlock.addEventListener('click', _this.resultListBlockClick);\n            _this.closeButton.addEventListener('click', _this.close);\n            _this.replaceButton.addEventListener('click', _this.onReplaceButtonClick);\n            _this.replaceAllButton.addEventListener('click', _this.onReplaceAllButtonClick);\n        };\n        /**\n         * Enable find pane only.\n         * @private\n         */\n        this.onFindPane = function () {\n            _this.replaceDiv.style.display = 'none';\n            _this.occurrenceDiv.style.display = 'none';\n            if (!isNullOrUndefined(_this.results) && _this.results.length === 0) {\n                _this.resultsListBlock.innerHTML = '';\n                _this.resultsListBlock.style.display = 'none';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n            }\n            _this.resultsListBlock.style.height = _this.resultsListBlock.offsetHeight + _this.replaceTabContentDiv.offsetHeight + 'px';\n            _this.replaceTabContentDiv.style.display = 'none';\n            _this.findDiv.style.display = 'block';\n            _this.messageDiv.style.display = 'block';\n            _this.focusedElement = [];\n            // tslint:disable-next-line:max-line-length\n            _this.focusedElement.push(_this.closeButton, _this.findTabButtonHeader, _this.replaceTabButtonHeader, _this.searchInput, _this.searchIcon, _this.navigateToPreviousResult, _this.navigateToNextResult, _this.matchInput, _this.wholeInput);\n            _this.focusedIndex = 3;\n            _this.searchInput.select();\n            _this.getMessageDivHeight();\n        };\n        this.onEnableDisableReplaceButton = function () {\n            if (_this.searchInput.value.length !== 0) {\n                _this.replaceButton.disabled = false;\n                _this.replaceAllButton.disabled = false;\n            }\n            else {\n                _this.replaceButton.disabled = true;\n                _this.replaceAllButton.disabled = true;\n            }\n        };\n        /**\n         * Enable replace pane only.\n         * @private\n         */\n        this.onReplacePane = function () {\n            _this.findDiv.style.display = 'block';\n            _this.replaceDiv.style.display = 'block';\n            _this.replaceTabContentDiv.style.display = 'block';\n            _this.resultsListBlock.style.height = _this.resultsListBlock.offsetHeight - _this.replaceTabContentDiv.offsetHeight + 'px';\n            _this.isOptionsPane = false;\n            if (_this.searchInput.value.length !== 0) {\n                _this.replaceButton.disabled = false;\n                _this.replaceAllButton.disabled = false;\n            }\n            else {\n                _this.replaceButton.disabled = true;\n                _this.replaceAllButton.disabled = true;\n            }\n            _this.focusedElement = [];\n            // tslint:disable-next-line:max-line-length\n            _this.focusedElement.push(_this.closeButton, _this.findTabButtonHeader, _this.replaceTabButtonHeader, _this.searchInput, _this.searchIcon, _this.navigateToPreviousResult, _this.navigateToNextResult, _this.matchInput, _this.wholeInput, _this.replaceWith, _this.replaceButton, _this.replaceAllButton);\n            _this.focusedIndex = 9;\n            if (_this.searchInput.value === '') {\n                _this.searchInput.select();\n            }\n            else {\n                _this.replaceWith.select();\n            }\n            _this.getMessageDivHeight();\n        };\n        /**\n         * Fires on key down on options pane.\n         * @param {KeyboardEvent} event - Specifies the focus of current element.\n         * @private\n         */\n        this.onKeyDownOnOptionPane = function (event) {\n            // if (event.keyCode === 70) {\n            //     event.preventDefault();\n            //     return;\n            // }\n            if (event.keyCode === 9) {\n                event.preventDefault();\n                var focusIndex = undefined;\n                if (event.shiftKey) {\n                    focusIndex = (_this.focusedIndex === 0 || isNullOrUndefined(_this.focusedIndex)) ?\n                        _this.focusedElement.length - 1 : _this.focusedIndex - 1;\n                }\n                else {\n                    focusIndex = (_this.focusedElement.length - 1 === _this.focusedIndex || isNullOrUndefined(_this.focusedIndex)) ?\n                        0 : _this.focusedIndex + 1;\n                }\n                var element = _this.focusedElement[focusIndex];\n                element.focus();\n                if (element instanceof HTMLInputElement) {\n                    element.select();\n                }\n                _this.focusedIndex = focusIndex;\n                if (element instanceof HTMLLIElement) {\n                    _this.scrollToPosition(element);\n                }\n            }\n            else if (event.keyCode === 13) {\n                // tslint:disable-next-line:max-line-length\n                if (event.target !== _this.searchInput && event.target !== _this.closeButton) {\n                    event.preventDefault();\n                    var index = _this.focusedElement.indexOf(event.target);\n                    if (index !== -1) {\n                        var list = _this.focusedElement[index];\n                        list.click();\n                        list.focus();\n                        _this.focusedIndex = index;\n                    }\n                }\n            }\n            else if (event.keyCode === 40 || event.keyCode === 38) {\n                if (_this.resultsListBlock.style.display !== 'none') {\n                    var index = void 0;\n                    var element = void 0;\n                    if (event.keyCode === 40) {\n                        if (_this.focusedIndex > 7) {\n                            if (_this.focusedIndex + 1 < _this.focusedElement.length) {\n                                element = _this.focusedElement[_this.focusedIndex + 1];\n                                element.focus();\n                                _this.focusedIndex = _this.focusedIndex + 1;\n                            }\n                        }\n                        else {\n                            index = (_this.focusedElement.length - _this.resultsListBlock.children.length) + _this.results.currentIndex + 1;\n                            if (index < _this.focusedElement.length) {\n                                element = _this.focusedElement[index];\n                                element.focus();\n                                _this.focusedIndex = index;\n                            }\n                        }\n                    }\n                    else {\n                        if (_this.focusedIndex > 8) {\n                            index = _this.focusedIndex - 1;\n                            element = _this.focusedElement[index];\n                            element.focus();\n                            _this.focusedIndex = index;\n                        }\n                    }\n                }\n            }\n        };\n        /**\n         * Fires on replace.\n         * @private\n         */\n        this.onReplaceButtonClick = function () {\n            var optionsPane = _this.optionsPane;\n            var findText = _this.searchInput.value;\n            var replaceText = _this.replaceWith.value;\n            var results = _this.viewer.owner.searchModule.textSearchResults;\n            if (findText !== '' && !isNullOrUndefined(findText)) {\n                if (_this.viewer.owner.selection != null) {\n                    var selectionText = _this.viewer.owner.selection.text;\n                    if (!_this.viewer.owner.selection.isEmpty) {\n                        if (_this.viewer.owner.selection.isForward) {\n                            _this.viewer.owner.selection.selectContent(_this.viewer.owner.selection.start, true);\n                        }\n                        else {\n                            _this.viewer.owner.selection.selectContent(_this.viewer.owner.selection.end, true);\n                        }\n                    }\n                    if (!isNullOrUndefined(results) && !isNullOrUndefined(results.currentSearchResult)) {\n                        var result = results.currentSearchResult;\n                        _this.viewer.owner.searchModule.navigate(result);\n                        if (result.text === selectionText) {\n                            var replace = isNullOrUndefined(replaceText) ? '' : replaceText;\n                            _this.viewer.owner.searchModule.replace(replace, result, results);\n                            var pattern = _this.viewer.owner.searchModule.textSearch.stringToRegex(findText, _this.findOption);\n                            var endSelection = _this.viewer.selection.end;\n                            var index = endSelection.getHierarchicalIndexInternal();\n                            // tslint:disable-next-line:max-line-length\n                            _this.viewer.owner.searchModule.textSearchResults = _this.viewer.owner.searchModule.textSearch.findAll(pattern, _this.findOption, index);\n                            _this.results = _this.viewer.owner.searchModule.textSearchResults;\n                            if (!isNullOrUndefined(_this.results) && !isNullOrUndefined(_this.results.currentSearchResult)) {\n                                _this.viewer.owner.searchModule.navigate(_this.results.currentSearchResult);\n                            }\n                            else {\n                                _this.messageDiv.style.display = 'block';\n                                _this.messageDiv.innerHTML = _this.localeValue.getConstant(_this.matchDivReplaceText);\n                            }\n                            _this.viewer.owner.findResultsList = [];\n                            if (!isNullOrUndefined(_this.results) && _this.results.innerList.length > 0) {\n                                _this.navigateSearchResult();\n                            }\n                            else {\n                                _this.resultsListBlock.innerHTML = '';\n                            }\n                        }\n                    }\n                    else {\n                        _this.messageDiv.style.display = 'block';\n                        _this.messageDiv.innerHTML = _this.localeValue.getConstant(_this.matchDivReplaceText);\n                    }\n                }\n            }\n        };\n        /**\n         * Fires on replace all.\n         * @private\n         */\n        this.onReplaceAllButtonClick = function () {\n            _this.replaceAll();\n            _this.resultsListBlock.style.display = 'none';\n            _this.messageDiv.innerHTML = '';\n        };\n        /**\n         * Fires on search icon.\n         * @private\n         */\n        this.searchIconClickInternal = function () {\n            // tslint:disable:no-any \n            var inputElement = document.getElementById(_this.viewer.owner.containerId + '_option_search_text_box');\n            // tslint:enable:no-any\n            var text = inputElement.value;\n            if (text === '') {\n                return;\n            }\n            if (_this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                _this.searchIcon.classList.add('e-de-op-search-icon');\n                _this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                inputElement.value = '';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.matchDiv.style.display = 'none';\n                _this.occurrenceDiv.style.display = 'none';\n                _this.onEnableDisableReplaceButton();\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n                _this.clearSearchResultItems();\n                _this.viewer.owner.searchModule.clearSearchHighlight();\n                _this.viewer.renderVisiblePages();\n                return;\n            }\n            if (_this.searchIcon.classList.contains('e-de-op-search-icon') && text.length >= 1) {\n                _this.searchIcon.classList.add('e-de-op-search-close-icon');\n                _this.searchIcon.classList.remove('e-de-op-search-icon');\n                _this.onEnableDisableReplaceButton();\n            }\n            _this.clearSearchResultItems();\n            _this.viewer.owner.searchModule.clearSearchHighlight();\n            var patterns = _this.viewer.owner.searchModule.textSearch.stringToRegex(text, _this.findOption);\n            var endSelection = _this.viewer.selection.end;\n            var index = endSelection.getHierarchicalIndexInternal();\n            _this.results = _this.viewer.owner.searchModule.textSearch.findAll(patterns, _this.findOption, index);\n            if (_this.results != null && _this.results.length > 0) {\n                _this.navigateSearchResult();\n                _this.getMessageDivHeight();\n                var resultsContainerHeight = _this.viewer.owner.getDocumentEditorElement().offsetHeight - 215;\n                _this.resultsListBlock.style.height = resultsContainerHeight + 'px';\n            }\n            else {\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n            }\n        };\n        /**\n         * Fires on getting next results.\n         * @private\n         */\n        this.navigateNextResultButtonClick = function () {\n            if (document.getElementById(_this.viewer.owner.containerId + '_list_box_container') != null &&\n                document.getElementById(_this.viewer.owner.containerId + '_list_box_container').style.display !== 'none') {\n                if (_this.results.currentIndex < _this.results.length - 1) {\n                    _this.results.currentIndex = _this.results.currentIndex + 1;\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var i = 0; i < _this.resultsListBlock.children.length; i++) {\n                        var list = _this.resultsListBlock.children[i];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElement = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElement.classList.contains('e-de-search-result-item')) {\n                        listElement.classList.remove('e-de-search-result-item');\n                        listElement.classList.add('e-de-search-result-hglt');\n                        listElement.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElement);\n                    }\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                else {\n                    var currentelement = _this.results.innerList[0];\n                    _this.results.currentIndex = 0;\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var j = 0; j < _this.resultsListBlock.children.length; j++) {\n                        var lists = _this.resultsListBlock.children[j];\n                        if (lists.classList.contains('e-de-search-result-hglt')) {\n                            lists.classList.remove('e-de-search-result-hglt');\n                            lists.children[0].classList.remove('e-de-op-search-word-text');\n                            lists.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElementsDiv = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElementsDiv.classList.contains('e-de-search-result-item')) {\n                        listElementsDiv.classList.remove('e-de-search-result-item');\n                        listElementsDiv.classList.add('e-de-search-result-hglt');\n                        listElementsDiv.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElementsDiv);\n                    }\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                _this.focusedIndex = _this.focusedElement.indexOf(_this.navigateToNextResult);\n            }\n        };\n        /**\n         * Fires on getting previous results.\n         * @private\n         */\n        this.navigatePreviousResultButtonClick = function () {\n            if (document.getElementById(_this.viewer.owner.containerId + '_list_box_container') != null &&\n                document.getElementById(_this.viewer.owner.containerId + '_list_box_container').style.display !== 'none') {\n                if (_this.results.currentIndex === 0) {\n                    _this.results.currentIndex = _this.results.length - 1;\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.length) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var index = 0; index < _this.resultsListBlock.children.length; index++) {\n                        var list = _this.resultsListBlock.children[index];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var liElement = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (liElement.classList.contains('e-de-search-result-item')) {\n                        liElement.classList.remove('e-de-search-result-item');\n                        liElement.classList.add('e-de-search-result-hglt');\n                        liElement.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(liElement);\n                    }\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    _this.results.currentIndex = _this.results.currentIndex - 1;\n                    for (var j = 0; j < _this.resultsListBlock.children.length; j++) {\n                        var list = _this.resultsListBlock.children[j];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElements = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElements.classList.contains('e-de-search-result-item')) {\n                        listElements.classList.remove('e-de-search-result-item');\n                        listElements.classList.add('e-de-search-result-hglt');\n                        listElements.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElements);\n                    }\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                _this.focusedIndex = _this.focusedElement.indexOf(_this.navigateToPreviousResult);\n            }\n        };\n        /**\n         * Fires on key down\n         * @param {KeyboardEvent} event - Speficies key down actions.\n         * @private\n         */\n        this.onKeyDown = function (event) {\n            var code = event.which || event.keyCode;\n            if (code === 13 && event.keyCode !== 9 && event.keyCode !== 40) {\n                event.preventDefault();\n                _this.findDiv.style.height = '';\n                _this.onKeyDownInternal();\n            }\n            else if (code === 8 && (_this.searchInput.value.length === 0)) {\n                _this.resultContainer.style.display = 'block';\n            }\n            else if (event.keyCode !== 9 && event.keyCode !== 40 && event.keyCode !== 27) {\n                _this.viewer.owner.searchModule.clearSearchHighlight();\n                _this.clearSearchResultItems();\n                _this.viewer.renderVisiblePages();\n                _this.resultsListBlock.style.display = 'none';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n                if (_this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                    _this.searchIcon.classList.add('e-de-op-search-icon');\n                    _this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                }\n            }\n            else if (code === 27 && event.keyCode === 27) {\n                _this.showHideOptionsPane(false);\n            }\n        };\n        /**\n         * Close the optios pane.\n         * @private\n         */\n        this.close = function () {\n            _this.clearFocusElement();\n            _this.showHideOptionsPane(false);\n            _this.resultsListBlock.innerHTML = '';\n            _this.focusedIndex = 1;\n            _this.isOptionsPane = true;\n        };\n        /**\n         * Fires on results list block.\n         * @param {MouseEvent} args - Specifies which list was clicked.\n         * @private\n         */\n        this.resultListBlockClick = function (args) {\n            var currentlist = args.target;\n            var element = _this.resultsListBlock.children;\n            var index = 0;\n            for (var i = 0; i < element.length; i++) {\n                var list_1 = element[i];\n                if (list_1.classList.contains('e-de-search-result-hglt')) {\n                    list_1.classList.remove('e-de-search-result-hglt');\n                    list_1.children[0].classList.remove('e-de-op-search-word-text');\n                    list_1.classList.add('e-de-search-result-item');\n                }\n            }\n            var list;\n            for (var i = 0; i < element.length; i++) {\n                if (currentlist === element[i]) {\n                    index = i;\n                    list = element[i];\n                    if (list.classList.contains('e-de-search-result-item')) {\n                        list.classList.remove('e-de-search-result-item');\n                        list.classList.add('e-de-search-result-hglt');\n                        list.children[0].classList.add('e-de-op-search-word-text');\n                        _this.focusedIndex = _this.focusedElement.indexOf(list);\n                    }\n                }\n            }\n            var currentelement = _this.results.innerList[index];\n            _this.results.currentIndex = index;\n            // tslint:disable-next-line:max-line-length\n            _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (index + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n            _this.viewer.owner.searchModule.navigate(currentelement);\n            _this.viewer.owner.searchModule.highlight(_this.results);\n            list.focus();\n        };\n        this.viewer = layoutViewer;\n    }\n    /**\n     * Get the module name.\n     */\n    OptionsPane.prototype.getModuleName = function () {\n        return 'OptionsPane';\n    };\n    /**\n     * Initialize the options pane.\n     * @param {L10n} localeValue - Specifies the localization based on culture.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    OptionsPane.prototype.initOptionsPane = function (localeValue) {\n        var viewer = this.viewer;\n        this.localeValue = localeValue;\n        this.optionsPane = createElement('div', { className: 'e-de-op', styles: 'display:none;' });\n        this.optionsPane.addEventListener('keydown', this.onKeyDownOnOptionPane);\n        this.searchDiv = createElement('div', {\n            className: this.viewer.owner.containerId + '_searchDiv e-de-op-header',\n            innerHTML: localeValue.getConstant(this.searchText)\n        });\n        this.optionsPane.appendChild(this.searchDiv);\n        // tslint:disable-next-line:max-line-length\n        this.closeButton = createElement('button', { className: 'e-de-op-close-button e-de-op-icon-btn e-btn e-flat e-icon-btn', id: 'close' });\n        this.optionsPane.appendChild(this.closeButton);\n        var closeSpan = createElement('span', { className: 'e-de-op-close-icon e-btn-icon e-icons' });\n        this.closeButton.appendChild(closeSpan);\n        this.focusedElement.push(this.closeButton);\n        this.findTab = createElement('div', { id: this.viewer.owner.containerId + '_findTabDiv', className: 'e-de-op-tab' });\n        this.optionsPane.appendChild(this.findTab);\n        var tabHeader = createElement('div', { className: 'e-tab-header' });\n        this.findTab.appendChild(tabHeader);\n        this.findTabButton = createElement('div', { innerHTML: localeValue.getConstant(this.findPaneText) });\n        this.focusedElement.push(this.findTabButtonHeader);\n        tabHeader.appendChild(this.findTabButton);\n        this.replaceTabButton = createElement('div', { innerHTML: localeValue.getConstant(this.replacePaneText) });\n        this.focusedElement.push(this.replaceTabButtonHeader);\n        tabHeader.appendChild(this.replaceTabButton);\n        var tabContent = createElement('div', { className: 'e-content' });\n        var findTabContent = createElement('div', { id: 'findTabContent' });\n        tabContent.appendChild(findTabContent);\n        this.findTabContentDiv = createElement('div', { className: 'e-de-search-tab-content' });\n        this.searchTextBoxContainer = createElement('div', { className: 'e-input-group e-de-op-input-group' });\n        this.findTabContentDiv.appendChild(this.searchTextBoxContainer);\n        // tslint:disable-next-line:max-line-length\n        this.searchInput = createElement('input', { className: 'e-input e-de-search-input', id: this.viewer.owner.containerId + '_option_search_text_box', attrs: { placeholder: 'Search for' }, styles: 'font-size:14px;' });\n        this.searchTextBoxContainer.appendChild(this.searchInput);\n        this.searchIcon = createElement('span', {\n            className: 'e-de-op-icon e-de-op-search-icon e-input-group-icon e-icon',\n            id: this.viewer.owner.containerId + '_search-icon'\n        });\n        this.searchIcon.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.searchIcon);\n        this.focusedElement.push(this.searchIcon);\n        // tslint:disable-next-line:max-line-length\n        this.navigateToPreviousResult = createElement('span', { className: 'e-de-op-icon e-de-op-nav-btn e-arrow-up e-spin-up e-btn-icon e-icon e-input-group-icon' });\n        this.navigateToPreviousResult.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.navigateToPreviousResult);\n        this.focusedElement.push(this.navigateToPreviousResult);\n        // tslint:disable-next-line:max-line-length\n        this.navigateToNextResult = createElement('span', { className: 'e-de-op-icon e-de-op-nav-btn e-arrow-down e-spin-down e-btn-icon e-icon e-input-group-icon' });\n        this.navigateToNextResult.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.navigateToNextResult);\n        this.focusedElement.push(this.navigateToNextResult);\n        var div = createElement('div', { className: 'e-de-op-more-less' });\n        this.matchInput = createElement('input', {\n            attrs: { type: 'checkbox' },\n            id: this.viewer.owner.containerId + '_matchCase'\n        });\n        div.appendChild(this.matchInput);\n        this.matchCase = new CheckBox({ label: 'Match case', checked: false, change: this.matchChange });\n        this.matchCase.appendTo(this.matchInput);\n        this.focusedElement.push(this.matchInput);\n        this.matchInput.tabIndex = 0;\n        this.wholeInput = createElement('input', {\n            attrs: { type: 'checkbox' },\n            id: this.viewer.owner.containerId + '_wholeWord',\n        });\n        div.appendChild(this.wholeInput);\n        this.wholeWord = new CheckBox({ label: 'Whole words', checked: false, change: this.wholeWordsChange });\n        this.wholeWord.appendTo(this.wholeInput);\n        this.focusedElement.push(this.wholeInput);\n        this.wholeInput.tabIndex = 0;\n        this.findTabContentDiv.appendChild(div);\n        var replaceTabContent = createElement('div');\n        tabContent.appendChild(replaceTabContent);\n        this.replaceTabContentDiv = createElement('div', { className: 'e-de-op-replacetabcontentdiv', styles: 'display:none;' });\n        tabContent.appendChild(this.replaceTabContentDiv);\n        this.findTabContentDiv.appendChild(this.replaceTabContentDiv);\n        this.createReplacePane();\n        this.findDiv = createElement('div', { className: 'findDiv', styles: 'height:250px;display:block;' });\n        findTabContent.appendChild(this.findTabContentDiv);\n        this.resultContainer = createElement('div', { styles: 'width:85%;display:block;', className: 'e-de-op-result-container' });\n        this.findDiv.appendChild(this.resultContainer);\n        // tslint:disable-next-line:max-line-length\n        this.messageDiv = createElement('div', { className: this.viewer.owner.containerId + '_messageDiv e-de-op-msg', innerHTML: this.localeValue.getConstant(this.messageDivText), id: this.viewer.owner.containerId + '_search_status' });\n        this.resultContainer.appendChild(this.messageDiv);\n        // tslint:disable-next-line:max-line-length\n        this.resultsListBlock = createElement('div', { id: this.viewer.owner.containerId + '_list_box_container', styles: 'display:none;width:270px;list-style:none;padding-right:5px;overflow:auto;', className: 'e-de-result-list-block' });\n        this.findDiv.appendChild(this.resultsListBlock);\n        this.findTabContentDiv.appendChild(this.findDiv);\n        this.findTab.appendChild(tabContent);\n        this.tabInstance = new Tab({ selected: this.selectedTabItem });\n        this.tabInstance.appendTo(this.findTab);\n        var findHeader = this.tabInstance.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        this.findTabButtonHeader = findHeader.getElementsByClassName('e-tab-wrap')[0];\n        this.findTabButtonHeader.classList.add('e-de-op-find-tab-header');\n        this.findTabButtonHeader.tabIndex = 0;\n        var replaceHeader = this.tabInstance.element.getElementsByClassName('e-item e-toolbar-item')[1];\n        this.replaceTabButtonHeader = replaceHeader.getElementsByClassName('e-tab-wrap')[0];\n        this.replaceTabButtonHeader.classList.add('e-de-op-replace-tab-header');\n        this.replaceTabButtonHeader.tabIndex = 0;\n        this.onWireEvents();\n    };\n    /**\n     * Create replace pane instances.\n     */\n    OptionsPane.prototype.createReplacePane = function () {\n        this.replaceDiv = createElement('div');\n        this.replaceTabContentDiv.appendChild(this.replaceDiv);\n        this.replaceWith = createElement('input', {\n            className: 'e-de-op-replacewith e-input', styles: 'font-size:14px;',\n            attrs: { placeholder: 'Replace with' }\n        });\n        this.replaceDiv.appendChild(this.replaceWith);\n        var replaceButtonDiv = createElement('div', { styles: 'text-align:right;', className: 'e-de-op-dlg-footer' });\n        this.replaceDiv.appendChild(replaceButtonDiv);\n        this.replaceButton = createElement('button', {\n            className: 'e-control e-btn e-flat e-replace',\n            styles: 'font-size:12px;margin-right:10px;',\n            innerHTML: this.localeValue.getConstant(this.replaceButtonText)\n        });\n        replaceButtonDiv.appendChild(this.replaceButton);\n        this.replaceAllButton = createElement('button', {\n            className: 'e-control e-btn e-flat e-replaceall',\n            styles: 'font-size:12px;',\n            innerHTML: this.localeValue.getConstant(this.replaceAllButtonText)\n        });\n        replaceButtonDiv.appendChild(this.replaceAllButton);\n        this.matchDiv = createElement('div', { styles: 'display:none;padding-top:10px;' });\n        this.replaceDiv.appendChild(this.matchDiv);\n        var emptyDiv6 = createElement('div', { className: 'e-de-op-search-replacediv' });\n        this.replaceDiv.appendChild(emptyDiv6);\n        this.occurrenceDiv = createElement('div', { styles: 'display:none;' });\n        this.replaceDiv.appendChild(this.occurrenceDiv);\n    };\n    OptionsPane.prototype.navigateSearchResult = function () {\n        this.viewer.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]);\n        this.viewer.owner.searchModule.highlight(this.results);\n        this.viewer.owner.searchModule.addFindResultView(this.results);\n        this.resultsListBlock.style.display = 'block';\n        this.resultContainer.style.display = 'block';\n        var lists = this.viewer.owner.findResultsList;\n        var text = '';\n        for (var i = 0; i < lists.length; i++) {\n            text += lists[i];\n        }\n        this.clearFocusElement();\n        this.resultsListBlock.innerHTML = text;\n        for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n            this.focusedElement.push(this.resultsListBlock.children[i]);\n        }\n        var currentIndexValue = this.results.currentIndex;\n        // tslint:disable-next-line:max-line-length\n        this.messageDiv.innerHTML = this.localeValue.getConstant('Result') + ' ' + (currentIndexValue + 1) + ' ' + this.localeValue.getConstant('of') + ' ' + this.resultsListBlock.children.length;\n        var listElement = this.resultsListBlock.children[currentIndexValue];\n        if (listElement.classList.contains('e-de-search-result-item')) {\n            listElement.classList.remove('e-de-search-result-item');\n            listElement.classList.add('e-de-search-result-hglt');\n            listElement.children[0].classList.add('e-de-op-search-word-text');\n            this.scrollToPosition(listElement);\n        }\n    };\n    /**\n     * Fires on key down actions done.\n     * @private\n     */\n    OptionsPane.prototype.onKeyDownInternal = function () {\n        // tslint:disable-next-line:max-line-length\n        var inputElement = document.getElementById(this.viewer.owner.containerId + '_option_search_text_box');\n        inputElement.blur();\n        var text = inputElement.value;\n        if (text === '') {\n            return;\n        }\n        if (text.length >= 1 && this.searchIcon.classList.contains('e-de-op-search-icon')) {\n            this.searchIcon.classList.add('e-de-op-search-close-icon');\n            this.searchIcon.classList.remove('e-de-op-search-icon');\n        }\n        var resultsContainerHeight = this.viewer.owner.getDocumentEditorElement().offsetHeight - 215;\n        this.clearSearchResultItems();\n        this.viewer.owner.searchModule.clearSearchHighlight();\n        var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(text, this.findOption);\n        var endSelection = this.viewer.selection.end;\n        var index = endSelection.getHierarchicalIndexInternal();\n        this.results = this.viewer.owner.searchModule.textSearch.findAll(pattern, this.findOption, index);\n        var results = this.results;\n        if (isNullOrUndefined(results)) {\n            this.viewer.renderVisiblePages();\n        }\n        if (results != null && results.length > 0) {\n            if ((this.focusedElement.indexOf(this.navigateToPreviousResult) === -1) && this.isOptionsPane) {\n                this.focusedElement.push(this.navigateToPreviousResult);\n            }\n            if ((this.focusedElement.indexOf(this.navigateToNextResult) === -1) && this.isOptionsPane) {\n                this.focusedElement.push(this.navigateToNextResult);\n            }\n            this.viewer.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]);\n            this.viewer.owner.searchModule.highlight(results);\n            this.viewer.owner.searchModule.addFindResultView(results);\n            // if (this.isOptionsPane) {\n            this.resultsListBlock.style.display = 'block';\n            this.resultsListBlock.style.height = resultsContainerHeight + 'px';\n            this.resultContainer.style.display = 'block';\n            var list = this.viewer.owner.findResultsList;\n            var text_1 = '';\n            this.clearFocusElement();\n            this.resultsListBlock.innerHTML = '';\n            for (var i = 0; i < list.length; i++) {\n                text_1 += list[i];\n            }\n            this.resultsListBlock.innerHTML = text_1;\n            for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n                this.focusedElement.push(this.resultsListBlock.children[i]);\n            }\n            var lists = this.resultsListBlock.children;\n            var currentIndex = this.results.currentIndex;\n            // tslint:disable-next-line:max-line-length\n            this.messageDiv.innerHTML = this.localeValue.getConstant('Result') + ' ' + (currentIndex + 1) + ' ' + this.localeValue.getConstant('of') + ' ' + this.resultsListBlock.children.length;\n            var listElement = this.resultsListBlock.children[currentIndex];\n            if (listElement.classList.contains('e-de-search-result-item')) {\n                listElement.classList.remove('e-de-search-result-item');\n                listElement.classList.add('e-de-search-result-hglt');\n                listElement.children[0].classList.add('e-de-op-search-word-text');\n            }\n            this.navigateToNextResult.focus();\n            this.focusedIndex = 6;\n            this.getMessageDivHeight();\n            // } else {\n            //this.focusedIndex = 4;\n            // }\n        }\n        else {\n            this.messageDiv.innerHTML = this.localeValue.getConstant('No matches');\n            this.resultContainer.style.display = 'block';\n            this.resultsListBlock.style.display = 'none';\n            this.clearFocusElement();\n            this.resultsListBlock.innerHTML = '';\n        }\n    };\n    OptionsPane.prototype.getMessageDivHeight = function () {\n        if (!this.isOptionsPane && this.messageDiv.classList.contains('e-de-op-msg')) {\n            this.messageDiv.classList.add('e-de-op-replace-messagediv');\n            this.messageDiv.classList.remove('e-de-op-msg');\n        }\n        else if (this.isOptionsPane && this.messageDiv.classList.contains('e-de-op-replace-messagediv')) {\n            this.messageDiv.classList.add('e-de-op-msg');\n            this.messageDiv.classList.remove('e-de-op-replace-messagediv');\n        }\n    };\n    /**\n     * Replace all.\n     * @private\n     */\n    OptionsPane.prototype.replaceAll = function () {\n        var optionsPane = this.optionsPane;\n        var findText = this.searchInput.value;\n        var replaceText = this.replaceWith.value;\n        if (findText !== '' && !isNullOrUndefined(findText)) {\n            var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(findText, this.findOption);\n            var endSelection = this.viewer.selection.end;\n            var index = endSelection.getHierarchicalIndexInternal();\n            var results = this.viewer.owner.searchModule.textSearch.findAll(pattern, this.findOption, index);\n            var replace = isNullOrUndefined(replaceText) ? '' : replaceText;\n            var count = isNullOrUndefined(results) ? 0 : results.length;\n            this.viewer.owner.searchModule.replaceAll(replace, results);\n            this.matchDiv.style.display = 'block';\n            this.matchDiv.innerHTML = this.localeValue.getConstant('All Done') + '!';\n            this.occurrenceDiv.style.display = 'block';\n            // tslint:disable-next-line:max-line-length\n            this.occurrenceDiv.innerHTML = this.localeValue.getConstant('We replaced all') + ' ' + count + ' ' + this.localeValue.getConstant('instances') + ' ' + this.localeValue.getConstant('of') + ' \"' + findText + '\" ' + this.localeValue.getConstant('with') + ' \"' + replaceText + '\" ';\n        }\n    };\n    /**\n     * Scrolls to position.\n     * @param {HTMLElement} list - Specifies the list element.\n     * @private\n     */\n    OptionsPane.prototype.scrollToPosition = function (list) {\n        var rect = list.getBoundingClientRect();\n        var top;\n        if (rect.top > 0) {\n            top = rect.top - list.parentElement.getBoundingClientRect().top;\n            if ((list.parentElement.offsetHeight - top) <= list.offsetHeight) {\n                if (Math.ceil(top + list.offsetHeight) === list.parentElement.scrollHeight) {\n                    list.parentElement.scrollTop = top;\n                }\n                list.parentElement.scrollTop = list.parentElement.scrollTop + (list.parentElement.offsetHeight / 100) * 30;\n            }\n            else if (top < 0) {\n                list.parentElement.scrollTop = list.parentElement.scrollTop - (list.parentElement.offsetHeight / 100) * 30;\n            }\n        }\n        else {\n            list.parentElement.scrollTop = 0;\n        }\n    };\n    /**\n     * Clear the focus elements.\n     * @private\n     */\n    OptionsPane.prototype.clearFocusElement = function () {\n        for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n            var index = this.focusedElement.indexOf(this.resultsListBlock.children[i]);\n            if (index !== -1) {\n                this.focusedElement.splice(index, 1);\n            }\n        }\n        this.focusedIndex = 0;\n    };\n    /**\n     * Show or hide option pane based on boolean value.\n     * @param {boolean} show - Specifies showing or hiding the options pane.\n     * @private\n     */\n    OptionsPane.prototype.showHideOptionsPane = function (show) {\n        if (!isNullOrUndefined(this.viewer.owner.selectionModule)) {\n            if (show) {\n                this.localeValue = new L10n('documenteditor', this.viewer.owner.defaultLocale);\n                this.localeValue.setLocale(this.viewer.owner.locale);\n                setCulture(this.viewer.owner.locale);\n                if (isNullOrUndefined(this.optionsPane)) {\n                    this.initOptionsPane(this.localeValue);\n                    //Add Option Pane\n                    this.viewer.optionsPaneContainer.setAttribute('style', 'display:inline-flex');\n                    // tslint:disable-next-line:max-line-length\n                    this.viewer.optionsPaneContainer.insertBefore(this.viewer.owner.optionsPaneModule.optionsPane, this.viewer.viewerContainer);\n                }\n                this.optionsPane.style.display = 'block';\n                if (this.viewer.owner.isReadOnlyMode) {\n                    this.tabInstance.hideTab(1);\n                }\n                else {\n                    this.tabInstance.hideTab(1, false);\n                }\n                if (this.isReplace && !this.viewer.owner.isReadOnlyMode) {\n                    this.tabInstance.select(1);\n                    this.isReplace = false;\n                    this.isOptionsPane = false;\n                }\n                else {\n                    this.tabInstance.select(0);\n                }\n                this.searchDiv.innerHTML = this.localeValue.getConstant(this.searchText);\n                this.isOptionsPaneShow = true;\n                // tslint:disable-next-line:max-line-length\n                var textBox = document.getElementById(this.viewer.owner.getDocumentEditorElement().id + '_option_search_text_box');\n                var selectedText = this.viewer.owner.selection.text;\n                if (!isNullOrUndefined(selectedText)) {\n                    var char = ['\\v', '\\r'];\n                    var index = HelperMethods.indexOfAny(selectedText, char);\n                    selectedText = index < 0 ? selectedText : selectedText.substring(0, index);\n                }\n                textBox.value = selectedText;\n                textBox.select();\n                this.messageDiv.innerHTML = '';\n                if (this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                    this.searchIcon.classList.add('e-de-op-search-icon');\n                    this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                }\n                this.viewer.selection.caret.style.display = 'none';\n                this.focusedIndex = 3;\n                this.focusedElement = [];\n                if (this.isOptionsPane) {\n                    // tslint:disable-next-line:max-line-length\n                    this.focusedElement.push(this.closeButton, this.findTabButtonHeader, this.replaceTabButtonHeader, this.searchInput, this.searchIcon, this.navigateToPreviousResult, this.navigateToNextResult, this.matchInput, this.wholeInput);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    this.focusedElement.push(this.closeButton, this.findTabButtonHeader, this.replaceTabButtonHeader, this.searchInput, this.searchIcon, this.navigateToPreviousResult, this.navigateToNextResult, this.matchInput, this.wholeInput, this.replaceWith, this.replaceButton, this.replaceAllButton);\n                }\n                this.viewer.updateViewerSize();\n            }\n            else {\n                if (!isNullOrUndefined(this.optionsPane)) {\n                    this.clearSearchResultItems();\n                    this.viewer.owner.searchModule.clearSearchHighlight();\n                    this.isOptionsPaneShow = false;\n                    var resultListBox = document.getElementById(this.viewer.owner.containerId + '_list_box_container');\n                    var message = document.getElementById(this.viewer.owner.containerId + '_search_status');\n                    if (!isNullOrUndefined(resultListBox) && !isNullOrUndefined(message)) {\n                        resultListBox.style.display = 'none';\n                        this.clearFocusElement();\n                        resultListBox.innerHTML = '';\n                        message.innerHTML = this.localeValue.getConstant('No matches');\n                    }\n                }\n                this.viewer.updateViewerSize();\n                if (!isNullOrUndefined(this.optionsPane)) {\n                    if (this.optionsPane.style.display !== 'none') {\n                        this.viewer.selection.updateCaretPosition();\n                        this.optionsPane.style.display = 'none';\n                    }\n                }\n                this.viewer.updateFocus();\n                this.viewer.selection.caret.style.display = 'block';\n            }\n        }\n    };\n    /**\n     * Clears search results.\n     * @private\n     */\n    OptionsPane.prototype.clearSearchResultItems = function () {\n        if (!isNullOrUndefined(this.viewer.owner.findResultsList)) {\n            this.viewer.owner.findResultsList = [];\n        }\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    OptionsPane.prototype.destroy = function () {\n        if (this.optionsPane) {\n            this.optionsPane.innerHTML = '';\n            this.optionsPane = undefined;\n        }\n        if (this.resultsListBlock) {\n            this.resultsListBlock.innerHTML = '';\n            this.resultsListBlock = undefined;\n        }\n        if (this.messageDiv) {\n            this.messageDiv.innerHTML = '';\n            this.messageDiv = undefined;\n        }\n        if (this.resultContainer) {\n            this.resultContainer.innerHTML = '';\n        }\n        this.resultContainer = undefined;\n        if (this.searchInput) {\n            this.searchInput.value = '';\n            this.searchInput = undefined;\n        }\n        if (this.searchDiv) {\n            this.searchDiv.innerHTML = '';\n            this.searchDiv = undefined;\n        }\n        if (this.searchTextBoxContainer) {\n            this.searchTextBoxContainer.innerHTML = '';\n            this.searchTextBoxContainer = undefined;\n        }\n        if (this.replaceWith) {\n            this.replaceWith.innerHTML = '';\n            this.replaceWith = undefined;\n        }\n        if (this.findDiv) {\n            this.findDiv.innerHTML = '';\n            this.findDiv = undefined;\n        }\n        if (this.replaceButton) {\n            this.replaceButton.innerHTML = '';\n            this.replaceButton = undefined;\n        }\n        if (this.replaceAllButton) {\n            this.replaceAllButton.innerHTML = '';\n            this.replaceAllButton = undefined;\n        }\n        if (this.matchInput) {\n            this.matchInput.innerHTML = '';\n            this.matchCase = undefined;\n        }\n        if (this.wholeInput) {\n            this.wholeInput.innerHTML = '';\n            this.wholeWord = undefined;\n        }\n        // if (this.regularInput) {\n        //     this.regularInput.innerHTML = '';\n        //     this.regular = undefined;\n        // }\n        if (!isNullOrUndefined(this.results)) {\n            this.results.destroy();\n        }\n        if (this.focusedElement) {\n            this.focusedElement = [];\n        }\n        this.focusedElement = undefined;\n        this.destroyInternal();\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     */\n    OptionsPane.prototype.destroyInternal = function () {\n        if (this.searchText) {\n            this.searchText = undefined;\n        }\n        if (this.resultsText) {\n            this.resultsText = undefined;\n        }\n        if (this.messageDivText) {\n            this.messageDivText = undefined;\n        }\n        if (this.replaceButtonText) {\n            this.replaceButtonText = undefined;\n        }\n        if (this.replaceAllButtonText) {\n            this.replaceAllButtonText = undefined;\n        }\n    };\n    return OptionsPane;\n}());\nexport { OptionsPane };\n","import { TableWidget } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Point, HelperMethods } from './editor-helper';\n/**\n * @private\n */\nvar TableResizer = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableResizer(node) {\n        this.resizeNode = 0;\n        this.resizerPosition = 0;\n        this.currentResizingTable = undefined;\n        this.owner = node;\n        this.startingPoint = new Point(0, 0);\n    }\n    Object.defineProperty(TableResizer.prototype, \"viewer\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets module name.\n     */\n    TableResizer.prototype.getModuleName = function () {\n        return 'TableResizer';\n    };\n    /**\n     * @private\n     */\n    TableResizer.prototype.updateResizingHistory = function (touchPoint) {\n        if (this.owner.editorHistory) {\n            this.owner.editorHistory.updateResizingHistory(touchPoint, this);\n        }\n        this.viewer.isRowOrCellResizing = false;\n        this.resizerPosition = -1;\n    };\n    TableResizer.prototype.handleResize = function (point) {\n        this.owner.viewer.isRowOrCellResizing = true;\n        this.startingPoint.x = point.x;\n        this.startingPoint.y = point.y;\n        //Initialize resizing history.\n        this.owner.editorHistory.initResizingHistory(point, this);\n    };\n    //Table Resizing implementation starts\n    /**\n     * @private\n     */\n    TableResizer.prototype.isInRowResizerArea = function (touchPoint) {\n        var position = this.getRowReSizerPosition(undefined, touchPoint);\n        if (position === -1) {\n            return false;\n        }\n        else {\n            this.resizeNode = 1;\n            this.resizerPosition = position;\n            return true;\n        }\n    };\n    TableResizer.prototype.isInCellResizerArea = function (touchPoint) {\n        var position = this.getCellReSizerPosition(touchPoint);\n        if (position === -1) {\n            return false;\n        }\n        else {\n            this.resizeNode = 0;\n            this.resizerPosition = position;\n            return true;\n        }\n    };\n    /**\n     * Gets cell resizer position.\n     * @param {Point} point\n     * @private\n     */\n    TableResizer.prototype.getCellReSizerPosition = function (touchPoint) {\n        var position = -1;\n        var resizerBoundaryWidth = 2;\n        var tableWidget = this.getTableWidget(touchPoint);\n        var cellWidget = this.getTableCellWidget(touchPoint);\n        var cellSpacing = isNullOrUndefined(tableWidget) ? 0 : tableWidget.tableFormat.cellSpacing;\n        if (tableWidget && cellSpacing > 0) {\n            this.currentResizingTable = tableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.isInsideRect(tableWidget.x - HelperMethods.convertPointToPixel(tableWidget.leftBorderWidth) - 0.25, tableWidget.y, HelperMethods.convertPointToPixel(tableWidget.leftBorderWidth) + 0.5, tableWidget.height, touchPoint)) {\n                return position = 0;\n            }\n            var startingPointX = tableWidget.x;\n            for (var i = 0; i < tableWidget.tableHolder.columns.length; i++) {\n                var preferredWidth = HelperMethods.convertPointToPixel(tableWidget.tableHolder.columns[i].preferredWidth);\n                // tslint:disable-next-line:max-line-length\n                if ((this.viewer.isInsideRect(startingPointX - 1, tableWidget.y, tableWidget.leftBorderWidth + resizerBoundaryWidth, tableWidget.height, touchPoint))) {\n                    return position = i > 0 ? i : 0;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (i > 0 && (this.viewer.isInsideRect(startingPointX + preferredWidth - resizerBoundaryWidth / 2, tableWidget.y, resizerBoundaryWidth, tableWidget.height, touchPoint))) {\n                    return position = (i + 1);\n                }\n                startingPointX = startingPointX + preferredWidth;\n            }\n        }\n        else {\n            if (!isNullOrUndefined(cellWidget)) {\n                this.currentResizingTable = cellWidget.ownerTable;\n                // tslint:disable-next-line:max-line-length\n                if (this.viewer.isInsideRect(cellWidget.x - cellWidget.margin.left - resizerBoundaryWidth / 2, cellWidget.y - cellWidget.margin.top, resizerBoundaryWidth, cellWidget.height, touchPoint)) {\n                    return position = cellWidget.columnIndex;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (isNullOrUndefined(cellWidget.nextRenderedWidget)\n                    && this.viewer.isInsideRect(cellWidget.x + cellWidget.margin.right + cellWidget.width - resizerBoundaryWidth / 2, cellWidget.y - cellWidget.margin.top, resizerBoundaryWidth, cellWidget.height, touchPoint)) {\n                    return position = (cellWidget.columnIndex + cellWidget.cellFormat.columnSpan);\n                }\n                else if (cellWidget.childWidgets.length > 0) {\n                    return this.getCellReSizerPositionInternal(cellWidget, touchPoint); // Gets the nested table resizer position.\n                }\n            }\n        }\n        return position;\n    };\n    /**\n     * Gets cell resizer position.\n     * @param {TableCellWidget} cellWidget\n     * @param {Point} touchPoint\n     */\n    TableResizer.prototype.getCellReSizerPositionInternal = function (cellWidget, touchPoint) {\n        var position = -1;\n        var childTableWidget = this.getTableWidgetFromWidget(touchPoint, cellWidget);\n        var childCellWidget = undefined;\n        if (!isNullOrUndefined(childTableWidget) && childTableWidget.tableFormat.cellSpacing > 0) {\n            this.currentResizingTable = childTableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.isInsideRect(childTableWidget.x - childTableWidget.leftBorderWidth - 0.25, childTableWidget.y, childTableWidget.leftBorderWidth + 0.5, childTableWidget.height, touchPoint)) {\n                return position = 0;\n            }\n            var startingPointX = childTableWidget.x;\n            for (var i = 0; i < childTableWidget.tableHolder.columns.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                var preferredWidth = HelperMethods.convertPointToPixel(childTableWidget.tableHolder.columns[i].preferredWidth);\n                // tslint:disable-next-line:max-line-length\n                if ((this.viewer.isInsideRect(startingPointX - 1, childTableWidget.y, childTableWidget.leftBorderWidth + 2, childTableWidget.height, touchPoint))) {\n                    return position = i > 0 ? i : 0;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (i > 0 && (this.viewer.isInsideRect(startingPointX + preferredWidth - 1, childTableWidget.y, 2, childTableWidget.height, touchPoint))) {\n                    return position = (i + 1);\n                }\n                startingPointX = startingPointX + preferredWidth;\n            }\n        }\n        else {\n            if (!isNullOrUndefined(childTableWidget)) {\n                childCellWidget = childTableWidget.getTableCellWidget(touchPoint);\n            }\n            if (!isNullOrUndefined(childCellWidget)) {\n                this.currentResizingTable = childCellWidget.ownerTable;\n                // tslint:disable-next-line:max-line-length\n                if (this.viewer.isInsideRect(childCellWidget.x - childCellWidget.margin.left - 1, childCellWidget.y - childCellWidget.margin.top, 2, childCellWidget.height, touchPoint)) {\n                    return position = childCellWidget.columnIndex;\n                }\n                else if (isNullOrUndefined(childCellWidget.nextRenderedWidget)\n                    // tslint:disable-next-line:max-line-length\n                    && this.viewer.isInsideRect(childCellWidget.x + childCellWidget.margin.right + childCellWidget.width - 1, childCellWidget.y - childCellWidget.margin.top, 2, childCellWidget.height, touchPoint)) {\n                    return position = (childCellWidget.columnIndex + childCellWidget.cellFormat.columnSpan);\n                }\n                else if (childCellWidget.childWidgets.length > 0) {\n                    return this.getCellReSizerPositionInternal(childCellWidget, touchPoint);\n                }\n            }\n        }\n        return position;\n    };\n    TableResizer.prototype.getRowReSizerPosition = function (widget, touchPoint) {\n        var tableWidget = undefined;\n        var cellWidget = undefined;\n        if (isNullOrUndefined(widget)) {\n            tableWidget = this.getTableWidget(touchPoint);\n            cellWidget = this.getTableCellWidget(touchPoint);\n        }\n        else {\n            tableWidget = this.getTableWidgetFromWidget(touchPoint, widget);\n        }\n        var cellSpacing = isNullOrUndefined(tableWidget) ? 0 : tableWidget.tableFormat.cellSpacing;\n        if (tableWidget && cellSpacing > 0) {\n            this.currentResizingTable = tableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.owner.viewer.isInsideRect(tableWidget.x, tableWidget.y + tableWidget.height - cellSpacing, this.getActualWidth(tableWidget.lastChild), (isNullOrUndefined(tableWidget.nextSplitWidget) ? tableWidget.bottomBorderWidth + cellSpacing : 0), touchPoint)) {\n                return tableWidget.lastChild.rowIndex;\n            }\n            for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n                //Need to consider for splitted widgets\n                var rowWidget = tableWidget.childWidgets[i];\n                if (tableWidget.childWidgets.indexOf(rowWidget) > -1\n                    // tslint:disable-next-line:max-line-length\n                    && (this.owner.viewer.isInsideRect(rowWidget.x, rowWidget.y + rowWidget.height + cellSpacing / 2, this.getActualWidth(rowWidget), cellSpacing / 2, touchPoint))) {\n                    return rowWidget.rowIndex;\n                }\n            }\n        }\n        else {\n            if (tableWidget && cellWidget) {\n                cellWidget = this.getTableCellWidget(touchPoint);\n            }\n            if (cellWidget) {\n                var rowWidget = cellWidget.containerWidget;\n                var height = 0;\n                if (rowWidget.rowIndex === rowWidget.ownerTable.childWidgets.length - 1) {\n                    height = rowWidget.bottomBorderWidth + 2;\n                }\n                else {\n                    height = rowWidget.nextRenderedWidget.topBorderWidth + 2;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (this.owner.viewer.isInsideRect(rowWidget.x, rowWidget.y + rowWidget.height - height, rowWidget.width, height * 2, touchPoint)) {\n                    this.currentResizingTable = rowWidget.ownerTable;\n                    return rowWidget.rowIndex;\n                }\n                else {\n                    if (cellWidget.childWidgets.length > 0) {\n                        return this.getRowReSizerPosition(cellWidget, touchPoint);\n                    }\n                }\n            }\n        }\n        return -1;\n    };\n    /**\n     * To handle Table Row and cell resize\n     * @param touchPoint\n     * @private\n     */\n    TableResizer.prototype.handleResizing = function (touchPoint) {\n        var dragValue = 0;\n        if (this.resizeNode === 0) {\n            dragValue = touchPoint.x - this.startingPoint.x;\n            this.resizeTableCellColumn(dragValue);\n        }\n        else {\n            dragValue = touchPoint.y - this.startingPoint.y;\n            this.resizeTableRow(dragValue);\n        }\n    };\n    TableResizer.prototype.resizeTableRow = function (dragValue) {\n        var table = this.currentResizingTable;\n        if (isNullOrUndefined(table) || dragValue === 0) {\n            return;\n        }\n        var selection = this.owner.selection;\n        if (table.isInsideTable) {\n            this.owner.isLayoutEnabled = false; //Layouting is disabled to skip the child table layouting. \n        }\n        if (this.resizerPosition > -1) {\n            var row = table.childWidgets[this.resizerPosition];\n            this.updateRowHeight(row, dragValue);\n            selection.selectPosition(selection.start, selection.end);\n        }\n        if (table.isInsideTable) {\n            var parentTable = this.owner.viewer.layout.getParentTable(table);\n            this.owner.isLayoutEnabled = true; //layouting is enabled to layout the parent table of the nested table.\n            table = parentTable;\n        }\n        this.startingPoint.y += HelperMethods.convertPointToPixel(dragValue);\n        this.owner.viewer.layout.reLayoutTable(table);\n        this.owner.editorModule.reLayout(this.owner.selection);\n    };\n    /**\n     * Gets the table widget from given cursor point\n     * @param cursorPoint\n     */\n    TableResizer.prototype.getTableWidget = function (cursorPoint) {\n        var widget = undefined;\n        var currentPage = this.owner.viewer.currentPage;\n        if (!isNullOrUndefined(currentPage)) {\n            for (var i = 0; i < currentPage.bodyWidgets.length; i++) {\n                var bodyWidget = currentPage.bodyWidgets[i];\n                widget = this.getTableWidgetFromWidget(cursorPoint, bodyWidget);\n                if (!isNullOrUndefined(widget)) {\n                    break;\n                }\n            }\n        }\n        return widget;\n    };\n    TableResizer.prototype.getTableWidgetFromWidget = function (point, widget) {\n        for (var j = 0; j < widget.childWidgets.length; j++) {\n            if (widget.childWidgets[j] instanceof TableWidget) {\n                var childWidget = widget.childWidgets[j];\n                if (childWidget.y <= point.y && (childWidget.y + childWidget.height) >= point.y) {\n                    return childWidget;\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Return the table cell widget from the given cursor point\n     * @param cursorPoint\n     * @private\n     */\n    TableResizer.prototype.getTableCellWidget = function (cursorPoint) {\n        var widget = undefined;\n        var currentPage = this.owner.viewer.currentPage;\n        if (!isNullOrUndefined(currentPage)) {\n            for (var i = 0; i < currentPage.bodyWidgets.length; i++) {\n                var bodyWidget = currentPage.bodyWidgets[i];\n                widget = bodyWidget.getTableCellWidget(cursorPoint);\n                if (!isNullOrUndefined(widget)) {\n                    break;\n                }\n            }\n        }\n        return widget;\n    };\n    TableResizer.prototype.updateRowHeight = function (row, dragValue) {\n        var rowFormat = row.rowFormat;\n        if (rowFormat.heightType === 'Auto') {\n            rowFormat.heightType = 'AtLeast';\n            var row_1 = rowFormat.ownerBase;\n            var currentHeight = this.owner.viewer.layout.getRowHeight(row_1, [row_1]);\n            //the minimum height of the Row in MS word is 2.7 points which is equal to 3.6 pixel.\n            if (currentHeight + dragValue >= 2.7 && rowFormat.height !== currentHeight + dragValue) {\n                rowFormat.height = currentHeight + dragValue;\n            }\n        }\n        else {\n            //the minimum height of the Row in MS word is 2.7 points which is equal to 3.6 pixel.\n            if (rowFormat.height + dragValue >= 2.7 && rowFormat.height !== rowFormat.height + dragValue) {\n                rowFormat.height = rowFormat.height + dragValue;\n            }\n        }\n    };\n    //Resize Table cell\n    TableResizer.prototype.resizeTableCellColumn = function (dragValue) {\n        var table = this.currentResizingTable;\n        if (isNullOrUndefined(table) || dragValue === 0 || isNullOrUndefined(table.childWidgets)) {\n            return;\n        }\n        var selectionFlag = true;\n        var selection = this.owner.selection;\n        this.owner.editor.setOffsetValue(selection);\n        table = table.combineWidget(this.viewer);\n        this.owner.isLayoutEnabled = false;\n        // table.PreserveGrid = true;\n        this.setPreferredWidth(table);\n        var containerWidth = table.getOwnerWidth(true);\n        var newIndent = table.leftIndent;\n        var tableAlignment = table.tableFormat.tableAlignment;\n        if (!selection.isEmpty) {\n            selectionFlag = this.resizeColumnWithSelection(selection, table, dragValue);\n        }\n        if (!selectionFlag) {\n            this.owner.isLayoutEnabled = true;\n            return;\n        }\n        if (this.resizerPosition === 0) {\n            // Todo: need to handle the resizing of first column and table indent.\n            var columnIndex = this.resizerPosition;\n            var rightColumn = table.tableHolder.columns[columnIndex];\n            var width = rightColumn.preferredWidth;\n            if (dragValue > 0) {\n                var prevDragValue = dragValue;\n                do {\n                    var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                    if (newWidth >= rightColumn.minWidth) {\n                        rightColumn.preferredWidth = newWidth;\n                        newIndent = table.leftIndent + dragValue;\n                        newIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        break;\n                    }\n                    else {\n                        prevDragValue = dragValue;\n                        dragValue += newWidth - rightColumn.minWidth;\n                    }\n                } while (dragValue !== prevDragValue);\n            }\n            else {\n                var prevDragValue = dragValue;\n                do {\n                    var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                    if (newWidth <= 2112) {\n                        rightColumn.preferredWidth = newWidth;\n                        newIndent = table.leftIndent + dragValue;\n                        newIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        break;\n                    }\n                    else {\n                        prevDragValue = dragValue;\n                        dragValue -= newWidth - 2112;\n                    }\n                } while (dragValue !== prevDragValue);\n            }\n            var dragOffset = dragValue;\n            // tslint:disable-next-line:max-line-length\n            if (tableAlignment !== 'Left' && (table.tableHolder.getTotalWidth() > containerWidth) && table.tableFormat.preferredWidthType === 'Auto') {\n                if (table.tableHolder.isFitColumns(containerWidth, table.tableHolder.tableWidth, table.tableFormat.preferredWidthType === 'Auto')) {\n                    // tslint:disable-next-line:max-line-length\n                    table.tableHolder.fitColumns(containerWidth, table.tableHolder.tableWidth, table.tableFormat.preferredWidthType === 'Auto');\n                }\n                else {\n                    rightColumn.preferredWidth = width;\n                }\n                dragOffset = 0;\n            }\n            if (tableAlignment === 'Center'\n                && (table.tableHolder.getTotalWidth() < containerWidth || table.tableFormat.preferredWidthType !== 'Auto')) {\n                dragOffset = dragOffset / 2;\n            }\n            table.tableFormat.leftIndent = tableAlignment === 'Left' ? newIndent : 0;\n            table.tableHolder.tableWidth = table.tableHolder.getTotalWidth();\n            this.updateCellPreferredWidths(table);\n            this.updateGridValue(table, true, dragOffset);\n        }\n        else if (table !== null && this.resizerPosition === table.tableHolder.columns.length) {\n            // Todo: need to handle the resizing of last column and table width.\n            this.resizeColumnAtLastColumnIndex(table, dragValue, containerWidth);\n        }\n        else {\n            if (this.resizerPosition === -1) {\n                this.owner.isLayoutEnabled = true;\n                return;\n            }\n            this.resizeCellAtMiddle(table, dragValue);\n        }\n        // table.PreserveGrid = false;\n        this.owner.isLayoutEnabled = true;\n        selection.selectPosition(selection.start, selection.end);\n    };\n    /**\n     * Resize Selected Cells\n     */\n    TableResizer.prototype.resizeColumnWithSelection = function (selection, table, dragValue) {\n        var newIndent = table.leftIndent;\n        var cellwidget = this.getTableCellWidget(this.startingPoint);\n        if (cellwidget && (selection.selectedWidgets.containsKey(cellwidget) || (cellwidget.previousWidget\n            && selection.selectedWidgets.containsKey((cellwidget.previousWidget))))) {\n            var selectedCells = selection.getSelectedCells();\n            if (this.resizerPosition === 0) {\n                this.resizeColumnAtStart(table, dragValue, selectedCells);\n            }\n            else if (table !== null && this.resizerPosition === table.tableHolder.columns.length) {\n                var leftColumnCollection = this.getColumnCells(table, this.resizerPosition, true);\n                for (var i = 0; i < leftColumnCollection.length; i++) {\n                    var cell = leftColumnCollection[i];\n                    if (selectedCells.indexOf(cell) !== -1) {\n                        this.increaseOrDecreaseWidth(cell, dragValue, true);\n                    }\n                }\n                //Updates the grid after value for all the rows.\n                this.updateRowsGridAfterWidth(table);\n                table.updateWidth(dragValue);\n                this.updateGridValue(table, true, dragValue);\n            }\n            else {\n                if (this.resizerPosition === -1) {\n                    return false;\n                }\n                var columnIndex = this.resizerPosition;\n                var leftColumnCollection = this.getColumnCells(table, columnIndex, true);\n                var rightColumnCollection = this.getColumnCells(table, columnIndex, false);\n                var isColumnResizing = this.isColumnSelected(table, columnIndex);\n                if (leftColumnCollection.length > 0 && !isColumnResizing) {\n                    for (var i = 0; i < leftColumnCollection.length; i++) {\n                        if (selectedCells.indexOf(leftColumnCollection[i]) === -1) {\n                            leftColumnCollection.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                if (rightColumnCollection.length > 0 && !isColumnResizing) {\n                    for (var i = 0; i < rightColumnCollection.length; i++) {\n                        if (selectedCells.indexOf(rightColumnCollection[i]) === -1) {\n                            rightColumnCollection.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                //Getting the adjacent cell collections for left side selected cells in the right column collection.\n                if (leftColumnCollection.length === 0 && rightColumnCollection.length > 0) {\n                    for (var i = 0; i < rightColumnCollection.length; i++) {\n                        var cell = rightColumnCollection[i];\n                        if (cell.previousWidget) {\n                            leftColumnCollection.push(cell.previousWidget);\n                        }\n                    }\n                }\n                else if (rightColumnCollection.length === 0 && leftColumnCollection.length > 0) {\n                    for (var i = 0; i < leftColumnCollection.length; i++) {\n                        var cell = leftColumnCollection[i];\n                        if (cell.nextWidget) {\n                            rightColumnCollection.push(cell.nextWidget);\n                        }\n                    }\n                }\n                this.changeWidthOfCells(table, leftColumnCollection, rightColumnCollection, dragValue, true);\n                this.updateGridValue(table, true, dragValue);\n            }\n            selection.selectPosition(selection.start, selection.end);\n        }\n        return false;\n    };\n    /**\n     * Resize selected cells at resizer position 0\n     */\n    TableResizer.prototype.resizeColumnAtStart = function (table, dragValue, selectedCells) {\n        var newIndent = table.leftIndent;\n        var rightColumnCollection = this.getColumnCells(table, this.resizerPosition, false);\n        var offset = 0;\n        var selectedRow = selectedCells[0].ownerRow;\n        var rowFormat = selectedRow.rowFormat;\n        if (rowFormat.beforeWidth > 0) {\n            var newGridBefore = rowFormat.beforeWidth + dragValue;\n            if (newGridBefore > 0) {\n                this.updateGridBefore(selectedRow, dragValue);\n            }\n            else {\n                var leastGridBefore = this.getLeastGridBefore(table, selectedRow);\n                if (newGridBefore < leastGridBefore && offset !== newGridBefore) {\n                    newIndent = table.leftIndent + newGridBefore;\n                    table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                    for (var i = 0; i < table.childWidgets.length; i++) {\n                        var tableRow = table.childWidgets[i];\n                        if (selectedRow !== tableRow) {\n                            this.updateGridBefore(tableRow, -newGridBefore);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            if (dragValue < 0) {\n                newIndent = table.leftIndent + dragValue;\n                table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                this.updateWidthForCells(table, selectedCells, dragValue);\n            }\n            else {\n                var leastGridBefore = this.getLeastGridBefore(table, selectedRow);\n                var currentTableIndent = table.tableFormat.leftIndent;\n                if (currentTableIndent === 0) {\n                    for (var i = 0; i < table.childWidgets.length; i++) {\n                        var tableRow = table.childWidgets[i];\n                        if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                            this.updateGridBefore(tableRow, dragValue);\n                            this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n                        }\n                    }\n                }\n                else {\n                    var difference = leastGridBefore - dragValue;\n                    if (difference > 0) {\n                        newIndent = table.leftIndent + dragValue;\n                        table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        this.updateWidthForCells(table, selectedCells, dragValue);\n                    }\n                    else {\n                        newIndent = table.leftIndent + leastGridBefore;\n                        table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        for (var i = 0; i < table.childWidgets.length; i++) {\n                            var tableRow = table.childWidgets[i];\n                            if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                                this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n                                this.updateGridBefore(tableRow, dragValue - leastGridBefore);\n                            }\n                            else {\n                                this.updateGridBefore(tableRow, -leastGridBefore);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        this.updateGridValue(table, true, dragValue);\n    };\n    TableResizer.prototype.updateWidthForCells = function (table, selectedCells, dragValue) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var tableRow = table.childWidgets[i];\n            if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n            }\n            else {\n                this.updateGridBefore(tableRow, -dragValue);\n            }\n        }\n    };\n    /**\n     * Resize selected cells at last column\n     */\n    TableResizer.prototype.resizeColumnAtLastColumnIndex = function (table, dragValue, containerWidth) {\n        var tableAlignment = table.tableFormat.tableAlignment;\n        var preferredWidth = table.tableFormat.preferredWidth;\n        var hasTableWidth = preferredWidth;\n        var columnIndex = this.resizerPosition;\n        var leftColumn = table.tableHolder.columns[columnIndex - 1];\n        var prevDragValue = 0;\n        while (dragValue !== prevDragValue) {\n            var newWidth = HelperMethods.round(leftColumn.preferredWidth + dragValue, 1);\n            if (newWidth >= leftColumn.minWidth) {\n                leftColumn.preferredWidth = newWidth;\n                prevDragValue = dragValue;\n            }\n            else {\n                prevDragValue = dragValue;\n                dragValue -= newWidth - leftColumn.minWidth;\n            }\n        }\n        this.updateCellPreferredWidths(table);\n        if (hasTableWidth || table.tableHolder.getTotalWidth() > containerWidth) {\n            table.updateWidth(dragValue);\n            table.tableHolder.tableWidth = table.tableHolder.getTotalWidth();\n        }\n        var dragOffset = dragValue;\n        if (tableAlignment === 'Right') {\n            dragOffset = 0;\n        }\n        else if (tableAlignment === 'Center') {\n            dragOffset = dragOffset / 2;\n        }\n        this.updateGridValue(table, true, dragOffset);\n    };\n    /**\n     *  Resize selected cells at middle column\n     */\n    TableResizer.prototype.resizeCellAtMiddle = function (table, dragValue) {\n        var columnIndex = this.resizerPosition;\n        var leftColumn = table.tableHolder.columns[columnIndex - 1];\n        var rightColumn = table.tableHolder.columns[columnIndex];\n        if (dragValue > 0) {\n            var isContinue = true;\n            while (isContinue) {\n                var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                if (newWidth >= rightColumn.minWidth) {\n                    rightColumn.preferredWidth = newWidth;\n                    leftColumn.preferredWidth = leftColumn.preferredWidth + dragValue;\n                    isContinue = false;\n                }\n                else {\n                    dragValue += newWidth - rightColumn.minWidth;\n                }\n            }\n        }\n        else {\n            var isContinue = true;\n            while (isContinue) {\n                var newWidth = HelperMethods.round(leftColumn.preferredWidth + dragValue, 1);\n                if (newWidth >= leftColumn.minWidth) {\n                    leftColumn.preferredWidth = newWidth;\n                    rightColumn.preferredWidth = rightColumn.preferredWidth - dragValue;\n                    isContinue = false;\n                }\n                else {\n                    dragValue -= newWidth - leftColumn.minWidth;\n                }\n            }\n        }\n        // Update the cell widths based on the columns preferred width\n        this.updateCellPreferredWidths(table);\n        // table.tableFormat.AllowAutoFit = false;\n        table.tableHolder.tableWidth = table.tableHolder.getTotalWidth();\n        this.updateGridValue(table, false, dragValue);\n    };\n    TableResizer.prototype.updateGridValue = function (table, isUpdate, dragValue) {\n        if (isUpdate) {\n            table.calculateGrid();\n            table.isGridUpdated = false;\n        }\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.owner.isLayoutEnabled = true;\n        if (table.isInsideTable) {\n            var parentTable = this.viewer.layout.getParentTable(table);\n            this.viewer.layout.reLayoutTable(parentTable); // Need to optmize this.\n        }\n        else {\n            this.viewer.layout.reLayoutTable(table);\n        }\n        this.owner.editor.getOffsetValue(this.viewer.selection);\n        this.owner.editorModule.reLayout(this.owner.selection);\n        if (dragValue) {\n            this.startingPoint.x += HelperMethods.convertPointToPixel(dragValue);\n            this.resizerPosition = this.getCellReSizerPosition(this.startingPoint);\n        }\n    };\n    TableResizer.prototype.getColumnCells = function (table, columnIndex, isLeftSideCollection) {\n        var cells = [];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                if (isLeftSideCollection) {\n                    if (cell.columnIndex + cell.cellFormat.columnSpan === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n                else {\n                    if (cell.columnIndex === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    TableResizer.prototype.updateGridBefore = function (row, offset) {\n        if (row.rowFormat.beforeWidth + offset !== row.rowFormat.beforeWidth) {\n            row.rowFormat.beforeWidth = row.rowFormat.beforeWidth + offset;\n            row.rowFormat.gridBeforeWidth = row.rowFormat.beforeWidth;\n        }\n    };\n    TableResizer.prototype.getLeastGridBefore = function (table, ignoreRow) {\n        var gridBefore = 0;\n        var flag = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row !== ignoreRow) {\n                if (flag === 0) {\n                    gridBefore = row.rowFormat.beforeWidth;\n                    flag++;\n                }\n                if (row.rowFormat.beforeWidth <= gridBefore) {\n                    gridBefore = row.rowFormat.beforeWidth;\n                }\n            }\n        }\n        return gridBefore;\n    };\n    TableResizer.prototype.increaseOrDecreaseWidth = function (cell, dragValue, isIncrease) {\n        var preferredWidth = cell.cellFormat.preferredWidth;\n        if (cell.cellFormat.preferredWidthType === 'Auto') {\n            preferredWidth = cell.cellFormat.cellWidth;\n            cell.cellFormat.preferredWidthType = 'Point';\n        }\n        var minimumWidth = cell.ownerColumn.minWidth;\n        if (cell.cellFormat.preferredWidthType === 'Percent') {\n            minimumWidth = cell.convertPointToPercent(minimumWidth);\n        }\n        // Margins properties usedd for internal purpose.\n        if (isIncrease) {\n            cell.cellFormat.preferredWidth = preferredWidth + dragValue > minimumWidth ? preferredWidth + dragValue : minimumWidth;\n        }\n        else {\n            cell.cellFormat.preferredWidth = preferredWidth - dragValue > minimumWidth ? preferredWidth - dragValue : minimumWidth;\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TableResizer.prototype.changeWidthOfCells = function (table, leftColumnCollection, rightColumnCollection, dragValue, isSelection) {\n        if (leftColumnCollection.length > 0) {\n            var flag = false;\n            for (var i = 0; i < leftColumnCollection.length; i++) {\n                var cell = leftColumnCollection[i];\n                this.increaseOrDecreaseWidth(cell, dragValue, true);\n                if (cell.cellIndex === cell.ownerRow.childWidgets.length - 1) {\n                    flag = true;\n                }\n            }\n            if (flag) {\n                this.updateRowsGridAfterWidth(table);\n            }\n        }\n        if (rightColumnCollection.length > 0) {\n            var diff = 0;\n            for (var i = 0; i < rightColumnCollection.length; i++) {\n                var cell = rightColumnCollection[i];\n                if (cell.cellIndex === 0) {\n                    var newGridBefore = cell.ownerRow.rowFormat.beforeWidth + dragValue;\n                    if (newGridBefore >= 0) {\n                        this.updateGridBefore(cell.ownerRow, dragValue);\n                    }\n                    else {\n                        if (diff !== newGridBefore) {\n                            diff = newGridBefore;\n                        }\n                        cell.ownerRow.rowFormat.gridBeforeWidth = 0;\n                        cell.ownerRow.rowFormat.gridBeforeWidthType = 'Auto';\n                    }\n                }\n                this.increaseOrDecreaseWidth(cell, dragValue, false);\n            }\n            if (diff !== 0) {\n                var newIndent = table.leftIndent + diff;\n                table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                for (var j = 0; j < table.childWidgets.length; j++) {\n                    var row = table.childWidgets[j];\n                    if (rightColumnCollection.indexOf(row.childWidgets[0]) === -1) {\n                        this.updateGridBefore(row, diff > 0 ? diff : -diff);\n                    }\n                }\n            }\n        }\n    };\n    TableResizer.prototype.updateRowsGridAfterWidth = function (table) {\n        var maxRowWidth = this.getMaxRowWidth(table, true);\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var currentRowWidth = this.getRowWidth(row, true);\n            if (maxRowWidth >= currentRowWidth && row.rowFormat.afterWidth !== maxRowWidth - currentRowWidth) {\n                var value = maxRowWidth - currentRowWidth;\n                row.rowFormat.gridAfterWidth = value;\n                row.rowFormat.afterWidth = value;\n            }\n        }\n    };\n    TableResizer.prototype.getRowWidth = function (row, toUpdateGridAfter) {\n        var rowWidth = 0;\n        if (toUpdateGridAfter) {\n            rowWidth = rowWidth + row.rowFormat.beforeWidth;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            rowWidth += cell.cellFormat.cellWidth;\n        }\n        return rowWidth;\n    };\n    TableResizer.prototype.getMaxRowWidth = function (table, toUpdateGridAfter) {\n        var width = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowWidth = 0;\n            if (toUpdateGridAfter) {\n                rowWidth = rowWidth + row.rowFormat.beforeWidth;\n            }\n            for (var i_1 = 0; i_1 < row.childWidgets.length; i_1++) {\n                var cell = row.childWidgets[i_1];\n                rowWidth += cell.cellFormat.cellWidth;\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    TableResizer.prototype.isColumnSelected = function (table, columnIndex) {\n        var selection = this.owner.selection;\n        var selectedCells = selection.getSelectedCells();\n        var leftColumnCells = this.getColumnCells(table, columnIndex, true);\n        var rightColumnCells = this.getColumnCells(table, columnIndex, false);\n        var isColumnSelected = false;\n        for (var i = 0; i < leftColumnCells.length; i++) {\n            var columnCell = leftColumnCells[i];\n            isColumnSelected = selectedCells.indexOf(columnCell) !== -1 ? true : false;\n        }\n        if (!isColumnSelected) {\n            for (var i = 0; i < rightColumnCells.length; i++) {\n                var columnCell = rightColumnCells[i];\n                isColumnSelected = selectedCells.indexOf(columnCell) !== -1 ? true : false;\n            }\n        }\n        return isColumnSelected;\n    };\n    TableResizer.prototype.applyProperties = function (table, tableHistoryInfo) {\n        if (isNullOrUndefined(tableHistoryInfo)) {\n            return;\n        }\n        table = table;\n        // PreserveGrid = true;\n        if (tableHistoryInfo.tableHolder) {\n            table.tableHolder = tableHistoryInfo.tableHolder.clone();\n        }\n        if (tableHistoryInfo.tableFormat !== null) {\n            table.tableFormat.leftIndent = tableHistoryInfo.tableFormat.leftIndent;\n            table.tableFormat.preferredWidth = tableHistoryInfo.tableFormat.preferredWidth;\n            table.tableFormat.preferredWidthType = tableHistoryInfo.tableFormat.preferredWidthType;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowFormat = tableHistoryInfo.rows[i];\n            row.rowFormat.gridBefore = rowFormat.gridBefore;\n            row.rowFormat.gridBeforeWidth = rowFormat.gridBeforeWidth;\n            row.rowFormat.gridBeforeWidthType = rowFormat.gridBeforeWidthType;\n            row.rowFormat.gridAfter = rowFormat.gridAfter;\n            row.rowFormat.gridAfterWidth = rowFormat.gridAfterWidth;\n            row.rowFormat.gridAfterWidthType = rowFormat.gridAfterWidthType;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellFormat = rowFormat.cells[j];\n                cell.columnIndex = cellFormat.columnIndex;\n                cell.cellFormat.columnSpan = cellFormat.columnSpan;\n                cell.cellFormat.preferredWidth = cellFormat.preferredWidth;\n                cell.cellFormat.preferredWidthType = cellFormat.preferredWidthType;\n            }\n        }\n        var containerWidth = table.getOwnerWidth(true);\n        var tableWidth = table.getTableClientWidth(containerWidth);\n        //Sets the width to cells\n        table.setWidthToCells(tableWidth, table.tableFormat.preferredWidthType === 'Auto');\n        // PreserveGrid = false;\n    };\n    /**\n     * Return table row width\n     */\n    TableResizer.prototype.getActualWidth = function (row) {\n        var width = 0;\n        if (row.childWidgets.length > 0) {\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                width += row.childWidgets[i].cellFormat.cellWidth;\n            }\n        }\n        return width;\n    };\n    TableResizer.prototype.setPreferredWidth = function (table) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var rw = table.childWidgets[i];\n            var rowFormat = rw.rowFormat;\n            if (rowFormat.gridBefore > 0) {\n                rowFormat.gridBeforeWidth = rowFormat.beforeWidth;\n                rowFormat.gridBeforeWidthType = 'Point';\n            }\n            for (var j = 0; j < rw.childWidgets.length; j++) {\n                var cell = rw.childWidgets[j];\n                cell.cellFormat.preferredWidth = cell.cellFormat.cellWidth;\n                cell.cellFormat.preferredWidthType = 'Point';\n            }\n            if (rowFormat.gridAfter > 0) {\n                rowFormat.gridAfterWidth = rowFormat.afterWidth;\n                rowFormat.gridAfterWidthType = 'Point';\n            }\n        }\n    };\n    TableResizer.prototype.updateCellPreferredWidths = function (table) {\n        var tableWidth = table.tableHolder.tableWidth;\n        var isAutoFit = table.tableFormat.preferredWidthType === 'Auto';\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.rowFormat.gridBefore > 0) {\n                var width = table.tableHolder.getCellWidth(0, row.rowFormat.gridBefore, tableWidth, isAutoFit);\n                this.updateGridBeforeWidth(width, row);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                cell.updateWidth(table.tableHolder.getCellWidth(cell.columnIndex, cell.cellFormat.columnSpan, tableWidth, isAutoFit));\n            }\n            if (row.rowFormat.gridAfter > 0) {\n                // tslint:disable-next-line:max-line-length\n                this.updateGridAfterWidth(table.tableHolder.getCellWidth(row.childWidgets.length, row.rowFormat.gridAfter, tableWidth, isAutoFit), row);\n            }\n        }\n    };\n    /**\n     * Update grid before width value\n     */\n    TableResizer.prototype.updateGridBeforeWidth = function (width, row) {\n        var rowFormat = row.rowFormat;\n        if (width !== rowFormat.beforeWidth) {\n            rowFormat.beforeWidth = width;\n            if (rowFormat.gridBeforeWidthType === 'Auto') {\n                rowFormat.gridBeforeWidthType = 'Point';\n            }\n            if (rowFormat.gridBeforeWidthType === 'Point') {\n                rowFormat.gridBeforeWidth = rowFormat.beforeWidth;\n            }\n            else {\n                // The value is calculated from the pixel values hence, its converted to percent using method. \n                var ownerWidth = row.ownerTable.getTableClientWidth(row.ownerTable.getOwnerWidth(true));\n                var value = row.ownerTable.convertPointToPercent(rowFormat.beforeWidth, ownerWidth);\n                rowFormat.gridBeforeWidth = value;\n            }\n        }\n    };\n    /**\n     * Update grid after width value\n     */\n    TableResizer.prototype.updateGridAfterWidth = function (width, row) {\n        var rowFormat = row.rowFormat;\n        if (width !== rowFormat.afterWidth) {\n            rowFormat.afterWidth = width;\n        }\n        if (rowFormat.gridAfterWidthType === 'Auto') {\n            rowFormat.gridAfterWidthType = 'Point';\n        }\n        if (rowFormat.gridAfterWidthType === 'Point') {\n            rowFormat.gridAfterWidth = rowFormat.afterWidth;\n        }\n        else {\n            // The value is calculated from the pixel values hence, its converted to percent using method. \n            var ownerWidth = row.ownerTable.getTableClientWidth(row.ownerTable.getOwnerWidth(true));\n            var value = row.ownerTable.convertPointToPercent(rowFormat.afterWidth, ownerWidth);\n            rowFormat.gridAfterWidth = value;\n        }\n    };\n    return TableResizer;\n}());\nexport { TableResizer };\n","import { TextPosition, ImageFormat } from '../selection/selection-helper';\nimport { ParagraphWidget, LineWidget, ElementBox, TextElementBox, Margin, ImageElementBox, BlockWidget, BlockContainer, BodyWidget, TableWidget, TableCellWidget, TableRowWidget, Widget, ListTextElementBox, BookmarkElementBox, HeaderFooterWidget, FieldTextElementBox, TabElementBox } from '../viewer/page';\nimport { WCharacterFormat } from '../format/character-format';\nimport { HelperMethods } from './editor-helper';\nimport { isNullOrUndefined, Browser, classList } from '@syncfusion/ej2-base';\nimport { WParagraphFormat, WSectionFormat, WListFormat, WTableFormat, WRowFormat, WCellFormat, WBorder, WBorders, WTabStop } from '../index';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { WLevelOverride } from '../list/level-override';\nimport { FieldElementBox } from '../viewer/page';\nimport { WCharacterStyle } from '../format/style';\nimport { TableResizer } from './table-resizer';\nimport { WParagraphStyle } from '../format/style';\n/**\n * Editor module\n */\nvar Editor = /** @class */ (function () {\n    /**\n     * Initialize the editor module\n     * @param  {LayoutViewer} viewer\n     * @private\n     */\n    function Editor(viewer) {\n        var _this = this;\n        this.nodes = [];\n        this.editHyperlinkInternal = false;\n        this.startParagraph = undefined;\n        this.endParagraph = undefined;\n        /**\n         * @private\n         */\n        this.isHandledComplex = false;\n        /**\n         * @private\n         */\n        this.tableResize = undefined;\n        /**\n         * @private\n         */\n        this.tocStyles = {};\n        this.refListNumber = undefined;\n        this.incrementListNumber = -1;\n        this.removedBookmarkElements = [];\n        /**\n         * @private\n         */\n        this.tocBookmarkId = 0;\n        /**\n         * @private\n         */\n        this.copiedData = undefined;\n        this.pageRefFields = {};\n        /**\n         * @private\n         */\n        this.isInsertingTOC = false;\n        /**\n         * @private\n         */\n        this.isBordersAndShadingDialog = false;\n        /**\n         * @private\n         */\n        this.onTextInputInternal = function (event) {\n            if (Browser.isDevice) {\n                var viewer = _this.viewer;\n                var nbsp = new RegExp(String.fromCharCode(160), 'g');\n                var lineFeed = new RegExp(String.fromCharCode(10), 'g');\n                viewer.prefix = viewer.prefix.replace(nbsp, ' ').replace(lineFeed, ' ');\n                var text = viewer.editableDiv.textContent.replace(nbsp, ' ').replace(lineFeed, ' ');\n                var textBoxText = text.substring(2);\n                if (viewer.isCompositionStart && viewer.isCompositionUpdated) {\n                    viewer.isCompositionUpdated = false;\n                    if (!viewer.owner.isReadOnlyMode && viewer.owner.isDocumentLoaded) {\n                        if (viewer.prefix.substring(2) !== textBoxText) {\n                            if (_this.selection.isEmpty) {\n                                // tslint:disable-next-line:max-line-length\n                                _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                                _this.handleTextInput(textBoxText);\n                                viewer.prefix = '@' + String.fromCharCode(160) + textBoxText;\n                            }\n                            else {\n                                _this.handleTextInput(textBoxText);\n                                viewer.prefix = '@' + String.fromCharCode(160) + textBoxText;\n                            }\n                        }\n                    }\n                    return;\n                }\n                else if (viewer.isCompositionStart && viewer.isCompositionEnd && viewer.suffix === '') {\n                    if (viewer.prefix.substring(2) !== textBoxText) {\n                        if (_this.selection.isEmpty && viewer.isCompositionStart) {\n                            viewer.isCompositionStart = false;\n                            // tslint:disable-next-line:max-line-length\n                            _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - viewer.prefix.substring(2).length);\n                            _this.selection.retrieveCurrentFormatProperties();\n                            if (viewer.suffix === '' || textBoxText === '') {\n                                _this.handleTextInput(textBoxText);\n                            }\n                        }\n                        else if (!_this.selection.isEmpty) {\n                            viewer.isCompositionStart = false;\n                            _this.handleTextInput(textBoxText);\n                        }\n                    }\n                    else if (textBoxText === '') {\n                        viewer.isCompositionStart = false;\n                        _this.handleBackKey();\n                    }\n                    else if (viewer.prefix.substring(2) === textBoxText && viewer.suffix === '') {\n                        viewer.isCompositionStart = false;\n                        _this.handleTextInput(' ');\n                    }\n                    viewer.isCompositionEnd = false;\n                    return;\n                }\n                else if (viewer.isCompositionEnd || viewer.isCompositionStart && !viewer.isCompositionUpdated) {\n                    if (textBoxText.length < viewer.prefix.length &&\n                        textBoxText === viewer.prefix.substring(2, viewer.prefix.length - 1) || viewer.editableDiv.innerText.length < 2) {\n                        _this.handleBackKey();\n                        return;\n                    }\n                    else if (viewer.suffix !== '' &&\n                        viewer.editableDiv.innerText[viewer.editableDiv.innerText.length - 1] !== String.fromCharCode(160)) {\n                        viewer.isCompositionStart = false;\n                        //When cursor is placed in between a word and chosen a word from predicted words.\n                        // tslint:disable-next-line:max-line-length\n                        _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                        _this.selection.end.setPositionForLineWidget(viewer.selection.end.currentWidget, _this.selection.end.offset + viewer.suffix.length);\n                        //Retrieve the character format properties. Since the selection was changed manually.\n                        _this.selection.retrieveCurrentFormatProperties();\n                        _this.handleTextInput(textBoxText);\n                        return;\n                    }\n                }\n                // tslint:disable-next-line:max-line-length\n                if (text !== '\\r' && text !== '\\b' && text !== '\\u001B' && !viewer.owner.isReadOnlyMode && viewer.isControlPressed === false) {\n                    if (text === '@' || text[0] !== '@' || text === '' || text.length < viewer.prefix.length &&\n                        textBoxText === viewer.prefix.substring(2, viewer.prefix.length - 1)) {\n                        _this.handleBackKey();\n                        if (viewer.editableDiv.innerText.length < 2) {\n                            _this.predictText();\n                        }\n                    }\n                    else if (text.indexOf(viewer.prefix) === 0 && text.length > viewer.prefix.length) {\n                        _this.handleTextInput(text.substring(viewer.prefix.length));\n                    }\n                    else if (text.indexOf(viewer.prefix) === -1 && text[text.length - 1] !== String.fromCharCode(160)\n                        && text[text.length - 1] !== ' ') {\n                        if ((textBoxText.charAt(0).toLowerCase() + textBoxText.slice(1)) === viewer.prefix.substring(2)) {\n                            // tslint:disable-next-line:max-line-length\n                            _this.selection.start.setPositionParagraph(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                        }\n                        _this.handleTextInput(textBoxText);\n                    }\n                    else if (text.length !== 2) {\n                        _this.handleTextInput(' ');\n                    }\n                }\n            }\n            else {\n                var text = _this.viewer.editableDiv.innerText;\n                if (text !== String.fromCharCode(160)) {\n                    // tslint:disable-next-line:max-line-length\n                    if (text !== '\\r' && text !== '\\b' && text !== '\\u001B' && !_this.owner.isReadOnlyMode && _this.viewer.isControlPressed === false) {\n                        _this.handleTextInput(text);\n                    }\n                }\n                else {\n                    _this.handleTextInput(' ');\n                }\n                _this.viewer.editableDiv.innerText = '';\n            }\n        };\n        /**\n         * Fired on paste.\n         * @param {ClipboardEvent} event\n         * @private\n         */\n        this.onPaste = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.pasteInternal(event);\n            }\n            event.preventDefault();\n        };\n        this.viewer = viewer;\n        this.tableResize = new TableResizer(this.viewer.owner);\n    }\n    Object.defineProperty(Editor.prototype, \"editorHistory\", {\n        get: function () {\n            return this.viewer.owner.editorHistory;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"selection\", {\n        get: function () {\n            if (this.viewer) {\n                return this.viewer.selection;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"owner\", {\n        get: function () {\n            return this.viewer.owner;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Editor.prototype.getModuleName = function () {\n        return 'Editor';\n    };\n    Editor.prototype.insertField = function (code, result) {\n        var fieldCode = code;\n        if (isNullOrUndefined(result)) {\n            fieldCode = HelperMethods.trimStart(fieldCode);\n            if (fieldCode.substring(0, 10) === 'MERGEFIELD') {\n                fieldCode = fieldCode.substring(10).trim();\n                var index = fieldCode.indexOf('\\\\*');\n                result = '«' + fieldCode.substring(0, index).trim() + '»';\n            }\n        }\n        var paragraph = new ParagraphWidget();\n        var line = new LineWidget(paragraph);\n        var fieldBegin = new FieldElementBox(0);\n        line.children.push(fieldBegin);\n        var fieldCodeSpan = new TextElementBox();\n        fieldCodeSpan.text = code;\n        line.children.push(fieldCodeSpan);\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldBegin.fieldSeparator = fieldSeparator;\n        line.children.push(fieldSeparator);\n        var fieldResultSpan = new TextElementBox();\n        fieldResultSpan.text = result;\n        line.children.push(fieldResultSpan);\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldSeparator = fieldSeparator;\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldBegin.fieldEnd = fieldEnd;\n        fieldSeparator.fieldEnd = fieldEnd;\n        line.children.push(fieldEnd);\n        fieldBegin.line = line;\n        paragraph.childWidgets.push(line);\n        this.viewer.fields.push(fieldBegin);\n        var widgets = [];\n        widgets.push(paragraph);\n        this.pasteContentsInternal(widgets);\n    };\n    /**\n     * To update style for paragraph\n     * @param style - style name\n     * @param clearDirectFormatting - Removes manual formatting (formatting not applied using a style)\n     * from the selected text, to match the formatting of the applied style. Default value is false.\n     */\n    Editor.prototype.applyStyle = function (style, clearDirectFormatting) {\n        clearDirectFormatting = isNullOrUndefined(clearDirectFormatting) ? false : clearDirectFormatting;\n        if (clearDirectFormatting) {\n            this.initComplexHistory('ApplyStyle');\n            this.clearFormatting();\n        }\n        var styleObj = this.viewer.styles.findByName(style);\n        if (styleObj !== undefined) {\n            this.onApplyParagraphFormat('styleName', styleObj, false, true);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), JSON.parse(this.viewer.preDefinedStyles.get(style)), this.viewer.styles);\n            this.applyStyle(style);\n        }\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo && this.editorHistory.currentHistoryInfo.action === 'ApplyStyle') {\n            this.editorHistory.updateComplexHistory();\n        }\n    };\n    // Public Implementation Starts\n    /**\n     * Moves the selected content in the document editor control to clipboard.\n     */\n    Editor.prototype.cut = function () {\n        if (this.owner.isReadOnlyMode || this.selection.isEmpty) {\n            return;\n        }\n        this.selection.copySelectedContent(true);\n    };\n    /**\n     * Notify content change event\n     * @private\n     */\n    Editor.prototype.fireContentChange = function () {\n        if (this.viewer.owner.isLayoutEnabled && !this.viewer.owner.isShiftingEnabled) {\n            this.viewer.owner.fireContentChange();\n        }\n    };\n    /**\n     * Update physical location for text position\n     * @private\n     */\n    Editor.prototype.updateSelectionTextPosition = function (isSelectionChanged) {\n        this.getOffsetValue(this.selection);\n        this.selection.start.updatePhysicalPosition(true);\n        if (this.selection.isEmpty) {\n            this.selection.end.setPositionInternal(this.selection.start);\n        }\n        else {\n            this.selection.end.updatePhysicalPosition(true);\n        }\n        this.selection.upDownSelectionLength = this.selection.end.location.x;\n        this.selection.fireSelectionChanged(isSelectionChanged);\n    };\n    /**\n     * Predict text\n     * @private\n     */\n    Editor.prototype.predictText = function () {\n        this.viewer.suffix = '';\n        if (this.selection.start.paragraph.isEmpty() || this.selection.start.offset === 0 &&\n            this.selection.start.currentWidget.isFirstLine() || this.selection.end.offset === 0 &&\n            this.selection.end.currentWidget.isFirstLine()) {\n            this.viewer.prefix = '';\n        }\n        else {\n            this.getPrefixAndSuffix();\n        }\n        this.viewer.prefix = '@' + String.fromCharCode(160) + this.viewer.prefix; // &nbsp;\n        this.viewer.editableDiv.innerText = this.viewer.prefix;\n        this.viewer.selection.setEditableDivCaretPosition(this.viewer.prefix.length);\n    };\n    /**\n     * Gets prefix and suffix.\n     * @private\n     */\n    /* tslint:disable:max-func-body-length */\n    Editor.prototype.getPrefixAndSuffix = function () {\n        var viewer = this.viewer;\n        if (this.selection.text !== '') {\n            viewer.prefix = '';\n            return;\n        }\n        else {\n            var startIndex = 0;\n            var inlineInfo = this.selection.start.currentWidget.getInline(this.selection.start.offset, startIndex);\n            var inline = inlineInfo.element;\n            startIndex = inlineInfo.index;\n            if (inline !== undefined) {\n                var boxInfo = this.selection.getElementBoxInternal(inline, startIndex);\n                var box = boxInfo.element;\n                startIndex = boxInfo.index;\n                var spaceIndex = 0;\n                if (!isNullOrUndefined(box)) {\n                    var prefixAdded = false;\n                    if (box instanceof TextElementBox && startIndex > 0 && box.line.isFirstLine()) {\n                        viewer.prefix = '';\n                    }\n                    if (!(inline instanceof TextElementBox)) {\n                        inline = this.selection.getPreviousTextElement(inline);\n                    }\n                    /* tslint:disable:no-conditional-assignment */\n                    while ((spaceIndex = viewer.prefix.lastIndexOf(' ')) < 0 && inline instanceof TextElementBox) {\n                        if (inline.previousNode instanceof TextElementBox && viewer.prefix.indexOf(' ') === -1) {\n                            if (!prefixAdded) {\n                                viewer.prefix = inline.text.substring(0, startIndex);\n                                prefixAdded = true;\n                            }\n                            else {\n                                viewer.prefix = inline.text + viewer.prefix;\n                            }\n                            inline = inline.previousNode;\n                            // If the line has no elements then break the loop to avoid the exception.\n                            if (inline instanceof ListTextElementBox) {\n                                break;\n                            }\n                            if (!(inline instanceof TextElementBox)) {\n                                inline = this.selection.getPreviousTextElement(inline);\n                            }\n                        }\n                        else if (!(inline.previousNode instanceof TextElementBox)) {\n                            if (!prefixAdded) {\n                                viewer.prefix = inline.text.substring(0, startIndex);\n                                prefixAdded = true;\n                            }\n                            else {\n                                viewer.prefix = inline.text + viewer.prefix;\n                            }\n                            break;\n                        }\n                    }\n                    if (!(viewer.prefix.length > 1 && viewer.prefix[viewer.prefix.length - 1] === ' ' &&\n                        viewer.prefix[viewer.prefix.length - 2] === '.')) {\n                        spaceIndex = viewer.prefix.lastIndexOf(' ');\n                    }\n                    else {\n                        spaceIndex = -1;\n                        viewer.prefix = '';\n                    }\n                    viewer.prefix = spaceIndex < 0 ? viewer.prefix : viewer.prefix.substring(spaceIndex);\n                    if (viewer.prefix.indexOf(' ') === 0 && viewer.prefix.length >= 1) {\n                        viewer.prefix = viewer.prefix.substring(1);\n                    }\n                    // suffix text prediction\n                    var endIndex = 0;\n                    var endInlineInfo = this.selection.end.currentWidget.getInline(this.selection.end.offset, endIndex);\n                    var endInline = endInlineInfo.element;\n                    endIndex = endInlineInfo.index;\n                    boxInfo = this.selection.getElementBoxInternal(endInline, endIndex);\n                    box = boxInfo.element;\n                    endIndex = boxInfo.index;\n                    if (box) {\n                        var suffixAdded = false;\n                        if (box instanceof TextElementBox && endIndex < box.length) {\n                            viewer.suffix = '';\n                        }\n                        // boxIndex = renderedElements.get(endInline).indexOf(box);\n                        while ((spaceIndex = viewer.suffix.indexOf(' ')) < 0 && endInline instanceof TextElementBox) {\n                            if (endInline.nextNode instanceof TextElementBox && viewer.suffix.indexOf(' ') === -1) {\n                                if (!suffixAdded) {\n                                    viewer.suffix = box.text.substring(endIndex);\n                                    suffixAdded = true;\n                                }\n                                else {\n                                    viewer.suffix = viewer.suffix + endInline.text;\n                                }\n                                endInline = endInline.nextNode;\n                            }\n                            else if (!(endInline.nextNode instanceof TextElementBox)) {\n                                if (!suffixAdded) {\n                                    viewer.suffix = box.text.substring(endIndex);\n                                    suffixAdded = true;\n                                }\n                                else {\n                                    viewer.suffix = viewer.suffix + endInline.text;\n                                }\n                                break;\n                            }\n                        }\n                        spaceIndex = viewer.suffix.indexOf(' ');\n                        viewer.suffix = spaceIndex < 0 ? viewer.suffix : viewer.suffix.substring(0, spaceIndex);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * key action\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Editor.prototype.onKeyDownInternal = function (event, ctrl, shift, alt) {\n        var key = event.which || event.keyCode;\n        if (ctrl && !shift && !alt) {\n            this.viewer.isControlPressed = true;\n            switch (key) {\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(false, false);\n                    }\n                    break;\n                case 13:\n                    event.preventDefault();\n                    this.insertPageBreak();\n                    break;\n                case 48:\n                    event.preventDefault();\n                    this.onApplyParagraphFormat('beforeSpacing', 0, false, false);\n                    break;\n                case 49:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 1, false, false);\n                    }\n                    break;\n                case 50:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 2, false, false);\n                    }\n                    break;\n                case 53:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 1.5, false, false);\n                    }\n                    break;\n                case 66:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBold();\n                    }\n                    break;\n                case 68:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode && this.owner.fontDialogModule) {\n                        this.owner.fontDialogModule.showFontDialog();\n                    }\n                    break;\n                case 69:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Center');\n                    }\n                    event.preventDefault();\n                    break;\n                case 72:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnly && this.owner.optionsPaneModule) {\n                        this.owner.optionsPaneModule.isReplace = true;\n                        this.owner.optionsPaneModule.showHideOptionsPane(true);\n                    }\n                    break;\n                case 73:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleItalic();\n                    }\n                    break;\n                case 74:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Justify');\n                    }\n                    event.preventDefault();\n                    break;\n                case 75:\n                    event.preventDefault();\n                    if (this.owner.hyperlinkDialogModule && !this.owner.isReadOnlyMode) {\n                        this.owner.hyperlinkDialogModule.show();\n                    }\n                    break;\n                case 76:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Left');\n                    }\n                    event.preventDefault();\n                    break;\n                case 77:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.increaseIndent();\n                    }\n                    event.preventDefault();\n                    break;\n                case 78:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.openBlank();\n                    }\n                    break;\n                case 82:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Right');\n                    }\n                    event.preventDefault();\n                    break;\n                case 85:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.toggleUnderline('Single');\n                    }\n                    break;\n                case 88:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.editor.cut();\n                    }\n                    break;\n                case 89:\n                    if (this.owner.enableEditorHistory) {\n                        this.editorHistory.redo();\n                        event.preventDefault();\n                    }\n                    break;\n                case 90:\n                    if (this.owner.enableEditorHistory) {\n                        this.editorHistory.undo();\n                        event.preventDefault();\n                    }\n                    break;\n                case 219:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'decrement', true);\n                    }\n                    break;\n                case 221:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'increment', true);\n                    }\n                    break;\n                case 187:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBaselineAlignment('Subscript');\n                    }\n                    break;\n            }\n        }\n        else if (shift && !ctrl && !alt) {\n            switch (key) {\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(false, true);\n                    }\n                    break;\n                case 13:\n                    this.handleShiftEnter();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        else if (shift && ctrl && !alt) {\n            switch (key) {\n                case 68:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.toggleUnderline('Double');\n                    }\n                    break;\n                case 77:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.decreaseIndent();\n                    }\n                    event.preventDefault();\n                    break;\n                case 188:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'decrement', true);\n                    }\n                    break;\n                case 190:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'increment', true);\n                    }\n                    break;\n                case 187:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBaselineAlignment('Superscript');\n                    }\n            }\n        }\n        else if (!shift && ctrl && alt) {\n            switch (key) {\n                case 72:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode && this.owner.isDocumentLoaded) {\n                        this.toggleHighlightColor();\n                    }\n                    break;\n            }\n        }\n        else {\n            switch (key) {\n                case 8:\n                    event.preventDefault();\n                    this.handleBackKey();\n                    break;\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(true, false);\n                    }\n                    break;\n                case 13:\n                    event.preventDefault();\n                    this.handleEnterKey();\n                    break;\n                case 46:\n                    this.handleDelete();\n                    event.preventDefault();\n                    break;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.handleShiftEnter = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.handleTextInput('\\v');\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles back key.\n     * @private\n     */\n    Editor.prototype.handleBackKey = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onBackSpace();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles delete\n     * @private\n     */\n    Editor.prototype.handleDelete = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onDelete();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles enter key.\n     * @private\n     */\n    Editor.prototype.handleEnterKey = function () {\n        if (!this.owner.isReadOnlyMode) {\n            if (Browser.isDevice) {\n                this.viewer.isCompositionStart = false;\n            }\n            this.owner.editorModule.onEnter();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.handleTextInput = function (text) {\n        var _this = this;\n        if (!this.owner.isReadOnlyMode) {\n            if (this.animationTimer) {\n                clearTimeout(this.animationTimer);\n            }\n            classList(this.selection.caret, [], ['e-de-cursor-animation']);\n            this.owner.editorModule.insertText(text, false);\n            /* tslint:disable:align */\n            this.animationTimer = setTimeout(function () {\n                if (_this.animationTimer) {\n                    clearTimeout(_this.animationTimer);\n                }\n                if (_this.selection && _this.selection.caret) {\n                    classList(_this.selection.caret, ['e-de-cursor-animation'], []);\n                }\n            }, 600);\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Copies to format.\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    Editor.prototype.copyInsertFormat = function (format, copy) {\n        var insertFormat = new WCharacterFormat();\n        var sFormat = this.selection.characterFormat;\n        if (copy) {\n            insertFormat.copyFormat(format);\n        }\n        if (!isNullOrUndefined(sFormat.bold) && format.bold !== sFormat.bold) {\n            insertFormat.bold = sFormat.bold;\n        }\n        if (!isNullOrUndefined(sFormat.italic) && format.italic !== sFormat.italic) {\n            insertFormat.italic = sFormat.italic;\n        }\n        if (sFormat.fontSize > 0 && format.fontSize !== sFormat.fontSize) {\n            insertFormat.fontSize = sFormat.fontSize;\n        }\n        if (!isNullOrUndefined(sFormat.fontFamily) && format.fontFamily !== sFormat.fontFamily) {\n            insertFormat.fontFamily = sFormat.fontFamily;\n        }\n        if (!isNullOrUndefined(sFormat.highlightColor) && format.highlightColor !== sFormat.highlightColor) {\n            insertFormat.highlightColor = sFormat.highlightColor;\n        }\n        if (!isNullOrUndefined(sFormat.baselineAlignment) && format.baselineAlignment !== sFormat.baselineAlignment) {\n            insertFormat.baselineAlignment = sFormat.baselineAlignment;\n        }\n        if (!isNullOrUndefined(sFormat.fontColor) && format.fontColor !== sFormat.fontColor) {\n            insertFormat.fontColor = sFormat.fontColor;\n        }\n        if (!isNullOrUndefined(sFormat.underline) && format.underline !== sFormat.underline) {\n            insertFormat.underline = sFormat.underline;\n        }\n        if (!isNullOrUndefined(sFormat.strikethrough) && format.strikethrough !== sFormat.strikethrough) {\n            insertFormat.strikethrough = sFormat.strikethrough;\n        }\n        return insertFormat;\n    };\n    /**\n     * Inserts the specified text at cursor position\n     * @param  {string} text\n     * @param  {boolean} isReplace\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    Editor.prototype.insertText = function (text, isReplace) {\n        var selection = this.viewer.selection;\n        var insertPosition;\n        var isRemoved = true;\n        this.isListTextSelected();\n        this.initHistory('Insert');\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        this.viewer.selection.editPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        if ((!selection.isEmpty && !this.viewer.selection.isImageSelected) ||\n            this.viewer.isListTextSelected && selection.contextType === 'List') {\n            selection.isSkipLayouting = true;\n            selection.skipFormatRetrieval = true;\n            isRemoved = this.removeSelectedContents(selection);\n            selection.skipFormatRetrieval = false;\n            selection.isSkipLayouting = false;\n        }\n        paragraphInfo = this.getParagraphInfo(selection.start);\n        if (isRemoved) {\n            selection.owner.isShiftingEnabled = true;\n            this.updateInsertPosition();\n            insertPosition = selection.start;\n            if (insertPosition.paragraph.isEmpty()) {\n                var span = new TextElementBox();\n                var insertFormat = this.copyInsertFormat(insertPosition.paragraph.characterFormat, true);\n                span.characterFormat.copyFormat(insertFormat);\n                span.text = text;\n                span.line = insertPosition.paragraph.childWidgets[0];\n                span.margin = new Margin(0, 0, 0, 0);\n                span.line.children.push(span);\n                if ((insertPosition.paragraph.paragraphFormat.textAlignment === 'Center'\n                    || insertPosition.paragraph.paragraphFormat.textAlignment === 'Right') &&\n                    insertPosition.paragraph.paragraphFormat.listFormat.listId === -1) {\n                    insertPosition.paragraph.x = this.viewer.clientActiveArea.x;\n                }\n                this.viewer.layout.reLayoutParagraph(insertPosition.paragraph, 0, 0);\n            }\n            else {\n                var indexInInline = 0;\n                var inlineObj = insertPosition.currentWidget.getInline(insertPosition.offset, indexInInline);\n                var inline = inlineObj.element;\n                indexInInline = inlineObj.index;\n                // Todo: compare selection format\n                var insertFormat = this.copyInsertFormat(inline.characterFormat, true);\n                if (insertFormat.isSameFormat(inline.characterFormat)) {\n                    this.insertTextInline(inline, selection, text, indexInInline);\n                }\n                else {\n                    var tempSpan = new TextElementBox();\n                    tempSpan.text = text;\n                    tempSpan.line = inline.line;\n                    tempSpan.characterFormat.copyFormat(insertFormat);\n                    var insertIndex = inline.indexInOwner;\n                    if (indexInInline === inline.length) {\n                        inline.line.children.splice(insertIndex + 1, 0, tempSpan);\n                    }\n                    else if (indexInInline === 0) {\n                        inline.line.children.splice(insertIndex, 0, tempSpan);\n                    }\n                    else {\n                        if (inline instanceof TextElementBox) {\n                            var splittedSpan = new TextElementBox();\n                            splittedSpan.line = inline.line;\n                            splittedSpan.characterFormat.copyFormat(inline.characterFormat);\n                            splittedSpan.text = inline.text.substring(indexInInline);\n                            inline.text = inline.text.slice(0, indexInInline);\n                            inline.line.children.splice(insertIndex + 1, 0, splittedSpan);\n                        }\n                        inline.line.children.splice(insertIndex + 1, 0, tempSpan);\n                    }\n                    this.viewer.layout.reLayoutParagraph(insertPosition.paragraph, inline.line.indexInOwner, 0);\n                }\n            }\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + text.length, true);\n            this.updateEndPosition();\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(this.editorHistory) && !isNullOrUndefined(this.editorHistory.currentHistoryInfo) && (this.editorHistory.currentHistoryInfo.action === 'ListSelect') &&\n                this.viewer.isListTextSelected) {\n                this.editorHistory.updateHistory();\n                this.editorHistory.updateComplexHistory();\n            }\n            // if (!isNullOrUndefined(selection.currentHistoryInfo) && (selection.currentHistoryInfo.action === 'MultiSelection')) {\n            //     this.updateComplexHistory();\n            // } else {           \n            this.reLayout(selection);\n            // }\n        }\n        else {\n            // selection.selectContent(selection.start, true);\n        }\n        // insertFormat.destroy();\n        if (!isReplace && isRemoved && (text === ' ' || text === '\\t' || text === '\\v')) {\n            var hyperlinkField = selection.getHyperlinkField();\n            var isSelectionOnHyperlink = !isNullOrUndefined(hyperlinkField);\n            var isList = false;\n            if (!(text === '\\v')) {\n                isList = this.checkAndConvertList(selection, text === '\\t');\n            }\n            if (isSelectionOnHyperlink) {\n                return;\n            }\n            if (!isList) {\n                //Checks if the previous text is URL, then it is auto formatted to hyperlink.\n                this.checkAndConvertToHyperlink(selection, false);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertIMEText = function (text, isUpdate) {\n        if (this.viewer.lastComposedText === text && isUpdate) {\n            return;\n        }\n        // Clone selection start position\n        var paragraphInfo = this.getParagraphInfo(this.selection.start);\n        var startPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        // Insert IME text in current selection\n        this.insertText(text, false);\n        this.viewer.lastComposedText = text;\n        // update selection start\n        var start = this.selection.start;\n        this.setPositionForCurrentIndex(start, startPosition);\n        // Update selection end\n        var endPosition = new TextPosition(this.owner);\n        endPosition.setPositionForLineWidget(start.currentWidget, start.offset + text.length);\n        this.selection.selectPosition(isUpdate ? start : endPosition, endPosition);\n    };\n    /**\n     * Insert Section break at cursor position\n     */\n    Editor.prototype.insertSectionBreak = function () {\n        var selection = this.viewer.selection;\n        if (isNullOrUndefined(selection) || this.owner.isReadOnlyMode || selection.start.paragraph.isInHeaderFooter) {\n            return;\n        }\n        this.initHistory('SectionBreak');\n        if (!selection.isEmpty) {\n            selection.selectContent(selection.isForward ? selection.start : selection.end, true);\n        }\n        this.viewer.owner.isShiftingEnabled = true;\n        this.updateInsertPosition();\n        this.insertSection(selection, true);\n        this.updateEndPosition();\n        this.reLayout(selection, true);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertSection = function (selection, selectFirstBlock) {\n        var newSectionFormat = this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat();\n        var lastBlock;\n        var firstBlock;\n        if (selection.start.paragraph.isInsideTable) {\n            var table = this.viewer.layout.getParentTable(selection.start.paragraph);\n            table = table.combineWidget(this.viewer);\n            var insertBefore = false;\n            if (selection.start.paragraph.associatedCell.rowIndex === 0) {\n                insertBefore = true;\n            }\n            var newParagraph = new ParagraphWidget();\n            var previousBlock = table.previousRenderedWidget;\n            if (!insertBefore) {\n                lastBlock = this.splitTable(table, selection.start.paragraph.associatedCell.ownerRow);\n                this.viewer.layout.layoutBodyWidgetCollection(lastBlock.index, lastBlock.containerWidget, lastBlock, false);\n                lastBlock = lastBlock.getSplitWidgets().pop();\n            }\n            else {\n                lastBlock = table;\n            }\n            var insertIndex = 0;\n            if ((isNullOrUndefined(previousBlock) || !previousBlock.bodyWidget.equals(lastBlock.bodyWidget)) && insertBefore) {\n                insertIndex = 0;\n                newParagraph.index = 0;\n            }\n            else {\n                insertIndex = lastBlock.indexInOwner + 1;\n                newParagraph.index = lastBlock.index + 1;\n            }\n            lastBlock.containerWidget.childWidgets.splice(insertIndex, 0, newParagraph);\n            newParagraph.containerWidget = lastBlock.containerWidget;\n            this.updateNextBlocksIndex(newParagraph, true);\n            this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, newParagraph.containerWidget, newParagraph, false);\n            lastBlock = newParagraph;\n        }\n        else {\n            var paragraphInfo = this.getParagraphInfo(selection.start);\n            var selectionStart = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n            //Split Paragraph\n            this.splitParagraphInternal(selection, selection.start.paragraph, selection.start.currentWidget, selection.start.offset);\n            this.setPositionForCurrentIndex(selection.start, selectionStart);\n            lastBlock = selection.start.paragraph.getSplitWidgets().pop();\n        }\n        //Split body widget\n        firstBlock = this.splitBodyWidget(lastBlock.bodyWidget, newSectionFormat, lastBlock).firstChild;\n        if (firstBlock instanceof TableWidget) {\n            firstBlock.updateRowIndex(0);\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(firstBlock.index, firstBlock.containerWidget, firstBlock, false);\n        if (firstBlock instanceof TableWidget) {\n            firstBlock = selection.getFirstParagraphInFirstCell(firstBlock);\n        }\n        if (selectFirstBlock) {\n            selection.selectParagraph(firstBlock, true);\n        }\n        return firstBlock;\n    };\n    Editor.prototype.splitBodyWidget = function (bodyWidget, sectionFormat, startBlock) {\n        var sectionIndex;\n        //Move blocks after the start block to next body widget\n        var newBodyWidget = this.viewer.layout.moveBlocksToNextPage(startBlock);\n        //Update SectionIndex for splitted body widget\n        this.updateSectionIndex(sectionFormat, newBodyWidget, true);\n        // insert New header footer widget in to section index \n        this.insertRemoveHeaderFooter(newBodyWidget.sectionIndex, true);\n        //update header and footer for splitted widget\n        this.viewer.layout.layoutHeaderFooter(newBodyWidget, this.viewer, newBodyWidget.page);\n        //Update Child item index from 0 for new Section\n        this.updateBlockIndex(0, newBodyWidget.firstChild);\n        // Start sinfting from first block\n        this.viewer.updateClientArea(newBodyWidget.sectionFormat, newBodyWidget.page);\n        return newBodyWidget;\n    };\n    Editor.prototype.insertRemoveHeaderFooter = function (sectionIndex, insert) {\n        if (this.viewer.headersFooters[sectionIndex]) {\n            // Need to handle further\n        }\n        else {\n            this.viewer.headersFooters[sectionIndex] = {};\n        }\n    };\n    Editor.prototype.updateBlockIndex = function (blockIndex, block) {\n        var blocks;\n        var sectionIndex = block.bodyWidget.sectionIndex;\n        do {\n            blocks = block.getSplitWidgets();\n            for (var i = 0; i < blocks.length; i++) {\n                blocks[i].index = blockIndex;\n            }\n            blockIndex++;\n            block = blocks.pop().nextRenderedWidget;\n        } while (!isNullOrUndefined(block) && block.bodyWidget.sectionIndex === sectionIndex);\n    };\n    Editor.prototype.updateSectionIndex = function (sectionFormat, startBodyWidget, increaseIndex) {\n        var currentSectionIndex = startBodyWidget.sectionIndex;\n        var blockIndex = 0;\n        var bodyWidget = startBodyWidget;\n        do {\n            if (bodyWidget.index === currentSectionIndex && sectionFormat) {\n                bodyWidget.sectionFormat = sectionFormat;\n            }\n            if (increaseIndex) {\n                bodyWidget.index++;\n            }\n            else {\n                bodyWidget.index--;\n            }\n            bodyWidget = bodyWidget.nextRenderedWidget;\n        } while (bodyWidget);\n    };\n    //Auto convert List\n    Editor.prototype.checkAndConvertList = function (selection, isTab) {\n        var list = selection.paragraphFormat.getList();\n        if (!isNullOrUndefined(list)) {\n            return false;\n        }\n        var convertList = false;\n        var isLeadingZero = false;\n        var indexInInline = 0;\n        var inlineObj = selection.start.currentWidget.getInline(selection.start.offset - 1, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!(inline instanceof TextElementBox)) {\n            return false;\n        }\n        var span = inline;\n        var text = span.text.substring(0, indexInInline);\n        var tabValue = 0;\n        var length = 0;\n        while (!isNullOrUndefined(span.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            if (span.previousNode instanceof TextElementBox && (span.previousNode.text === '\\t' || span.previousNode.text.trim().length === 0)) {\n                (span.previousNode.text === '\\t') ? tabValue += 36 : length = span.previousNode.text.length * 2.5;\n                span = span.previousNode;\n                continue;\n            }\n            return false;\n        }\n        span = inline;\n        var index = 0;\n        var tabIndex = text.lastIndexOf('\\t');\n        index = (tabIndex >= 0) ? tabIndex + 1 : text.lastIndexOf(' ') + 1;\n        while (span.previousNode instanceof TextElementBox && index === 0) {\n            span = span.previousNode;\n            var previousText = span.text;\n            tabIndex = previousText.lastIndexOf('\\t');\n            index = (tabIndex >= 0) ? tabIndex + 1 : previousText.lastIndexOf(' ') + 1;\n            text = span.text + text;\n            text = text.substring(index);\n        }\n        text = HelperMethods.trimStart(text);\n        var numberFormat = text.substring(1, 2);\n        var listLevelPattern = this.getListLevelPattern(text.substring(0, 1));\n        if (listLevelPattern !== 'None' && this.checkNumberFormat(numberFormat, listLevelPattern === 'Bullet', text)) {\n            convertList = true;\n        }\n        else if (this.checkLeadingZero(text)) {\n            isLeadingZero = true;\n            convertList = true;\n        }\n        if (convertList) {\n            this.initComplexHistory('AutoList');\n            var paragraph = inline.paragraph;\n            // tslint:disable-next-line:max-line-length\n            selection.start.setPositionParagraph(paragraph.childWidgets[0], paragraph.childWidgets[0].getOffset(inline, indexInInline + 1));\n            selection.end.setPositionParagraph(paragraph.childWidgets[0], 0);\n            this.initHistory('Delete');\n            this.deleteSelectedContents(selection, false);\n            this.reLayout(selection, false);\n            var followCharacter = isTab ? 'Tab' : 'Space';\n            numberFormat = !isLeadingZero ? '%1' + numberFormat : '%1' + text.substring(text.length - 1, text.length);\n            var leadingZeroText = text.substring(text.length - 3, text.length - 1);\n            listLevelPattern = !isLeadingZero ? listLevelPattern : this.getListLevelPattern(leadingZeroText);\n            var listLevel = new WListLevel(undefined);\n            listLevel.listLevelPattern = listLevelPattern;\n            if (listLevelPattern === 'Bullet') {\n                if (text === '*') {\n                    listLevel.numberFormat = '\\uf0b7';\n                    listLevel.characterFormat.fontFamily = 'Symbol';\n                }\n                else if (text === '-') {\n                    listLevel.numberFormat = '-';\n                }\n            }\n            else {\n                listLevel.numberFormat = numberFormat;\n            }\n            listLevel.followCharacter = followCharacter;\n            var leftIndent = selection.paragraphFormat.leftIndent;\n            if (tabValue !== 0 || length !== 0) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + 18 + tabValue + length;\n            }\n            else if (indexInInline > 2) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + (indexInInline - 2) * 2.5 + 18;\n            }\n            else if (leftIndent > 0) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + 18;\n            }\n            else {\n                listLevel.paragraphFormat.leftIndent = 36;\n            }\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            if ((!isLeadingZero && text.substring(0, 1) === '0') || leadingZeroText === '00') {\n                listLevel.startAt = 0;\n            }\n            else {\n                listLevel.startAt = 1;\n            }\n            this.autoConvertList(selection, listLevel);\n            if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n                this.editorHistory.updateComplexHistory();\n            }\n            else {\n                this.reLayout(selection);\n            }\n        }\n        return convertList;\n    };\n    Editor.prototype.getListLevelPattern = function (value) {\n        switch (value) {\n            case '0':\n            case '1':\n                return 'Arabic';\n            case 'I':\n                return 'UpRoman';\n            case 'i':\n                return 'LowRoman';\n            case 'A':\n                return 'UpLetter';\n            case 'a':\n                return 'LowLetter';\n            case '*':\n            case '-':\n                return 'Bullet';\n            case '00':\n            case '01':\n                return 'LeadingZero';\n            default:\n                return 'None';\n        }\n    };\n    Editor.prototype.autoConvertList = function (selection, listLevel) {\n        var start = selection.start;\n        if (!selection.isForward) {\n            start = selection.end;\n        }\n        var newList = new WList();\n        if (this.viewer.lists.length > 0) {\n            newList.listId = this.viewer.lists[this.viewer.lists.length - 1].listId + 1;\n        }\n        else {\n            newList.listId = 0;\n        }\n        var newAbstractList = new WAbstractList();\n        var layout = this.viewer;\n        if (layout.abstractLists.length > 0) {\n            newAbstractList.abstractListId = layout.abstractLists[layout.abstractLists.length - 1].abstractListId + 1;\n        }\n        else {\n            newAbstractList.abstractListId = 0;\n        }\n        newList.abstractListId = newAbstractList.abstractListId;\n        newList.abstractList = newAbstractList;\n        layout.abstractLists.push(newAbstractList);\n        newAbstractList.levels.push(listLevel);\n        listLevel.ownerBase = newAbstractList;\n        selection.paragraphFormat.setList(newList);\n        selection.paragraphFormat.listLevelNumber = 0;\n    };\n    Editor.prototype.checkNumberFormat = function (numberFormat, isBullet, text) {\n        if (isBullet) {\n            return numberFormat === '';\n        }\n        else {\n            var index = text.indexOf(numberFormat);\n            return (numberFormat === '.' || numberFormat === ')'\n                || numberFormat === '>' || numberFormat === '-') && text.substring(index, text.length - 1) === '';\n        }\n    };\n    Editor.prototype.checkLeadingZero = function (text) {\n        var j;\n        var isZero = false;\n        for (var i = 0; i <= text.length - 1; i++) {\n            if (text.charAt(i) === '0') {\n                isZero = true;\n                continue;\n            }\n            j = i;\n            break;\n        }\n        var numberFormat = undefined;\n        if (text.charAt(j) === '1') {\n            numberFormat = text.charAt(j + 1);\n        }\n        else {\n            numberFormat = text.charAt(j);\n        }\n        return isZero && this.checkNumberFormat(numberFormat, false, text);\n    };\n    Editor.prototype.getPageFromBlockWidget = function (block) {\n        var page = undefined;\n        if (block.containerWidget instanceof BodyWidget) {\n            page = block.containerWidget.page;\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget) {\n            page = block.containerWidget.page;\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            page = block.containerWidget.bodyWidget.page;\n        }\n        return page;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertTextInline = function (element, selection, text, index) {\n        if (element instanceof TextElementBox) {\n            element.text = HelperMethods.insert(element.text, index, text);\n            var paragraph = element.line.paragraph;\n            var lineIndex = paragraph.childWidgets.indexOf(element.line);\n            var elementIndex = element.line.children.indexOf(element);\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n        }\n        else if (element instanceof ImageElementBox) {\n            this.insertImageText(element, selection, text, index);\n        }\n        else if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0) {\n                this.insertFieldBeginText(element, selection, text, index);\n            }\n            else if (element.fieldType === 2) {\n                this.insertFieldSeparatorText(element, selection, text, index);\n            }\n            else {\n                this.insertFieldEndText(element, selection, text, index);\n            }\n        }\n        else if (element instanceof BookmarkElementBox) {\n            this.insertBookMarkText(element, selection, text, index);\n        }\n    };\n    Editor.prototype.insertFieldBeginText = function (fieldBegin, selection, text, index) {\n        var spanObj = new TextElementBox();\n        spanObj.text = text;\n        var lineIndex = fieldBegin.line.paragraph.childWidgets.indexOf(fieldBegin.line);\n        var spanIndex = fieldBegin.line.children.indexOf(fieldBegin);\n        spanObj.characterFormat.copyFormat(fieldBegin.characterFormat);\n        fieldBegin.line.children.splice(spanIndex, 0, spanObj);\n        spanObj.line = fieldBegin.line;\n        this.viewer.layout.reLayoutParagraph(fieldBegin.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertBookMarkText = function (element, selection, text, index) {\n        var spanObj = new TextElementBox();\n        spanObj.text = text;\n        var lineIndex = element.line.paragraph.childWidgets.indexOf(element.line);\n        var spanIndex = element.line.children.indexOf(element);\n        spanObj.characterFormat.copyFormat(element.characterFormat);\n        element.line.children.splice(spanIndex, 0, spanObj);\n        spanObj.line = element.line;\n        this.viewer.layout.reLayoutParagraph(element.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertFieldSeparatorText = function (fieldSeparator, selection, text, index) {\n        var previousInline = selection.getPreviousTextInline(fieldSeparator);\n        var nextInline = selection.getNextTextInline(fieldSeparator);\n        var span = new TextElementBox();\n        span.text = text;\n        var spanIndex = fieldSeparator.line.children.indexOf(fieldSeparator);\n        if (index === fieldSeparator.length) {\n            spanIndex++;\n        }\n        if (isNullOrUndefined(previousInline) && isNullOrUndefined(nextInline)) {\n            span.characterFormat.copyFormat(fieldSeparator.line.paragraph.characterFormat);\n        }\n        else if (isNullOrUndefined(previousInline)) {\n            span.characterFormat.copyFormat(nextInline.characterFormat);\n        }\n        else {\n            span.characterFormat.copyFormat(previousInline.characterFormat);\n        }\n        fieldSeparator.line.children.splice(spanIndex, 0, span);\n        span.line = fieldSeparator.line;\n        var lineIndex = fieldSeparator.line.paragraph.childWidgets.indexOf(fieldSeparator.line);\n        this.viewer.layout.reLayoutParagraph(fieldSeparator.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertFieldEndText = function (fieldEnd, selection, text, index) {\n        var span = new TextElementBox();\n        span.text = text;\n        var spanIndex = fieldEnd.line.children.indexOf(fieldEnd);\n        span.characterFormat.copyFormat(fieldEnd.characterFormat);\n        fieldEnd.line.children.splice(spanIndex + 1, 0, span);\n        span.line = fieldEnd.line;\n        var lineIndex = fieldEnd.line.paragraph.childWidgets.indexOf(fieldEnd.line);\n        this.viewer.layout.reLayoutParagraph(fieldEnd.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertImageText = function (image, selection, text, index) {\n        var previousInlineObj = selection.getPreviousTextInline(image);\n        var nextInlineObj = selection.getNextTextInline(image);\n        var line = image.line;\n        var element = new TextElementBox();\n        var paragraph = line.paragraph;\n        var lineIndex = paragraph.childWidgets.indexOf(line);\n        element.text = text;\n        var spanIndex = line.children.indexOf(image);\n        if (index === image.length) {\n            spanIndex++;\n        }\n        if (isNullOrUndefined(previousInlineObj) && isNullOrUndefined(nextInlineObj)) {\n            element.characterFormat.copyFormat(paragraph.characterFormat);\n        }\n        else if (isNullOrUndefined(previousInlineObj)) {\n            element.characterFormat.copyFormat(nextInlineObj.characterFormat);\n        }\n        else {\n            element.characterFormat.copyFormat(previousInlineObj.characterFormat);\n        }\n        line.children.splice(spanIndex, 0, element);\n        element.line = line;\n        this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, spanIndex);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.isListTextSelected = function () {\n        if (this.viewer.isListTextSelected) {\n            this.initComplexHistory('ListSelect');\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.selection.start.paragraph.paragraphFormat.listFormat && this.viewer.selection.start.paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n            }\n        }\n    };\n    //Auto Format and insert Hyperlink Implementation starts\n    Editor.prototype.checkAndConvertToHyperlink = function (selection, isEnter, paragraph) {\n        var text;\n        var span;\n        if (isEnter) {\n            span = paragraph.lastChild.children[paragraph.lastChild.children.length - 1];\n            text = span.text;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset - 1, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!(inline instanceof TextElementBox)) {\n                return;\n            }\n            span = inline;\n            text = span.text.substring(0, indexInInline);\n        }\n        var index = 0;\n        var tabCharIndex = text.lastIndexOf('\\t');\n        index = (tabCharIndex >= 0) ? tabCharIndex + 1 : text.lastIndexOf(' ') + 1;\n        while (span.previousNode instanceof TextElementBox && index === 0) {\n            span = span.previousNode;\n            var previousText = span.text;\n            tabCharIndex = previousText.lastIndexOf('\\t');\n            index = (tabCharIndex >= 0) ? tabCharIndex + 1 : previousText.lastIndexOf(' ') + 1;\n            text = span.text + text;\n        }\n        text = text.substring(index);\n        var lowerCaseText = text.toLowerCase();\n        var containsURL = false;\n        if (lowerCaseText.substring(0, 8) === 'file:///'\n            || (lowerCaseText.substring(0, 7) === 'http://' && lowerCaseText.length > 7)\n            || (lowerCaseText.substring(0, 8) === 'https://' && lowerCaseText.length > 8)\n            || (lowerCaseText.substring(0, 4) === 'www.' && lowerCaseText.length > 4)\n            || (lowerCaseText.substring(0, 3) === '\\\\' && lowerCaseText.length > 3)\n            || (lowerCaseText.substring(0, 7) === 'mailto:' && lowerCaseText.length > 7)) {\n            containsURL = true;\n            if (lowerCaseText.substring(0, 4) === 'www.' && lowerCaseText.length > 4) {\n                text = 'http://' + text;\n            }\n        }\n        else {\n            var atIndex = text.indexOf('@');\n            var dotIndex = text.indexOf('.');\n            if (atIndex > 0 && atIndex < dotIndex && dotIndex < text.length - 1) {\n                containsURL = true;\n                text = 'mailto:' + text;\n            }\n        }\n        if (containsURL) {\n            var startPos = new TextPosition(this.viewer.owner);\n            startPos.setPositionParagraph(span.line, span.line.getOffset(span, index));\n            var endPos = new TextPosition(this.viewer.owner);\n            if (isEnter) {\n                endPos.setPositionParagraph(span.line, span.line.getEndOffset());\n            }\n            else {\n                if (selection.end.currentWidget.children.length === 0 && selection.end.offset === 0) {\n                    var prevLine = selection.end.currentWidget.previousLine;\n                    endPos.setPositionParagraph(prevLine, prevLine.getEndOffset());\n                }\n                else {\n                    endPos.setPositionParagraph(selection.end.currentWidget, selection.end.offset - 1);\n                }\n            }\n            this.autoFormatHyperlink(selection, text, startPos, endPos);\n        }\n    };\n    Editor.prototype.autoFormatHyperlink = function (selection, url, startPosition, endPosition) {\n        this.initComplexHistory('AutoFormatHyperlink');\n        var blockInfo = this.getParagraphInfo(startPosition);\n        var start = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.currentHistoryInfo.insertPosition = start;\n        }\n        // Moves the selection to URL text start and end position.\n        selection.start.setPositionInternal(startPosition);\n        selection.end.setPositionInternal(endPosition);\n        // Preserves the character format for hyperlink field.\n        var temp = this.getCharacterFormat(selection);\n        var format = new WCharacterFormat();\n        format.copyFormat(temp);\n        var fieldEnd = this.createHyperlinkElement(url, startPosition, endPosition, format);\n        // Moves the selection to the end of field end position.\n        selection.start.setPositionParagraph(fieldEnd.line, (fieldEnd.line).getOffset(fieldEnd, 1));\n        // Moves to next text position. (To achieve common behavior for space and enter).\n        selection.start.moveNextPosition();\n        selection.end.setPositionInternal(selection.start);\n        blockInfo = this.getParagraphInfo(selection.end);\n        var end = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.currentHistoryInfo.endPosition = end;\n            this.editorHistory.updateComplexHistory();\n            this.reLayout(selection);\n        }\n        else {\n            this.updateComplexWithoutHistory(0, start, end);\n        }\n    };\n    Editor.prototype.appylingHyperlinkFormat = function (selection) {\n        this.initHistory('Underline');\n        this.updateCharacterFormatWithUpdate(selection, 'underline', 'Single', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n        // Applies font color for field result.\n        this.initHistory('FontColor');\n        this.updateCharacterFormatWithUpdate(selection, 'fontColor', '#0563c1', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.createHyperlinkElement = function (url, startPosition, endPosition, format) {\n        var selection = this.selection;\n        this.viewer.layout.allowLayout = false;\n        this.appylingHyperlinkFormat(selection);\n        this.viewer.layout.allowLayout = true;\n        // Adds the field end at the URL text end position.\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.characterFormat.copyFormat(format);\n        fieldEnd.line = selection.end.currentWidget;\n        selection.start.setPositionInternal(selection.end);\n        // this.insertElementInCurrentLine(selection, fieldEnd, true);\n        this.initInsertInline(fieldEnd);\n        // Moves the selection to URL text start position.        \n        selection.start.setPositionInternal(startPosition);\n        selection.end.setPositionInternal(selection.start);\n        // Adds field begin, field code and field separator at the URL text start position.\n        var begin = this.insertHyperlinkfield(selection, format, url);\n        var lineIndex = selection.start.paragraph.childWidgets.indexOf(begin.line);\n        var index = begin.line.children.indexOf(begin);\n        fieldEnd.linkFieldCharacter(this.viewer);\n        this.viewer.layout.reLayoutParagraph(selection.start.paragraph, lineIndex, index);\n        return fieldEnd;\n    };\n    Editor.prototype.insertHyperlinkfield = function (selection, format, url, isBookmark) {\n        // Adds field begin, field code and field separator at the URL text start position.\n        var begin = new FieldElementBox(0);\n        begin.characterFormat.copyFormat(format);\n        begin.line = selection.start.currentWidget;\n        this.initInsertInline(begin);\n        var span = new TextElementBox();\n        span.characterFormat.copyFormat(format);\n        if (isBookmark) {\n            span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n        }\n        else {\n            span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n        }\n        span.line = selection.start.currentWidget;\n        this.initInsertInline(span);\n        var separator = new FieldElementBox(2);\n        separator.characterFormat.copyFormat(format);\n        separator.line = selection.start.currentWidget;\n        this.initInsertInline(separator);\n        return begin;\n    };\n    Editor.prototype.unLinkFieldCharacter = function (inline) {\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            if (inline.fieldEnd) {\n                if (this.viewer) {\n                    this.viewer.fieldToLayout = inline;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                // inline.line.paragraph.addFieldCharacter(inline.fieldEnd);\n                inline.fieldEnd = undefined;\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            if (!isNullOrUndefined(inline.fieldEnd)) {\n                if (this.viewer) {\n                    this.viewer.fieldToLayout = inline.fieldBegin;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                inline.fieldBegin.fieldSeparator = undefined;\n                inline.fieldEnd.fieldSeparator = undefined;\n            }\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            if (inline.fieldBegin) {\n                if (!isNullOrUndefined(this.viewer)) {\n                    this.viewer.fieldToLayout = inline.fieldBegin;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                var fieldIndex = this.viewer.fields.indexOf(inline.fieldBegin);\n                if (fieldIndex !== -1) {\n                    this.viewer.fields.splice(fieldIndex, 1);\n                }\n                inline.fieldBegin = undefined;\n            }\n        }\n    };\n    Editor.prototype.getCharacterFormat = function (selection) {\n        if (selection.start.paragraph.isEmpty()) {\n            return selection.start.paragraph.characterFormat;\n        }\n        else {\n            var info = selection.start.currentWidget.getInline(selection.start.offset, 0);\n            return info.element.characterFormat;\n        }\n    };\n    /**\n     * Insert Hyperlink\n     * @param  {string} url\n     * @param  {string} displayText\n     * @param  {boolean} remove\n     * @private\n     */\n    Editor.prototype.insertHyperlink = function (url, displayText, remove, isBookmark) {\n        var selection = this.viewer.selection;\n        if (selection.start.paragraph.associatedCell !== selection.end.paragraph.associatedCell) {\n            return;\n        }\n        if (remove) {\n            //Empty selection Hyperlink insert\n            this.insertHyperlinkInternal(selection, url, displayText, isBookmark);\n        }\n        else {\n            //Non-Empty Selection- change the selected text to Field       \n            // this.preservedFontCol = this.getFontColor();\n            var startPosition = selection.start;\n            var endPosition = selection.end;\n            if (!selection.isForward) {\n                startPosition = selection.end;\n                endPosition = selection.start;\n            }\n            var fieldStartPosition = new TextPosition(this.viewer.owner);\n            fieldStartPosition.setPositionInternal(startPosition);\n            var temp = this.getCharacterFormat(selection);\n            var format = new WCharacterFormat(undefined);\n            format.copyFormat(temp);\n            this.initComplexHistory('InsertHyperlink');\n            var blockInfo = this.getParagraphInfo(startPosition);\n            var start = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n                // tslint:disable-next-line:max-line-length\n                this.editorHistory.currentHistoryInfo.insertPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            }\n            this.appylingHyperlinkFormat(selection);\n            this.viewer.layout.allowLayout = true;\n            startPosition.setPositionInternal(endPosition);\n            // Adds the field end at the URL text end position.\n            var fieldEnd = new FieldElementBox(1);\n            fieldEnd.characterFormat.copyFormat(format);\n            fieldEnd.line = selection.end.currentWidget;\n            startPosition.setPositionInternal(endPosition);\n            // this.insertElementInCurrentLine(selection, fieldEnd, true);\n            this.initInsertInline(fieldEnd);\n            // Moves the selection to URL text start position.        \n            startPosition.setPositionInternal(fieldStartPosition);\n            endPosition.setPositionInternal(startPosition);\n            // Adds field begin, field code and field separator at the URL text start position.\n            var begin = this.insertHyperlinkfield(selection, format, url, isBookmark);\n            fieldEnd.linkFieldCharacter(this.viewer);\n            var lineIndex = selection.start.paragraph.childWidgets.indexOf(begin.line);\n            var index = begin.line.children.indexOf(begin);\n            this.viewer.layout.reLayoutParagraph(selection.start.paragraph, lineIndex, index);\n            var lineWidget = fieldEnd.line;\n            selection.selects(lineWidget, lineWidget.getOffset(fieldEnd, fieldEnd.length), true);\n            blockInfo = this.getParagraphInfo(endPosition);\n            var end = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n                // tslint:disable-next-line:max-line-length\n                this.editorHistory.currentHistoryInfo.endPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n                this.editorHistory.updateComplexHistory();\n            }\n            else {\n                this.updateComplexWithoutHistory(1, start, end);\n            }\n        }\n    };\n    Editor.prototype.insertHyperlinkInternal = function (selection, url, displayText, isBookmark) {\n        if (isNullOrUndefined(selection.start)) {\n            return;\n        }\n        if (this.editHyperlink(selection, url, displayText)) {\n            return;\n        }\n        this.initHistory('InsertHyperlink');\n        var isRemoved = true;\n        if (!selection.isEmpty) {\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (isRemoved) {\n            // Preserves the character format for hyperlink field.\n            var temp = this.getCharacterFormat(selection);\n            var format = new WCharacterFormat();\n            format.copyFormat(temp);\n            this.insertHyperlinkByFormat(selection, url, displayText, format, isBookmark);\n        }\n        //else\n        //    this.Select(Start, true);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertHyperlinkByFormat = function (selection, url, displayText, format, isBookmark) {\n        this.updateInsertPosition();\n        selection.owner.isShiftingEnabled = true;\n        var indexInInline = 0;\n        var initial = indexInInline;\n        var element = [];\n        var fieldBegin = new FieldElementBox(0);\n        element.push(fieldBegin);\n        var span = new TextElementBox();\n        if (isBookmark) {\n            span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n        }\n        else {\n            span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n        }\n        element.push(span);\n        var fieldSeparator = new FieldElementBox(2);\n        element.push(fieldSeparator);\n        if (!isNullOrUndefined(displayText) && displayText !== '') {\n            span = new TextElementBox();\n            span.characterFormat.underline = 'Single';\n            span.characterFormat.fontColor = '#0563c1';\n            span.text = displayText;\n            element.push(span);\n        }\n        var fieldEnd = new FieldElementBox(1);\n        element.push(fieldEnd);\n        this.insertElement(element);\n        var paragraph = selection.start.paragraph;\n        fieldEnd.linkFieldCharacter(this.viewer);\n        if (this.viewer.fields.indexOf(fieldBegin) === -1) {\n            this.viewer.fields.push(fieldBegin);\n        }\n        var offset = fieldEnd.line.getOffset(fieldEnd, 1);\n        selection.selects(fieldEnd.line, fieldEnd.line.getOffset(fieldEnd, fieldEnd.length), true);\n        this.updateEndPosition();\n        this.reLayout(selection, true);\n    };\n    Editor.prototype.initInsertInline = function (element, insertHyperlink) {\n        this.initHistory('InsertInline');\n        this.insertInlineInSelection(this.viewer.selection, element);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElementInCurrentLine = function (selection, inline, isReLayout) {\n        if (this.checkIsNotRedoing()) {\n            selection.owner.isShiftingEnabled = true;\n        }\n        if (!selection.isEmpty) {\n            this.removeSelectedContents(selection);\n        }\n        this.updateInsertPosition();\n        this.insertElement([inline]);\n        if (this.checkEndPosition(selection)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * Edit Hyperlink\n     * @param  {Selection} selection\n     * @param  {string} url\n     * @param  {string} displayText\n     * @private\n     */\n    Editor.prototype.editHyperlink = function (selection, url, displayText, isBookmark) {\n        var fieldBegin = selection.getHyperlinkField();\n        if (isNullOrUndefined(fieldBegin)) {\n            return false;\n        }\n        this.initHistory('InsertHyperlink');\n        this.editHyperlinkInternal = isNullOrUndefined(this.editorHistory)\n            || (this.editorHistory && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo));\n        var fieldResult = '';\n        var isNestedField = false;\n        // Preserves the character format for hyperlink field.\n        var temp = this.getCharacterFormat(selection);\n        var format = new WCharacterFormat();\n        format.copyFormat(temp);\n        var fieldSeparator = undefined;\n        if (!isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            fieldSeparator = fieldBegin.fieldSeparator;\n            // tslint:disable-next-line:max-line-length\n            var fieldObj = selection.getHyperlinkDisplayText(fieldBegin.fieldSeparator.line.paragraph, fieldBegin.fieldSeparator, fieldBegin.fieldEnd, isNestedField, format);\n            fieldResult = fieldObj.displayText;\n            isNestedField = fieldObj.isNestedField;\n            format = fieldObj.format;\n        }\n        var offset = fieldBegin.line.getOffset(fieldBegin, 0);\n        selection.start.setPositionParagraph(fieldBegin.line, offset);\n        offset = fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, 1);\n        selection.end.setPositionParagraph(fieldBegin.fieldEnd.line, offset);\n        this.deleteSelectedContents(selection, false);\n        if (!isNestedField && fieldResult !== displayText || isNullOrUndefined(fieldSeparator)) {\n            this.insertHyperlinkByFormat(selection, url, displayText, format, isBookmark);\n        }\n        else {\n            //Modify the new hyperlink url. Inserts field begin, url and field separator.\n            this.updateInsertPosition();\n            var newFieldBegin = new FieldElementBox(0);\n            newFieldBegin.characterFormat.copyFormat(fieldBegin.characterFormat);\n            newFieldBegin.line = selection.start.currentWidget;\n            this.insertInlineInternal(newFieldBegin);\n            var span = new TextElementBox();\n            span.characterFormat.copyFormat(fieldBegin.characterFormat);\n            if (isBookmark) {\n                span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n            }\n            else {\n                span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n            }\n            span.line = selection.start.currentWidget;\n            this.insertInlineInternal(span);\n            var nodes = this.editorHistory && this.editorHistory.currentBaseHistoryInfo ?\n                this.editorHistory.currentBaseHistoryInfo.removedNodes : this.nodes;\n            this.insertClonedFieldResult(selection, nodes, fieldSeparator);\n            var fieldEnd = selection.end.currentWidget.getInline(selection.end.offset, 0).element;\n            fieldEnd.linkFieldCharacter(this.viewer);\n            var paragraph = newFieldBegin.line.paragraph;\n            var lineIndex = newFieldBegin.line.paragraph.childWidgets.indexOf(newFieldBegin.line);\n            var elementIndex = newFieldBegin.line.children.indexOf(newFieldBegin);\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n            selection.selects(newFieldBegin.fieldEnd.line, offset, true);\n            this.updateEndPosition();\n            this.reLayout(selection, true);\n        }\n        this.editHyperlinkInternal = false;\n        this.nodes = [];\n        return true;\n    };\n    /* tslint:disable:no-any */\n    Editor.prototype.insertClonedFieldResult = function (selection, nodes, fieldSeparator) {\n        var fieldEnd;\n        var isStarted = false;\n        for (var i = nodes.length - 1; i > -1; i--) {\n            var node = nodes[i];\n            /* tslint:enable:no-any */\n            if (!isStarted) {\n                if (fieldSeparator === node) {\n                    isStarted = true;\n                }\n                else {\n                    if (node instanceof ParagraphWidget && node === fieldSeparator.line.paragraph) {\n                        isStarted = true;\n                        var paragraph = undefined;\n                        if (i === nodes.length - 1) {\n                            paragraph = selection.start.paragraph;\n                            var fieldParagraph = fieldSeparator.line.paragraph;\n                            this.getClonedFieldResultWithSel(fieldParagraph, selection, fieldSeparator);\n                        }\n                        else {\n                            paragraph = this.getClonedFieldResult(fieldSeparator.line.paragraph, fieldSeparator);\n                            this.insertParagraph(paragraph, true);\n                        }\n                        selection.selectParagraph(selection.getNextParagraphBlock(paragraph), true);\n                    }\n                    continue;\n                }\n            }\n            if (node instanceof ElementBox) {\n                this.insertInlineInternal(node.clone());\n            }\n            else if (node instanceof BlockWidget) {\n                this.insertBlock(node.clone());\n            }\n            // else if (node instanceof WSection)\n            //     editor.insertSection((node as WSection)._Clone());\n        }\n    };\n    Editor.prototype.getClonedFieldResultWithSel = function (paragraph, selection, fieldSeparator) {\n        var lineIndex = paragraph.childWidgets.indexOf(fieldSeparator.line);\n        var elementIndex = paragraph.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < paragraph.childWidgets.length; j++) {\n            var lineWidget = paragraph.childWidgets[j];\n            if (j !== lineIndex) {\n                elementIndex = 0;\n            }\n            for (var i = elementIndex; i < lineWidget.children.length; i++) {\n                this.insertInlineInternal(lineWidget.children[i].clone());\n            }\n        }\n    };\n    Editor.prototype.getClonedFieldResult = function (curParagraph, fieldSeparator) {\n        var paragraph = new ParagraphWidget();\n        paragraph.characterFormat.copyFormat(curParagraph.characterFormat);\n        paragraph.paragraphFormat.copyFormat(curParagraph.paragraphFormat);\n        var lineIndex = curParagraph.childWidgets.indexOf(fieldSeparator.line);\n        var elementIndex = curParagraph.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < curParagraph.childWidgets.length; j++) {\n            var lineWidget = curParagraph.childWidgets[j];\n            if (j !== lineIndex) {\n                elementIndex = 0;\n            }\n            for (var i = elementIndex; i < lineWidget.children.length; i++) {\n                paragraph.childWidgets[0].children.push(lineWidget.children[i]);\n            }\n        }\n        return paragraph;\n    };\n    /**\n     * Removes the hyperlink if selection is within hyperlink.\n     */\n    Editor.prototype.removeHyperlink = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var selection = this.selection;\n        var fieldBegin = selection.getHyperlinkField();\n        if (isNullOrUndefined(fieldBegin)) {\n            return;\n        }\n        var fieldEnd = fieldBegin.fieldEnd;\n        var fieldSeparator = fieldBegin.fieldSeparator;\n        var fieldStartPosition = new TextPosition(selection.owner);\n        // tslint:disable-next-line:max-line-length\n        fieldStartPosition.setPositionParagraph(fieldBegin.line, (fieldBegin.line).getOffset(fieldBegin, 0));\n        var fieldSeparatorPosition = new TextPosition(selection.owner);\n        // tslint:disable-next-line:max-line-length\n        fieldSeparatorPosition.setPositionParagraph(fieldSeparator.line, (fieldSeparator.line).getOffset(fieldSeparator, fieldSeparator.length));\n        this.initComplexHistory('RemoveHyperlink');\n        selection.start.setPositionParagraph(fieldEnd.line, (fieldEnd.line).getOffset(fieldEnd, 0));\n        selection.end.setPositionInternal(selection.start);\n        this.onDelete();\n        selection.start.setPositionInternal(fieldSeparatorPosition);\n        this.initHistory('Underline');\n        this.updateCharacterFormatWithUpdate(selection, 'underline', 'None', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        // Applies font color for field result.\n        this.initHistory('FontColor');\n        this.updateCharacterFormatWithUpdate(selection, 'fontColor', undefined, false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n        selection.end.setPositionInternal(selection.start);\n        selection.start.setPositionInternal(fieldStartPosition);\n        this.initHistory('Delete');\n        this.deleteSelectedContents(selection, false);\n        this.reLayout(selection, true);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            this.editorHistory.updateComplexHistory();\n        }\n    };\n    //Paste Implementation starts\n    /**\n     * Paste copied clipboard content on Paste event\n     * @param  {ClipboardEvent} event\n     * @param  {any} pasteWindow?\n     * @private\n     */\n    /* tslint:disable:no-any */\n    Editor.prototype.pasteInternal = function (event, pasteWindow) {\n        if (this.viewer.owner.enableLocalPaste) {\n            this.pasteLocal();\n        }\n        else {\n            if (isNullOrUndefined(pasteWindow)) {\n                pasteWindow = window;\n            }\n            /* tslint:enable:no-any */\n            var textContent = '';\n            var clipbordData = pasteWindow.clipboardData ? pasteWindow.clipboardData : event.clipboardData;\n            textContent = clipbordData.getData('Text');\n            if (textContent !== '') {\n                this.pasteContents(textContent);\n                this.viewer.editableDiv.innerHTML = '';\n            }\n        }\n        this.viewer.updateFocus();\n    };\n    /**\n     * Pastes the data present in local clipboard if any.\n     */\n    Editor.prototype.pasteLocal = function () {\n        /* tslint:disable:no-any */\n        if (this.copiedData && this.owner.enableLocalPaste) {\n            var document_1 = JSON.parse(this.copiedData);\n            this.pasteContents(document_1);\n        }\n    };\n    Editor.prototype.getBlocks = function (pasteContent) {\n        var widgets = [];\n        if (typeof (pasteContent) === 'string') {\n            var startParagraph = this.selection.start.paragraph;\n            if (!this.selection.isForward) {\n                startParagraph = this.selection.end.paragraph;\n            }\n            var arr = [];\n            var txt = pasteContent;\n            txt = txt.replace(/\\r\\n/g, '\\r');\n            arr = txt.split('\\r');\n            for (var i = 0; i < arr.length; i++) {\n                var insertFormat = this.copyInsertFormat(startParagraph.characterFormat, false);\n                var insertParaFormat = this.viewer.selection.copySelectionParagraphFormat();\n                var paragraph = new ParagraphWidget();\n                paragraph.paragraphFormat.copyFormat(insertParaFormat);\n                var line = new LineWidget(paragraph);\n                if (arr[i].length > 0) {\n                    var textElement = new TextElementBox();\n                    textElement.characterFormat.copyFormat(insertFormat);\n                    textElement.text = arr[i];\n                    line.children.push(textElement);\n                    textElement.line = line;\n                }\n                paragraph.childWidgets.push(line);\n                widgets.push(paragraph);\n            }\n        }\n        else {\n            for (var i = 0; i < pasteContent.sections.length; i++) {\n                this.viewer.owner.parser.parseBody(pasteContent.sections[i].blocks, widgets);\n            }\n        }\n        return widgets;\n    };\n    Editor.prototype.pasteContents = function (content) {\n        this.pasteContentsInternal(this.getBlocks(content));\n    };\n    Editor.prototype.pasteContentsInternal = function (widgets) {\n        /* tslint:enable:no-any */\n        var selection = this.viewer.selection;\n        var isRemoved = true;\n        this.initComplexHistory('Paste');\n        if (this.viewer.isListTextSelected) {\n            var paragraph = selection.start.paragraph;\n            if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n            }\n        }\n        this.initHistory('Paste');\n        if (!selection.isEmpty || this.viewer.isListTextSelected) {\n            isRemoved = this.removeSelectedContentInternal(selection, selection.start, selection.end);\n        }\n        if (isRemoved) {\n            this.pasteContent(widgets);\n        }\n        else if (this.editorHistory) {\n            this.editorHistory.currentBaseHistoryInfo = undefined;\n        }\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.updateHistory();\n            this.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.reLayout(selection, selection.isEmpty);\n        }\n    };\n    /* tslint:disable:no-any */\n    Editor.prototype.pasteContent = function (widgets) {\n        /* tslint:enable:no-any */\n        this.viewer.owner.isShiftingEnabled = true;\n        this.updateInsertPosition();\n        this.viewer.owner.isLayoutEnabled = true;\n        this.viewer.owner.isPastingContent = true;\n        this.pasteCopiedData(widgets);\n        this.updateEndPosition();\n        this.viewer.owner.isPastingContent = false;\n        this.viewer.selection.fireSelectionChanged(true);\n    };\n    Editor.prototype.pasteCopiedData = function (widgets) {\n        for (var j = 0; j < widgets.length; j++) {\n            var widget = widgets[j];\n            if (widget instanceof ParagraphWidget && widget.childWidgets.length === 0) {\n                widget.childWidgets[0] = new LineWidget(widget);\n            }\n            if (j === widgets.length - 1 && widget instanceof ParagraphWidget) {\n                var newParagraph = widget;\n                if (newParagraph.childWidgets.length > 0\n                    && newParagraph.childWidgets[0].children.length > 0) {\n                    this.insertElement(newParagraph.childWidgets[0].children);\n                }\n            }\n            else if (widget instanceof BlockWidget) {\n                var startParagraph = this.selection.start.paragraph;\n                if (widget instanceof TableWidget && startParagraph.isInsideTable) {\n                    var table = widget;\n                    //Handled to resize table based on parent cell width.\n                    var clientWidth = startParagraph.getContainerWidth();\n                    table.fitCellsToClientArea(clientWidth);\n                }\n                if (widget instanceof TableWidget && startParagraph.isEmpty()\n                    && startParagraph.previousWidget instanceof TableWidget) {\n                    this.insertTableRows(widget, startParagraph.previousWidget);\n                }\n                else {\n                    this.insertBlockInternal(widget);\n                }\n            }\n        }\n    };\n    /**\n     * Insert Table on undo\n     * @param  {WTable} table\n     * @param  {WTable} newTable\n     * @param  {boolean} moveRows\n     * @private\n     */\n    Editor.prototype.insertTableInternal = function (table, newTable, moveRows) {\n        //Gets the index of current table.\n        var insertIndex = table.getIndex();\n        if (moveRows) {\n            //Moves the rows to table.\n            for (var i = 0, index = 0; i < table.childWidgets.length; i++, index++) {\n                var row = table.childWidgets[i];\n                newTable.childWidgets.splice(index, 0, row);\n                row.containerWidget = newTable;\n                table.childWidgets.splice(i, 1);\n                i--;\n            }\n        }\n        var owner = table.containerWidget;\n        this.removeBlock(table);\n        //Inserts table in the current table position.        \n        var blockAdvCollection = owner.childWidgets;\n        blockAdvCollection.splice(insertIndex, 0, newTable);\n        newTable.index = table.index;\n        table.containerWidget = undefined;\n        newTable.containerWidget = owner;\n        newTable.isGridUpdated = false;\n        newTable.buildTableColumns();\n        newTable.isGridUpdated = true;\n        this.viewer.layout.clearTableWidget(newTable, true, true);\n        this.updateNextBlocksIndex(newTable, true);\n        this.viewer.layout.linkFieldInTable(newTable);\n        this.viewer.layout.layoutBodyWidgetCollection(newTable.index, owner, newTable, false);\n    };\n    /**\n     * Insert Table on undo\n     * @param  {Selection} selection\n     * @param  {WBlock} block\n     * @param  {WTable} table\n     * @private\n     */\n    Editor.prototype.insertBlockTable = function (selection, block, table) {\n        var offset = selection.start.offset;\n        var lineIndex = selection.start.paragraph.childWidgets.indexOf(selection.start.currentWidget);\n        if (block instanceof ParagraphWidget && offset > 0) {\n            //Moves the inline items before selection start to the inserted paragraph.\n            // tslint:disable-next-line:max-line-length\n            this.moveInlines(selection.start.paragraph, block, 0, 0, selection.start.paragraph.firstChild, offset, selection.start.currentWidget);\n            selection.selectParagraph(selection.start.paragraph, true);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(this.getHierarchicalIndex(block, offset.toString()), true);\n            }\n        }\n        if (offset > 0 && this.checkInsertPosition(selection)) {\n            this.updateHistoryPosition(selection.start, true);\n        }\n        var index = table.indexInOwner;\n        table.containerWidget.childWidgets.splice(index, 0, block);\n        block.containerWidget = table.containerWidget;\n        block.index = table.index;\n        this.updateNextBlocksIndex(block, true);\n        this.viewer.layout.layoutBodyWidgetCollection(block.index, block.containerWidget, block, false);\n        if (this.checkInsertPosition(selection)) {\n            var paragraph = undefined;\n            if (block instanceof ParagraphWidget) {\n                paragraph = block;\n            }\n            if (block instanceof TableWidget) {\n                paragraph = selection.getFirstParagraphInFirstCell(block);\n            }\n            this.updateHistoryPosition(this.getHierarchicalIndex(paragraph, '0'), true);\n        }\n    };\n    /**\n     * On cut handle selected content remove and relayout\n     * @param  {Selection} selection\n     * @param  {TextPosition} startPosition\n     * @param  {TextPosition} endPosition\n     * @private\n     */\n    Editor.prototype.handleCut = function (selection) {\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        // this.owner.isShiftingEnabled = true;\n        var blockInfo = this.getParagraphInfo(startPosition);\n        selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        var image = undefined;\n        if (startPosition.paragraph === endPosition.paragraph && startPosition.offset + 1 === endPosition.offset) {\n            //Gets selected image and copy image to clipboard.\n            var index = 0;\n            var currentInline = startPosition.paragraph.getInline(endPosition.offset, index);\n            var inline = currentInline.element;\n            image = inline;\n        }\n        this.initHistory('Cut');\n        selection.owner.isShiftingEnabled = true;\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(selection.editPosition, true);\n            }\n        }\n        this.deleteSelectedContent(endPosition.paragraph, selection, startPosition, endPosition, 3);\n        var textPosition = new TextPosition(selection.owner);\n        this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n        selection.selectContent(textPosition, true);\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            if (this.checkEndPosition(selection)) {\n                this.updateHistoryPosition(selection.end, false);\n            }\n        }\n        this.reLayout(selection);\n    };\n    Editor.prototype.insertInlineInternal = function (element) {\n        var selection = this.selection;\n        var length = element.length;\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        if (selection.start.paragraph.isEmpty()) {\n            var paragraph = selection.start.paragraph;\n            if ((paragraph.paragraphFormat.textAlignment === 'Center' || paragraph.paragraphFormat.textAlignment === 'Right')\n                && paragraph.paragraphFormat.listFormat.listId === -1) {\n                paragraph.x = this.viewer.clientActiveArea.x;\n            }\n            paragraph.childWidgets[0].children.push(element);\n            element.line = paragraph.childWidgets[0];\n            element.linkFieldCharacter(this.viewer);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            this.insertElementInternal(curInline, element, indexInInline, true);\n        }\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n    };\n    Editor.prototype.insertElement = function (element) {\n        var selection = this.selection;\n        var length = 0;\n        var paragraph = undefined;\n        var lineIndex = -1;\n        var lineWidget = undefined;\n        var insertIndex = 0;\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        if (selection.start.paragraph.isEmpty()) {\n            paragraph = selection.start.paragraph;\n            lineWidget = paragraph.childWidgets[0];\n            lineIndex = 0;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            paragraph = curInline.line.paragraph;\n            lineIndex = paragraph.childWidgets.indexOf(curInline.line);\n            insertIndex = curInline.indexInOwner;\n            lineWidget = curInline.line;\n            if (indexInInline === curInline.length) { // Add new Element in current \n                insertIndex++;\n            }\n            else if (indexInInline === 0) {\n                if (isNullOrUndefined(curInline.previousNode)) {\n                    insertIndex = 0;\n                }\n            }\n            else {\n                insertIndex++;\n                var prevElement = new TextElementBox();\n                prevElement.characterFormat.copyFormat(curInline.characterFormat);\n                prevElement.text = curInline.text.substring(indexInInline);\n                curInline.text = curInline.text.substr(0, indexInInline);\n                lineWidget.children.splice(insertIndex, 0, prevElement);\n                prevElement.line = curInline.line;\n            }\n        }\n        for (var i = 0; i < element.length; i++) {\n            length += element[i].length;\n            lineWidget.children.splice(insertIndex, 0, element[i]);\n            element[i].line = lineWidget;\n            element[i].linkFieldCharacter(this.viewer);\n            insertIndex++;\n        }\n        this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, 0);\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n    };\n    Editor.prototype.insertElementInternal = function (element, newElement, index, relayout) {\n        var line = element.line;\n        var paragraph = line.paragraph;\n        var lineIndex = line.indexInOwner;\n        var insertIndex = element.indexInOwner;\n        if (index === element.length) { // Add new Element in current \n            insertIndex++;\n            line.children.splice(insertIndex, 0, newElement);\n        }\n        else if (index === 0) {\n            if (isNullOrUndefined(element.previousNode)) {\n                element.line.children.splice(0, 0, newElement);\n                insertIndex = 0;\n            }\n            else {\n                element.line.children.splice(insertIndex, 0, newElement);\n            }\n        }\n        else {\n            insertIndex++;\n            var textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(element.characterFormat);\n            textElement.text = element.text.substring(index);\n            element.text = element.text.substr(0, index);\n            line.children.splice(insertIndex, 0, textElement);\n            textElement.line = element.line;\n            //Inserts the new inline.\n            line.children.splice(insertIndex, 0, newElement);\n            insertIndex -= 1;\n        }\n        newElement.line = element.line;\n        newElement.linkFieldCharacter(this.viewer);\n        if (relayout) {\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, insertIndex);\n        }\n    };\n    /**\n     * Insert Block on undo\n     * @param  {Selection} selection\n     * @param  {WBlock} block\n     * @private\n     */\n    Editor.prototype.insertBlock = function (block) {\n        var isRemoved = true;\n        var selection = this.selection;\n        if (!selection.isEmpty) {\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (!isRemoved) {\n            selection.selectContent(selection.start, false);\n        }\n        this.insertBlockInternal(block);\n        if (this.checkInsertPosition(selection)) {\n            var paragraph = undefined;\n            if (block instanceof ParagraphWidget) {\n                paragraph = block;\n            }\n            else {\n                paragraph = this.selection.getFirstParagraphInFirstCell(block);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.updateHistoryPosition(this.getHierarchicalIndex(paragraph, '0'), true);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * Insert new Block on specific index\n     * @param  {Selection} selection\n     * @param  {BlockWidget} block\n     * @private\n     */\n    Editor.prototype.insertBlockInternal = function (block) {\n        var selection = this.selection;\n        var isRemoved = true;\n        var startPara = this.selection.start.paragraph;\n        if (!selection.start.isAtParagraphStart) {\n            if (block instanceof ParagraphWidget) {\n                this.insertNewParagraphWidget(block, false);\n                return;\n            }\n            this.updateInsertPosition();\n            startPara = startPara.combineWidget(this.viewer);\n            // tslint:disable-next-line:max-line-length\n            this.splitParagraph(startPara, startPara.firstChild, 0, selection.start.currentWidget, selection.start.offset, false);\n            selection.selectParagraph(this.selection.start.paragraph, true);\n        }\n        var bodyWidget = selection.start.paragraph.containerWidget;\n        var blockIndex = selection.start.paragraph.index;\n        var insertIndex = bodyWidget.childWidgets.indexOf(selection.start.paragraph);\n        if (!isNullOrUndefined(bodyWidget)) {\n            bodyWidget.childWidgets.splice(insertIndex, 0, block);\n            block.containerWidget = bodyWidget;\n            block.index = blockIndex;\n            block.height = 0;\n            if (block instanceof TableWidget) {\n                block.isGridUpdated = false;\n                block.buildTableColumns();\n                block.isGridUpdated = true;\n            }\n            this.updateNextBlocksIndex(block, true);\n            this.viewer.layout.layoutBodyWidgetCollection(blockIndex, bodyWidget, block, false);\n        }\n    };\n    /**\n     * Inserts the image with specified size at cursor position in the document editor.\n     * @param {string} imageString  Base64 string, web URL or file URL.\n     * @param {number} width? Image width\n     * @param {number} height? Image height\n     */\n    Editor.prototype.insertImage = function (imageString, width, height) {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        if (isNullOrUndefined(width)) {\n            width = 100;\n        }\n        if (isNullOrUndefined(height)) {\n            height = 100;\n        }\n        this.insertPicture(imageString, width, height);\n    };\n    /**\n     * Inserts a table of specified size at cursor position\n     *  in the document editor.\n     * @param {number} rows Default value of ‘rows’ parameter is 1.\n     * @param {number} columns Default value of ‘columns’ parameter is 1.\n     */\n    Editor.prototype.insertTable = function (rows, columns) {\n        var startPos = this.selection.start;\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        rows = rows || 1;\n        columns = columns || 1;\n        var table = this.createTable(rows, columns);\n        var clientWidth = startPos.paragraph.getContainerWidth();\n        table.splitWidthToTableCells(clientWidth);\n        var prevBlock = startPos.paragraph.previousWidget;\n        if (startPos.currentWidget.isFirstLine() && startPos.offset === 0 && prevBlock instanceof TableWidget) {\n            this.insertTableRows(table, prevBlock);\n            table.destroy();\n            return;\n        }\n        else {\n            this.initHistory('InsertTable');\n            this.viewer.owner.isShiftingEnabled = true;\n            this.insertBlock(table);\n        }\n        var startLine = this.selection.getFirstParagraphInFirstCell(table).childWidgets[0];\n        startPos.setPosition(startLine, true);\n        this.selection.end.setPositionInternal(startPos);\n        var lastParagraph = this.selection.getLastParagraphInLastCell(table);\n        var endOffset = lastParagraph.getLength() + 1;\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            // tslint:disable-next-line:max-line-length\n            this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(lastParagraph, endOffset.toString());\n        }\n        this.reLayout(this.selection);\n    };\n    /**\n     * Inserts the specified number of rows to the table above or below to the row at cursor position.\n     * @param {boolean} above The above parameter is optional and if omitted,\n     * it takes the value as false and inserts below the row at cursor position.\n     * @param {number} count The count parameter is optional and if omitted, it takes the value as 1.\n     */\n    Editor.prototype.insertRow = function (above, count) {\n        var rowPlacement = above ? 'Above' : 'Below';\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        if (startPos.paragraph.isInsideTable) {\n            if (this.checkIsNotRedoing()) {\n                this.initHistory(rowPlacement === 'Above' ? 'InsertRowAbove' : 'InsertRowBelow');\n            }\n            this.viewer.owner.isShiftingEnabled = true;\n            var startCell = this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0];\n            var endCell = this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0];\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            var row = rowPlacement === 'Below' ? endCell.ownerRow : startCell.ownerRow;\n            if (this.editorHistory) {\n                var clonedTable = this.cloneTableToHistoryInfo(table);\n            }\n            var rowCount = count ? count : this.getRowCountToInsert();\n            var rows = [];\n            var index = row.rowIndex;\n            if (rowPlacement === 'Below') {\n                index++;\n                var isAffectedByRowSpannedCell = isNullOrUndefined(endCell.previousWidget)\n                    || endCell.columnIndex === endCell.previousWidget.columnIndex + 1;\n                var isRowSpanEnd = endCell.cellIndex !== endCell.columnIndex && isAffectedByRowSpannedCell\n                    && row.rowIndex + startCell.cellFormat.rowSpan - 1 === endCell.ownerRow.rowIndex;\n                if (!isRowSpanEnd) {\n                    if (endCell.cellFormat.rowSpan > 1) {\n                        if (!isNullOrUndefined(row.nextWidget) && row.nextWidget instanceof TableRowWidget) {\n                            endCell.cellFormat.rowSpan += rowCount;\n                            row = row.nextWidget;\n                        }\n                    }\n                }\n            }\n            for (var i = 0; i < rowCount; i++) {\n                var cellCountInfo = this.updateRowspan(row, rowPlacement === 'Below' ? endCell : startCell, rowPlacement);\n                var newRow = this.createRowAndColumn(cellCountInfo.count, i);\n                newRow.rowFormat.copyFormat(row.rowFormat);\n                this.updateCellFormatForInsertedRow(newRow, cellCountInfo.cellFormats);\n                rows.push(newRow);\n            }\n            table.insertTableRowsInternal(rows, index);\n            var cell = undefined;\n            var paragraph = undefined;\n            if ((table.childWidgets[index] instanceof TableRowWidget)) {\n                cell = table.childWidgets[index].firstChild;\n                paragraph = this.selection.getFirstParagraph(cell);\n            }\n            else {\n                var widget = undefined;\n                while (!(widget instanceof TableWidget)) {\n                    widget = table.nextRenderedWidget;\n                }\n                paragraph = this.selection.getFirstParagraphInFirstCell(widget);\n            }\n            this.viewer.layout.reLayoutTable(table);\n            this.selection.selectParagraph(paragraph, true);\n        }\n        this.reLayout(this.selection, true);\n    };\n    Editor.prototype.updateCellFormatForInsertedRow = function (newRow, cellFormats) {\n        for (var i = 0; i < newRow.childWidgets.length; i++) {\n            newRow.childWidgets[i].cellFormat.copyFormat(cellFormats[i]);\n            newRow.childWidgets[i].cellFormat.rowSpan = 1;\n        }\n    };\n    Editor.prototype.updateRowspan = function (row, startCell, rowPlacement) {\n        var spannedCells = row.getPreviousRowSpannedCells(true);\n        var count = 0;\n        var cellFormats = [];\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            var isCellIncluded = false;\n            // Need to check with all the row spanned cells. if the start cell contains rowspan greater than 1, \n            // and when inserting below, need to increment rowspan for all row spanned cells by 1 except\n            // if the spanned cells is placed in the same column or cell to be cloned has the same row index of cloned cell row index.\n            // and when inserting above, if cloned cell placed in the same row of start cell or\n            // if the cloned cell has equal column index, need to skip updating rowspan value of cloned cell.\n            // else update row span value for spanned cell except \n            // if the spanned cells is placed in the same column or cell to be cloned has the same row index of cloned cell row index.\n            var isRowSpanned = (isNullOrUndefined(cell.previousWidget)\n                || cell.columnIndex !== cell.previousWidget.columnIndex + 1);\n            for (var j = 0; j < spannedCells.length; j++) {\n                if (isRowSpanned) {\n                    var spannedCell = spannedCells[j];\n                    var clonedRowIndex = spannedCell.ownerRow.rowIndex + spannedCell.cellFormat.rowSpan - 1;\n                    if (cell.columnIndex < spannedCell.columnIndex && cell.cellIndex !== cell.columnIndex) {\n                        isCellIncluded = true;\n                        count++;\n                        cellFormats.push(cell.cellFormat);\n                    }\n                    if (startCell.cellFormat.rowSpan === 1) {\n                        // Need to check whether cell is affected by a row spanned cell. if cell is placed on the row where it is affected \n                        // by row spanned cell, then if we are inserting row below, need to add new cell with spanned cell width\n                        // or if we are inserting above, need to update row span value of the spanned cell.\n                        // if cell is placed inbetween the spanned cell , \n                        // then if we are inserting below, need to update row span value of spanned cell or\n                        // if we are inserting above, need to skip updating row span value except\n                        // if start cell is placed on the same row of spanned cell or if start cell placed in the same column.\n                        if (clonedRowIndex > cell.ownerRow.rowIndex) {\n                            if (rowPlacement === 'Above'\n                                && spannedCell.ownerRow === startCell.ownerRow) {\n                                continue;\n                            }\n                            else {\n                                spannedCell.cellFormat.rowSpan += 1;\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                        }\n                        else if (cell.cellIndex !== cell.columnIndex && isRowSpanned && clonedRowIndex === cell.ownerRow.rowIndex) {\n                            if (rowPlacement === 'Above') {\n                                spannedCell.cellFormat.rowSpan += 1;\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                            else {\n                                count++;\n                                cellFormats.push(spannedCell.cellFormat);\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                        }\n                    }\n                    else {\n                        if (spannedCell !== startCell) {\n                            if (rowPlacement === 'Above'\n                                && (spannedCell.ownerRow === startCell.ownerRow || spannedCell.columnIndex === startCell.columnIndex)) {\n                                continue;\n                            }\n                            else {\n                                if (spannedCell.columnIndex !== startCell.columnIndex\n                                    && spannedCell.ownerRow.rowIndex !== cell.ownerRow.rowIndex\n                                    && (clonedRowIndex > startCell.ownerRow.rowIndex\n                                        || (rowPlacement === 'Above' && clonedRowIndex === startCell.ownerRow.rowIndex))) {\n                                    spannedCell.cellFormat.rowSpan += 1;\n                                    spannedCells.splice(j, 1);\n                                    j--;\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            if (spannedCells.indexOf(cell) === -1 && cell.cellFormat.rowSpan > 1) {\n                isCellIncluded = true;\n            }\n            if (!isCellIncluded) {\n                count++;\n                cellFormats.push(cell.cellFormat);\n            }\n        }\n        return { count: count, cellFormats: cellFormats };\n    };\n    Editor.prototype.insertTableRows = function (table, prevBlock) {\n        this.initHistory('InsertRowBelow');\n        table.containerWidget = prevBlock.containerWidget;\n        prevBlock = prevBlock.combineWidget(this.viewer);\n        if (this.editorHistory) {\n            var clonedTable = this.cloneTableToHistoryInfo(prevBlock);\n        }\n        var row = prevBlock.childWidgets[prevBlock.childWidgets.length - 1];\n        prevBlock.insertTableRowsInternal(table.childWidgets, prevBlock.childWidgets.length);\n        var paragraph = this.selection.getFirstParagraph(row.nextWidget.childWidgets[0]);\n        this.viewer.layout.reLayoutTable(prevBlock);\n        this.selection.selectParagraph(paragraph, true);\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            this.updateHistoryPosition(this.selection.start, true);\n            this.updateHistoryPosition(this.selection.end, false);\n        }\n        this.reLayout(this.selection);\n    };\n    /**\n     * Inserts the specified number of columns to the table left or right to the column at cursor position.\n     * @param {number} left The left parameter is optional and if omitted, it takes the value as false and\n     * inserts to the right of column at cursor position.\n     * @param {number} count The count parameter is optional and if omitted, it takes the value as 1.\n     */\n    Editor.prototype.insertColumn = function (left, count) {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var columnPlacement = left ? 'Left' : 'Right';\n        if (this.selection.start.paragraph.isInsideTable) {\n            if (this.checkIsNotRedoing()) {\n                this.initHistory(columnPlacement === 'Left' ? 'InsertColumnLeft' : 'InsertColumnRight');\n            }\n            this.selection.owner.isShiftingEnabled = true;\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            var table = startCell.ownerRow.ownerTable.combineWidget(this.viewer);\n            if (this.editorHistory) {\n                //Clones the entire table to preserve in history.\n                var clonedTable = this.cloneTableToHistoryInfo(table);\n            }\n            this.selection.owner.isLayoutEnabled = false;\n            var cellIndex = startCell.columnIndex;\n            if (columnPlacement === 'Right') {\n                cellIndex = endCell.columnIndex + endCell.cellFormat.columnSpan;\n            }\n            var startParagraph = undefined;\n            var newCell = undefined;\n            var columnCount = count ? count : this.getColumnCountToInsert();\n            var rowSpannedCells = [];\n            var rowSpanCellIndex = cellIndex;\n            for (var i = 0; i < columnCount; i++) {\n                for (var j = 0; j < table.childWidgets.length; j++) {\n                    var row = table.childWidgets[j];\n                    newCell = this.createColumn(this.selection.getLastParagraph(startCell));\n                    newCell.index = j;\n                    newCell.rowIndex = row.rowIndex;\n                    newCell.containerWidget = row;\n                    newCell.cellFormat.copyFormat(startCell.cellFormat);\n                    newCell.cellFormat.rowSpan = 1;\n                    if (isNullOrUndefined(startParagraph)) {\n                        startParagraph = this.selection.getFirstParagraph(newCell);\n                    }\n                    if (cellIndex === 0) {\n                        row.childWidgets.splice(cellIndex, 0, newCell);\n                    }\n                    else {\n                        var isCellInserted = false;\n                        for (var j_1 = 0; j_1 < row.childWidgets.length; j_1++) {\n                            var rowCell = row.childWidgets[j_1];\n                            // Add the row spanned cells to colection for adding column before / after row spnned cells.\n                            if (rowCell.cellFormat.rowSpan > 1) {\n                                rowSpannedCells.push(rowCell);\n                            }\n                            if (rowCell.columnIndex + rowCell.cellFormat.columnSpan === cellIndex) {\n                                row.childWidgets.splice(rowCell.cellIndex + 1, 0, newCell);\n                                isCellInserted = true;\n                            }\n                            else if (cellIndex > rowCell.columnIndex && rowCell.columnIndex + rowCell.cellFormat.columnSpan > cellIndex\n                                && cellIndex < rowCell.columnIndex + rowCell.cellFormat.columnSpan) {\n                                row.childWidgets.splice(rowCell.cellIndex, 0, newCell);\n                                isCellInserted = true;\n                            }\n                            if (isCellInserted) {\n                                break;\n                            }\n                        }\n                        // If the cell is not inserted for row, then check for row spanned cells.\n                        if (!isCellInserted) {\n                            if (rowSpannedCells.length > 0) {\n                                for (var k = 0; k < rowSpannedCells.length; k++) {\n                                    var rowSpannedCell = rowSpannedCells[k];\n                                    if (rowSpannedCell.ownerRow !== row\n                                        && row.rowIndex <= rowSpannedCell.ownerRow.rowIndex + rowSpannedCell.cellFormat.rowSpan - 1) {\n                                        if (rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan === cellIndex) {\n                                            if (rowSpannedCell.cellIndex > row.childWidgets.length) {\n                                                row.childWidgets.push(newCell);\n                                            }\n                                            else {\n                                                row.childWidgets.splice(rowSpannedCell.cellIndex, 0, newCell);\n                                            }\n                                            isCellInserted = true;\n                                        }\n                                        else if (cellIndex > rowSpannedCell.columnIndex &&\n                                            rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan > cellIndex\n                                            && cellIndex < rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan) {\n                                            row.childWidgets.splice(rowSpannedCell.columnIndex, 0, newCell);\n                                            isCellInserted = true;\n                                        }\n                                    }\n                                    if (isCellInserted) {\n                                        break;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            table.updateRowIndex(0);\n            var parentTable = this.viewer.layout.getParentTable(table);\n            if (parentTable) {\n                parentTable.fitChildToClientArea();\n            }\n            else {\n                table.fitChildToClientArea();\n            }\n            this.selection.owner.isLayoutEnabled = true;\n            table.isGridUpdated = false;\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n            this.viewer.layout.reLayoutTable(table);\n            this.selection.start.setPosition(startParagraph.firstChild, true);\n            this.selection.end.setPosition(this.selection.getLastParagraph(newCell).firstChild, false);\n            if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n                this.reLayout(this.selection);\n            }\n        }\n    };\n    /**\n     * Creates table with specified rows and columns.\n     * @private\n     */\n    Editor.prototype.createTable = function (rows, columns) {\n        var startPara = this.selection.start.paragraph;\n        var table = new TableWidget();\n        table.tableFormat = new WTableFormat(table);\n        table.tableFormat.preferredWidthType = 'Auto';\n        table.tableFormat.initializeTableBorders();\n        var index = 0;\n        while (index < rows) {\n            var tableRow = this.createRowAndColumn(columns, index);\n            tableRow.rowFormat.heightType = 'Auto';\n            tableRow.containerWidget = table;\n            table.childWidgets.push(tableRow);\n            index++;\n        }\n        return table;\n    };\n    Editor.prototype.createRowAndColumn = function (columns, rowIndex) {\n        var startPara = this.selection.start.paragraph;\n        var tableRow = new TableRowWidget();\n        tableRow.rowFormat = new WRowFormat(tableRow);\n        tableRow.index = rowIndex;\n        for (var i = 0; i < columns; i++) {\n            var tableCell = this.createColumn(startPara);\n            tableCell.index = i;\n            tableCell.rowIndex = rowIndex;\n            tableCell.containerWidget = tableRow;\n            tableRow.childWidgets.push(tableCell);\n        }\n        return tableRow;\n    };\n    Editor.prototype.createColumn = function (paragraph) {\n        var tableCell = new TableCellWidget();\n        var para = new ParagraphWidget();\n        para.paragraphFormat.copyFormat(paragraph.paragraphFormat);\n        para.characterFormat.copyFormat(paragraph.characterFormat);\n        para.containerWidget = tableCell;\n        tableCell.childWidgets.push(para);\n        tableCell.cellFormat = new WCellFormat(tableCell);\n        return tableCell;\n    };\n    Editor.prototype.getColumnCountToInsert = function () {\n        var count = 1;\n        var start = this.selection.start;\n        var end = this.selection.end;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        if (start && end && this.selection.getTable(start, end)) {\n            if (start.paragraph.associatedCell === end.paragraph.associatedCell) {\n                return count = 1;\n            }\n            if (start.paragraph.associatedCell.ownerRow === end.paragraph.associatedCell.ownerRow) {\n                return count = count + end.paragraph.associatedCell.cellIndex - start.paragraph.associatedCell.cellIndex;\n            }\n            else {\n                count = 0;\n                // tslint:disable-next-line:max-line-length\n                var selectedCells = start.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(start.paragraph.associatedCell, end.paragraph.associatedCell);\n                for (var i = 0; i < selectedCells.length; i++) {\n                    if (start.paragraph.associatedCell.ownerRow === selectedCells[i].ownerRow) {\n                        count++;\n                    }\n                }\n            }\n        }\n        return count === 0 ? 1 : count;\n    };\n    Editor.prototype.getRowCountToInsert = function () {\n        var count = 1;\n        var start = this.selection.start;\n        var end = this.selection.end;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(this.selection.getTable(start, end))) {\n            if (start.paragraph.associatedCell === end.paragraph.associatedCell ||\n                start.paragraph.associatedCell.ownerRow === end.paragraph.associatedCell.ownerRow) {\n                return count = 1;\n            }\n            else {\n                return count = count +\n                    this.getOwnerRow(!this.selection.isForward).rowIndex - this.getOwnerRow(this.selection.isForward).rowIndex;\n            }\n        }\n        return count === 0 ? 1 : count;\n    };\n    Editor.prototype.getOwnerCell = function (isStart) {\n        var cell = undefined;\n        var startCell = isStart ? this.selection.start.paragraph.associatedCell\n            : this.selection.end.paragraph.associatedCell;\n        var endCell = isStart ? this.selection.end.paragraph.associatedCell\n            : this.selection.start.paragraph.associatedCell;\n        cell = startCell;\n        var owner = cell.ownerTable;\n        while (!isNullOrUndefined(owner) && owner.containerWidget instanceof TableCellWidget && owner !== endCell.ownerTable) {\n            cell = owner.containerWidget;\n            owner = cell.ownerTable;\n        }\n        return cell;\n    };\n    Editor.prototype.getOwnerRow = function (isStart) {\n        var row;\n        var startRow = isStart ? this.selection.start.paragraph.associatedCell.ownerRow\n            : this.selection.end.paragraph.associatedCell.ownerRow;\n        var endRow = isStart ? this.selection.end.paragraph.associatedCell.ownerRow\n            : this.selection.start.paragraph.associatedCell.ownerRow;\n        row = startRow;\n        var owner = row.ownerTable;\n        while (!isNullOrUndefined(owner) && owner.containerWidget instanceof TableCellWidget && owner !== endRow.ownerTable) {\n            row = owner.containerWidget.ownerRow;\n            owner = row.ownerTable;\n        }\n        return row;\n    };\n    Editor.prototype.getOwnerTable = function (isStart) {\n        var table = undefined;\n        var startTable = this.selection.start.paragraph.associatedCell.ownerTable;\n        var endTable = this.selection.end.paragraph.associatedCell.ownerTable;\n        table = isStart ? startTable : endTable;\n        while (table.containerWidget instanceof TableCellWidget && table !== (isStart ? endTable : startTable)) {\n            table = table.containerWidget.ownerTable;\n        }\n        return table;\n    };\n    /**\n     * Merge Selected cells\n     * @private\n     */\n    Editor.prototype.mergeSelectedCellsInTable = function () {\n        if (!this.canMergeCells()) {\n            return;\n        }\n        if (this.checkIsNotRedoing()) {\n            this.initHistory('MergeCells');\n        }\n        this.selection.owner.isShiftingEnabled = true;\n        var startPosition = this.selection.start;\n        var endPosition = this.selection.end;\n        if (!this.selection.isForward) {\n            startPosition = this.selection.end;\n            endPosition = this.selection.start;\n        }\n        var startOwnerCell = this.getOwnerCell(this.selection.isForward);\n        var endOwnerCell = this.getOwnerCell(!this.selection.isForward);\n        var containerCell = this.selection.getContainerCellOf(startOwnerCell, endOwnerCell);\n        if (containerCell.ownerTable.contains(endOwnerCell)) {\n            if (!this.selection.containsCell(containerCell, endOwnerCell)) {\n                //Start and End are in different cells.               \n                var table = startOwnerCell.ownerTable.combineWidget(this.viewer);\n                startOwnerCell = this.selection.getSelectedCell(startOwnerCell, containerCell);\n                endOwnerCell = this.selection.getSelectedCell(endOwnerCell, containerCell);\n                //Merges the selected cells.               \n                var mergedCell = this.mergeSelectedCells(table, startOwnerCell, endOwnerCell);\n                var lastParagraph = this.selection.getLastParagraph(mergedCell);\n                endPosition.setPosition(lastParagraph.lastChild, false);\n            }\n        }\n        if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n            this.reLayout(this.selection, false);\n        }\n    };\n    Editor.prototype.mergeSelectedCells = function (table, startCell, endCell) {\n        //Clones the entire table to preserve in history.\n        var clonedTable = this.cloneTableToHistoryInfo(table);\n        this.selection.owner.isLayoutEnabled = false;\n        //Merges the selected cells.\n        var start = this.selection.getCellLeft(startCell.ownerRow, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(start, end, endCellLeft, endCellRight);\n        start = cellInfo.start;\n        end = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var rowStartIndex = table.childWidgets.indexOf(startCell.ownerRow);\n        var mergedCell = undefined;\n        for (var i = rowStartIndex; i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellStart = this.selection.getCellLeft(row, cell);\n                if (HelperMethods.round(start, 2) <= HelperMethods.round(cellStart, 2)\n                    && HelperMethods.round(cellStart, 2) < HelperMethods.round(end, 2)) {\n                    if (isNullOrUndefined(mergedCell)) {\n                        mergedCell = cell;\n                    }\n                    else {\n                        if (i === rowStartIndex) {\n                            mergedCell.cellFormat.preferredWidth += cell.cellFormat.preferredWidth;\n                            mergedCell.cellFormat.columnSpan += cell.cellFormat.columnSpan;\n                            this.mergeBorders(mergedCell, cell);\n                        }\n                        for (var k = 0; k < cell.childWidgets.length; k++) {\n                            var block = cell.childWidgets[k];\n                            if (cell.childWidgets.length === 1 && block instanceof ParagraphWidget\n                                && block.childWidgets.length === 0) {\n                                break;\n                            }\n                            mergedCell.childWidgets.push(block.clone());\n                        }\n                        row.childWidgets.splice(j, 1);\n                        cell.destroy();\n                        j--;\n                    }\n                }\n            }\n            if (row.childWidgets.length === 0) {\n                var rowIndex = table.childWidgets.indexOf(row);\n                row.updateRowBySpannedCells();\n                table.childWidgets.splice(rowIndex, 1);\n                row.destroy();\n                count--;\n                i--;\n            }\n        }\n        if (!isNullOrUndefined(mergedCell) && rowStartIndex < count) {\n            mergedCell.cellFormat.rowSpan = count - rowStartIndex + 1;\n        }\n        this.updateBlockIndexAfterMerge(mergedCell);\n        table.updateRowIndex(0);\n        table.calculateGrid();\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.layout.reLayoutTable(table);\n        //Layouts the table after merging cells.\n        this.selection.owner.isLayoutEnabled = true;\n        return mergedCell;\n    };\n    Editor.prototype.mergeBorders = function (mergedCell, tableCell) {\n        var mergedCellborders = undefined;\n        var cellBorders = null;\n        if (!isNullOrUndefined(mergedCell.cellFormat.borders)) {\n            mergedCellborders = mergedCell.cellFormat.borders;\n        }\n        if (!isNullOrUndefined(tableCell.cellFormat.borders)) {\n            cellBorders = tableCell.cellFormat.borders;\n        }\n        if (isNullOrUndefined(mergedCellborders) && isNullOrUndefined(cellBorders)) {\n            return;\n        }\n        if (isNullOrUndefined(mergedCellborders)) {\n            mergedCellborders = new WBorders(mergedCell.cellFormat);\n            mergedCellborders.copyFormat(cellBorders);\n        }\n        else if (isNullOrUndefined(cellBorders)) {\n            return;\n        }\n        else {\n            if (mergedCell.ownerRow.rowIndex === tableCell.ownerRow.rowIndex) {\n                mergedCellborders.top = mergedCell.getBorderBasedOnPriority(mergedCellborders.top, cellBorders.bottom);\n                mergedCellborders.bottom = mergedCell.getBorderBasedOnPriority(mergedCellborders.bottom, cellBorders.bottom);\n            }\n        }\n    };\n    Editor.prototype.updateBlockIndexAfterMerge = function (cell) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            cell.childWidgets[i].index = i;\n        }\n    };\n    /**\n     * Determines whether merge cell operation can be done.\n     */\n    Editor.prototype.canMergeCells = function () {\n        if (this.selection.isEmpty || !this.selection.start.paragraph.isInsideTable || !this.selection.end.paragraph.isInsideTable) {\n            return false;\n        }\n        var startPos = this.selection.start;\n        var endPos = this.selection.end;\n        if (!this.selection.isForward) {\n            startPos = this.selection.end;\n            endPos = this.selection.start;\n        }\n        var startCell = this.getOwnerCell(this.selection.isForward);\n        var endCell = this.getOwnerCell(!this.selection.isForward);\n        var containerCell = this.selection.getContainerCellOf(startCell, endCell);\n        if (containerCell.ownerTable.contains(endCell)) {\n            if (!this.selection.containsCell(containerCell, endCell)) {\n                startCell = this.selection.getSelectedCell(startCell, containerCell);\n                endCell = this.selection.getSelectedCell(endCell, containerCell);\n                var rowSpan = 1;\n                if (startCell.ownerRow === endCell.ownerRow) {\n                    var startCellIndex = startCell.ownerRow.childWidgets.indexOf(startCell);\n                    for (var i = startCellIndex; i <= startCell.ownerRow.childWidgets.indexOf(endCell); i++) {\n                        var cell = startCell.ownerRow.childWidgets[i];\n                        var prevCell = cell.previousWidget;\n                        if (i !== startCellIndex) {\n                            if (cell.cellFormat.rowSpan !== rowSpan) {\n                                return false;\n                            }\n                            if (!isNullOrUndefined(prevCell)\n                                && cell.columnIndex !== (prevCell.cellFormat.columnSpan + prevCell.columnIndex)) {\n                                return false;\n                            }\n                        }\n                        rowSpan = cell.cellFormat.rowSpan;\n                    }\n                    return true;\n                }\n                return this.canMergeSelectedCellsInTable(startCell.ownerTable, startCell, endCell);\n            }\n        }\n        return false;\n    };\n    Editor.prototype.canMergeSelectedCellsInTable = function (table, startCell, endCell) {\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var rowStartIndex = table.childWidgets.indexOf(startCell.ownerRow);\n        var startLeft = this.selection.getCellLeft(startCell.ownerRow, startCell);\n        var endLeft = startLeft + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startLeft, endLeft, endCellLeft, endCellRight);\n        startLeft = cellInfo.start;\n        endLeft = cellInfo.end;\n        var selectionLeft = 0;\n        var selectionRight = 0;\n        var isRowLeftWithinSel = false;\n        var isRowRightWithinSel = false;\n        var rowSpannedCells = [];\n        for (var i = rowStartIndex; i <= count; i++) {\n            var row = table.childWidgets[i];\n            var rowLeft = 0;\n            var rowRight = 0;\n            var isStarted = false;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellStart = this.selection.getCellLeft(row, cell);\n                if (this.checkCellWithInSelection(startLeft, endLeft, cellStart)) {\n                    isRowLeftWithinSel = false;\n                    isRowRightWithinSel = false;\n                    if (cell.cellFormat.rowSpan > 1) {\n                        rowSpannedCells.push(cell);\n                    }\n                    if (!isStarted) {\n                        rowLeft = cellStart;\n                        rowRight = cellStart;\n                        isStarted = true;\n                    }\n                    var prevCell = cell.previousWidget;\n                    if (rowRight !== 0 && HelperMethods.round(rowRight, 0) !== HelperMethods.round(cellStart, 0)) {\n                        rowRight = cellStart;\n                    }\n                    rowRight += HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n                    var isPrevCellWithinSel = this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, true);\n                    var isNextCellWithinSel = this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, false);\n                    // When selected cell not having row spanned cells and column index is not having immediate cell index value,\n                    // then returned false.\n                    var isNoRowSpan = rowSpannedCells.length === 0 || rowSpannedCells.length === 1 && rowSpannedCells[0] === cell;\n                    // checks whether current cell is with in selection.\n                    var isCellWithInSel = this.checkCurrentCell(rowSpannedCells, cell, isPrevCellWithinSel, isNextCellWithinSel);\n                    // when last selected row not having equal row span then returned false.\n                    if (i === count && !isNullOrUndefined(prevCell) && cell.cellFormat.rowSpan > prevCell.cellFormat.rowSpan\n                        && !isCellWithInSel) {\n                        return false;\n                    }\n                    if (i !== rowStartIndex) {\n                        for (var m = 0; m < rowSpannedCells.length; m++) {\n                            {\n                                var rowSpan = (rowSpannedCells[m].ownerRow.rowIndex + rowSpannedCells[m].cellFormat.rowSpan) - 1;\n                                if (rowSpan >= row.rowIndex) {\n                                    if (rowSpannedCells[m].columnIndex > cell.columnIndex) {\n                                        isRowRightWithinSel = true;\n                                    }\n                                    else {\n                                        isRowLeftWithinSel = true;\n                                    }\n                                    if (i === count && rowSpannedCells[m] !== cell\n                                        && rowSpan > (cell.ownerRow.rowIndex + cell.cellFormat.rowSpan - 1)) {\n                                        return false;\n                                    }\n                                    if (rowSpan === row.rowIndex && !this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, false)) {\n                                        rowSpannedCells.splice(rowSpannedCells.indexOf(rowSpannedCells[m]), 1);\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    if (isPrevCellWithinSel && !isNullOrUndefined(prevCell)\n                        && isNoRowSpan\n                        && (cell.columnIndex !== prevCell.columnIndex + 1 && this.checkCellWidth(cell))) {\n                        return false;\n                    }\n                }\n            }\n            if (i === rowStartIndex) {\n                selectionLeft = rowLeft;\n                selectionRight = rowRight;\n            }\n            else {\n                if (rowRight > 0 && rowLeft > 0) {\n                    if (!((isRowLeftWithinSel || Math.round(selectionLeft) === Math.round(rowLeft))\n                        && (isRowRightWithinSel || Math.round(selectionRight) === Math.round(rowRight)))) {\n                        return false;\n                    }\n                }\n                if (i === count) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.checkCellWidth = function (cell) {\n        var prevCell = cell.previousWidget;\n        var cellLeft = this.viewer.selection.getCellLeft(cell.ownerRow, cell);\n        var prevCellLeft = this.viewer.selection.getCellLeft(cell.ownerRow, prevCell);\n        var left = prevCellLeft + HelperMethods.convertPointToPixel(prevCell.cellFormat.cellWidth);\n        if (HelperMethods.round(left, 2) !== HelperMethods.round(cellLeft, 2)) {\n            return true;\n        }\n        return false;\n    };\n    ;\n    Editor.prototype.checkCellWithInSelection = function (startLeft, endLeft, cellStart) {\n        if (HelperMethods.round(startLeft, 2) <= HelperMethods.round(cellStart, 2)\n            && HelperMethods.round(cellStart, 2) < HelperMethods.round(endLeft, 2)) {\n            return true;\n        }\n        return false;\n    };\n    ;\n    Editor.prototype.checkPrevOrNextCellIsWithinSel = function (startLeft, endLeft, cell, isPrev) {\n        var prevOrNextCell = isPrev ? cell.previousWidget : cell.nextWidget;\n        var cellStart = 0;\n        if (isNullOrUndefined(prevOrNextCell)) {\n            return false;\n        }\n        cellStart = this.viewer.selection.getCellLeft(prevOrNextCell.ownerRow, prevOrNextCell);\n        return this.checkCellWithInSelection(startLeft, endLeft, cellStart);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.checkCurrentCell = function (rowSpannedCells, cell, isPrevCellWithInSel, isNextCellWithinSel) {\n        var cellOwner = cell.ownerRow;\n        if (rowSpannedCells.length > 0) {\n            for (var i = 0; i < rowSpannedCells.length; i++) {\n                var spannedCellOwner = rowSpannedCells[i].ownerRow;\n                var rowSpan = (spannedCellOwner.rowIndex + rowSpannedCells[i].cellFormat.rowSpan) - 1;\n                if (rowSpannedCells[i] === cell && (rowSpannedCells.length === 1 || this.checkRowSpannedCells(rowSpannedCells, cell))\n                    && !(isNextCellWithinSel || isPrevCellWithInSel)) {\n                    return true;\n                }\n                if (rowSpannedCells[i] !== cell && spannedCellOwner.rowIndex < cellOwner.rowIndex\n                    && rowSpan === (cellOwner.rowIndex + cell.cellFormat.rowSpan - 1)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.checkRowSpannedCells = function (rowSpannedCells, cell) {\n        for (var i = 0; i < rowSpannedCells.length; i++) {\n            if (rowSpannedCells[i] !== cell && rowSpannedCells[i].columnIndex === cell.columnIndex) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertNewParagraphWidget = function (newParagraph, insertAfter) {\n        this.updateInsertPosition();\n        this.insertParagraph(newParagraph, insertAfter);\n        if (!insertAfter) {\n            var nextParagraph = void 0;\n            var currentParagraph = newParagraph;\n            do {\n                nextParagraph = this.selection.getNextParagraphBlock(currentParagraph);\n                currentParagraph = nextParagraph;\n            } while (nextParagraph && nextParagraph.equals(newParagraph));\n            if (!isNullOrUndefined(nextParagraph)) {\n                this.selection.selectParagraph(nextParagraph, true);\n            }\n            else {\n                this.selection.selectParagraph(newParagraph, true);\n            }\n        }\n        this.fireContentChange();\n    };\n    Editor.prototype.insertParagraph = function (newParagraph, insertAfter) {\n        var lineWidget = this.selection.start.currentWidget;\n        var offset = this.selection.start.offset;\n        var currentParagraph = this.selection.start.paragraph;\n        currentParagraph = currentParagraph.combineWidget(this.viewer);\n        if (insertAfter) {\n            // tslint:disable-next-line:max-line-length\n            var length_1 = this.selection.getLineLength(currentParagraph.lastChild);\n            var insertIndex_1 = newParagraph.firstChild ? newParagraph.firstChild.children.length : 0;\n            // tslint:disable-next-line:max-line-length\n            this.moveInlines(currentParagraph, newParagraph, insertIndex_1, offset, lineWidget, length_1, currentParagraph.lastChild);\n        }\n        else if (offset > 0) {\n            this.moveInlines(currentParagraph, newParagraph, 0, 0, currentParagraph.firstChild, offset, lineWidget);\n        }\n        var splittedWidget = currentParagraph.getSplitWidgets();\n        currentParagraph = insertAfter ? splittedWidget[splittedWidget.length - 1] : splittedWidget[0];\n        var insertIndex = currentParagraph.containerWidget.childWidgets.indexOf(currentParagraph);\n        if (insertAfter) {\n            insertIndex++;\n        }\n        var bodyWidget = currentParagraph.containerWidget;\n        newParagraph.index = currentParagraph.index;\n        newParagraph.containerWidget = bodyWidget;\n        bodyWidget.childWidgets.splice(insertIndex, 0, newParagraph);\n        this.updateNextBlocksIndex(insertAfter ? currentParagraph : newParagraph, true);\n        newParagraph.height = 0;\n        this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, bodyWidget, newParagraph, false);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.moveInlines = function (currentParagraph, newParagraph, insertIndex, startOffset, startLine, endOffset, endLine) {\n        if (newParagraph.childWidgets.length === 0) {\n            var line = new LineWidget(newParagraph);\n            newParagraph.childWidgets.push(line);\n        }\n        var isMoved = false;\n        this.viewer.layout.clearListElementBox(currentParagraph);\n        this.viewer.layout.clearListElementBox(newParagraph);\n        for (var j = 0; j < currentParagraph.childWidgets.length; j++) {\n            var lineWidget = currentParagraph.childWidgets[j];\n            if (startLine === lineWidget && endLine === lineWidget) {\n                insertIndex = this.moveContent(lineWidget, startOffset, endOffset, insertIndex, newParagraph);\n                break;\n            }\n            if (endLine === lineWidget) {\n                insertIndex = this.moveContent(lineWidget, 0, endOffset, insertIndex, newParagraph);\n                break;\n            }\n            else if (startLine === lineWidget) {\n                isMoved = true;\n                // tslint:disable-next-line:max-line-length\n                insertIndex = this.moveContent(lineWidget, startOffset, this.viewer.selection.getLineLength(lineWidget), insertIndex, newParagraph);\n            }\n            else if (isMoved) {\n                insertIndex = this.moveContent(lineWidget, 0, this.viewer.selection.getLineLength(lineWidget), insertIndex, newParagraph);\n            }\n        }\n        this.removeEmptyLine(currentParagraph);\n        if (!currentParagraph.isInsideTable) {\n            this.viewer.layout.reLayoutParagraph(currentParagraph, 0, 0);\n        }\n    };\n    /**\n     * @private\n     */\n    //tslint:disable-next-line:max-line-length\n    Editor.prototype.moveContent = function (lineWidget, startOffset, endOffset, insertIndex, paragraph) {\n        var count = 0;\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var inline = lineWidget.children[i];\n            if (startOffset >= count + inline.length || inline instanceof ListTextElementBox) {\n                if (!(inline instanceof ListTextElementBox)) {\n                    count += inline.length;\n                }\n                continue;\n            }\n            var startIndex = 0;\n            if (startOffset > count) {\n                startIndex = startOffset - count;\n            }\n            var endIndex = endOffset - count;\n            if (endIndex > inline.length) {\n                endIndex = inline.length;\n            }\n            if (startIndex > 0) {\n                count += startIndex;\n            }\n            if (startIndex === 0 && endIndex === inline.length) {\n                paragraph.firstChild.children.splice(insertIndex, 0, inline);\n                inline.line = paragraph.firstChild;\n                insertIndex++;\n                // if (editAction < 4) {\n                // this.unLinkFieldCharacter(inline);\n                lineWidget.children.splice(i, 1);\n                i--;\n                // }\n            }\n            else if (inline instanceof TextElementBox) {\n                // if (editAction < 4) {\n                var span = new TextElementBox();\n                span.characterFormat.copyFormat(inline.characterFormat);\n                span.text = inline.text.substr(startIndex, endIndex - startIndex);\n                paragraph.firstChild.children.splice(insertIndex, 0, span);\n                span.line = paragraph.firstChild;\n                insertIndex++;\n                inline.text = inline.text.slice(0, startIndex) + inline.text.slice(endIndex);\n            }\n            if (endOffset <= count + endIndex - startIndex) {\n                break;\n            }\n            count += endIndex - startIndex;\n        }\n        return insertIndex;\n    };\n    /**\n     * update complex changes when history is not preserved\n     * @param  {number} action?\n     * @param  {string} start?\n     * @param  {string} end?\n     * @private\n     */\n    Editor.prototype.updateComplexWithoutHistory = function (action, start, end) {\n        var selection = this.viewer.selection;\n        if (action === 0) {\n            var startPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(startPosition, start);\n            this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n            this.setPositionForCurrentIndex(selection.start, end);\n            this.setPositionForCurrentIndex(selection.end, end);\n        }\n        if (action === 1) {\n            var startPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(startPosition, start);\n            var endPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(endPosition, end);\n            this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n            if (endPosition.paragraph !== startPosition.paragraph) {\n                this.viewer.layout.reLayoutParagraph(endPosition.paragraph, 0, 0);\n            }\n        }\n        if (selection.owner.isShiftingEnabled) {\n            this.viewer.layout.shiftLayoutedItems();\n            if (this.viewer.owner.enableHeaderAndFooter) {\n                this.updateHeaderFooterWidget();\n            }\n        }\n        selection.owner.isShiftingEnabled = false;\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        selection.fireSelectionChanged(true);\n        this.viewer.updateFocus();\n        this.viewer.updateScrollBars();\n        this.fireContentChange();\n        this.isHandledComplex = true;\n    };\n    /**\n     * reLayout\n     * @param selection\n     * @param isSelectionChanged\n     * @private\n     */\n    Editor.prototype.reLayout = function (selection, isSelectionChanged) {\n        if (!this.viewer.isComposingIME && this.editorHistory && this.editorHistory.isHandledComplexHistory()) {\n            if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n                || (this.editorHistory.currentBaseHistoryInfo\n                    && !(this.editorHistory.currentBaseHistoryInfo.action === 'ClearCharacterFormat'\n                        || this.editorHistory.currentBaseHistoryInfo.action === 'ClearParagraphFormat'))) {\n                this.startParagraph = undefined;\n                this.endParagraph = undefined;\n            }\n            this.isHandledComplex = false;\n            return;\n        }\n        if (isNullOrUndefined(this.viewer.blockToShift)) {\n            this.viewer.removeEmptyPages();\n            this.viewer.layout.updateFieldElements();\n            this.viewer.updateScrollBars();\n            if (!selection.owner.isShiftingEnabled) {\n                selection.fireSelectionChanged(true);\n                this.startParagraph = undefined;\n                this.endParagraph = undefined;\n            }\n        }\n        if (isNullOrUndefined(isSelectionChanged)) {\n            isSelectionChanged = selection.isEmpty;\n        }\n        if (selection.owner.isShiftingEnabled) {\n            selection.owner.isShiftingEnabled = false;\n            selection.owner.isLayoutEnabled = true;\n            this.viewer.layout.shiftLayoutedItems();\n            if (this.viewer.owner.enableHeaderAndFooter) {\n                this.updateHeaderFooterWidget();\n            }\n            this.getOffsetValue(selection);\n            selection.upDownSelectionLength = selection.end.location.x;\n            selection.fireSelectionChanged(true);\n            this.viewer.updateFocus();\n            this.startParagraph = undefined;\n            this.endParagraph = undefined;\n            this.viewer.layout.allowLayout = true;\n        }\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo &&\n            ((this.editorHistory.currentBaseHistoryInfo.action !== 'RowResizing'\n                && this.editorHistory.currentBaseHistoryInfo.action !== 'CellResizing')\n                || (this.editorHistory.isUndoing || this.editorHistory.isRedoing))) {\n            if (this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                this.editorHistory.currentBaseHistoryInfo.updateSelection();\n            }\n            this.editorHistory.updateHistory();\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidget = function () {\n        this.updateHeaderFooterWidgetToPage(this.selection.start.paragraph.bodyWidget);\n        this.shiftPageContent(this.selection.start.paragraph.bodyWidget);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidgetToPage = function (node) {\n        var currentPage = node.page;\n        node = this.viewer.layout.updateHeaderFooterToParent(node);\n        var isEvenPage = (node.headerFooterType === 'EvenHeader' || node.headerFooterType === 'EvenFooter');\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var page = this.viewer.pages[i];\n            if ((i + 1 === 1) && page.bodyWidgets[0].sectionFormat.differentFirstPage &&\n                node.headerFooterType.indexOf('FirstPage') !== -1) {\n                return;\n            }\n            if (page.index === 0 && page.bodyWidgets[0].sectionFormat.differentFirstPage &&\n                node.headerFooterType.indexOf('FirstPage') === -1) {\n                continue;\n            }\n            if (currentPage !== page) {\n                if (page.bodyWidgets[0].sectionFormat.differentOddAndEvenPages) {\n                    if (isEvenPage && (i + 1) % 2 === 0) {\n                        this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                    }\n                    else if ((!isEvenPage && (i + 1) % 2 !== 0)) {\n                        if (page.bodyWidgets[0].sectionFormat.differentFirstPage && (i + 1 !== 1)) {\n                            this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                        }\n                    }\n                }\n                else {\n                    this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidgetToPageInternal = function (page, widget, isHeader) {\n        if (widget.page !== page) {\n            var hfWidget = widget.clone();\n            hfWidget.page = page;\n            this.viewer.updateHFClientArea(hfWidget.sectionFormat, isHeader);\n            hfWidget = this.viewer.layout.layoutHeaderFooterItems(this.viewer, hfWidget);\n            var headerOrFooter = void 0;\n            if (isHeader) {\n                headerOrFooter = page.headerWidget;\n                page.headerWidget = hfWidget;\n            }\n            else {\n                headerOrFooter = page.footerWidget;\n                page.footerWidget = hfWidget;\n            }\n            this.removeFieldInWidget(headerOrFooter);\n            headerOrFooter.destroy();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldInWidget = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            this.removeFieldInBlock(widget.childWidgets[i]);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldInBlock = function (block) {\n        if (block instanceof TableWidget) {\n            this.removeFieldTable(block);\n        }\n        else {\n            this.removeField(block);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldTable = function (table) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.removeFieldInWidget(row.childWidgets[j]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.shiftPageContent = function (headerFooter) {\n        var type = headerFooter.headerFooterType;\n        var pageIndex;\n        if (type === 'FirstPageHeader' || type === 'FirstPageFooter') {\n            pageIndex = 0;\n        }\n        else if (headerFooter.sectionFormat.differentOddAndEvenPages) {\n            if (headerFooter.sectionFormat.differentFirstPage) {\n                pageIndex = (type === 'EvenHeader' || type === 'EvenFooter') ? 1 : 2;\n            }\n            else {\n                pageIndex = (type.indexOf('Even') === -1) ? 0 : 1;\n            }\n        }\n        else {\n            pageIndex = headerFooter.sectionFormat.differentFirstPage ? 1 : 0;\n            if (pageIndex === 1 && this.viewer.pages.length === 1) {\n                pageIndex = 0;\n            }\n        }\n        var page = this.viewer.pages[pageIndex];\n        if (type.indexOf('Header') !== -1) {\n            var firstBlock = page.bodyWidgets[0].firstChild;\n            var top_1 = HelperMethods.convertPointToPixel(headerFooter.sectionFormat.topMargin);\n            var headerDistance = HelperMethods.convertPointToPixel(headerFooter.sectionFormat.headerDistance);\n            top_1 = Math.max(headerDistance + page.headerWidget.height, top_1);\n            if (firstBlock.y !== top_1) {\n                this.viewer.updateClientArea(page.bodyWidgets[0].sectionFormat, page);\n                firstBlock = firstBlock.combineWidget(this.viewer);\n                var prevWidget = firstBlock.previousRenderedWidget;\n                if (prevWidget) {\n                    this.viewer.cutFromTop(prevWidget.y + prevWidget.height);\n                    if (firstBlock.containerWidget !== prevWidget.containerWidget) {\n                        // tslint:disable-next-line:max-line-length\n                        this.viewer.layout.updateContainerWidget(firstBlock, prevWidget.containerWidget, prevWidget.indexInOwner + 1, false);\n                    }\n                }\n                this.viewer.blockToShift = firstBlock;\n            }\n        }\n        else {\n            this.checkAndShiftFromBottom(page, headerFooter);\n        }\n        if (this.viewer.blockToShift) {\n            this.viewer.renderedLists.clear();\n            this.viewer.layout.shiftLayoutedItems();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.checkAndShiftFromBottom = function (page, footerWidget) {\n        var bodyWidget = page.bodyWidgets[0];\n        var blockToShift;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var block = bodyWidget.childWidgets[i];\n            if (block.y + block.height > footerWidget.y) {\n                blockToShift = block;\n                break;\n            }\n            if (bodyWidget.childWidgets.length - 1 === i && block.y + block.height < footerWidget.y) {\n                blockToShift = block;\n                break;\n            }\n        }\n        this.viewer.updateClientArea(bodyWidget.sectionFormat, page);\n        this.viewer.cutFromTop(blockToShift.y);\n        this.viewer.blockToShift = blockToShift;\n    };\n    //Paste Implementation ends\n    //Character Format apply implementation starts\n    /**\n     * Change HighlightColor\n     * @param  {HighlightColor} highlightColor\n     * Applies character format for selection.\n     * @param {string} property\n     * @param {Object} value\n     * @param {boolean} update\n     * @private\n     */\n    Editor.prototype.onApplyCharacterFormat = function (property, value, update) {\n        var selection = this.viewer.selection;\n        if (selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded) {\n            return;\n        }\n        update = isNullOrUndefined(update) ? false : update;\n        var action = (property[0].toUpperCase() + property.slice(1));\n        var paragraph = selection.start.paragraph;\n        var lastLine = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n        if (selection.isEmpty && selection.contextType !== 'List') {\n            selection.skipFormatRetrieval = true;\n            if (selection.end.isAtParagraphEnd) {\n                this.initHistory(action);\n                this.viewer.owner.isShiftingEnabled = true;\n                this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n                this.reLayout(this.viewer.selection);\n                this.viewer.updateFocus();\n            }\n            else {\n                selection.fireSelectionChanged(true);\n            }\n            selection.skipFormatRetrieval = false;\n            return;\n        }\n        this.setOffsetValue(selection);\n        this.initHistory(action);\n        // Todo: Complete Microsoft Word behavior on apply formatting in empty selection\n        // if (selection.isEmpty) {\n        //     this.viewer.owner.isShiftingEnabled = true;\n        //     this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n        //     this.reLayout(this.viewer.selection);\n        //     this.viewer.updateFocus();\n        //     return;\n        // }\n        if (selection.contextType === 'List') {\n            // this.updateCharacterFormatForListText(selection, action, value, update);\n            this.applyCharacterFormatForListText(selection, property, value, update);\n        }\n        else {\n            //Iterate and update format.\n            this.updateSelectionCharacterFormatting(property, value, update);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharacterFormatForListText = function (selection, property, values, update) {\n        var listLevel = this.getListLevel(selection.start.paragraph);\n        if (isNullOrUndefined(listLevel)) {\n            return;\n        }\n        var characterFormat = listLevel.characterFormat;\n        switch (property) {\n            case 'bold':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'bold', !(characterFormat.bold));\n                break;\n            case 'italic':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'italic', !(characterFormat.italic));\n                break;\n            case 'fontColor':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontColor', values);\n                break;\n            case 'fontFamily':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontFamily', values);\n                break;\n            case 'fontSize':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontSize', values);\n                break;\n            case 'highlightColor':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'highlightColor', values);\n                break;\n            case 'baselineAlignment':\n                if (characterFormat.baselineAlignment === values) {\n                    values = 'Normal';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'baselineAlignment', values);\n                break;\n            case 'strikethrough':\n                if (characterFormat.strikethrough === values) {\n                    values = 'None';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'strikethrough', values);\n                break;\n            case 'underline':\n                if (characterFormat.underline === values) {\n                    values = 'None';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'underline', values);\n                break;\n            case 'characterFormat':\n                this.applyListCharacterFormatByValue(selection, characterFormat, undefined, values);\n                break;\n        }\n    };\n    Editor.prototype.applyListCharacterFormatByValue = function (selection, format, property, value) {\n        this.initHistory('ListCharacterFormat');\n        this.applyCharFormatValue(format, property, value, false);\n        this.editorHistory.updateHistory();\n        this.reLayout(selection);\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateListCharacterFormat = function (selection, property, value) {\n        this.updateListTextSelRange(selection, property, value, false);\n    };\n    Editor.prototype.updateListTextSelRange = function (selection, property, value, update) {\n        this.viewer.owner.isShiftingEnabled = true;\n        var startPositionInternal = selection.start;\n        var endPositionInternal = selection.end;\n        if (!selection.isForward) {\n            startPositionInternal = selection.end;\n            endPositionInternal = selection.start;\n        }\n        this.initHistoryPosition(selection, startPositionInternal);\n        var listLevel = this.getListLevel(selection.start.paragraph);\n        this.applyCharFormatValue(listLevel.characterFormat, property, value, update);\n        this.startSelectionReLayouting(startPositionInternal.paragraph, selection, startPositionInternal, endPositionInternal);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getListLevel = function (paragraph) {\n        var currentList = undefined;\n        var listLevelNumber = 0;\n        if (!isNullOrUndefined(paragraph.paragraphFormat) && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n            currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n        }\n        if (!isNullOrUndefined(currentList) &&\n            !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n            // && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels.getItem(listLevelNumber))) {\n            && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels)) {\n            return this.viewer.layout.getListLevel(currentList, listLevelNumber);\n        }\n        return undefined;\n    };\n    Editor.prototype.updateInsertPosition = function () {\n        var selection = this.viewer.selection;\n        var position = selection.start;\n        if (!selection.isForward) {\n            position = selection.end;\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && !isNullOrUndefined(position)) {\n            if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                this.updateHistoryPosition(position, true);\n            }\n        }\n    };\n    /**\n     * preserve paragraph and offset value for selection\n     * @private\n     */\n    Editor.prototype.setOffsetValue = function (selection) {\n        var info = this.getParagraphInfo(selection.start);\n        this.startParagraph = info.paragraph;\n        this.startOffset = info.offset;\n        info = this.getParagraphInfo(selection.end);\n        this.endParagraph = info.paragraph;\n        this.endOffset = info.offset;\n    };\n    /**\n     * Toggles the highlight color property of selected contents.\n     * @param {HighlightColor} highlightColor Default value of ‘underline’ parameter is Yellow.\n     */\n    Editor.prototype.toggleHighlightColor = function (highlightColor) {\n        var selection = this.viewer.selection;\n        if (isNullOrUndefined(highlightColor) || highlightColor === 'NoColor') {\n            highlightColor = 'Yellow';\n        }\n        //In Ms Word the highlight color is took from the ribbon. So we Have given yellow as constant.\n        if (selection.characterFormat.highlightColor === highlightColor) {\n            highlightColor = 'NoColor';\n        }\n        this.selection.characterFormat.highlightColor = highlightColor;\n    };\n    /**\n     * Toggles the subscript formatting of selected contents.\n     */\n    Editor.prototype.toggleSubscript = function () {\n        if (!this.owner.isReadOnlyMode) {\n            var value = this.selection.characterFormat.baselineAlignment === 'Subscript' ? 'Normal' : 'Subscript';\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    /**\n     * Toggles the superscript formatting of selected contents.\n     */\n    Editor.prototype.toggleSuperscript = function () {\n        if (!this.owner.isReadOnlyMode) {\n            var value = this.selection.characterFormat.baselineAlignment === 'Superscript' ? 'Normal' : 'Superscript';\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    /**\n     * Toggles the text alignment property of selected contents.\n     * @param {TextAlignment} textAlignment Default value of ‘textAlignment parameter is TextAlignment.Left.\n     */\n    /**\n     * Increases the left indent of selected paragraphs to a factor of 36 points.\n     */\n    Editor.prototype.increaseIndent = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.onApplyParagraphFormat('leftIndent', this.viewer.defaultTabWidth, true, false);\n        }\n    };\n    /**\n     * Decreases the left indent of selected paragraphs to a factor of 36 points.\n     */\n    Editor.prototype.decreaseIndent = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.onApplyParagraphFormat('leftIndent', -this.viewer.defaultTabWidth, true, false);\n        }\n    };\n    /**\n     * Clears the list format for selected paragraphs.\n     */\n    Editor.prototype.clearList = function () {\n        this.selection.owner.editorModule.onApplyList(undefined);\n    };\n    /**\n     * Applies the bullet list to selected paragraphs.\n     * @param {string} bullet Bullet character\n     * @param {string} fontFamily Bullet font family\n     */\n    Editor.prototype.applyBullet = function (bullet, fontFamily) {\n        if (!this.owner.isReadOnlyMode) {\n            this.applyBulletOrNumbering(bullet, 'Bullet', fontFamily);\n        }\n    };\n    /**\n     * Applies the numbering list to selected paragraphs.\n     * @param numberFormat  “%n” representations in ‘numberFormat’ parameter will be replaced by respective list level’s value.\n     * `“%1)” will be displayed as “1)” `\n     * @param listLevelPattern  Default value of ‘listLevelPattern’ parameter is ListLevelPattern.Arabic\n     */\n    Editor.prototype.applyNumbering = function (numberFormat, listLevelPattern) {\n        if (!this.owner.isReadOnlyMode) {\n            this.applyBulletOrNumbering(numberFormat, listLevelPattern, 'Verdana');\n        }\n    };\n    /**\n     * Toggles the baseline alignment property of selected contents.\n     * @param  {Selection} selection\n     * @param  {BaselineAlignment} baseAlignment\n     */\n    Editor.prototype.toggleBaselineAlignment = function (baseAlignment) {\n        this.updateProperty(2, baseAlignment);\n    };\n    /**\n     * Clears the formatting.\n     */\n    Editor.prototype.clearFormatting = function () {\n        var selection = this.viewer.selection;\n        this.initComplexHistory('ClearFormat');\n        // let startIndex: string = selection.start.getHierarchicalIndexInternal();\n        // let endIndex: string = selection.end.getHierarchicalIndexInternal();\n        if (selection.isEmpty) {\n            selection.start.moveToParagraphStartInternal(selection, false);\n            selection.end.moveToParagraphEndInternal(selection, false);\n        }\n        this.setOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ClearCharacterFormat');\n        }\n        this.updateSelectionCharacterFormatting('ClearCharacterFormat', undefined, false);\n        this.getOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.setOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ClearParagraphFormat');\n        }\n        this.updateParagraphFormatInternal('ClearParagraphFormat', undefined, false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.getOffsetValue(selection);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            this.editorHistory.updateComplexHistory();\n        }\n        this.startParagraph = undefined;\n        this.endParagraph = undefined;\n        // else {\n        //     this.checkAndUpdatedSelection(startIndex, endIndex);\n        // }\n    };\n    /**\n     * Toggles the specified property. If property is assigned already. Then property will be changed\n     * @param  {Selection} selection\n     * @param  {number} type\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateProperty = function (type, value) {\n        var selection = this.selection;\n        if (selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded) {\n            return;\n        }\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        var indexInInline = 0;\n        var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        var paragraph = startPosition.paragraph;\n        if (!isNullOrUndefined(inline) && inline.length === indexInInline && !this.selection.isEmpty) {\n            inline = inline.nextNode;\n        }\n        if (type === 1) {\n            var currentUnderline = 'None';\n            if (!isNullOrUndefined(inline)) {\n                currentUnderline = inline.characterFormat.underline;\n            }\n            else if (!isNullOrUndefined(paragraph)) {\n                currentUnderline = paragraph.characterFormat.underline;\n            }\n            this.selection.characterFormat.underline = value === currentUnderline ? 'None' : value;\n        }\n        else {\n            var script = 'Normal';\n            if (!isNullOrUndefined(inline)) {\n                script = inline.characterFormat.baselineAlignment;\n            }\n            else if (!isNullOrUndefined(paragraph)) {\n                script = paragraph.characterFormat.baselineAlignment;\n            }\n            if (script === value) {\n                value = 'Normal';\n            }\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    Editor.prototype.getCompleteStyles = function () {\n        var completeStylesString = '{\"styles\":[';\n        for (var _i = 0, _a = this.viewer.preDefinedStyles.getItem(); _i < _a.length; _i++) {\n            var name_1 = _a[_i];\n            completeStylesString += (this.viewer.preDefinedStyles.get(name_1) + ',');\n        }\n        return completeStylesString.slice(0, -1) + ']}';\n    };\n    /**\n     * Initialize default styles\n     * @private\n     */\n    Editor.prototype.intializeDefaultStyles = function () {\n        var existingStyles = this.owner.getStyleNames('Paragraph');\n        var defaultStyleNames = ['Normal', 'Heading 1', 'Heading 2', 'Heading 3', 'Heading 4', 'Heading 5', 'Heading 6'];\n        var styleNames = defaultStyleNames.filter(function (val) {\n            return existingStyles.indexOf(val) === -1;\n        });\n        for (var _i = 0, styleNames_1 = styleNames; _i < styleNames_1.length; _i++) {\n            var name_2 = styleNames_1[_i];\n            this.createStyle(this.viewer.preDefinedStyles.get(name_2));\n        }\n    };\n    /**\n     * Creates a new instance of Style.\n     */\n    Editor.prototype.createStyle = function (styleString) {\n        this.createStyleIn(styleString);\n    };\n    /**\n     * Create a Style.\n     * @private\n     */\n    Editor.prototype.createStyleIn = function (styleString) {\n        /* tslint:disable:no-any */\n        var style = JSON.parse(styleString);\n        var styleObj = this.viewer.styles.findByName(style.name);\n        if (styleObj !== undefined) {\n            //Create a new style with new name and add it to collection.\n            style.name = this.getUniqueStyleName(style.name);\n        }\n        this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), style, this.viewer.styles);\n        return this.viewer.styles.findByName(style.name);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getUniqueStyleName = function (name) {\n        var uniqueName = this.getUniqueName(name);\n        var style = this.viewer.styles.findByName(uniqueName);\n        while (!isNullOrUndefined(style)) {\n            uniqueName = this.getUniqueStyleName(style.name);\n            style = this.viewer.styles.findByName(uniqueName);\n        }\n        return uniqueName;\n    };\n    Editor.prototype.getUniqueName = function (name) {\n        var matchArray = name.match(/\\d+$/);\n        var returnName;\n        if (!isNullOrUndefined(matchArray) && matchArray.length > 0) {\n            return name.replace(matchArray[0], (parseInt(matchArray[0], 10) + 1).toString());\n        }\n        else {\n            return name + '_1';\n        }\n    };\n    /**\n     * Update Character format for selection\n     * @private\n     */\n    Editor.prototype.updateSelectionCharacterFormatting = function (property, values, update) {\n        if (isNullOrUndefined(property)) {\n            property = 'CharacterFormat';\n        }\n        switch (property) {\n            case 'bold':\n                this.updateCharacterFormat('bold', values);\n                break;\n            case 'italic':\n                this.updateCharacterFormat('italic', values);\n                break;\n            case 'fontColor':\n                this.updateCharacterFormat('fontColor', values);\n                break;\n            case 'fontFamily':\n                this.updateCharacterFormat('fontFamily', values);\n                break;\n            case 'fontSize':\n                this.updateCharacterFormatWithUpdate(this.viewer.selection, 'fontSize', values, update);\n                break;\n            case 'highlightColor':\n                this.updateCharacterFormat('highlightColor', values);\n                break;\n            case 'baselineAlignment':\n                this.updateCharacterFormat('baselineAlignment', values);\n                break;\n            case 'strikethrough':\n                this.updateCharacterFormat('strikethrough', values);\n                break;\n            case 'underline':\n                this.updateCharacterFormat('underline', values);\n                break;\n            case 'styleName':\n                this.updateCharacterFormatWithUpdate(this.viewer.selection, 'styleName', values, true);\n                break;\n            case 'CharacterFormat':\n                this.updateCharacterFormat(undefined, values);\n                break;\n            case 'ClearCharacterFormat':\n                this.updateCharacterFormat(undefined, values);\n                break;\n        }\n        this.reLayout(this.viewer.selection);\n    };\n    /**\n     * Update character format for selection range\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @returns void\n     * @private\n     */\n    Editor.prototype.updateCharacterFormat = function (property, value) {\n        this.updateCharacterFormatWithUpdate(this.viewer.selection, property, value, false);\n    };\n    Editor.prototype.updateCharacterFormatWithUpdate = function (selection, property, value, update) {\n        this.viewer.owner.isShiftingEnabled = true;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        this.applyCharFormatSelectedContent(startPosition.paragraph, selection, startPosition, endPosition, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatSelectedContent = function (paragraph, selection, start, end, property, value, update) {\n        //Selection start in cell.\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            var cell = void 0;\n            start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(start, true);\n            }\n            cell = start.paragraph.associatedCell;\n            this.applyCharFormatCell(cell, selection, start, end, property, value, update);\n            var table = cell.ownerTable;\n            // tslint:disable-next-line:max-line-length\n            this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        }\n        else {\n            this.applyCharFormat(paragraph, selection, start, end, property, value, update);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelectedPara = function (paragraph, selection, property, value, update) {\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var line = paragraph.childWidgets[i];\n            for (var j = 0; j < line.children.length; j++) {\n                var element = line.children[j];\n                this.applyCharFormatValue(element.characterFormat, property, value, update);\n            }\n        }\n        this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n    };\n    Editor.prototype.splittedLastParagraph = function (paragraph) {\n        var splittedWidets = paragraph.getSplitWidgets();\n        return splittedWidets[splittedWidets.length - 1];\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.getNextParagraphForCharacterFormatting = function (block, start, end, property, value, update) {\n        var widgetCollection = block.getSplitWidgets();\n        block = widgetCollection[widgetCollection.length - 1];\n        block = this.viewer.selection.getNextRenderedBlock(block);\n        if (!isNullOrUndefined(block)) { //Goto the next block.\n            if (block instanceof ParagraphWidget) {\n                this.applyCharFormat(block, this.viewer.selection, start, end, property, value, update);\n            }\n            else {\n                this.applyCharFormatForTable(0, block, this.viewer.selection, start, end, property, value, update);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormat = function (paragraph, selection, start, end, property, value, update) {\n        paragraph = paragraph.combineWidget(this.viewer);\n        var startOffset = 0;\n        var length = selection.getParagraphLength(paragraph);\n        var startLineWidget = paragraph.childWidgets.indexOf(start.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(start.currentWidget) : 0;\n        var endOffset = end.offset;\n        var endLineWidget = paragraph.childWidgets.indexOf(end.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(end.currentWidget) : paragraph.childWidgets.length - 1;\n        if (!isNullOrUndefined(selection)) {\n            if (paragraph === start.paragraph) {\n                startOffset = start.offset;\n            }\n        }\n        if (!paragraph.equals(end.paragraph)) {\n            this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n            endOffset = length;\n        }\n        else {\n            var lastLine = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n            if (selection.isParagraphLastLine(lastLine) && end.currentWidget === lastLine\n                && ((endOffset === selection.getLineLength(lastLine) + 1) || (selection.isEmpty && selection.end.isAtParagraphEnd))) {\n                this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n            }\n        }\n        // let count: number = 0;\n        for (var i = startLineWidget; i <= endLineWidget; i++) {\n            var line = paragraph.childWidgets[i];\n            if (i !== startLineWidget) {\n                startOffset = selection.getStartLineOffset(line);\n            }\n            if (line === end.currentWidget) {\n                endOffset = end.offset;\n            }\n            else {\n                endOffset = selection.getLineLength(line);\n            }\n            var count = 0;\n            for (var j = 0; j < line.children.length; j++) {\n                var inlineObj = line.children[j];\n                if (inlineObj instanceof ListTextElementBox) {\n                    continue;\n                }\n                if (startOffset >= count + inlineObj.length) {\n                    count += inlineObj.length;\n                    continue;\n                }\n                var startIndex = 0;\n                if (startOffset > count) {\n                    startIndex = startOffset - count;\n                }\n                var endIndex = endOffset - count;\n                var inlineLength = inlineObj.length;\n                if (endIndex > inlineLength) {\n                    endIndex = inlineLength;\n                }\n                j += this.applyCharFormatInline(inlineObj, selection, startIndex, endIndex, property, value, update);\n                if (endOffset <= count + inlineLength) {\n                    break;\n                }\n                count += inlineLength;\n            }\n        }\n        var endParagraph = end.paragraph;\n        this.viewer.layout.reLayoutParagraph(paragraph, startLineWidget, 0);\n        if (paragraph.equals(endParagraph)) {\n            return;\n        }\n        this.getNextParagraphForCharacterFormatting(paragraph, start, end, property, value, update);\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     */\n    Editor.prototype.toggleBold = function () {\n        if (this.viewer.owner.isReadOnlyMode) {\n            return;\n        }\n        var value = this.getCurrentSelectionValue('bold');\n        this.selection.characterFormat.bold = value;\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     */\n    Editor.prototype.toggleItalic = function () {\n        if (this.viewer.owner.isReadOnlyMode) {\n            return;\n        }\n        var value = this.getCurrentSelectionValue('italic');\n        this.selection.characterFormat.italic = value;\n    };\n    Editor.prototype.getCurrentSelectionValue = function (property) {\n        var value = false;\n        if ((property === 'bold' || property === 'italic')) {\n            var index = 0;\n            var start = this.selection.start;\n            if (!this.selection.isForward) {\n                start = this.selection.end;\n            }\n            var lineWidget = start.currentWidget;\n            var inlineObj = lineWidget.getInline(start.offset, index);\n            var inline = inlineObj.element;\n            // inline.ownerBase\n            index = inlineObj.index;\n            var characterFormat = lineWidget.paragraph.characterFormat;\n            if (!isNullOrUndefined(inline)) {\n                if (!this.selection.isEmpty && index === inline.length) {\n                    characterFormat = isNullOrUndefined(inline.nextNode) ? lineWidget.paragraph.characterFormat\n                        : inline.nextNode.characterFormat;\n                }\n                else {\n                    characterFormat = inline.characterFormat;\n                }\n            }\n            if (property === 'bold') {\n                value = !(characterFormat.bold);\n            }\n            if (property === 'italic') {\n                value = !(characterFormat.italic);\n            }\n        }\n        return value;\n    };\n    /**\n     * Toggles the underline property of selected contents.\n     * @param underline Default value of ‘underline’ parameter is Single.\n     */\n    Editor.prototype.toggleUnderline = function (underline) {\n        if (!this.owner.isReadOnlyMode) {\n            this.updateProperty(1, underline);\n        }\n    };\n    /**\n     * Toggles the strike through property of selected contents.\n     * @param {Strikethrough} strikethrough Default value of strikethrough parameter is SingleStrike.\n     */\n    Editor.prototype.toggleStrikethrough = function (strikethrough) {\n        if (!this.owner.isReadOnlyMode) {\n            var value = void 0;\n            if (isNullOrUndefined(strikethrough)) {\n                value = this.selection.characterFormat.strikethrough === 'SingleStrike' ? 'None' : 'SingleStrike';\n            }\n            else {\n                value = strikethrough;\n            }\n            this.selection.characterFormat.strikethrough = value;\n        }\n    };\n    Editor.prototype.updateFontSize = function (format, value) {\n        if (typeof (value) === 'number' && !(value < 0 && format.fontSize === 1)) {\n            return format.fontSize + value;\n        }\n        var fontsizeCollection = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72];\n        if (typeof (value) === 'string' && value === 'increment') {\n            if (format.fontSize < 8) {\n                return format.fontSize + 1;\n            }\n            else if (format.fontSize >= 72 && format.fontSize < 80) {\n                return 80;\n            }\n            else if (format.fontSize >= 80) {\n                return format.fontSize + 10;\n            }\n            else {\n                for (var i = 0; i < fontsizeCollection.length; i++) {\n                    if (format.fontSize < fontsizeCollection[i]) {\n                        return fontsizeCollection[i];\n                    }\n                }\n            }\n        }\n        else if (typeof (value) === 'string' && value === 'decrement' && format.fontSize > 1) {\n            if (format.fontSize <= 8) {\n                return format.fontSize - 1;\n            }\n            else if (format.fontSize > 72 && format.fontSize <= 80) {\n                return 72;\n            }\n            else if (format.fontSize > 80) {\n                return format.fontSize - 10;\n            }\n            else {\n                for (var i = 0; i < fontsizeCollection.length; i++) {\n                    if (format.fontSize <= fontsizeCollection[i]) {\n                        return fontsizeCollection[i - 1];\n                    }\n                }\n            }\n        }\n        return format.fontSize;\n    };\n    // Inline\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatInline = function (inline, selection, startIndex, endIndex, property, value, update) {\n        if (startIndex === 0 && endIndex === inline.length) {\n            this.applyCharFormatValue(inline.characterFormat, property, value, update);\n            return 0;\n        }\n        else if (inline instanceof TextElementBox) {\n            return this.formatInline(inline, selection, startIndex, endIndex, property, value, update);\n        }\n        return 0;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.formatInline = function (inline, selection, startIndex, endIndex, property, value, update) {\n        var x = 0;\n        var node = inline;\n        var index = inline.line.children.indexOf(node);\n        var paragraph = inline.paragraph;\n        var lineIndex = paragraph.childWidgets.indexOf(inline.line);\n        var textElement;\n        if (startIndex > 0) {\n            textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(inline.characterFormat);\n            textElement.line = inline.line;\n            textElement.text = inline.text.substr(startIndex, endIndex - startIndex);\n            this.applyCharFormatValue(textElement.characterFormat, property, value, update);\n            index++;\n            node.line.children.splice(index, 0, textElement);\n            x++;\n            // this.addToLinkedFields(span);                      \n        }\n        if (endIndex < node.length) {\n            textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(inline.characterFormat);\n            textElement.text = node.text.substring(endIndex);\n            textElement.line = inline.line;\n            index++;\n            node.line.children.splice(index, 0, textElement);\n            x++;\n            // this.addToLinkedFields(span);                       \n        }\n        if (startIndex === 0) {\n            inline.text = inline.text.substr(0, endIndex);\n            this.applyCharFormatValue(inline.characterFormat, property, value, update);\n        }\n        else {\n            inline.text = inline.text.substr(0, startIndex);\n        }\n        return x;\n    };\n    // Cell\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatCell = function (cell, selection, start, end, property, value, update) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = selection.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cell, containerCell);\n                var endCell = selection.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (selection.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(containerCell, start, end)) {\n                        value = this.getCharacterFormatValueOfCell(cell, selection, value, property);\n                        this.applyCharFormatForSelectedCell(containerCell, selection, property, value, update);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.applyCharFormat(start.paragraph, selection, start, end, property, value, update);\n                        }\n                        else {\n                            this.applyCharFormatRow(startCell.ownerRow, selection, start, end, property, value, update);\n                        }\n                    }\n                }\n                else { //Format other selected cells in current table.\n                    this.applyCharFormatForTableCell(containerCell.ownerTable, selection, containerCell, endCell, property, value, update);\n                }\n            }\n            else {\n                this.applyCharFormatRow(containerCell.ownerRow, selection, start, end, property, value, update);\n            }\n        }\n        else {\n            var tableCell = selection.getContainerCell(cell);\n            this.applyCharFormatRow(tableCell.ownerRow, selection, start, end, property, value, update);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelectedCell = function (cell, selection, property, value, update) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                this.applyCharFormatForSelectedPara(block, selection, property, value, update);\n            }\n            else {\n                this.applyCharFormatForSelTable(block, selection, property, value, update);\n            }\n        }\n    };\n    // Row\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatRow = function (row, selection, start, end, property, value, update) {\n        value = this.getCharacterFormatValueOfCell(row.childWidgets[0], selection, value, property);\n        this.applyCharFormatForTable(row.rowIndex, row.ownerTable, selection, start, end, property, value, update);\n    };\n    // Table\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForTable = function (index, table, selection, start, end, property, value, update) {\n        table = table.combineWidget(this.viewer);\n        for (var i = index; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n            }\n            if (end.paragraph.isInsideTable && selection.containsRow(row, end.paragraph.associatedCell)) {\n                this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n                return;\n            }\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        this.getNextParagraphForCharacterFormatting(table, start, end, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelTable = function (tableWidget, selection, property, value, update) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var row = tableWidget.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForTableCell = function (table, selection, startCell, endCell, property, value, update) {\n        var startCellLeft = selection.getCellLeft(startCell.ownerRow, startCell);\n        var startCellRight = startCellLeft + startCell.cellFormat.cellWidth;\n        var endCellLeft = selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startCellLeft, startCellRight, endCellLeft, endCellRight);\n        startCellLeft = cellInfo.start;\n        startCellRight = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var isStarted = false;\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var left = selection.getCellLeft(row, row.childWidgets[j]);\n                if (HelperMethods.round(startCellLeft, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(startCellRight, 2)) {\n                    if (!isStarted) {\n                        value = this.getCharacterFormatValueOfCell(row.childWidgets[j], selection, value, property);\n                        isStarted = true;\n                    }\n                    this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n                }\n            }\n        }\n    };\n    Editor.prototype.updateSelectedCellsInTable = function (start, end, endCellLeft, endCellRight) {\n        var selection = this.viewer.selection;\n        if (start > endCellLeft) {\n            start = endCellLeft;\n        }\n        if (end < endCellRight) {\n            end = endCellRight;\n        }\n        if (start > selection.upDownSelectionLength) {\n            start = selection.upDownSelectionLength;\n        }\n        if (end < selection.upDownSelectionLength) {\n            end = selection.upDownSelectionLength;\n        }\n        return { start: start, end: end };\n    };\n    Editor.prototype.getCharacterFormatValueOfCell = function (cell, selection, value, property) {\n        if (typeof (value) === 'boolean' || (value === undefined && (property === 'bold' || property === 'italic'))) {\n            var firstParagraph = selection.getFirstParagraph(cell);\n            var format = firstParagraph.characterFormat;\n            if (firstParagraph.childWidgets.length > 0 && firstParagraph.childWidgets[0].children.length > 0) {\n                format = firstParagraph.childWidgets[0].children[0].characterFormat;\n            }\n            value = !format.getPropertyValue(property);\n        }\n        return value;\n    };\n    /**\n     * Apply Character format for selection\n     * @private\n     */\n    Editor.prototype.applyCharFormatValueInternal = function (selection, format, property, value) {\n        this.applyCharFormatValue(format, property, value, false);\n    };\n    Editor.prototype.copyInlineCharacterFormat = function (sourceFormat, destFormat) {\n        destFormat.uniqueCharacterFormat = sourceFormat.uniqueCharacterFormat;\n        destFormat.baseCharStyle = sourceFormat.baseCharStyle;\n    };\n    Editor.prototype.applyCharFormatValue = function (format, property, value, update) {\n        if (update && property === 'fontSize') {\n            value = this.updateFontSize(format, value);\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(format, property, value);\n        }\n        if (value instanceof WCharacterFormat) {\n            if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n                this.copyInlineCharacterFormat(value, format);\n            }\n            else {\n                format.copyFormat(value);\n            }\n            return;\n        }\n        if (isNullOrUndefined(value)) {\n            format.clearFormat();\n            return;\n        }\n        if (property === 'bold') {\n            format.bold = value;\n        }\n        else if (property === 'italic') {\n            format.italic = value;\n        }\n        else if (property === 'fontColor') {\n            format.fontColor = value;\n        }\n        else if (property === 'fontFamily') {\n            format.fontFamily = value;\n        }\n        else if (property === 'fontSize') {\n            format.fontSize = value;\n        }\n        else if (property === 'highlightColor') {\n            format.highlightColor = value;\n        }\n        else if (property === 'baselineAlignment') {\n            format.baselineAlignment = value;\n        }\n        else if (property === 'strikethrough') {\n            format.strikethrough = value;\n        }\n        else if (property === 'underline') {\n            format.underline = value;\n        }\n        else if (property === 'styleName') {\n            format.baseCharStyle = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onImageFormat = function (elementBox, width, height) {\n        var modifiedFormat = new ImageFormat(elementBox);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ImageResizing');\n            this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(modifiedFormat);\n        }\n        this.setOffsetValue(this.selection);\n        elementBox.width = width;\n        elementBox.height = height;\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.reLayoutParagraph(elementBox.line.paragraph, elementBox.line.indexInOwner, 0);\n        this.reLayout(this.selection, false);\n        if (this.viewer.owner.imageResizerModule) {\n            this.viewer.owner.imageResizerModule.positionImageResizer(elementBox);\n        }\n    };\n    /**\n     * Toggles the text alignment of selected paragraphs.\n     * @param  {TextAlignment} textAlignment\n     */\n    Editor.prototype.toggleTextAlignment = function (textAlignment) {\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        // Toggle performed based on current selection format similar to MS word behavior.\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.viewer.selection.paragraphFormat.textAlignment) && this.viewer.selection.paragraphFormat.textAlignment === textAlignment) {\n            if (textAlignment === 'Left') {\n                this.onApplyParagraphFormat('textAlignment', 'Justify', false, true);\n            }\n            else {\n                this.onApplyParagraphFormat('textAlignment', 'Left', false, true);\n            }\n        }\n        else {\n            this.onApplyParagraphFormat('textAlignment', textAlignment, false, true);\n        }\n    };\n    /**\n     * Applies paragraph format for the selection ranges.\n     * @param {string} property\n     * @param {Object} value\n     * @param {boolean} update\n     * @param {boolean} isSelectionChanged\n     * @private\n     */\n    Editor.prototype.onApplyParagraphFormat = function (property, value, update, isSelectionChanged) {\n        var action = (property[0].toUpperCase() + property.slice(1));\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        this.initHistory(action);\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        if (property === 'leftIndent') {\n            if (selection.paragraphFormat.listId !== -1 && update) {\n                this.updateListLevel(value > 0);\n                return;\n            }\n        }\n        if (selection.isEmpty) {\n            this.setOffsetValue(selection);\n            if (update && property === 'leftIndent') {\n                value = this.getIndentIncrementValue(selection.start.paragraph, value);\n            }\n            var para = selection.start.paragraph.combineWidget(this.viewer);\n            this.applyParaFormatProperty(para, property, value, update);\n            this.layoutItemBlock(para, false);\n        }\n        else {\n            //Iterate and update formatting's.      \n            this.setOffsetValue(selection);\n            this.updateSelectionParagraphFormatting(property, value, update);\n        }\n        this.reLayout(selection);\n    };\n    /**\n     * Update the list level\n     * @param  {boolean} increaseLevel\n     * @private\n     */\n    Editor.prototype.updateListLevel = function (increaseLevel) {\n        // Increment or Decrement list level for Multilevel lists.\n        var viewer = this.viewer;\n        var listFormat = this.viewer.selection.start.paragraph.paragraphFormat.listFormat;\n        var paragraphFormat = this.viewer.selection.start.paragraph.paragraphFormat;\n        var list = viewer.getListById(paragraphFormat.listFormat.listId);\n        var listLevel = viewer.layout.getListLevel(list, paragraphFormat.listFormat.listLevelNumber);\n        var levelNumber;\n        if (increaseLevel) {\n            levelNumber = paragraphFormat.listFormat.listLevelNumber + 1;\n        }\n        else {\n            levelNumber = paragraphFormat.listFormat.listLevelNumber - 1;\n        }\n        var nextListLevel = viewer.layout.getListLevel(list, levelNumber);\n        if (!isNullOrUndefined(nextListLevel)) {\n            this.onApplyListInternal(list, levelNumber);\n            viewer.selection.start.updatePhysicalPosition(true);\n            viewer.selection.end.updatePhysicalPosition(true);\n            viewer.selection.updateCaretPosition();\n        }\n    };\n    /**\n     * Applies list\n     * @param  {WList} list\n     * @param  {number} listLevelNumber\n     * @private\n     */\n    Editor.prototype.onApplyListInternal = function (list, listLevelNumber) {\n        var selection = this.viewer.selection;\n        var listFormat = new WListFormat();\n        if (!isNullOrUndefined(list) && listLevelNumber >= 0 && listLevelNumber < 9) {\n            listFormat.listId = list.listId;\n            listFormat.listLevelNumber = listLevelNumber;\n        }\n        this.onApplyParagraphFormat('listFormat', listFormat, false, false);\n    };\n    /**\n     * Apply paragraph format to selection range\n     * @private\n     */\n    Editor.prototype.updateSelectionParagraphFormatting = function (property, value, update) {\n        var selection = this.viewer.selection;\n        if (property === 'leftIndent' && update) {\n            if (!isNullOrUndefined(selection.start) && selection.start.isExistBefore(selection.end)) {\n                value = this.getIndentIncrementValue(selection.start.paragraph, value);\n            }\n            else {\n                value = this.getIndentIncrementValue(selection.end.paragraph, value);\n            }\n        }\n        this.updateParagraphFormatInternal(property, value, update);\n    };\n    Editor.prototype.getIndentIncrementValue = function (currentParagraph, incrementFactor) {\n        var currentParagraphIndent = currentParagraph.paragraphFormat.leftIndent;\n        if (currentParagraphIndent < 0) {\n            // In MS Word, if the current paragraph left indent is lesser that or equal to 0\n            // then performing decrement indent will set left indent to 0. \n            if (incrementFactor < 0 || currentParagraphIndent + incrementFactor >= 0) {\n                return -currentParagraphIndent;\n            }\n            else {\n                var incrementValue = -this.getIndentIncrementValueInternal(-currentParagraphIndent, -incrementFactor);\n                return incrementValue % incrementFactor === 0 ? incrementValue : incrementValue + incrementFactor;\n            }\n        }\n        else {\n            return this.getIndentIncrementValueInternal(currentParagraphIndent, incrementFactor);\n        }\n    };\n    Editor.prototype.getIndentIncrementValueInternal = function (position, incrementFactor) {\n        var tabValue = Math.abs(incrementFactor);\n        if (position === 0 || tabValue === 0) {\n            return incrementFactor > 0 ? tabValue : 0;\n        }\n        else {\n            var diff = ((Math.round(position) * 100) % (Math.round(tabValue) * 100)) / 100;\n            var cnt = (Math.round(position) - diff) / Math.round(tabValue);\n            var fPosition = cnt * tabValue;\n            if (incrementFactor > 0) {\n                fPosition += tabValue;\n            }\n            return (fPosition - position) === 0 ? incrementFactor : fPosition - position;\n        }\n    };\n    Editor.prototype.updateParagraphFormatInternal = function (property, value, update) {\n        if (isNullOrUndefined(property)) {\n            property = 'ParagraphFormat';\n        }\n        switch (property) {\n            case 'afterSpacing':\n                this.updateParagraphFormat('afterSpacing', value, false);\n                break;\n            case 'beforeSpacing':\n                this.updateParagraphFormat('beforeSpacing', value, false);\n                break;\n            case 'rightIndent':\n                this.updateParagraphFormat('rightIndent', value, false);\n                break;\n            case 'leftIndent':\n                this.updateParagraphFormat('leftIndent', value, update);\n                break;\n            case 'firstLineIndent':\n                this.updateParagraphFormat('firstLineIndent', value, false);\n                break;\n            case 'lineSpacing':\n                this.updateParagraphFormat('lineSpacing', value, false);\n                break;\n            case 'lineSpacingType':\n                this.updateParagraphFormat('lineSpacingType', value, false);\n                break;\n            case 'textAlignment':\n                this.updateParagraphFormat('textAlignment', value, false);\n                break;\n            case 'listFormat':\n                this.updateParagraphFormat('listFormat', value, false);\n                break;\n            case 'ParagraphFormat':\n                this.updateParagraphFormat(undefined, value, false);\n                break;\n            case 'styleName':\n                this.updateParagraphFormat('styleName', value, false);\n                break;\n            case 'ClearParagraphFormat':\n                // this.initializeHistory('ClearParagraphFormat', selectionRange);\n                this.updateParagraphFormat(undefined, value, false);\n                break;\n        }\n    };\n    /**\n     * Update paragraph format on undo\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @param  {boolean} update\n     * @private\n     */\n    Editor.prototype.updateParagraphFormat = function (property, value, update) {\n        var selection = this.viewer.selection;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        // this.updateInsertPosition(selection, startPosition);\n        this.applyParaFormatSelectedContent(startPosition, endPosition, property, value, update);\n        // this.startSelectionReLayouting(startPosition.paragraph, selection, startPosition, endPosition);\n    };\n    Editor.prototype.applyParaFormatSelectedContent = function (start, end, property, value, update) {\n        var selection = this.viewer.selection;\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            var cell = void 0;\n            start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(start, true);\n            }\n            cell = start.paragraph.associatedCell;\n            this.applyParaFormatInCell(cell, start, end, property, value, update);\n            var table = cell.ownerTable;\n            this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(value) && !this.selection.isEmpty && property === 'styleName' && this.applyCharacterStyle(start.paragraph, start, end, property, value, update)) {\n                return;\n            }\n            else {\n                this.applyParaFormat(start.paragraph, start, end, property, value, update);\n            }\n        }\n    };\n    /**\n     * Apply Paragraph format\n     * @private\n     */\n    Editor.prototype.applyParaFormatProperty = function (paragraph, property, value, update) {\n        var format = paragraph.paragraphFormat;\n        if (update && property === 'leftIndent') {\n            value = format.leftIndent + value;\n        }\n        if (property === 'listFormat' && value instanceof WListFormat) {\n            var listFormat = value;\n            if (!listFormat.hasValue('listLevelNumber')) {\n                listFormat.listLevelNumber = format.listFormat.listLevelNumber;\n            }\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(format, property, value);\n        }\n        if (value instanceof WParagraphFormat) {\n            if (isNullOrUndefined(property)) {\n                if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n                    this.copyParagraphFormat(value, format);\n                }\n                else {\n                    format.copyFormat(value);\n                }\n            }\n            else if (property === 'listFormat') {\n                format.listFormat = value.listFormat;\n                // this.handleListFormat(format, value as WParagraphFormat);\n            }\n        }\n        if (isNullOrUndefined(value)) {\n            format.clearFormat();\n            this.viewer.layout.reLayoutParagraph(format.ownerBase, 0, 0);\n            return;\n        }\n        if (property === 'afterSpacing') {\n            format.afterSpacing = value;\n        }\n        else if (property === 'beforeSpacing') {\n            format.beforeSpacing = value;\n        }\n        else if (property === 'leftIndent') {\n            format.leftIndent = value;\n        }\n        else if (property === 'lineSpacingType') {\n            format.lineSpacingType = value;\n        }\n        else if (property === 'lineSpacing') {\n            format.lineSpacing = value;\n        }\n        else if (property === 'rightIndent') {\n            format.rightIndent = value;\n        }\n        else if (property === 'firstLineIndent') {\n            format.firstLineIndent = value;\n        }\n        else if (property === 'textAlignment') {\n            format.textAlignment = value;\n            this.viewer.layout.allowLayout = false;\n        }\n        else if (property === 'styleName') {\n            if (typeof (value) === 'string') {\n                value = this.viewer.styles.findByName(value);\n            }\n            format.ApplyStyle(value);\n        }\n        else if (property === 'listFormat') {\n            if (value instanceof WParagraphFormat) {\n                this.copyFromListLevelParagraphFormat(format, value);\n                value = value.listFormat;\n            }\n            format.listFormat.copyFormat(value);\n            this.viewer.layout.clearListElementBox(format.ownerBase);\n            this.onListFormatChange(format.ownerBase, value, format);\n            this.layoutItemBlock(format.ownerBase, false);\n            return;\n        }\n    };\n    Editor.prototype.copyParagraphFormat = function (sourceFormat, destFormat) {\n        destFormat.uniqueParagraphFormat = sourceFormat.uniqueParagraphFormat;\n        destFormat.listFormat = sourceFormat.listFormat;\n        destFormat.baseStyle = sourceFormat.baseStyle;\n    };\n    Editor.prototype.onListFormatChange = function (paragraph, listFormat, paraFormat) {\n        if (listFormat instanceof WListFormat) {\n            var currentFormat = listFormat;\n            // currentFormat.setOwnerBase(paraFormat);\n            this.updateListParagraphFormat(paragraph, listFormat);\n        }\n    };\n    Editor.prototype.updateListParagraphFormat = function (paragraph, listFormat) {\n        var list = this.viewer.getListById(listFormat.listId);\n        var listlevel = undefined;\n        if (!isNullOrUndefined(list)) {\n            listlevel = this.viewer.layout.getListLevel(list, listFormat.listLevelNumber);\n        }\n        var isUpdateIndent = !this.editorHistory || (this.editorHistory && !this.editorHistory.isUndoing);\n        if (isUpdateIndent) {\n            if (paragraph instanceof ParagraphWidget && !isNullOrUndefined(listlevel)\n                && !isNullOrUndefined(listlevel.paragraphFormat) && !isNullOrUndefined(paragraph.containerWidget)) {\n                this.copyFromListLevelParagraphFormat(paragraph.paragraphFormat, listlevel.paragraphFormat);\n            }\n            else if (isNullOrUndefined(list)) {\n                paragraph.paragraphFormat.leftIndent = undefined;\n                paragraph.paragraphFormat.firstLineIndent = undefined;\n            }\n        }\n    };\n    /**\n     * Copies list level paragraph format\n     * @param  {WParagraphFormat} oldFormat\n     * @param  {WParagraphFormat} newFormat\n     * @private\n     */\n    Editor.prototype.copyFromListLevelParagraphFormat = function (oldFormat, newFormat) {\n        if (!isNullOrUndefined(newFormat.leftIndent)) {\n            oldFormat.leftIndent = newFormat.leftIndent;\n        }\n        if (!isNullOrUndefined(newFormat.firstLineIndent)) {\n            oldFormat.firstLineIndent = newFormat.firstLineIndent;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyContinueNumbering = function (selection) {\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ContinueNumbering');\n        }\n        this.applyContinueNumberingInternal(selection);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyContinueNumberingInternal = function (selection) {\n        var paragraph = selection.start.paragraph;\n        var numberingInfo = this.getContinueNumberingInfo(paragraph);\n        var paraFormat = this.getParagraphFormat(paragraph, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.changeListId(numberingInfo.currentList, paragraph, paraFormat, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.reLayout(selection, false);\n        this.viewer.updateFocus();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getContinueNumberingInfo = function (paragraph) {\n        var currentList = undefined;\n        var listLevelNumber = 0;\n        var listPattern = 'None';\n        if (!isNullOrUndefined(paragraph.paragraphFormat)\n            && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n            currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n        }\n        var viewer = this.viewer;\n        if (listLevelNumber !== 0 && !isNullOrUndefined(currentList) &&\n            !isNullOrUndefined(viewer.getAbstractListById(currentList.abstractListId))\n            && !isNullOrUndefined(viewer.getAbstractListById(currentList.abstractListId).levels[listLevelNumber])) {\n            var listLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n            if (!isNullOrUndefined(listLevel)) {\n                listPattern = listLevel.listLevelPattern;\n            }\n        }\n        return {\n            currentList: currentList,\n            listLevelNumber: listLevelNumber,\n            listPattern: listPattern\n        };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.revertContinueNumbering = function (selection, format) {\n        var paragraph = selection.start.paragraph;\n        var numberingInfo = this.getContinueNumberingInfo(paragraph);\n        this.changeListId(numberingInfo.currentList, paragraph, format, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.reLayout(selection, false);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.updateHistory();\n        }\n    };\n    Editor.prototype.changeListId = function (list, block, format, levelNum, listType) {\n        if (isNullOrUndefined(block)) {\n            return;\n        }\n        if (block instanceof ParagraphWidget) {\n            if (list.listId === block.paragraphFormat.listFormat.listId\n                && levelNum === block.paragraphFormat.listFormat.listLevelNumber) {\n                if (this.editorHistory) {\n                    var baseHistoryInfo = this.editorHistory.currentBaseHistoryInfo;\n                    if (!isNullOrUndefined(baseHistoryInfo)) {\n                        format = baseHistoryInfo.addModifiedPropertiesForContinueNumbering(block.paragraphFormat, format);\n                    }\n                }\n                block.paragraphFormat.copyFormat(format);\n                this.viewer.layout.reLayoutParagraph(block, 0, 0);\n            }\n        }\n        return this.changeListId(list, block.nextRenderedWidget, format, levelNum, listType);\n    };\n    Editor.prototype.getParagraphFormat = function (paragraph, levelNumber, listType) {\n        if (!isNullOrUndefined(paragraph.previousRenderedWidget)) {\n            if (paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n                if (!isNullOrUndefined(paragraph.previousRenderedWidget.paragraphFormat.listFormat)\n                    && paragraph.previousRenderedWidget.paragraphFormat.listFormat.listId !== -1) {\n                    var listLevel = this.getListLevel(paragraph.previousRenderedWidget);\n                    if (levelNumber === 0) {\n                        return paragraph.previousRenderedWidget.paragraphFormat;\n                    }\n                    else if (listType === listLevel.listLevelPattern\n                        || this.checkNumberArabic(listType, listLevel.listLevelPattern)) {\n                        return paragraph.previousRenderedWidget.paragraphFormat;\n                    }\n                    else {\n                        return this.getParagraphFormat(paragraph.previousRenderedWidget, levelNumber, listType);\n                    }\n                }\n                else {\n                    return this.getParagraphFormat(paragraph.previousRenderedWidget, levelNumber, listType);\n                }\n            }\n        }\n        return undefined;\n    };\n    Editor.prototype.checkNumberArabic = function (listType, levelPattern) {\n        if ((listType === 'Number' && levelPattern === 'Arabic')\n            || (levelPattern === 'Number' && listType === 'Arabic')) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyRestartNumbering = function (selection) {\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('RestartNumbering');\n        }\n        this.restartListAt(selection);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.restartListAt = function (selection) {\n        var currentListLevel = this.getListLevel(selection.start.paragraph);\n        var list = new WList();\n        list.listId = this.viewer.lists[(this.viewer.lists.length - 1)].listId + 1;\n        var abstractList = new WAbstractList();\n        abstractList.abstractListId = this.viewer.abstractLists[(this.viewer.abstractLists.length - 1)].abstractListId + 1;\n        list.abstractListId = abstractList.abstractListId;\n        list.abstractList = abstractList;\n        this.viewer.abstractLists.push(abstractList);\n        this.createListLevels(abstractList, currentListLevel, list);\n        this.viewer.lists.push(list);\n        this.restartListAtInternal(selection, list.listId);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.restartListAtInternal = function (selection, listId) {\n        var numberingInfo = this.getContinueNumberingInfo(selection.start.paragraph);\n        this.changeRestartNumbering(numberingInfo.currentList, selection.start.paragraph, listId);\n        this.reLayout(selection, false);\n        this.incrementListNumber = -1;\n        this.refListNumber = undefined;\n        this.viewer.updateFocus();\n    };\n    Editor.prototype.changeRestartNumbering = function (list, block, listId) {\n        if (isNullOrUndefined(block)) {\n            return;\n        }\n        if (block instanceof ParagraphWidget) {\n            if (list.listId === block.paragraphFormat.listFormat.listId) {\n                if (this.editorHistory) {\n                    var baseHistoryInfo = this.editorHistory.currentBaseHistoryInfo;\n                    if (!isNullOrUndefined(baseHistoryInfo)) {\n                        listId = baseHistoryInfo.addModifiedPropertiesForRestartNumbering(block.paragraphFormat.listFormat, listId);\n                    }\n                }\n                block.paragraphFormat.listFormat.listId = listId;\n                if (this.refListNumber !== block.paragraphFormat.listFormat.listLevelNumber) {\n                    this.incrementListNumber += 1;\n                    this.refListNumber = block.paragraphFormat.listFormat.listLevelNumber;\n                }\n                block.paragraphFormat.listFormat.listLevelNumber = this.incrementListNumber;\n                this.viewer.layout.reLayoutParagraph(block, 0, 0);\n            }\n        }\n        return this.changeRestartNumbering(list, block.nextRenderedWidget, listId);\n    };\n    Editor.prototype.createListLevels = function (abstractList, currentListLevel, list) {\n        var levelPattern = currentListLevel.listLevelPattern;\n        var levelPatterns = [];\n        var currentAbstractList = currentListLevel.ownerBase;\n        for (var i = 0; i < 3; i++) {\n            var listLevel = currentAbstractList.levels[i];\n            if (!isNullOrUndefined(listLevel)) {\n                levelPatterns.push(listLevel.listLevelPattern);\n            }\n        }\n        var indexOfLevelPattern = levelPatterns.indexOf(levelPattern) === -1 ? 0 : levelPatterns.indexOf(levelPattern);\n        var numberFormat = currentListLevel.numberFormat.charAt(currentListLevel.numberFormat.length - 1);\n        for (var i = 0; i < currentAbstractList.levels.length; i++) {\n            var listLevel = new WListLevel(abstractList);\n            if (i === 0) {\n                listLevel.listLevelPattern = levelPattern;\n            }\n            else {\n                if (indexOfLevelPattern === 0 || indexOfLevelPattern < levelPatterns.length - 1) {\n                    indexOfLevelPattern++;\n                }\n                else {\n                    indexOfLevelPattern = 0;\n                }\n                listLevel.listLevelPattern = levelPatterns[indexOfLevelPattern];\n            }\n            listLevel.numberFormat = '%' + (i + 1) + numberFormat;\n            listLevel.startAt = 1;\n            listLevel.characterFormat.copyFormat(currentListLevel.characterFormat);\n            listLevel.paragraphFormat.copyFormat(currentListLevel.paragraphFormat);\n            listLevel.restartLevel = i;\n            abstractList.levels.push(listLevel);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormat = function (paragraph, start, end, property, value, update) {\n        this.setOffsetValue(this.selection);\n        paragraph = paragraph.combineWidget(this.viewer);\n        //Apply Paragraph Format for spitted paragraph\n        this.applyParaFormatProperty(paragraph, property, value, update);\n        this.layoutItemBlock(paragraph, false);\n        this.getOffsetValue(this.selection);\n        if (paragraph.equals(end.paragraph)) {\n            return;\n        }\n        this.getNextParagraphForFormatting(paragraph, start, end, property, value, update);\n    };\n    /* tslint:disable-next-line:max-line-length */\n    Editor.prototype.applyCharacterStyle = function (paragraph, start, end, property, value, update) {\n        var paragraphWidget = paragraph.getSplitWidgets();\n        if ((end.paragraph === paragraph || paragraphWidget.indexOf(end.paragraph) !== -1)) {\n            if (((value.type === 'Paragraph') && ((value.link) instanceof WCharacterStyle)) || (value.type === 'Character')) {\n                var obj = (value.type === 'Character') ? value : value.link;\n                this.updateSelectionCharacterFormatting(property, obj, update);\n                return true;\n            }\n        }\n        return false;\n    };\n    // Cell\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatInCell = function (cell, start, end, property, value, update) {\n        var selection = this.viewer.selection;\n        if (end.paragraph.isInsideTable) {\n            var cellContainer = selection.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (cellContainer.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cell, cellContainer);\n                var endCell = selection.getSelectedCell(end.paragraph.associatedCell, cellContainer);\n                if (selection.containsCell(cellContainer, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(cellContainer, start, end)) {\n                        value = this.getParaFormatValueInCell(cellContainer, property, value);\n                        this.applyParaFormatCellInternal(cellContainer, property, value, update);\n                    }\n                    else {\n                        if (startCell === cellContainer) {\n                            this.applyParaFormat(start.paragraph, start, end, property, value, update);\n                        }\n                        else {\n                            this.applyParagraphFormatRow(startCell.ownerRow, start, end, property, value, update);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.applyParaFormatTableCell(cellContainer.ownerTable, cellContainer, endCell, property, value, update);\n                }\n            }\n            else {\n                this.applyParagraphFormatRow(cellContainer.ownerRow, start, end, property, value, update);\n            }\n        }\n        else {\n            var wCell = selection.getContainerCell(cell);\n            this.applyParagraphFormatRow(wCell.ownerRow, start, end, property, value, update);\n        }\n    };\n    Editor.prototype.applyParaFormatCellInternal = function (cell, property, value, update) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                this.applyParaFormatProperty(block, property, value, update);\n            }\n            else {\n                this.applyParagraphFormatTableInternal(block, property, value, update);\n            }\n        }\n    };\n    Editor.prototype.getParaFormatValueInCell = function (cell, property, value) {\n        if (typeof value === 'boolean') {\n            var firstPara = this.viewer.selection.getFirstParagraph(cell);\n            value = !firstPara.paragraphFormat.getPropertyValue(property);\n        }\n        return value;\n    };\n    // Row\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParagraphFormatRow = function (wRow, start, end, property, value, update) {\n        value = this.getParaFormatValueInCell(wRow.childWidgets[0], property, value);\n        for (var i = wRow.rowIndex; i < wRow.ownerTable.childWidgets.length; i++) {\n            var row = wRow.ownerTable.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyParaFormatCellInternal(row.childWidgets[j], property, value, update);\n            }\n            if (end.paragraph.isInsideTable && this.viewer.selection.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        this.getNextParagraphForFormatting(wRow.ownerTable, start, end, property, value, update);\n    };\n    // Table\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatTableCell = function (table, startCell, endCell, property, value, update) {\n        var selection = this.viewer.selection;\n        var startValue = selection.getCellLeft(startCell.ownerRow, startCell);\n        var endValue = startValue + startCell.cellFormat.cellWidth;\n        var endCellLeft = selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startValue, endValue, endCellLeft, endCellRight);\n        startValue = cellInfo.start;\n        endValue = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var isStarted = false;\n        for (var m = table.childWidgets.indexOf(startCell.ownerRow); m <= count; m++) {\n            var row = table.childWidgets[m];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var left = selection.getCellLeft(row, row.childWidgets[j]);\n                if (Math.round(startValue) <= Math.round(left) && Math.round(left) < Math.round(endValue)) {\n                    if (!isStarted) {\n                        value = this.getParaFormatValueInCell(row.childWidgets[j], property, value);\n                        isStarted = true;\n                    }\n                    this.applyParaFormatCellInternal(row.childWidgets[j], property, value, update);\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatTable = function (table, start, end, property, value, update) {\n        table = table.combineWidget(this.viewer);\n        var selection = this.viewer.selection;\n        for (var m = 0; m < table.childWidgets.length; m++) {\n            var tableRow = table.childWidgets[m];\n            for (var k = 0; k < tableRow.childWidgets.length; k++) {\n                this.applyParaFormatCellInternal(tableRow.childWidgets[k], property, value, update);\n            }\n            if (end.paragraph.isInsideTable && selection.containsRow(tableRow, end.paragraph.associatedCell)) {\n                this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n                return;\n            }\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        this.getNextParagraphForFormatting(table, start, end, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.getNextParagraphForFormatting = function (block, start, end, property, value, update) {\n        var widgetCollection = block.getSplitWidgets();\n        block = widgetCollection[widgetCollection.length - 1];\n        block = this.viewer.selection.getNextRenderedBlock(block);\n        if (!isNullOrUndefined(block)) { //Goto the next block.\n            if (block instanceof ParagraphWidget) {\n                this.applyParaFormat(block, start, end, property, value, update);\n            }\n            else {\n                this.applyParaFormatTable(block, start, end, property, value, update);\n            }\n        }\n    };\n    Editor.prototype.applyParagraphFormatTableInternal = function (table, property, value, update) {\n        for (var x = 0; x < table.childWidgets.length; x++) {\n            var row = table.childWidgets[x];\n            for (var y = 0; y < row.childWidgets.length; y++) {\n                this.applyParaFormatCellInternal(row.childWidgets[y], property, value, update);\n            }\n        }\n    };\n    //Paragraph Format apply implementation Ends\n    // Apply Selection Section Format Option Implementation Starts\n    /**\n     * Apply section format selection changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplySectionFormat = function (property, value) {\n        if (!isNullOrUndefined(property)) {\n            var action = (property[0].toUpperCase() + property.slice(1));\n            this.initHistory(action);\n        }\n        else {\n            this.initHistory('SectionFormat');\n        }\n        this.updateSectionFormat(property, value);\n    };\n    /**\n     * Update section format\n     * @param  {string} property\n     * @param  {Object} value\n     * @returns TextPosition\n     * @private\n     */\n    Editor.prototype.updateSectionFormat = function (property, value) {\n        var selection = this.viewer.selection;\n        selection.owner.isShiftingEnabled = true;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        var startPageIndex;\n        var endPageIndex;\n        this.viewer.clearContent();\n        var startSectionIndex = startPosition.paragraph.containerWidget.index;\n        var endSectionIndex = endPosition.paragraph.containerWidget.index;\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            if (this.viewer.pages[i].bodyWidgets[0].index === startSectionIndex) {\n                startPageIndex = i;\n                break;\n            }\n        }\n        for (var i = startPageIndex; i < this.viewer.pages.length; i++) {\n            var bodyWidget = this.viewer.pages[i].bodyWidgets[0];\n            endPageIndex = i;\n            if ((bodyWidget.index === startSectionIndex)) {\n                continue;\n            }\n            else if ((bodyWidget.index >= startSectionIndex) && bodyWidget.index <= endSectionIndex) {\n                continue;\n            }\n            else {\n                endPageIndex = i - 1;\n                break;\n            }\n        }\n        // let startPageIndex: number = this.viewer.pages.indexOf((selection.start.paragraph.containerWidget as BodyWidget).page);\n        // let endPageIndex: number = this.viewer.pages.indexOf((selection.end.paragraph.containerWidget as BodyWidget).page);\n        var update = true;\n        var index = 0;\n        for (var i = startPageIndex; i <= endPageIndex; i++) {\n            if (index !== this.viewer.pages[i].bodyWidgets[0].index && !update) {\n                update = true;\n            }\n            this.applyPropertyValueForSection(this.viewer.pages[i].bodyWidgets[0].sectionFormat, property, value, update);\n            index = this.viewer.pages[i].bodyWidgets[0].index;\n            update = false;\n        }\n        this.layoutWholeDocument();\n        this.fireContentChange();\n    };\n    //Apply Selection Table Format option implementation starts\n    /**\n     * Apply table format property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableFormat = function (property, value) {\n        var action = this.getTableFormatAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        var table = selection.start.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            this.applyTablePropertyValue(selection, property, value, table);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        table.calculateGrid();\n        this.selection.owner.isLayoutEnabled = true;\n        this.viewer.layout.reLayoutTable(table);\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getTableFormatAction = function (property) {\n        switch (property) {\n            case 'tableAlignment':\n                return 'TableAlignment';\n            case 'leftIndent':\n                return 'TableLeftIndent';\n            case 'leftMargin':\n                return 'DefaultCellLeftMargin';\n            case 'rightMargin':\n                return 'DefaultCellRightMargin';\n            case 'bottomMargin':\n                return 'DefaultCellBottomMargin';\n            case 'topMargin':\n                return 'DefaultCellTopMargin';\n            case 'preferredWidth':\n                return 'TablePreferredWidth';\n            case 'preferredWidthType':\n                return 'TablePreferredWidthType';\n            case 'shading':\n                return 'Shading';\n            default:\n                return 'DefaultCellSpacing';\n        }\n    };\n    // Apply Selection Row Format Option Implementation Starts\n    /**\n     * Apply table row format property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableRowFormat = function (property, value) {\n        var action = this.getRowAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            var table = selection.start.paragraph.associatedCell.ownerRow.ownerTable;\n            this.applyRowPropertyValue(selection, property, value, selection.start.paragraph.associatedCell.ownerRow);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getRowAction = function (property) {\n        switch (property) {\n            case 'height':\n                return 'RowHeight';\n            case 'heightType':\n                return 'RowHeightType';\n            case 'isHeader':\n                return 'RowHeader';\n            default:\n                return 'AllowBreakAcrossPages';\n        }\n    };\n    /**\n     * Apply table cell property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableCellFormat = function (property, value) {\n        var action = this.getTableCellAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        var table = selection.start.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            this.applyCellPropertyValue(selection, property, value, selection.start.paragraph.associatedCell.cellFormat);\n            table.calculateGrid();\n            this.selection.owner.isLayoutEnabled = true;\n            this.viewer.layout.reLayoutTable(table);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getTableCellAction = function (property) {\n        switch (property) {\n            case 'verticalAlignment':\n                return 'CellContentVerticalAlignment';\n            case 'leftMargin':\n                return 'CellLeftMargin';\n            case 'rightMargin':\n                return 'CellRightMargin';\n            case 'bottomMargin':\n                return 'CellBottomMargin';\n            case 'topMargin':\n                return 'CellTopMargin';\n            case 'preferredWidth':\n                return 'CellPreferredWidth';\n            case 'shading':\n                return 'Shading';\n            default:\n                return 'CellPreferredWidthType';\n        }\n    };\n    Editor.prototype.applyPropertyValueForSection = function (sectionFormat, property, value, update) {\n        var selection = this.viewer.selection;\n        if (update && this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(sectionFormat, property, value);\n        }\n        if (isNullOrUndefined(value)) {\n            return;\n        }\n        if (value instanceof WSectionFormat) {\n            if (isNullOrUndefined(property)) {\n                sectionFormat.copyFormat(value, this.editorHistory);\n            }\n            return;\n        }\n        if (property === 'pageHeight') {\n            sectionFormat.pageHeight = value;\n        }\n        else if (property === 'pageWidth') {\n            sectionFormat.pageWidth = value;\n        }\n        else if (property === 'leftMargin') {\n            sectionFormat.leftMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            sectionFormat.rightMargin = value;\n        }\n        else if (property === 'topMargin') {\n            sectionFormat.topMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            sectionFormat.bottomMargin = value;\n        }\n        else if (property === 'differentFirstPage') {\n            sectionFormat.differentFirstPage = value;\n        }\n        else if (property === 'differentOddAndEvenPages') {\n            sectionFormat.differentOddAndEvenPages = value;\n        }\n        else if (property === 'headerDistance') {\n            sectionFormat.headerDistance = value;\n        }\n        else if (property === 'footerDistance') {\n            sectionFormat.footerDistance = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.layoutWholeDocument = function () {\n        var startPosition = this.viewer.selection.start;\n        var endPosition = this.viewer.selection.end;\n        if (startPosition.isExistAfter(endPosition)) {\n            startPosition = this.viewer.selection.end;\n            endPosition = this.viewer.selection.start;\n        }\n        var startInfo = this.getParagraphInfo(startPosition);\n        var endInfo = this.getParagraphInfo(startPosition);\n        var startIndex = this.getHierarchicalIndex(startInfo.paragraph, startInfo.offset.toString());\n        var endIndex = this.getHierarchicalIndex(endInfo.paragraph, endInfo.offset.toString());\n        this.viewer.renderedLists.clear();\n        // this.viewer.owner.isLayoutEnabled = true;\n        var sections = this.combineSection();\n        this.viewer.clearContent();\n        this.viewer.layout.layoutItems(sections);\n        this.viewer.owner.isShiftingEnabled = false;\n        this.setPositionForCurrentIndex(startPosition, startIndex);\n        this.setPositionForCurrentIndex(endPosition, endIndex);\n        this.viewer.selection.selectPosition(startPosition, endPosition);\n        this.reLayout(this.viewer.selection);\n    };\n    Editor.prototype.combineSection = function () {\n        var sections = [];\n        var nextSection = this.viewer.pages[0].bodyWidgets[0];\n        do {\n            nextSection = this.combineSectionChild(nextSection, sections);\n        } while (nextSection);\n        return sections;\n    };\n    Editor.prototype.combineSectionChild = function (bodyWidget, sections) {\n        var previousBodyWidget = bodyWidget;\n        var temp = new BodyWidget();\n        temp.sectionFormat = bodyWidget.sectionFormat;\n        temp.index = previousBodyWidget.index;\n        do {\n            previousBodyWidget = bodyWidget;\n            if (bodyWidget.lastChild) {\n                bodyWidget.lastChild.combineWidget(this.viewer);\n            }\n            bodyWidget = bodyWidget.nextRenderedWidget;\n            for (var j = 0; j < previousBodyWidget.childWidgets.length; j++) {\n                var block = previousBodyWidget.childWidgets[j];\n                if (block instanceof TableWidget) {\n                    this.viewer.layout.clearTableWidget(block, true, true);\n                }\n                else {\n                    block.x = 0;\n                    block.y = 0;\n                    block.width = 0;\n                    block.height = 0;\n                }\n                temp.childWidgets.push(block);\n                previousBodyWidget.childWidgets.splice(j, 1);\n                j--;\n                block.containerWidget = temp;\n            }\n            previousBodyWidget.page.destroy();\n            // this.viewer.pages.splice(previousBodyWidget.page.index, 1);\n        } while (bodyWidget && previousBodyWidget.equals(bodyWidget));\n        sections.push(temp);\n        return bodyWidget;\n    };\n    Editor.prototype.updateSelectionTableFormat = function (selection, action, value) {\n        switch (action) {\n            case 'TableAlignment':\n                this.editorHistory.initializeHistory('TableAlignment');\n                this.updateTableFormat(selection, 'tableAlignment', value);\n                break;\n            case 'TableLeftIndent':\n                this.editorHistory.initializeHistory('TableLeftIndent');\n                this.updateTableFormat(selection, 'leftIndent', value);\n                break;\n            case 'DefaultCellSpacing':\n                this.editorHistory.initializeHistory('DefaultCellSpacing');\n                this.updateTableFormat(selection, 'cellSpacing', value);\n                break;\n            case 'DefaultCellLeftMargin':\n                this.editorHistory.initializeHistory('DefaultCellLeftMargin');\n                this.updateTableFormat(selection, 'leftMargin', value);\n                break;\n            case 'DefaultCellRightMargin':\n                this.editorHistory.initializeHistory('DefaultCellRightMargin');\n                this.updateTableFormat(selection, 'rightMargin', value);\n                break;\n            case 'DefaultCellTopMargin':\n                this.editorHistory.initializeHistory('DefaultCellTopMargin');\n                this.updateTableFormat(selection, 'topMargin', value);\n                break;\n            case 'TablePreferredWidth':\n                this.editorHistory.initializeHistory('TablePreferredWidth');\n                this.updateTableFormat(selection, 'preferredWidth', value);\n                break;\n            case 'TablePreferredWidthType':\n                this.editorHistory.initializeHistory('TablePreferredWidthType');\n                this.updateTableFormat(selection, 'preferredWidthType', value);\n                break;\n            case 'DefaultCellBottomMargin':\n                this.editorHistory.initializeHistory('DefaultCellBottomMargin');\n                this.updateTableFormat(selection, 'bottomMargin', value);\n                break;\n            case 'CellContentVerticalAlignment':\n                this.editorHistory.initializeHistory('CellContentVerticalAlignment');\n                this.updateCellFormat(selection, 'verticalAlignment', value);\n                break;\n            case 'CellLeftMargin':\n                this.editorHistory.initializeHistory('CellLeftMargin');\n                this.updateCellFormat(selection, 'leftMargin', value);\n                break;\n            case 'CellRightMargin':\n                this.editorHistory.initializeHistory('CellRightMargin');\n                this.updateCellFormat(selection, 'rightMargin', value);\n                break;\n            case 'CellTopMargin':\n                this.editorHistory.initializeHistory('CellTopMargin');\n                this.updateCellFormat(selection, 'topMargin', value);\n                break;\n            case 'CellBottomMargin':\n                this.editorHistory.initializeHistory('CellBottomMargin');\n                this.updateCellFormat(selection, 'bottomMargin', value);\n                break;\n            case 'CellPreferredWidth':\n                this.editorHistory.initializeHistory('CellPreferredWidth');\n                this.updateCellFormat(selection, 'preferredWidth', value);\n                break;\n            case 'CellPreferredWidthType':\n                this.editorHistory.initializeHistory('CellPreferredWidthType');\n                this.updateCellFormat(selection, 'preferredWidthType', value);\n                break;\n            case 'Shading':\n                this.editorHistory.initializeHistory('Shading');\n                this.updateCellFormat(selection, 'shading', value);\n                break;\n            case 'RowHeight':\n                this.editorHistory.initializeHistory('RowHeight');\n                this.updateRowFormat(selection, 'height', value);\n                break;\n            case 'RowHeightType':\n                this.editorHistory.initializeHistory('RowHeightType');\n                this.updateRowFormat(selection, 'heightType', value);\n                break;\n            case 'RowHeader':\n                this.editorHistory.initializeHistory('RowHeader');\n                this.updateRowFormat(selection, 'isHeader', value);\n                break;\n            case 'AllowBreakAcrossPages':\n                this.editorHistory.initializeHistory('AllowBreakAcrossPages');\n                this.updateRowFormat(selection, 'allowBreakAcrossPages', value);\n                break;\n        }\n    };\n    // Update Table Properties\n    /**\n     * Update Table Format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {object} value\n     * @private\n     */\n    Editor.prototype.updateTableFormat = function (selection, property, value) {\n        var tableStartPosition = selection.start;\n        var tableEndPosition = selection.end;\n        if (!selection.isForward) {\n            tableStartPosition = selection.end;\n            tableEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, tableStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.applyTablePropertyValue(selection, property, value, tableStartPosition.paragraph.associatedCell.ownerTable);\n    };\n    /**\n     * update cell format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateCellFormat = function (selection, property, value) {\n        selection.owner.isShiftingEnabled = true;\n        var newStartPosition = selection.start;\n        var newEndPosition = selection.end;\n        if (!selection.isForward) {\n            newStartPosition = selection.end;\n            newEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, newStartPosition);\n        this.updateFormatForCell(selection, property, value);\n    };\n    /**\n     * update row format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateRowFormat = function (selection, property, value) {\n        var rowStartPosition = selection.start;\n        var rowEndPosition = selection.end;\n        if (!selection.isForward) {\n            rowStartPosition = selection.end;\n            rowEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, rowStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.applyRowFormat(rowStartPosition.paragraph.associatedCell.ownerRow, rowStartPosition, rowEndPosition, property, value);\n    };\n    Editor.prototype.initHistoryPosition = function (selection, position) {\n        if (this.viewer.owner.editorHistoryModule && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            if (!isNullOrUndefined(position)) {\n                if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                    this.editorHistory.currentBaseHistoryInfo.insertPosition = position.getHierarchicalIndexInternal();\n                }\n            }\n            else if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = selection.start.getHierarchicalIndexInternal();\n            }\n        }\n    };\n    Editor.prototype.startSelectionReLayouting = function (paragraph, selection, start, end) {\n        selection.owner.isLayoutEnabled = true;\n        if (start.paragraph.isInsideTable) {\n            var table = start.paragraph.associatedCell.ownerTable;\n            while (table.isInsideTable) {\n                table = table.associatedCell.ownerTable;\n            }\n            this.reLayoutSelectionOfTable(table, selection, start, end);\n        }\n        else {\n            this.reLayoutSelection(paragraph, selection, start, end);\n        }\n    };\n    Editor.prototype.reLayoutSelectionOfTable = function (table, selection, start, end) {\n        var isEnded = false;\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        // If the selection ends in the current table, need to stop relayouting.\n        if (!isNullOrUndefined(end.paragraph.associatedCell) && table.contains(end.paragraph.associatedCell)) {\n            return true;\n        }\n        var block = selection.getNextRenderedBlock(table);\n        // Relayout the next block.\n        if (!isNullOrUndefined(block)) {\n            isEnded = this.reLayoutSelectionOfBlock(block, selection, start, end);\n        }\n        return isEnded;\n    };\n    Editor.prototype.reLayoutSelection = function (paragraph, selection, start, end) {\n        if (start.paragraph === paragraph) {\n            var startOffset = start.offset;\n            var length_2 = selection.getParagraphLength(paragraph);\n            var indexInInline = 0;\n            var index = 0;\n            var inlineObj = paragraph.getInline(start.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                if (indexInInline === inline.length && !isNullOrUndefined(inline.nextNode)) {\n                    inline = inline.nextNode;\n                }\n                index = inline.line.children.indexOf(inline);\n            }\n            var lineIndex = 0;\n            if (start.currentWidget.paragraph === paragraph) {\n                lineIndex = paragraph.childWidgets.indexOf(start.currentWidget);\n                index = start.currentWidget.children.indexOf(inline);\n            }\n            // If selection start inline is at new inline, need to relayout from the previous inline.\n            if (inline instanceof TextElementBox && !inline.line && index > 0) {\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, index - 1);\n            }\n            else {\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, index);\n            }\n        }\n        else {\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n        // If the selection ends at the current paragraph, need to stop relayouting.\n        if (end.paragraph === paragraph) {\n            return true;\n        }\n        // _Relayout the next block.\n        var block = selection.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            return this.reLayoutSelectionOfBlock(block, selection, start, end);\n        }\n        return false;\n    };\n    //Relayouting Start    \n    Editor.prototype.reLayoutSelectionOfBlock = function (block, selection, start, end) {\n        if (block instanceof ParagraphWidget) {\n            return this.reLayoutSelection(block, selection, start, end);\n        }\n        else {\n            return undefined;\n            // return this.reLayoutSelectionOfTable(block as TableWidget, selection, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.layoutItemBlock = function (block, shiftNextWidget) {\n        var section = undefined;\n        if (block.containerWidget instanceof BlockContainer) {\n            section = block.containerWidget;\n            var index = section.childWidgets.indexOf(block);\n            if (!isNullOrUndefined(this.viewer.owner)\n                && this.viewer.owner.isLayoutEnabled) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.layout.layoutBodyWidgetCollection(block.index, section, block, false);\n            }\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            var cell = block.containerWidget;\n            cell = this.viewer.selection.getContainerCell(cell);\n            if (!isNullOrUndefined(this.viewer.owner)\n                && this.viewer.owner.isLayoutEnabled) {\n                this.viewer.layout.reLayoutTable(block);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeSelectedContents = function (selection) {\n        return this.removeSelectedContentInternal(selection, selection.start, selection.end);\n    };\n    Editor.prototype.removeSelectedContentInternal = function (selection, startPosition, endPosition) {\n        var startPos = startPosition;\n        var endPos = endPosition;\n        if (!startPosition.isExistBefore(endPosition)) {\n            startPos = endPosition;\n            endPos = startPosition;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (startPos.paragraph === endPos.paragraph && startPos.paragraph.childWidgets.indexOf(startPos.currentWidget) === startPos.paragraph.childWidgets.length - 1 &&\n            startPos.offset === selection.getParagraphLength(startPos.paragraph) && startPos.offset + 1 === endPos.offset) {\n            selection.owner.isShiftingEnabled = true;\n            selection.selectContent(startPos, true);\n            return true;\n        }\n        var paragraphInfo = this.getParagraphInfo(startPos);\n        selection.editPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        var isRemoved = this.removeSelectedContent(endPos.paragraph, selection, startPos, endPos);\n        var textPosition = new TextPosition(selection.owner);\n        this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n        selection.selectContent(textPosition, true);\n        return isRemoved;\n    };\n    Editor.prototype.removeSelectedContent = function (paragraph, selection, start, end) {\n        //If end is not table end and start is outside the table, then skip removing the contents and move caret to start position.\n        if (end.paragraph.isInsideTable\n            && end.paragraph !== selection.getLastParagraphInLastCell(end.paragraph.associatedCell.ownerTable)\n            && (!start.paragraph.isInsideTable || start.paragraph.associatedCell.ownerTable !== end.paragraph.associatedCell.ownerTable)) {\n            return false;\n        }\n        selection.owner.isShiftingEnabled = true;\n        this.deleteSelectedContent(paragraph, selection, start, end, 2);\n        return true;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteSelectedContent = function (paragraph, selection, start, end, editAction) {\n        var indexInInline = 0;\n        var inlineObj = start.currentWidget.getInline(start.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        // if (!isNullOrUndefined(inline)) {\n        //     inline = selection.getNextRenderedInline(inline, indexInInline);\n        // }\n        // if (inline instanceof WFieldBegin && !isNullOrUndefined((inline as WFieldBegin).fieldEnd)) {\n        // tslint:disable-next-line:max-line-length\n        //     let fieldEndOffset: number = ((inline as WFieldBegin).fieldEnd.owner as WParagraph).getOffset((inline as WFieldBegin).fieldEnd, 1);\n        //     let fieldEndIndex: string = WordDocument.getHierarchicalIndexOf((inline as WFieldBegin).fieldEnd.owner as WParagraph, fieldEndOffset.toString());\n        //     let selectionEndIndex: string = end.getHierarchicalIndexInternal();\n        //     if (!TextPosition.isForwardSelection(fieldEndIndex, selectionEndIndex)) {\n        //         //If selection end is after field begin, moves selection start to field separator.\n        //         start.moveToInline((inline as WFieldBegin).fieldSeparator, 1);\n        //         selection.editPosition = start.getHierarchicalIndexInternal();\n        //         if (!isNullOrUndefined(selection.currentBaseHistoryInfo)) {\n        //             selection.currentBaseHistoryInfo.insertPosition = selection.editPosition;\n        //         }\n        //     }\n        // }\n        indexInInline = 0;\n        inlineObj = end.currentWidget.getInline(end.offset, indexInInline);\n        inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        // if (!isNullOrUndefined(inline)) {\n        //     inline = selection.getNextRenderedInline(inline, indexInInline);\n        // }\n        // if (inline instanceof WFieldEnd && !isNullOrUndefined((inline as WFieldEnd).fieldBegin)) {\n        // tslint:disable-next-line:max-line-length\n        //     let fieldBeginOffset: number = ((inline as WFieldEnd).fieldBegin.owner as WParagraph).getOffset((inline as WFieldEnd).fieldBegin, 0);\n        //     let fieldBeginIndex: string = WordDocument.getHierarchicalIndexOf((inline as WFieldEnd).fieldBegin.owner as WParagraph, fieldBeginOffset.toString());\n        //     let selectionStartIndex: string = start.getHierarchicalIndexInternal();\n        //     if (!TextPosition.isForwardSelection(selectionStartIndex, fieldBeginIndex)) {\n        //         //If field begin is before selection start, move selection end to inline item before field end.\n        //         let prevInline: WInline = selection.getPreviousTextInline(inline);\n        //         if (isNullOrUndefined(prevInline)) {\n        //             end.moveBackward();\n        //         } else {\n        //             end.moveToInline(prevInline, prevInline.length);\n        //         }\n        //     }\n        // }\n        if (end.paragraph !== paragraph) {\n            this.deleteSelectedContent(end.paragraph, selection, start, end, editAction);\n            return;\n        }\n        //  Selection start in cell.\n        if (end.paragraph.isInsideTable && (!start.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(end.paragraph.associatedCell, start, end))) {\n            end.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            this.deleteTableCell(end.paragraph.associatedCell, selection, start, end, editAction);\n        }\n        else {\n            this.deletePara(paragraph, start, end, editAction);\n        }\n    };\n    /**\n     * Merge the selected cells.\n     */\n    Editor.prototype.mergeCells = function () {\n        if (this.owner.isReadOnlyMode || !this.owner.isDocumentLoaded) {\n            return;\n        }\n        if (!isNullOrUndefined(this.viewer) && !this.selection.isEmpty) {\n            this.mergeSelectedCellsInTable();\n        }\n    };\n    /**\n     * Deletes the entire table at selection.\n     */\n    Editor.prototype.deleteTable = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        if (startPos.paragraph.isInsideTable) {\n            var table = this.getOwnerTable(this.selection.isForward).combineWidget(this.viewer);\n            this.selection.owner.isShiftingEnabled = true;\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteTable');\n                //Sets the insert position in history info as current table.    \n                this.updateHistoryPosition(startPos, true);\n            }\n            var paragraph = this.getParagraphForSelection(table);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.editorHistory.currentBaseHistoryInfo.removedNodes.push(table.clone());\n            }\n            this.removeBlock(table);\n            this.selection.selectParagraph(paragraph, true);\n            if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n                this.reLayout(this.selection);\n            }\n        }\n    };\n    /**\n     * Deletes the selected column(s).\n     */\n    Editor.prototype.deleteColumn = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        if (startPos.paragraph.isInsideTable) {\n            this.selection.owner.isShiftingEnabled = true;\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteColumn');\n            }\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.cloneTableToHistoryInfo(table);\n            }\n            var paragraph = undefined;\n            if (endCell.nextWidget) {\n                var nextCell = endCell.nextWidget;\n                paragraph = this.selection.getFirstParagraph(nextCell);\n            }\n            else if (startCell.previousWidget) {\n                var previousCell = startCell.previousWidget;\n                paragraph = this.selection.getFirstParagraph(previousCell);\n            }\n            if (isNullOrUndefined(paragraph)) {\n                paragraph = this.getParagraphForSelection(table);\n            }\n            //retrieve the cell collection based on start and end cell to remove. \n            var deleteCells = table.getColumnCellsForSelection(startCell, endCell);\n            for (var i = 0; i < table.childWidgets.length; i++) {\n                var row = table.childWidgets[i];\n                if (row.childWidgets.length === 1) {\n                    if (deleteCells.indexOf(row.childWidgets[0]) >= 0) {\n                        table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n                        row.destroy();\n                        i--;\n                    }\n                }\n                else {\n                    for (var j = 0; j < row.childWidgets.length; j++) {\n                        var tableCell = row.childWidgets[j];\n                        if (deleteCells.indexOf(tableCell) >= 0) {\n                            row.childWidgets.splice(j, 1);\n                            tableCell.destroy();\n                            j--;\n                        }\n                    }\n                    if (row.childWidgets.length === 0) {\n                        table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n                        row.destroy();\n                        i--;\n                    }\n                }\n            }\n            if (table.childWidgets.length === 0) {\n                // Before disposing table reset the paragrph.\n                paragraph = this.getParagraphForSelection(table);\n                this.removeBlock(table);\n                if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                    this.editorHistory.currentBaseHistoryInfo.action = 'DeleteTable';\n                }\n                table.destroy();\n            }\n            else {\n                table.isGridUpdated = false;\n                table.buildTableColumns();\n                table.isGridUpdated = true;\n                this.viewer.layout.reLayoutTable(table);\n            }\n            this.selection.selectParagraph(paragraph, true);\n            if (isNullOrUndefined(this.editorHistory) || this.checkIsNotRedoing()) {\n                this.reLayout(this.selection, true);\n            }\n        }\n    };\n    /**\n     * Deletes the selected row(s).\n     */\n    Editor.prototype.deleteRow = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = !this.selection.isForward ? this.selection.end : this.selection.start;\n        var endPos = !this.selection.isForward ? this.selection.start : this.selection.end;\n        if (startPos.paragraph.isInsideTable) {\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteRow');\n            }\n            this.selection.owner.isShiftingEnabled = true;\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            var row = this.getOwnerRow(true);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.cloneTableToHistoryInfo(table);\n            }\n            var paragraph = undefined;\n            if (row.nextWidget) {\n                var nextCell = row.nextWidget.childWidgets[0];\n                paragraph = this.selection.getFirstParagraph(nextCell);\n            }\n            if (isNullOrUndefined(paragraph)) {\n                paragraph = this.getParagraphForSelection(table);\n            }\n            if (!this.selection.isEmpty) {\n                //tslint:disable-next-line:max-line-length\n                var containerCell = this.selection.getContainerCellOf(startCell, endCell);\n                if (containerCell.ownerTable.contains(endCell)) {\n                    startCell = this.selection.getSelectedCell(startCell, containerCell);\n                    endCell = this.selection.getSelectedCell(endCell, containerCell);\n                    if (this.selection.containsCell(containerCell, endCell)) {\n                        row = startCell.ownerRow;\n                        this.removeRow(row);\n                    }\n                    else {\n                        row = startCell.ownerRow;\n                        var endRow = endCell.ownerRow;\n                        //Update the selection paragraph.\n                        paragraph = undefined;\n                        if (endRow.nextWidget) {\n                            var nextCell = endRow.nextWidget.childWidgets[0];\n                            paragraph = this.selection.getFirstParagraph(nextCell);\n                        }\n                        if (isNullOrUndefined(paragraph)) {\n                            paragraph = this.getParagraphForSelection(table);\n                        }\n                        for (var i = 0; i < table.childWidgets.length; i++) {\n                            var tableRow = table.childWidgets[i];\n                            if (tableRow.rowIndex >= row.rowIndex && tableRow.rowIndex <= endRow.rowIndex) {\n                                table.childWidgets.splice(i, 1);\n                                tableRow.destroy();\n                                i--;\n                            }\n                        }\n                        if (table.childWidgets.length === 0) {\n                            this.removeBlock(table);\n                            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                                this.editorHistory.currentBaseHistoryInfo.action = 'DeleteTable';\n                            }\n                            table.destroy();\n                        }\n                        else {\n                            this.updateTable(table);\n                        }\n                    }\n                }\n            }\n            else {\n                this.removeRow(row);\n            }\n            this.selection.selectParagraph(paragraph, true);\n            if (isNullOrUndefined(this.editorHistory) || this.checkIsNotRedoing()) {\n                this.reLayout(this.selection, true);\n            }\n        }\n    };\n    Editor.prototype.removeRow = function (row) {\n        var table = row.ownerTable;\n        if (table.childWidgets.length === 1) {\n            this.removeBlock(table);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.editorHistory.currentBaseHistoryInfo.action = 'Delete';\n            }\n            table.destroy();\n        }\n        else {\n            table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n            row.destroy();\n            this.updateTable(table);\n        }\n    };\n    Editor.prototype.updateTable = function (table) {\n        table.updateRowIndex(0);\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.layout.reLayoutTable(table);\n    };\n    Editor.prototype.getParagraphForSelection = function (table) {\n        var paragraph = undefined;\n        var nextWidget = table.nextWidget ? table.nextWidget : table.nextRenderedWidget;\n        var previousWidget = table.previousWidget ? table.previousWidget : table.previousRenderedWidget;\n        if (nextWidget) {\n            paragraph = nextWidget instanceof ParagraphWidget ? nextWidget\n                : this.selection.getFirstParagraphInFirstCell(nextWidget);\n        }\n        else if (previousWidget) {\n            paragraph = previousWidget instanceof ParagraphWidget ? previousWidget\n                : this.selection.getLastParagraphInLastCell(previousWidget);\n        }\n        return paragraph;\n    };\n    Editor.prototype.deletePara = function (paragraph, start, end, editAction) {\n        paragraph = paragraph.combineWidget(this.viewer);\n        var selection = this.viewer.selection;\n        var paragraphStart = selection.getStartOffset(paragraph);\n        var endParagraphStartOffset = selection.getStartOffset(end.paragraph);\n        var startOffset = paragraphStart;\n        var endOffset = 0;\n        var isCombineNextParagraph = false;\n        var lastLinelength = this.selection.getLineLength(paragraph.lastChild);\n        var currentParagraph = paragraph;\n        var section = paragraph.bodyWidget instanceof BodyWidget ? paragraph.bodyWidget : undefined;\n        var startLine = undefined;\n        var endLineWidget = undefined;\n        if (paragraph === start.paragraph) {\n            startOffset = start.offset;\n            startLine = start.currentWidget;\n            if (end.paragraph.isInsideTable) {\n                isCombineNextParagraph = this.isEndInAdjacentTable(paragraph, end.paragraph);\n            }\n        }\n        else {\n            startLine = paragraph.firstChild;\n        }\n        if (paragraph !== start.paragraph && selection.isSkipLayouting) {\n            selection.isSkipLayouting = false;\n        }\n        if (paragraph === end.paragraph) {\n            endLineWidget = end.currentWidget;\n            endOffset = end.offset;\n        }\n        else {\n            endLineWidget = paragraph.lastChild;\n            endOffset = this.viewer.selection.getLineLength(paragraph.lastChild);\n        }\n        var block = paragraph.previousRenderedWidget;\n        if (startOffset > paragraphStart && start.currentWidget === paragraph.lastChild &&\n            startOffset === lastLinelength && (paragraph === end.paragraph && end.offset === startOffset + 1 ||\n            paragraph.nextRenderedWidget === end.paragraph && end.offset === endParagraphStartOffset) ||\n            (this.editorHistory && this.editorHistory.isUndoing && this.editorHistory.currentHistoryInfo &&\n                this.editorHistory.currentHistoryInfo.action === 'PageBreak' && block && block.isPageBreak()\n                && (startOffset === 0 && !start.currentWidget.isFirstLine || startOffset > 0))) {\n            isCombineNextParagraph = true;\n        }\n        if (end.paragraph === paragraph && end.currentWidget !== paragraph.lastChild ||\n            (end.currentWidget === paragraph.lastChild && end.offset <= selection.getLineLength(paragraph.lastChild))) {\n            var isStartParagraph = start.paragraph === paragraph;\n            if (end.currentWidget.isFirstLine() && end.offset > paragraphStart || !end.currentWidget.isFirstLine()) {\n                //If selection end with this paragraph and selection doesnot include paragraph mark.               \n                this.removeInlines(paragraph, startLine, startOffset, endLineWidget, endOffset, editAction);\n                //Removes the splitted paragraph.\n            }\n            if (!isNullOrUndefined(block) && !isStartParagraph) {\n                var nextSection = block.bodyWidget instanceof BodyWidget ? block.bodyWidget : undefined;\n                if (nextSection && !section.equals(nextSection) && section.index !== nextSection.index) {\n                    this.deleteSection(selection, nextSection, section, editAction);\n                }\n                this.deleteBlock(block, selection, start, end, editAction);\n            }\n        }\n        else if (start.paragraph === paragraph && (start.currentWidget !== paragraph.firstChild ||\n            (start.currentWidget === paragraph.firstChild && startOffset > paragraphStart))) {\n            // If selection start is after paragraph start\n            //And selection does not end with this paragraph Or selection include paragraph mark.\n            if (editAction === 4) {\n                return;\n            }\n            else {\n                currentParagraph = this.splitParagraph(paragraph, paragraph.firstChild, 0, startLine, startOffset, true);\n                this.insertParagraphPaste(paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction);\n                this.addRemovedNodes(paragraph);\n                return;\n            }\n        }\n        else {\n            var newParagraph = undefined;\n            var previousBlock = paragraph.previousWidget;\n            var prevParagraph = (previousBlock instanceof ParagraphWidget) ? previousBlock : undefined;\n            var nextWidget = paragraph.nextRenderedWidget;\n            if (editAction < 4) {\n                //Checks whether this is last paragraph of owner text body and previousBlock is not paragraph.\n                newParagraph = this.checkAndInsertBlock(paragraph, start, end, editAction, prevParagraph);\n                this.removeBlock(paragraph);\n                if (this.viewer.blockToShift === paragraph) {\n                    this.viewer.blockToShift = undefined;\n                }\n                this.addRemovedNodes(paragraph);\n                if (!isNullOrUndefined(newParagraph)) {\n                    selection.editPosition = this.getHierarchicalIndex(newParagraph, '0');\n                    var offset = selection.getParagraphLength(newParagraph) + 1;\n                    if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                        //tslint:disable-next-line:max-line-length\n                        this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(newParagraph, offset.toString());\n                    }\n                }\n                else if (paragraph === start.paragraph && isNullOrUndefined(nextWidget) && !isNullOrUndefined(prevParagraph)) {\n                    var offset = this.selection.getParagraphLength(prevParagraph);\n                    // if (isNullOrUndefined(block)) {\n                    selection.editPosition = this.getHierarchicalIndex(prevParagraph, offset.toString());\n                    if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                        this.updateHistoryPosition(selection.editPosition, true);\n                        this.editorHistory.currentBaseHistoryInfo.endPosition = selection.editPosition;\n                    }\n                    // } else {\n                    //     let offset: number = selection.getParagraphLength(paragraph) + 1;\n                    //     if (block instanceof ParagraphWidget) {\n                    //         prevParagraph = block as ParagraphWidget;\n                    //     }\n                    //     // if (block instanceof WTable) {\n                    //     //     prevParagraph = (block as WTable).getFirstParagraphInFirstCell();\n                    //     // }\n                    //     selection.editPosition = prevLineWidget.getHierarchicalIndex('0');\n                    // }\n                }\n            }\n            if (start.paragraph !== paragraph && !isNullOrUndefined(block)) {\n                var nextSection = block.bodyWidget instanceof BodyWidget ? block.bodyWidget : undefined;\n                // if (section !== nextSection) {\n                //     this.deleteSection(selection, section, nextSection, editAction);\n                // }\n                this.deleteBlock(block, selection, start, end, editAction);\n            }\n        }\n        this.insertParagraphPaste(paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction);\n    };\n    Editor.prototype.deleteSection = function (selection, section, nextSection, editAction) {\n        if (editAction < 4) {\n            this.combineSectionInternal(selection, section, nextSection);\n        }\n        //Copies the section properties, if this is last paragraph of section.\n        if (editAction > 2) {\n            section.sectionFormat.copyFormat(nextSection.sectionFormat);\n        }\n    };\n    Editor.prototype.combineSectionInternal = function (selection, section, nextSection) {\n        // if (section.sectionFormat.isEqualFormat(nextSection.sectionFormat)) {\n        // } else {\n        var bodyWidget = section.getSplitWidgets()[0];\n        var currentSection = [];\n        this.combineSectionChild(bodyWidget, currentSection);\n        bodyWidget = currentSection[0];\n        var lastBlockIndex = bodyWidget.lastChild.index;\n        this.updateBlockIndex(lastBlockIndex + 1, nextSection.firstChild);\n        var insertIndex = 0;\n        var containerWidget = nextSection;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var block = bodyWidget.childWidgets.splice(i, 1)[0];\n            containerWidget.childWidgets.splice(insertIndex, 0, block);\n            block.containerWidget = containerWidget;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, block.bodyWidget, block, false);\n            block = block.getSplitWidgets().pop();\n            containerWidget = block.containerWidget;\n            insertIndex = block.indexInOwner + 1;\n            i--;\n        }\n        this.updateSectionIndex(undefined, nextSection, false);\n        this.addRemovedNodes(bodyWidget);\n        // this.insert\n        // }\n    };\n    //tslint:disable:max-line-length\n    /**\n     * @private\n     */\n    Editor.prototype.checkAndInsertBlock = function (block, start, end, editAction, previousParagraph) {\n        if (block instanceof ParagraphWidget && block === start.paragraph || block instanceof TableWidget) {\n            var newParagraph = void 0; //Adds an empty paragraph, to ensure minimal content.\n            if (isNullOrUndefined(block.nextWidget) && (isNullOrUndefined(previousParagraph) || previousParagraph.nextRenderedWidget instanceof TableWidget)) {\n                newParagraph = new ParagraphWidget();\n                if (editAction === 1 && block instanceof ParagraphWidget) {\n                    newParagraph.characterFormat.copyFormat(block.characterFormat);\n                    newParagraph.paragraphFormat.copyFormat(block.paragraphFormat);\n                }\n                newParagraph.index = block.index + 1;\n                newParagraph.containerWidget = block.containerWidget;\n                this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, newParagraph.bodyWidget, newParagraph, false);\n                if (block.containerWidget instanceof Widget) {\n                    block.containerWidget.childWidgets.push(newParagraph);\n                }\n            }\n            return newParagraph;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.splitParagraph = function (paragraphAdv, startLine, startOffset, endLine, endOffset, removeBlock) {\n        var paragraph = new ParagraphWidget();\n        paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n        paragraph.characterFormat = new WCharacterFormat(paragraph);\n        paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n        paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n        var lineWidget = new LineWidget(paragraph);\n        paragraph.childWidgets.push(lineWidget);\n        var blockIndex = paragraphAdv.index;\n        var insertIndex = paragraphAdv.indexInOwner;\n        this.moveInlines(paragraphAdv, paragraph, 0, startOffset, startLine, endOffset, endLine);\n        //Inserts new paragraph in the current text position.\n        paragraphAdv.containerWidget.childWidgets.splice(insertIndex, 0, paragraph);\n        paragraph.index = blockIndex;\n        paragraph.containerWidget = paragraphAdv.containerWidget;\n        this.updateNextBlocksIndex(paragraph, true);\n        if (removeBlock) {\n            this.removeBlock(paragraphAdv);\n        }\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.layoutBodyWidgetCollection(blockIndex, paragraph.containerWidget, paragraph, false);\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeBlock = function (block) {\n        var index;\n        var blockCollection;\n        var containerWidget;\n        this.removeFieldInBlock(block);\n        if (block.isInsideTable) {\n            containerWidget = block.associatedCell;\n            index = block.associatedCell.childWidgets.indexOf(block);\n            blockCollection = block.associatedCell.childWidgets;\n            this.updateNextBlocksIndex(block, false);\n            block.associatedCell.childWidgets.splice(index, 1);\n            block.containerWidget = undefined;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, containerWidget, block, false);\n        }\n        else {\n            containerWidget = block.containerWidget;\n            index = containerWidget.childWidgets.indexOf(block);\n            blockCollection = containerWidget.childWidgets;\n            this.updateNextBlocksIndex(block, false);\n            containerWidget.childWidgets.splice(index, 1);\n            block.containerWidget = undefined;\n            containerWidget.height -= block.height;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, containerWidget, block, false);\n        }\n    };\n    Editor.prototype.removeField = function (block) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            var field = this.viewer.fields[i];\n            if (field.line.paragraph === block) {\n                this.viewer.fields.splice(i, 1);\n                i--;\n            }\n        }\n    };\n    Editor.prototype.addRemovedNodes = function (node) {\n        if (node instanceof FieldElementBox && node.fieldType === 0) {\n            if (this.viewer.fields.indexOf(node) !== -1) {\n                this.viewer.fields.splice(this.viewer.fields.indexOf(node), 1);\n            }\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.currentBaseHistoryInfo.removedNodes.push(node);\n        }\n        else if (this.editHyperlinkInternal) {\n            this.nodes.push(node);\n        }\n    };\n    Editor.prototype.deleteBlock = function (block, selection, start, end, editAction) {\n        if (block instanceof ParagraphWidget) {\n            this.deletePara(block, start, end, editAction);\n        }\n        else {\n            this.deleteTableBlock(block, selection, start, end, editAction);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteTableCell = function (cellAdv, selection, start, end, editAction) {\n        var deletePreviousBlock = !(start.paragraph.isInsideTable && cellAdv.ownerTable.contains(start.paragraph.associatedCell));\n        var previousBlock = cellAdv.ownerTable.previousRenderedWidget;\n        if (start.paragraph.isInsideTable) {\n            var containerCell = selection.getContainerCellOf(cellAdv, start.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(start.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cellAdv, containerCell);\n                var endCell = selection.getSelectedCell(start.paragraph.associatedCell, containerCell);\n                if (selection.containsCell(containerCell, start.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(containerCell, start, end)) {\n                        //Container cell is completely selected.\n                        this.updateEditPosition(containerCell, selection);\n                        if (editAction === 1) {\n                            //Specifically handled for backspace. Delete selected cell in current table.\n                            this.deleteCellsInTable(cellAdv.ownerRow.ownerTable, selection, start, end, editAction);\n                        }\n                        else {\n                            //Delete contents within table cell or Copy contents within table cell to clipboard.\n                            var isCellCleared = this.deleteCell(containerCell, selection, editAction, true);\n                            if (!isCellCleared && editAction !== 2 && this.editorHistory) {\n                                this.editorHistory.currentBaseHistoryInfo = undefined;\n                            }\n                        }\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.deletePara(end.paragraph, start, end, editAction);\n                        }\n                        else {\n                            this.deleteContainer(startCell, selection, start, end, editAction);\n                        }\n                    }\n                }\n                else {\n                    if (editAction === 2) {\n                        //Delete contents within table cell.\n                        this.deleteCell(cellAdv, selection, 2, false);\n                    }\n                    else {\n                        //Delete other selected cells in current table.\n                        this.deleteCellsInTable(containerCell.ownerTable, selection, start, end, editAction);\n                    }\n                }\n            }\n            else {\n                //Selection end is different table.\n                this.deleteContainer(containerCell, selection, start, end, editAction);\n            }\n        }\n        else {\n            //Selection end is outside table.\n            var cell = selection.getContainerCell(cellAdv);\n            this.deleteContainer(cell, selection, start, end, editAction);\n        }\n        if (deletePreviousBlock) {\n            var sectionAdv = previousBlock.bodyWidget instanceof BodyWidget ? previousBlock.bodyWidget : undefined;\n            // this.deleteContent(cellAdv.ownerTable, selection, editAction);\n            if (!isNullOrUndefined(previousBlock)) {\n                // let nextSection: WSection = blockAdv.section instanceof WSection ? blockAdv.section as WSection : undefined;\n                // if (sectionAdv !== nextSection) {\n                //     this.deleteSection(selection, sectionAdv, nextSection, editAction);\n                // }\n                //Goto the next block.\n                this.deleteBlock(previousBlock, selection, start, end, editAction);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteCellsInTable = function (table, selection, start, end, editAction) {\n        var clonedTable = undefined;\n        var isDeleteCells = false;\n        var action = 'Delete';\n        var startCell = start.paragraph.associatedCell;\n        var endCell = end.paragraph.associatedCell;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            action = this.editorHistory.currentBaseHistoryInfo.action;\n            //tslint:disable-next-line:max-line-length\n            isDeleteCells = this.editorHistory.currentBaseHistoryInfo.action === 'BackSpace' || this.editorHistory.currentBaseHistoryInfo.action === 'DeleteCells'\n                || this.editorHistory.currentBaseHistoryInfo.action === 'InsertTable' || (isNullOrUndefined(startCell.ownerRow.previousWidget)\n                && isNullOrUndefined(endCell.ownerRow.nextWidget) && this.editorHistory.currentBaseHistoryInfo.action === 'Cut');\n            this.editorHistory.currentBaseHistoryInfo.action = isDeleteCells ? 'DeleteCells' : 'ClearCells';\n            clonedTable = this.cloneTableToHistoryInfo(table);\n            selection.owner.isLayoutEnabled = false;\n        }\n        var startColumnIndex = startCell.columnIndex;\n        var endColumnIndex = endCell.columnIndex + endCell.cellFormat.columnSpan - 1;\n        var startRowIndex = startCell.rowIndex;\n        var endRowIndex = endCell.rowIndex;\n        var cells = [];\n        var isStarted = false;\n        var isCellCleared = false;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.index >= startRowIndex && row.index <= endRowIndex) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (cell.columnIndex >= startColumnIndex && cell.columnIndex <= endColumnIndex) {\n                        if (!isStarted) {\n                            this.updateEditPosition(cell, selection);\n                            isStarted = true;\n                        }\n                        if (isDeleteCells) {\n                            //Specific for Backspace and Cut if selection includes all rows.\n                            var cell_1 = row.childWidgets[j];\n                            this.updateNextBlocksIndex(cell_1, false);\n                            row.childWidgets.splice(j, 1);\n                            j--;\n                        }\n                        else if (editAction < 4) {\n                            isCellCleared = this.deleteCell(cell, selection, editAction, false);\n                        }\n                    }\n                }\n                if (row.childWidgets.length === 0) {\n                    this.updateNextBlocksIndex(table.childWidgets[i], false);\n                    table.childWidgets.splice(i, 1);\n                    i--;\n                    endRowIndex--;\n                }\n            }\n        }\n        //Layouts the table after delete cells.\n        selection.owner.isLayoutEnabled = true;\n        if (table.childWidgets.length === 0) {\n            selection.editPosition = this.getHierarchicalIndex(table, '0');\n            this.setActionInternal(selection, action);\n            this.removeBlock(table);\n        }\n        else {\n            // Before lay outing need to update table grid.\n            table.isGridUpdated = false;\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n            this.viewer.layout.reLayoutTable(table);\n        }\n    };\n    Editor.prototype.deleteCell = function (cell, selection, editAction, copyChildToClipboard) {\n        //Checks whether this is last paragraph of owner textbody.\n        var block = cell.childWidgets[0];\n        if (cell.childWidgets.length === 1 && block instanceof ParagraphWidget && block.isEmpty()) {\n            return false;\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            block = cell.childWidgets[i];\n            if (editAction < 4) {\n                //Checks whether this is last paragraph of owner textbody.\n                if (block instanceof ParagraphWidget && cell.childWidgets.length === 1) {\n                    //Preserves empty paragraph, to ensure minimal content.\n                    var paragraph = block;\n                    //Removes all the inlines in the paragraph.\n                    for (var j = 0; j < paragraph.childWidgets.length; j++) {\n                        var inline = paragraph.childWidgets[j];\n                        for (var k = 0; k < inline.children.length; k++) {\n                            var element = inline.children[k];\n                            this.unLinkFieldCharacter(element);\n                            inline.children.splice(k, 1);\n                            // this.layoutInlineCollection(true, paragraph.inlines.indexOf(inline), paragraph.inlines, inline);\n                            k--;\n                            if (this.checkClearCells(selection)) {\n                                this.addRemovedNodes(element);\n                            }\n                        }\n                        if (paragraph.childWidgets.length > 1) {\n                            paragraph.childWidgets.splice(j, 1);\n                            j--;\n                        }\n                    }\n                    if (this.checkClearCells(selection)) {\n                        //Add Index for line Widget\n                        selection.editPosition = this.getHierarchicalIndex(paragraph, '0');\n                        this.updateHistoryPosition(selection.editPosition, true);\n                    }\n                    break;\n                }\n                this.removeBlock(block);\n                i--;\n                if (this.checkClearCells(selection)) {\n                    this.addRemovedNodes(block);\n                }\n            }\n        }\n        return true;\n    };\n    Editor.prototype.deleteContainer = function (cell, selection, start, end, editAction) {\n        var ownerTable = cell.ownerTable;\n        if (selection.containsRow(ownerTable.lastChild, end.paragraph.associatedCell)) {\n            this.deleteContent(ownerTable, selection, editAction);\n        }\n        else {\n            for (var i = 0; i < ownerTable.childWidgets.length; i++) {\n                var row = ownerTable.childWidgets[i];\n                if (editAction < 4) {\n                    this.updateNextBlocksIndex(row, false);\n                    ownerTable.childWidgets.splice(i, 1);\n                    this.addRemovedNodes(row);\n                    i--;\n                }\n                if (end.paragraph.isInsideTable && selection.containsRow(row, end.paragraph.associatedCell)) {\n                    this.viewer.layout.reLayoutTable(ownerTable);\n                    return;\n                }\n            }\n        }\n    };\n    Editor.prototype.deleteTableBlock = function (table, selection, start, end, editAction) {\n        table = table.combineWidget(this.viewer);\n        if (start.paragraph.isInsideTable && table.contains(start.paragraph.associatedCell)) {\n            var block = table.previousRenderedWidget;\n            // tslint:disable-next-line:max-line-length\n            var previousBlock = this.checkAndInsertBlock(table, start, end, editAction, block instanceof ParagraphWidget ? block : undefined);\n            if (selection.containsRow(table.firstChild, start.paragraph.associatedCell)) {\n                this.deleteContent(table, selection, editAction);\n            }\n            else {\n                var newTable = this.splitTable(table, start.paragraph.associatedCell.ownerRow);\n                this.deleteContent(table, selection, editAction);\n                this.viewer.layout.layoutBodyWidgetCollection(newTable.index, newTable.containerWidget, newTable, false);\n            }\n            if (!isNullOrUndefined(previousBlock)) {\n                selection.editPosition = this.getHierarchicalIndex(previousBlock, '0');\n                if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                    this.editorHistory.currentBaseHistoryInfo.endPosition = selection.editPosition;\n                }\n            }\n        }\n        else {\n            var blockAdv = table.previousRenderedWidget;\n            var sectionAdv = table.bodyWidget instanceof BodyWidget ? table.bodyWidget : undefined;\n            this.deleteContent(table, selection, editAction);\n            if (!isNullOrUndefined(blockAdv)) {\n                // let nextSection: WSection = blockAdv.section instanceof WSection ? blockAdv.section as WSection : undefined;\n                // if (sectionAdv !== nextSection) {\n                //     this.deleteSection(selection, sectionAdv, nextSection, editAction);\n                // }\n                //Goto the next block.\n                this.deleteBlock(blockAdv, selection, start, end, editAction);\n            }\n        }\n    };\n    Editor.prototype.splitTable = function (table, splitEndRow) {\n        var newTable = new TableWidget();\n        newTable.tableFormat.copyFormat(table.tableFormat);\n        newTable.index = table.index;\n        //Moves the rows to new table.\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row === splitEndRow) {\n                break;\n            }\n            newTable.childWidgets.push(row);\n            row.containerWidget = newTable;\n            table.childWidgets.splice(i, 1);\n            i--;\n        }\n        //Inserts new table in the current text position.\n        var insertIndex = table.getIndex();\n        table.containerWidget.childWidgets.splice(insertIndex, 0, newTable);\n        newTable.containerWidget = table.containerWidget;\n        this.updateNextBlocksIndex(newTable, true);\n        return newTable;\n    };\n    Editor.prototype.updateEditPosition = function (cell, selection) {\n        var firstParagraph = selection.getFirstParagraphInCell(cell);\n        selection.editPosition = this.getHierarchicalIndex(firstParagraph, '0');\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteContent = function (table, selection, editAction) {\n        if (editAction < 4) {\n            this.removeBlock(table);\n            this.addRemovedNodes(table);\n        }\n    };\n    Editor.prototype.setActionInternal = function (selection, action) {\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.currentBaseHistoryInfo.action = action;\n        }\n    };\n    Editor.prototype.checkClearCells = function (selection) {\n        // tslint:disable-next-line:max-line-length\n        return this.editorHistory && this.editorHistory.currentBaseHistoryInfo && this.editorHistory.currentBaseHistoryInfo.action !== 'ClearCells';\n    };\n    Editor.prototype.isEndInAdjacentTable = function (paragraph, endParagraph) {\n        var start = this.getHierarchicalIndex(paragraph, '');\n        var end = this.getHierarchicalIndex(endParagraph, '');\n        var selectionStart = start.split(';');\n        var selectionEnd = end.split(';');\n        return selectionStart.length < selectionEnd.length;\n    };\n    Editor.prototype.cloneTableToHistoryInfo = function (table) {\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            //Clones the entire table to preserve in history.\n            var clonedTable = table.clone();\n            //Preserves the cloned table in history info, for future undo operation.\n            this.editorHistory.currentBaseHistoryInfo.removedNodes.push(clonedTable);\n            //Sets the insert position in history info as current table.\n            if (this.viewer.selection.start.paragraph.isInsideTable &&\n                this.viewer.selection.start.paragraph.associatedCell.ownerTable === table) {\n                this.updateHistoryPosition(this.getHierarchicalIndex(table, '0'), true);\n            }\n            return clonedTable;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertParagraphPaste = function (paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction) {\n        if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing) && this.editorHistory.currentBaseHistoryInfo.action === 'Paste') {\n            var nextParagraph = this.selection.getNextParagraphBlock(currentParagraph);\n            if (nextParagraph) {\n                if (start.offset > 0 && nextParagraph === end.paragraph && paragraph === start.paragraph\n                    && this.editorHistory.currentBaseHistoryInfo.action === 'Paste') {\n                    //Combines the current paragraph with end paragraph specific for undo/redo paste action.\n                    var insertIndex = 0;\n                    this.removeBlock(currentParagraph);\n                    this.viewer.layout.clearListElementBox(nextParagraph);\n                    this.viewer.layout.clearListElementBox(currentParagraph);\n                    for (var i = 0; i < currentParagraph.childWidgets.length; i++) {\n                        var line = currentParagraph.childWidgets[i];\n                        nextParagraph.childWidgets.splice(insertIndex, 0, line);\n                        currentParagraph.childWidgets.splice(i, 1);\n                        i--;\n                        insertIndex++;\n                        line.paragraph = nextParagraph;\n                    }\n                    this.viewer.layout.reLayoutParagraph(nextParagraph, 0, 0);\n                    isCombineNextParagraph = false;\n                    var offset = this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(';') + 1);\n                    this.selection.editPosition = this.getHierarchicalIndex(nextParagraph, offset);\n                }\n            }\n        }\n        if (isCombineNextParagraph) {\n            this.deleteParagraphMark(currentParagraph, this.selection, editAction);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.removeInlines = function (paragraph, startLine, startOffset, endLine, endOffset, editAction) {\n        var isRemoved = false;\n        this.viewer.layout.clearListElementBox(paragraph);\n        var startIndex = paragraph.childWidgets.indexOf(startLine);\n        for (var i = paragraph.childWidgets.length - 1; i >= 0; i--) {\n            var lineWidget = paragraph.childWidgets[i];\n            if (startLine === lineWidget && endLine === lineWidget) {\n                this.removeContent(lineWidget, startOffset, endOffset);\n                isRemoved = true;\n                break;\n            }\n            if (endLine === lineWidget) {\n                isRemoved = true;\n                this.removeContent(lineWidget, 0, endOffset);\n            }\n            else if (startLine === lineWidget) {\n                this.removeContent(lineWidget, startOffset, this.viewer.selection.getLineLength(lineWidget));\n                break;\n            }\n            else if (isRemoved) {\n                this.removeContent(lineWidget, 0, this.viewer.selection.getLineLength(lineWidget));\n            }\n        }\n        if (isRemoved) {\n            this.removeEmptyLine(paragraph);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeContent = function (lineWidget, startOffset, endOffset) {\n        var count = this.selection.getLineLength(lineWidget);\n        for (var i = lineWidget.children.length - 1; i >= 0; i--) {\n            var inline = lineWidget.children[i];\n            if (endOffset <= count - inline.length) {\n                count -= inline.length;\n                continue;\n            }\n            var endIndex = inline.length;\n            if (count > endOffset && (count - endIndex < endOffset)) {\n                endIndex = endOffset - (count - inline.length);\n            }\n            var startIndex = 0;\n            if (count - inline.length < startOffset) {\n                startIndex = startOffset - (count - inline.length);\n            }\n            if (count > endOffset) {\n                count -= (inline.length - endIndex);\n            }\n            if (startIndex === 0 && endIndex === inline.length) {\n                if (!(this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing))) {\n                    if (inline instanceof BookmarkElementBox) {\n                        this.removedBookmarkElements.push(inline);\n                    }\n                }\n                // if (editAction < 4) {\n                this.unLinkFieldCharacter(inline);\n                this.addRemovedNodes(lineWidget.children[i]);\n                lineWidget.children.splice(i, 1);\n                // }\n            }\n            else if (inline instanceof TextElementBox) {\n                // if (editAction < 4) {\n                var span = new TextElementBox();\n                span.characterFormat.copyFormat(inline.characterFormat);\n                span.text = inline.text.substr(startIndex, endIndex - startIndex);\n                this.addRemovedNodes(span);\n                inline.text = inline.text.slice(0, startIndex) + inline.text.slice(endIndex);\n            }\n            if (startOffset >= count - (endIndex - startIndex)) {\n                break;\n            }\n            count -= (endIndex - startIndex);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeEmptyLine = function (paragraph) {\n        if (paragraph.childWidgets.length > 1) {\n            for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                var lineWidget = paragraph.childWidgets[i];\n                if (lineWidget.children.length === 0 && paragraph.childWidgets.length > 1) {\n                    paragraph.childWidgets.splice(i, 1);\n                    i--;\n                }\n            }\n        }\n    };\n    //#endregion\n    /**\n     * clone the list level\n     * @param  {WListLevel} source\n     * @private\n     */\n    Editor.prototype.cloneListLevel = function (source) {\n        var listLevel = new WListLevel(undefined);\n        this.copyListLevel(listLevel, source);\n        return listLevel;\n    };\n    /**\n     * Copies the list level\n     * @param  {WListLevel} destination\n     * @param  {WListLevel} listLevel\n     * @private\n     */\n    Editor.prototype.copyListLevel = function (destination, listLevel) {\n        if (!isNullOrUndefined(listLevel.paragraphFormat)) {\n            destination.paragraphFormat = new WParagraphFormat(destination);\n            destination.paragraphFormat.copyFormat(listLevel.paragraphFormat);\n        }\n        if (!isNullOrUndefined(listLevel.characterFormat)) {\n            destination.characterFormat = new WCharacterFormat(destination);\n            destination.characterFormat.copyFormat(listLevel.characterFormat);\n        }\n        if (!isNullOrUndefined(listLevel.followCharacter)) {\n            destination.followCharacter = listLevel.followCharacter;\n        }\n        if (!isNullOrUndefined(listLevel.listLevelPattern)) {\n            destination.listLevelPattern = listLevel.listLevelPattern;\n        }\n        if (!isNullOrUndefined(listLevel.numberFormat)) {\n            destination.numberFormat = listLevel.numberFormat;\n        }\n        if (!isNullOrUndefined(listLevel.restartLevel)) {\n            destination.restartLevel = listLevel.restartLevel;\n        }\n        if (!isNullOrUndefined(listLevel.startAt)) {\n            destination.startAt = listLevel.startAt;\n        }\n    };\n    /**\n     * Clone level override\n     * @param  {WLevelOverride} source\n     * @private\n     */\n    Editor.prototype.cloneLevelOverride = function (source) {\n        var levelOverride = new WLevelOverride();\n        if (!isNullOrUndefined(source.startAt)) {\n            levelOverride.startAt = source.startAt;\n        }\n        if (!isNullOrUndefined(source.overrideListLevel)) {\n            levelOverride.overrideListLevel = source.overrideListLevel;\n        }\n        if (!isNullOrUndefined(source.levelNumber)) {\n            levelOverride.levelNumber = source.levelNumber;\n        }\n        return levelOverride;\n    };\n    /**\n     * Update List Paragraph\n     * @private\n     */\n    Editor.prototype.updateListParagraphs = function () {\n        this.viewer.listParagraphs = [];\n        for (var j = 0; j < this.viewer.pages.length; j++) {\n            var bodyWidget = this.viewer.pages[j].bodyWidgets[0];\n            for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n                this.updateListParagraphsInBlock(bodyWidget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateListParagraphsInBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            if (!isNullOrUndefined(block.paragraphFormat)\n                && !isNullOrUndefined(block.paragraphFormat.listFormat)\n                && !isNullOrUndefined(block.paragraphFormat.listFormat.listId)) {\n                if (isNullOrUndefined(this.viewer.listParagraphs)) {\n                    this.viewer.listParagraphs = [];\n                }\n                this.viewer.listParagraphs.push(block);\n            }\n        }\n        else if (block instanceof TableWidget) {\n            for (var i = 0; i < block.childWidgets.length; i++) {\n                for (var j = 0; j < block.childWidgets[i].childWidgets.length; j++) {\n                    var cell = block.childWidgets[i].childWidgets[j];\n                    for (var k = 0; k < cell.childWidgets.length; k++) {\n                        this.updateListParagraphsInBlock(cell.childWidgets[k]);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Applies list format\n     * @param  {WList} list\n     * @private\n     */\n    Editor.prototype.onApplyList = function (list) {\n        var selection = this.viewer.selection;\n        this.setOffsetValue(this.viewer.selection);\n        this.initHistory('ListFormat');\n        var format = new WListFormat();\n        if (!isNullOrUndefined(list)) {\n            format.listId = list.listId;\n        }\n        this.viewer.owner.isShiftingEnabled = true;\n        if (selection.isEmpty) {\n            this.applyParaFormatProperty(selection.start.paragraph, 'listFormat', format, false);\n            this.layoutItemBlock(selection.start.paragraph, false);\n        }\n        else {\n            this.updateSelectionParagraphFormatting('listFormat', format, false);\n        }\n        this.reLayout(selection);\n    };\n    /**\n     * Applies bullets or numbering list\n     * @param  {string} format\n     * @param  {ListLevelPattern} listLevelPattern\n     * @param  {string} fontFamily\n     * @private\n     */\n    Editor.prototype.applyBulletOrNumbering = function (format, listLevelPattern, fontFamily) {\n        var selection = this.viewer.selection;\n        var list = selection.paragraphFormat.getList();\n        var isUpdate = false;\n        var start = selection.start;\n        if (!selection.isForward) {\n            start = selection.end;\n        }\n        var currentParagraph = start.paragraph;\n        if (isNullOrUndefined(list)) {\n            while (!isNullOrUndefined(currentParagraph.previousWidget) && currentParagraph.previousWidget instanceof ParagraphWidget\n                && currentParagraph.previousWidget.isEmpty() && currentParagraph.previousWidget.paragraphFormat.listFormat.listId === -1) {\n                currentParagraph = currentParagraph.previousWidget;\n            }\n            if (currentParagraph.previousWidget && currentParagraph.previousWidget instanceof ParagraphWidget\n                && currentParagraph.previousWidget.paragraphFormat.listFormat.listId !== -1) {\n                currentParagraph = currentParagraph.previousWidget;\n                list = this.viewer.getListById(currentParagraph.paragraphFormat.listFormat.listId);\n                isUpdate = true;\n            }\n        }\n        var startListLevel = undefined;\n        if (!isNullOrUndefined(list)) {\n            var tempList = this.viewer.getListById(currentParagraph.paragraphFormat.listFormat.listId);\n            startListLevel = this.viewer.layout.getListLevel(tempList, currentParagraph.paragraphFormat.listFormat.listLevelNumber);\n        }\n        if (isNullOrUndefined(list) || (!isNullOrUndefined(list) && ((startListLevel.listLevelPattern !== listLevelPattern) ||\n            startListLevel.numberFormat !== format || (startListLevel.characterFormat.fontFamily !== fontFamily\n            && startListLevel.listLevelPattern === 'Bullet')))) {\n            isUpdate = false;\n            list = new WList();\n            if (this.viewer.lists.length > 0) {\n                list.listId = this.viewer.lists[this.viewer.lists.length - 1].listId + 1;\n            }\n            else {\n                list.listId = 0;\n            }\n            var abstractList = new WAbstractList();\n            if (this.viewer.abstractLists.length > 0) {\n                abstractList.abstractListId = this.viewer.abstractLists[this.viewer.abstractLists.length - 1].abstractListId + 1;\n            }\n            else {\n                abstractList.abstractListId = 0;\n            }\n            list.abstractListId = abstractList.abstractListId;\n            list.abstractList = abstractList;\n            this.viewer.abstractLists.push(abstractList);\n            if (format === 'bullet' || format === 'multiLevel' || format === 'numbering') {\n                this.addListLevels(abstractList, format, selection);\n            }\n            else {\n                var listLevel = new WListLevel(abstractList);\n                listLevel.listLevelPattern = listLevelPattern;\n                listLevel.numberFormat = format;\n                if (listLevelPattern !== 'Bullet') {\n                    listLevel.startAt = 1;\n                }\n                else {\n                    listLevel.characterFormat.fontFamily = fontFamily;\n                }\n                listLevel.paragraphFormat.leftIndent = 36;\n                listLevel.paragraphFormat.firstLineIndent = -18;\n                abstractList.levels.push(listLevel);\n                selection.paragraphFormat.listLevelNumber = 0;\n            }\n            selection.paragraphFormat.setList(list);\n        }\n        else if (!isNullOrUndefined(list) && isUpdate) {\n            selection.paragraphFormat.setList(list);\n        }\n        else {\n            selection.paragraphFormat.setList(undefined);\n        }\n    };\n    Editor.prototype.addListLevels = function (abstractListAdv, listName, selection) {\n        var bulletCharacters = ['\\uf076', '\\uf0d8', '\\uf0a7', '\\uf0b7', '\\uf0a8'];\n        for (var i = abstractListAdv.levels.length; i < 9; i++) {\n            var listLevel = new WListLevel(abstractListAdv);\n            if (listName.match('bullet')) {\n                listLevel.listLevelPattern = 'Bullet';\n                listLevel.numberFormat = bulletCharacters[i < 5 ? i % 5 : i % 5 + 1];\n                listLevel.characterFormat.fontFamily = i < 3 || i === 5 ? 'Wingdings' : 'Symbol';\n            }\n            else {\n                if (listName.match('multiLevel')) {\n                    for (var j = 0; j < i + 1; j++) {\n                        listLevel.numberFormat += '%' + (j + 1).toString() + '.';\n                    }\n                    listLevel.listLevelPattern = 'Number';\n                }\n                else {\n                    listLevel.numberFormat = '%' + (i + 1).toString() + ')';\n                    listLevel.listLevelPattern = i % 3 === 0 ? 'Number'\n                        : i % 3 === 1 ? 'LowLetter' : 'LowRoman';\n                }\n                listLevel.startAt = 1;\n                listLevel.restartLevel = i;\n            }\n            if (i === 0) {\n                listLevel.paragraphFormat.leftIndent = 36;\n            }\n            else {\n                listLevel.paragraphFormat.leftIndent = 36 * i;\n            }\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            abstractListAdv.levels.push(listLevel);\n            selection.paragraphFormat.listLevelNumber = i;\n        }\n    };\n    /**\n     * Insert page break at cursor position\n     */\n    Editor.prototype.insertPageBreak = function () {\n        if (!this.owner.isReadOnlyMode) {\n            if (this.viewer.selection.start.paragraph.isInsideTable ||\n                this.viewer.selection.start.paragraph.isInHeaderFooter) {\n                return;\n            }\n            this.initComplexHistory('PageBreak');\n            this.onEnter(true);\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo != null) {\n                this.editorHistory.updateComplexHistory();\n            }\n            this.selection.checkForCursorVisibility();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onEnter = function (isInsertPageBreak) {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            //ToDo: Need to handle the CTRL + Enter (Page Break) and SHIFT + Enter (Line Break) behavior.\n            var hyperlinkField = selection.getHyperlinkField();\n            var isSelectionOnHyperlink = !isNullOrUndefined(hyperlinkField);\n            if (isSelectionOnHyperlink) {\n                selection.fireRequestNavigate(hyperlinkField);\n                return;\n            }\n            var paragraph = selection.start.paragraph;\n            if (paragraph.isEmpty() && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                // tslint:disable-next-line:max-line-length\n                this.onApplyListInternal(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId), paragraph.paragraphFormat.listFormat.listLevelNumber - 1);\n                return;\n            }\n        }\n        this.initHistory('Enter');\n        var isRemoved = true;\n        if (!selection.isEmpty) {\n            // this.initHistoryWithSelection(selection, 'Enter');\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (isRemoved) {\n            selection.owner.isShiftingEnabled = true;\n            this.updateInsertPosition();\n            var blockInfo = this.getParagraphInfo(selection.start);\n            var initialStart = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            this.splitParagraphInternal(selection, selection.start.paragraph, selection.start.currentWidget, selection.start.offset);\n            this.setPositionForCurrentIndex(selection.start, initialStart);\n            if (isInsertPageBreak) {\n                var currentParagraph = selection.start.paragraph;\n                var breakParagraph = new ParagraphWidget();\n                breakParagraph.characterFormat.copyFormat(currentParagraph.characterFormat);\n                breakParagraph.paragraphFormat.copyFormat(currentParagraph.paragraphFormat);\n                var pageBreak = new TextElementBox();\n                pageBreak.text = '\\f';\n                var line = new LineWidget(breakParagraph);\n                line.children.push(pageBreak);\n                pageBreak.line = line;\n                breakParagraph.childWidgets.push(line);\n                this.insertParagraph(breakParagraph, true);\n                selection.selectParagraph(breakParagraph, true);\n            }\n            var nextNode = selection.start.paragraph.nextWidget;\n            if (isNullOrUndefined(nextNode)) {\n                nextNode = selection.getNextRenderedBlock(selection.start.paragraph);\n            }\n            selection.selectParagraph(nextNode, true);\n            this.updateEndPosition();\n            if (isInsertPageBreak && this.editorHistory) {\n                this.owner.editorHistory.updateHistory();\n            }\n            // if (!isNullOrUndefined(selection.currentHistoryInfo)) {\n            //     this.updateComplexHistory();\n            // } else {\n            this.reLayout(selection);\n            // }\n            var paragraph = selection.start.paragraph.previousWidget;\n            if (!isNullOrUndefined(paragraph) && !paragraph.isEmpty() &&\n                // tslint:disable-next-line:max-line-length\n                paragraph.lastChild.children[paragraph.lastChild.children.length - 1] instanceof TextElementBox) {\n                this.checkAndConvertToHyperlink(selection, true, paragraph);\n            }\n        }\n    };\n    Editor.prototype.splitParagraphInternal = function (selection, paragraphAdv, currentLine, offset) {\n        var insertIndex = 0;\n        var blockIndex = paragraphAdv.index;\n        var paragraph = new ParagraphWidget();\n        var lineWidget = new LineWidget(paragraph);\n        paragraph.childWidgets.push(lineWidget);\n        //Copies the format to new paragraph.\n        paragraph.paragraphFormat.ownerBase = paragraph;\n        if (currentLine === paragraphAdv.lastChild && offset === selection.getLineLength(currentLine)) {\n            // tslint:disable-next-line:max-line-length\n            if (paragraphAdv.paragraphFormat.baseStyle\n                && paragraphAdv.paragraphFormat.baseStyle.name !== 'Normal' && paragraphAdv.paragraphFormat.baseStyle.next instanceof WParagraphStyle) {\n                if (paragraphAdv.paragraphFormat.baseStyle.name === paragraphAdv.paragraphFormat.baseStyle.next.name) {\n                    paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n                    paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n                }\n                else {\n                    paragraph.paragraphFormat.baseStyle = paragraphAdv.paragraphFormat.baseStyle.next;\n                }\n                this.selection.skipFormatRetrieval = false;\n            }\n            else {\n                paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n                paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n            }\n            //ToDo in future: Need to skip copying formattings to new paragraph, if the style for following paragraph is same style.\n            insertIndex++;\n            blockIndex++;\n        }\n        else {\n            paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n            paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n            if (offset > 0 || !currentLine.isFirstLine()) {\n                paragraphAdv = paragraphAdv.combineWidget(this.viewer);\n                this.moveInlines(paragraphAdv, paragraph, 0, 0, paragraphAdv.firstChild, offset, currentLine);\n            }\n            paragraphAdv = paragraphAdv.getSplitWidgets()[0];\n        }\n        insertIndex += paragraphAdv.getIndex();\n        var container = paragraphAdv.containerWidget;\n        var childNodes = container.childWidgets;\n        childNodes.splice(insertIndex, 0, paragraph);\n        paragraph.containerWidget = container;\n        paragraph.index = blockIndex;\n        this.updateNextBlocksIndex(paragraph, true);\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.layoutBodyWidgetCollection(blockIndex, container, paragraph, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateNextBlocksIndex = function (block, increaseIndex) {\n        var nextIndex = block.containerWidget.childWidgets.indexOf(block) + 1;\n        if (block.containerWidget instanceof BodyWidget) {\n            var currentSectionIndex = block.containerWidget.index;\n            for (var j = this.viewer.pages.indexOf(block.containerWidget.page); j < this.viewer.pages.length; j++) {\n                var page = this.viewer.pages[j];\n                if (page.bodyWidgets[0].index === currentSectionIndex) {\n                    for (var k = nextIndex; k < page.bodyWidgets[0].childWidgets.length; k++) {\n                        var childWidget = page.bodyWidgets[0].childWidgets[k];\n                        this.updateIndex(childWidget, increaseIndex);\n                    }\n                    nextIndex = 0;\n                }\n                else {\n                    return;\n                }\n            }\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            var cells = block.containerWidget.getSplitWidgets();\n            var currentCellIndex = cells.indexOf(block.containerWidget);\n            for (var x = currentCellIndex; x < cells.length; x++) {\n                var blocks = cells[x].childWidgets;\n                for (var y = nextIndex; y < blocks.length; y++) {\n                    this.updateIndex(blocks[y], increaseIndex);\n                }\n                currentCellIndex = 0;\n                nextIndex = 0;\n            }\n        }\n        else if (block.containerWidget instanceof TableRowWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var cell = block.containerWidget.childWidgets[i];\n                if (cell.rowIndex === block.containerWidget.index) {\n                    this.updateIndex(cell, increaseIndex);\n                }\n            }\n        }\n        else if (block.containerWidget instanceof TableWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var row = block.containerWidget.childWidgets[i];\n                this.updateIndex(row, increaseIndex);\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    row.childWidgets[j].rowIndex = row.index;\n                }\n            }\n            //update Row index of all the cell\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var nextBlock = block.containerWidget.childWidgets[i];\n                this.updateIndex(nextBlock, increaseIndex);\n            }\n        }\n    };\n    Editor.prototype.updateIndex = function (widget, increment) {\n        if (increment) {\n            widget.index++;\n        }\n        else {\n            widget.index--;\n        }\n    };\n    Editor.prototype.updateEndPosition = function () {\n        var selection = this.viewer.selection;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onBackSpace = function () {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.singleBackspace(selection, false);\n        }\n        else {\n            this.initHistory('BackSpace');\n            var skipBackSpace = this.deleteSelectedContents(selection, true);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                if (skipBackSpace) {\n                    this.editorHistory.currentBaseHistoryInfo = undefined;\n                }\n                else {\n                    if (this.checkEndPosition(selection)) {\n                        this.updateHistoryPosition(selection.end, false);\n                    }\n                    this.reLayout(selection);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertRemoveBookMarkElements = function () {\n        var isHandledComplexHistory = false;\n        for (var i = 0; i < this.removedBookmarkElements.length; i++) {\n            var bookMark = this.removedBookmarkElements[i];\n            if (bookMark.bookmarkType === 0) {\n                var bookMarkStart = bookMark;\n                if (bookMarkStart && bookMarkStart.reference && this.removedBookmarkElements.indexOf(bookMarkStart.reference) !== -1) {\n                    var endIndex = this.removedBookmarkElements.indexOf(bookMarkStart.reference);\n                    var startIndex = this.removedBookmarkElements.indexOf(bookMarkStart);\n                    this.removedBookmarkElements.splice(endIndex, 1);\n                    this.removedBookmarkElements.splice(startIndex, 1);\n                }\n                else {\n                    this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action);\n                    this.editorHistory.updateHistory();\n                    this.initInsertInline(bookMarkStart.clone());\n                    this.editorHistory.updateComplexHistory();\n                    isHandledComplexHistory = true;\n                }\n            }\n            else {\n                var bookMarkEnd = bookMark;\n                if (bookMarkEnd && bookMarkEnd.reference && this.removedBookmarkElements.indexOf(bookMarkEnd.reference) !== -1) {\n                    var endIndex = this.removedBookmarkElements.indexOf(bookMarkEnd.reference);\n                    var startIndex = this.removedBookmarkElements.indexOf(bookMarkEnd);\n                    this.removedBookmarkElements.splice(endIndex, 1);\n                    this.removedBookmarkElements.splice(startIndex, 1);\n                }\n                else {\n                    this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action);\n                    this.editorHistory.updateHistory();\n                    this.initInsertInline(bookMarkEnd.clone());\n                    this.editorHistory.updateComplexHistory();\n                    isHandledComplexHistory = true;\n                }\n            }\n        }\n        this.removedBookmarkElements = [];\n        return isHandledComplexHistory;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteSelectedContents = function (selection, isBackSpace) {\n        var skipBackSpace = this.deleteSelectedContentInternal(selection, isBackSpace, selection.start, selection.end);\n        var textPosition = new TextPosition(selection.owner);\n        var blockInfo = this.getParagraph({ index: selection.editPosition });\n        var lineInfo = this.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n        selection.selectContent(textPosition, true);\n        return skipBackSpace;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.singleBackspace = function (selection, isRedoing) {\n        var history = this.editorHistory;\n        // If backspace is pressed after auto format to hyperlink is done, need to undo auto format.\n        if (history && !isRedoing && !history.canRedo() && history.canUndo()) {\n            var historyInfo = history.undoStack[history.undoStack.length - 1];\n            var startBlockInfo = this.getParagraphInfo(selection.start);\n            var endBlockInfo = this.getParagraphInfo(selection.end);\n            // tslint:disable-next-line:max-line-length\n            if (historyInfo.action === 'AutoFormatHyperlink' && historyInfo.insertPosition === this.getHierarchicalIndex(startBlockInfo.paragraph, startBlockInfo.offset.toString()) &&\n                historyInfo.endPosition === this.getHierarchicalIndex(endBlockInfo.paragraph, endBlockInfo.offset.toString())) {\n                history.undo();\n                return;\n            }\n        }\n        var paragraph = selection.start.paragraph;\n        var currentLineWidget = selection.start.currentWidget;\n        var offset = selection.start.offset;\n        var indexInInline = 0;\n        var inlineObj = currentLineWidget.getInline(offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        var previousInline = inline;\n        if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            if (HelperMethods.isLinkedFieldCharacter(inline)) {\n                var begin = inline.fieldBegin;\n                var end = inline.fieldEnd;\n                selection.start.setPositionParagraph(begin.line, begin.line.getOffset(begin, 0));\n                selection.end.setPositionParagraph(end.line, end.line.getOffset(end, 0) + 1);\n                selection.fireSelectionChanged(true);\n                return;\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            var prevInline = selection.getPreviousValidElement(inline);\n            if (prevInline instanceof FieldElementBox) {\n                inline = prevInline.fieldBegin;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n                selection.end.setPositionParagraph(inline.line, offset); //Selects the entire field.\n                selection.fireSelectionChanged(true);\n                return;\n            }\n            else if (prevInline !== inline) {\n                inline = prevInline; //Updates the offset to delete next content.\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, inline.length);\n            }\n        }\n        if (inline && (inline instanceof BookmarkElementBox && inline.bookmarkType === 1\n            || inline.previousNode instanceof BookmarkElementBox)) {\n            if (inline instanceof BookmarkElementBox) {\n                inline = inline.previousNode;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, inline.length);\n            }\n            if (inline.length === 1 && inline.nextNode instanceof BookmarkElementBox && inline.previousNode instanceof BookmarkElementBox) {\n                var begin = inline.previousNode;\n                var end = inline.nextNode;\n                selection.start.setPositionParagraph(begin.line, begin.line.getOffset(begin, 0));\n                selection.end.setPositionParagraph(end.line, end.line.getOffset(end, 0) + 1);\n                this.initHistory('BackSpace');\n                this.deleteSelectedContents(selection, true);\n                if (this.checkEndPosition(selection)) {\n                    this.updateHistoryPosition(selection.end, false);\n                }\n                this.reLayout(selection);\n                return;\n            }\n        }\n        if (!isRedoing) {\n            this.initHistory('BackSpace');\n        }\n        if (offset === selection.getStartOffset(paragraph) && selection.start.currentWidget.isFirstLine()) {\n            if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n                return;\n            }\n            if (paragraph.paragraphFormat.firstLineIndent !== 0) {\n                this.onApplyParagraphFormat('firstLineIndent', 0, false, false);\n                return;\n            }\n            if (paragraph.paragraphFormat.leftIndent !== 0) {\n                this.onApplyParagraphFormat('leftIndent', 0, false, false);\n                return;\n            }\n            if (paragraph.paragraphFormat.textAlignment !== 'Left') {\n                this.onApplyParagraphFormat('textAlignment', 'Left', false, true);\n                return;\n            }\n            if (paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n                selection.owner.isShiftingEnabled = true;\n                var previousParagraph = paragraph.previousRenderedWidget;\n                // if (isNullOrUndefined(previousParagraph)) {\n                //     previousParagraph = this.viewer.selection.getPreviousBlock(paragraph) as ParagraphWidget;\n                // }\n                if (previousParagraph.isEmpty()) {\n                    this.removeBlock(previousParagraph);\n                    this.addRemovedNodes(previousParagraph);\n                }\n                else {\n                    this.removeBlock(paragraph);\n                    var endOffset = this.viewer.selection.getLineLength(previousParagraph.lastChild);\n                    var previousIndex = previousParagraph.childWidgets.length - 1;\n                    var lineWidget = void 0;\n                    if (!paragraph.isEmpty()) {\n                        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                            lineWidget = paragraph.childWidgets[i];\n                            previousParagraph.childWidgets.push(lineWidget);\n                            paragraph.childWidgets.splice(i, 1);\n                            i--;\n                            lineWidget.paragraph = previousParagraph;\n                        }\n                    }\n                    this.viewer.layout.reLayoutParagraph(previousParagraph, previousIndex, 0);\n                    selection.selects(previousParagraph.childWidgets[previousIndex], endOffset, true);\n                    this.addRemovedNodes(paragraph);\n                }\n                this.setPositionForHistory();\n                // if (!isRedoing) {\n                this.reLayout(selection);\n                // }\n            }\n            else {\n                if (this.editorHistory) {\n                    this.editorHistory.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n        else {\n            if (!isRedoing) {\n                selection.owner.isShiftingEnabled = true;\n            }\n            var paragraphInfo = this.getParagraphInfo(selection.start);\n            var lineWidget = selection.start.currentWidget;\n            var removeOffset = offset - 1;\n            if (removeOffset < 0) {\n                lineWidget = lineWidget.previousLine;\n                removeOffset = this.viewer.selection.getLineLength(lineWidget) + removeOffset;\n            }\n            this.removeAtOffset(lineWidget, selection, removeOffset);\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset - 1, false);\n            this.setPositionForHistory();\n            if (!isRedoing) {\n                this.reLayout(selection);\n            }\n            else {\n                this.fireContentChange();\n            }\n        }\n    };\n    Editor.prototype.setPositionForHistory = function (editPosition) {\n        var selection = this.viewer.selection;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            if (isNullOrUndefined(editPosition)) {\n                this.updateHistoryPosition(selection.start, true);\n                this.editorHistory.currentBaseHistoryInfo.endPosition = this.editorHistory.currentBaseHistoryInfo.insertPosition;\n            }\n            else {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = editPosition;\n                this.editorHistory.currentBaseHistoryInfo.endPosition = editPosition;\n            }\n        }\n    };\n    Editor.prototype.removeAtOffset = function (lineWidget, selection, offset) {\n        var count = 0;\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var inline = lineWidget.children[i];\n            if (inline instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset < count + inline.length) {\n                var indexInInline = offset - count;\n                if (offset === count && inline.length === 1) {\n                    this.unLinkFieldCharacter(inline);\n                    lineWidget.children.splice(i, 1);\n                    this.viewer.layout.reLayoutParagraph(lineWidget.paragraph, lineIndex, i);\n                    this.addRemovedNodes(inline);\n                }\n                else {\n                    var span = new TextElementBox();\n                    span.characterFormat.copyFormat(inline.characterFormat);\n                    span.text = inline.text.substr(indexInInline, 1);\n                    inline.text = HelperMethods.remove(inline.text, indexInInline, 1);\n                    this.viewer.layout.reLayoutParagraph(lineWidget.paragraph, lineIndex, i);\n                    this.addRemovedNodes(span);\n                }\n                break;\n            }\n            count += inline.length;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onDelete = function () {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.singleDelete(selection, false);\n        }\n        else {\n            // this.initComplexHistory('MultiSelection');\n            // for (let i: number = 0; i < selection.selectionRanges.length; i++) {\n            // let selectionRange: SelectionRange = selection.selectionRanges.getRange(i);\n            this.initHistory('Delete');\n            this.deleteSelectedContentInternal(selection, false, selection.start, selection.end);\n            var textPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n            selection.selectContent(textPosition, true);\n            // if (this.viewer.owner.enableEditorHistory) {\n            this.reLayout(selection);\n            // }\n            // this.updateSelectionRangeOffSet(selection.start, selection.end);\n            // }\n            // let textPosition: TextPosition = new TextPosition(selection.owner, this.viewer);\n            // this.setPositionForCurrentIndex(textPosition,selection.editPosition);\n            // selection.selectContent(textPosition, true);\n            // if (!isNullOrUndefined(selection.currentHistoryInfo)) {\n            //     this.updateComplexHistory();\n            // } else {\n            //     this.updateComplexWithoutHistory();\n            // }\n        }\n    };\n    /**\n     * Remove single character on right of cursor position\n     * @param  {Selection} selection\n     * @param  {boolean} isRedoing\n     * @private\n     */\n    Editor.prototype.singleDelete = function (selection, isRedoing) {\n        // tslint:disable-next-line:max-line-length\n        var paragraph = selection.start.paragraph;\n        var offset = selection.start.offset;\n        var indexInInline = 0;\n        var inlineObj = paragraph.getInline(selection.start.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1 &&\n            this.viewer.isListTextSelected && selection.contextType === 'List') {\n            this.onApplyList(undefined);\n            return;\n        }\n        if (!isNullOrUndefined(inline) && indexInInline === inline.length && !isNullOrUndefined(inline.nextNode)) {\n            inline = inline.nextNode;\n            indexInInline = 0;\n        }\n        if (!isNullOrUndefined(inline)) {\n            var nextRenderedInline = undefined;\n            var nextInline = selection.getNextValidElement(inline);\n            if (nextInline instanceof ElementBox) {\n                nextRenderedInline = nextInline;\n            }\n            if (!isNullOrUndefined(nextRenderedInline) && nextRenderedInline instanceof FieldElementBox\n                && nextRenderedInline.fieldType === 0) { //Selects the entire field.\n                inline = nextRenderedInline.fieldEnd;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 1);\n                selection.end.setPositionParagraph(inline.line, offset);\n                selection.fireSelectionChanged(true);\n                return;\n            }\n            else if (inline !== nextRenderedInline) { //Updates the offset to delete next content.               \n                inline = nextRenderedInline;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n                if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    offset++;\n                }\n            }\n        }\n        if (inline && (inline instanceof BookmarkElementBox && inline.bookmarkType === 0\n            || inline.nextNode instanceof BookmarkElementBox)) {\n            if (inline instanceof BookmarkElementBox) {\n                inline = inline.nextNode;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n            }\n            if (inline.length === 1 && inline.nextNode instanceof BookmarkElementBox\n                && inline.previousNode instanceof BookmarkElementBox) {\n                var bookMarkBegin = inline.previousNode;\n                var bookMarkEnd = inline.nextNode;\n                selection.start.setPositionParagraph(bookMarkBegin.line, bookMarkBegin.line.getOffset(bookMarkBegin, 0));\n                selection.end.setPositionParagraph(bookMarkEnd.line, bookMarkEnd.line.getOffset(bookMarkEnd, 0) + 1);\n                this.initHistory('Delete');\n                this.deleteSelectedContentInternal(selection, false, selection.start, selection.end);\n                var textPosition = new TextPosition(selection.owner);\n                this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n                selection.selectContent(textPosition, true);\n                this.reLayout(selection);\n                return;\n            }\n        }\n        if (selection.start.currentWidget.isLastLine() && offset === this.viewer.selection.getLineLength(selection.start.currentWidget)) {\n            if (paragraph.isInsideTable && isNullOrUndefined(paragraph.nextWidget)) {\n                return;\n            }\n            var previousParagraph = undefined;\n            var newParagraph = undefined;\n            var nextParagraph = selection.getNextParagraphBlock(paragraph);\n            if (isNullOrUndefined(nextParagraph)) {\n                if (offset > 0) {\n                    return;\n                }\n                else {\n                    if (paragraph.previousWidget instanceof ParagraphWidget) {\n                        previousParagraph = paragraph.previousWidget;\n                    }\n                    if (paragraph.previousWidget instanceof TableWidget) {\n                        return;\n                    }\n                    if (isNullOrUndefined(previousParagraph)) {\n                        return;\n                        //Adds an empty paragraph, to ensure minimal content.\n                    }\n                }\n            }\n            if (!isRedoing) {\n                this.initHistory('Delete');\n            }\n            var blockInfo = this.getParagraphInfo(selection.start);\n            selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.checkInsertPosition(selection)) {\n                this.setPositionForHistory(selection.editPosition);\n            }\n            selection.owner.isShiftingEnabled = true;\n            if (paragraph.isEmpty()) {\n                this.removeBlock(paragraph);\n                this.addRemovedNodes(paragraph);\n                if (isNullOrUndefined(nextParagraph)) {\n                    if (isNullOrUndefined(previousParagraph)) {\n                        // selection.selectParagraph(newParagraph, true, true);\n                        var paraEndOffset = selection.getParagraphLength(newParagraph) + 1;\n                        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                            this.updateHistoryPosition(selection.start, true);\n                            //tslint:disable-next-line:max-line-length\n                            this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(newParagraph, paraEndOffset.toString());\n                        }\n                    }\n                    else {\n                        selection.selectParagraph(previousParagraph, false);\n                        this.setPositionForHistory();\n                    }\n                }\n                else {\n                    selection.selectParagraph(nextParagraph, true);\n                }\n            }\n            else {\n                paragraph = paragraph.combineWidget(this.viewer);\n                // tslint:disable-next-line:max-line-length\n                var currentParagraph = this.splitParagraph(paragraph, paragraph.firstChild, 0, selection.start.currentWidget, selection.start.offset, true);\n                this.deleteParagraphMark(currentParagraph, selection, 0);\n                this.addRemovedNodes(paragraph);\n                this.setPositionForCurrentIndex(selection.start, selection.editPosition);\n                selection.selectContent(selection.start, true);\n            }\n            // if (!isRedoing) {\n            this.reLayout(selection);\n            // }\n        }\n        else {\n            this.singleDeleteInternal(selection, isRedoing, paragraph);\n        }\n    };\n    Editor.prototype.singleDeleteInternal = function (selection, isRedoing, paragraph) {\n        if (!isRedoing) {\n            selection.owner.isShiftingEnabled = true;\n            this.initHistory('Delete');\n        }\n        if (this.checkInsertPosition(selection)) {\n            this.updateHistoryPosition(selection.start, true);\n            this.editorHistory.currentBaseHistoryInfo.endPosition = this.editorHistory.currentBaseHistoryInfo.insertPosition;\n        }\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        var lineWidget = selection.start.currentWidget;\n        var removeOffset = selection.start.offset;\n        var lineLength = selection.getLineLength(selection.start.currentWidget);\n        if (removeOffset >= lineLength) {\n            lineWidget = lineWidget.nextLine;\n            removeOffset = removeOffset - lineLength;\n        }\n        this.removeAtOffset(lineWidget, selection, removeOffset);\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset, false);\n        if (!isRedoing) {\n            this.reLayout(selection);\n        }\n        else {\n            this.fireContentChange();\n        }\n    };\n    Editor.prototype.deleteParagraphMark = function (paragraph, selection, editAction) {\n        if (isNullOrUndefined(paragraph.containerWidget)) {\n            return;\n        }\n        paragraph = paragraph.combineWidget(this.viewer);\n        var nextParagraph = selection.getNextParagraphBlock(paragraph);\n        if (paragraph.isInsideTable && isNullOrUndefined(paragraph.nextWidget) || isNullOrUndefined(nextParagraph)) {\n            return;\n        }\n        //BodyWidget\n        var section = paragraph.containerWidget instanceof BodyWidget ? paragraph.containerWidget : undefined;\n        var table = undefined;\n        if (selection.getNextRenderedBlock(paragraph) instanceof TableWidget) {\n            table = selection.getNextRenderedBlock(paragraph);\n        }\n        else {\n            table = undefined;\n        }\n        if (nextParagraph.isInsideTable && !isNullOrUndefined(table) && table.contains(nextParagraph.associatedCell)) {\n            if (editAction < 4) {\n                // let nextSection: BodyWidget = table.containerWidget instanceof BodyWidget ? table.containerWidget : undefined;\n                // if (section !== nextSection) {\n                //     this.combineSection(section, selection, nextSection);\n                // }\n                var offset = 0;\n                this.removeBlock(paragraph);\n                this.viewer.layout.clearListElementBox(nextParagraph);\n                this.viewer.layout.clearListElementBox(paragraph);\n                for (var i = paragraph.childWidgets.length - 1; i >= 0; i--) {\n                    var line = paragraph.childWidgets[i];\n                    for (var j = line.children.length - 1; j >= 0; j--) {\n                        var element = line.children[j];\n                        offset += element.length;\n                        nextParagraph.firstChild.children.unshift(element);\n                        element.line = nextParagraph.firstChild;\n                        // this.layoutInlineCollection(false, 0, nextParagraph.inlines, inline);\n                    }\n                }\n                this.viewer.layout.reLayoutParagraph(nextParagraph, 0, 0);\n                if (offset > 0) {\n                    selection.editPosition = this.getHierarchicalIndex(nextParagraph, offset.toString());\n                }\n            }\n        }\n        else {\n            if (editAction < 4) {\n                // let nextSection: WSection = nextParagraph.section instanceof WSection ? nextParagraph.section as WSection : undefined;\n                // if (section !== nextSection) {\n                //     this.combineSection(section, selection, nextSection);\n                // }\n                var prevLength = paragraph.childWidgets.length - 1;\n                var nextPara = nextParagraph.getSplitWidgets();\n                nextParagraph = nextParagraph.combineWidget(this.viewer);\n                this.viewer.layout.clearListElementBox(nextParagraph);\n                this.viewer.layout.clearListElementBox(paragraph);\n                this.updateEditPositionOnMerge(paragraph, nextParagraph);\n                for (var i = 0; i < nextParagraph.childWidgets.length; i++) {\n                    var inline = nextParagraph.childWidgets[i];\n                    nextParagraph.childWidgets.splice(i, 1);\n                    paragraph.childWidgets.push(inline);\n                    inline.paragraph = paragraph;\n                    i--;\n                }\n                if (nextParagraph.childWidgets.length === 0) {\n                    nextParagraph.childWidgets.push(new LineWidget(nextParagraph));\n                }\n                this.removeBlock(nextParagraph);\n                this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n                this.addRemovedNodes(nextParagraph);\n            }\n        }\n    };\n    Editor.prototype.updateEditPositionOnMerge = function (currentParagraph, nextParagraph) {\n        if (this.viewer.selection.editPosition === this.getHierarchicalIndex(nextParagraph, '0') &&\n            nextParagraph.nextRenderedWidget === undefined) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selection.editPosition = this.getHierarchicalIndex(currentParagraph, this.viewer.selection.getLineLength(currentParagraph.lastChild).toString());\n        }\n    };\n    Editor.prototype.checkEndPosition = function (selection) {\n        return (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.endPosition));\n    };\n    Editor.prototype.checkInsertPosition = function (selection) {\n        return (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition));\n    };\n    Editor.prototype.checkIsNotRedoing = function () {\n        return this.viewer.owner.enableHistoryMode && !this.editorHistory.isRedoing;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteSelectedContentInternal = function (selection, isBackSpace, startPosition, endPosition) {\n        var startPos = startPosition;\n        var endPos = endPosition;\n        if (!startPosition.isExistBefore(endPosition)) {\n            startPos = endPosition;\n            endPos = startPosition;\n        }\n        var blockInfo = this.getParagraphInfo(startPos);\n        selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        var skipBackSpace = false;\n        if (isBackSpace && startPos.isInSameParagraph(endPos)) {\n            //Handled specifically to skip removal of contents, if selection is only paragraph mark and next rendered block is table.\n            if (startPos.offset < endPos.offset && startPos.offset === selection.getParagraphLength(endPos.paragraph)) {\n                var nextBlock = selection.getNextRenderedBlock(startPos.paragraph);\n                skipBackSpace = nextBlock instanceof TableWidget;\n            }\n            //Handled specifically to remove paragraph completely (Delete behavior), if the selected paragraph is empty.\n            if (endPos.offset === 1 && endPos.offset > selection.getParagraphLength(endPos.paragraph)\n                && !(endPos.paragraph.isInsideTable && isNullOrUndefined(endPos.paragraph.nextWidget))) {\n                isBackSpace = false;\n            }\n        }\n        if (!skipBackSpace) {\n            selection.owner.isShiftingEnabled = true;\n            if (this.checkInsertPosition(selection)) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = selection.editPosition;\n            }\n            var editAction = (isBackSpace ? 1 : 0);\n            this.deleteSelectedContent(endPos.paragraph, selection, startPos, endPos, editAction);\n        }\n        return skipBackSpace;\n    };\n    /**\n     * Init EditorHistory\n     * @private\n     */\n    Editor.prototype.initHistory = function (action) {\n        if (this.viewer.owner.enableHistoryMode) {\n            this.editorHistory.initializeHistory(action);\n        }\n    };\n    /**\n     * Init Complex EditorHistory\n     * @private\n     */\n    Editor.prototype.initComplexHistory = function (action) {\n        if (this.viewer.owner.enableHistoryMode) {\n            this.editorHistory.initComplexHistory(this.viewer.selection, action);\n        }\n    };\n    //Insert Picture implementation starts\n    /**\n     * Insert image\n     * @param  {string} base64String\n     * @param  {number} width\n     * @param  {number} height\n     * @private\n     */\n    Editor.prototype.insertPicture = function (base64String, width, height) {\n        var imageElementBox = new ImageElementBox(true);\n        imageElementBox.imageString = base64String;\n        imageElementBox.width = width;\n        imageElementBox.height = height;\n        this.insertPictureInternal(imageElementBox);\n    };\n    Editor.prototype.insertPictureInternal = function (imageElementBox) {\n        var selection = this.viewer.selection;\n        this.initHistory('InsertInline');\n        this.fitImageToPage(selection, imageElementBox);\n        this.insertInlineInSelection(selection, imageElementBox);\n        this.reLayout(selection);\n    };\n    Editor.prototype.fitImageToPage = function (selection, imageElementBox) {\n        var section = selection.start.paragraph.bodyWidget;\n        var pageWidth = section.sectionFormat.pageWidth - section.sectionFormat.leftMargin - section.sectionFormat.rightMargin;\n        var pageHeight = section.sectionFormat.pageHeight - section.sectionFormat.topMargin - section.sectionFormat.topMargin;\n        //Resizes image to page size.\n        if (imageElementBox.width > pageWidth) {\n            imageElementBox.height = imageElementBox.height * pageWidth / imageElementBox.width;\n            imageElementBox.width = pageWidth;\n        }\n        if (imageElementBox.height > pageHeight) {\n            imageElementBox.width = imageElementBox.width * pageHeight / imageElementBox.height;\n            imageElementBox.height = pageHeight;\n        }\n    };\n    //Insert Picture implementation ends\n    /**\n     * @private\n     */\n    Editor.prototype.insertInlineInSelection = function (selection, elementBox) {\n        if (this.checkIsNotRedoing()) {\n            selection.owner.isShiftingEnabled = true;\n        }\n        if (!selection.isEmpty) {\n            this.removeSelectedContents(selection);\n        }\n        this.updateInsertPosition();\n        this.insertInlineInternal(elementBox);\n        if (this.checkEndPosition(selection)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onPortrait = function () {\n        var sectionFormat = new WSectionFormat();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (width > height) {\n            sectionFormat.pageWidth = height;\n            sectionFormat.pageHeight = width;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onLandscape = function () {\n        var sectionFormat = new WSectionFormat();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (width < height) {\n            sectionFormat.pageWidth = height;\n            sectionFormat.pageHeight = width;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    Editor.prototype.copyValues = function () {\n        var format = new WSectionFormat();\n        format.bottomMargin = this.viewer.selection.sectionFormat.bottomMargin;\n        format.topMargin = this.viewer.selection.sectionFormat.topMargin;\n        format.leftMargin = this.viewer.selection.sectionFormat.leftMargin;\n        format.rightMargin = this.viewer.selection.sectionFormat.rightMargin;\n        format.pageHeight = this.viewer.selection.sectionFormat.pageHeight;\n        format.pageWidth = this.viewer.selection.sectionFormat.pageWidth;\n        format.footerDistance = this.viewer.selection.sectionFormat.footerDistance;\n        format.headerDistance = this.viewer.selection.sectionFormat.headerDistance;\n        return format;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.changeMarginValue = function (property) {\n        var sectionFormat = this.copyValues();\n        if (property === 'lastCustomSetting' || property === 'normal') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 72;\n            sectionFormat.rightMargin = 72;\n        }\n        else if (property === 'narrow') {\n            sectionFormat.topMargin = 36;\n            sectionFormat.bottomMargin = 36;\n            sectionFormat.leftMargin = 36;\n            sectionFormat.rightMargin = 36;\n        }\n        else if (property === 'moderate') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 54;\n            sectionFormat.rightMargin = 54;\n        }\n        else if (property === 'wide') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 144;\n            sectionFormat.rightMargin = 144;\n        }\n        else if (property === 'mirrored') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 90;\n            sectionFormat.rightMargin = 72;\n        }\n        else if (property === 'office2003Default') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 90;\n            sectionFormat.rightMargin = 90;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onPaperSize = function (property) {\n        var sectionFormat = this.copyValues();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (property === 'letter') {\n            if (width < height) {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 791.9;\n            }\n            else {\n                sectionFormat.pageWidth = 791.9;\n                sectionFormat.pageHeight = 611.9;\n            }\n        }\n        else if (property === 'tabloid') {\n            if (width < height) {\n                sectionFormat.pageWidth = 791.9;\n                sectionFormat.pageHeight = 1223.9;\n            }\n            else {\n                sectionFormat.pageWidth = 1223.9;\n                sectionFormat.pageHeight = 791.9;\n            }\n        }\n        else if (property === 'legal') {\n            if (width < height) {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 1007.9;\n            }\n            else {\n                sectionFormat.pageWidth = 1007.9;\n                sectionFormat.pageHeight = 611.9;\n            }\n        }\n        else if (property === 'statement') {\n            if (width < height) {\n                sectionFormat.pageWidth = 396;\n                sectionFormat.pageHeight = 611.9;\n            }\n            else {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 396;\n            }\n        }\n        else if (property === 'executive') {\n            if (width < height) {\n                sectionFormat.pageWidth = 521.9;\n                sectionFormat.pageHeight = 755.9;\n            }\n            else {\n                sectionFormat.pageWidth = 755.9;\n                sectionFormat.pageHeight = 521.9;\n            }\n        }\n        else if (property === 'a3') {\n            if (width < height) {\n                sectionFormat.pageWidth = 841.8;\n                sectionFormat.pageHeight = 1190.4;\n            }\n            else {\n                sectionFormat.pageWidth = 1190.4;\n                sectionFormat.pageHeight = 841.8;\n            }\n        }\n        else if (property === 'a4') {\n            if (width < height) {\n                sectionFormat.pageWidth = 595.2;\n                sectionFormat.pageHeight = 841.8;\n            }\n            else {\n                sectionFormat.pageWidth = 841.8;\n                sectionFormat.pageHeight = 595.2;\n            }\n        }\n        else if (property === 'a5') {\n            if (width < height) {\n                sectionFormat.pageWidth = 419.5;\n                sectionFormat.pageHeight = 595.2;\n            }\n            else {\n                sectionFormat.pageWidth = 595.2;\n                sectionFormat.pageHeight = 419.5;\n            }\n        }\n        else if (property === 'b4') {\n            if (width < height) {\n                sectionFormat.pageWidth = 728.4;\n                sectionFormat.pageHeight = 1031.7;\n            }\n            else {\n                sectionFormat.pageWidth = 1031.7;\n                sectionFormat.pageHeight = 728.4;\n            }\n        }\n        else if (property === 'b5') {\n            if (width < height) {\n                sectionFormat.pageWidth = 515.8;\n                sectionFormat.pageHeight = 728.4;\n            }\n            else {\n                sectionFormat.pageWidth = 728.4;\n                sectionFormat.pageHeight = 515.8;\n            }\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    //Update List Items\n    /**\n     * @private\n     */\n    Editor.prototype.updateListItemsTillEnd = function (blockAdv, updateNextBlockList) {\n        var block = updateNextBlockList ? this.viewer.selection.getNextRenderedBlock(blockAdv) : blockAdv;\n        while (!isNullOrUndefined(block)) {\n            //Updates the list value of the rendered paragraph. \n            this.updateRenderedListItems(block);\n            block = block.getSplitWidgets().pop().nextRenderedWidget;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateWholeListItems = function (block) {\n        this.viewer.renderedLists.clear();\n        var sectionIndex = block.bodyWidget.index;\n        var currentBlock;\n        for (var j = 0; j < this.viewer.pages.length; j++) {\n            var page = this.viewer.pages[j];\n            if (page.bodyWidgets[0].index === sectionIndex) {\n                currentBlock = page.bodyWidgets[0].firstChild;\n                break;\n            }\n        }\n        var isListUpdated = false;\n        do {\n            isListUpdated = this.updateListItems(currentBlock, block);\n            if (isListUpdated) {\n                break;\n            }\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    Editor.prototype.updateListItems = function (blockAdv, block) {\n        var isListUpdated = false;\n        if (blockAdv instanceof ParagraphWidget) {\n            isListUpdated = this.updateListItemsForPara(blockAdv, block);\n        }\n        else {\n            isListUpdated = this.updateListItemsForTable(blockAdv, block);\n        }\n        return isListUpdated;\n    };\n    Editor.prototype.updateListItemsForTable = function (table, block) {\n        if (block instanceof TableWidget && table.equals(block)) {\n            return true;\n        }\n        var row = table.firstChild;\n        do {\n            var isListUpdated = this.updateListItemsForRow(row, block);\n            if (isListUpdated) {\n                return true;\n            }\n            row = row.getSplitWidgets().pop().nextRenderedWidget;\n        } while (row);\n        return false;\n    };\n    Editor.prototype.updateListItemsForRow = function (row, block) {\n        if (block.isInsideTable && row.childWidgets.indexOf(this.viewer.selection.getContainerCell(block.associatedCell)) !== -1) {\n            //Returns as list updated, inorder to start list numbering from first list paragraph of this row.\n            return true;\n        }\n        var cell = row.firstChild;\n        do {\n            this.updateListItemsForCell(cell, block);\n            cell = cell.nextRenderedWidget;\n        } while (cell);\n        return false;\n    };\n    Editor.prototype.updateListItemsForCell = function (cell, block) {\n        if (cell.childWidgets.length === 0) {\n            return;\n        }\n        var currentBlock = cell.firstChild;\n        do {\n            this.updateListItems(currentBlock, block);\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    // public abstract updateListParagraphs(): void;\n    /**\n     * @private\n     */\n    Editor.prototype.updateRenderedListItems = function (block) {\n        if (block instanceof ParagraphWidget) {\n            this.updateRenderedListItemsForPara(block);\n        }\n        else {\n            this.updateRenderedListItemsForTable(block);\n        }\n    };\n    Editor.prototype.updateRenderedListItemsForTable = function (table) {\n        var row = table.firstChild;\n        do {\n            this.updateRenderedListItemsForRow(row);\n            row = row.getSplitWidgets().pop().nextRenderedWidget;\n        } while (row);\n    };\n    Editor.prototype.updateRenderedListItemsForRow = function (row) {\n        var cell = row.firstChild;\n        do {\n            this.updateRenderedListItemsForCell(cell);\n            cell = cell.nextRenderedWidget;\n        } while (cell);\n    };\n    Editor.prototype.updateRenderedListItemsForCell = function (cell) {\n        if (cell.childWidgets.length === 0) {\n            return;\n        }\n        var currentBlock = cell.firstChild;\n        do {\n            this.updateRenderedListItems(currentBlock);\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    Editor.prototype.updateListItemsForPara = function (paragraph, block) {\n        if (paragraph.equals(block)) {\n            return true;\n        }\n        else {\n            var currentList = undefined;\n            var listLevelNumber = 0;\n            if (!isNullOrUndefined(paragraph.paragraphFormat) && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n                currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n                listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n            }\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(currentList) && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n                // tslint:disable-next-line:max-line-length\n                && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels[listLevelNumber])) {\n                var currentListLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n                //Updates the list numbering from document start for reLayouting.\n                if (currentListLevel.listLevelPattern !== 'Bullet') {\n                    this.viewer.layout.getListNumber(paragraph.paragraphFormat.listFormat);\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.updateRenderedListItemsForPara = function (paragraph) {\n        if (!isNullOrUndefined(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId))) {\n            var currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            var listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n            if (!isNullOrUndefined(currentList) && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n                // tslint:disable-next-line:max-line-length\n                && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels[paragraph.paragraphFormat.listFormat.listLevelNumber])) {\n                var currentListLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n                //Updates the list numbering from document start for reLayouting.\n                if (currentListLevel.listLevelPattern !== 'Bullet') {\n                    var element = undefined;\n                    if (paragraph.childWidgets.length > 0) {\n                        var lineWidget = paragraph.childWidgets[0];\n                        if (lineWidget.children.length > 0) {\n                            element = lineWidget.children[0];\n                        }\n                    }\n                    if (!isNullOrUndefined(element)) {\n                        element.text = this.viewer.layout.getListNumber(paragraph.paragraphFormat.listFormat);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Get logical offset of paragraph.\n     * @private\n     */\n    Editor.prototype.getParagraphInfo = function (position) {\n        return this.getParagraphInfoInternal(position.currentWidget, position.offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getParagraphInfoInternal = function (line, lineOffset) {\n        var paragraph = line.paragraph;\n        var offset = this.selection.getParagraphLength(paragraph, line) + lineOffset;\n        var previous = paragraph.previousSplitWidget;\n        while (previous instanceof ParagraphWidget) {\n            paragraph = previous;\n            offset += this.viewer.selection.getParagraphLength(paragraph);\n            previous = paragraph.previousSplitWidget;\n        }\n        return { 'paragraph': paragraph, 'offset': offset };\n    };\n    /**\n     * Get offset value to update in selection\n     * @private\n     */\n    Editor.prototype.getOffsetValue = function (selection) {\n        if (this.startParagraph) {\n            var lineInfo = this.getLineInfo(this.startParagraph, this.startOffset);\n            selection.start.setPositionFromLine(lineInfo.line, lineInfo.offset);\n        }\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            if (this.endParagraph) {\n                var lineInfo = this.getLineInfo(this.endParagraph, this.endOffset);\n                selection.end.setPositionFromLine(lineInfo.line, lineInfo.offset);\n            }\n            selection.end.updatePhysicalPosition(true);\n        }\n    };\n    /**\n     * Get offset value to update in selection\n     * @private\n     */\n    Editor.prototype.getLineInfo = function (paragraph, offset) {\n        var position = undefined;\n        var element = undefined;\n        var length = this.selection.getParagraphLength(paragraph);\n        var next = paragraph.nextSplitWidget;\n        if (offset > length + 1 && isNullOrUndefined(next)) {\n            offset = length;\n        }\n        while (offset > length && next instanceof ParagraphWidget) {\n            offset -= length;\n            paragraph = next;\n            length = this.selection.getParagraphLength(paragraph);\n            next = paragraph.nextSplitWidget;\n        }\n        return this.selection.getLineInfo(paragraph, offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.setPositionParagraph = function (paragraph, offset, skipSelectionChange) {\n        var selection = this.viewer.selection;\n        var lineInfo = this.getLineInfo(paragraph, offset);\n        selection.start.setPositionFromLine(lineInfo.line, lineInfo.offset);\n        selection.end.setPositionInternal(selection.start);\n        if (!skipSelectionChange) {\n            selection.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.setPositionForCurrentIndex = function (textPosition, editPosition) {\n        var blockInfo = this.getParagraph({ index: editPosition });\n        var lineInfo = this.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertPageNumber = function (numberFormat) {\n        if (isNullOrUndefined(numberFormat)) {\n            numberFormat = '';\n        }\n        else {\n            numberFormat = ' \\\\*' + numberFormat;\n        }\n        var fieldCode = 'PAGE ' + numberFormat + ' \\\\* MERGEFORMAT';\n        this.createFields(fieldCode);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertPageCount = function (numberFormat) {\n        if (isNullOrUndefined(numberFormat)) {\n            numberFormat = '';\n        }\n        else {\n            numberFormat = ' \\*' + numberFormat;\n        }\n        var fieldCode = 'NUMPAGES ' + numberFormat + ' \\* MERGEFORMAT';\n        this.createFields(fieldCode);\n    };\n    Editor.prototype.createFields = function (fieldCode) {\n        var paragraph = new ParagraphWidget();\n        var line = new LineWidget(paragraph);\n        var fieldBegin = new FieldElementBox(0);\n        line.children.push(fieldBegin);\n        var fieldtext = new FieldTextElementBox();\n        fieldtext.fieldBegin = fieldBegin;\n        fieldtext.text = '1';\n        var text = new TextElementBox();\n        text.text = fieldCode;\n        line.children.push(text);\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldBegin.fieldSeparator = fieldSeparator;\n        line.children.push(fieldSeparator);\n        line.children.push(fieldtext);\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldEnd.fieldSeparator = fieldSeparator;\n        fieldSeparator.fieldEnd = fieldEnd;\n        fieldBegin.fieldEnd = fieldEnd;\n        line.children.push(fieldEnd);\n        fieldBegin.line = line;\n        paragraph.childWidgets.push(line);\n        var widgets = [];\n        widgets.push(paragraph);\n        this.viewer.fields.push(fieldBegin);\n        this.pasteContentsInternal(widgets);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertBookmark = function (name) {\n        var bookmark = new BookmarkElementBox(0);\n        bookmark.name = name;\n        var bookmarkEnd = new BookmarkElementBox(1);\n        bookmarkEnd.name = name;\n        bookmark.reference = bookmarkEnd;\n        bookmarkEnd.reference = bookmark;\n        this.viewer.bookmarks.add(name, bookmark);\n        this.initComplexHistory('InsertBookmark');\n        this.insertElements([bookmarkEnd], [bookmark]);\n        if (this.editorHistory) {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n        this.selection.start.setPositionForSelection(bookmark.line, bookmark, 1, this.selection.start.location);\n        this.selection.end.setPositionForSelection(bookmarkEnd.line, bookmarkEnd, 0, this.selection.end.location);\n        this.selection.fireSelectionChanged(true);\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteBookmark = function (bookmarkName) {\n        var bookmarks = this.viewer.bookmarks;\n        var bookmark = bookmarks.get(bookmarkName);\n        if (bookmark instanceof BookmarkElementBox) {\n            var bookmarkEnd = bookmark.reference;\n            this.initHistory('DeleteBookmark');\n            if (this.editorHistory) {\n                this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(bookmark);\n                this.editorHistory.updateHistory();\n            }\n            this.deleteBookmarkInternal(bookmark);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteBookmarkInternal = function (bookmark) {\n        this.viewer.bookmarks.remove(bookmark.name);\n        bookmark.line.children.splice(bookmark.indexInOwner, 1);\n        bookmark.reference.line.children.splice(bookmark.reference.indexInOwner, 1);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getSelectionInfo = function () {\n        var start = this.selection.start;\n        var end = this.selection.end;\n        var isEmpty = this.selection.isEmpty;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        var startElementInfo = start.currentWidget.getInline(start.offset, 0);\n        var endElementInfo = end.currentWidget.getInline(end.offset, 0);\n        // tslint:disable-next-line:max-line-length\n        return { 'start': start.clone(), 'end': end.clone(), 'startElementInfo': startElementInfo, 'endElementInfo': endElementInfo, 'isEmpty': isEmpty };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElements = function (endElements, startElements) {\n        var info = this.getSelectionInfo();\n        if (!isNullOrUndefined(startElements)) {\n            this.insertElementsInternal(info.start, startElements);\n        }\n        if (!isNullOrUndefined(endElements)) {\n            this.insertElementsInternal(info.end, endElements);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElementsInternal = function (position, elements) {\n        this.selection.selectPosition(position, position);\n        this.initHistory('InsertElements');\n        this.updateInsertPosition();\n        var indexInInline = 0;\n        var paragraphInfo = this.getParagraphInfo(this.selection.start);\n        if (this.selection.start.paragraph.isEmpty()) {\n            var paragraph = this.selection.start.paragraph;\n            paragraph.childWidgets[0].children.push(elements[0]);\n            elements[0].line = paragraph.childWidgets[0];\n            elements[0].linkFieldCharacter(this.viewer);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n            position.setPositionForSelection(elements[0].line, elements[0], elements[0].length, this.selection.start.location);\n            this.selection.selectPosition(position, position);\n        }\n        else {\n            var inlineObj = this.selection.start.currentWidget.getInline(this.viewer.selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            var firstElement = elements[0];\n            this.insertElementInternal(curInline, firstElement, indexInInline, true);\n            var index = firstElement.indexInOwner;\n            var lastElement = firstElement;\n            for (var i = 1; i < elements.length; i++) {\n                lastElement = elements[i];\n                firstElement.line.children.splice(index + i, 0, lastElement);\n            }\n            position.setPositionForSelection(lastElement.line, lastElement, lastElement.length, this.selection.start.location);\n            this.selection.selectPosition(position, position);\n        }\n        if (this.editorHistory) {\n            if (this.checkEndPosition()) {\n                this.updateHistoryPosition(this.selection.start, false);\n            }\n            this.editorHistory.updateHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getHierarchicalIndex = function (block, offset) {\n        var index;\n        if (block) {\n            if (block instanceof HeaderFooterWidget) {\n                var hfString = block.headerFooterType.indexOf('Header') !== -1 ? 'H' : 'F';\n                var pageIndex = block.page.index.toString();\n                var headerFooterIndex = this.viewer.getHeaderFooter(block.headerFooterType).toString();\n                var sectionIndex = block.page.sectionIndex;\n                index = sectionIndex + ';' + hfString + ';' + pageIndex + ';' + offset;\n            }\n            else {\n                index = block.index + ';' + offset;\n            }\n            if (block.containerWidget) {\n                if (block instanceof TableCellWidget && block.rowIndex !== block.containerWidget.index) {\n                    index = block.rowIndex + ';' + index;\n                    block = block.containerWidget;\n                }\n                return this.getHierarchicalIndex(block.containerWidget, index);\n            }\n        }\n        return index;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBlock = function (position) {\n        var bodyWidget = this.getBodyWidget(position);\n        return this.getBlockInternal(bodyWidget, position);\n    };\n    /**\n     * Return Block relative to position\n     * @private\n     */\n    Editor.prototype.getBlockInternal = function (widget, position) {\n        if (position.index === '' || isNullOrUndefined(position)) {\n            return undefined;\n        }\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var node = widget;\n        // if (node instanceof WSection && value === 'HF') {\n        //     //Gets the block in Header footers.\n        //     let blockObj: BlockInfo = this.getBlock((node as WSection).headerFooters, position);\n        // tslint:disable-next-line:max-line-length\n        //     return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n        // }\n        index = parseInt(value, 10);\n        var childWidget = this.getBlockByIndex(widget, index);\n        if (childWidget) {\n            var child = childWidget;\n            if (position.index.indexOf(';') >= 0) {\n                if (child instanceof ParagraphWidget) {\n                    if (position.index.indexOf(';') >= 0) {\n                        position.index = '0';\n                    }\n                    return { 'node': child, 'position': position };\n                }\n                if (child instanceof Widget) {\n                    var blockObj = this.getBlockInternal(child, position);\n                    // tslint:disable-next-line:max-line-length\n                    return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n                }\n            }\n            else {\n                return { 'node': child, 'position': position };\n            }\n        }\n        else {\n            return { 'node': node, 'position': position };\n        }\n        return { 'node': node, 'position': position };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getParagraph = function (position) {\n        var paragraph = this.getParagraphInternal(this.getBodyWidget(position), position);\n        return { paragraph: paragraph, offset: parseInt(position.index, 10) };\n    };\n    /**\n     * Get paragraph relative to position\n     * @private\n     */\n    Editor.prototype.getParagraphInternal = function (container, position) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        // let ins: Widget = container;\n        var index = position.index.indexOf(';');\n        var value = '0';\n        if (index >= 0) {\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        // if (container instanceof BodyWidget && value === 'HF') {\n        //     return this.getParagraph(container.headerFooters, position);\n        // }\n        index = parseInt(value, 10);\n        if (container instanceof TableRowWidget && index >= container.childWidgets.length) {\n            position.index = '0;0';\n            index = container.childWidgets.length - 1;\n        }\n        var childWidget = this.getBlockByIndex(container, index);\n        if (childWidget) {\n            var child = childWidget;\n            if (child instanceof ParagraphWidget) {\n                if (position.index.indexOf(';') > 0) {\n                    position.index = '0';\n                }\n                return child;\n            }\n            if (child instanceof Widget) {\n                if (position.index.indexOf(';') > 0) {\n                    return this.getParagraphInternal(child, position);\n                }\n                else {\n                    //If table is shifted to previous text position then return the first paragraph within table.\n                    if (child instanceof TableWidget) {\n                        return this.viewer.selection.getFirstParagraphInFirstCell(child);\n                    }\n                    return undefined;\n                }\n            }\n        }\n        else if (container) {\n            var nextWidget = container.getSplitWidgets().pop().nextRenderedWidget;\n            if (nextWidget instanceof Widget) {\n                position.index = '0';\n                if (nextWidget instanceof TableWidget) {\n                    return this.viewer.selection.getFirstParagraphInFirstCell(nextWidget);\n                }\n                return nextWidget;\n            }\n        }\n        return undefined;\n    };\n    Editor.prototype.getBodyWidget = function (position) {\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var sectionIndex = parseInt(value, 10);\n        index = parseInt(value, 10);\n        index = position.index.indexOf(';');\n        value = position.index.substring(0, index);\n        // position = position.substring(index).replace(';', '');\n        if (value === 'H' || value === 'F') {\n            return this.getHeaderFooterWidget(position);\n        }\n        index = parseInt(value, 10);\n        return this.getBodyWidgetInternal(sectionIndex, index);\n    };\n    Editor.prototype.getHeaderFooterWidget = function (position) {\n        //HEADER OR FOOTER WIDGET\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var isHeader = value === 'H';\n        index = position.index.indexOf(';');\n        value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        index = parseInt(value, 10);\n        var page = this.viewer.pages[index];\n        if (isHeader) {\n            return page.headerWidget;\n        }\n        else {\n            return page.footerWidget;\n        }\n    };\n    Editor.prototype.getBodyWidgetInternal = function (sectionIndex, blockIndex) {\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var bodyWidget = this.viewer.pages[i].bodyWidgets[0];\n            if (bodyWidget.index === sectionIndex) {\n                if (bodyWidget.firstChild.index <= blockIndex && bodyWidget.lastChild.index >= blockIndex) {\n                    return bodyWidget;\n                }\n            }\n            if (bodyWidget.index > sectionIndex) {\n                break;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBlockByIndex = function (container, blockIndex) {\n        var childWidget;\n        if (container) {\n            for (var j = 0; j < container.childWidgets.length; j++) {\n                if (container.childWidgets[j].index === blockIndex) {\n                    childWidget = container.childWidgets[j];\n                    break;\n                }\n            }\n            if (!childWidget && !(container instanceof HeaderFooterWidget)) {\n                return this.getBlockByIndex(container.nextSplitWidget, blockIndex);\n            }\n        }\n        return childWidget;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHistoryPosition = function (position, isInsertPosition) {\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            var hierarchicalIndex = void 0;\n            if (position instanceof TextPosition) {\n                var blockInfo = this.getParagraphInfo(position);\n                hierarchicalIndex = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            }\n            else {\n                hierarchicalIndex = position;\n            }\n            if (isInsertPosition) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = hierarchicalIndex;\n            }\n            else {\n                this.editorHistory.currentBaseHistoryInfo.endPosition = hierarchicalIndex;\n            }\n        }\n    };\n    /**\n     * Applies the borders based on given settings.\n     * @param {BorderSettings} settings\n     */\n    Editor.prototype.applyBorders = function (settings) {\n        this.initHistory('Borders');\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var table = startPos.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (this.editorHistory) {\n            var clonedTable = this.cloneTableToHistoryInfo(table);\n        }\n        var startCell = startPos.paragraph.associatedCell;\n        var endCell = endPos.paragraph.associatedCell;\n        var cells;\n        var border = this.getBorder(settings.borderColor, settings.lineWidth, settings.borderStyle);\n        if (this.selection.isEmpty) {\n            //Apply borders for current selected cell initially.                    \n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'LeftBorder') {\n                endCell.cellFormat.borders.left.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'TopBorder') {\n                endCell.cellFormat.borders.top.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'RightBorder') {\n                endCell.cellFormat.borders.right.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'BottomBorder') {\n                endCell.cellFormat.borders.bottom.copyFormat(border);\n            }\n            if (settings.type === 'AllBorders' || settings.type === 'InsideBorders'\n                || settings.type === 'InsideVerticalBorder') {\n                endCell.cellFormat.borders.vertical.copyFormat(border);\n            }\n            if (settings.type === 'AllBorders' || settings.type === 'InsideBorders'\n                || settings.type === 'InsideHorizontalBorder') {\n                endCell.cellFormat.borders.horizontal.copyFormat(border);\n            }\n            if (settings.type === 'NoBorder') {\n                this.clearAllBorderValues(endCell.cellFormat.borders);\n            }\n        }\n        else {\n            if (settings.type === 'OutsideBorders' || settings.type === 'TopBorder') {\n                var selectedCell = this.getTopBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.top.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'LeftBorder') {\n                var selectedCell = this.getLeftBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.left.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'RightBorder') {\n                var selectedCell = this.getRightBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.right.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'BottomBorder') {\n                var selectedCell = this.getBottomBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.bottom.copyFormat(border);\n                }\n            }\n        }\n        //Apply Only borders property to selected cells      \n        if (settings.type === 'BottomBorder' || settings.type === 'AllBorders' || settings.type === 'OutsideBorders'\n            || settings.type === 'NoBorder') {\n            cells = this.getAdjacentCellToApplyBottomBorder();\n            for (var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if (settings.type === 'NoBorder') {\n                    cell.cellFormat.borders.top.copyFormat(this.clearBorder());\n                }\n                else {\n                    cell.cellFormat.borders.top.copyFormat(border);\n                }\n            }\n        }\n        if (settings.type === 'AllBorders' || settings.type === 'OutsideBorders' || settings.type === 'RightBorder'\n            || settings.type === 'NoBorder') {\n            cells = this.getAdjacentCellToApplyRightBorder();\n            for (var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if (settings.type === 'NoBorder') {\n                    cell.cellFormat.borders.left.copyFormat(this.clearBorder());\n                }\n                else {\n                    cell.cellFormat.borders.left.copyFormat(border);\n                }\n            }\n        }\n        if (settings.type === 'AllBorders' || settings.type === 'NoBorder') {\n            this.applyAllBorders(border, settings.type);\n        }\n        if (settings.type === 'InsideBorders' || settings.type === 'InsideVerticalBorder'\n            || settings.type === 'InsideHorizontalBorder' || settings.type === 'NoBorder') {\n            this.applyInsideBorders(border, settings.type, table);\n        }\n        this.updateGridForTableDialog(table, false);\n        this.reLayout(this.selection, false);\n        this.editorHistory.updateHistory();\n    };\n    Editor.prototype.applyAllBorders = function (border, borderType) {\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            if (borderType === 'NoBorder') {\n                cells[i].cellFormat.borders.left.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.right.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.top.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.bottom.copyFormat(this.clearBorder());\n            }\n            else {\n                cells[i].cellFormat.borders.left.copyFormat(border);\n                cells[i].cellFormat.borders.right.copyFormat(border);\n                cells[i].cellFormat.borders.top.copyFormat(border);\n                cells[i].cellFormat.borders.bottom.copyFormat(border);\n            }\n        }\n    };\n    Editor.prototype.applyInsideBorders = function (border, borderType, table) {\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            var cell = cells[i];\n            var isLastSelectedRow = cell.ownerRow === cells[cells.length - 1].ownerRow;\n            var isLastRightCell = (cell.columnIndex + cell.cellFormat.columnSpan - 1) === cells[cells.length - 1].columnIndex;\n            if (borderType === 'NoBorder') {\n                cell.cellFormat.borders.right.copyFormat(this.clearBorder());\n                cell.cellFormat.borders.bottom.copyFormat(this.clearBorder());\n            }\n            else {\n                if (!isLastRightCell && borderType !== 'InsideHorizontalBorder') {\n                    cell.cellFormat.borders.right.copyFormat(border);\n                }\n                if (!isLastSelectedRow && borderType !== 'InsideVerticalBorder') {\n                    cell.cellFormat.borders.bottom.copyFormat(border);\n                }\n            }\n            if (!isLastSelectedRow && borderType !== 'InsideVerticalBorder') {\n                // Apply adjacent bottom borders.\n                var nextRowIndex = cell.ownerRow.rowIndex + cell.cellFormat.rowSpan;\n                var nextRow = table.childWidgets[nextRowIndex];\n                if (nextRow) {\n                    var selectedCells = this.getAdjacentBottomBorderOnEmptyCells(nextRow, cell, true);\n                    for (var j = 0; j < selectedCells.length; j++) {\n                        if (borderType === 'NoBorder') {\n                            selectedCells[j].cellFormat.borders.top.copyFormat(this.clearBorder());\n                        }\n                        else {\n                            selectedCells[j].cellFormat.borders.top.copyFormat(border);\n                        }\n                    }\n                }\n            }\n            if (!isLastRightCell && borderType !== 'InsideHorizontalBorder') {\n                // Apply adjacent right borders.\n                var rightBorderCells = this.getSelectedCellsNextWidgets(cell, table);\n                for (var k = 0; k < rightBorderCells.length; k++) {\n                    if (borderType === 'NoBorder') {\n                        rightBorderCells[k].cellFormat.borders.left.copyFormat(this.clearBorder());\n                    }\n                    else {\n                        rightBorderCells[k].cellFormat.borders.left.copyFormat(border);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getTopBorderCellsOnSelection = function () {\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var startCell = startPos.paragraph.associatedCell;\n        var topBorderCells = [];\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].ownerRow === startCell.ownerRow) {\n                topBorderCells.push(cells[i]);\n            }\n        }\n        return topBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getLeftBorderCellsOnSelection = function () {\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var startCell = startPos.paragraph.associatedCell;\n        var cells = this.selection.getSelectedCells();\n        var leftBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].columnIndex === startCell.columnIndex) {\n                leftBorderCells.push(cells[i]);\n            }\n        }\n        return leftBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getRightBorderCellsOnSelection = function () {\n        var cells = this.selection.getSelectedCells();\n        var rightBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if ((cells[i].columnIndex + cells[i].cellFormat.columnSpan - 1) === cells[cells.length - 1].columnIndex) {\n                rightBorderCells.push(cells[i]);\n            }\n        }\n        return rightBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBottomBorderCellsOnSelection = function () {\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var endCell = endPos.paragraph.associatedCell;\n        var cells = this.selection.getSelectedCells();\n        var bottomBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].ownerRow === endCell.ownerRow) {\n                bottomBorderCells.push(cells[i]);\n            }\n        }\n        return bottomBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.clearAllBorderValues = function (borders) {\n        var border = this.clearBorder();\n        borders.bottom.copyFormat(border);\n        borders.left.copyFormat(border);\n        borders.right.copyFormat(border);\n        borders.top.copyFormat(border);\n        borders.vertical.copyFormat(border);\n        borders.horizontal.copyFormat(border);\n    };\n    Editor.prototype.clearBorder = function () {\n        var border = new WBorder();\n        border.lineStyle = 'Cleared';\n        return border;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getAdjacentCellToApplyBottomBorder = function () {\n        var cells = [];\n        var startPos = this.selection.start;\n        var endPos = this.selection.end;\n        if (!this.selection.isForward) {\n            startPos = this.selection.end;\n            endPos = this.selection.start;\n        }\n        var table = startPos.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        var startCell = startPos.paragraph.associatedCell;\n        var endCell = endPos.paragraph.associatedCell;\n        var nextRowIndex = endCell.ownerRow.rowIndex + endCell.cellFormat.rowSpan;\n        var nextRow = table.childWidgets[nextRowIndex];\n        if (nextRow) {\n            if (endCell.cellFormat.columnSpan > 1) {\n                for (var i = endCell.columnIndex; i < endCell.columnIndex + endCell.cellFormat.columnSpan; i++) {\n                    cells.push(nextRow.childWidgets[i]);\n                }\n            }\n            else {\n                cells = this.getAdjacentBottomBorderOnEmptyCells(nextRow, endCell);\n                if (!this.selection.isEmpty) {\n                    for (var i = 0; i < nextRow.childWidgets.length; i++) {\n                        var nextCellColIndex = nextRow.childWidgets[i].columnIndex;\n                        if (nextCellColIndex >= startCell.columnIndex && nextCellColIndex <= endCell.columnIndex) {\n                            cells.push(nextRow.childWidgets[i]);\n                        }\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getAdjacentBottomBorderOnEmptyCells = function (nextRow, cell, isSingleCell) {\n        var cells = [];\n        if (cell.cellFormat.columnSpan > 1) {\n            for (var i = cell.columnIndex; i < cell.columnIndex + cell.cellFormat.columnSpan; i++) {\n                cells.push(nextRow.childWidgets[i]);\n            }\n        }\n        else {\n            if (this.selection.isEmpty || isSingleCell) {\n                for (var i = 0; i < nextRow.childWidgets.length; i++) {\n                    if (nextRow.childWidgets[i].columnIndex === cell.columnIndex) {\n                        cells.push(nextRow.childWidgets[i]);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getAdjacentCellToApplyRightBorder = function () {\n        var cells = [];\n        var startPosIn = this.selection.start;\n        var endPosIn = this.selection.end;\n        if (!this.selection.isForward) {\n            startPosIn = this.selection.end;\n            endPosIn = this.selection.start;\n        }\n        var table = startPosIn.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        var startCell = startPosIn.paragraph.associatedCell;\n        var endCell = endPosIn.paragraph.associatedCell;\n        if (this.selection.isEmpty) {\n            var selectedCell = startPosIn.paragraph.associatedCell;\n            cells = this.getSelectedCellsNextWidgets(selectedCell, table);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            var selectedCells = this.getRightBorderCellsOnSelection();\n            for (var i = 0; i < selectedCells.length; i++) {\n                var cell = selectedCells[i];\n                cells = cells.concat(this.getSelectedCellsNextWidgets(cell, table));\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getSelectedCellsNextWidgets = function (selectedCell, table) {\n        var cells = [];\n        if (selectedCell.nextWidget) {\n            cells.push(selectedCell.nextWidget);\n        }\n        if (selectedCell.cellFormat.rowSpan > 1) {\n            var nextRowIndex = selectedCell.ownerRow.rowIndex + selectedCell.cellFormat.rowSpan;\n            for (var i = selectedCell.ownerRow.rowIndex + 1; i < nextRowIndex; i++) {\n                var nextRow = table.childWidgets[i];\n                if (nextRow) {\n                    for (var j = 0; j < nextRow.childWidgets.length; j++) {\n                        if (nextRow.childWidgets[j].columnIndex ===\n                            selectedCell.nextWidget.columnIndex) {\n                            cells.push(nextRow.childWidgets[j]);\n                        }\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBorder = function (borderColor, lineWidth, borderStyle) {\n        var border = new WBorder();\n        border.color = borderColor || '#000000';\n        border.lineWidth = lineWidth || 1;\n        border.lineStyle = borderStyle || 'Single';\n        return border;\n    };\n    /**\n     * Applies borders\n     * @param  {WBorders} sourceBorders\n     * @param  {WBorders} applyBorders\n     * @private\n     */\n    Editor.prototype.applyBordersInternal = function (sourceBorders, applyBorders) {\n        if (!isNullOrUndefined(sourceBorders) && !isNullOrUndefined(sourceBorders)) {\n            if (!isNullOrUndefined(sourceBorders.top)) {\n                this.applyBorder(sourceBorders.top, applyBorders.top);\n            }\n            if (!isNullOrUndefined(sourceBorders.bottom)) {\n                this.applyBorder(sourceBorders.bottom, applyBorders.bottom);\n            }\n            if (!isNullOrUndefined(sourceBorders.left)) {\n                this.applyBorder(sourceBorders.left, applyBorders.left);\n            }\n            if (!isNullOrUndefined(sourceBorders.right)) {\n                this.applyBorder(sourceBorders.right, applyBorders.right);\n            }\n            if (!isNullOrUndefined(sourceBorders.horizontal)) {\n                this.applyBorder(sourceBorders.horizontal, applyBorders.horizontal);\n            }\n            if (!isNullOrUndefined(sourceBorders.vertical)) {\n                this.applyBorder(sourceBorders.vertical, applyBorders.vertical);\n            }\n            if (!isNullOrUndefined(sourceBorders.diagonalUp)) {\n                this.applyBorder(sourceBorders.diagonalUp, applyBorders.diagonalUp);\n            }\n            if (!isNullOrUndefined(sourceBorders.diagonalDown)) {\n                this.applyBorder(sourceBorders.diagonalDown, applyBorders.diagonalDown);\n            }\n        }\n    };\n    /**\n     * Apply shading to table\n     * @param  {WShading} sourceShading\n     * @param  {WShading} applyShading\n     * @private\n     */\n    Editor.prototype.applyShading = function (sourceShading, applyShading) {\n        if (!isNullOrUndefined(applyShading) && !isNullOrUndefined(sourceShading)) {\n            if (!isNullOrUndefined(applyShading.backgroundColor)\n                && sourceShading.backgroundColor !== applyShading.backgroundColor) {\n                sourceShading.backgroundColor = applyShading.backgroundColor;\n            }\n            if (!isNullOrUndefined(applyShading.foregroundColor)\n                && sourceShading.foregroundColor !== applyShading.foregroundColor) {\n                sourceShading.foregroundColor = applyShading.foregroundColor;\n            }\n            if (!isNullOrUndefined(applyShading.textureStyle)\n                && sourceShading.textureStyle !== applyShading.textureStyle) {\n                sourceShading.textureStyle = applyShading.textureStyle;\n            }\n        }\n    };\n    Editor.prototype.applyBorder = function (sourceBorder, applyBorder) {\n        if (!isNullOrUndefined(sourceBorder) && !isNullOrUndefined(applyBorder)) {\n            if (!isNullOrUndefined(applyBorder.color)\n                && sourceBorder.color !== applyBorder.color) {\n                sourceBorder.color = applyBorder.color;\n            }\n            if (!isNullOrUndefined(applyBorder.lineStyle)\n                && sourceBorder.lineStyle !== applyBorder.lineStyle) {\n                sourceBorder.lineStyle = applyBorder.lineStyle;\n            }\n            if (!isNullOrUndefined(applyBorder.lineWidth)\n                && sourceBorder.lineWidth !== applyBorder.lineWidth) {\n                sourceBorder.lineWidth = applyBorder.lineWidth;\n            }\n            if (!isNullOrUndefined(applyBorder.shadow)\n                && sourceBorder.shadow !== applyBorder.shadow) {\n                sourceBorder.shadow = applyBorder.shadow;\n            }\n            if (!isNullOrUndefined(applyBorder.space)\n                && sourceBorder.space !== applyBorder.space) {\n                sourceBorder.space = applyBorder.space;\n            }\n        }\n    };\n    /**\n     * Apply Table Format changes\n     * @param  {Selection} selection\n     * @param  {WTableFormat} format\n     * @private\n     */\n    Editor.prototype.onTableFormat = function (format) {\n        if (!isNullOrUndefined(this.selection.tableFormat)) {\n            this.viewer.owner.isShiftingEnabled = true;\n            this.editorHistory.initializeHistory('TableFormat');\n            var table = this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            this.applyTableFormat(table, undefined, format);\n            this.reLayout(this.selection, false);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyTableFormat = function (table, property, value) {\n        this.applyTablePropertyValue(this.viewer.selection, undefined, value, table);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyTablePropertyValue = function (selection, property, value, table) {\n        var sourceFormat = table.tableFormat;\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(sourceFormat, property, value);\n        }\n        if (value instanceof WTableFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleTableFormat(sourceFormat, value);\n            }\n            return;\n        }\n        if (property === 'preferredWidth') {\n            sourceFormat.preferredWidth = value;\n        }\n        else if (property === 'leftIndent') {\n            sourceFormat.leftIndent = value;\n        }\n        else if (property === 'tableAlignment') {\n            sourceFormat.tableAlignment = value;\n        }\n        else if (property === 'cellSpacing') {\n            sourceFormat.cellSpacing = value;\n        }\n        else if (property === 'leftMargin') {\n            sourceFormat.leftMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            sourceFormat.rightMargin = value;\n        }\n        else if (property === 'topMargin') {\n            sourceFormat.topMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            sourceFormat.bottomMargin = value;\n        }\n        else if (property === 'preferredWidthType') {\n            sourceFormat.preferredWidthType = value;\n        }\n        if (property === 'shading') {\n            sourceFormat.shading = value;\n        }\n        else if (property === 'borders') {\n            sourceFormat.borders = value;\n        }\n        // if (!isNullOrUndefined(table)) {\n        //     this.layoutItemBlock(table, true);\n        // }\n    };\n    Editor.prototype.handleTableFormat = function (tableFormat, applyFormat) {\n        if (this.isBordersAndShadingDialog || this.editorHistory.isUndoing\n            || this.editorHistory.isRedoing) {\n            if (!isNullOrUndefined(tableFormat.borders)) {\n                this.applyBordersInternal(tableFormat.borders, applyFormat.borders);\n            }\n            if (!isNullOrUndefined(tableFormat.shading)) {\n                this.applyShading(tableFormat.shading, applyFormat.shading);\n            }\n        }\n        if (!this.isBordersAndShadingDialog) {\n            if (applyFormat.hasValue('preferredWidth') && applyFormat.preferredWidth !== tableFormat.preferredWidth) {\n                tableFormat.preferredWidth = applyFormat.preferredWidth;\n            }\n            if (applyFormat.hasValue('preferredWidthType') && applyFormat.preferredWidthType !== tableFormat.preferredWidthType) {\n                tableFormat.preferredWidthType = applyFormat.preferredWidthType;\n            }\n            if (applyFormat.hasValue('tableAlignment') && applyFormat.tableAlignment !== tableFormat.tableAlignment) {\n                tableFormat.tableAlignment = applyFormat.tableAlignment;\n            }\n            if (applyFormat.hasValue('leftIndent') && applyFormat.leftIndent !== tableFormat.leftIndent) {\n                tableFormat.leftIndent = applyFormat.leftIndent;\n            }\n        }\n        this.updateGridForTableDialog(tableFormat.ownerBase, false);\n    };\n    Editor.prototype.updateGridForTableDialog = function (table, shiftNextItem) {\n        if (table.tableHolder) {\n            table.updateRowIndex(0);\n            table.calculateGrid();\n            table.isGridUpdated = false;\n        }\n        this.viewer.layout.reLayoutTable(table);\n    };\n    /**\n     * Applies Row Format Changes\n     * @param  {Selection} selection\n     * @param  {WRowFormat} format\n     * @param  {WRow} row\n     * @private\n     */\n    Editor.prototype.onRowFormat = function (format) {\n        if (isNullOrUndefined(this.selection) || isNullOrUndefined(format)) {\n            return;\n        }\n        this.editorHistory.initializeHistory('RowFormat');\n        this.viewer.owner.isShiftingEnabled = true;\n        var rowStartPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var rowEndPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var table = rowStartPos.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n        this.applyRowFormat(rowStartPos.paragraph.associatedCell.ownerRow, rowStartPos, rowEndPos, undefined, format);\n        this.reLayout(this.selection, false);\n    };\n    Editor.prototype.applyRowFormat = function (row, start, end, property, value) {\n        this.applyRowPropertyValue(this.viewer.selection, property, value, row);\n        if (end.paragraph.associatedCell.ownerRow === row) {\n            return;\n        }\n        var newRow = row.nextWidget;\n        if (!isNullOrUndefined(newRow)) {\n            this.applyRowFormat(newRow, start, end, property, value);\n        }\n    };\n    Editor.prototype.applyRowPropertyValue = function (selection, property, value, row) {\n        var applyFormat = row.rowFormat;\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(applyFormat, property, value);\n        }\n        if (value instanceof WRowFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleRowFormat(value, applyFormat);\n            }\n            return;\n        }\n        if (property === 'heightType') {\n            applyFormat.heightType = value;\n        }\n        else if (property === 'height') {\n            applyFormat.height = value;\n        }\n        else if (property === 'isHeader') {\n            applyFormat.isHeader = value;\n        }\n        else if (property === 'allowBreakAcrossPages') {\n            applyFormat.allowBreakAcrossPages = value;\n        }\n        if (!isNullOrUndefined(row.ownerTable)) {\n            this.layoutItemBlock(row.ownerTable, true);\n        }\n    };\n    Editor.prototype.handleRowFormat = function (format, applyFormat) {\n        if (format.hasValue('allowBreakAcrossPages') && format.allowBreakAcrossPages !== applyFormat.allowBreakAcrossPages) {\n            applyFormat.allowBreakAcrossPages = format.allowBreakAcrossPages;\n        }\n        if (format.hasValue('isHeader') && format.isHeader !== applyFormat.isHeader) {\n            applyFormat.isHeader = format.isHeader;\n        }\n        if (format.hasValue('heightType') && format.heightType !== applyFormat.heightType) {\n            applyFormat.heightType = format.heightType;\n        }\n        if (format.hasValue('height') && format.height !== applyFormat.height) {\n            applyFormat.height = format.height;\n        }\n        this.updateGridForTableDialog(applyFormat.ownerBase.ownerTable, true);\n    };\n    /**\n     * Applies Cell Format changes\n     * @param  {Selection} selection\n     * @param  {WCellFormat} format\n     * @param  {WCell} cell\n     * @private\n     */\n    Editor.prototype.onCellFormat = function (format) {\n        if (isNullOrUndefined(this.selection) || isNullOrUndefined(format)) {\n            return;\n        }\n        this.editorHistory.initializeHistory('CellFormat');\n        this.updateFormatForCell(this.selection, undefined, format);\n        this.reLayout(this.selection, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateCellMargins = function (selection, value) {\n        var cellStartPosition = selection.start;\n        var cellEndPosition = selection.end;\n        if (!selection.isForward) {\n            cellStartPosition = selection.end;\n            cellEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, cellStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.viewer.owner.cellOptionsDialogModule.applyCellmarginsValue(cellStartPosition.paragraph.associatedCell.ownerRow, cellStartPosition, cellEndPosition, value);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateFormatForCell = function (selection, property, value) {\n        var start = selection.start;\n        var end = selection.end;\n        if (!selection.isForward) {\n            start = selection.end;\n            end = selection.start;\n        }\n        var startCell = start.paragraph.associatedCell;\n        var endCell = end.paragraph.associatedCell;\n        var cells;\n        var table = startCell.ownerTable.combineWidget(this.viewer);\n        var appliedFormat;\n        for (var k = startCell.columnIndex; k <= endCell.columnIndex; k++) {\n            cells = this.getSelectedCellInColumn(startCell.ownerTable, startCell.ownerRow.rowIndex, k, endCell.ownerRow.rowIndex);\n            for (var i = 0; i < cells.length; i++) {\n                appliedFormat = this.applyCellPropertyValue(this.viewer.selection, property, value, cells[i].cellFormat);\n            }\n        }\n        this.updateGridForTableDialog(table, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getSelectedCellInColumn = function (table, rowStartIndex, columnIndex, rowEndIndex) {\n        var cells = [];\n        for (var i = rowStartIndex; i <= rowEndIndex; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                if (row.childWidgets[j].columnIndex === columnIndex) {\n                    cells.push(row.childWidgets[j]);\n                }\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getColumnCells = function (table, columnIndex, isLeftSideCollection) {\n        var cells = [];\n        for (var k = 0; k < table.childWidgets.length; k++) {\n            var row = table.childWidgets[k];\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                var cell = row.childWidgets[i];\n                if (isLeftSideCollection) {\n                    if (cell.columnIndex + cell.cellFormat.columnSpan === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n                else {\n                    if (cell.columnIndex === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getTableWidth = function (table) {\n        if (table.tableFormat.preferredWidth !== 0 || table.tableFormat.preferredWidthType === 'Percent') {\n            if (table.tableFormat.preferredWidthType === 'Auto' || table.tableFormat.preferredWidthType === 'Point') {\n                return table.tableFormat.preferredWidth;\n            }\n            else {\n                if (table.tableFormat.preferredWidth === 0) {\n                    return 0;\n                }\n                else {\n                    return HelperMethods.convertPixelToPoint(this.viewer.clientArea.width) / 100 * table.tableFormat.preferredWidth;\n                }\n            }\n        }\n        return HelperMethods.convertPixelToPoint(this.viewer.layout.getTableWidth(table));\n    };\n    Editor.prototype.applyCellPropertyValue = function (selection, property, value, applyFormat) {\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(applyFormat, property, value);\n        }\n        if (value instanceof WCellFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleCellFormat(value, applyFormat);\n            }\n            return value;\n        }\n        if (property === 'leftMargin') {\n            applyFormat.leftMargin = value;\n        }\n        else if (property === 'topMargin') {\n            applyFormat.topMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            applyFormat.rightMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            applyFormat.bottomMargin = value;\n        }\n        else if (property === 'preferredWidth') {\n            applyFormat.preferredWidth = value;\n            applyFormat.cellWidth = value;\n        }\n        else if (property === 'cellWidth') {\n            applyFormat.cellWidth = value;\n        }\n        else if (property === 'columnSpan') {\n            applyFormat.columnSpan = value;\n        }\n        else if (property === 'rowSpan') {\n            applyFormat.rowSpan = value;\n        }\n        else if (property === 'preferredWidthType') {\n            applyFormat.preferredWidthType = value;\n        }\n        else if (property === 'verticalAlignment') {\n            applyFormat.verticalAlignment = value;\n        }\n        if (property === 'shading') {\n            applyFormat.shading = value;\n        }\n        else if (property === 'borders') {\n            applyFormat.borders = value;\n        }\n        return undefined;\n    };\n    Editor.prototype.handleCellFormat = function (cellFormat, applyFormat) {\n        if (!isNullOrUndefined(cellFormat) && !isNullOrUndefined(applyFormat)) {\n            if (this.isBordersAndShadingDialog) {\n                if (!isNullOrUndefined(cellFormat.borders)) {\n                    this.applyBordersInternal(applyFormat.borders, cellFormat.borders);\n                }\n                if (!isNullOrUndefined(cellFormat.shading)) {\n                    this.applyShading(applyFormat.shading, cellFormat.shading);\n                }\n                // this.layoutRow((applyFormat.ownerBase as TableCellWidget).ownerRow, this.viewer, false);\n            }\n            else {\n                if (cellFormat.hasValue('preferredWidth') && applyFormat.preferredWidth !== cellFormat.preferredWidth) {\n                    applyFormat.preferredWidth = cellFormat.preferredWidth;\n                }\n                if (cellFormat.hasValue('preferredWidthType') && applyFormat.preferredWidthType !== cellFormat.preferredWidthType) {\n                    applyFormat.preferredWidthType = cellFormat.preferredWidthType;\n                }\n                if (cellFormat.hasValue('verticalAlignment') && applyFormat.verticalAlignment !== cellFormat.verticalAlignment) {\n                    applyFormat.verticalAlignment = cellFormat.verticalAlignment;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.destroy = function () {\n        this.viewer = undefined;\n        this.nodes = [];\n    };\n    Editor.prototype.isTocField = function (element) {\n        if (element instanceof FieldElementBox) {\n            var nextElement = element.nextNode;\n            if (element instanceof FieldElementBox && element.fieldType === 0 && nextElement instanceof TextElementBox\n                && nextElement.text.trim().toLowerCase().indexOf('toc') === 0) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Updates the table of contents.\n     * @private\n     */\n    Editor.prototype.updateToc = function (tocField) {\n        if (isNullOrUndefined(tocField)) {\n            tocField = this.selection.getTocFieldInternal();\n        }\n        if (!this.isTocField(tocField)) {\n            return;\n        }\n        // Decode field code to get parameters\n        var code = this.selection.getFieldCode(tocField);\n        if (code.toLocaleLowerCase().indexOf('toc') !== -1) {\n            this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(code, tocField)));\n        }\n    };\n    Editor.prototype.getTocSettings = function (code, tocField) {\n        var tocSettings = {};\n        tocSettings.includePageNumber = true;\n        tocSettings.rightAlign = true;\n        // Decode field code to get parameters\n        if (code.toLowerCase() === 'toc \\\\mergeformat') {\n            tocSettings.startLevel = 1;\n            tocSettings.endLevel = 3;\n        }\n        else {\n            var swtiches = code.split('\\\\');\n            for (var i = 0; i < swtiches.length; i++) {\n                var swtch = swtiches[i];\n                if (swtch.length === 0) {\n                    continue;\n                }\n                switch (swtch[0]) {\n                    case 'o':\n                        if (!isNullOrUndefined(swtch.match(/\\d+/g))) {\n                            var levels = swtch.match(/\\d+/g).map(Number);\n                            tocSettings.startLevel = levels[0];\n                            tocSettings.endLevel = levels[1];\n                        }\n                        else {\n                            tocSettings.startLevel = 1;\n                            tocSettings.endLevel = 9;\n                        }\n                        break;\n                    case 'h':\n                        tocSettings.includeHyperlink = true;\n                        break;\n                    case 'n':\n                        tocSettings.includePageNumber = false;\n                        break;\n                    case 'p':\n                        tocSettings.rightAlign = false;\n                        break;\n                    case 'u':\n                        tocSettings.includeOutlineLevels = true;\n                        break;\n                    case 't':\n                        this.decodeTSwitch(tocSettings, swtch);\n                        break;\n                }\n            }\n        }\n        //assigns tab leader.\n        var tabs = tocField.paragraph.paragraphFormat.getUpdatedTabs();\n        if (tabs.length > 0) {\n            tocSettings.tabLeader = tabs[tabs.length - 1].tabLeader;\n        }\n        if (tocSettings.rightAlign && isNullOrUndefined(tocSettings.tabLeader)) {\n            tocSettings.tabLeader = 'Dot';\n        }\n        return tocSettings;\n    };\n    Editor.prototype.decodeTSwitch = function (tocSettings, tSwitch) {\n        tocSettings.levelSettings = {};\n        tSwitch = tSwitch.replace('t', '');\n        tSwitch = tSwitch.replace('\"', '');\n        tSwitch = tSwitch.replace('\"', '');\n        tSwitch = tSwitch.trim();\n        var levels = tSwitch.split(',');\n        for (var index = 0; index < levels.length; index++) {\n            tocSettings.levelSettings[levels[index]] = parseInt(levels[index + 1], 10);\n            index++;\n        }\n    };\n    /**\n     * Inserts, modifies or updates the table of contents based on given settings.\n     * @param {TableOfContentsSettings} tableOfContentsSettings\n     */\n    Editor.prototype.insertTableOfContents = function (tableOfContentsSettings) {\n        this.isInsertingTOC = true;\n        this.initComplexHistory('TOC');\n        if (isNullOrUndefined(tableOfContentsSettings)) {\n            //Initializes with default value.\n            tableOfContentsSettings = {};\n            tableOfContentsSettings.startLevel = 1;\n            tableOfContentsSettings.endLevel = 3;\n            tableOfContentsSettings.includeHyperlink = true;\n            tableOfContentsSettings.includeOutlineLevels = true;\n            tableOfContentsSettings.includePageNumber = true;\n            tableOfContentsSettings.rightAlign = true;\n            tableOfContentsSettings.tabLeader = 'Dot';\n        }\n        var tocField = undefined;\n        var code = undefined;\n        if (this.selection.contextType === 'TableOfContents') {\n            tocField = this.selection.getTocFieldInternal();\n        }\n        if (tocField instanceof FieldElementBox) {\n            this.selection.start.setPositionForSelection(tocField.line, tocField, 0, this.selection.start.location);\n            this.selection.end.setPositionForSelection(tocField.fieldEnd.line, tocField.fieldEnd, 2, this.selection.end.location);\n            this.onDelete();\n        }\n        // Build TOC field code based on parameter\n        code = this.constructTocFieldCode(tableOfContentsSettings);\n        var isStartParagraph = this.selection.start.isAtParagraphStart;\n        var blockInfo = this.getParagraphInfo(this.selection.start);\n        var initialStart = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        // Build TOC fields\n        // tslint:disable-next-line:max-line-length\n        var widgets = this.buildToc(this.validateTocSettings(tableOfContentsSettings), code, true, isStartParagraph);\n        if (widgets.length > 0) {\n            var tocLastPara = new ParagraphWidget();\n            var tocLastLine = new LineWidget(tocLastPara);\n            tocLastPara.childWidgets.push(tocLastLine);\n            var index = 0;\n            if (!isStartParagraph) {\n                index = 1;\n            }\n            var line = widgets[index].childWidgets[0];\n            var fieldBegin = line.children[0];\n            this.appendEndField(fieldBegin, tocLastLine);\n            widgets.push(tocLastPara);\n            this.appendEmptyPara(widgets);\n        }\n        this.setPositionForCurrentIndex(this.selection.start, initialStart);\n        this.selection.end.setPositionInternal(this.selection.start);\n        this.pasteContentsInternal(widgets);\n        this.isInsertingTOC = false;\n        this.updatePageRef();\n        if (this.editorHistory) {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n    };\n    Editor.prototype.appendEmptyPara = function (widgets) {\n        var emptyPara = new ParagraphWidget();\n        var emptyLine = new LineWidget(emptyPara);\n        emptyPara.childWidgets.push(emptyLine);\n        widgets.push(emptyPara);\n    };\n    Editor.prototype.constructTocFieldCode = function (tocSettings) {\n        var tocFieldCode = 'TOC';\n        //appends styles level\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(tocSettings.startLevel) && tocSettings.startLevel !== 0 && !isNullOrUndefined(tocSettings.endLevel) && tocSettings.endLevel !== 0) {\n            tocFieldCode = tocFieldCode + ' \\\\o \"' + tocSettings.startLevel + '-' + tocSettings.endLevel + '\"';\n        }\n        if (tocSettings.includePageNumber && !tocSettings.rightAlign) {\n            tocFieldCode = tocFieldCode + ' \\\\p \" \"';\n        }\n        if (!tocSettings.includePageNumber) {\n            tocFieldCode = tocFieldCode + ' \\\\n';\n        }\n        if (tocSettings.includeHyperlink) {\n            tocFieldCode = tocFieldCode + ' \\\\h \\\\z';\n        }\n        if (tocSettings.includeOutlineLevels) {\n            tocFieldCode = tocFieldCode + ' \\\\u';\n        }\n        var tSwitch = this.constructTSwitch(tocSettings);\n        if (tSwitch.length > 6) {\n            tocFieldCode = tocFieldCode + tSwitch;\n        }\n        return tocFieldCode;\n    };\n    Editor.prototype.constructTSwitch = function (tocSettings) {\n        var tSwitch = '';\n        var prefix = ' \\\\t ';\n        if (!isNullOrUndefined(tocSettings.levelSettings)) {\n            for (var _i = 0, _a = Object.keys(tocSettings.levelSettings); _i < _a.length; _i++) {\n                var key = _a[_i];\n                tSwitch = tSwitch + key + ',' + tocSettings.levelSettings[key].toString() + ',';\n            }\n        }\n        tSwitch = tSwitch.slice(0, -1);\n        tSwitch = prefix + '\"' + tSwitch + '\"';\n        return tSwitch;\n    };\n    /**\n     * Appends the end filed to the given line.\n     */\n    Editor.prototype.appendEndField = function (fieldBegin, lineWidget) {\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldSeparator = fieldBegin.fieldSeparator;\n        fieldBegin.fieldSeparator.fieldEnd = fieldEnd;\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldEnd.fieldBegin.fieldEnd = fieldEnd;\n        fieldEnd.line = lineWidget;\n        lineWidget.children.push(fieldEnd);\n    };\n    Editor.prototype.validateTocSettings = function (tocSettings) {\n        if (isNullOrUndefined(tocSettings.startLevel) || tocSettings.startLevel < 1) {\n            tocSettings.startLevel = 1;\n        }\n        if (isNullOrUndefined(tocSettings.endLevel) || tocSettings.endLevel < tocSettings.endLevel) {\n            tocSettings.endLevel = tocSettings.startLevel > 3 ? tocSettings.startLevel : 3;\n        }\n        if (isNullOrUndefined(tocSettings.includeHyperlink)) {\n            tocSettings.includeHyperlink = false;\n        }\n        if (isNullOrUndefined(tocSettings.includePageNumber)) {\n            tocSettings.includePageNumber = false;\n        }\n        if (isNullOrUndefined(tocSettings.rightAlign)) {\n            tocSettings.rightAlign = false;\n        }\n        if (isNullOrUndefined(tocSettings.levelSettings)) {\n            tocSettings.levelSettings = {};\n        }\n        return tocSettings;\n    };\n    /**\n     * Builds the TOC\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.buildToc = function (tocSettings, fieldCode, isFirstPara, isStartParagraph) {\n        var tocDomBody = this.viewer.pages[0].bodyWidgets[0];\n        var widgets = [];\n        this.createHeadingLevels(tocSettings);\n        if (tocSettings.includeOutlineLevels) {\n            this.createOutlineLevels(tocSettings);\n        }\n        var widget = tocDomBody.childWidgets[0];\n        while (widget !== undefined) {\n            // tslint:disable-next-line:max-line-length\n            if (widget instanceof ParagraphWidget && (this.isHeadingStyle(widget) || (tocSettings.includeOutlineLevels && this.isOutlineLevelStyle(widget)))) {\n                var bookmarkName = this.insertTocBookmark(widget);\n                // tslint:disable-next-line:max-line-length\n                this.createTOCWidgets(widget, widgets, fieldCode, bookmarkName, tocSettings, isFirstPara, isStartParagraph);\n                isFirstPara = false;\n            }\n            widget = this.selection.getNextParagraphBlock(widget);\n        }\n        this.tocStyles = {};\n        return widgets;\n    };\n    Editor.prototype.createOutlineLevels = function (settings) {\n        for (var i = settings.startLevel; i <= settings.endLevel; i++) {\n            var levelStyle = 'Level' + i.toString();\n            if (isNullOrUndefined(this.tocStyles[levelStyle])) {\n                this.tocStyles[levelStyle] = i;\n            }\n        }\n    };\n    /**\n     * Creates TOC heading styles\n     * @param start - lower heading level\n     * @param end - higher heading level\n     */\n    Editor.prototype.createHeadingLevels = function (settings) {\n        var normalStyle = 'Normal';\n        for (var i = settings.startLevel; i <= settings.endLevel; i++) {\n            var headingStyle = 'Heading ' + i.toString();\n            if (isNullOrUndefined(this.tocStyles[headingStyle])) {\n                this.tocStyles[headingStyle] = i;\n            }\n        }\n        if (!isNullOrUndefined(settings.levelSettings)) {\n            for (var _i = 0, _a = Object.keys(settings.levelSettings); _i < _a.length; _i++) {\n                var key = _a[_i];\n                this.tocStyles[key] = settings.levelSettings[key];\n            }\n        }\n    };\n    /**\n     * Checks the current style is heading style.\n     */\n    Editor.prototype.isHeadingStyle = function (para) {\n        var style = para.paragraphFormat.baseStyle;\n        if (style !== undefined) {\n            return isNullOrUndefined(this.tocStyles[style.name]) ? false : true;\n        }\n        return false;\n    };\n    Editor.prototype.isOutlineLevelStyle = function (para) {\n        var styleName = para.paragraphFormat.outlineLevel;\n        return isNullOrUndefined(this.tocStyles[styleName]) ? false : true;\n    };\n    /**\n     * Creates TOC field element.\n     */\n    Editor.prototype.createTocFieldElement = function (lineWidget, fieldCode) {\n        //begin\n        var fieldBegin = new FieldElementBox(0);\n        fieldBegin.hasFieldEnd = true;\n        fieldBegin.line = lineWidget;\n        lineWidget.children.push(fieldBegin);\n        //format toc\n        var textElement = new TextElementBox();\n        textElement.text = fieldCode;\n        textElement.line = lineWidget;\n        lineWidget.children.push(textElement);\n        //field separator\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldSeparator.fieldBegin.fieldSeparator = fieldSeparator;\n        fieldSeparator.line = lineWidget;\n        lineWidget.children.push(fieldSeparator);\n        return fieldBegin;\n    };\n    /**\n     * Updates TOC para\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.createTOCWidgets = function (widget, widgets, fieldCode, bookmarkName, tocSettings, isFirstPara, isStartParagraph) {\n        var fieldBegin = undefined;\n        var tocPara = undefined;\n        var tocLine = undefined;\n        // tslint:disable-next-line:max-line-length\n        if (widgets.length === 1 && widgets[0].childWidgets[0].children.length === 3 && !isNullOrUndefined(isFirstPara) && !isFirstPara) {\n            tocLine = widgets[0].childWidgets[0];\n        }\n        else {\n            tocPara = new ParagraphWidget();\n            var styleName = undefined;\n            //Adds toc syles into paragraph\n            var headingStyleName = widget.paragraphFormat.baseStyle.name;\n            if (tocSettings.includeOutlineLevels && isNullOrUndefined(this.tocStyles[headingStyleName])) {\n                styleName = widget.paragraphFormat.outlineLevel;\n            }\n            else {\n                styleName = headingStyleName;\n            }\n            var tocStyleName = 'Toc' + this.tocStyles[styleName];\n            var paraStyle = this.viewer.styles.findByName(tocStyleName, 'Paragraph');\n            if (isNullOrUndefined(paraStyle)) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), JSON.parse(this.viewer.preDefinedStyles.get(tocStyleName)), this.viewer.styles);\n                paraStyle = this.viewer.styles.findByName(tocStyleName, 'Paragraph');\n            }\n            tocPara.paragraphFormat.ApplyStyle(paraStyle);\n            //Creates right tab for page number.\n            if (tocSettings.rightAlign && tocSettings.includePageNumber) {\n                var tabStop = new WTabStop();\n                tabStop.position = HelperMethods.convertPixelToPoint(this.viewer.clientArea.width);\n                tabStop.tabLeader = tocSettings.tabLeader;\n                tabStop.deletePosition = 0;\n                tabStop.tabJustification = 'Right';\n                tocPara.paragraphFormat.tabs.push(tabStop);\n            }\n            tocLine = new LineWidget(tocPara);\n            tocPara.childWidgets.push(tocLine);\n        }\n        //creates toc field element if it is insert\n        if ((isFirstPara !== undefined) && isFirstPara) {\n            if (!isNullOrUndefined(isStartParagraph) && !isStartParagraph) {\n                this.appendEmptyPara(widgets);\n            }\n            this.createTocFieldElement(tocLine, fieldCode);\n        }\n        var text = '';\n        for (var lineIndex = 0; lineIndex < widget.childWidgets.length; lineIndex++) {\n            var lineWidget = widget.childWidgets[lineIndex];\n            for (var elementIndex = 0; elementIndex < lineWidget.children.length; elementIndex++) {\n                var element = lineWidget.children[elementIndex];\n                if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n                    var temp = element.text;\n                    var tabChar = '\\t';\n                    if (temp.indexOf(tabChar) !== -1) {\n                        temp = temp.replace(new RegExp(tabChar, 'g'), ' ');\n                    }\n                    text = text + temp;\n                }\n            }\n        }\n        if (text !== '') {\n            // inserts hyperlink\n            if (tocSettings.includeHyperlink && (bookmarkName !== undefined)) {\n                fieldBegin = this.insertTocHyperlink(tocLine, bookmarkName, text);\n            }\n            else {\n                var span = new TextElementBox();\n                span.text = text;\n                span.line = tocLine;\n                tocLine.children.push(span);\n            }\n            //inserts page number\n            if (tocSettings.includePageNumber && (bookmarkName !== undefined)) {\n                if (tocSettings.rightAlign) {\n                    var tabText = new TabElementBox();\n                    tabText.text = '\\t';\n                    tabText.line = tocLine;\n                    tocLine.children.push(tabText);\n                }\n                var pageField = this.insertTocPageNumber(bookmarkName, tocLine, tocSettings.rightAlign, widget);\n                this.appendEndField(pageField, tocLine);\n            }\n            if (tocSettings.includeHyperlink && fieldBegin !== undefined) {\n                this.appendEndField(fieldBegin, tocLine);\n            }\n        }\n        if (!isNullOrUndefined(tocPara) && (text !== '' || isFirstPara)) {\n            widgets.push(tocPara);\n        }\n    };\n    /**\n     * Inserts toc hyperlink.\n     */\n    Editor.prototype.insertTocHyperlink = function (lineWidget, bookmarkName, text) {\n        var fieldCode = ' HYPERLINK \\\\l \\\"' + bookmarkName + '\\\" ';\n        var fieldBegin = this.createTocFieldElement(lineWidget, fieldCode);\n        //text element.\n        var span = new TextElementBox();\n        span.text = text;\n        span.line = lineWidget;\n        lineWidget.children.push(span);\n        return fieldBegin;\n    };\n    /**\n     * Inserts toc page number.\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertTocPageNumber = function (bookMarkname, lineWidget, isRightAlign, widget) {\n        var fieldCode = ' PAGEREF' + bookMarkname + ' \\\\h ';\n        var fieldBegin = this.createTocFieldElement(lineWidget, fieldCode);\n        var text = (this.viewer.pages.indexOf(widget.bodyWidget.page) + 1).toString();\n        //text element.\n        var span = new FieldTextElementBox();\n        span.fieldBegin = fieldBegin;\n        if (!isRightAlign) {\n            text = ' ' + text;\n        }\n        span.text = text;\n        span.line = lineWidget;\n        lineWidget.children.push(span);\n        this.pageRefFields[bookMarkname] = span;\n        return fieldBegin;\n    };\n    Editor.prototype.updatePageRef = function () {\n        for (var _i = 0, _a = Object.keys(this.pageRefFields); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var bookmark = this.viewer.bookmarks.get(key);\n            var pageRef = (bookmark.paragraph.bodyWidget.page.index + 1).toString();\n            var span = this.pageRefFields[key];\n            if (pageRef !== span.text) {\n                span.text = pageRef;\n                var paragraph = span.paragraph;\n                var lineIndex = paragraph.childWidgets.indexOf(span.line);\n                var elementIndex = span.line.children.indexOf(span);\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n            }\n        }\n    };\n    /**\n     * Inserts toc bookmark.\n     */\n    Editor.prototype.insertTocBookmark = function (widget) {\n        var bookmarkName = undefined;\n        var lineLength = widget.childWidgets.length;\n        if (lineLength > 0) {\n            var startLine = widget.childWidgets[0];\n            var endLine = widget.childWidgets[lineLength - 1];\n            if ((startLine !== undefined) && (endLine !== undefined)) {\n                var startElement = startLine.children[0];\n                //Returns the bookmark if already present for paragraph.\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(startElement) && startElement instanceof BookmarkElementBox && startElement.bookmarkType === 0 && (startElement.name.toLowerCase().match('^_toc'))) {\n                    return startElement.name;\n                }\n                var endElement = endLine.children[endLine.children.length - 1];\n                if ((startElement !== undefined) && (endElement !== undefined)) {\n                    this.selection.start.setPositionForSelection(startLine, startElement, 0, this.selection.start.location);\n                    this.selection.end.setPositionForSelection(endLine, endElement, endElement.length, this.selection.end.location);\n                    bookmarkName = this.generateBookmarkName();\n                    this.insertBookmark(bookmarkName);\n                }\n            }\n        }\n        return bookmarkName;\n    };\n    /**\n     * Generates bookmark id.\n     */\n    Editor.prototype.generateBookmarkName = function () {\n        this.tocBookmarkId++;\n        var count = 10 - this.tocBookmarkId.toString().length;\n        var formatString = '';\n        while (count - 1 > 0) {\n            formatString = '0' + formatString;\n            count--;\n        }\n        var bookmarkName = '_Toc' + formatString + this.tocBookmarkId;\n        return bookmarkName;\n    };\n    /**\n     * Change cell content alignment\n     * @private\n     */\n    Editor.prototype.onCellContentAlignment = function (verticalAlignment, textAlignment) {\n        this.owner.isShiftingEnabled = true;\n        var selection = this.owner.selection;\n        if (selection.isEmpty && selection.start.paragraph.isInsideTable) {\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.initComplexHistory(selection, 'MultiSelection');\n            }\n            //Selecting the table cell to update the all the paragraph format.\n            selection.selectTableCell();\n            this.initHistory('CellContentVerticalAlignment');\n            var cellFormat = selection.start.paragraph.associatedCell.cellFormat;\n            this.applyCellPropertyValue(selection, 'verticalAlignment', verticalAlignment, cellFormat);\n            this.reLayout(selection, false);\n            this.initHistory('TextAlignment');\n            this.updateParagraphFormat('textAlignment', textAlignment, false);\n            this.reLayout(this.owner.selection, false);\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.updateComplexHistory();\n            }\n        }\n        else {\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.initComplexHistory(selection, 'MultiSelection');\n            }\n            if (!isNullOrUndefined(selection.getTable(selection.start, selection.end))) {\n                //Table cell vertical alignment.\n                this.updateSelectionTableFormat(selection, 'CellContentVerticalAlignment', verticalAlignment);\n                this.reLayout(this.owner.selection, false);\n                this.initHistory('TextAlignment');\n                //Paragraph text alignment.\n                this.updateSelectionParagraphFormatting('textAlignment', textAlignment, false);\n                this.reLayout(selection, false);\n            }\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.updateComplexHistory();\n            }\n        }\n    };\n    return Editor;\n}());\nexport { Editor };\n","import { WTableHolder } from '../viewer/page';\n/**\n * @private\n */\nvar ModifiedLevel = /** @class */ (function () {\n    function ModifiedLevel(owner, modified) {\n        this.ownerListLevelIn = undefined;\n        this.modifiedListLevelIn = undefined;\n        this.ownerListLevel = owner;\n        this.modifiedListLevel = modified;\n    }\n    Object.defineProperty(ModifiedLevel.prototype, \"ownerListLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerListLevelIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.ownerListLevelIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ModifiedLevel.prototype, \"modifiedListLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.modifiedListLevelIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.modifiedListLevelIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ModifiedLevel.prototype.destroy = function () {\n        this.ownerListLevel = undefined;\n        this.modifiedListLevel = undefined;\n    };\n    return ModifiedLevel;\n}());\nexport { ModifiedLevel };\n/**\n * @private\n */\nvar ModifiedParagraphFormat = /** @class */ (function () {\n    function ModifiedParagraphFormat(ownerFormat, modifiedFormat) {\n        this.ownerFormatIn = undefined;\n        this.modifiedFormatIn = undefined;\n        this.ownerFormat = ownerFormat;\n        this.modifiedFormat = modifiedFormat;\n    }\n    Object.defineProperty(ModifiedParagraphFormat.prototype, \"ownerFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.ownerFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ModifiedParagraphFormat.prototype, \"modifiedFormat\", {\n        /**\n         * hidden\n         */\n        get: function () {\n            return this.modifiedFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.modifiedFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ModifiedParagraphFormat.prototype.destroy = function () {\n        this.ownerFormat = undefined;\n        this.modifiedFormat.destroy();\n        this.modifiedFormat = undefined;\n    };\n    return ModifiedParagraphFormat;\n}());\nexport { ModifiedParagraphFormat };\n/**\n * @private\n */\nvar RowHistoryFormat = /** @class */ (function () {\n    function RowHistoryFormat(startingPoint, rowFormat) {\n        this.startingPoint = startingPoint;\n        this.rowFormat = rowFormat;\n        this.rowHeightType = rowFormat.heightType;\n    }\n    RowHistoryFormat.prototype.revertChanges = function (isRedo, owner) {\n        //backup current format values.\n        var currentRowHeightType = this.rowFormat.heightType;\n        //Restore old values.\n        owner.editorModule.tableResize.updateRowHeight(this.rowFormat.ownerBase, isRedo ? this.displacement : (-this.displacement));\n        owner.viewer.layout.reLayoutTable(this.rowFormat.ownerBase.ownerTable);\n        if (this.rowFormat.heightType !== this.rowHeightType) {\n            this.rowFormat.heightType = this.rowHeightType;\n        }\n        //backup the current format values for redo.\n        this.rowHeightType = currentRowHeightType;\n    };\n    return RowHistoryFormat;\n}());\nexport { RowHistoryFormat };\n/**\n * @private\n */\nvar TableHistoryInfo = /** @class */ (function () {\n    function TableHistoryInfo(table, owner) {\n        this.tableHolder = new WTableHolder();\n        this.tableFormat = new TableFormatHistoryInfo();\n        this.rows = [];\n        this.owner = owner;\n        this.copyProperties(table);\n    }\n    TableHistoryInfo.prototype.copyProperties = function (table) {\n        if (table.tableHolder) {\n            this.tableHolder = table.tableHolder.clone();\n        }\n        if (table.tableFormat) {\n            this.tableFormat.leftIndent = table.tableFormat.leftIndent;\n            this.tableFormat.preferredWidth = table.tableFormat.preferredWidth;\n            this.tableFormat.preferredWidthType = table.tableFormat.preferredWidthType;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowFormat = new RowFormatHistoryInfo();\n            rowFormat.gridBefore = row.rowFormat.gridBefore;\n            rowFormat.gridBeforeWidth = row.rowFormat.gridBeforeWidth;\n            rowFormat.gridBeforeWidthType = row.rowFormat.gridBeforeWidthType;\n            rowFormat.gridAfter = row.rowFormat.gridAfter;\n            rowFormat.gridAfterWidth = row.rowFormat.gridAfterWidth;\n            rowFormat.gridAfterWidthType = row.rowFormat.gridAfterWidthType;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellFormat = new CellFormatHistoryInfo();\n                cellFormat.columnIndex = cell.columnIndex;\n                cellFormat.columnSpan = cell.cellFormat.columnSpan;\n                cellFormat.preferredWidth = cell.cellFormat.preferredWidth;\n                cellFormat.preferredWidthType = cell.cellFormat.preferredWidthType;\n                rowFormat.cells.push(cellFormat);\n            }\n            this.rows.push(rowFormat);\n        }\n        this.tableHierarchicalIndex = this.owner.editorModule.getHierarchicalIndex(table, '0');\n    };\n    TableHistoryInfo.prototype.destroy = function () {\n        this.tableHierarchicalIndex = undefined;\n        if (this.tableHolder) {\n            this.tableHolder.destroy();\n            this.tableHolder = undefined;\n        }\n        if (this.tableFormat) {\n            this.tableFormat = null;\n        }\n        if (this.rows) {\n            this.rows = [];\n            this.rows = undefined;\n        }\n    };\n    return TableHistoryInfo;\n}());\nexport { TableHistoryInfo };\n/**\n * @private\n */\nvar TableFormatHistoryInfo = /** @class */ (function () {\n    function TableFormatHistoryInfo() {\n        /* tslint:disable:no-empty */\n    }\n    return TableFormatHistoryInfo;\n}());\nexport { TableFormatHistoryInfo };\n/**\n * @private\n */\nvar RowFormatHistoryInfo = /** @class */ (function () {\n    function RowFormatHistoryInfo() {\n        this.cells = [];\n    }\n    return RowFormatHistoryInfo;\n}());\nexport { RowFormatHistoryInfo };\n/**\n * @private\n */\nvar CellFormatHistoryInfo = /** @class */ (function () {\n    function CellFormatHistoryInfo() {\n        /* tslint:disable:no-empty */\n    }\n    return CellFormatHistoryInfo;\n}());\nexport { CellFormatHistoryInfo };\n/**\n * @private\n */\nvar CellHistoryFormat = /** @class */ (function () {\n    function CellHistoryFormat(point) {\n        this.startingPoint = point; // starting point preserved to calculate the displacement on after cell resizing finished.\n    }\n    return CellHistoryFormat;\n}());\nexport { CellHistoryFormat };\n","import { WParagraphFormat } from '../format/paragraph-format';\nimport { WSectionFormat } from '../format/section-format';\nimport { WCharacterFormat } from '../format/character-format';\nimport { WListFormat } from '../format/list-format';\nimport { ModifiedLevel, RowHistoryFormat, TableHistoryInfo } from './history-helper';\nimport { BlockWidget, ParagraphWidget, BodyWidget, TableCellWidget, TableWidget, TableRowWidget, HeaderFooterWidget } from '../viewer/page';\nimport { Dictionary } from '../../base/dictionary';\nimport { TextPosition, ImageFormat } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ElementBox } from '../viewer/page';\nimport { WTableFormat, WRowFormat, WCellFormat, WParagraphStyle } from '../format/index';\n/**\n * @private\n */\nvar BaseHistoryInfo = /** @class */ (function () {\n    function BaseHistoryInfo(node) {\n        this.ownerIn = node;\n        this.viewer = node.viewer;\n        this.modifiedPropertiesIn = [];\n        this.modifiedNodeLength = [];\n        this.removedNodesIn = [];\n    }\n    Object.defineProperty(BaseHistoryInfo.prototype, \"owner\", {\n        //Properties\n        //gets owner control\n        /**\n         * gets the owner control\n         * @private\n         */\n        get: function () { return this.ownerIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"editorHistory\", {\n        /**\n         * gets or sets action\n         * @private\n         */\n        get: function () {\n            return this.owner.editorHistory;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"action\", {\n        /**\n         * gets or sets action\n         * @private\n         */\n        get: function () { return this.actionIn; },\n        set: function (value) { this.actionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"modifiedProperties\", {\n        /**\n         * gets modified properties\n         * @returns Object\n         * @private\n         */\n        get: function () { return this.modifiedPropertiesIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"removedNodes\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.removedNodesIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"selectionStart\", {\n        /**\n         * Gets or Sets the selection start\n         * @private\n         */\n        //gets or sets selection start\n        get: function () { return this.selectionStartIn; },\n        set: function (value) { this.selectionStartIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"selectionEnd\", {\n        /**\n         * Gets or Sets the selection end\n         * @private\n         */\n        get: function () { return this.selectionEndIn; },\n        set: function (value) { this.selectionEndIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"insertPosition\", {\n        /**\n         * Gets or sets the insert position\n         * @private\n         */\n        get: function () { return this.insertPositionIn; },\n        set: function (value) { this.insertPositionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"endPosition\", {\n        /**\n         * Gets or sets end position\n         * @private\n         */\n        get: function () { return this.endPositionIn; },\n        set: function (value) { this.endPositionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Update the selection\n     * @param selection\n     * @private\n     */\n    BaseHistoryInfo.prototype.updateSelection = function () {\n        var blockInfo = this.owner.editorModule.getParagraphInfo(this.owner.selection.start);\n        this.selectionStart = this.owner.editorModule.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        blockInfo = this.owner.editorModule.getParagraphInfo(this.owner.selection.end);\n        this.selectionEnd = this.owner.editorModule.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n    };\n    BaseHistoryInfo.prototype.setBookmarkInfo = function (bookmark) {\n        this.removedNodes.push({ 'bookmark': bookmark, 'startIndex': bookmark.indexInOwner, 'endIndex': bookmark.reference.indexInOwner });\n    };\n    BaseHistoryInfo.prototype.revertBookmark = function () {\n        var bookmarkInfo = this.removedNodes[0];\n        var bookmark = bookmarkInfo.bookmark;\n        if (this.editorHistory.isUndoing) {\n            this.viewer.bookmarks.add(bookmark.name, bookmark);\n            bookmark.line.children.splice(bookmarkInfo.startIndex, 0, bookmark);\n            bookmark.reference.line.children.splice(bookmarkInfo.endIndex, 0, bookmark.reference);\n            this.editorHistory.recordChanges(this);\n        }\n        else {\n            this.owner.editorModule.deleteBookmarkInternal(bookmark);\n            this.editorHistory.undoStack.push(this);\n        }\n    };\n    /**\n     * Reverts this instance\n     * @private\n     */\n    // tslint:disable: max-func-body-length\n    BaseHistoryInfo.prototype.revert = function () {\n        if (this.action === 'DeleteBookmark') {\n            this.revertBookmark();\n            return;\n        }\n        this.owner.isShiftingEnabled = true;\n        var selectionStartTextPosition = undefined;\n        var selectionEndTextPosition = undefined;\n        var start = this.selectionStart;\n        var end = this.selectionEnd;\n        var isForwardSelection = TextPosition.isForwardSelection(start, end);\n        if (this.modifiedProperties.length > 0 || this.action === 'Selection' || this.action === 'ClearCharacterFormat'\n            || this.action === 'ClearParagraphFormat') {\n            selectionStartTextPosition = this.getTextPosition(start);\n            selectionEndTextPosition = this.getTextPosition(end);\n            this.revertModifiedProperties(selectionStartTextPosition, selectionEndTextPosition);\n        }\n        else {\n            var deletedNodes = this.removedNodes;\n            this.removedNodesIn = [];\n            var isForward = TextPosition.isForwardSelection(this.insertPosition, this.endPosition);\n            var insertTextPosition = this.getTextPosition(isForward ? this.insertPosition : this.endPosition);\n            var endTextPosition = this.getTextPosition(isForward ? this.endPosition : this.insertPosition);\n            if (insertTextPosition.isAtSamePosition(endTextPosition)) {\n                this.owner.selection.selectContent(insertTextPosition, true);\n            }\n            else {\n                this.owner.selection.selectPosition(insertTextPosition, endTextPosition);\n            }\n            if (this.action === 'InsertHyperlink' && this.editorHistory.isRedoing) {\n                var fieldBegin = this.owner.selection.getHyperlinkField();\n                if (!isNullOrUndefined(fieldBegin)) {\n                    var offset = (fieldBegin.line).getOffset(fieldBegin, 0);\n                    insertTextPosition.setPositionParagraph(fieldBegin.line, offset);\n                    this.owner.selection.start.setPositionInternal(insertTextPosition);\n                    offset = fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, 1);\n                    endTextPosition.setPositionParagraph(fieldBegin.fieldEnd.line, offset);\n                }\n            }\n            this.editorHistory.currentBaseHistoryInfo = this;\n            this.selectionStart = this.insertPosition;\n            this.insertPosition = undefined;\n            this.selectionEnd = this.endPosition;\n            this.endPosition = undefined;\n            var isRemoveContent = false;\n            if (!insertTextPosition.isAtSamePosition(endTextPosition)) {\n                isRemoveContent = this.action === 'BackSpace' || this.action === 'Delete' || this.action === 'ClearCells'\n                    || this.action === 'DeleteCells';\n                if (!(isRemoveContent) && this.action !== 'MergeCells' && this.action !== 'InsertRowAbove'\n                    && this.action !== 'InsertRowBelow' && this.action !== 'InsertColumnLeft'\n                    && this.action !== 'InsertColumnRight' && this.action !== 'Borders'\n                    && this.action !== 'DeleteTable' && this.action !== 'DeleteColumn' && this.action !== 'DeleteRow') {\n                    this.owner.selection.end.setPositionInternal(endTextPosition);\n                    if (!this.owner.selection.isEmpty) {\n                        if (this.editorHistory.isRedoing) {\n                            this.owner.editorModule.removeSelectedContents(this.owner.selection);\n                        }\n                        else {\n                            this.owner.editorModule.deleteSelectedContents(this.owner.selection, true);\n                        }\n                        if (!isNullOrUndefined(this.editorHistory.currentHistoryInfo) &&\n                            this.editorHistory.currentHistoryInfo.action === 'PageBreak' && this.viewer.blockToShift) {\n                            this.viewer.layout.shiftLayoutedItems();\n                        }\n                    }\n                }\n            }\n            var isRedoAction = this.editorHistory.isRedoing && !isRemoveContent;\n            this.revertModifiedNodes(deletedNodes, isRedoAction, isForwardSelection ? start : end, start === end);\n            if (isRemoveContent) {\n                this.removeContent(insertTextPosition, endTextPosition);\n            }\n            //this.owner.editorModule.reLayout(this.viewer.selection);\n        }\n        var isSelectionChanged = false;\n        if ((this.editorHistory.isUndoing && isNullOrUndefined(this.editorHistory.currentHistoryInfo)) ||\n            ((this.action === 'InsertRowAbove' || this.action === 'Borders' || this.action === 'InsertRowBelow'\n                || this.action === 'InsertColumnLeft'\n                || this.action === 'InsertColumnRight') && (this.editorHistory.isRedoing\n                || this.editorHistory.currentHistoryInfo.action === 'Paste'))) {\n            selectionStartTextPosition = this.getTextPosition(start);\n            selectionEndTextPosition = this.getTextPosition(end);\n            this.owner.selection.selectRange(selectionStartTextPosition, selectionEndTextPosition);\n            isSelectionChanged = true;\n        }\n        // Updates insert position of history info instance.\n        this.insertPosition = start;\n        this.endPosition = end;\n        this.owner.editorModule.reLayout(this.owner.selection, this.owner.selection.isEmpty);\n        if (isSelectionChanged) {\n            this.viewer.scrollToPosition(this.owner.selection.start, this.owner.selection.end);\n        }\n        this.highlightListText();\n    };\n    BaseHistoryInfo.prototype.highlightListText = function () {\n        if (!isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            // tslint:disable-next-line:max-line-length\n            if (this.action === 'ListCharacterFormat' || (this.editorHistory.currentHistoryInfo.action === 'ListSelect' && this.action === 'ListFormat')) {\n                var selectionStartTextPosition = this.getTextPosition(this.selectionStart);\n                var widget = selectionStartTextPosition.currentWidget;\n                this.viewer.selection.highlightListText(widget);\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.removeContent = function (insertTextPosition, endTextPosition) {\n        //If the base parent of the insert text position and end text position is null \n        //then the paragraphs already removed.\n        //Example scenario: In table editing that is delete cells operation \n        // we will backed up the entire table ad it will be replaced on undo operation.\n        //At that time if the positions are in table \n        //which is already replaced in undo (revert modified nodes method) then the base parent of the paragraph will be null.\n        //So again, selecting the content and deleting is unnecessary\n        // and it will cause improper position updates and null reference exceptions. \n        if ((!isNullOrUndefined(insertTextPosition.paragraph.containerWidget) &&\n            insertTextPosition.paragraph.containerWidget instanceof BodyWidget &&\n            (!isNullOrUndefined(endTextPosition.paragraph.containerWidget)\n                && endTextPosition.paragraph.containerWidget instanceof BodyWidget))\n            || (!isNullOrUndefined(insertTextPosition.paragraph.containerWidget)\n                && !isNullOrUndefined(endTextPosition.paragraph.containerWidget)\n                && insertTextPosition.paragraph.containerWidget instanceof TableCellWidget\n                && endTextPosition.paragraph.containerWidget instanceof TableCellWidget\n                && !isNullOrUndefined(insertTextPosition.paragraph.bodyWidget))) {\n            //Removes if any empty paragraph is added while delete.\n            this.owner.selection.selectRange(insertTextPosition, endTextPosition);\n            var isDelete = (this.action === 'BackSpace') ? true : false;\n            this.owner.editorModule.deleteSelectedContents(this.owner.selection, isDelete);\n        }\n    };\n    BaseHistoryInfo.prototype.revertModifiedProperties = function (start, end) {\n        if (this.action === 'CellFormat' || this.action === 'CellOptions' || this.action === 'TableOptions') {\n            this.owner.isShiftingEnabled = false;\n        }\n        this.owner.selection.selectRange(start, end);\n        if (this.action === 'RowResizing' || this.action === 'CellResizing') {\n            this.revertResizing();\n        }\n        else if (this.action === 'CellOptions' || this.action === 'TableOptions') {\n            this.revertTableDialogProperties(this.action);\n        }\n        else if (this.action !== 'Selection') {\n            this.revertProperties();\n        }\n    };\n    // Redoes the Action\n    BaseHistoryInfo.prototype.redoAction = function () {\n        var editor = this.owner.editorModule;\n        switch (this.action) {\n            case 'BackSpace':\n                editor.singleBackspace(this.owner.selection, true);\n                break;\n            case 'Delete':\n                editor.singleDelete(this.owner.selection, true);\n                break;\n            case 'DeleteTable':\n                editor.deleteTable();\n                break;\n            case 'DeleteColumn':\n                editor.deleteColumn();\n                break;\n            case 'DeleteRow':\n                editor.deleteRow();\n                break;\n            case 'MergeCells':\n                editor.mergeSelectedCellsInTable();\n                break;\n            case 'InsertRowAbove':\n                editor.insertRow(true);\n                break;\n            case 'InsertRowBelow':\n                editor.insertRow(false);\n                break;\n            case 'InsertColumnLeft':\n                editor.insertColumn(true);\n                break;\n            case 'InsertColumnRight':\n                editor.insertColumn(true);\n                break;\n            case 'SectionBreak':\n                editor.insertSection(this.owner.selection, true);\n                break;\n        }\n    };\n    /**\n     * Revert the modified nodes\n     * @param  {WNode[]} deletedNodes\n     * @param  {boolean} isRedoAction\n     * @param  {string} start\n     * @param  {boolean} isEmptySelection\n     */\n    BaseHistoryInfo.prototype.revertModifiedNodes = function (deletedNodes, isRedoAction, start, isEmptySelection) {\n        if (isRedoAction && (this.action === 'BackSpace' || this.action === 'Delete' || this.action === 'DeleteTable'\n            || this.action === 'DeleteColumn' || this.action === 'DeleteRow' || this.action === 'InsertRowAbove' ||\n            this.action === 'InsertRowBelow' || this.action === 'InsertColumnLeft' || this.action === 'InsertColumnRight'\n            || this.action === 'MergeCells' || this.action === 'SectionBreak')) {\n            this.redoAction();\n            if (this.action === 'SectionBreak') {\n                return;\n            }\n        }\n        if (deletedNodes.length > 0) {\n            if ((this.editorHistory.isUndoing && (this.action === 'DeleteCells' || this.action === 'DeleteColumn'\n                || this.action === 'DeleteRow' || this.action === 'MergeCells'))\n                || (this.action === 'InsertRowAbove' || this.action === 'InsertRowBelow' || this.action === 'InsertColumnLeft'\n                    || this.action === 'ClearCells' || this.action === 'InsertColumnRight' || this.action === 'Borders')) {\n                var insertIndex = this.selectionStart;\n                var block = this.owner.editorModule.getBlock({ index: insertIndex }).node;\n                var lastNode = deletedNodes[deletedNodes.length - 1];\n                if ((block instanceof TableWidget || block.previousRenderedWidget instanceof TableWidget || block.isInsideTable)\n                    && lastNode instanceof TableWidget) {\n                    if (block instanceof ParagraphWidget && !block.isInsideTable) {\n                        block = block.previousRenderedWidget;\n                    }\n                    block = block.combineWidget(this.viewer);\n                    this.owner.editorModule.insertTableInternal(block, lastNode, false);\n                    deletedNodes.splice(deletedNodes.indexOf(lastNode), 1);\n                }\n                else if (lastNode instanceof TableWidget) {\n                    this.owner.editorModule.insertBlock(lastNode);\n                }\n            }\n            else {\n                var initialStart = start;\n                var block = this.owner.editorModule.getBlock({ index: initialStart }).node;\n                // initialStart = blockObj.position;\n                if (deletedNodes.length > 0 && (this.action === 'BackSpace' && isEmptySelection\n                    || (!(block instanceof TableWidget) && !(block instanceof HeaderFooterWidget)))) {\n                    var lastNode = deletedNodes[0];\n                    if (this.action === 'SectionBreak' && lastNode instanceof BodyWidget ||\n                        !isNullOrUndefined(this.editorHistory.currentHistoryInfo) &&\n                            this.editorHistory.currentHistoryInfo.action === 'PageBreak') {\n                        lastNode = deletedNodes[1];\n                    }\n                    if (lastNode instanceof ParagraphWidget && this.owner.selection.start.offset > 0) {\n                        this.owner.editorModule.insertNewParagraphWidget(lastNode, true);\n                        deletedNodes.splice(deletedNodes.indexOf(lastNode), 1);\n                        if (isNullOrUndefined(block)) {\n                            // tslint:disable-next-line:max-line-length\n                            var nextBlock = this.viewer.selection.getNextParagraphBlock(lastNode.getSplitWidgets().pop());\n                            this.owner.selection.getNextRenderedBlock(lastNode);\n                            if (isNullOrUndefined(nextBlock)) {\n                                //Sets the selection as starting of last paragraph.\n                                this.owner.selection.selectParagraph(lastNode, true);\n                            }\n                        }\n                    }\n                    if (lastNode instanceof TableWidget && this.owner.selection.start.offset > 0) {\n                        var firstBlock = deletedNodes[deletedNodes.length - 1];\n                        if (firstBlock instanceof ParagraphWidget) {\n                            this.owner.editorModule.insertNewParagraphWidget(firstBlock, true);\n                            deletedNodes.splice(deletedNodes.indexOf(firstBlock), 1);\n                            if (isNullOrUndefined(block)) {\n                                // tslint:disable-next-line:max-line-length\n                                var nextBlock = this.viewer.selection.getNextParagraphBlock(firstBlock.getSplitWidgets().pop());\n                                if (isNullOrUndefined(nextBlock)) {\n                                    //Sets the selection as starting of last paragraph.\n                                    this.owner.selection.selectParagraph(firstBlock, true);\n                                }\n                            }\n                        }\n                    }\n                }\n                if (deletedNodes.length > 0) {\n                    var firstNode = deletedNodes[deletedNodes.length - 1];\n                    if (block instanceof TableWidget) {\n                        block = block.combineWidget(this.viewer);\n                        if (firstNode instanceof TableWidget) {\n                            this.owner.editorModule.insertTableInternal(block, firstNode, true);\n                            deletedNodes.splice(deletedNodes.indexOf(firstNode), 1);\n                            this.insertPosition = start;\n                            var nextWidget = firstNode.getSplitWidgets().pop();\n                            if (nextWidget.nextRenderedWidget instanceof TableWidget) {\n                                block = nextWidget.nextRenderedWidget;\n                            }\n                            else {\n                                initialStart = start;\n                                block = this.owner.editorModule.getBlock({ index: initialStart }).node;\n                            }\n                        }\n                    }\n                    //Checks if first node is paragraph and current insert position is paragraph end.\n                    // tslint:disable-next-line:max-line-length\n                    if (firstNode instanceof ParagraphWidget && this.owner.selection.start.offset > 0\n                        && this.owner.selection.start.offset === this.owner.selection.getLineLength(this.owner.selection.start.paragraph.lastChild)) {\n                        var editor = this.owner.editorModule;\n                        editor.insertNewParagraphWidget(firstNode, false);\n                        deletedNodes.splice(deletedNodes.indexOf(firstNode), 1);\n                        //Removes the intermediate empty paragraph instance.\n                        if (this.action !== 'Paste') {\n                            editor.removeBlock(this.owner.selection.start.paragraph);\n                        }\n                        // tslint:disable-next-line:max-line-length\n                        var paragraph = this.viewer.selection.getNextParagraphBlock(firstNode.getSplitWidgets().pop());\n                        if (!isNullOrUndefined(paragraph)) {\n                            this.owner.selection.selectParagraph(paragraph, true);\n                        }\n                    }\n                    else if (deletedNodes[0] instanceof TableWidget && deletedNodes.length !== 1) {\n                        var nextNode = deletedNodes[1];\n                        if (nextNode instanceof ParagraphWidget && nextNode.isEmpty()) {\n                            deletedNodes.splice(deletedNodes.indexOf(nextNode), 1);\n                        }\n                    }\n                }\n                if (deletedNodes.length > 0) {\n                    if (block instanceof TableWidget) {\n                        block = block.combineWidget(this.viewer);\n                    }\n                    this.insertRemovedNodes(deletedNodes, block);\n                }\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.insertRemovedNodes = function (deletedNodes, block) {\n        for (var i = deletedNodes.length - 1, index = 0; i > -1; i--) {\n            var node = deletedNodes[i];\n            if (node instanceof ElementBox) {\n                this.owner.editorModule.insertInlineInSelection(this.owner.selection, node);\n            }\n            else if (node instanceof BlockWidget) {\n                if (node instanceof TableRowWidget) {\n                    if (block instanceof TableWidget) {\n                        block.childWidgets.splice(index, 0, node);\n                        this.owner.editorModule.updateNextBlocksIndex(node, true);\n                        if (i === 0 || !(deletedNodes[i - 1] instanceof TableRowWidget)) {\n                            // tslint:disable-next-line:max-line-length\n                            this.viewer.layout.layoutBodyWidgetCollection(block.index, block.containerWidget, block, false);\n                        }\n                    }\n                }\n                else if (block instanceof TableWidget) {\n                    this.owner.editorModule.insertBlockTable(this.owner.selection, node, block);\n                }\n                else {\n                    this.owner.editorModule.insertBlock(node);\n                }\n            }\n            else if (node instanceof BodyWidget) {\n                this.owner.editorModule.insertSection(this.owner.selection, false);\n            }\n        }\n        deletedNodes = [];\n    };\n    BaseHistoryInfo.prototype.revertResizing = function () {\n        this.editorHistory.currentBaseHistoryInfo = this;\n        if (this.action === 'RowResizing') {\n            if (this.modifiedProperties[0] instanceof RowHistoryFormat) {\n                // tslint:disable-next-line:max-line-length\n                this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing, this.owner);\n            }\n        }\n        else {\n            if (this.modifiedProperties[0] instanceof TableHistoryInfo) {\n                //selected cell resizing the condition checks done based on the selected widgets only. so need to highlight the selection.\n                if (this.owner.selection.selectedWidgets.length === 0) {\n                    this.owner.selection.highlightSelection(true);\n                }\n                var prevTableHistoryInfo = this.modifiedProperties[0];\n                var position = prevTableHistoryInfo.tableHierarchicalIndex;\n                var block = this.owner.editorModule.getBlock({ index: position }).node;\n                if (block instanceof TableWidget) {\n                    var tableResize = this.owner.editorModule.tableResize;\n                    this.owner.editor.setOffsetValue(this.owner.selection);\n                    block = block.combineWidget(this.owner.viewer);\n                    tableResize.currentResizingTable = block;\n                    this.modifiedProperties.splice(0, 1);\n                    if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n                        var tableHistoryInfoCurrent = new TableHistoryInfo(block, this.owner);\n                        this.modifiedProperties.splice(0, 0, tableHistoryInfoCurrent);\n                        this.owner.isLayoutEnabled = false;\n                        tableResize.applyProperties(tableResize.currentResizingTable, prevTableHistoryInfo);\n                        tableResize.currentResizingTable.isGridUpdated = true;\n                        this.owner.isLayoutEnabled = true;\n                        tableResize.updateGridValue(tableResize.currentResizingTable, false);\n                        prevTableHistoryInfo.destroy();\n                        prevTableHistoryInfo = undefined;\n                    }\n                }\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.revertTableDialogProperties = function (action) {\n        this.owner.isShiftingEnabled = false;\n        this.editorHistory.currentBaseHistoryInfo = this;\n        this.currentPropertyIndex = 0;\n        if (action === 'CellOptions') {\n            var selection = this.owner.selection;\n            var cellFormat = this.modifiedProperties[0];\n            this.owner.editorModule.updateCellMargins(selection, cellFormat);\n        }\n        else if (action === 'TableOptions') {\n            this.owner.tableOptionsDialogModule.applyTableOptionsHelper(this.modifiedProperties[0]);\n        }\n        this.currentPropertyIndex = 0;\n        this.owner.isShiftingEnabled = true;\n    };\n    BaseHistoryInfo.prototype.getTextPosition = function (hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        var blockInfo = this.owner.editorModule.getParagraph({ index: hierarchicalIndex });\n        var lineInfo = this.owner.editorModule.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n        return textPosition;\n    };\n    /**\n     * Add modified properties for section format\n     * @param  {WSectionFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForSection = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            var modifiedProperties = this.modifiedProperties;\n            var previousFormat = (this.currentPropertyIndex < modifiedProperties.length ?\n                modifiedProperties[this.currentPropertyIndex] : modifiedProperties[modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n            }\n            else {\n                value = previousFormat.getPropertyValue(property);\n                previousFormat.copyFormat(format);\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WSectionFormat();\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n        }\n        return value;\n    };\n    /**\n     * Add the modified properties for character format\n     * @param  {WCharacterFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedProperties = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length           \n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            var skipRemove = false;\n            if (format.ownerBase instanceof ElementBox) {\n                var prevLength = this.modifiedNodeLength[this.currentPropertyIndex];\n                if (format.ownerBase.length < prevLength) {\n                    skipRemove = true;\n                    this.modifiedNodeLength[this.currentPropertyIndex] = format.ownerBase.length;\n                    this.modifiedNodeLength.splice(this.currentPropertyIndex + 1, 0, prevLength - format.ownerBase.length);\n                    //Adds a copy of character format at next position for splitted inline.\n                    var nextFormat = new WCharacterFormat(undefined);\n                    nextFormat.copyFormat(previousFormat);\n                    this.modifiedProperties.splice(this.currentPropertyIndex + 1, 0, nextFormat);\n                }\n            }\n            if (this.action === 'ClearCharacterFormat') {\n                if (this.editorHistory.isUndoing) {\n                    value = previousFormat;\n                    if (!skipRemove) {\n                        this.modifiedProperties.splice(this.currentPropertyIndex, 1);\n                        this.currentPropertyIndex--;\n                    }\n                }\n                else {\n                    this.modifiedProperties.push(format.cloneFormat());\n                }\n            }\n            else {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WCharacterFormat(undefined);\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n            if (format.ownerBase instanceof ElementBox) {\n                this.modifiedNodeLength.push(format.ownerBase.length);\n            }\n            else {\n                this.modifiedNodeLength.push(0);\n            }\n        }\n        return value;\n    };\n    /**\n     * Add the modified properties for paragraph format\n     * @param  {WParagraphFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForParagraphFormat = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (this.action === 'ClearParagraphFormat') {\n                if (this.editorHistory.isUndoing) {\n                    value = previousFormat;\n                    this.modifiedProperties.splice(this.currentPropertyIndex, 1);\n                    this.currentPropertyIndex--;\n                }\n                else {\n                    this.modifiedProperties.push(format.cloneFormat());\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'listFormat') {\n                value = new WParagraphFormat(undefined);\n                value.copyFormat(previousFormat);\n                previousFormat.listFormat = new WListFormat();\n                previousFormat.listFormat.copyFormat(format.listFormat);\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'styleName') {\n                if (!isNullOrUndefined(previousFormat.baseStyle)) {\n                    value = new WParagraphStyle();\n                    value.copyStyle(previousFormat.baseStyle);\n                    this.currentPropertyIndex++;\n                    return value;\n                }\n                else {\n                    return undefined;\n                }\n            }\n            value = previousFormat.getPropertyValue(property);\n            previousFormat.copyFormat(format);\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WParagraphFormat(undefined);\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n        }\n        return value;\n    };\n    /**\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForContinueNumbering = function (paragraphFormat, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = previousFormat;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = paragraphFormat.cloneFormat();\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = paragraphFormat.cloneFormat();\n            }\n            this.currentPropertyIndex++;\n            return value;\n        }\n        else {\n            var currentFormat = new WParagraphFormat();\n            currentFormat.copyFormat(paragraphFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * @param listFormat\n     * @param value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForRestartNumbering = function (listFormat, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var listId = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = listId;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = listFormat.listId;\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = listFormat.listId;\n            }\n            this.currentPropertyIndex++;\n            return value;\n        }\n        else {\n            this.modifiedProperties.push(listFormat.listId);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for list format\n     * @param  {WListLevel} listLevel\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForList = function (listLevel) {\n        var value;\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousLevel = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = previousLevel;\n            previousLevel = new ModifiedLevel(listLevel, this.owner.editorModule.cloneListLevel(listLevel));\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = previousLevel;\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = previousLevel;\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            this.modifiedProperties.push(new ModifiedLevel(listLevel, this.owner.editorModule.cloneListLevel(listLevel)));\n            value = listLevel;\n        }\n        return value;\n    };\n    /**\n     * Revert the properties\n     * @param  {SelectionRange} selectionRange\n     */\n    BaseHistoryInfo.prototype.revertProperties = function () {\n        this.editorHistory.currentBaseHistoryInfo = this;\n        this.currentPropertyIndex = 0;\n        var property = this.getProperty();\n        this.viewer.owner.editorModule.setOffsetValue(this.viewer.selection);\n        if (this.action === 'ClearCharacterFormat' || this.modifiedProperties[0] instanceof WCharacterFormat) {\n            if (this.action === 'ListCharacterFormat') {\n                this.owner.editorModule.updateListCharacterFormat(this.viewer.selection, property, undefined);\n                return;\n            }\n            this.owner.editorModule.updateSelectionCharacterFormatting(property, undefined, false);\n        }\n        else if (this.action === 'ClearParagraphFormat' || this.modifiedProperties[0] instanceof WParagraphFormat) {\n            if (this.action === 'ContinueNumbering') {\n                // tslint:disable-next-line:max-line-length\n                this.owner.editorModule.revertContinueNumbering(this.owner.selection, this.modifiedProperties[0]);\n                return;\n            }\n            if (this.action === 'StyleName' && this.modifiedProperties[0] instanceof WParagraphFormat) {\n                // tslint:disable-next-line:max-line-length\n                this.owner.editorModule.updateSelectionParagraphFormatting(property, this.modifiedProperties[0].baseStyle, false);\n                return;\n            }\n            this.owner.editorModule.updateSelectionParagraphFormatting(property, undefined, false);\n        }\n        else if (this.modifiedProperties[0] instanceof WSectionFormat) {\n            this.owner.editorModule.updateSectionFormat(property, undefined);\n        }\n        else if (this.action === 'RestartNumbering') {\n            this.owner.editorModule.restartListAtInternal(this.owner.selection, this.modifiedProperties[0]);\n            return;\n        }\n        else if (this.modifiedProperties[0] instanceof ImageFormat) {\n            this.owner.selection.updateImageSize(this.modifiedProperties[0]);\n        }\n        else if (this.modifiedProperties[0] instanceof ModifiedLevel) {\n            var modified = new Dictionary();\n            for (var i = 0; i < this.modifiedProperties.length; i++) {\n                var modifiedLevel = this.modifiedProperties[i];\n                // modified.modifiedLevels.add(modifiedLevel.ownerListLevel.levelNumber, modifiedLevel);\n                modified.add(i, modifiedLevel);\n            }\n            this.editorHistory.updateListChanges(modified);\n            modified.destroy();\n            modified = undefined;\n        }\n        else if (this.modifiedProperties[0] instanceof WTableFormat) {\n            this.owner.editorModule.updateTableFormat(this.owner.selection, property, undefined);\n        }\n        else if (this.modifiedProperties[0] instanceof WCellFormat) {\n            this.owner.isShiftingEnabled = true;\n            this.owner.editorModule.updateCellFormat(this.owner.selection, property, undefined);\n        }\n        else if (this.modifiedProperties[0] instanceof WRowFormat) {\n            this.owner.editorModule.updateRowFormat(this.owner.selection, property, undefined);\n        }\n        this.currentPropertyIndex = 0;\n        if (this.action === 'ClearCharacterFormat' || this.action === 'ClearParagraphFormat') {\n            this.owner.editorModule.getOffsetValue(this.viewer.selection);\n        }\n    };\n    /**\n     * Add modified properties for cell options dialog\n     * @param  {WCellFormat} format\n     * @param  {WTable} table\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedCellOptions = function (applyFormat, format, table) {\n        var currentFormat;\n        if (isNullOrUndefined(applyFormat.bottomMargin) && isNullOrUndefined(applyFormat.topMargin)\n            && isNullOrUndefined(applyFormat.rightMargin) && isNullOrUndefined(applyFormat.leftMargin)) {\n            currentFormat = this.copyCellOptions(table.tableFormat);\n        }\n        else {\n            currentFormat = this.copyCellOptions(applyFormat);\n        }\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            format = previousFormat;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = this.copyCellOptions(applyFormat);\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = this.copyCellOptions(applyFormat);\n            }\n            this.currentPropertyIndex++;\n            return format;\n        }\n        else {\n            this.modifiedProperties.push(currentFormat);\n        }\n        return format;\n    };\n    BaseHistoryInfo.prototype.copyCellOptions = function (format) {\n        var cellFormat = new WCellFormat();\n        cellFormat.topMargin = format.topMargin;\n        cellFormat.rightMargin = format.rightMargin;\n        cellFormat.bottomMargin = format.bottomMargin;\n        cellFormat.leftMargin = format.leftMargin;\n        return cellFormat;\n    };\n    /**\n     * Add modified properties for cell options dialog\n     * @param  {WTableFormat} format\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedTableOptions = function (format) {\n        var currentFormat = this.copyTableOptions(format);\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length           \n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties.splice(this.currentPropertyIndex, 1, currentFormat);\n            }\n            else {\n                this.modifiedProperties.splice(this.modifiedProperties.length - 1, 1, currentFormat);\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            this.modifiedProperties.push(currentFormat);\n        }\n    };\n    BaseHistoryInfo.prototype.copyTableOptions = function (format) {\n        var tableFormat = new WTableFormat();\n        tableFormat.topMargin = format.topMargin;\n        tableFormat.rightMargin = format.rightMargin;\n        tableFormat.bottomMargin = format.bottomMargin;\n        tableFormat.leftMargin = format.leftMargin;\n        tableFormat.cellSpacing = format.cellSpacing;\n        return tableFormat;\n    };\n    BaseHistoryInfo.prototype.getProperty = function () {\n        switch (this.action) {\n            case 'Bold':\n                return 'bold';\n            case 'Italic':\n                return 'italic';\n            case 'FontColor':\n                return 'fontColor';\n            case 'FontFamily':\n                return 'fontFamily';\n            case 'FontSize':\n                return 'fontSize';\n            case 'HighlightColor':\n                return 'highlightColor';\n            case 'BaselineAlignment':\n                return 'baselineAlignment';\n            case 'Strikethrough':\n                return 'strikethrough';\n            case 'Underline':\n                return 'underline';\n            case 'AfterSpacing':\n                return 'afterSpacing';\n            case 'BeforeSpacing':\n                return 'beforeSpacing';\n            case 'LeftIndent':\n                return 'leftIndent';\n            case 'RightIndent':\n                return 'rightIndent';\n            case 'FirstLineIndent':\n                return 'firstLineIndent';\n            case 'LineSpacingType':\n                return 'lineSpacingType';\n            case 'LineSpacing':\n                return 'lineSpacing';\n            case 'TextAlignment':\n                return 'textAlignment';\n            case 'ListFormat':\n                return 'listFormat';\n            case 'PageHeight':\n                return 'pageHeight';\n            case 'PageWidth':\n                return 'pageWidth';\n            case 'TableAlignment':\n                return 'tableAlignment';\n            case 'TableLeftIndent':\n                return 'leftIndent';\n            case 'DefaultCellSpacing':\n                return 'cellSpacing';\n            case 'LeftMargin':\n            case 'CellLeftMargin':\n            case 'DefaultCellLeftMargin':\n                return 'leftMargin';\n            case 'RightMargin':\n            case 'CellRightMargin':\n            case 'DefaultCellRightMargin':\n                return 'rightMargin';\n            case 'TopMargin':\n            case 'CellTopMargin':\n            case 'DefaultCellTopMargin':\n                return 'topMargin';\n            case 'BottomMargin':\n            case 'CellBottomMargin':\n            case 'DefaultCellBottomMargin':\n                return 'bottomMargin';\n            case 'CellContentVerticalAlignment':\n                return 'verticalAlignment';\n            case 'RowHeight':\n                return 'height';\n            case 'RowHeightType':\n                return 'heightType';\n            case 'RowHeader':\n                return 'isHeader';\n            case 'AllowBreakAcrossPages':\n                return 'allowBreakAcrossPages';\n            case 'TablePreferredWidth':\n            case 'CellPreferredWidth':\n                return 'preferredWidth';\n            case 'TablePreferredWidthType':\n            case 'CellPreferredWidthType':\n                return 'preferredWidthType';\n            case 'Shading':\n                return 'shading';\n            case 'StyleName':\n                return 'styleName';\n        }\n        return undefined;\n    };\n    BaseHistoryInfo.prototype.getCharacterPropertyValue = function (property, modifiedProperty) {\n        var value;\n        if (property === 'bold') {\n            value = modifiedProperty.bold;\n        }\n        else if (property === 'italic') {\n            value = modifiedProperty.italic;\n        }\n        else if (property === 'fontColor') {\n            value = modifiedProperty.fontColor;\n        }\n        else if (property === 'fontFamily') {\n            value = modifiedProperty.fontFamily;\n        }\n        else if (property === 'fontSize') {\n            value = modifiedProperty.fontSize;\n        }\n        else if (property === 'highlightColor') {\n            value = modifiedProperty.highlightColor;\n        }\n        else if (property === 'baselineAlignment') {\n            value = modifiedProperty.baselineAlignment;\n        }\n        else if (property === 'strikethrough') {\n            value = modifiedProperty.strikethrough;\n        }\n        else if (property === 'underline') {\n            value = modifiedProperty.underline;\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for table format\n     * @param  {WTableFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedTableProperties = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousTableFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousTableFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'shading') {\n                value = previousTableFormat.shading;\n            }\n            else {\n                value = previousTableFormat.getPropertyValue(property);\n            }\n            previousTableFormat.copyFormat(format);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WTableFormat();\n            currentFormat.copyFormat(format);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for row format\n     * @param  {WRowFormat} rowFormat\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedRowProperties = function (rowFormat, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = rowFormat.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = rowFormat.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            value = previousFormat.getPropertyValue(property);\n            previousFormat.copyFormat(rowFormat);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WRowFormat();\n            currentFormat.copyFormat(rowFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for cell format\n     * @param  {WCellFormat} cellFormat\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedCellProperties = function (cellFormat, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = cellFormat.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = cellFormat.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'shading') {\n                value = previousFormat.shading;\n            }\n            else {\n                value = previousFormat.getPropertyValue(property);\n            }\n            previousFormat.copyFormat(cellFormat);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WCellFormat();\n            currentFormat.copyFormat(cellFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * @private\n     */\n    BaseHistoryInfo.prototype.destroy = function () {\n        this.selectionStart = undefined;\n        this.selectionEnd = undefined;\n        this.insertPosition = undefined;\n        this.endPosition = undefined;\n        if (!isNullOrUndefined(this.modifiedNodeLength)) {\n            this.modifiedNodeLength = [];\n            this.modifiedNodeLength = undefined;\n        }\n        if (!isNullOrUndefined(this.modifiedProperties)) {\n            for (var i = 0; i < this.modifiedProperties.length; i++) {\n                var property = this.modifiedProperties[i];\n                if (property instanceof WCharacterFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof WParagraphFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof WSectionFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof ModifiedLevel) {\n                    property.destroy();\n                }\n                this.modifiedProperties.splice(this.modifiedProperties.indexOf(property), 1);\n                i--;\n            }\n            this.modifiedPropertiesIn = undefined;\n        }\n        if (!isNullOrUndefined(this.removedNodes)) {\n            for (var i = 0; i < this.removedNodes.length; i++) {\n                var node = this.removedNodes[i];\n                if (node instanceof ParagraphWidget) {\n                    node.destroyInternal(this.viewer);\n                }\n                else if (node instanceof ElementBox) {\n                    node.destroy();\n                }\n                this.removedNodes.splice(this.removedNodes.indexOf(node), 1);\n                i--;\n            }\n            this.removedNodesIn = undefined;\n        }\n        this.ownerIn = undefined;\n    };\n    return BaseHistoryInfo;\n}());\nexport { BaseHistoryInfo };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { PageLayoutViewer } from '../index';\nimport { Dictionary } from '../../base/dictionary';\nimport { ImageFormat } from '../selection/selection-helper';\nimport { Point, HelperMethods } from './editor-helper';\nimport { BaseHistoryInfo } from '../editor-history/base-history-info';\n/**\n * Image resizer implementation.\n */\nvar ImageResizer = /** @class */ (function () {\n    /**\n     * Constructor for image resizer module.\n     * @param {DocumentEditor} node\n     * @param {LayoutViewer} viewer\n     * @private\n     */\n    function ImageResizer(node, viewer) {\n        /**\n         * @private\n         */\n        this.resizeContainerDiv = undefined;\n        /**\n         * @private\n         */\n        this.topLeftRect = undefined;\n        /**\n         * @private\n         */\n        this.topMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.topRightRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomLeftRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomRightRect = undefined;\n        /**\n         * @private\n         */\n        this.leftMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.rightMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.topLeftRectParent = undefined;\n        /**\n         * @private\n         */\n        this.topMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.topRightRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomLeftRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomRightRectParent = undefined;\n        /**\n         * @private\n         */\n        this.leftMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.rightMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.resizeMarkSizeIn = 7;\n        /**\n         * @private\n         */\n        this.selectedImageWidget = undefined;\n        /**\n         * @private\n         */\n        this.baseHistoryInfo = undefined;\n        /**\n         * @private\n         */\n        this.isImageResizing = false;\n        /**\n         * @private\n         */\n        this.isImageResizerVisible = false;\n        /**\n         * @private\n         */\n        this.isImageMoveToNextPage = false;\n        /**\n         * @private\n         */\n        this.selectedResizeElement = undefined;\n        /**\n         * @private\n         */\n        this.topValue = undefined;\n        /**\n         * @private\n         */\n        this.leftValue = undefined;\n        this.owner = node;\n        this.selectedImageWidget = new Dictionary();\n        this.viewer = viewer;\n        this.imageResizerPoints = new ImageResizingPoints();\n        if (isNullOrUndefined(this.imageResizerDiv) && this.viewer && this.viewer.pageContainer) {\n            this.initializeImageResizer();\n        }\n    }\n    Object.defineProperty(ImageResizer.prototype, \"currentImageElementBox\", {\n        /**\n         * Gets or Sets the current image element box.\n         * @private\n         */\n        get: function () {\n            return this.currentImageElementBoxIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.currentImageElementBoxIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageResizer.prototype, \"resizeMarkSize\", {\n        /**\n         * Gets or Sets the resize mark size.\n         * @private\n         */\n        get: function () {\n            return this.resizeMarkSizeIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.resizeMarkSizeIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets module name.\n     */\n    ImageResizer.prototype.getModuleName = function () {\n        return 'ImageResizer';\n    };\n    //Image Resizing Methods\n    /**\n     * Sets image resizer position.\n     * @param {number} x - Specifies for image resizer left value.\n     * @param {number} y - Specifies for image resizer top value.\n     * @param {number} width - Specifies for image resizer width value.\n     * @param {number} height - Specifies for image resizer height value.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizerPositions = function (x, y, width, height) {\n        this.imageResizerDivElement.style.top = y.toString() + 'px';\n        this.imageResizerDivElement.style.left = x.toString() + 'px';\n        this.imageResizerDivElement.style.borderWidth = '0px';\n        this.imageResizerDivElement.style.height = height + 'px';\n        this.imageResizerDivElement.style.width = width + 'px';\n        this.imageResizerDivElement.style.backgroundColor = 'transparent';\n        this.imageResizerDivElement.style.overflow = 'hidden';\n        this.imageResizerDivElement.style.position = 'absolute';\n    };\n    /**\n     * Creates image resizer DOM element.\n     * @private\n     */\n    ImageResizer.prototype.initializeImageResizer = function () {\n        this.imageResizerDivElement = document.createElement('div');\n        this.imageResizerDivElement.style.zIndex = '1';\n        this.imageResizerDivElement.style.display = 'none';\n        this.viewer.pageContainer.appendChild(this.imageResizerDivElement);\n    };\n    /**\n     * Position an image resizer\n     * @param {ImageElementBox} elementBox - Specifies the image position.\n     * @private\n     */\n    ImageResizer.prototype.positionImageResizer = function (elementBox) {\n        this.selectedImageWidget.clear();\n        // Initializes the image resizer on demand, i.e at the time of selecting an image for the first time.\n        var resizeDiv;\n        if (!isNullOrUndefined(this.viewer.currentPage)) {\n            resizeDiv = this.imageResizerDivElement;\n        }\n        if (!isNullOrUndefined(resizeDiv) && !resizeDiv.contains(this.imageResizerDiv)) {\n            this.imageResizerDiv = this.initResizeMarks(resizeDiv, this);\n        }\n        this.imageResizerDiv.style.width = (elementBox.width) + 'px';\n        this.imageResizerDiv.style.height = (elementBox.height) + 'px';\n        this.currentImageElementBox = elementBox;\n        var lineWidget = elementBox.line;\n        var top = this.viewer.selection.getTop(lineWidget) + elementBox.margin.top;\n        var left = this.viewer.selection.getLeftInternal(lineWidget, elementBox, 0);\n        var page = this.viewer.selection.getPage(lineWidget.paragraph);\n        this.currentPage = page;\n        var x = 0;\n        var y = 0;\n        if (!isNullOrUndefined(resizeDiv)) {\n            this.imageResizerDivElement.style.display = 'block';\n            resizeDiv.style.width = page.boundingRectangle.width + 'px';\n            resizeDiv.style.height = page.boundingRectangle.height + 'px';\n            resizeDiv.style.left = page.boundingRectangle.x + 'px';\n            resizeDiv.style.top = page.boundingRectangle.y + 'px';\n            resizeDiv.style.borderWidth = '0px';\n            resizeDiv.style.backgroundColor = 'transparent';\n            resizeDiv.style.overflow = 'hidden';\n            resizeDiv.style.position = 'absolute';\n        }\n        var horizontalWidth = 0;\n        var pageWidth = this.viewer.getPageWidth(page);\n        var pagelayout = this.viewer;\n        // tslint:disable-next-line:max-line-length\n        horizontalWidth = parseFloat(this.imageResizerDivElement.style.width);\n        x = (this.viewer.visibleBounds.width - horizontalWidth * this.viewer.zoomFactor) / 2;\n        if (x < 30) {\n            x = 30;\n        }\n        if (pageWidth < horizontalWidth) {\n            x += (horizontalWidth - pageWidth) * this.viewer.zoomFactor / 2;\n        }\n        // tslint:disable-next-line:max-line-length           \n        y = page.boundingRectangle.y * this.viewer.zoomFactor + (this.viewer.pages.indexOf(page) + 1) * 20 * (1 - this.viewer.zoomFactor);\n        var currentPageDiv = this.imageResizerDivElement;\n        var currentPageDivWidth = parseFloat(currentPageDiv.style.width);\n        var currentPageDivHeight = parseFloat(currentPageDiv.style.height);\n        var imageResizerDivWidth = parseFloat(this.imageResizerDiv.style.width);\n        var imageResizerDivHeight = parseFloat(this.imageResizerDiv.style.height);\n        var margin = (this.resizeMarkSize - 1) / 2;\n        var width = imageResizerDivWidth + 2 * margin;\n        var height = imageResizerDivHeight + 2 * margin;\n        if (width > (currentPageDivWidth - left) * this.viewer.zoomFactor + margin) {\n            width = (currentPageDivWidth - left) * this.viewer.zoomFactor;\n        }\n        if (height > (currentPageDivHeight - top) * this.viewer.zoomFactor + margin) {\n            height = (currentPageDivHeight - top) * this.viewer.zoomFactor;\n        }\n        // if (width < imageResizerDivHeight + margin || height < imageResizerDivHeight + margin) {\n        // }\n        // tslint:disable-next-line:max-line-length\n        this.imageResizerDivElement.style.width = parseInt(this.imageResizerDivElement.style.width.replace('px', ''), 10) * this.viewer.zoomFactor + 'px';\n        this.imageResizerDivElement.style.height = parseInt(this.imageResizerDivElement.style.height.replace('px', ''), 10) * this.viewer.zoomFactor + 'px';\n        height = this.viewer.render.getScaledValue(elementBox.height);\n        width = this.viewer.render.getScaledValue(elementBox.width);\n        left = this.viewer.render.getScaledValue(left);\n        top = this.viewer.render.getScaledValue(top);\n        this.setImageResizerPosition(left, top, width, height, this);\n        if (!this.selectedImageWidget.containsKey(lineWidget)) {\n            var selectedImageInfo = new SelectedImageInfo(elementBox.height, elementBox.width);\n            this.selectedImageWidget.add(lineWidget, selectedImageInfo);\n        }\n    };\n    /**\n     * Shows the image resizer.\n     * @private\n     */\n    ImageResizer.prototype.showImageResizer = function () {\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.style.display = '';\n        }\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.style.display = '';\n            this.bottomLeftRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.style.display = '';\n            this.bottomRightRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.style.display = '';\n            this.bottomMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.style.display = '';\n            this.rightMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.style.display = '';\n            this.topRightRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.style.display = '';\n            this.topLeftRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.style.display = '';\n            this.leftMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.style.display = '';\n            this.topMiddleRectParent.style.display = '';\n        }\n        this.isImageResizerVisible = true;\n    };\n    /**\n     * Hides the image resizer.\n     * @private\n     */\n    ImageResizer.prototype.hideImageResizer = function () {\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.style.display = 'none';\n            this.bottomLeftRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.style.display = 'none';\n            this.bottomRightRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.style.display = 'none';\n            this.bottomMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.style.display = 'none';\n            this.rightMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.style.display = 'none';\n            this.topRightRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.style.display = 'none';\n            this.topLeftRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.style.display = 'none';\n            this.leftMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.style.display = 'none';\n            this.topMiddleRectParent.style.display = 'none';\n        }\n        this.isImageResizerVisible = false;\n        this.currentPage = undefined;\n    };\n    /**\n     * Initialize the resize marks.\n     * @param {HTMLElement} resizeDiv - Specifies to appending resizer container div element.\n     * @param {ImageResizer} imageResizer - Specifies to creating div element of each position.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    ImageResizer.prototype.initResizeMarks = function (resizeDiv, imageResizer) {\n        this.initResizeContainerDiv(imageResizer);\n        resizeDiv.appendChild(imageResizer.resizeContainerDiv);\n        imageResizer.topRightRectParent = document.createElement('div');\n        imageResizer.topRightRectParent.style.cursor = 'ne-resize';\n        imageResizer.topRightRectParent.id = this.viewer.owner.containerId + '_TopRightRectParent';\n        this.applyProperties(imageResizer.topRightRectParent);\n        imageResizer.topRightRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topRightRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topRightRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topRightRectParent);\n        imageResizer.topRightRect = document.createElement('div');\n        imageResizer.topRightRect.id = this.viewer.owner.containerId + '_TopRightRect';\n        imageResizer.topRightRect.style.cursor = 'ne-resize';\n        this.applyProperties(imageResizer.topRightRect);\n        resizeDiv.appendChild(imageResizer.topRightRect);\n        imageResizer.topLeftRectParent = document.createElement('div');\n        imageResizer.topLeftRectParent.style.cursor = 'nw-resize';\n        imageResizer.topLeftRectParent.id = this.viewer.owner.containerId + '_TopLeftRectParent';\n        this.applyProperties(imageResizer.topLeftRectParent);\n        imageResizer.topLeftRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topLeftRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topLeftRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topLeftRectParent);\n        imageResizer.topLeftRect = document.createElement('div');\n        imageResizer.topLeftRect.id = this.viewer.owner.containerId + '_TopLeftRect';\n        imageResizer.topLeftRect.style.cursor = 'nw-resize';\n        this.applyProperties(imageResizer.topLeftRect);\n        resizeDiv.appendChild(imageResizer.topLeftRect);\n        imageResizer.topMiddleRectParent = document.createElement('div');\n        imageResizer.topMiddleRectParent.style.cursor = 'n-resize';\n        imageResizer.topMiddleRectParent.id = this.viewer.owner.containerId + '_TopMiddleRectParent';\n        this.applyProperties(imageResizer.topMiddleRectParent);\n        imageResizer.topMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topMiddleRectParent);\n        imageResizer.topMiddleRect = document.createElement('div');\n        imageResizer.topMiddleRect.id = this.viewer.owner.containerId + '_TopMiddleRect';\n        imageResizer.topMiddleRect.style.cursor = 'n-resize';\n        this.applyProperties(imageResizer.topMiddleRect);\n        resizeDiv.appendChild(imageResizer.topMiddleRect);\n        imageResizer.bottomRightRectParent = document.createElement('div');\n        imageResizer.bottomRightRectParent.style.cursor = 'se-resize';\n        imageResizer.bottomRightRectParent.id = this.viewer.owner.containerId + '_BottomRightRectParent';\n        this.applyProperties(imageResizer.bottomRightRectParent);\n        imageResizer.bottomRightRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomRightRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomRightRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomRightRectParent);\n        imageResizer.bottomRightRect = document.createElement('div');\n        imageResizer.bottomRightRect.id = this.viewer.owner.containerId + '_BottomRightRect';\n        imageResizer.bottomRightRect.style.cursor = 'se-resize';\n        this.applyProperties(imageResizer.bottomRightRect);\n        resizeDiv.appendChild(imageResizer.bottomRightRect);\n        imageResizer.bottomLeftRectParent = document.createElement('div');\n        imageResizer.bottomLeftRectParent.style.cursor = 'sw-resize';\n        imageResizer.bottomLeftRectParent.id = this.viewer.owner.containerId + '_BottomLeftRectParent';\n        this.applyProperties(imageResizer.bottomLeftRectParent);\n        imageResizer.bottomLeftRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomLeftRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomLeftRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomLeftRectParent);\n        imageResizer.bottomLeftRect = document.createElement('div');\n        imageResizer.bottomLeftRect.id = this.viewer.owner.containerId + '_BottomLeftRect';\n        imageResizer.bottomLeftRect.style.cursor = 'sw-resize';\n        this.applyProperties(imageResizer.bottomLeftRect);\n        resizeDiv.appendChild(imageResizer.bottomLeftRect);\n        imageResizer.bottomMiddleRectParent = document.createElement('div');\n        imageResizer.bottomMiddleRectParent.style.cursor = 's-resize';\n        imageResizer.bottomMiddleRectParent.id = this.viewer.owner.containerId + '_BottomMiddleRectParent';\n        this.applyProperties(imageResizer.bottomMiddleRectParent);\n        imageResizer.bottomMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomMiddleRectParent);\n        imageResizer.bottomMiddleRect = document.createElement('div');\n        imageResizer.bottomMiddleRect.id = this.viewer.owner.containerId + '_BottomMiddleRect';\n        imageResizer.bottomMiddleRect.style.cursor = 's-resize';\n        this.applyProperties(imageResizer.bottomMiddleRect);\n        resizeDiv.appendChild(imageResizer.bottomMiddleRect);\n        imageResizer.rightMiddleRectParent = document.createElement('div');\n        imageResizer.rightMiddleRectParent.style.cursor = 'e-resize';\n        imageResizer.rightMiddleRectParent.id = this.viewer.owner.containerId + '_RightMiddleRectParent';\n        this.applyProperties(imageResizer.rightMiddleRectParent);\n        imageResizer.rightMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.rightMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.rightMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.rightMiddleRectParent);\n        imageResizer.rightMiddleRect = document.createElement('div');\n        imageResizer.rightMiddleRect.id = this.viewer.owner.containerId + '_RightMiddleRect';\n        imageResizer.rightMiddleRect.style.cursor = 'e-resize';\n        this.applyProperties(imageResizer.rightMiddleRect);\n        resizeDiv.appendChild(imageResizer.rightMiddleRect);\n        imageResizer.leftMiddleRectParent = document.createElement('div');\n        imageResizer.leftMiddleRectParent.style.cursor = 'w-resize';\n        imageResizer.leftMiddleRectParent.id = this.viewer.owner.containerId + '_LeftMiddleRectParent';\n        this.applyProperties(imageResizer.leftMiddleRectParent);\n        imageResizer.leftMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.leftMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.leftMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.leftMiddleRectParent);\n        imageResizer.leftMiddleRect = document.createElement('div');\n        imageResizer.leftMiddleRect.id = this.viewer.owner.containerId + '_LeftMiddleRect';\n        imageResizer.leftMiddleRect.style.cursor = 'w-resize';\n        this.applyProperties(imageResizer.leftMiddleRect);\n        resizeDiv.appendChild(imageResizer.leftMiddleRect);\n        return imageResizer.resizeContainerDiv;\n    };\n    /**\n     * Sets the image resizer position.\n     * @param {number} left - Specifies for image resizer left value.\n     * @param {number} top - Specifies for image resizer top value.\n     * @param {number} width - Specifies for image resizer width value.\n     * @param {number} height - Specifies for image resizer height value.\n     * @param {ImageResizer} imageResizer - Specifies for image resizer.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizerPosition = function (left, top, width, height, imageResizer) {\n        //Positions Updating For Image Resize Div\n        imageResizer.resizeContainerDiv.style.width = width + 'px';\n        imageResizer.resizeContainerDiv.style.height = height + 'px';\n        imageResizer.resizeContainerDiv.style.left = left - 1 + 'px';\n        imageResizer.resizeContainerDiv.style.top = top + 'px';\n        //Positions Updating For Image Resizing Points\n        imageResizer.topRightRect.style.left = ((left + width) - 5) + 'px';\n        imageResizer.topRightRect.style.top = (top - 4) + 'px';\n        imageResizer.topLeftRect.style.left = (left - 5) + 'px';\n        imageResizer.topLeftRect.style.top = (top - 4) + 'px';\n        imageResizer.topMiddleRect.style.left = ((parseFloat(imageResizer.topLeftRect.style.left) + (width / 2)) - 4) + 'px';\n        imageResizer.topMiddleRect.style.top = (top - 4) + 'px';\n        imageResizer.bottomRightRect.style.left = imageResizer.topRightRect.style.left;\n        imageResizer.bottomRightRect.style.top = (parseFloat(imageResizer.topRightRect.style.top) + height) + 'px';\n        imageResizer.bottomLeftRect.style.left = imageResizer.topLeftRect.style.left;\n        imageResizer.bottomLeftRect.style.top = (parseFloat(imageResizer.topLeftRect.style.top) + height) + 'px';\n        imageResizer.bottomMiddleRect.style.left = imageResizer.topMiddleRect.style.left;\n        imageResizer.bottomMiddleRect.style.top = (parseFloat(imageResizer.topMiddleRect.style.top) + height) + 'px';\n        imageResizer.rightMiddleRect.style.left = ((left + width) - 4) + 'px';\n        imageResizer.rightMiddleRect.style.top = (parseFloat(imageResizer.topRightRect.style.top) + (height / 2)) + 'px';\n        imageResizer.leftMiddleRect.style.left = imageResizer.topLeftRect.style.left;\n        imageResizer.leftMiddleRect.style.top = (parseFloat(imageResizer.topLeftRect.style.top) + (height / 2)) + 'px';\n        imageResizer.topRightRectParent.style.left = !this.viewer.isTouchInput ? ((left + width) - 8) + 'px' : ((left + width) - 15) + 'px';\n        imageResizer.topRightRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.topLeftRectParent.style.left = !this.viewer.isTouchInput ? (left - 8) + 'px' : (left - 15) + 'px';\n        imageResizer.topLeftRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.topMiddleRectParent.style.left = ((parseFloat(imageResizer.topLeftRectParent.style.left) + (width / 2)) - 4) + 'px';\n        imageResizer.topMiddleRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.bottomRightRectParent.style.left = imageResizer.topRightRectParent.style.left;\n        imageResizer.bottomRightRectParent.style.top = (parseFloat(imageResizer.topRightRectParent.style.top) + height) + 'px';\n        imageResizer.bottomLeftRectParent.style.left = imageResizer.topLeftRectParent.style.left;\n        imageResizer.bottomLeftRectParent.style.top = (parseFloat(imageResizer.topLeftRectParent.style.top) + height) + 'px';\n        imageResizer.bottomMiddleRectParent.style.left = imageResizer.topMiddleRectParent.style.left;\n        imageResizer.bottomMiddleRectParent.style.top = (parseFloat(imageResizer.topMiddleRectParent.style.top) + height) + 'px';\n        // tslint:disable-next-line:max-line-length \n        imageResizer.rightMiddleRectParent.style.left = !this.viewer.isTouchInput ? ((left + width) - 7) + 'px' : ((left + width) - 15) + 'px';\n        imageResizer.rightMiddleRectParent.style.top = (parseFloat(imageResizer.topRightRectParent.style.top) + (height / 2)) + 'px';\n        imageResizer.leftMiddleRectParent.style.left = imageResizer.topLeftRectParent.style.left;\n        imageResizer.leftMiddleRectParent.style.top = (parseFloat(imageResizer.topLeftRectParent.style.top) + (height / 2)) + 'px';\n        this.setImageResizingPoints(imageResizer);\n        if (this.viewer.isTouchInput) {\n            this.applyPropertiesForTouch();\n        }\n        else {\n            this.applyPropertiesForMouse();\n        }\n    };\n    /**\n     * Sets the image resizing points.\n     * @param {ImageResizer} imageResizer - Specifies for position of each resizing elements.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizingPoints = function (imageResizer) {\n        this.imageResizerPoints.resizeContainerDiv.x = parseFloat(imageResizer.resizeContainerDiv.style.left);\n        this.imageResizerPoints.resizeContainerDiv.y = parseFloat(imageResizer.resizeContainerDiv.style.top);\n        this.imageResizerPoints.bottomLeftRectParent.x = parseFloat(imageResizer.bottomLeftRectParent.style.left);\n        this.imageResizerPoints.bottomLeftRectParent.y = parseFloat(imageResizer.bottomLeftRectParent.style.top);\n        this.imageResizerPoints.bottomRightRectParent.x = parseFloat(imageResizer.bottomRightRectParent.style.left);\n        this.imageResizerPoints.bottomRightRectParent.y = parseFloat(imageResizer.bottomRightRectParent.style.top);\n        this.imageResizerPoints.bottomMiddleRectParent.x = parseFloat(imageResizer.bottomMiddleRectParent.style.left);\n        this.imageResizerPoints.bottomMiddleRectParent.y = parseFloat(imageResizer.bottomMiddleRectParent.style.top);\n        this.imageResizerPoints.topLeftRectParent.x = parseFloat(imageResizer.topLeftRectParent.style.left);\n        this.imageResizerPoints.topLeftRectParent.y = parseFloat(imageResizer.topLeftRectParent.style.top);\n        this.imageResizerPoints.topRightRectParent.x = parseFloat(imageResizer.topRightRectParent.style.left);\n        this.imageResizerPoints.topRightRectParent.y = parseFloat(imageResizer.topRightRectParent.style.top);\n        this.imageResizerPoints.topMiddleRectParent.x = parseFloat(imageResizer.topMiddleRectParent.style.left);\n        this.imageResizerPoints.topMiddleRectParent.y = parseFloat(imageResizer.topMiddleRectParent.style.top);\n        this.imageResizerPoints.leftMiddleRectParent.x = parseFloat(imageResizer.leftMiddleRectParent.style.left);\n        this.imageResizerPoints.leftMiddleRectParent.y = parseFloat(imageResizer.leftMiddleRectParent.style.top);\n        this.imageResizerPoints.rightMiddleRectParent.x = parseFloat(imageResizer.rightMiddleRectParent.style.left);\n        this.imageResizerPoints.rightMiddleRectParent.y = parseFloat(imageResizer.rightMiddleRectParent.style.top);\n    };\n    /**\n     * Initialize the resize container div element.\n     * @param {ImageResizer} imageResizer - Specifies for creating resize container div element.\n     * @private\n     */\n    ImageResizer.prototype.initResizeContainerDiv = function (imageResizer) {\n        imageResizer.resizeContainerDiv = document.createElement('div');\n        imageResizer.resizeContainerDiv.id = this.viewer.owner.containerId + '_ResizeDivElement';\n        imageResizer.resizeContainerDiv.style.position = 'absolute';\n        imageResizer.resizeContainerDiv.style.border = '1px solid #bfbfbf';\n        imageResizer.resizeContainerDiv.style.zIndex = '30';\n        imageResizer.resizeContainerDiv.style.backgroundColor = 'transparent';\n        imageResizer.resizeContainerDiv.style.display = 'block';\n    };\n    /**\n     * Apply the properties of each resize rectangle element.\n     * @param {HTMLDivElement} resizeRectElement - Specifies for applying properties to resize rectangle element.\n     * @private\n     */\n    ImageResizer.prototype.applyProperties = function (resizeRectElement) {\n        resizeRectElement.style.position = 'absolute';\n        resizeRectElement.style.width = '8px';\n        resizeRectElement.style.height = '8px';\n        resizeRectElement.style.fontSize = '0px';\n        resizeRectElement.style.zIndex = ' 551';\n        resizeRectElement.style.backgroundColor = '#ffffff';\n        resizeRectElement.style.border = '1px solid #bfbfbf';\n        resizeRectElement.style.boxShadow = '0 1px 2px 0 #bfbfbf 0.35';\n        resizeRectElement.style.color = '#000000';\n    };\n    /**\n     * Handles an image resizing.\n     * @param {number} x  - Specifies for left value while resizing.\n     * @param {number} y - Specifies for top value while resizing.\n     */\n    ImageResizer.prototype.handleImageResizing = function (touchPoint, prevX, prevY) {\n        prevX = prevX / this.viewer.zoomFactor;\n        prevY = prevY / this.viewer.zoomFactor;\n        this.leftValue = isNullOrUndefined(this.leftValue) ? prevX : this.leftValue;\n        this.topValue = isNullOrUndefined(this.topValue) ? prevY : this.topValue;\n        var points;\n        switch (this.selectedResizeElement.id.split('_')[1]) {\n            case 'TopRightRectParent':\n                points = this.topRightResizing(touchPoint);\n                prevX = points.left;\n                prevY = points.top;\n                break;\n            case 'TopLeftRectParent':\n                points = this.topLeftResizing(touchPoint);\n                prevX = -points.left;\n                prevY = -points.top;\n                break;\n            case 'TopMiddleRectParent':\n                prevX = 0;\n                prevY = this.topMiddleResizing(touchPoint);\n                break;\n            case 'BottomRightRectParent':\n                points = this.bottomRightResizing(touchPoint);\n                prevX = points.left;\n                prevY = points.top;\n                break;\n            case 'BottomLeftRectParent':\n                points = this.bottomLeftResizing(touchPoint);\n                prevX = -points.left;\n                prevY = -points.top;\n                break;\n            case 'BottomMiddleRectParent':\n                prevY = touchPoint.y - prevY;\n                prevX = 0;\n                break;\n            case 'RightMiddleRectParent':\n                prevX = touchPoint.x - prevX;\n                prevY = 0;\n                break;\n            case 'LeftMiddleRectParent':\n                prevX = this.leftMiddleResizing(touchPoint);\n                prevY = 0;\n                break;\n            default:\n                break;\n        }\n        if (prevX !== 0 || prevY !== 0) {\n            var widget = this.currentImageElementBox.line.paragraph;\n            var image = this.currentImageElementBox;\n            if (!isNullOrUndefined(widget) && widget.isInsideTable) {\n                var cellWidget = widget.containerWidget;\n                if (!isNullOrUndefined(cellWidget)) {\n                    var rowWidget = cellWidget.containerWidget;\n                    var imageHeight = HelperMethods.convertPointToPixel(image.height);\n                    var widgetHeight = rowWidget.height - imageHeight;\n                    if (prevY > 0 && rowWidget.y + widgetHeight + imageHeight + prevY > this.viewer.clientArea.bottom) {\n                        this.isImageMoveToNextPage = true;\n                    }\n                }\n            }\n            // tslint:disable-next-line:max-line-length \n            if (this.owner.enableHistoryMode) {\n                this.initHistoryForImageResizer(this.currentImageElementBox);\n            }\n            if (!isNullOrUndefined(this.currentImageElementBox)) {\n                // tslint:disable-next-line:max-line-length   \n                var width = this.currentImageElementBox.width + prevX > 10 ? this.currentImageElementBox.width + prevX : 10;\n                // tslint:disable-next-line:max-line-length \n                var height = this.currentImageElementBox.height + prevY > 10 ? this.currentImageElementBox.height + prevY : 10;\n                if (this.selectedResizeElement.id.split('_')[1] === 'BottomRightRectParent'\n                    || this.selectedResizeElement.id.split('_')[1] === 'TopRightRectParent'\n                    || this.selectedResizeElement.id.split('_')[1] === 'BottomLeftRectParent'\n                    || this.selectedResizeElement.id.split('_')[1] === 'TopLeftRectParent') {\n                    height = this.currentImageElementBox.height / this.currentImageElementBox.width * width;\n                    width = this.currentImageElementBox.width / this.currentImageElementBox.height * height;\n                }\n                this.currentImageElementBox.width = width;\n                this.currentImageElementBox.height = height;\n                var owner = this.currentImageElementBox.line.paragraph;\n                this.positionImageResizer(this.currentImageElementBox);\n            }\n            this.isImageResizing = true;\n        }\n    };\n    /**\n     * Handles image resizing on mouse.\n     * @param {MouseEvent} event - Specifies for image resizing using mouse event.\n     * @private\n     */\n    ImageResizer.prototype.handleImageResizingOnMouse = function (event) {\n        if (!isNullOrUndefined(this.selectedResizeElement)) {\n            var prevX = parseFloat(this.selectedResizeElement.style.left);\n            var prevY = parseFloat(this.selectedResizeElement.style.top);\n            var cursorPoint = new Point(event.offsetX, event.offsetY);\n            var touchPoint = this.viewer.findFocusedPage(cursorPoint, true);\n            this.handleImageResizing(touchPoint, prevX, prevY);\n        }\n    };\n    ImageResizer.prototype.topMiddleResizing = function (touchPoint) {\n        var prevY;\n        if (this.topValue >= touchPoint.y) {\n            prevY = this.topValue / touchPoint.y;\n            this.topValue = touchPoint.y;\n            if (this.viewer instanceof PageLayoutViewer) {\n                if (this.topValue <= this.viewer.pageGap) {\n                    prevY = 1;\n                }\n            }\n        }\n        else {\n            prevY = -(touchPoint.y / this.topValue);\n            this.topValue = touchPoint.y;\n            if (this.topValue === 0) {\n                prevY = -1;\n            }\n        }\n        return prevY;\n    };\n    ImageResizer.prototype.leftMiddleResizing = function (touchPoint) {\n        var prevX;\n        if (this.leftValue >= touchPoint.x) {\n            prevX = this.leftValue / touchPoint.x;\n            this.leftValue = touchPoint.x;\n            if (this.leftValue === 0) {\n                prevX = 1;\n                this.leftValue = parseFloat(this.selectedResizeElement.style.left);\n            }\n        }\n        else {\n            prevX = -(touchPoint.x / this.leftValue);\n            this.leftValue = touchPoint.x;\n        }\n        return prevX;\n    };\n    ImageResizer.prototype.topRightResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue <= touchPoint.x && this.topValue >= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.topLeftResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue >= touchPoint.x && this.topValue >= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.bottomRightResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue <= touchPoint.x && this.topValue <= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.bottomLeftResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue >= touchPoint.x && this.topValue <= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.getOuterResizingPoint = function (touchPoint) {\n        var prevX;\n        var prevY;\n        prevX = touchPoint.x - this.leftValue;\n        this.leftValue = touchPoint.x;\n        prevY = touchPoint.y - this.topValue;\n        this.topValue = touchPoint.y;\n        return { left: prevX, top: prevY };\n    };\n    ImageResizer.prototype.getInnerResizingPoint = function (touchPoint) {\n        var prevX;\n        var prevY;\n        prevX = -(this.leftValue - touchPoint.x);\n        this.leftValue = touchPoint.x;\n        prevY = -(this.topValue - touchPoint.y);\n        this.topValue = touchPoint.y;\n        return { left: prevX, top: prevY };\n    };\n    /**\n     * Handles image resizing on touch.\n     * @param {TouchEvent} touchEvent - Specifies for image resizing using touch event.\n     * @private\n     */\n    ImageResizer.prototype.handleImageResizingOnTouch = function (touchEvent) {\n        if (!isNullOrUndefined(this.selectedResizeElement)) {\n            var prevX = parseFloat(this.selectedResizeElement.style.left) + 24;\n            var prevY = parseFloat(this.selectedResizeElement.style.top) + 24;\n            var touch = touchEvent.touches;\n            var cursorPoint = new Point(touch[0].clientX, touch[0].clientY);\n            var touchPoint = this.viewer.findFocusedPage(cursorPoint, true);\n            if (isNullOrUndefined(this.currentImageElementBox) || isNullOrUndefined(this.currentImageElementBox)) {\n                return;\n            }\n            this.handleImageResizing(touchPoint, prevX, prevY);\n        }\n    };\n    /**\n     * Gets the image point of mouse.\n     * @param {Point} touchPoint - Specifies for resizer cursor position.\n     * @private\n     */\n    ImageResizer.prototype.getImagePoint = function (touchPoint) {\n        var x = this.viewer.render.getScaledValue(touchPoint.x, 1);\n        var y = this.viewer.render.getScaledValue(touchPoint.y, 2);\n        touchPoint = new Point(x, y);\n        var imageResizingPoints = this.imageResizerPoints;\n        var resizePosition = '';\n        var selectedElement = undefined;\n        var bottomMiddle = imageResizingPoints.bottomMiddleRectParent;\n        var bottomRight = imageResizingPoints.bottomRightRectParent;\n        var bottomLeft = imageResizingPoints.bottomLeftRectParent;\n        var topMiddle = imageResizingPoints.topMiddleRectParent;\n        var topRight = imageResizingPoints.topRightRectParent;\n        var topLeft = imageResizingPoints.topLeftRectParent;\n        var rightMiddle = imageResizingPoints.rightMiddleRectParent;\n        var leftMiddle = imageResizingPoints.leftMiddleRectParent;\n        if (!isNullOrUndefined(this.bottomMiddleRectParent) && this.bottomMiddleRectParent.style.display !== 'none') {\n            // tslint:disable-next-line:max-line-length   \n            if ((touchPoint.x > bottomMiddle.x && touchPoint.x <= bottomMiddle.x + 15) && (touchPoint.y > bottomMiddle.y && touchPoint.y <= bottomMiddle.y + 15)) {\n                selectedElement = this.bottomMiddleRectParent;\n                resizePosition = 's-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > bottomRight.x && touchPoint.x <= bottomRight.x + 15) && (touchPoint.y > bottomRight.y && touchPoint.y <= bottomRight.y + 15)) {\n                selectedElement = this.bottomRightRectParent;\n                resizePosition = 'se-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > bottomLeft.x && touchPoint.x <= bottomLeft.x + 15) && (touchPoint.y > bottomLeft.y && touchPoint.y <= bottomLeft.y + 15)) {\n                selectedElement = this.bottomLeftRectParent;\n                resizePosition = 'sw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topMiddle.x && touchPoint.x <= topMiddle.x + 15) && (touchPoint.y > topMiddle.y && touchPoint.y <= topMiddle.y + 15)) {\n                selectedElement = this.topMiddleRectParent;\n                resizePosition = 'n-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topRight.x && touchPoint.x <= topRight.x + 15) && (touchPoint.y > topRight.y && touchPoint.y <= topRight.y + 15)) {\n                selectedElement = this.topRightRectParent;\n                resizePosition = 'ne-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topLeft.x && touchPoint.x <= topLeft.x + 15) && (touchPoint.y > topLeft.y && touchPoint.y <= topLeft.y + 15)) {\n                selectedElement = this.topLeftRectParent;\n                resizePosition = 'nw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > leftMiddle.x && touchPoint.x <= leftMiddle.x + 15) && (touchPoint.y > leftMiddle.y && touchPoint.y <= leftMiddle.y + 15)) {\n                selectedElement = this.leftMiddleRectParent;\n                resizePosition = 'w-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > rightMiddle.x && touchPoint.x <= rightMiddle.x + 15) && (touchPoint.y > rightMiddle.y && touchPoint.y <= rightMiddle.y + 15)) {\n                selectedElement = this.rightMiddleRectParent;\n                resizePosition = 'e-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if (!isNullOrUndefined(this.resizeContainerDiv) && (touchPoint.x > parseFloat(this.resizeContainerDiv.style.left)\n                && touchPoint.x <= (parseFloat(this.resizeContainerDiv.style.left) + parseFloat(this.resizeContainerDiv.style.width)))\n                && (touchPoint.y > parseFloat(this.resizeContainerDiv.style.top)\n                    // tslint:disable-next-line:max-line-length \n                    && touchPoint.y <= (parseFloat(this.resizeContainerDiv.style.top) + parseFloat(this.resizeContainerDiv.style.height)))) {\n                resizePosition = 'move';\n            }\n        }\n        return { 'selectedElement': selectedElement, 'resizePosition': resizePosition };\n    };\n    ImageResizer.prototype.applyPropertiesForMouse = function () {\n        if (!isNullOrUndefined(this.bottomLeftRectParent)) {\n            this.bottomMiddleRectParent.style.width = '14px';\n            this.bottomMiddleRectParent.style.height = '14px';\n            this.bottomRightRectParent.style.width = '14px';\n            this.bottomRightRectParent.style.height = '14px';\n            this.bottomLeftRectParent.style.width = '14px';\n            this.bottomLeftRectParent.style.height = '14px';\n            this.topMiddleRectParent.style.width = '14px';\n            this.topMiddleRectParent.style.height = '14px';\n            this.topRightRectParent.style.width = '14px';\n            this.topRightRectParent.style.height = '14px';\n            this.topLeftRectParent.style.width = '14px';\n            this.topLeftRectParent.style.height = '14px';\n            this.leftMiddleRectParent.style.width = '14px';\n            this.leftMiddleRectParent.style.height = '14px';\n            this.rightMiddleRectParent.style.width = '14px';\n            this.rightMiddleRectParent.style.height = '14px';\n        }\n    };\n    /**\n     * Gets the image point of touch.\n     * @param {Point} touchPoints - Specifies for resizer cursor position.\n     * @private\n     */\n    ImageResizer.prototype.getImagePointOnTouch = function (touchPoints) {\n        var x = this.viewer.render.getScaledValue(touchPoints.x, 1);\n        var y = this.viewer.render.getScaledValue(touchPoints.y, 2);\n        touchPoints = new Point(x, y);\n        var imageResizingPointsOnTouch = this.imageResizerPoints;\n        var resizePosition = '';\n        var selectedElements = undefined;\n        var bottomMiddle = imageResizingPointsOnTouch.bottomMiddleRectParent;\n        var bottomRight = imageResizingPointsOnTouch.bottomRightRectParent;\n        var bottomLeft = imageResizingPointsOnTouch.bottomLeftRectParent;\n        var topMiddle = imageResizingPointsOnTouch.topMiddleRectParent;\n        var topRight = imageResizingPointsOnTouch.topRightRectParent;\n        var topLeft = imageResizingPointsOnTouch.topLeftRectParent;\n        var rightMiddle = imageResizingPointsOnTouch.rightMiddleRectParent;\n        var leftMiddle = imageResizingPointsOnTouch.leftMiddleRectParent;\n        if (!isNullOrUndefined(this.bottomMiddleRectParent) && this.bottomMiddleRectParent.style.display !== 'none') {\n            // tslint:disable-next-line:max-line-length   \n            if ((touchPoints.x > bottomMiddle.x && touchPoints.x <= bottomMiddle.x + 25) && (touchPoints.y > bottomMiddle.y && touchPoints.y <= bottomMiddle.y + 25)) {\n                selectedElements = this.bottomMiddleRectParent;\n                resizePosition = 's-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > bottomRight.x && touchPoints.x <= bottomRight.x + 25) && (touchPoints.y > bottomRight.y && touchPoints.y <= bottomRight.y + 25)) {\n                selectedElements = this.bottomRightRectParent;\n                resizePosition = 'se-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > bottomLeft.x && touchPoints.x <= bottomLeft.x + 25) && (touchPoints.y > bottomLeft.y && touchPoints.y <= bottomLeft.y + 25)) {\n                selectedElements = this.bottomLeftRectParent;\n                resizePosition = 'sw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topMiddle.x && touchPoints.x <= topMiddle.x + 25) && (touchPoints.y > topMiddle.y && touchPoints.y <= topMiddle.y + 25)) {\n                selectedElements = this.topMiddleRectParent;\n                resizePosition = 'n-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topRight.x && touchPoints.x <= topRight.x + 25) && (touchPoints.y > topRight.y && touchPoints.y <= topRight.y + 25)) {\n                selectedElements = this.topRightRectParent;\n                resizePosition = 'ne-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topLeft.x && touchPoints.x <= topLeft.x + 25) && (touchPoints.y > topLeft.y && touchPoints.y <= topLeft.y + 25)) {\n                selectedElements = this.topLeftRectParent;\n                resizePosition = 'nw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > leftMiddle.x && touchPoints.x <= leftMiddle.x + 25) && (touchPoints.y > leftMiddle.y && touchPoints.y <= leftMiddle.y + 25)) {\n                selectedElements = this.leftMiddleRectParent;\n                resizePosition = 'w-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > rightMiddle.x && touchPoints.x <= rightMiddle.x + 25) && (touchPoints.y > rightMiddle.y && touchPoints.y <= rightMiddle.y + 25)) {\n                selectedElements = this.rightMiddleRectParent;\n                resizePosition = 'e-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if (!isNullOrUndefined(this.resizeContainerDiv) && (touchPoints.x > parseFloat(this.resizeContainerDiv.style.left)\n                && touchPoints.x <= (parseFloat(this.resizeContainerDiv.style.left) + parseFloat(this.resizeContainerDiv.style.width)))\n                && (touchPoints.y > parseFloat(this.resizeContainerDiv.style.top)\n                    // tslint:disable-next-line:max-line-length \n                    && touchPoints.y <= (parseFloat(this.resizeContainerDiv.style.top) + parseFloat(this.resizeContainerDiv.style.height)))) {\n                resizePosition = 'move';\n            }\n        }\n        return { 'selectedElement': selectedElements, 'resizePosition': resizePosition };\n    };\n    ImageResizer.prototype.applyPropertiesForTouch = function () {\n        if (!isNullOrUndefined(this.bottomLeftRectParent)) {\n            this.bottomMiddleRectParent.style.width = '30px';\n            this.bottomMiddleRectParent.style.height = '30px';\n            this.bottomRightRectParent.style.width = '30px';\n            this.bottomRightRectParent.style.height = '30px';\n            this.bottomLeftRectParent.style.width = '30px';\n            this.bottomLeftRectParent.style.height = '30px';\n            this.topMiddleRectParent.style.width = '30px';\n            this.topMiddleRectParent.style.height = '30px';\n            this.topRightRectParent.style.width = '30px';\n            this.topRightRectParent.style.height = '30px';\n            this.topLeftRectParent.style.width = '30px';\n            this.topLeftRectParent.style.height = '30px';\n            this.leftMiddleRectParent.style.width = '30px';\n            this.leftMiddleRectParent.style.height = '30px';\n            this.rightMiddleRectParent.style.width = '30px';\n            this.rightMiddleRectParent.style.height = '30px';\n        }\n    };\n    /**\n     * @private\n     */\n    ImageResizer.prototype.mouseUpInternal = function () {\n        this.currentImageElementBox.width = parseFloat(this.imageResizerDiv.style.width) / this.viewer.zoomFactor;\n        this.currentImageElementBox.height = parseFloat(this.imageResizerDiv.style.height) / this.viewer.zoomFactor;\n        this.owner.isShiftingEnabled = true;\n        this.owner.editorModule.setOffsetValue(this.owner.selection);\n        this.viewer.layout.reLayoutParagraph(this.currentImageElementBox.line.paragraph, 0, 0);\n        this.owner.editorModule.reLayout(this.owner.selection, true);\n        this.viewer.updateScrollBars();\n    };\n    /**\n     * Initialize history for image resizer.\n     * @param {ImageResizer} imageResizer - Specifies for image resizer.\n     * @param {WImage} imageContainer - Specifies for an image.\n     * @private\n     */\n    ImageResizer.prototype.initHistoryForImageResizer = function (imageContainer) {\n        if (!isNullOrUndefined(this.owner) && isNullOrUndefined(this.baseHistoryInfo)) {\n            this.baseHistoryInfo = new BaseHistoryInfo(this.owner);\n            this.baseHistoryInfo.action = 'ImageResizing';\n            this.baseHistoryInfo.updateSelection();\n            this.baseHistoryInfo.modifiedProperties.push(new ImageFormat(imageContainer));\n        }\n    };\n    /**\n     * Updates histroy for image resizer.\n     * @private\n     */\n    ImageResizer.prototype.updateHistoryForImageResizer = function () {\n        if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.baseHistoryInfo)) {\n            var imageFormat = this.baseHistoryInfo.modifiedProperties[0];\n            if (this.currentImageElementBox.width === imageFormat.width\n                && this.currentImageElementBox.height === imageFormat.height) {\n                this.baseHistoryInfo.modifiedProperties.pop();\n            }\n            else {\n                //Records the image size modifications\n                this.owner.editorHistory.recordChanges(this.baseHistoryInfo);\n            }\n            //Fires the content changed event for the image size modifications\n            this.baseHistoryInfo = undefined;\n        }\n    };\n    /**\n     * Updates image resize container when applying zooming\n     * @private\n     */\n    ImageResizer.prototype.updateImageResizerPosition = function () {\n        if (!isNullOrUndefined(this.currentImageElementBox)) {\n            var elementBox = this.currentImageElementBox;\n            var lineWidget = elementBox.line;\n            var top_1 = this.viewer.selection.getTop(lineWidget) + elementBox.margin.top;\n            var left = this.viewer.selection.getLeftInternal(lineWidget, elementBox, 0);\n            var topValue = top_1 * this.viewer.zoomFactor;\n            var leftValue = left * this.viewer.zoomFactor;\n            var height = this.viewer.render.getScaledValue(elementBox.height, 2);\n            var width = this.viewer.render.getScaledValue(elementBox.width, 1);\n            this.setImageResizerPosition(leftValue, topValue, width, height, this);\n        }\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    ImageResizer.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.imageResizerDiv)) {\n            this.imageResizerDiv.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.selectedImageWidget)) {\n            this.selectedImageWidget.destroy();\n        }\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.innerHTML = '';\n        }\n        this.imageResizerDivElement = undefined;\n        this.resizeContainerDiv = undefined;\n        this.topLeftRect = undefined;\n        this.topMiddleRect = undefined;\n        this.topRightRect = undefined;\n        this.bottomLeftRect = undefined;\n        this.bottomMiddleRect = undefined;\n        this.bottomRightRect = undefined;\n        this.leftMiddleRect = undefined;\n        this.rightMiddleRect = undefined;\n        this.imageResizerDiv = undefined;\n        this.selectedImageWidget = undefined;\n        this.isImageResizing = false;\n        this.isImageResizerVisible = false;\n        this.currentImageElementBoxIn = undefined;\n        //this.baseHistoryInfo = undefined;\n        this.resizeMarkSizeIn = undefined;\n        this.viewer = undefined;\n        this.owner = undefined;\n    };\n    return ImageResizer;\n}());\nexport { ImageResizer };\n/**\n * @private\n */\nvar ImageResizingPoints = /** @class */ (function () {\n    /**\n     * Constructor for image resizing points class.\n     */\n    function ImageResizingPoints() {\n        /**\n         * @private\n         */ this.resizeContainerDiv = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topLeftRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topRightRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomLeftRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomRightRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.leftMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.rightMiddleRectParent = new Point(0, 0);\n        var text = 'DocumentEditor';\n    }\n    return ImageResizingPoints;\n}());\nexport { ImageResizingPoints };\n/**\n * @private\n */\nvar SelectedImageInfo = /** @class */ (function () {\n    /**\n     * Constructor for selected image info class.\n     * @param {number} height - Specifies for height value.\n     * @param {number} width - Specifies for width value.\n     */\n    function SelectedImageInfo(height, width) {\n        this.heightIn = 0;\n        this.widthIn = 0;\n        this.heightIn = height;\n        this.widthIn = width;\n    }\n    Object.defineProperty(SelectedImageInfo.prototype, \"height\", {\n        /**\n         * Gets or Sets the height value.\n         * @private\n         */\n        get: function () {\n            return this.heightIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.heightIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectedImageInfo.prototype, \"width\", {\n        /**\n         * Gets or Sets the width value.\n         * @private\n         */\n        get: function () {\n            return this.widthIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.widthIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SelectedImageInfo;\n}());\nexport { SelectedImageInfo };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { BaseHistoryInfo } from './base-history-info';\n/**\n * EditorHistory preservation class\n */\n/**\n * @private\n */\nvar HistoryInfo = /** @class */ (function (_super) {\n    __extends(HistoryInfo, _super);\n    function HistoryInfo(node, isChild) {\n        var _this = _super.call(this, node) || this;\n        _this.isChildHistoryInfo = false;\n        _this.isChildHistoryInfo = isChild;\n        return _this;\n    }\n    Object.defineProperty(HistoryInfo.prototype, \"hasAction\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return !isNullOrUndefined(this.modifiedActions);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Adds the modified actions\n     * @param  {BaseHistoryInfo} baseHistoryInfo\n     * @private\n     */\n    HistoryInfo.prototype.addModifiedAction = function (baseHistoryInfo) {\n        // For complex actions such as Replace text, Insert/Remove Hyperlink etc.\n        if (!(this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n            if (isNullOrUndefined(this.modifiedActions)) {\n                this.modifiedActions = [];\n            }\n            this.modifiedActions.push(baseHistoryInfo);\n        }\n    };\n    /**\n     * Reverts this instance\n     * @private\n     */\n    HistoryInfo.prototype.revert = function () {\n        this.editorHistory.currentHistoryInfo = this;\n        if (this.action === 'BordersAndShading') {\n            this.owner.editorModule.isBordersAndShadingDialog = true;\n        }\n        if (!isNullOrUndefined(this.modifiedActions)) {\n            if (this.editorHistory.isUndoing) {\n                var i = this.modifiedActions.length;\n                while (i > 0) {\n                    var baseHistoryInfo = this.modifiedActions[i - 1];\n                    baseHistoryInfo.revert();\n                    i = i - 1;\n                }\n            }\n            else {\n                var i = 0;\n                while (i < this.modifiedActions.length) {\n                    var baseHistoryInfo = this.modifiedActions[i];\n                    baseHistoryInfo.revert();\n                    i = i + 1;\n                }\n            }\n        }\n        if (!this.isChildHistoryInfo) {\n            this.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n    };\n    /**\n     * @private\n     */\n    HistoryInfo.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.modifiedActions)) {\n            while (this.modifiedActions.length > 0) {\n                var baseHistoryInfo = this.modifiedActions[this.modifiedActions.length - 1];\n                baseHistoryInfo.destroy();\n                this.modifiedActions.splice(this.modifiedActions.indexOf(baseHistoryInfo), 1);\n            }\n            this.modifiedActions = undefined;\n        }\n        _super.prototype.destroy.call(this);\n    };\n    return HistoryInfo;\n}(BaseHistoryInfo));\nexport { HistoryInfo };\n","import { Dictionary } from '../../base/dictionary';\nimport { TextPosition } from '../selection/selection-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { BaseHistoryInfo, } from './base-history-info';\nimport { ModifiedParagraphFormat, ModifiedLevel, RowHistoryFormat, TableHistoryInfo } from './history-helper';\nimport { HistoryInfo } from './history-info';\nimport { WParagraphFormat } from '../format/paragraph-format';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n *  `EditorHistory` Module class is used to handle history preservation\n */\nvar EditorHistory = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function EditorHistory(node) {\n        //Fields\n        this.undoStackIn = [];\n        this.redoStackIn = [];\n        this.historyInfoStack = [];\n        /**\n         * @private\n         */\n        this.isUndoing = false;\n        /**\n         * @private\n         */\n        this.isRedoing = false;\n        this.owner = node;\n        this.viewer = node.viewer;\n        this.modifiedParaFormats = new Dictionary();\n        this.undoLimitIn = 500;\n        this.redoLimitIn = 500;\n    }\n    Object.defineProperty(EditorHistory.prototype, \"currentHistoryInfo\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.historyInfoStack && this.historyInfoStack.length > 0 ?\n                this.historyInfoStack[this.historyInfoStack.length - 1] : undefined;\n        },\n        set: function (value) {\n            if (value instanceof HistoryInfo) {\n                this.historyInfoStack.push(value);\n            }\n            else {\n                this.historyInfoStack.pop();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"undoStack\", {\n        //Properties\n        /**\n         * gets undo stack\n         * @private\n         */\n        get: function () { return this.undoStackIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"redoStack\", {\n        /**\n         * gets redo stack\n         * @private\n         */\n        get: function () { return this.redoStackIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"undoLimit\", {\n        /**\n         * Gets or Sets the limit of undo operations can be done.\n         */\n        get: function () {\n            return isNullOrUndefined(this.undoLimitIn) ? 0 : this.undoLimitIn;\n        },\n        set: function (value) {\n            if (value < 0) {\n                throw new Error('The limit should be greater than or equal to zero.');\n            }\n            this.undoLimitIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"redoLimit\", {\n        /**\n         * Gets or Sets the limit of redo operations can be done.\n         */\n        get: function () {\n            return isNullOrUndefined(this.redoLimitIn) ? 0 : this.redoLimitIn;\n        },\n        set: function (value) {\n            if (value < 0) {\n                throw new Error('The limit should be greater than or equal to zero.');\n            }\n            this.redoLimitIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    EditorHistory.prototype.getModuleName = function () {\n        return 'EditorHistory';\n    };\n    /**\n     * Determines whether undo operation can be done.\n     * @returns boolean\n     */\n    EditorHistory.prototype.canUndo = function () {\n        return !isNullOrUndefined(this.undoStack) && this.undoStack.length > 0;\n    };\n    /**\n     * Determines whether redo operation can be done.\n     * @returns boolean\n     */\n    EditorHistory.prototype.canRedo = function () {\n        return !isNullOrUndefined(this.redoStack) && this.redoStack.length > 0;\n    };\n    //EditorHistory Initialization    \n    /**\n     * initialize EditorHistory\n     * @param  {Selection} selection\n     * @param  {Action} action\n     * @param  {SelectionRange} selectionRange\n     * @private\n     */\n    EditorHistory.prototype.initializeHistory = function (action) {\n        this.currentBaseHistoryInfo = new BaseHistoryInfo(this.owner);\n        this.currentBaseHistoryInfo.action = action;\n        this.currentBaseHistoryInfo.updateSelection();\n    };\n    /**\n     * Initialize complex history\n     * @param  {Selection} selection\n     * @param  {Action} action\n     * @private\n     */\n    EditorHistory.prototype.initComplexHistory = function (selection, action) {\n        this.currentHistoryInfo = new HistoryInfo(selection.owner, !isNullOrUndefined(this.currentHistoryInfo));\n        this.currentHistoryInfo.action = action;\n        this.currentHistoryInfo.updateSelection();\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.initResizingHistory = function (startingPoint, tableResize) {\n        if (tableResize.resizeNode === 1) {\n            this.initializeHistory('RowResizing');\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                // tslint:disable-next-line:max-line-length\n                this.currentBaseHistoryInfo.modifiedProperties.push(new RowHistoryFormat(startingPoint, tableResize.currentResizingTable.childWidgets[tableResize.resizerPosition].rowFormat));\n            }\n        }\n        else {\n            this.initializeHistory('CellResizing');\n            if (this.currentBaseHistoryInfo) {\n                tableResize.currentResizingTable = tableResize.currentResizingTable.combineWidget(this.viewer);\n                var tableHistoryInfo = new TableHistoryInfo(tableResize.currentResizingTable, this.owner);\n                tableHistoryInfo.startingPoint = startingPoint;\n                this.currentBaseHistoryInfo.modifiedProperties.push(tableHistoryInfo);\n            }\n        }\n    };\n    /**\n     * Update resizing history\n     * @param  {Point} point\n     * @param  {Selection} selection\n     * @private\n     */\n    EditorHistory.prototype.updateResizingHistory = function (point, tableResize) {\n        if (tableResize.resizeNode === 1) {\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                var rowHistoryFormat = this.currentBaseHistoryInfo.modifiedProperties[0];\n                if (rowHistoryFormat.startingPoint.y === point.y) {\n                    this.currentBaseHistoryInfo.modifiedProperties.length = 0;\n                }\n                else {\n                    rowHistoryFormat.displacement = HelperMethods.convertPixelToPoint(point.y - rowHistoryFormat.startingPoint.y);\n                    this.recordChanges(this.currentBaseHistoryInfo);\n                    this.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n        else {\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                var cellHistoryFormat = this.currentBaseHistoryInfo.modifiedProperties[0];\n                if (cellHistoryFormat.startingPoint.x === point.x) {\n                    this.currentBaseHistoryInfo.modifiedProperties.length = 0;\n                }\n                else {\n                    cellHistoryFormat.displacement = HelperMethods.convertPixelToPoint(point.x - cellHistoryFormat.startingPoint.x);\n                    cellHistoryFormat.endIndex = tableResize.getCellReSizerPosition(point);\n                    this.owner.editorHistory.recordChanges(this.currentBaseHistoryInfo);\n                    this.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n    };\n    /**\n     * Record the changes\n     * @param  {BaseHistoryInfo} baseHistoryInfo\n     * @private\n     */\n    EditorHistory.prototype.recordChanges = function (baseHistoryInfo) {\n        if (!this.owner.enableHistoryMode) {\n            return;\n        }\n        if (this.isUndoing) {\n            if (isNullOrUndefined(this.redoStack)) {\n                this.redoStackIn = [];\n            }\n            if (this.redoStack.length === this.redoLimit && this.redoLimit > 0) {\n                var count = this.undoLimit > 20 ? 10 : 1;\n                this.redoStackIn.splice(0, count);\n            }\n            if (this.redoStack.length < this.redoLimit) {\n                this.redoStack.push(baseHistoryInfo);\n            }\n        }\n        else {\n            if (!this.isRedoing) {\n                this.clearRedoStack();\n            }\n            if (isNullOrUndefined(this.undoStack)) {\n                this.undoStackIn = [];\n            }\n            if (this.undoStack.length === this.undoLimit && this.undoLimit > 0) {\n                var count = this.undoLimit > 20 ? 10 : 1;\n                this.undoStackIn.splice(0, count);\n            }\n            if (this.undoStack.length < this.undoLimit) {\n                this.undoStackIn.push(baseHistoryInfo);\n            }\n        }\n    };\n    /**\n     * update EditorHistory\n     * @private\n     */\n    EditorHistory.prototype.updateHistory = function () {\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.currentBaseHistoryInfo)) {\n            //Updates the current end position\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)\n                && isNullOrUndefined(this.currentBaseHistoryInfo.endPosition)) {\n                this.currentBaseHistoryInfo.endPosition = this.currentBaseHistoryInfo.insertPosition;\n            }\n            if (!isNullOrUndefined(this.currentHistoryInfo)) {\n                this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo);\n            }\n            else {\n                this.recordChanges(this.currentBaseHistoryInfo);\n            }\n            this.currentBaseHistoryInfo = undefined;\n        }\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.isHandledComplexHistory = function () {\n        var isHandledComplexHistory = false;\n        if (!(this.isUndoing || this.isRedoing)) {\n            isHandledComplexHistory = this.owner.editorModule.insertRemoveBookMarkElements();\n        }\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.currentHistoryInfo)) {\n            this.updateHistory();\n            isHandledComplexHistory = true;\n        }\n        else if (this.owner.editorModule.isHandledComplex) {\n            isHandledComplexHistory = true;\n        }\n        return isHandledComplexHistory;\n    };\n    /**\n     * Update complex history\n     * @private\n     */\n    EditorHistory.prototype.updateComplexHistory = function () {\n        var selection = this.viewer.selection;\n        if (this.currentHistoryInfo.hasAction) {\n            if (this.currentHistoryInfo.action === 'AutoFormatHyperlink') {\n                var startPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(startPosition, this.currentHistoryInfo.insertPosition);\n                // this.reLayoutParagraph(startPosition.paragraph, 0);\n                if (selection.owner.editorHistory.isUndoing) {\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.start, this.currentHistoryInfo.selectionStart);\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.end, this.currentHistoryInfo.selectionEnd);\n                }\n                else {\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.start, this.currentHistoryInfo.endPosition);\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.end, this.currentHistoryInfo.endPosition);\n                }\n            }\n            if (this.currentHistoryInfo.action === 'InsertHyperlink') {\n                var startPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(startPosition, this.currentHistoryInfo.insertPosition);\n                var endPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(endPosition, this.currentHistoryInfo.endPosition);\n                this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n                if (endPosition.paragraph !== startPosition.paragraph) {\n                    this.viewer.layout.reLayoutParagraph(endPosition.paragraph, 0, 0);\n                }\n            }\n            if (this.currentHistoryInfo.action === 'ReplaceAll') {\n                this.owner.editorModule.layoutWholeDocument();\n            }\n            else if (selection.owner.isShiftingEnabled) {\n                this.viewer.layout.shiftLayoutedItems();\n                if (this.owner.enableHeaderAndFooter) {\n                    this.owner.editorModule.updateHeaderFooterWidget();\n                }\n                this.viewer.removeEmptyPages();\n            }\n        }\n        selection.owner.isShiftingEnabled = false;\n        selection.owner.isLayoutEnabled = true;\n        // // selection.addMultipleSelectionRanges();\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        this.viewer.updateScrollBars();\n        selection.fireSelectionChanged(true);\n        this.viewer.updateFocus();\n        this.updateComplexHistoryInternal();\n        this.owner.editorModule.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.updateComplexHistoryInternal = function () {\n        if (!isNullOrUndefined(this.currentHistoryInfo)) {\n            //Updates the current end position\n            if (isNullOrUndefined(this.currentHistoryInfo.endPosition)) {\n                this.currentHistoryInfo.endPosition = this.currentHistoryInfo.insertPosition;\n            }\n            if (this.historyInfoStack.length > 1) {\n                var historyInfo = this.historyInfoStack[this.historyInfoStack.length - 2];\n                historyInfo.addModifiedAction(this.currentHistoryInfo);\n            }\n            else {\n                this.recordChanges(this.currentHistoryInfo);\n            }\n            this.currentHistoryInfo = undefined;\n        }\n    };\n    //List history preservation undo API\n    /**\n     * update list changes for history preservation\n     * @param  {Selection} selection\n     * @param  {WAbstractList} currentAbstractList\n     * @param  {WList} list\n     * @private\n     */\n    EditorHistory.prototype.updateListChangesInHistory = function (currentAbstractList, list) {\n        this.currentBaseHistoryInfo = new BaseHistoryInfo(this.viewer.owner);\n        this.currentBaseHistoryInfo.action = 'List';\n        this.currentBaseHistoryInfo.updateSelection();\n        var collection = new Dictionary();\n        for (var i = 0; i < currentAbstractList.levels.length; i++) {\n            var levels = this.viewer.getAbstractListById(list.abstractListId).levels[i];\n            var value = this.currentBaseHistoryInfo.addModifiedPropertiesForList(levels);\n            var modifiedLevel = new ModifiedLevel(levels, currentAbstractList.levels[i]);\n            if (!isNullOrUndefined(levels)) {\n                this.viewer.owner.editorModule.copyListLevel(levels, currentAbstractList.levels[i]);\n            }\n            collection.add(i, modifiedLevel);\n        }\n        return collection;\n    };\n    /**\n     * Apply list changes\n     * @param  {Selection} selection\n     * @param  {Dictionary<number, ModifiedLevel>} modifiedLevelsInternal\n     * @private\n     */\n    EditorHistory.prototype.applyListChanges = function (selection, modifiedLevelsInternal) {\n        if (isNullOrUndefined(this.modifiedParaFormats)) {\n            this.modifiedParaFormats = new Dictionary();\n        }\n        var collection = [];\n        for (var i = 0; i < this.viewer.listParagraphs.length; i++) {\n            var paragraph = this.viewer.listParagraphs[i];\n            var paraFormat = paragraph.paragraphFormat;\n            var currentList = this.viewer.getListById(paraFormat.listFormat.listId);\n            var listLevel = this.viewer.layout.getListLevel(currentList, paraFormat.listFormat.listLevelNumber);\n            // tslint:disable-next-line:max-line-length\n            if (modifiedLevelsInternal.containsKey(paraFormat.listFormat.listLevelNumber)\n                && modifiedLevelsInternal.get(paraFormat.listFormat.listLevelNumber).ownerListLevel === listLevel) {\n                var modifiedFormat = new WParagraphFormat(null);\n                modifiedFormat.leftIndent = paraFormat.leftIndent;\n                modifiedFormat.firstLineIndent = paraFormat.firstLineIndent;\n                var modified = new ModifiedParagraphFormat(paraFormat, modifiedFormat);\n                collection.push(modified);\n                this.owner.editorModule.copyFromListLevelParagraphFormat(paraFormat, listLevel.paragraphFormat);\n            }\n        }\n        this.modifiedParaFormats.add(this.currentBaseHistoryInfo, collection);\n    };\n    /**\n     * Update list changes\n     * @param  {Dictionary<number, ModifiedLevel>} modifiedCollection\n     * @param  {Selection} selection\n     * @private\n     */\n    EditorHistory.prototype.updateListChanges = function (modifiedCollection) {\n        this.viewer.owner.isLayoutEnabled = false;\n        this.owner.editorModule.updateListParagraphs();\n        for (var i = 0; i < modifiedCollection.keys.length; i++) {\n            var levelNumber = modifiedCollection.keys[0];\n            var modifiedLevel = modifiedCollection.get(levelNumber);\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                // tslint:disable-next-line:max-line-length\n                modifiedLevel = this.currentBaseHistoryInfo.addModifiedPropertiesForList(modifiedLevel.ownerListLevel);\n            }\n            this.owner.editorModule.copyListLevel(modifiedLevel.ownerListLevel, modifiedLevel.modifiedListLevel);\n        }\n        this.revertListChanges();\n        this.viewer.owner.isLayoutEnabled = true;\n        this.viewer.renderedLists.clear();\n        this.viewer.pages = [];\n        this.viewer.layout.layout();\n        var selection = this.viewer.selection;\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        selection.fireSelectionChanged(false);\n        this.updateHistory();\n    };\n    /**\n     * Revert list changes\n     * @param  {Selection} selection\n     */\n    EditorHistory.prototype.revertListChanges = function () {\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.currentBaseHistoryInfo)\n            && this.viewer.owner.editorHistory.modifiedParaFormats.containsKey(this.currentBaseHistoryInfo)) {\n            // tslint:disable-next-line:max-line-length\n            var collection = this.modifiedParaFormats.get(this.currentBaseHistoryInfo);\n            for (var i = 0; i < collection.length; i++) {\n                var modified = new WParagraphFormat(null);\n                modified.leftIndent = collection[i].ownerFormat.leftIndent;\n                modified.firstLineIndent = collection[i].ownerFormat.firstLineIndent;\n                collection[i].ownerFormat.copyFormat(collection[i].modifiedFormat);\n                collection[i].modifiedFormat.leftIndent = modified.leftIndent;\n                collection[i].modifiedFormat.firstLineIndent = modified.firstLineIndent;\n            }\n        }\n    };\n    /**\n     * Reverts the last editing action.\n     */\n    EditorHistory.prototype.undo = function () {\n        if (this.owner.isReadOnlyMode || !this.canUndo() || !this.owner.enableHistoryMode) {\n            return;\n        }\n        //this.owner.ClearTextSearchResults();\n        var historyInfo = this.undoStack.pop();\n        this.isUndoing = true;\n        historyInfo.revert();\n        this.isUndoing = false;\n        this.owner.selection.checkForCursorVisibility();\n        this.owner.editorModule.isBordersAndShadingDialog = false;\n    };\n    /**\n     * Performs the last reverted action.\n     */\n    EditorHistory.prototype.redo = function () {\n        if (this.owner.isReadOnlyMode || !this.canRedo() || !this.owner.enableHistoryMode) {\n            return;\n        }\n        //this.owner.ClearTextSearchResults();\n        var historyInfo = this.redoStack.pop();\n        if (historyInfo.action === 'BordersAndShading') {\n            this.owner.editorModule.isBordersAndShadingDialog = true;\n        }\n        this.isRedoing = true;\n        historyInfo.revert();\n        this.isRedoing = false;\n        this.owner.selection.checkForCursorVisibility();\n        this.owner.editorModule.isBordersAndShadingDialog = false;\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.destroy = function () {\n        this.clearHistory();\n        this.undoStackIn = undefined;\n        this.redoStackIn = undefined;\n    };\n    EditorHistory.prototype.clearHistory = function () {\n        this.clearUndoStack();\n        this.clearRedoStack();\n    };\n    EditorHistory.prototype.clearUndoStack = function () {\n        if (this.canUndo()) {\n            while (this.undoStack.length > 0) {\n                var historyInfo = this.undoStack.pop();\n                historyInfo.destroy();\n                historyInfo = undefined;\n            }\n        }\n    };\n    EditorHistory.prototype.clearRedoStack = function () {\n        if (this.canRedo()) {\n            while (this.redoStack.length > 0) {\n                var historyInfo = this.redoStack.pop();\n                historyInfo.destroy();\n                historyInfo = undefined;\n            }\n        }\n    };\n    return EditorHistory;\n}());\nexport { EditorHistory };\n","import { ZipArchive, ZipArchiveItem } from '@syncfusion/ej2-compression';\nimport { XmlWriter } from '@syncfusion/ej2-file-utils';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../index';\n/**\n * Exports the document to Word format.\n */\nvar WordExport = /** @class */ (function () {\n    function WordExport() {\n        //Part path\n        this.documentPath = 'word/document.xml';\n        this.stylePath = 'word/styles.xml';\n        this.numberingPath = 'word/numbering.xml';\n        this.settingsPath = 'word/settings.xml';\n        this.headerPath = 'word/header';\n        this.footerPath = 'word/footer';\n        //private commentsPath: string = 'word/comments.xml';\n        this.imagePath = 'word/media/image';\n        // private footnotesPath: string = 'word/footnotes.xml';\n        // private endnotesPath: string = 'word/endnotes.xml';\n        this.appPath = 'docProps/app.xml';\n        this.corePath = 'docProps/core.xml';\n        // private CustomPath: string = 'docProps/custom.xml';\n        // private FontTablePath: string = 'word/fontTable.xml';\n        this.contentTypesPath = '[Content_Types].xml';\n        // private ChartsPath: string = 'word/charts/';\n        // private DefaultEmbeddingPath: string = 'word/embeddings/';\n        // private EmbeddingPath:string = 'word\\embeddings\\';\n        // private DrawingPath:string = 'word\\drawings\\';\n        // private ThemePath: string = 'word/theme/theme1.xml';\n        // private FontsPath:string = 'word\\fonts\\';\n        // private DiagramPath:string = \"word/diagrams/';\n        // private ControlPath:string = \"word/activeX/';\n        // private VbaProject: string = 'vbaProject.bin';\n        // private VbaData: string = 'vbaData.xml';\n        // private VbaProjectPath: string = 'word/vbaProject.bin';\n        // private VbaDataPath: string = 'word/vbaData.xml';\n        // private CustomXMLPath:string = 'customXml\\';\n        //Relationship path\n        this.generalRelationPath = '_rels/.rels';\n        this.wordRelationPath = 'word/_rels/document.xml.rels';\n        // private FontRelationPath: string = 'word/_rels/fontTable.xml.rels';\n        // private CommentsRelationPath: string = 'word/_rels/comments.xml.rels';\n        // private FootnotesRelationPath: string = 'word/_rels/footnotes.xml.rels';\n        // private EndnotesRelationPath: string = 'word/_rels/endnotes.xml.rels';\n        // private NumberingRelationPath: string = 'word/_rels/numbering.xml.rels';\n        this.headerRelationPath = 'word/_rels/header';\n        this.footerRelationPath = 'word/_rels/footer';\n        // private SettingsRelationpath: string = 'word/_rels/settings.xml.rels';\n        // private VbaProjectRelsPath: string = 'word/_rels/vbaProject.bin.rels';\n        //Content type of the parts\n        this.xmlContentType = 'application/xml';\n        this.fontContentType = 'application/vnd.openxmlformats-officedocument.obfuscatedFont';\n        this.documentContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml';\n        // private TemplateContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml';\n        // private CommentsContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml';\n        this.settingsContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml';\n        // private EndnoteContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml';\n        // private FontTableContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml';\n        this.footerContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml';\n        // private FootnoteContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml';\n        // private GlossaryDocumentContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml';\n        this.headerContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml';\n        this.numberingContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml';\n        this.stylesContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml';\n        this.webSettingsContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml';\n        this.appContentType = 'application/vnd.openxmlformats-officedocument.extended-properties+xml';\n        this.coreContentType = 'application/vnd.openxmlformats-package.core-properties+xml';\n        this.customContentType = 'application/vnd.openxmlformats-officedocument.custom-properties+xml';\n        this.customXmlContentType = 'application/vnd.openxmlformats-officedocument.customXmlProperties+xml';\n        this.relationContentType = 'application/vnd.openxmlformats-package.relationships+xml';\n        // private DiagramColor: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml';\n        // private DiagramData: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml';\n        // private DiagramLayout: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml';\n        // private DiagramStyle: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml';\n        // private ChartsContentType: string = 'application/vnd.openxmlformats-officedocument.drawingml.chart+xml';\n        // private ThemeContentType: string = 'application/vnd.openxmlformats-officedocument.theme+xml';\n        // private ChartDrawingContentType: string = 'application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml';\n        // private ActiveXContentType: string = 'application/vnd.ms-office.activeX+xml';\n        // private ActiveXBinContentType: string = 'application/vnd.ms-office.activeX';\n        this.tableStyleContentType = 'application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml';\n        // private ChartStyleContentType: string = 'application/vnd.ms-office.chartstyle+xml';\n        // private ChartColorStyleContentType: string = 'application/vnd.ms-office.chartcolorstyle+xml';\n        // private VbaProjectContentType: string = 'application/vnd.ms-office.vbaProject';\n        // private VbaDataContentType: string = 'application/vnd.ms-word.vbaData+xml';\n        // private MacroDocumentContentType: string = 'application/vnd.ms-word.document.macroEnabled.main+xml';\n        // private MacroTemplateContentType: string = 'application/vnd.ms-word.template.macroEnabledTemplate.main+xml';\n        // private OleObjectContentType: string = 'application/vnd.openxmlformats-officedocument.oleObject';\n        // Relationship types of document parts\n        // private AltChunkRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk';\n        // private CommentsRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments';\n        this.settingsRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings';\n        // private EndnoteRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes';\n        // private FontTableRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable';\n        this.footerRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer';\n        // private FootnoteRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes';\n        this.headerRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/header';\n        this.documentRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument';\n        this.numberingRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering';\n        this.stylesRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles';\n        // private OleObjectRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject';\n        // private ChartRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart';\n        // private ThemeRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme';\n        this.fontRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/font';\n        this.tableStyleRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles';\n        this.coreRelType = 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties';\n        this.appRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties';\n        this.customRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties';\n        this.imageRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image';\n        this.hyperlinkRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink';\n        this.controlRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/control';\n        this.packageRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package';\n        // private VbaProjectRelType: string = 'http://schemas.microsoft.com/office/2006/relationships/vbaProject';\n        // private VbaDataRelType: string = 'http://schemas.microsoft.com/office/2006/relationships/wordVbaData';\n        this.customXmlRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml';\n        this.customUIRelType = 'http://schemas.microsoft.com/office/2006/relationships/ui/extensibility';\n        this.attachedTemplateRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate';\n        // private ChartColorStyleRelType: string = 'http://schemas.microsoft.com/office/2011/relationships/chartColorStyle';\n        // private ChartStyleRelType: string = 'http://schemas.microsoft.com/office/2011/relationships/chartStyle';\n        // private ChartUserShapesRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartUserShapes';\n        // private ChartContentType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package';\n        // Namespaces\n        // private PKG_namespace: string = 'http://schemas.microsoft.com/office/2006/xmlPackage';\n        this.wNamespace = 'http://schemas.openxmlformats.org/wordprocessingml/2006/main';\n        this.wpNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing';\n        this.pictureNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/picture';\n        this.aNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/main';\n        this.a14Namespace = 'http://schemas.microsoft.com/office/drawing/2010/main';\n        // private SVG_namespace: string = 'http://schemas.microsoft.com/office/drawing/2016/SVG/main';\n        this.rNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships';\n        this.rpNamespace = 'http://schemas.openxmlformats.org/package/2006/relationships';\n        this.vNamespace = 'urn:schemas-microsoft-com:vml';\n        this.oNamespace = 'urn:schemas-microsoft-com:office:office';\n        this.xmlNamespace = 'http://www.w3.org/XML/1998/namespace';\n        this.w10Namespace = 'urn:schemas-microsoft-com:office:word';\n        this.cpNamespace = 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties';\n        this.dcNamespace = 'http://purl.org/dc/elements/1.1/';\n        // private DCTERMS_namespace: string = 'http://purl.org/dc/terms/';\n        // private XSI_namespace: string = 'http://www.w3.org/2001/XMLSchema-instance';\n        this.docPropsNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties';\n        this.veNamespace = 'http://schemas.openxmlformats.org/markup-compatibility/2006';\n        this.mNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/math';\n        this.wneNamespace = 'http://schemas.microsoft.com/office/word/2006/wordml';\n        // private DCMI_namespace: string = 'http://purl.org/dc/dcmitype/';\n        this.customPropsNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/custom-properties';\n        this.vtNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes';\n        this.chartNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/chart';\n        this.slNamespace = 'http://schemas.openxmlformats.org/schemaLibrary/2006/main';\n        //2003WML namespace\n        // private amlNamespace: string = 'http://schemas.microsoft.com/aml/2001/core';\n        this.dtNamespace = 'uuid:C2F41010-65B3-11d1-A29F-00AA00C14882';\n        this.wmlNamespace = 'http://schemas.microsoft.com/office/word/2003/wordml';\n        //2010 namespaces\n        this.w14Namespace = 'http://schemas.microsoft.com/office/word/2010/wordml';\n        this.wpCanvasNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas';\n        this.wpDrawingNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing';\n        this.wpGroupNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingGroup';\n        this.wpInkNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingInk';\n        this.wpShapeNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingShape';\n        //2013 namespaces\n        this.w15Namespace = 'http://schemas.microsoft.com/office/word/2012/wordml';\n        this.diagramNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/diagram';\n        //Encryption namespaces\n        this.eNamespace = 'http://schemas.microsoft.com/office/2006/encryption';\n        this.pNamespace = 'http://schemas.microsoft.com/office/2006/keyEncryptor/password';\n        this.certNamespace = 'http://schemas.microsoft.com/office/2006/keyEncryptor/certificate';\n        // Dls xml tags\n        this.cRelationshipsTag = 'Relationships';\n        this.cRelationshipTag = 'Relationship';\n        this.cIdTag = 'Id';\n        this.cTypeTag = 'Type';\n        this.cTargetTag = 'Target';\n        this.cUserShapesTag = 'userShapes';\n        this.cExternalData = 'externalData';\n        this.twipsInOnePoint = 20;\n        this.twentiethOfPoint = 20;\n        this.borderMultiplier = 8;\n        this.percentageFactor = 50;\n        this.emusPerPoint = 12700;\n        // private const TOC_SYMBOL:string = (char)0x01;\n        // private const FOOTNOTE_SYMBOL:string = (char)0x02;\n        // private const PAGENUMBER_SYMBOL:string = (char)0xB;\n        // private DEF_FIT_TEXT_TO_SHAPE: string = 'mso-fit-shape-to-text:t';\n        // Document tags\n        this.cConditionalTableStyleTag = 'tblStylePr';\n        this.cTableFormatTag = 'tblPr';\n        this.cTowFormatTag = 'trPr';\n        this.cCellFormatTag = 'tcPr';\n        this.cParagraphFormatTag = 'pPr';\n        this.cCharacterFormatTag = 'rPr';\n        this.packageType = 'http://schemas.microsoft.com/office/2006/xmlPackage';\n        this.relsPartPath = '/_rels/.rels';\n        this.documentRelsPartPath = '/word/_rels/document.xml.rels';\n        this.webSettingsPath = '/word/webSettings.xml';\n        this.wordMLDocumentPath = '/word/document.xml';\n        this.wordMLStylePath = '/word/styles.xml';\n        this.wordMLNumberingPath = '/word/numbering.xml';\n        this.wordMLSettingsPath = '/word/settings.xml';\n        this.wordMLHeaderPath = '/word/header';\n        this.wordMLFooterPath = '/word/footer';\n        this.wordMLCommentsPath = '/word/comments.xml';\n        this.wordMLImagePath = '/word/media/image';\n        this.wordMLFootnotesPath = '/word/footnotes.xml';\n        this.wordMLEndnotesPath = '/word/endnotes.xml';\n        this.wordMLAppPath = '/docProps/app.xml';\n        this.wordMLCorePath = '/docProps/core.xml';\n        this.wordMLCustomPath = '/docProps/custom.xml';\n        this.wordMLFontTablePath = '/word/fontTable.xml';\n        this.wordMLChartsPath = '/word/charts/';\n        this.wordMLDefaultEmbeddingPath = '/word/embeddings/';\n        this.wordMLEmbeddingPath = '/word/embeddings/';\n        this.wordMLDrawingPath = '/word/drawings/';\n        this.wordMLThemePath = '/word/theme/theme1.xml';\n        this.wordMLFontsPath = '/word/fonts/';\n        this.wordMLDiagramPath = '/word/diagrams/';\n        this.wordMLControlPath = '/word/activeX/';\n        this.wordMLVbaProject = '/vbaProject.bin';\n        this.wordMLVbaData = '/vbaData.xml';\n        this.wordMLVbaProjectPath = '/word/vbaProject.bin';\n        this.wordMLVbaDataPath = '/word/vbaData.xml';\n        // private WordMLCustomXMLPath: string = '/customXml/';\n        this.wordMLWebSettingsPath = '/word/webSettings.xml';\n        this.wordMLCustomItemProp1Path = '/customXml/itemProps1.xml';\n        // private WordMLCustomXMLRelPath: string = '/customXml/_rels/item1.xml.rels';\n        this.wordMLFootnoteRelPath = '/word/_rels/footnotes.xml.rels';\n        this.wordMLEndnoteRelPath = '/word/_rels/endnotes.xml.rels';\n        this.wordMLSettingsRelPath = '/word/_rels/settings.xml.rels';\n        this.wordMLNumberingRelPath = '/word/_rels/numbering.xml.rels';\n        this.wordMLFontTableRelPath = '/word/_rels/fontTable.xml.rels';\n        this.wordMLCustomXmlPropsRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps';\n        this.wordMLControlRelType = 'http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary';\n        this.wordMLDiagramContentType = 'application/vnd.ms-office.drawingml.diagramDrawing+xml';\n        this.lastSection = false;\n        this.mRelationShipID = 0;\n        this.mDocPrID = 0;\n        this.mDifferentFirstPage = false;\n        this.mBookmarks = undefined;\n        /* tslint:enable:no-any */\n    }\n    WordExport.prototype.getModuleName = function () {\n        return 'WordExport';\n    };\n    Object.defineProperty(WordExport.prototype, \"bookmarks\", {\n        // Gets the bookmark name\n        get: function () {\n            if (isNullOrUndefined(this.mBookmarks)) {\n                this.mBookmarks = [];\n            }\n            return this.mBookmarks;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"documentImages\", {\n        // Gets the collection of images present in the document body\n        get: function () {\n            if (this.mDocumentImages === undefined) {\n                this.mDocumentImages = new Dictionary();\n            }\n            return this.mDocumentImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"externalImages\", {\n        // Gets the collection of images present in the document body\n        get: function () {\n            if (this.mExternalLinkImages === undefined) {\n                this.mExternalLinkImages = new Dictionary();\n            }\n            return this.mExternalLinkImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"headerFooterImages\", {\n        // Gets the collections of images present in the HeaderFooters\n        get: function () {\n            if (this.mHeaderFooterImages === undefined) {\n                this.mHeaderFooterImages = new Dictionary();\n            }\n            return this.mHeaderFooterImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"headersFooters\", {\n        /// Gets the HeaderFooter Collection\n        get: function () {\n            if (this.mHeaderFooterColl === undefined) {\n                this.mHeaderFooterColl = new Dictionary();\n            }\n            return this.mHeaderFooterColl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    WordExport.prototype.save = function (viewer, fileName) {\n        this.serialize(viewer);\n        this.mArchive.save(fileName + '.docx').then(function (mArchive) {\n            mArchive.destroy();\n        });\n        this.close();\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.saveAsBlob = function (viewer) {\n        var _this = this;\n        this.serialize(viewer);\n        return new Promise(function (resolve, reject) {\n            _this.mArchive.saveAsBlob().then(function (blob) {\n                _this.mArchive.destroy();\n                blob = new Blob([blob], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });\n                resolve(blob);\n            });\n        });\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.destroy = function () {\n        this.clearDocument();\n        this.mRelationShipID = undefined;\n        this.mDocPrID = undefined;\n        this.mDifferentFirstPage = undefined;\n        if (this.mArchive) {\n            this.mArchive.destroy();\n            this.mArchive = undefined;\n        }\n    };\n    // Saves the word document in the stream\n    WordExport.prototype.serialize = function (viewer) {\n        /* tslint:disable:no-any */\n        var document = viewer.owner.sfdtExportModule.write();\n        this.setDocument(document);\n        this.mArchive = new ZipArchive();\n        this.mArchive.compressionLevel = 'Normal';\n        this.mVerticalMerge = new Dictionary();\n        this.mGridSpans = new Dictionary();\n        var contenttype;\n        //document.xml\n        this.serializeDocument();\n        //Styles.xml\n        this.serializeStyles();\n        //numbering.xml\n        this.serializeNumberings();\n        //theme.xml\n        // if (m_document.DocHasThemes && !isNullOrUndefined(m_document.Themes))\n        //     SerializeThemes();\n        // else\n        // this.serializeDefaultThemes();\n        //settings.xml\n        this.serializeSettings();\n        //core.xml\n        this.serializeCoreProperties();\n        //app.xml\n        this.serializeAppProperties();\n        //fontTable.xml\n        this.serializeFontTable(contenttype);\n        //custom.xml\n        // if (!isNullOrUndefined(this.wordDocument.CustomDocumentProperties) && m_document.CustomDocumentProperties.length > 0) {\n        //     SerializeCustomProperties();\n        // }\n        //Settings Relations\n        this.serializeSettingsRelation();\n        //Numbering relation if the document has picture bullet\n        // if (PictureBullets.length > 0) {\n        //     SerializeNumberingsRelation();\n        // }\n        this.serializeHeaderFooters();\n        //document relations\n        this.serializeDocumentRelations();\n        // // Add controls to archieve.\n        // if (ControlsPathNames.length > 0) {\n        //     AddControlsToZip(m_document.DocxPackage);\n        // }\n        // if (!isNullOrUndefined(m_document.CustomUIPartContainer))\n        //     AddPartContainerToArchive(m_document.CustomUIPartContainer);\n        // if (!isNullOrUndefined(m_document.CustomXMLContainer))\n        //     AddPartContainerToArchive(m_document.CustomXMLContainer);\n        //general relations\n        this.serializeGeneralRelations();\n        //[ContentTypes].xml\n        this.serializeContentTypes(contenttype);\n        // Clears the internal fields maintained for serializing.\n        this.clearDocument();\n    };\n    // Sets the document\n    WordExport.prototype.setDocument = function (document) {\n        this.document = document;\n        this.mSections = document.sections;\n        this.mLists = document.lists;\n        this.mAbstractLists = document.abstractLists;\n        this.defCharacterFormat = document.characterFormat;\n        this.defParagraphFormat = document.paragraphFormat;\n        this.defaultTabWidthValue = document.defaultTabWidth;\n        this.mStyles = document.styles;\n    };\n    // Clears the document\n    WordExport.prototype.clearDocument = function () {\n        // Owner Nodes\n        this.section = undefined;\n        this.lastSection = undefined;\n        this.blockOwner = undefined;\n        this.paragraph = undefined;\n        this.table = undefined;\n        this.row = undefined;\n        this.headerFooter = undefined;\n        this.document = undefined;\n        this.mSections = undefined;\n        this.mLists = undefined;\n        this.mAbstractLists = undefined;\n        this.defCharacterFormat = undefined;\n        this.defParagraphFormat = undefined;\n        this.defaultTabWidthValue = undefined;\n        this.mRelationShipID = 0;\n        this.mDocPrID = 0;\n        this.mDifferentFirstPage = false;\n        if (this.mHeaderFooterColl) {\n            this.mHeaderFooterColl.destroy();\n            this.mHeaderFooterColl = undefined;\n        }\n        if (this.mVerticalMerge) {\n            this.mVerticalMerge.destroy();\n            this.mVerticalMerge = undefined;\n        }\n        if (this.mGridSpans) {\n            this.mGridSpans.destroy();\n            this.mGridSpans = undefined;\n        }\n        if (this.mDocumentImages) {\n            this.mDocumentImages.destroy();\n            this.mDocumentImages = undefined;\n        }\n        if (this.mExternalLinkImages) {\n            this.mExternalLinkImages.destroy();\n            this.mExternalLinkImages = undefined;\n        }\n        if (this.mHeaderFooterImages) {\n            this.mHeaderFooterImages.destroy();\n            this.mHeaderFooterImages = undefined;\n        }\n    };\n    // Serializes the document elements (document.xml)\n    WordExport.prototype.serializeDocument = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'document', this.wNamespace);\n        this.writeCommonAttributeStrings(writer);\n        this.serializeDocumentBody(writer);\n        writer.writeEndElement(); //end of document tag\n        var archiveItem = new ZipArchiveItem(writer.buffer, this.documentPath);\n        this.mArchive.addItem(archiveItem);\n    };\n    WordExport.prototype.writeCommonAttributeStrings = function (writer) {\n        writer.writeAttributeString('xmlns', 'wpc', undefined, this.wpCanvasNamespace);\n        this.writeCustom(writer);\n        writer.writeAttributeString('xmlns', 'wp14', undefined, this.wpDrawingNamespace);\n        writer.writeAttributeString('xmlns', 'wp', undefined, this.wpNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'w', undefined, this.wNamespace);\n        this.writeDup(writer);\n        writer.writeAttributeString('xmlns', 'wne', undefined, this.wneNamespace);\n        writer.writeAttributeString('xmlns', 'wps', undefined, this.wpShapeNamespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15 wp14');\n    };\n    WordExport.prototype.writeDup = function (writer) {\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('xmlns', 'wpg', undefined, this.wpGroupNamespace);\n        writer.writeAttributeString('xmlns', 'wpi', undefined, this.wpInkNamespace);\n    };\n    WordExport.prototype.writeCustom = function (writer) {\n        writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n    };\n    // Serializes the document body\n    WordExport.prototype.serializeDocumentBody = function (writer) {\n        writer.writeStartElement(undefined, 'body', this.wNamespace);\n        var count = this.document.sections.length;\n        for (var i = 0; i < count; i++) {\n            this.section = this.document.sections[i];\n            this.lastSection = i === count - 1;\n            this.serializeSection(writer, this.section, i === count - 1);\n            this.section = undefined;\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the Section.\n    WordExport.prototype.serializeSection = function (writer, section, last) {\n        this.blockOwner = section;\n        this.serializeBodyItems(writer, section.blocks, last);\n        if (last) {\n            this.serializeSectionProperties(writer, section);\n        }\n        this.blockOwner = undefined;\n    };\n    // Serialize the section properties.\n    WordExport.prototype.serializeSectionProperties = function (writer, section) {\n        writer.writeStartElement('w', 'sectPr', this.wNamespace);\n        if (section.headersFooters) {\n            this.serializeHFReference(writer, section.headersFooters);\n        }\n        // if (IsNeedToSerializeSectionFootNoteProperties(section))\n        //     SerializeFootnoteProperties(section);\n        // if (IsNeedToSerializeSectionEndNoteProperties(section))\n        //     SerializeEndnoteProperties(section);\n        this.serializeSectionType(writer, 'nextPage');\n        this.serializePageSetup(writer, section.sectionFormat);\n        this.serializeColumns(writer, section);\n        // this.serializeSectionProtection(section);\n        // if (section.PageSetup.VerticalAlignment !== PageAlignment.Top) {\n        //     writer.writeStartElement('vAlign', this.wNamespace);\n        //     switch (section.PageSetup.VerticalAlignment) {\n        //         case PageAlignment.Top:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'top');\n        //             break;\n        //         case PageAlignment.Middle:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'center');\n        //             break;\n        //         case PageAlignment.Justified:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'both');\n        //             break;\n        //         case PageAlignment.Bottom:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'bottom');\n        //             break;\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        if (section.sectionFormat !== undefined && section.sectionFormat.differentFirstPage) {\n            writer.writeStartElement(undefined, 'titlePg', this.wNamespace);\n            writer.writeEndElement();\n        }\n        // SerializeTextDirection(section);\n        // if (section.PageSetup.Bidi) {\n        //     writer.WriteStartElement('bidi', this.wNamespace);\n        //     writer.WriteEndElement();\n        // }\n        //rtlGutter\n        // SerializeDocGrid(section);\n        //printerSettings\n        writer.writeEndElement(); //end of sectPr tag\n    };\n    // Serialize the column properties of section.\n    WordExport.prototype.serializeColumns = function (writer, section) {\n        writer.writeStartElement(undefined, 'cols', this.wNamespace);\n        writer.writeAttributeString(undefined, 'equalWidth', this.wNamespace, '1');\n        writer.writeAttributeString(undefined, 'space', this.wNamespace, '0');\n        writer.writeEndElement();\n        // ColumnCollection columns = section.Columns;\n        // writer.WriteStartElement('cols', this.wNamespace);\n        // if (columns.length > 0)\n        // {\n        //     writer.WriteAttributeString('num', this.wNamespace, columns.length.ToString());\n        // }\n        // if (section.PageSetup.DrawLinesBetweenCols)\n        //     writer.WriteAttributeString('sep', this.wNamespace, '1');\n        // if (columns.OwnerSection.PageSetup.EqualColumnWidth)\n        // {\n        //     writer.WriteAttributeString('equalWidth', this.wNamespace, '1');\n        //     //When the column count is negative, MS word just reset the column's count to zero\n        //     //To avoid index out of exception, checked the columns count\n        // tslint:disable-next-line:max-line-length\n        //     writer.WriteAttributeString('space', this.wNamespace, ToString(columns.length > 0 ? columns[0].Space * this.TwentiethOfPoint : 0));\n        // }\n        // else if (columns.length > 0)\n        // {\n        //     writer.WriteAttributeString('equalWidth', this.wNamespace, '0');\n        //     foreach (Column column in columns)\n        //     {\n        //         writer.WriteStartElement('col', this.wNamespace);\n        //         writer.WriteAttributeString('w', this.wNamespace, ToString(column.Width * this.TwentiethOfPoint));\n        // tslint:disable-next-line:max-line-length\n        //         writer.WriteAttributeString('space', this.wNamespace, ToString(column.Space * this.TwentiethOfPoint));\n        //         writer.WriteEndElement();\n        //     }\n        // }\n        // writer.WriteEndElement();\n    };\n    // Serialize the page setup properties.\n    WordExport.prototype.serializePageSetup = function (writer, pageSetup) {\n        if (pageSetup !== undefined) {\n            this.serializePageSize(writer, pageSetup);\n            this.serializePageMargins(writer, pageSetup);\n        }\n        // // StartElement paperSrc (if any)\n        // if (pageSetup.FirstPageTray > 0 || pageSetup.OtherPagesTray > 0) {\n        //     writer.WriteStartElement('paperSrc', this.wNamespace);\n        //     if (pageSetup.FirstPageTray > 0) {\n        //         writer.WriteAttributeString('first', this.wNamespace, pageSetup.FirstPageTray.ToString());\n        //     }\n        //     if (pageSetup.OtherPagesTray > 0) {\n        //         writer.WriteAttributeString('other', this.wNamespace, pageSetup.OtherPagesTray.ToString());\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        writer.writeStartElement(undefined, 'pgBorders', this.wNamespace);\n        // //zOrder\n        // if (pageSetup.PageBordersApplyType === PageBordersApplyType.FirstPage)\n        //     writer.WriteAttributeString('display', this.wNamespace, 'firstPage');\n        // else if (pageSetup.PageBordersApplyType === PageBordersApplyType.AllExceptFirstPage)\n        //     writer.WriteAttributeString('display', this.wNamespace, 'notFirstPage');\n        // if (pageSetup.PageBorderOffsetFrom === PageBorderOffsetFrom.PageEdge) {\n        //     writer.WriteAttributeString('offsetFrom', this.wNamespace, 'page');\n        // }\n        // //Serializing zOrder of the front page border\n        // if (!pageSetup.IsFrontPageBorder) {\n        //     writer.WriteAttributeString('zOrder', this.wNamespace, 'back');\n        // }\n        // SerializePageBorders(pageSetup.Borders);\n        writer.writeEndElement();\n        // this.serializeLineNumberType(writer, pageSetup);\n        //this.serializePageNumberType(writer, pageSetup);\n    };\n    // serialize the page size\n    WordExport.prototype.serializePageSize = function (writer, pageSetup) {\n        writer.writeStartElement(undefined, 'pgSz', this.wNamespace);\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(pageSetup.pageWidth * this.twentiethOfPoint).toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'h', this.wNamespace, this.roundToTwoDecimal(pageSetup.pageHeight * this.twentiethOfPoint).toString());\n        // if (pageSetup.Orientation === PageOrientation.Landscape)\n        // {\n        //     writer.WriteAttributeString('orient', this.wNamespace, 'landscape');\n        // }\n        writer.writeEndElement();\n    };\n    // Serialize the border.\n    WordExport.prototype.serializePageMargins = function (writer, pageSetup) {\n        writer.writeStartElement(undefined, 'pgMar', this.wNamespace);\n        var marginValue = Math.round(pageSetup.topMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'top', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.rightMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'right', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.bottomMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'bottom', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.leftMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'left', this.wNamespace, marginValue.toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'header', this.wNamespace, this.roundToTwoDecimal(pageSetup.headerDistance * this.twentiethOfPoint).toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'footer', this.wNamespace, this.roundToTwoDecimal(pageSetup.footerDistance * this.twentiethOfPoint).toString());\n        writer.writeAttributeString(undefined, 'gutter', this.wNamespace, '0');\n        writer.writeEndElement();\n    };\n    // Serialize the section type.\n    WordExport.prototype.serializeSectionType = function (writer, sectionBreakCode) {\n        writer.writeStartElement('w', 'type', this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, sectionBreakCode); //GetSectionBreakCode(sectionBreakCode));\n        writer.writeEndElement();\n    };\n    // Serialize the heeader/footer reference.\n    WordExport.prototype.serializeHFReference = function (writer, headersFooters) {\n        var hfId = '';\n        if (headersFooters !== undefined) {\n            this.mDifferentFirstPage = this.section.sectionFormat.differentOddAndEvenPages;\n            var hf = headersFooters.firstPageHeader;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'first');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'FirstPageHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.firstPageFooter;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'first');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'FirstPageFooter', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.evenHeader;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'even');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'EvenHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.evenFooter;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'even');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'EvenFooter', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.header;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'default');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'OddHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.footer;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'default');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'OddFooter', hfId);\n                writer.writeEndElement();\n            }\n        }\n    };\n    // Adds the header footer details to the collection.\n    WordExport.prototype.addHeaderFooter = function (hf, hfType, id) {\n        var hfColl = new Dictionary();\n        this.headersFooters.add(hfType, hfColl);\n        this.headersFooters.get(hfType).add(id, hf);\n    };\n    // Serializes the bodyItems\n    WordExport.prototype.serializeBodyItems = function (writer, blockCollection, isLastSection) {\n        for (var i = 0; i < blockCollection.length; i++) {\n            this.serializeBodyItem(writer, blockCollection[i], isLastSection);\n        }\n    };\n    // Serialize the TextBody item\n    WordExport.prototype.serializeBodyItem = function (writer, item, isLastSection) {\n        if (isNullOrUndefined(item)) {\n            throw new Error('BodyItem should not be undefined');\n        }\n        if (item.hasOwnProperty('inlines')) {\n            this.paragraph = item;\n            this.serializeParagraph(writer, item, isLastSection);\n            this.paragraph = undefined;\n        }\n        else {\n            var table = item;\n            for (var i = 0; i < table.rows.length; i++) {\n                if (table.rows[i].cells.length > 0) {\n                    this.serializeTable(writer, table);\n                    break;\n                }\n            }\n        }\n    };\n    // Serialize the paragraph\n    WordExport.prototype.serializeParagraph = function (writer, paragraph, isLastSection) {\n        if (isNullOrUndefined(paragraph)) {\n            throw new Error('Paragraph should not be undefined');\n        }\n        var sec = this.blockOwner;\n        //Need to write the Section Properties if the Paragraph is last item in the section\n        if (!isLastSection && sec.hasOwnProperty('sectionFormat')\n            && sec.blocks.indexOf(paragraph) === sec.blocks.length - 1) {\n            writer.writeStartElement('w', 'p', this.wNamespace);\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            this.serializeSectionProperties(writer, sec);\n            writer.writeEndElement();\n            writer.writeEndElement();\n        }\n        // if (paragraph.ParagraphFormat.PageBreakAfter && !IsPageBreakNeedToBeSkipped(paragraph as Entity))\n        //     paragraph.InsertBreak(BreakType.PageBreak);\n        // if (paragraph.ParagraphFormat.ColumnBreakAfter && !IsPageBreakNeedToBeSkipped(paragraph as Entity))\n        //     paragraph.InsertBreak(BreakType.ColumnBreak);\n        //Splits the paragraph based on the newline character\n        // paragraph.SplitTextRange();\n        writer.writeStartElement('w', 'p', this.wNamespace);\n        writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n        this.serializeParagraphFormat(writer, paragraph.paragraphFormat, paragraph);\n        writer.writeEndElement(); //end of pPr\n        // Serialize watermark if paragraph is the first item of Header document.\n        // EnsureWatermark(paragraph);\n        this.serializeParagraphItems(writer, paragraph.inlines);\n        writer.writeEndElement(); //end of paragraph tag.\n    };\n    // Serialize the paragraph items\n    WordExport.prototype.serializeParagraphItems = function (writer, paraItems) {\n        var previousNode = undefined;\n        for (var i = 0; i < paraItems.length; i++) {\n            var item = paraItems[i];\n            if (item.hasOwnProperty('fieldType')) {\n                this.serializeFieldCharacter(writer, item);\n            }\n            else if (item.hasOwnProperty('imageString')) {\n                this.serializePicture(writer, item);\n            }\n            else if (item.hasOwnProperty('bookmarkType')) {\n                this.serializeBookMark(writer, item);\n            }\n            else {\n                this.serializeTextRange(writer, item, previousNode);\n            }\n            previousNode = item;\n        }\n    };\n    // Serialize the book mark\n    WordExport.prototype.serializeBookMark = function (writer, bookmark) {\n        var bookmarkId = this.getBookmarkId(bookmark.name);\n        var bookmarkName = bookmark.name;\n        if (bookmark.bookmarkType === 0) {\n            writer.writeStartElement('w', 'bookmarkStart', this.wNamespace);\n            writer.writeAttributeString('w', 'name', this.wNamespace, bookmarkName);\n        }\n        else if (bookmark.bookmarkType === 1) {\n            writer.writeStartElement('w', 'bookmarkEnd', this.wNamespace);\n        }\n        writer.writeAttributeString('w', 'id', this.wNamespace, bookmarkId.toString());\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getBookmarkId = function (name) {\n        var index = this.bookmarks.indexOf(name);\n        if (index < 0) {\n            index = this.bookmarks.length;\n            this.bookmarks.push(name);\n        }\n        return index;\n    };\n    // Serialize the picture.\n    WordExport.prototype.serializePicture = function (writer, image) {\n        if (image.width >= 0 && image.height >= 0) {\n            writer.writeStartElement(undefined, 'r', this.wNamespace);\n            this.serializeCharacterFormat(writer, image.characterFormat);\n            this.serializeDrawing(writer, image);\n            writer.writeEndElement(); //end of run element\n        }\n    };\n    // Serialize the drawing element.\n    WordExport.prototype.serializeDrawing = function (writer, image) {\n        writer.writeStartElement(undefined, 'drawing', this.wNamespace);\n        this.serializeInlinePicture(writer, image);\n        writer.writeEndElement();\n    };\n    // Serialize the inline picture.\n    WordExport.prototype.serializeInlinePicture = function (writer, image) {\n        writer.writeStartElement(undefined, 'inline', this.wpNamespace);\n        writer.writeStartElement(undefined, 'extent', this.wpNamespace);\n        var cx = Math.round(image.width * this.emusPerPoint);\n        writer.writeAttributeString(undefined, 'cx', undefined, cx.toString());\n        var cy = Math.round(image.height * this.emusPerPoint);\n        writer.writeAttributeString(undefined, 'cy', undefined, cy.toString());\n        writer.writeEndElement();\n        // double borderWidth = (double)picture.PictureShape.PictureDescriptor.BorderLeft.LineWidth / DLSConstants.BorderLineFactor;\n        // if (borderWidth > 0 && picture.DocxProps.length === 0) {\n        //     long leftTop = 0, rightBottom = 0;\n        //     picture.PictureShape.GetEffectExtent(borderWidth, ref leftTop, ref rightBottom);\n        //     m_writer.WriteStartElement('effectExtent', WP_namespace);\n        //     m_writer.WriteAttributeString('l', leftTop.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('t', leftTop.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('r', rightBottom.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('b', rightBottom.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteEndElement();\n        // }\n        //this.serializePicProperties(writer, image);\n        this.serializeDrawingGraphics(writer, image);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.startsWith = function (sourceString, startString) {\n        return startString.length > 0 && sourceString.substring(0, startString.length) === startString;\n    };\n    // Serialize the graphics element for pictures.\n    WordExport.prototype.serializeDrawingGraphics = function (writer, picture) {\n        var id = '';\n        id = this.updateShapeId(picture);\n        // picture.ShapeId = this.getNextDocPrID();\n        // Processing picture\n        writer.writeStartElement('wp', 'docPr', this.wpNamespace);\n        writer.writeAttributeString(undefined, 'id', undefined, (this.mDocPrID++).toString());\n        // if (!isNullOrUndefined(picture.AlternativeText))\n        //     m_writer.WriteAttributeString('descr', picture.AlternativeText);\n        writer.writeAttributeString(undefined, 'name', undefined, '1'.toString());\n        // if (!string.IsNullOrEmpty(picture.Title))\n        //     m_writer.WriteAttributeString('title', picture.Title);\n        // else\n        writer.writeAttributeString(undefined, 'title', undefined, '');\n        // if (!picture.Visible)\n        //     m_writer.WriteAttributeString('hidden', '1');\n        // SerializePictureHyperlink(picture);\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'graphic', this.aNamespace);\n        writer.writeStartElement('a', 'graphicData', this.aNamespace);\n        writer.writeAttributeString(undefined, 'uri', undefined, this.pictureNamespace);\n        writer.writeStartElement('pic', 'pic', this.pictureNamespace);\n        writer.writeStartElement('pic', 'nvPicPr', this.pictureNamespace);\n        writer.writeStartElement('pic', 'cNvPr', this.pictureNamespace);\n        writer.writeAttributeString(undefined, 'id', undefined, '0');\n        writer.writeAttributeString(undefined, 'name', undefined, '');\n        writer.writeAttributeString(undefined, 'descr', undefined, '');\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'cNvPicPr', this.pictureNamespace);\n        writer.writeStartElement('a', 'picLocks', this.aNamespace);\n        writer.writeAttributeString(undefined, 'noChangeAspect', undefined, '1');\n        writer.writeAttributeString(undefined, 'noChangeArrowheads', undefined, '1');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'blipFill', this.pictureNamespace);\n        writer.writeStartElement('a', 'blip', this.aNamespace);\n        if (this.startsWith(picture.imageString, 'data:image')) {\n            writer.writeAttributeString('r', 'embed', this.rNamespace, id);\n        }\n        else {\n            if (this.documentImages.containsKey(id)) {\n                //Remove the image document images collection for this particular key\n                //If the picture image data has href means MS Word contains the image in media folder as well as \n                //it is having external relationship id\n                // if (!this.startsWith(picture.imageString, 'data:image')) {\n                this.documentImages.remove(id);\n                this.externalImages.add(id, picture.imageString);\n                writer.writeAttributeString(undefined, 'link', this.rNamespace, id);\n            }\n        }\n        //End Element Blip\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'srcRect', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'stretch', this.aNamespace);\n        writer.writeStartElement('a', 'fillRect', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'spPr', this.pictureNamespace);\n        writer.writeAttributeString(undefined, 'bwMode', undefined, 'auto');\n        writer.writeStartElement('a', 'xfrm', this.aNamespace);\n        // if (picture.Rotation !== 0)\n        //     m_writer.WriteAttributeString('rot', picture.Rotation.ToString());\n        writer.writeStartElement('a', 'off', this.aNamespace);\n        writer.writeAttributeString(undefined, 'x', undefined, '0');\n        writer.writeAttributeString(undefined, 'y', undefined, '0');\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'ext', this.aNamespace);\n        var cx = Math.round((picture.width * this.emusPerPoint));\n        writer.writeAttributeString(undefined, 'cx', undefined, cx.toString());\n        var cy = Math.round((picture.height * this.emusPerPoint));\n        writer.writeAttributeString(undefined, 'cy', undefined, cy.toString());\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'prstGeom', this.aNamespace);\n        writer.writeAttributeString(undefined, 'prst', undefined, 'rect');\n        writer.writeStartElement('a', 'avLst', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement();\n        //When the picture border has been added next to effect list\n        //if not, Picture border has not been preserved\n        // if (picture.HasBorder)\n        // {\n        //     if (picture.TextWrappingStyle === TextWrappingStyle.Inline && picture.IsShape)\n        //         SerializeInlineShapeLine(picture.PictureShape);\n        //     else\n        //         SerializeShapeLine(picture.PictureShape);\n        // }\n        // if (picture.DocxProps.length > 0)\n        //     SerializeDocxProps(picture.DocxProps, 'effectLst');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n    };\n    /// Update the shape id.\n    WordExport.prototype.updateShapeId = function (picture) {\n        var id = '';\n        var tOwner = this.paragraph;\n        // Adding picture byte data to the corresponding picture collection \n        // depending on its owner subdocument\n        if (this.headerFooter) {\n            id = this.updateHFImageRels(this.headerFooter, picture);\n        }\n        else {\n            if (id === '') {\n                if (tOwner.hasOwnProperty('sectionFormat') || tOwner.hasOwnProperty('inlines')) {\n                    id = this.addImageRelation(this.documentImages, picture);\n                    // if (owner is WFootnote)\n                    // {\n                    //     if ((owner as WFootnote).FootnoteType === FootnoteType.Footnote)\n                    //         id = AddImageRelation(FootnoteImages, picture.ImageRecord);\n                    //     else\n                    //         id = AddImageRelation(EndnoteImages, picture.ImageRecord);\n                    // }\n                    // if (owner is WComment)\n                    //     id = AddImageRelation(CommentImages, picture.ImageRecord);\n                }\n            }\n        }\n        return id;\n    };\n    // Adds the image relation.\n    WordExport.prototype.addImageRelation = function (imageCollection, image) {\n        var relationId = '';\n        // if (imageCollection.ContainsValue(imageRecord)) {\n        //     foreach(string key in imageCollection.keys)\n        //     {\n        //         if (imageRecord === imageCollection[key]) {\n        //             relationId = key;\n        //             break;\n        //         }\n        //     }\n        // }\n        // else {\n        relationId = this.getNextRelationShipID();\n        imageCollection.add(relationId, image);\n        // }\n        return relationId;\n    };\n    // Update the HeaderFooter image relations.\n    WordExport.prototype.updateHFImageRels = function (hf, image) {\n        var id = '';\n        // UpdateImages(image);\n        var headerId = '';\n        var types = this.headersFooters.keys;\n        for (var i = 0; i < types.length; i++) {\n            var hfColl = this.headersFooters.get(types[i]);\n            var hfKeys = hfColl.keys;\n            for (var j = 0; j < hfKeys.length; j++) {\n                if (hfColl.get(hfKeys[j]) === hf) {\n                    headerId = hfKeys[j];\n                    var headerImages = void 0;\n                    if (this.headerFooterImages.containsKey(headerId)) {\n                        headerImages = this.headerFooterImages.get(headerId);\n                        id = this.addImageRelation(headerImages, image);\n                    }\n                    else {\n                        headerImages = new Dictionary();\n                        id = this.addImageRelation(headerImages, image);\n                        this.headerFooterImages.add(headerId, headerImages);\n                    }\n                }\n            }\n        }\n        return id;\n    };\n    // Serialize the table\n    WordExport.prototype.serializeTable = function (writer, table) {\n        if (table.rows.length <= 0) {\n            return;\n        }\n        var owner = this.table;\n        this.table = table;\n        writer.writeStartElement(undefined, 'tbl', this.wNamespace);\n        var tableFormat = table.rows[0].rowFormat;\n        this.serializeTableFormat(writer, tableFormat, table);\n        this.serializeTableGrid(writer, table);\n        this.serializeTableRows(writer, table.rows);\n        writer.writeEndElement();\n        this.table = owner;\n    };\n    // Serialize the table grid\n    WordExport.prototype.serializeTableGrid = function (writer, table) {\n        writer.writeStartElement(undefined, 'tblGrid', this.wNamespace);\n        if (table.grid.length !== 0) {\n            this.serializeGridColumns(writer, table.grid);\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table rows\n    WordExport.prototype.serializeTableRows = function (writer, rows) {\n        if (rows.length > 0) {\n            for (var i = 0; i < rows.length; i++) {\n                var row = rows[i];\n                if (row.cells.length > 0) {\n                    this.serializeRow(writer, row);\n                }\n            }\n        }\n    };\n    // Serialize the table row\n    WordExport.prototype.serializeRow = function (writer, row) {\n        var owner = this.row;\n        this.row = row;\n        writer.writeStartElement(undefined, 'tr', this.wNamespace);\n        this.serializeRowFormat(writer, row);\n        this.serializeCells(writer, row.cells);\n        writer.writeEndElement(); //end od table row 'tr'\n        this.row = owner;\n    };\n    // Serialize the row format\n    WordExport.prototype.serializeRowFormat = function (writer, row) {\n        writer.writeStartElement(undefined, 'trPr', this.wNamespace);\n        //Serialize Row Height\n        if (row.rowFormat.height > 0) {\n            writer.writeStartElement(undefined, 'trHeight', this.wNamespace);\n            if (row.rowFormat.heightType === 'Exactly') {\n                writer.writeAttributeString('w', 'hRule', this.wNamespace, 'exact');\n            }\n            else if (row.rowFormat.heightType === 'AtLeast') {\n                writer.writeAttributeString('w', 'hRule', this.wNamespace, 'atLeast');\n            }\n            var height = this.roundToTwoDecimal(row.rowFormat.height * this.twentiethOfPoint).toString();\n            writer.writeAttributeString('w', 'val', this.wNamespace, height);\n            writer.writeEndElement();\n        }\n        var rowFormat = row.rowFormat;\n        // //Serialize 'gridBefore' element\n        var gridBefore = rowFormat.gridBefore;\n        if (gridBefore > 0) {\n            writer.writeStartElement(undefined, 'gridBefore', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, gridBefore.toString());\n            writer.writeEndElement();\n        }\n        // //Serialize 'gridAfter' element\n        var gridAfter = rowFormat.gridAfter;\n        if (gridAfter > 0) {\n            writer.writeStartElement(undefined, 'gridAfter', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, gridAfter.toString());\n            writer.writeEndElement();\n        }\n        // //Serialize 'wBefore' element \n        if (gridBefore > 0) {\n            writer.writeStartElement(undefined, 'wBefore', this.wNamespace);\n            switch (rowFormat.gridBeforeWidthType) {\n                case 'Percent':\n                    var width = this.roundToTwoDecimal(rowFormat.gridBeforeWidth * this.percentageFactor).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, width);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'pct');\n                    break;\n                case 'Point':\n                    var pointWidth = this.roundToTwoDecimal(rowFormat.gridBeforeWidth * this.twipsInOnePoint).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, pointWidth);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'dxa');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        //Serialize 'wAfter' element\n        if (gridAfter > 0) {\n            writer.writeStartElement(undefined, 'wAfter', this.wNamespace);\n            switch (rowFormat.gridAfterWidthType) {\n                case 'Percent':\n                    var width = this.roundToTwoDecimal(rowFormat.gridAfterWidth * this.percentageFactor).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, width);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'pct');\n                    break;\n                case 'Point':\n                    var pointWidth = this.roundToTwoDecimal(rowFormat.gridAfterWidth * this.twipsInOnePoint).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, pointWidth);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'dxa');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        //Serialize 'cantSplit' element \n        if (!rowFormat.allowBreakAcrossPages) {\n            writer.writeStartElement(undefined, 'cantSplit', this.wNamespace);\n            writer.writeEndElement();\n        }\n        // //Serialize 'tblHeader' element \n        if (rowFormat.isHeader) {\n            writer.writeStartElement(undefined, 'tblHeader', this.wNamespace);\n            writer.writeEndElement();\n        }\n        writer.writeEndElement();\n    };\n    // serialize the table cells\n    WordExport.prototype.serializeCells = function (writer, cells) {\n        for (var i = 0; i < cells.length; i++) {\n            this.serializeCell(writer, cells[i]);\n        }\n    };\n    // Serialize the table cell\n    WordExport.prototype.serializeCell = function (writer, cell) {\n        var owner = this.blockOwner;\n        this.blockOwner = cell;\n        writer.writeStartElement(undefined, 'tc', this.wNamespace);\n        this.serializeCellFormat(writer, cell.cellFormat);\n        if (cell.blocks.length > 0) {\n            var itemIndex = 0;\n            var item = undefined;\n            while (itemIndex < cell.blocks.length) {\n                item = cell.blocks[itemIndex];\n                this.serializeBodyItem(writer, item, false);\n                itemIndex += 1;\n            }\n        }\n        else {\n            writer.writeStartElement(undefined, 'p', this.wNamespace);\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            writer.writeStartElement(undefined, 'pStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'Normal');\n            writer.writeEndElement(); //end of pStyle\n            writer.writeEndElement(); //end of pPr\n            writer.writeEndElement(); //end of P\n        }\n        writer.writeEndElement(); //end of table cell 'tc'        \n        this.blockOwner = owner;\n    };\n    // Serialize the cell formatting\n    WordExport.prototype.serializeCellFormat = function (writer, cellFormat) {\n        var cell = this.blockOwner;\n        //Get the table fomat\n        var tf = this.table.tableFormat;\n        //Get the row format\n        var rf = this.row.rowFormat;\n        writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n        //w:cnfStyle -   Table Cell Conditional Formatting\n        // SerializeCnfStyleElement(cell);\n        //w:tcW -    Preferred Table Cell Width\n        this.serializeCellWidth(writer, cell);\n        //w:hMerge -    Horizontally Merged Cell and w:vMerge -    Vertically Merged Cell\n        this.serializeCellMerge(writer, cellFormat);\n        //w:gridSpan -   Grid Columns Spanned by Current Table Cell\n        this.serializeGridSpan(writer, cell);\n        //w:tcBorders -    Table Cell Borders\n        writer.writeStartElement(undefined, 'tcBorders', this.wNamespace);\n        this.serializeBorders(writer, cellFormat.borders, 8);\n        writer.writeEndElement();\n        //w:shd -  Table Cell Shading\n        this.serializeShading(writer, cell.cellFormat.shading);\n        // //w:noWrap -   Don't Wrap Cell Content\n        // if (cellFormat.HasValue(CellFormat.TextWrapKey)) {\n        //     m_writer.WriteStartElement('noWrap', W_namespace);\n        //     if (cellFormat.TextWrap)\n        //         m_writer.WriteAttributeString('w', 'val', W_namespace, 'false');\n        //     m_writer.WriteEndElement();\n        // }\n        // //w:tcMar -  Single Table Cell Margins\n        // if (!cellFormat.SamePaddingsAsTable) {\n        //     m_writer.WriteStartElement('tcMar', W_namespace);\n        //     SerializePaddings(cellFormat.Paddings);\n        //     m_writer.WriteEndElement();\n        // }\n        //w:textDirection -   Table Cell Text Flow Direction\n        this.serializeTableCellDirection(writer, cellFormat);\n        // //w:tcFitText -  Fit Text Within Cell\n        // if (cellFormat.FitText) {\n        //     m_writer.WriteStartElement('tcFitText', W_namespace);\n        //     m_writer.WriteEndElement();\n        // }\n        // //w:hideMark \n        // if (cellFormat.HideMark) {\n        //     m_writer.WriteStartElement('hideMark', W_namespace);\n        //     m_writer.WriteEndElement();\n        // }\n        //w:vAlign -  Table Cell Vertical Alignment\n        // if (cellFormat.HasValue(CellFormat.VrAlignmentKey))\n        this.serializeCellVerticalAlign(writer, cellFormat.verticalAlignment);\n        // //w:hideMark -   Ignore End Of Cell Marker In Row Height Calculation\n        // SerializeDocxProps(tempDocxProps, 'hideMark');\n        // //w:cellIns -    Table Cell Insertion\n        // SerializeDocxProps(tempDocxProps, 'cellIns');\n        // //w:cellDel -    Table Cell Deletion\n        // SerializeDocxProps(tempDocxProps, 'cellDel');\n        // //w:cellMerge -   Vertically Merged/Split Table Cells\n        // SerializeDocxProps(tempDocxProps, 'cellMerge');\n        // if (cellFormat.OldPropertiesHash.length > 0 && !m_isAlternativeCellFormat) {\n        //     m_isAlternativeCellFormat = true;\n        //     SerializeTrackChangeProps('tcPrChange', cellFormat.FormatChangeAuthorName, cellFormat.FormatChangeDateTime);\n        //     Dictionary < int, object > oldPropertyHash = new Dictionary<int, object>(cellFormat.OldPropertiesHash);\n        //     Dictionary < int, object > propertyHash = new Dictionary<int, object>(cellFormat.PropertiesHash);\n        //     cellFormat.PropertiesHash.Clear();\n        //     cellFormat.OldPropertiesHash.Clear();\n        //     foreach(KeyValuePair < int, object > keyValue in oldPropertyHash)\n        //     cellFormat.PropertiesHash[keyValue.Key] = keyValue.Value;\n        //     SerializeCellFormat(cellFormat);\n        //     cellFormat.PropertiesHash.Clear();\n        //     foreach(KeyValuePair < int, object > keyValue in propertyHash)\n        //     cellFormat.PropertiesHash[keyValue.Key] = keyValue.Value;\n        //     foreach(KeyValuePair < int, object > keyValue in oldPropertyHash)\n        //     cellFormat.OldPropertiesHash[keyValue.Key] = keyValue.Value;\n        //     m_writer.WriteEndElement();\n        //     m_isAlternativeCellFormat = false;\n        // }\n        writer.writeEndElement();\n    };\n    // Serialize the cell width\n    WordExport.prototype.serializeCellWidth = function (writer, cell) {\n        var cf = cell.cellFormat;\n        writer.writeStartElement(undefined, 'tcW', this.wNamespace);\n        if (cf.preferredWidthType === 'Percent') {\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'pct');\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(cf.preferredWidth * this.percentageFactor).toString());\n        }\n        else if (cf.preferredWidthType === 'Point') {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(cf.preferredWidth * this.twipsInOnePoint).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'auto');\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, '0');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize cell merge\n    WordExport.prototype.serializeCellMerge = function (writer, cellFormat) {\n        var cell = this.blockOwner;\n        var isserialized = false;\n        var collKey;\n        var currentIndex = cell.columnIndex;\n        var cellIndex = this.row.cells.indexOf(cell);\n        var prevIndex = cellIndex > 0 ? this.row.cells[cellIndex - 1].columnIndex : cell.columnIndex;\n        if (cell.columnIndex === cellIndex) {\n            collKey = cell.columnIndex;\n            isserialized = true;\n        }\n        else {\n            isserialized = false;\n        }\n        if (!isserialized) {\n            if (cellIndex === 0) {\n                currentIndex = cell.columnIndex;\n                prevIndex = -1;\n            }\n            for (var i = prevIndex; i < currentIndex; i++) {\n                collKey = prevIndex + 1;\n                prevIndex += 1;\n                if (this.mVerticalMerge.containsKey(collKey)) {\n                    this.createMerge(writer, collKey, cell);\n                }\n            }\n        }\n        if (cellFormat.rowSpan > 1) {\n            writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n            this.mVerticalMerge.add(collKey, cellFormat.rowSpan - 1);\n            if (cellFormat.columnSpan > 1) {\n                this.mGridSpans.add(collKey, cellFormat.columnSpan);\n            }\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'restart');\n            writer.writeEndElement();\n        }\n        else if (this.mVerticalMerge.containsKey(collKey) && isserialized) {\n            this.createMerge(writer, collKey, cell);\n        }\n        else if (this.mVerticalMerge.containsKey(cellIndex + 1) && isserialized && cell.nextNode === undefined) {\n            collKey = cell.columnIndex + 1;\n            writer.writeEndElement();\n            writer.writeStartElement('w', 'p', this.wNamespace);\n            writer.writeEndElement();\n            writer.writeEndElement();\n            writer.writeStartElement(undefined, 'tc', this.wNamespace);\n            writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n            this.serializeColumnSpan(collKey, writer);\n            writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'continue');\n            writer.writeEndElement();\n            this.checkMergeCell(collKey);\n        }\n    };\n    WordExport.prototype.createMerge = function (writer, collKey, cell) {\n        this.serializeColumnSpan(collKey, writer);\n        writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, 'continue');\n        writer.writeEndElement();\n        writer.writeEndElement(); //end tcPr\n        writer.writeStartElement('w', 'p', this.wNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement(); //end tc\n        writer.writeStartElement(undefined, 'tc', this.wNamespace);\n        writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n        this.serializeCellWidth(writer, cell);\n        this.checkMergeCell(collKey);\n    };\n    WordExport.prototype.serializeColumnSpan = function (collKey, writer) {\n        if (this.mGridSpans.keys.length > 0 && this.mGridSpans.containsKey(collKey)) {\n            writer.writeStartElement(undefined, 'gridSpan', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.mGridSpans.get(collKey).toString());\n            writer.writeEndElement();\n        }\n    };\n    WordExport.prototype.checkMergeCell = function (collKey) {\n        if ((this.mVerticalMerge.get(collKey) - 1) === 0) {\n            this.mVerticalMerge.remove(collKey);\n            if (this.mGridSpans.keys.length > 0 && this.mGridSpans.containsKey(collKey)) {\n                this.mGridSpans.remove(collKey);\n            }\n        }\n        else {\n            this.mVerticalMerge.set(collKey, this.mVerticalMerge.get(collKey) - 1);\n        }\n    };\n    // Serialize the grid span element of cell.\n    WordExport.prototype.serializeGridSpan = function (writer, cell) {\n        // int gridSpan = cell.cellFormat.GridSpan;\n        if (cell.cellFormat.columnSpan > 1) {\n            var num = cell.cellFormat.columnSpan;\n            writer.writeStartElement(undefined, 'gridSpan', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, num.toString());\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the table cell direction\n    WordExport.prototype.serializeTableCellDirection = function (writer, cellFormat) {\n        // if (cellFormat..textDirection !== TextDirection.Horizontal)\n        // {\n        //     m_writer.WriteStartElement('textDirection', W_namespace);\n        //     switch (cellFormat.TextDirection)\n        //     {\n        //         case TextDirection.Horizontal:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'lrTb');\n        //             break;\n        //         case TextDirection.VerticalBottomToTop:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'btLr');\n        //             break;\n        //         case TextDirection.VerticalTopToBottom:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbRl');\n        //             break;\n        //         case TextDirection.HorizontalFarEast:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'lrTbV');\n        //             break;\n        //         case TextDirection.Vertical:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbLrV');\n        //             break;\n        //         case TextDirection.VerticalFarEast:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbRlV');\n        //             break;\n        //     }\n        //     m_writer.WriteEndElement();\n        // }\n    };\n    // Serialize the cell vertical alignment\n    WordExport.prototype.serializeCellVerticalAlign = function (writer, alignment) {\n        writer.writeStartElement(undefined, 'vAlign', this.wNamespace);\n        switch (alignment) {\n            case 'Top':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'top');\n                break;\n            case 'Center':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'center');\n                break;\n            default:\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'bottom');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table grid columns.\n    WordExport.prototype.serializeGridColumns = function (writer, grid) {\n        for (var i = 1, count = grid.length; i < count; i++) {\n            var gridValue = Math.round(grid[i] * 20);\n            writer.writeStartElement(undefined, 'gridCol', this.wNamespace);\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, gridValue.toString());\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the row formattings.\n    // Table parameter is passed for serializing table format and undefined for serializing row format.\n    WordExport.prototype.serializeTableFormat = function (writer, format, table) {\n        // if (!isNullOrUndefined(table))\n        // {\n        //     List<Stream> tempDocxProps = new List<Stream>();\n        //     for (int i = 0, cnt = table.DocxTableFormat.NodeArray.length; i < cnt; i++)\n        //         tempDocxProps.Add(table.DocxTableFormat.NodeArray[i]);\n        writer.writeStartElement(undefined, 'tblPr', this.wNamespace);\n        //     SerializeTableStlye(format);\n        //     if (format.WrapTextAround &&!((table.OwnerTextBody.Owner is WTextBox) || \n        //(table.OwnerTextBody.Owner is WComment) || (table.OwnerTextBody.Owner is WFootnote)))\n        //     {\n        //         SerializeTablePositioning(format.Positioning);\n        //         if (!format.Positioning.AllowOverlap)\n        //         {\n        //             m_writer.WriteStartElement('tblOverlap', W_namespace);\n        //             m_writer.WriteAttributeString('val', W_namespace, 'never');\n        //             m_writer.WriteEndElement();\n        //         }\n        //     }\n        //     if (format.Bidi)\n        //     {\n        //         m_writer.WriteStartElement('bidiVisual', W_namespace);\n        //         m_writer.WriteEndElement();\n        //     }\n        //     SerializeDocxProps(tempDocxProps, 'tblStyleRowBandSize');\n        //     SerializeDocxProps(tempDocxProps, 'tblStyleColBandSize');\n        this.serializeTableWidth(writer, table);\n        this.serializeTableAlignment(writer, table.tableFormat);\n        this.serializeCellSpacing(writer, table.tableFormat);\n        this.serializeTableIndentation(writer, table.tableFormat);\n        this.serializeTableBorders(writer, table.tableFormat);\n        this.serializeShading(writer, table.tableFormat.shading);\n        this.serializeTblLayout(writer, table.tableFormat);\n        // this.serializeTableCellMargin(writer, table.tableFormat);\n        //     SerializeTableLook(table);\n        //         if (!isNullOrUndefined(table.Title))\n        //             SerializeTableTitle(table);\n        //         if (!isNullOrUndefined(table.Description))\n        //             SerializeTableDescription(table);\n        // }\n        // else\n        // {\n        //     SerializeCellSpacing(format);\n        //     SerializeTableIndentation(format);\n        //     SerializeTableBorders(format);\n        //     SerializeTableShading(format);\n        //     SerializeTblLayout(format);\n        //     SerializeTableCellMargin(format);\n        // }\n        // if (!isNullOrUndefined(format.OwnerBase) && format.OwnerBase is WTable\n        //   && format.OldPropertiesHash.length > 0 && !m_isAlternativeTableFormat)\n        // {\n        //     m_isAlternativeTableFormat = true;\n        //     SerializeTrackChangeProps('tblPrChange', format.FormatChangeAuthorName, format.FormatChangeDateTime);\n        //     SerializeTableTrackChanges(format, format.OwnerBase as WTable);\n        //     m_writer.WriteEndElement();\n        //     m_isAlternativeTableFormat = false;\n        // }\n        // if (!isNullOrUndefined(format.OwnerRow) && format.OldPropertiesHash.length > 0)\n        // {\n        //     SerializeTrackChangeProps('tblPrExChange', format.FormatChangeAuthorName, format.FormatChangeDateTime);\n        //     SerializeTableTrackChanges(format, undefined);\n        //     m_writer.WriteEndElement();\n        // }\n        // SerializeTblTrackChanges(format);\n        if (!isNullOrUndefined(table)) {\n            writer.writeEndElement(); //end of tblPr\n        }\n    };\n    // Serialize the table borders\n    WordExport.prototype.serializeShading = function (writer, format) {\n        // if (format.textureStyle !== 'TextureNone') {\n        writer.writeStartElement(undefined, 'shd', this.wNamespace);\n        writer.writeAttributeString(undefined, 'fill', this.wNamespace, this.getColor(format.backgroundColor));\n        if (format.foregroundColor === 'empty') {\n            writer.writeAttributeString(undefined, 'color', this.wNamespace, 'auto');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'color', this.wNamespace, this.getColor(format.foregroundColor));\n        }\n        writer.writeAttributeString('w', 'val', this.wNamespace, this.getTextureStyle(format.textureStyle));\n        writer.writeEndElement();\n        // }\n    };\n    WordExport.prototype.getTextureStyle = function (textureStyle) {\n        switch (textureStyle) {\n            case 'Texture5Percent':\n            case 'Texture2Pt5Percent':\n            case 'Texture7Pt5Percent':\n                return 'pct5';\n            case 'Texture10Percent':\n                return 'pct10';\n            case 'Texture12Pt5Percent':\n                return 'pct12';\n            case 'Texture15Percent':\n            case 'Texture17Pt5Percent':\n                return 'pct15';\n            case 'Texture20Percent':\n            case 'Texture22Pt5Percent':\n                return 'pct20';\n            case 'Texture25Percent':\n            case 'Texture27Pt5Percent':\n                return 'pct25';\n            case 'Texture30Percent':\n            case 'Texture32Pt5Percent':\n                return 'pct30';\n            case 'Texture35Percent':\n                return 'pct35';\n            case 'Texture37Pt5Percent':\n                return 'pct37';\n            case 'Texture40Percent':\n            case 'Texture42Pt5Percent':\n                return 'pct40';\n            case 'Texture45Percent':\n            case 'Texture47Pt5Percent':\n                return 'pct45';\n            case 'Texture50Percent':\n            case 'Texture52Pt5Percent':\n                return 'pct50';\n            case 'Texture55Percent':\n            case 'Texture57Pt5Percent':\n                return 'pct55';\n            case 'Texture60Percent':\n                return 'pct60';\n            case 'Texture62Pt5Percent':\n                return 'pct62';\n            case 'Texture65Percent':\n            case 'Texture67Pt5Percent':\n                return 'pct65';\n            case 'Texture70Percent':\n            case 'Texture72Pt5Percent':\n                return 'pct70';\n            case 'Texture75Percent':\n            case 'Texture77Pt5Percent':\n                return 'pct75';\n            case 'Texture80Percent':\n            case 'Texture82Pt5Percent':\n                return 'pct80';\n            case 'Texture85Percent':\n                return 'pct85';\n            case 'Texture87Pt5Percent':\n                return 'pct87';\n            case 'Texture90Percent':\n            case 'Texture92Pt5Percent':\n                return 'pct90';\n            case 'Texture95Percent':\n            case 'Texture97Pt5Percent':\n                return 'pct95';\n            case 'TextureCross':\n                return 'thinHorzCross';\n            case 'TextureDarkCross':\n                return 'horzCross';\n            case 'TextureDarkDiagonalCross':\n                return 'diagCross';\n            case 'TextureDarkDiagonalDown':\n                return 'reverseDiagStripe';\n            case 'TextureDarkDiagonalUp':\n                return 'diagStripe';\n            case 'TextureDarkHorizontal':\n                return 'horzStripe';\n            case 'TextureDarkVertical':\n                return 'vertStripe';\n            case 'TextureDiagonalCross':\n                return 'thinDiagCross';\n            case 'TextureDiagonalDown':\n                return 'thinReverseDiagStripe';\n            case 'TextureDiagonalUp':\n                return 'thinDiagStripe';\n            case 'TextureHorizontal':\n                return 'thinHorzStripe';\n            case 'TextureSolid':\n                return 'solid';\n            case 'TextureVertical':\n                return 'thinVertStripe';\n            default:\n                return 'clear';\n        }\n    };\n    // Serialize the table borders\n    WordExport.prototype.serializeTableBorders = function (writer, format) {\n        var borders = format.borders;\n        // if (IsNoneBorder(borders))\n        //     return;\n        writer.writeStartElement(undefined, 'tblBorders', this.wNamespace);\n        this.serializeBorders(writer, format.borders, 8);\n        writer.writeEndElement();\n    };\n    // Serialize the borders.\n    WordExport.prototype.serializeBorders = function (writer, borders, multipler) {\n        this.serializeBorder(writer, borders.top, 'top', multipler);\n        this.serializeBorder(writer, borders.left, 'left', multipler);\n        this.serializeBorder(writer, borders.bottom, 'bottom', multipler);\n        this.serializeBorder(writer, borders.right, 'right', multipler);\n        this.serializeBorder(writer, borders.horizontal, 'insideH', multipler);\n        this.serializeBorder(writer, borders.vertical, 'insideV', multipler);\n        this.serializeBorder(writer, borders.diagonalDown, 'tl2br', multipler);\n        this.serializeBorder(writer, borders.diagonalUp, 'tr2bl', multipler);\n    };\n    // Serialize the table layout element\n    WordExport.prototype.serializeTblLayout = function (writer, format) {\n        //TODO: AUTO size property is not mapped yet\n        // if (!format.IsAutoResized)\n        // {\n        //     writer.writeStartElement(undefined, 'tblLayout', this.wNamespace);\n        //     writer.writeAttributeString(undefined, 'type', this.wNamespace, 'fixed');\n        //     writer.writeEndElement();\n        // }\n    };\n    // Serializes the Border\n    WordExport.prototype.serializeBorder = function (writer, border, tagName, multiplier) {\n        var borderStyle = border.lineStyle;\n        var sz = (border.lineWidth * multiplier);\n        var space = border.space;\n        if (borderStyle === 'Cleared') {\n            writer.writeStartElement(undefined, tagName, this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'nil');\n            writer.writeEndElement();\n            return;\n        }\n        else if ((borderStyle === 'None' && !border.hasNoneStyle) || sz <= 0) {\n            return;\n        }\n        writer.writeStartElement(undefined, tagName, this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, this.getBorderStyle(borderStyle));\n        // if (border.color === '#000000')\n        // {\n        //     writer.writeAttributeString(undefined, 'color', this.wNamespace, 'auto');\n        // }\n        // else\n        // {\n        writer.writeAttributeString(undefined, 'color', this.wNamespace, this.getColor(border.color));\n        // }\n        writer.writeAttributeString(undefined, 'sz', this.wNamespace, this.roundToTwoDecimal(sz).toString());\n        writer.writeAttributeString(undefined, 'space', this.wNamespace, space.toString());\n        if (border.shadow) {\n            writer.writeAttributeString(undefined, 'shadow', this.wNamespace, 'on');\n        }\n        writer.writeEndElement();\n    };\n    // Get the border style as string\n    WordExport.prototype.getBorderStyle = function (borderStyle) {\n        switch (borderStyle) {\n            case 'Cleared':\n                return 'cleared';\n            case 'DashSmallGap':\n                return 'dashSmallGap';\n            case 'Triple':\n                return 'triple';\n            case 'Dot':\n                return 'dotted';\n            case 'DashDot':\n                return 'dotDash';\n            case 'DashLargeGap':\n                return 'dashed';\n            case 'DashDotDot':\n                return 'dotDotDash';\n            case 'Double':\n                return 'double';\n            case 'ThinThickSmallGap':\n                return 'thinThickSmallGap';\n            case 'ThickThinSmallGap':\n                return 'thickThinSmallGap';\n            case 'ThinThickThinSmallGap':\n                return 'thinThickThinSmallGap';\n            case 'ThickThinMediumGap':\n                return 'thickThinMediumGap';\n            case 'ThinThickMediumGap':\n                return 'thinThickMediumGap';\n            case 'ThinThickThinMediumGap':\n                return 'thinThickThinMediumGap';\n            case 'ThickThinLargeGap':\n                return 'thickThinLargeGap';\n            case 'ThinThickLargeGap':\n                return 'thinThickLargeGap';\n            case 'ThinThickThinLargeGap':\n                return 'thinThickThinLargeGap';\n            case 'Thick':\n                return 'thick';\n            case 'SingleWavy':\n                return 'wave';\n            case 'DoubleWavy':\n                return 'doubleWave';\n            case 'DashDotStroked':\n                return 'dashDotStroked';\n            case 'Engrave3D':\n                return 'threeDEngrave';\n            case 'Emboss3D':\n                return 'threeDEmboss';\n            case 'Outset':\n                return 'outset';\n            case 'Inset':\n                return 'inset';\n            // case 'None':\n            //     return 'none';\n            default:\n                return 'single';\n        }\n    };\n    // Serialize the table indentation.\n    WordExport.prototype.serializeTableIndentation = function (writer, format) {\n        writer.writeStartElement(undefined, 'tblInd', this.wNamespace);\n        var tableIndent = Math.round(format.leftIndent * this.twipsInOnePoint);\n        writer.writeAttributeString(undefined, 'w', this.wNamespace, tableIndent.toString());\n        writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        writer.writeEndElement();\n    };\n    // Serialize the cell spacing.\n    WordExport.prototype.serializeCellSpacing = function (writer, format) {\n        if (!isNullOrUndefined(format.cellSpacing) && format.cellSpacing >= 0) {\n            writer.writeStartElement(undefined, 'tblCellSpacing', this.wNamespace);\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(format.cellSpacing * this.twentiethOfPoint).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the table width\n    WordExport.prototype.serializeTableWidth = function (writer, table) {\n        writer.writeStartElement(undefined, 'tblW', this.wNamespace);\n        if (table.tableFormat.preferredWidthType === 'Percent') {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, (table.tableFormat.preferredWidth * this.percentageFactor).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'pct');\n        }\n        else if (table.tableFormat.preferredWidthType === 'Point') {\n            var tableWidth = Math.round(table.tableFormat.preferredWidth * this.twipsInOnePoint);\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, tableWidth.toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, '0');\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'auto');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table alignment\n    WordExport.prototype.serializeTableAlignment = function (writer, format) {\n        writer.writeStartElement(undefined, 'jc', this.wNamespace);\n        switch (format.tableAlignment) {\n            case 'Right':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'right');\n                break;\n            case 'Center':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'center');\n                break;\n            default:\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'left');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the field\n    WordExport.prototype.serializeFieldCharacter = function (writer, field) {\n        writer.writeStartElement(undefined, 'r', this.wNamespace);\n        this.serializeCharacterFormat(writer, field.characterFormat);\n        writer.writeStartElement(undefined, 'fldChar', this.wNamespace);\n        var type = field.fieldType === 0 ? 'begin'\n            : field.fieldType === 1 ? 'end' : 'separate';\n        writer.writeAttributeString(undefined, 'fldCharType', this.wNamespace, type);\n        writer.writeEndElement();\n        writer.writeEndElement();\n    };\n    // Serialize the text range.\n    WordExport.prototype.serializeTextRange = function (writer, span, previousNode) {\n        writer.writeStartElement('w', 'r', this.wNamespace);\n        this.serializeCharacterFormat(writer, span.characterFormat);\n        if (span.text === '\\t') {\n            writer.writeElementString(undefined, 'tab', this.wNamespace, undefined);\n        }\n        else if (span.text === '\\v') {\n            writer.writeElementString(undefined, 'br', this.wNamespace, undefined);\n        }\n        else if (span.text === '\\f') {\n            writer.writeStartElement(undefined, 'br', this.wNamespace);\n            writer.writeAttributeString('w', 'type', this.wNamespace, 'page');\n            writer.writeEndElement();\n        }\n        else {\n            var isField = !isNullOrUndefined(previousNode)\n                && previousNode.hasOwnProperty('fieldType') && previousNode.fieldType !== 2;\n            writer.writeStartElement(undefined, isField ? 'instrText' : 't', this.wNamespace);\n            writer.writeAttributeString('xml', 'space', this.xmlNamespace, 'preserve');\n            writer.writeString(span.text);\n            writer.writeEndElement();\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the paragraph format\n    WordExport.prototype.serializeParagraphFormat = function (writer, paragraphFormat, paragraph) {\n        if (!isNullOrUndefined(paragraphFormat.styleName)) {\n            writer.writeStartElement(undefined, 'pStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, paragraphFormat.styleName);\n            writer.writeEndElement(); //end of pStyle\n        }\n        if (!isNullOrUndefined(paragraph)) {\n            this.serializeListFormat(writer, paragraph.paragraphFormat.listFormat);\n        }\n        else {\n            this.serializeListFormat(writer, paragraphFormat.listFormat);\n        }\n        this.serializeParagraphSpacing(writer, paragraphFormat);\n        this.serializeIndentation(writer, paragraphFormat);\n        this.serializeParagraphAlignment(writer, paragraphFormat.textAlignment);\n        if (!isNullOrUndefined(paragraphFormat.tabs) && paragraphFormat.tabs.length > 0) {\n            this.serializeTabs(writer, paragraphFormat.tabs);\n        }\n    };\n    // Serialize Tabs\n    WordExport.prototype.serializeTabs = function (writer, tabStops) {\n        writer.writeStartElement('w', 'tabs', this.wNamespace);\n        for (var i = 0; i < tabStops.length; i++) {\n            this.serializeTab(writer, tabStops[i]);\n        }\n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeTab = function (writer, tabStop) {\n        var position = 0;\n        writer.writeStartElement('w', 'tab', this.wNamespace);\n        if (tabStop.position === 0 && tabStop.deletePosition !== 0) {\n            position = tabStop.deletePosition * this.twentiethOfPoint;\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'clear');\n        }\n        else {\n            position = tabStop.position * this.twentiethOfPoint;\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getTabJustification(tabStop.tabJustification));\n        }\n        if (!isNullOrUndefined(tabStop.tabLeader) && (tabStop.tabLeader !== 'None')) {\n            writer.writeAttributeString('w', 'leader', this.wNamespace, this.getTabLeader(tabStop.tabLeader));\n        }\n        writer.writeAttributeString('w', 'pos', this.wNamespace, position.toString() + '');\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getTabLeader = function (tabLeader) {\n        switch (tabLeader) {\n            case 'Dot':\n                return 'dot';\n            case 'Hyphen':\n                return 'hyphen';\n            case 'Underscore':\n                return 'underscore';\n            default:\n                return 'none';\n        }\n    };\n    WordExport.prototype.getTabJustification = function (tabJustification) {\n        switch (tabJustification) {\n            case 'Bar':\n                return 'bar';\n            case 'Center':\n                return 'center';\n            case 'Decimal':\n                return 'decimal';\n            case 'Left':\n                return 'left';\n            case 'List':\n                return 'num';\n            case 'Right':\n                return 'right';\n            default:\n                return 'clear';\n        }\n    };\n    // // Seraializes the pargraph list format\n    // private serializeListParagraph(writer: XmlWriter, paragraph: any): void {\n    //     if (!isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n    //         this.serializeListFormat(writer, paragraph.paragraphFormat.listFormat);\n    //     }\n    // }\n    // Serialize the list format\n    WordExport.prototype.serializeListFormat = function (writer, lf) {\n        // let pStyleName = undefined;\n        // if (lf.CurrentListStyle.IsBuiltInStyle && !isNullOrUndefined(lf.OwnerParagraph))\n        // {\n        //     pStyleName = lf.OwnerParagraph.StyleName;\n        // }\n        // int listId = GetListId(lf);\n        // if (!isNullOrUndefined(pStyleName) && string.IsNullOrEmpty(lf.LFOStyleName)) \n        // {\n        //     WordDocument doc = lf.OwnerParagraph.Document;\n        //     WParagraphStyle style = doc.Styles.FindByName(pStyleName, StyleType.ParagraphStyle) as WParagraphStyle;\n        //     if (style.ListIndex === -1)\n        //     {\n        //         ListStyle lstStyle = lf.OwnerParagraph.Document.ListStyles.FindByName(lf.CustomStyleName);\n        //         style.ListIndex = listId;\n        //         if (lstStyle.Levels.length > 1)\n        //         {\n        //             style.ListLevel = lf.ListLevelNumber;\n        //         }\n        //         pStyleName = pStyleName.Replace(' ', '');\n        //         lstStyle.Levels[lf.ListLevelNumber].ParaStyleName = pStyleName;\n        //     }\n        // }\n        // else\n        // {\n        // if (!isNullOrUndefined(lf.listId) && !isNullOrUndefined(lf.listLevelNumber)) {\n        //     this.serializeNumPr(writer, lf.listId, lf.listLevelNumber);\n        // }\n        // }\n        if (!isNullOrUndefined(lf.listId) || !isNullOrUndefined(lf.listLevelNumber)) {\n            writer.writeStartElement(undefined, 'numPr', this.wNamespace);\n            if (!isNullOrUndefined(lf.listLevelNumber) && lf.listLevelNumber !== -1) {\n                writer.writeStartElement(undefined, 'ilvl', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, lf.listLevelNumber.toString());\n                writer.writeEndElement();\n            }\n            if (!isNullOrUndefined(lf.listId) && lf.listId !== -1) {\n                writer.writeStartElement(undefined, 'numId', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, (lf.listId + 1).toString());\n                writer.writeEndElement();\n            }\n            writer.writeEndElement();\n        }\n    };\n    // // Serializes the numbering properties to the paragraph\n    // private serializeNumPr(writer: XmlWriter, listId: number, listLevel: number): void {\n    //     writer.writeStartElement(undefined, 'numPr', this.wNamespace);\n    //     if (listLevel !== -1) {\n    //         writer.writeStartElement(undefined, 'ilvl', this.wNamespace);\n    //         writer.writeAttributeString('w', 'val', this.wNamespace, listLevel.toString());\n    //         writer.writeEndElement();\n    //     }\n    //     if (listId !== -1) {\n    //         writer.writeStartElement(undefined, 'numId', this.wNamespace);\n    //         writer.writeAttributeString('w', 'val', this.wNamespace, listId.toString());\n    //         writer.writeEndElement();\n    //     }\n    //     writer.writeEndElement();\n    // }\n    WordExport.prototype.serializeParagraphAlignment = function (writer, txtAlignment) {\n        if (!isNullOrUndefined(txtAlignment)) {\n            writer.writeStartElement(undefined, 'jc', this.wNamespace);\n            var alignment = void 0;\n            switch (txtAlignment) {\n                case 'Center':\n                    alignment = 'center';\n                    break;\n                case 'Right':\n                    alignment = 'right';\n                    break;\n                case 'Justify':\n                    alignment = 'both';\n                    break;\n                default:\n                    alignment = 'left';\n                    break;\n            }\n            writer.writeAttributeString('w', 'val', this.wNamespace, alignment);\n            writer.writeEndElement();\n        }\n    };\n    // Serializes the paragraph spacings\n    WordExport.prototype.serializeParagraphSpacing = function (writer, paragraphFormat) {\n        writer.writeStartElement(undefined, 'spacing', this.wNamespace);\n        // if (paragraphFormat.HasValue(WParagraphFormat.BeforeLinesKey))\n        // {\n        //     short beforeLines = (short)Math.Round(paragraphFormat.BeforeLines * DLSConstants.HundredthsUnit);\n        //     writer.WriteAttributeString('beforeLines', this.wNamespace, ToString((float)beforeLines));               \n        // }\n        // if (paragraphFormat.HasValue(WParagraphFormat.AfterLinesKey))\n        // {\n        //     short afterLines = (short)Math.Round(paragraphFormat.AfterLines * DLSConstants.HundredthsUnit);\n        //     writer.WriteAttributeString('afterLines', this.wNamespace, ToString((float)afterLines));                 \n        // }\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(paragraphFormat.beforeSpacing)) {\n            writer.writeAttributeString(undefined, 'before', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.beforeSpacing * this.twentiethOfPoint).toString());\n        }\n        //TODO:ISSUEFIX(paragraphFormat.beforeSpacing * this.twentiethOfPoint).toString());\n        // if (paragraphFormat.HasValue(WParagraphFormat.SpacingBeforeAutoKey))\n        // {\n        //     if (paragraphFormat.SpaceBeforeAuto)\n        //     {\n        //         writer.WriteAttributeString('beforeAutospacing', this.wNamespace, '1');\n        //     }\n        //     else\n        //     {\n        //         writer.WriteAttributeString('beforeAutospacing', this.wNamespace, '0');\n        //     }\n        // }\n        if (!isNullOrUndefined(paragraphFormat.afterSpacing)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'after', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.afterSpacing * this.twentiethOfPoint).toString());\n        }\n        //TODO:ISSUEFIX(paragraphFormat.afterSpacing * this.twentiethOfPoint).toString());\n        // if (paragraphFormat.HasValue(WParagraphFormat.SpacingAfterAutoKey))\n        // {\n        //     if (paragraphFormat.SpaceAfterAuto)\n        //     {\n        //         writer.WriteAttributeString('afterAutospacing', this.wNamespace, '1');\n        //     }\n        //     else\n        //     {\n        //         writer.WriteAttributeString('afterAutospacing', this.wNamespace, '0');\n        //     }\n        // }\n        writer.writeAttributeString(undefined, 'line', this.wNamespace, '240');\n        //TODO:ISSUEFIX((paragraphFormat.lineSpacing) * this.twentiethOfPoint).toString());\n        switch (paragraphFormat.lineSpacingType) {\n            case 'AtLeast':\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'atLeast');\n                break;\n            case 'Exactly':\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'exact');\n                break;\n            default:\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'auto');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the paragraph indentation\n    WordExport.prototype.serializeIndentation = function (writer, paragraphFormat) {\n        writer.writeStartElement(undefined, 'ind', this.wNamespace);\n        if (!isNullOrUndefined(paragraphFormat.leftIndent)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'left', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.leftIndent * this.twipsInOnePoint).toString());\n        }\n        if (!isNullOrUndefined(paragraphFormat.rightIndent)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'right', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.rightIndent * this.twipsInOnePoint).toString());\n        }\n        if (!isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n            if (paragraphFormat.firstLineIndent < 0) {\n                // tslint:disable-next-line:max-line-length\n                writer.writeAttributeString(undefined, 'hanging', this.wNamespace, this.roundToTwoDecimal(-1 * paragraphFormat.firstLineIndent * this.twipsInOnePoint).toString());\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                writer.writeAttributeString(undefined, 'firstLine', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.firstLineIndent * this.twipsInOnePoint).toString());\n            }\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the styles (styles.xml)\n    WordExport.prototype.serializeStyles = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'styles', this.wNamespace);\n        writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'w', undefined, this.wNamespace);\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15');\n        //writes the document defaults, latent styles and default styles.\n        this.serializeDefaultStyles(writer);\n        //writes the document styles\n        this.serializeDocumentStyles(writer);\n        writer.writeEndElement(); //end of styles tag\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.stylePath);\n        this.mArchive.addItem(zipArchiveItem); //this.stylePath, styleStream, false, FileAttributes.Archive);\n    };\n    // Serializes the default styles (document default paragraph and character format)\n    WordExport.prototype.serializeDefaultStyles = function (writer) {\n        writer.writeStartElement(undefined, 'docDefaults', this.wNamespace);\n        //if (HasDefaultCharFormat())\n        //{\n        writer.writeStartElement(undefined, 'rPrDefault', this.wNamespace);\n        // if (!isNullOrUndefined(this.mDocument.characterFormat)) {\n        this.serializeCharacterFormat(writer, this.defCharacterFormat);\n        writer.writeEndElement(); // end of rPrDefault\n        // }\n        // else {\n        //     writer.writeStartElement(undefined, 'rPr', this.wNamespace);\n        //     writer.writeStartElement(undefined, 'rFonts', this.wNamespace);\n        //     if (!string.IsNullOrEmpty(m_document.StandardAsciiFont))\n        //         writer.WriteAttributeString('ascii', this.wNamespace, m_document.StandardAsciiFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardFarEastFont))\n        //         writer.WriteAttributeString('eastAsia', this.wNamespace, m_document.StandardFarEastFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardNonFarEastFont))\n        //         writer.WriteAttributeString('hAnsi', this.wNamespace, m_document.StandardNonFarEastFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardBidiFont))\n        //         writer.WriteAttributeString('cs', this.wNamespace, m_document.StandardBidiFont);\n        //     writer.WriteEndElement();\n        //     float fontSize = GetDefFontSize(m_document, WCharacterFormat.FontSizeKey);\n        //     if (fontSize !== 0f)\n        //     {\n        //         writer.WriteStartElement('sz', this.wNamespace);\n        //         writer.WriteAttributeString('val', this.wNamespace, (fontSize * 2).ToString(CultureInfo.InvariantCulture));\n        //         writer.WriteEndElement();\n        //     }\n        //     fontSize = GetDefFontSize(m_document, WCharacterFormat.FontSizeBidiKey);\n        //     if (fontSize !== 0f)\n        //     {\n        //         writer.WriteStartElement('szCs', this.wNamespace);\n        //         writer.WriteAttributeString('val', this.wNamespace, (fontSize * 2).ToString(CultureInfo.InvariantCulture));\n        //         writer.WriteEndElement();\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        // writer.WriteEndElement();\n        // //}\n        writer.writeStartElement(undefined, 'pPrDefault', this.wNamespace);\n        if (!isNullOrUndefined(this.defParagraphFormat)) {\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            this.serializeParagraphFormat(writer, this.defParagraphFormat, undefined);\n            writer.writeEndElement(); //end of pPr\n        }\n        writer.writeEndElement(); //end of pPrDefault\n        // writer.WriteEndElement();\n        // SerializeLatentStyles();\n        // //Default styles\n        // if (m_document.Styles.length === 0 || isNullOrUndefined(m_document.Styles.FindByName('Normal')))\n        // {\n        //     SerializeDefaultParagraphStyle();\n        // }\n        // if (!IsDocumentContainsDefaultTableStyle())\n        // {\n        //     SerializeTableNormalStyle();\n        // }\n        // if (isNullOrUndefined(m_document.Styles.FindByName('No List')) && isNullOrUndefined(m_document.Styles.FindByName('NoList')))\n        //     SerializeNoListStyle();\n        // tslint:disable-next-line:max-line-length\n        // if (isNullOrUndefined(m_document.Styles.FindByName('Table Grid')) && isNullOrUndefined(m_document.Styles.FindByName('TableGrid')))\n        // {\n        //     SerializeTableGridStyle();\n        // }\n        // }        \n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeDocumentStyles = function (writer) {\n        for (var i = 0; i < this.mStyles.length; i++) {\n            var style = this.mStyles[i];\n            writer.writeStartElement(undefined, 'style', this.wNamespace);\n            var type = style.type === 'Paragraph' ? 'paragraph' : 'character';\n            writer.writeAttributeString('w', 'type', this.wNamespace, type);\n            writer.writeAttributeString('w', 'styleId', this.wNamespace, style.name);\n            //name\n            writer.writeStartElement(undefined, 'name', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, style.name);\n            writer.writeEndElement();\n            //basedOn\n            if (!isNullOrUndefined(style.basedOn)) {\n                writer.writeStartElement(undefined, 'basedOn', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.basedOn);\n                writer.writeEndElement();\n            }\n            //next\n            if (!isNullOrUndefined(style.next)) {\n                writer.writeStartElement(undefined, 'next', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.next);\n                writer.writeEndElement();\n            }\n            //link\n            if (!isNullOrUndefined(style.link)) {\n                writer.writeStartElement(undefined, 'link', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.link);\n                writer.writeEndElement();\n            }\n            if (style.type === 'Paragraph') {\n                writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n                this.serializeParagraphFormat(writer, style.paragraphFormat, undefined);\n                writer.writeEndElement();\n            }\n            // let value = (style.characterFormat as WCharacterFormat).newgetCharacterFormat();\n            this.serializeCharacterFormat(writer, style.characterFormat);\n            writer.writeEndElement(); //end of Style\n        }\n    };\n    // Serializes the Character format\n    WordExport.prototype.serializeCharacterFormat = function (writer, characterFormat) {\n        writer.writeStartElement(undefined, 'rPr', this.wNamespace);\n        if (!isNullOrUndefined(characterFormat.styleName)) {\n            writer.writeStartElement(undefined, 'rStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, characterFormat.styleName);\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.fontFamily)) {\n            writer.writeStartElement(undefined, 'rFonts', this.wNamespace);\n            writer.writeAttributeString(undefined, 'ascii', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'hAnsi', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'eastAsia', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'cs', this.wNamespace, characterFormat.fontFamily);\n            writer.writeEndElement(); //end         \n        }\n        if (!isNullOrUndefined(characterFormat.bold)) {\n            this.serializeBoolProperty(writer, 'b', characterFormat.bold);\n        }\n        if (!isNullOrUndefined(characterFormat.italic)) {\n            this.serializeBoolProperty(writer, 'i', characterFormat.italic);\n        }\n        if (!isNullOrUndefined(characterFormat.strikethrough)) {\n            switch (characterFormat.strikethrough) {\n                case 'SingleStrike':\n                    this.serializeBoolProperty(writer, 'strike', true);\n                    break;\n                case 'DoubleStrike':\n                    this.serializeBoolProperty(writer, 'dstrike', true);\n                    break;\n                default:\n                    this.serializeBoolProperty(writer, 'strike', false);\n                    this.serializeBoolProperty(writer, 'dstrike', false);\n                    break;\n            }\n        }\n        if (!isNullOrUndefined(characterFormat.fontColor)) {\n            writer.writeStartElement(undefined, 'color', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getColor(characterFormat.fontColor));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.fontSize)) {\n            writer.writeStartElement(undefined, 'sz', this.wNamespace);\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.roundToTwoDecimal(characterFormat.fontSize * 2).toString());\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.highlightColor) && characterFormat.highlightColor !== 'NoColor') {\n            writer.writeStartElement(undefined, 'highlight', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getHighlightColor(characterFormat.highlightColor));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.underline) && characterFormat.underline !== 'None') {\n            writer.writeStartElement(undefined, 'u', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getUnderlineStyle(characterFormat.underline));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.baselineAlignment)) {\n            writer.writeStartElement(undefined, 'vertAlign', this.wNamespace);\n            switch (characterFormat.baselineAlignment) {\n                case 'Subscript':\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'subscript');\n                    break;\n                case 'Superscript':\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'superscript');\n                    break;\n                default:\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'baseline');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        writer.writeEndElement(); //end of rPrChange\n    };\n    WordExport.prototype.getColor = function (color) {\n        if (color.length > 0) {\n            if (color[0] === '#') {\n                color = color.substr(1);\n            }\n            if (color.length > 6) {\n                color = color.substr(0, 6);\n            }\n        }\n        return color;\n    };\n    // Get the underline style as string\n    WordExport.prototype.getUnderlineStyle = function (underlineStyle) {\n        switch (underlineStyle) {\n            case 'DotDotDashHeavy':\n                return 'dashDotDotHeavy';\n            case 'DotDashHeavy':\n                return 'dashDotHeavy';\n            case 'DashHeavy':\n                return 'dashedHeavy';\n            case 'DashLong':\n                return 'dashLong';\n            case 'DashLongHeavy':\n                return 'dashLongHeavy';\n            case 'DotDash':\n                return 'dotDash';\n            case 'DotDotDash':\n                return 'dotDotDash';\n            case 'Dotted':\n                return 'dotted';\n            case 'DottedHeavy':\n                return 'dottedHeavy';\n            case 'Double':\n                return 'double';\n            case 'Single':\n                return 'single';\n            case 'Thick':\n                return 'thick';\n            case 'Wavy':\n                return 'wave';\n            case 'WavyDouble':\n                return 'wavyDouble';\n            case 'WavyHeavy':\n                return 'wavyHeavy';\n            case 'Words':\n                return 'words';\n            default:\n                return 'dash';\n        }\n    };\n    WordExport.prototype.getHighlightColor = function (highlight) {\n        switch (highlight) {\n            // Highlights the content with bright green (#ff00ff00) color.\n            case 'BrightGreen':\n                return 'green';\n            // Highlights the content with turquoise (#ff00ffff) color.\n            case 'Turquoise':\n                return 'cyan';\n            // Highlights the content with pink (#ffff00ff) color.\n            case 'Pink':\n                return 'magenta';\n            // Highlights the content with blue (#ff0000ff) color.\n            case 'Blue':\n                return 'blue';\n            // Highlights the content with red (#ffff0000) color.\n            case 'Red':\n                return 'red';\n            // Highlights the content with dark blue (#ff000080) color.\n            case 'DarkBlue':\n                return 'darkBlue';\n            // Highlights the content with teal (#ff008080) color.\n            case 'Teal':\n                return 'darkCyan';\n            // Highlights the content with green (#ff008000) color.\n            case 'Green':\n                return 'darkGreen';\n            // Highlights the content with violet (#ff800080) color.\n            case 'Violet':\n                return 'darkMagenta';\n            // Highlights the content with dark red (#ff800000) color.\n            case 'DarkRed':\n                return 'darkRed';\n            // Highlights the content with dark yellow (#ff808000)  color.\n            case 'DarkYellow':\n                return 'darkYellow';\n            // Highlights the content with gray 50 (#ff808080) color.\n            case 'Gray50':\n                return 'darkGray';\n            // Highlights the content with gray 25 (#ffc0c0c0) color.\n            case 'Gray25':\n                return 'lightGray';\n            // Highlights the content with black (#ff000000) color.\n            case 'Black':\n                return 'black';\n            // Highlights the content with yellow (#ffffff00) color.\n            default:\n                return 'yellow';\n        }\n    };\n    /*private toggleFirstCahar(text: string) {\n        return text.charAt(0).toLowerCase() + text.slice(1);\n    }*/\n    // Serializes the bool character format property\n    WordExport.prototype.serializeBoolProperty = function (writer, tag, value) {\n        writer.writeStartElement(undefined, tag, this.wNamespace);\n        if (!value) {\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, '0');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the list styles and numberings (numberings.xml)\n    WordExport.prototype.serializeNumberings = function () {\n        if (this.document.lists.length === 0) {\n            return;\n        }\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'numbering', this.wNamespace);\n        this.writeCommonAttributeStrings(writer);\n        // this.serializePictureBullets(writer, this.mDocument.lists);\n        this.serializeAbstractListStyles(writer, this.document.abstractLists);\n        this.serializeListInstances(writer, this.document.lists);\n        // SerializeListOverrides(writer, this.mDocument.ridesm_document.ListOverrides);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.numberingPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    // Serializes the abstract list styles\n    WordExport.prototype.serializeAbstractListStyles = function (writer, listStyles) {\n        for (var i = 0; i < listStyles.length; i++) {\n            var abstractList = listStyles[i];\n            writer.writeStartElement(undefined, 'abstractNum', this.wNamespace);\n            writer.writeAttributeString(undefined, 'abstractNumId', this.wNamespace, abstractList.abstractListId.toString());\n            writer.writeStartElement(undefined, 'nsid', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, this.generateHex());\n            writer.writeEndElement();\n            for (var ilvl = 0, cnt = abstractList.levels.length; ilvl < cnt; ilvl++) {\n                this.serializeListLevel(writer, abstractList.levels[ilvl], ilvl);\n            }\n            writer.writeEndElement(); //end of abstractNum\n        }\n    };\n    // Serializes the list styles\n    WordExport.prototype.serializeListInstances = function (writer, listStyles) {\n        for (var i = 0; i < listStyles.length; i++) {\n            var list = listStyles[i];\n            writer.writeStartElement(undefined, 'num', this.wNamespace);\n            writer.writeAttributeString(undefined, 'numId', this.wNamespace, (list.listId + 1).toString());\n            writer.writeStartElement(undefined, 'abstractNumId', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, list.abstractListId.toString());\n            writer.writeEndElement();\n            writer.writeEndElement();\n        }\n    };\n    WordExport.prototype.generateHex = function () {\n        return (Math.floor(Math.random() * (4000000000 - 270000000)) + 270000000).toString(16).toUpperCase();\n    };\n    WordExport.prototype.roundToTwoDecimal = function (num) {\n        return Math.round(num); // * 100) / 100;\n    };\n    // Serialize the list level\n    WordExport.prototype.serializeListLevel = function (writer, listLevel, levelIndex) {\n        writer.writeStartElement(undefined, 'lvl', this.wNamespace);\n        writer.writeAttributeString(undefined, 'ilvl', this.wNamespace, levelIndex.toString());\n        writer.writeStartElement(undefined, 'start', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, listLevel.startAt.toString());\n        writer.writeEndElement();\n        writer.writeStartElement(undefined, 'numFmt', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, this.getLevelPattern(listLevel.listLevelPattern));\n        writer.writeEndElement();\n        if (listLevel.restartLevel > 0) {\n            writer.writeStartElement(undefined, 'lvlRestart', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, '0');\n            writer.writeEndElement();\n        }\n        // if (!isNullOrUndefined(listLevel.paragraphFormat)) {\n        //     string name = listLevel.ParaStyleName.Substring(0, 1).ToUpper() + listLevel.ParaStyleName.Remove(0, 1);\n        //     writer.WriteStartElement('pStyle', this.wNamespace);\n        //     writer.WriteAttributeString('val', this.wNamespace, name);\n        //     writer.WriteEndElement();\n        // }\n        // if (listLevel.IsLegalStyleNumbering) {\n        //     writer.WriteStartElement('isLgl', this.wNamespace);\n        //     writer.WriteEndElement();\n        // }\n        this.serializeLevelFollow(writer, listLevel);\n        this.serializeLevelText(writer, listLevel, levelIndex + 1);\n        // SerializeLegacyProperties(listLevel);\n        // if (listLevel.PicBulletId > 0) {\n        //     writer.WriteStartElement('lvlPicBulletId', this.wNamespace);\n        //     writer.WriteAttributeString('val', this.wNamespace, listLevel.PicBulletId.ToString());\n        //     writer.WriteEndElement();\n        // }\n        // //lvlJc\n        // if (listLevel.NumberAlignment !== ListNumberAlignment.Left) {\n        //     writer.WriteStartElement('lvlJc', this.wNamespace);\n        //     string alignment = string.Empty;\n        //     if (listLevel.NumberAlignment === ListNumberAlignment.Right) {\n        //         alignment = 'right';\n        //     }\n        //     else {\n        //         alignment = 'center';\n        //     }\n        //     writer.WriteAttributeString('val', this.wNamespace, alignment);\n        //     writer.WriteEndElement();\n        // }\n        writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n        this.serializeParagraphFormat(writer, listLevel.paragraphFormat, undefined);\n        writer.writeEndElement(); //end of pPr\n        this.serializeCharacterFormat(writer, listLevel.characterFormat);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getLevelPattern = function (levelPattern) {\n        var patternType;\n        switch (levelPattern) {\n            case 'Arabic':\n                patternType = 'decimal';\n                break;\n            case 'UpRoman':\n                patternType = 'upperRoman';\n                break;\n            case 'LowRoman':\n                patternType = 'lowerRoman';\n                break;\n            case 'UpLetter':\n                patternType = 'upperLetter';\n                break;\n            case 'LowLetter':\n                patternType = 'lowerLetter';\n                break;\n            // case 'Ordinal':\n            //     patternType = 'ordinal';\n            //     break;\n            // case 'Number':\n            //     patternType = 'cardinalText';\n            //     break;\n            // case 'OrdinalText':\n            //     patternType = 'ordinalText';\n            //     break;\n            // case 'LeadingZero':\n            //     patternType = 'decimalZero';\n            //     break;\n            // case 'Bullet':\n            default:\n                patternType = 'bullet';\n                break;\n            // case 'FarEast':\n            //     patternType = 'aiueoFullWidth';\n            //     break;\n            // case 'Special':\n            //     patternType = 'russianLower';\n            //     break;\n            // case 'None':\n            //     patternType = 'none';\n            //     break;\n        }\n        return patternType;\n    };\n    // Serializes the level text\n    WordExport.prototype.serializeLevelText = function (writer, listLevel, lvlIndex) {\n        writer.writeStartElement(undefined, 'lvlText', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, (listLevel.numberFormat));\n        writer.writeEndElement();\n    };\n    // Serialize the level follow character\n    WordExport.prototype.serializeLevelFollow = function (writer, listLevel) {\n        var fc;\n        //TODO:Type issue returns number instead of string\n        if (listLevel.followCharacter === 'Tab') {\n            fc = 'tab';\n        }\n        else if (listLevel.followCharacter === 'Space') {\n            fc = 'space';\n        }\n        else {\n            fc = 'nothing';\n        }\n        writer.writeStartElement(undefined, 'suff', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, fc);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeSettings = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'settings', this.wNamespace);\n        this.writeCustom(writer);\n        // writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        // writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        // writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        // writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        // writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('xmlns', 'sl', undefined, this.slNamespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15');\n        // //w:writeProtection - Write Protection\n        // if (m_document.WriteProtected)\n        // {\n        //     writer.writeStartElement('w', 'writeProtection', this.wNamespace);\n        //     writer.writeAttributeString('recommended', this.wNamespace, '1');\n        //     writer.writeEndElement();\n        // }\n        //w:view - Document View Setting\n        // if (this.mDocument.ViewSetup.DocumentViewType !== DocumentViewType.PrintLayout &&\n        //   m_document.ViewSetup.DocumentViewType !== DocumentViewType.NormalLayout)\n        // {\n        //     writer.writeStartElement('view', this.wNamespace);\n        //     string viewTypeStr = string.Empty;\n        //     if (m_document.ViewSetup.DocumentViewType === DocumentViewType.OutlineLayout)\n        //     {\n        //         viewTypeStr = 'outline';\n        //     }\n        //     else if (m_document.ViewSetup.DocumentViewType === DocumentViewType.WebLayout)\n        //     {\n        //         viewTypeStr = 'web';\n        //     }\n        //     writer.writeAttributeString('val', this.wNamespace, viewTypeStr);\n        //     writer.writeEndElement();\n        // }\n        //w:zoom - Magnification Setting\n        writer.writeStartElement('w', 'zoom', this.wNamespace);\n        // switch (m_document.ViewSetup.ZoomType)\n        // {\n        //     case ZoomType.FullPage:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'fullPage');\n        //         break;\n        //     case ZoomType.PageWidth:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'bestFit');\n        //         break;\n        //     case ZoomType.TextFit:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'textFit');\n        //         break;\n        // default:\n        writer.writeAttributeString('w', 'val', this.wNamespace, 'none');\n        // break;\n        // }\n        writer.writeAttributeString('w', 'percent', this.wNamespace, '100');\n        writer.writeEndElement();\n        //w:displayBackgroundShape - Display Background Objects When Displaying Document\n        // if (m_document.Background.Type !== BackgroundType.NoBackground)\n        // {\n        writer.writeStartElement(undefined, 'displayBackgroundShape', this.wNamespace);\n        writer.writeEndElement();\n        // }\n        //w:defaultTabStop - Distance Between Automatic Tab Stops\n        writer.writeStartElement(undefined, 'defaultTabStop', this.wNamespace);\n        var tabWidth = Math.round(this.defaultTabWidthValue * this.twipsInOnePoint);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, tabWidth.toString());\n        writer.writeEndElement();\n        //w:evenAndOddHeaders - Different Even/Odd Page Headers and Footers        \n        if (this.mDifferentFirstPage) {\n            writer.writeStartElement(undefined, 'evenAndOddHeaders', this.wNamespace);\n            writer.writeEndElement();\n        }\n        //w:footnotePr - Document-Wide Footnote Properties and w:endnotePr - Document-Wide Endnote Properties\n        // SerializeFootnoteSettings();\n        //w:compat - Compatibility Settings\n        writer.writeStartElement(undefined, 'compat', this.wNamespace);\n        writer.writeStartElement(undefined, 'compatSetting', this.wNamespace);\n        writer.writeAttributeString(undefined, 'name', this.wNamespace, 'compatibilityMode');\n        writer.writeAttributeString(undefined, 'uri', this.wNamespace, 'http://schemas.microsoft.com/office/word');\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, '15');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.settingsPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    WordExport.prototype.serializeCoreProperties = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeAppProperties = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeFontTable = function (contentType) {\n        //implementation\n    };\n    WordExport.prototype.serializeSettingsRelation = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeHeaderFooters = function () {\n        this.serializeHeaderFooter('EvenFooter');\n        this.serializeHeaderFooter('EvenHeader');\n        this.serializeHeaderFooter('FirstPageFooter');\n        this.serializeHeaderFooter('FirstPageHeader');\n        this.serializeHeaderFooter('OddFooter');\n        this.serializeHeaderFooter('OddHeader');\n    };\n    // Serializes the Header/Footer\n    WordExport.prototype.serializeHeaderFooter = function (hfType) {\n        if (this.headersFooters.length === 0) {\n            return;\n        }\n        var headerFooterPath;\n        var headerFooterRelsPath;\n        if (!this.headersFooters.containsKey(hfType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(hfType);\n        var hf = undefined;\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            hf = hfColl.get(id);\n            if (hfType === 'EvenHeader' || hfType === 'FirstPageHeader' ||\n                hfType === 'OddHeader') {\n                headerFooterPath = this.headerPath + id.replace('rId', '') + '.xml';\n                headerFooterRelsPath = this.headerRelationPath + id.replace('rId', '') + '.xml.rels';\n                this.serializeHeader(hf, id, headerFooterPath, headerFooterRelsPath);\n            }\n            else {\n                headerFooterPath = this.footerPath + id.replace('rId', '') + '.xml';\n                headerFooterRelsPath = this.footerRelationPath + id.replace('rId', '') + '.xml.rels';\n                this.serializeFooter(hf, id, headerFooterPath, headerFooterRelsPath);\n            }\n        }\n    };\n    // Serialize the header part\n    WordExport.prototype.serializeHeader = function (header, id, headerFooterPath, headerFooterRelsPath) {\n        this.headerFooter = header;\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'hdr', this.wNamespace);\n        this.writeHFCommonAttributes(writer);\n        var owner = this.blockOwner;\n        this.blockOwner = header;\n        this.serializeBodyItems(writer, header.blocks, true);\n        this.blockOwner = owner;\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.serializeHFRelations(id, headerFooterRelsPath);\n        this.headerFooter = undefined;\n    };\n    // Serializes the HeaderFooter relations\n    WordExport.prototype.serializeHFRelations = function (hfId, headerFooterRelsPath) {\n        var hasHFImage = this.headerFooterImages.containsKey(hfId);\n        // let hasHFHyperlinks = HeaderFooterHyperlinks.ContainsKey(hfId);\n        // let hasHFInclPics = HeaderFooterInclPicUrls.ContainsKey(hfId);\n        // let hasHFAlternateChunks = HeaderFooterAlternateChunks.ContainsKey(hfId);\n        if (hasHFImage) { // || hasHFHyperlinks ||hasHFAlternateChunks\n            var writer = new XmlWriter();\n            writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n            this.serializeImagesRelations(this.headerFooterImages.get(hfId), writer);\n            // if (hasHFHyperlinks)\n            //     SerializeHyperlinkRelations(stream, HeaderFooterHyperlinks[hfId]);\n            // if (hasHFAlternateChunks)\n            //     SerializeAltChunkRelations(stream, HeaderFooterAlternateChunks[hfId]);\n            // if (hasHFInclPics)\n            //     SerializeIncludePictureUrlRelations(stream, HeaderFooterInclPicUrls[hfId]);\n            // if (HFOleContainers.ContainsKey(hfId))\n            // {\n            //     AddOLEToZip(HFOleContainers[hfId]);\n            // }\n            // if (HFRelations.ContainsKey(hfId))\n            //     SerializeHFCommonRelations(stream, HFRelations[hfId]);\n            writer.writeEndElement();\n            var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterRelsPath);\n            this.mArchive.addItem(zipArchiveItem);\n        }\n        else {\n            return;\n        }\n    };\n    WordExport.prototype.writeHFCommonAttributes = function (writer) {\n        writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        writer.writeAttributeString('xmlns', 've', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        writer.writeAttributeString('xmlns', 'wne', undefined, this.wneNamespace);\n        writer.writeAttributeString('xmlns', 'a', undefined, this.aNamespace);\n        writer.writeAttributeString('xmlns', 'pic', undefined, this.pictureNamespace);\n        writer.writeAttributeString('xmlns', 'wp', undefined, this.wpNamespace);\n        writer.writeAttributeString('xmlns', 'wpc', undefined, this.wpCanvasNamespace);\n        writer.writeAttributeString('xmlns', 'wp14', undefined, this.wpDrawingNamespace);\n        this.writeDup(writer);\n        writer.writeAttributeString('xmlns', 'wps', undefined, this.wpShapeNamespace);\n        writer.writeAttributeString('ve', 'Ignorable', undefined, 'w14 w15 wp14');\n    };\n    // Serailize the footer and its relations\n    WordExport.prototype.serializeFooter = function (footer, id, headerFooterPath, headerFooterRelsPath) {\n        this.headerFooter = footer;\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'ftr', this.wNamespace);\n        this.writeHFCommonAttributes(writer);\n        this.serializeBodyItems(writer, footer.blocks, true);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.serializeHFRelations(id, headerFooterRelsPath);\n    };\n    WordExport.prototype.serializeDocumentRelations = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.stylesRelType, 'styles.xml');\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.settingsRelType, 'settings.xml');\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.ThemeRelType, 'theme/theme1.xml');\n        if (this.document.lists.length > 0) {\n            this.serializeRelationShip(writer, this.getNextRelationShipID(), this.numberingRelType, 'numbering.xml');\n        }\n        this.serializeHeaderFooterRelations(writer);\n        // if (HasFontTable) {\n        //     SerializeRelationShip(docRelstream, GetNextRelationShipID(), this.FontTableRelType, 'fontTable.xml');\n        // }\n        // SerializeIncludePictureUrlRelations(docRelstream, InclPicFieldUrl);\n        // //// Creating relationships for every hyperlink and image containing in the document\n        this.serializeImagesRelations(this.documentImages, writer);\n        // SerializeSvgImageRelation();\n        //this.serializeExternalLinkImages(writer);\n        // if (HasHyperlink && HyperlinkTargets.length > 0) {\n        //     SerializeHyperlinkRelations(docRelstream, HyperlinkTargets);\n        // }\n        // if (m_document.HasMacros\n        //     && IsMacroEnabled)\n        //     SerializeRelationShip(docRelstream, GetNextRelationShipID(), this.VbaProjectRelType, this.VbaProject);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.wordRelationPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.headerFooter = undefined;\n    };\n    // Serializes the image relations\n    WordExport.prototype.serializeImagesRelations = function (images, writer) {\n        if (images.length > 0) {\n            var imagePath = '';\n            var base64ImageString = void 0;\n            var keys = images.keys;\n            for (var i = 0; i < keys.length; i++) {\n                var mImage = images.get(keys[i]);\n                base64ImageString = mImage.imageString;\n                if (isNullOrUndefined(base64ImageString)) {\n                    imagePath = this.imagePath + '/0.jpeg';\n                    this.serializeRelationShip(writer, keys[i], this.imageRelType, imagePath.replace('word/', ''));\n                }\n                else {\n                    var extension = '';\n                    var formatClippedString = '';\n                    if (this.startsWith(base64ImageString, 'data:image/bmp;base64,')) {\n                        extension = '.bmp';\n                        formatClippedString = base64ImageString.replace('data:image/bmp;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/x-emf;base64,')) {\n                        extension = '.emf';\n                        formatClippedString = base64ImageString.replace('data:image/x-emf;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/exif;base64,')) {\n                        extension = '.exif';\n                        formatClippedString = base64ImageString.replace('data:image/exif;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/gif;base64,')) {\n                        extension = '.gif';\n                        formatClippedString = base64ImageString.replace('data:image/gif;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/icon;base64,')) {\n                        extension = '.ico';\n                        formatClippedString = base64ImageString.replace('data:image/icon;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/jpeg;base64,')) {\n                        extension = '.jpeg';\n                        formatClippedString = base64ImageString.replace('data:image/jpeg;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/jpg;base64,')) {\n                        extension = '.jpg';\n                        formatClippedString = base64ImageString.replace('data:image/jpg;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/png;base64,')) {\n                        extension = '.png';\n                        formatClippedString = base64ImageString.replace('data:image/png;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/tiff;base64,')) {\n                        extension = '.tif';\n                        formatClippedString = base64ImageString.replace('data:image/tiff;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/x-wmf;base64,')) {\n                        extension = '.wmf';\n                        formatClippedString = base64ImageString.replace('data:image/x-wmf;base64,', '');\n                    }\n                    else {\n                        extension = '.jpeg';\n                    }\n                    imagePath = this.imagePath + keys[i] + extension;\n                    this.serializeRelationShip(writer, keys[i], this.imageRelType, imagePath.replace('word/', ''));\n                    //if (m_archive.Find(imagePath.Replace('\\\\', '/')) === -1)\n                    // {\n                    var imageBlob = new Blob([this.encodedString(formatClippedString)]);\n                    var zipArchiveItem = new ZipArchiveItem(imageBlob, imagePath);\n                    // let TestArchive = new ZipArchive();\n                    this.mArchive.addItem(zipArchiveItem);\n                    // TestArchive.save('image.zip').then(function (): void {\n                    //     TestArchive.destroy();\n                    // });\n                    // }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.encodedString = function (input) {\n        var keyStr = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        var chr1;\n        var chr2;\n        var chr3;\n        var enc1;\n        var enc2;\n        var enc3;\n        var enc4;\n        var i = 0;\n        var resultIndex = 0;\n        /*let dataUrlPrefix: string = 'data:';*/\n        input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, '');\n        var totalLength = input.length * 3 / 4;\n        if (input.charAt(input.length - 1) === keyStr.charAt(64)) {\n            totalLength--;\n        }\n        if (input.charAt(input.length - 2) === keyStr.charAt(64)) {\n            totalLength--;\n        }\n        if (totalLength % 1 !== 0) {\n            // totalLength is not an integer, the length does not match a valid\n            // base64 content. That can happen if:\n            // - the input is not a base64 content\n            // - the input is *almost* a base64 content, with a extra chars at the\n            // beginning or at the end\n            // - the input uses a base64 variant (base64url for example)\n            throw new Error('Invalid base64 input, bad content length.');\n        }\n        var output = new Uint8Array(totalLength | 0);\n        while (i < input.length) {\n            enc1 = keyStr.indexOf(input.charAt(i++));\n            enc2 = keyStr.indexOf(input.charAt(i++));\n            enc3 = keyStr.indexOf(input.charAt(i++));\n            enc4 = keyStr.indexOf(input.charAt(i++));\n            chr1 = (enc1 << 2) | (enc2 >> 4);\n            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n            chr3 = ((enc3 & 3) << 6) | enc4;\n            output[resultIndex++] = chr1;\n            if (enc3 !== 64) {\n                output[resultIndex++] = chr2;\n            }\n            if (enc4 !== 64) {\n                output[resultIndex++] = chr3;\n            }\n        }\n        return output;\n    };\n    WordExport.prototype.serializeExternalLinkImages = function (writer) {\n        var imagePath = '';\n        var keys = this.externalImages.keys;\n        for (var i = 0; i < this.externalImages.keys.length; i++) {\n            this.serializeRelationShip(writer, keys[i], this.imageRelType, this.externalImages.get(keys[i]));\n        }\n    };\n    // Serializes the HeaderFooters relations to the document relations stream\n    WordExport.prototype.serializeHeaderFooterRelations = function (writer) {\n        this.serializeHFRelation(writer, 'EvenFooter');\n        this.serializeHFRelation(writer, 'EvenHeader');\n        this.serializeHFRelation(writer, 'FirstPageFooter');\n        this.serializeHFRelation(writer, 'FirstPageHeader');\n        this.serializeHFRelation(writer, 'OddFooter');\n        this.serializeHFRelation(writer, 'OddHeader');\n    };\n    // Serializes the headers footers relations.\n    WordExport.prototype.serializeHFRelation = function (writer, hfType) {\n        var headerFooterPath = '';\n        var relType;\n        if (!this.headersFooters.containsKey(hfType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(hfType);\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            if (hfType === 'EvenHeader' || hfType === 'FirstPageHeader' ||\n                hfType === 'OddHeader') {\n                headerFooterPath = 'header' + id.replace('rId', '') + '.xml';\n                relType = this.headerRelType;\n            }\n            else {\n                headerFooterPath = 'footer' + id.replace('rId', '') + '.xml';\n                relType = this.footerRelType;\n            }\n            this.serializeRelationShip(writer, id, relType, headerFooterPath);\n        }\n    };\n    // Serializes the relationship\n    WordExport.prototype.serializeRelationShip = function (writer, relationshipID, relationshipType, targetPath) {\n        writer.writeStartElement(undefined, 'Relationship', undefined);\n        writer.writeAttributeString(undefined, 'Id', undefined, relationshipID);\n        writer.writeAttributeString(undefined, 'Type', undefined, relationshipType);\n        writer.writeAttributeString(undefined, 'Target', undefined, targetPath.replace('\\\\', '/').replace('\\v', ''));\n        // tslint:disable-next-line:max-line-length\n        if (relationshipType === this.hyperlinkRelType || this.startsWith(targetPath, 'http://') || this.startsWith(targetPath, 'https://') || this.startsWith(targetPath, 'file:///')) {\n            // Uri targetUri;\n            // if ((!targetPath.StartsWith('file:///')) && Uri.TryCreate(targetPath, UriKind.Absolute, out targetUri))\n            // {\n            //     //Handled using Try catch to avoid exception if the Host name type is None because in \n            //Silverlight 'HostNameType' property is not available.\n            //     try\n            //     {\n            //         m_writer.WriteAttributeString('Target', targetUri.AbsoluteUri);\n            //     }\n            //     catch\n            //     {\n            //         m_writer.WriteAttributeString('Target', targetPath.Replace('\\\\', '/').Replace(ControlChar.LineBreak, string.Empty));\n            //     }\n            // }\n            // else\n            // {\n            //     m_writer.WriteAttributeString('Target', targetPath.Replace('\\\\', '/').Replace(ControlChar.LineBreak, string.Empty));\n            // }\n            writer.writeAttributeString(undefined, 'TargetMode', undefined, 'External');\n        }\n        writer.writeEndElement();\n    };\n    // Get the next relationship ID\n    WordExport.prototype.getNextRelationShipID = function () {\n        return 'rId' + (++this.mRelationShipID);\n    };\n    WordExport.prototype.serializeGeneralRelations = function () {\n        var writer = new XmlWriter();\n        this.resetRelationShipID();\n        writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.documentRelType, this.documentPath);\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.AppRelType, this.appPath);\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.CoreRelType, this.corePath);\n        //End of Relationships tag\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.generalRelationPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    WordExport.prototype.serializeContentTypes = function (contentType) {\n        var writer = new XmlWriter();\n        writer.writeStartElement(undefined, 'Types', 'http://schemas.openxmlformats.org/package/2006/content-types');\n        //if (m_hasOleObject)\n        //{\n        //    //<Default Extension='bin' ContentType='application/vnd.openxmlformats-officedocument.oleObject'/>\n        //    SerializeDefaultContentType(contentStream, 'bin', 'application/vnd.openxmlformats-officedocument.oleObject');\n        //}\n        this.serializeDefaultContentType(writer, 'rels', this.relationContentType);\n        this.serializeDefaultContentType(writer, 'xml', this.xmlContentType);\n        // if (m_hasEmbedFonts && !string.IsNullOrEmpty(type))\n        // {\n        //     SerializeDefaultContentType(contentStream,type, this.fontContentType);\n        // }\n        if (this.documentImages.length > 0 || this.externalImages.length > 0 || this.headerFooterImages.length > 0) {\n            this.serializeDefaultContentType(writer, 'png', 'image/png');\n            this.serializeDefaultContentType(writer, 'bmp', 'image/bmp');\n            this.serializeDefaultContentType(writer, 'emf', 'image/x-emf');\n            this.serializeDefaultContentType(writer, 'wmf', 'image/x-wmf');\n            this.serializeDefaultContentType(writer, 'gif', 'image/gif');\n            this.serializeDefaultContentType(writer, 'ico', 'image/x-icon');\n            this.serializeDefaultContentType(writer, 'tif', 'image/tiff');\n            this.serializeDefaultContentType(writer, 'tiff', 'image/tiff');\n            this.serializeDefaultContentType(writer, 'jpeg', 'image/jpeg');\n            this.serializeDefaultContentType(writer, 'jpg', 'image/jpeg');\n            this.serializeDefaultContentType(writer, 'svg', 'image/svg+xml');\n        }\n        // if (m_document.HasMacros\n        //     && IsMacroEnabled && !m_isSkipBinExtension)\n        // {\n        //     SerializeDefaultContentType(contentStream, 'bin', this.VbaProjectContentType);\n        //     m_isSkipBinExtension = true;\n        // }\n        // if (m_hasOleObject)\n        // {\n        //     SerializeOleContentType(contentStream);\n        // }\n        //document.xml\n        this.serializeOverrideContentType(writer, this.documentPath, this.documentContentType);\n        // tslint:disable-next-line:max-line-length\n        //<Override PartName='/word/numbering.xml' ContentType='application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml'/>\n        // if (HasNumbering) {\n        this.serializeOverrideContentType(writer, this.numberingPath, this.numberingContentType);\n        // }\n        //Add the header/footer Alternate chunks\n        // if (HeaderFooterAlternateChunks.length > 0) {\n        //     foreach(Dictionary < string, string > item in m_headerFooterAlternateChunks.Values)\n        //     AddAlternateChunkItem(item);\n        // }\n        //styles.xml\n        this.serializeOverrideContentType(writer, this.stylePath, this.stylesContentType);\n        //settings.xml\n        this.serializeOverrideContentType(writer, this.settingsPath, this.settingsContentType);\n        //             //core.xml\n        //             SerializeOverrideContentType(contentStream, this.corePath, this.CoreContentType);\n        //             //app.xml\n        //             SerializeOverrideContentType(contentStream, this.appPath, this.AppContentType);\n        //             //custom.xml\n        //             if (!isNullOrUndefined(m_document.CustomDocumentProperties) && m_document.CustomDocumentProperties.length > 0)\n        //                 SerializeOverrideContentType(contentStream, this.CustomPath, this.CustomContentType);\n        // #if Chart\n        //             if (m_hasChart)\n        //                 SerializeChartContentType(contentStream);\n        // #endif\n        this.serializeHFContentTypes(writer);\n        // WriteXmlItemsContentTypes(contentStream);\n        //End of Types tag\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.contentTypesPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    // Serializes the HeaderFooter content types\n    WordExport.prototype.serializeHFContentTypes = function (writer) {\n        this.serializeHeaderFootersContentType(writer, 'EvenFooter');\n        this.serializeHeaderFootersContentType(writer, 'EvenHeader');\n        this.serializeHeaderFootersContentType(writer, 'FirstPageFooter');\n        this.serializeHeaderFootersContentType(writer, 'FirstPageHeader');\n        this.serializeHeaderFootersContentType(writer, 'OddFooter');\n        this.serializeHeaderFootersContentType(writer, 'OddHeader');\n    };\n    // Serializes the HeaderFooter content types.\n    WordExport.prototype.serializeHeaderFootersContentType = function (writer, headerFooterType) {\n        var contentType;\n        var partName;\n        if (!this.headersFooters.containsKey(headerFooterType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(headerFooterType);\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            if (headerFooterType === 'EvenHeader' || headerFooterType === 'FirstPageHeader' ||\n                headerFooterType === 'OddHeader') {\n                partName = this.headerPath + id.replace('rId', '') + '.xml';\n                contentType = this.headerContentType;\n            }\n            else {\n                partName = this.footerPath + id.replace('rId', '') + '.xml';\n                contentType = this.footerContentType;\n            }\n            this.serializeOverrideContentType(writer, partName, contentType);\n        }\n    };\n    // Serializes the Override content type.\n    WordExport.prototype.serializeOverrideContentType = function (writer, partName, contentType) {\n        writer.writeStartElement(undefined, 'Override', undefined);\n        writer.writeAttributeString(undefined, 'PartName', undefined, '/' + partName.replace('\\\\', '/'));\n        writer.writeAttributeString(undefined, 'ContentType', undefined, contentType);\n        writer.writeEndElement();\n    };\n    // Serializes the default content type\n    WordExport.prototype.serializeDefaultContentType = function (writer, extension, contentType) {\n        writer.writeStartElement(undefined, 'Default', undefined);\n        writer.writeAttributeString(undefined, 'Extension', undefined, extension);\n        writer.writeAttributeString(undefined, 'ContentType', undefined, contentType);\n        writer.writeEndElement();\n    };\n    // Reset the relationship id counter\n    WordExport.prototype.resetRelationShipID = function () {\n        this.mRelationShipID = 0;\n    };\n    WordExport.prototype.close = function () {\n        //Implement\n    };\n    return WordExport;\n}());\nexport { WordExport };\n","import { StreamWriter } from '@syncfusion/ej2-file-utils';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Exports the document to Text format.\n */\nvar TextExport = /** @class */ (function () {\n    function TextExport() {\n        this.text = '';\n        this.curSectionIndex = 0;\n        this.inField = false;\n    }\n    TextExport.prototype.getModuleName = function () {\n        return 'TextExport';\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.save = function (viewer, fileName) {\n        this.serialize(viewer);\n        var writer = new StreamWriter();\n        this.writeInternal(writer);\n        writer.save(fileName + '.txt');\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.saveAsBlob = function (viewer) {\n        this.serialize(viewer);\n        var streamWriter = new StreamWriter();\n        this.writeInternal(streamWriter);\n        var blob = streamWriter.buffer;\n        streamWriter.destroy();\n        var promise;\n        return new Promise(function (resolve, reject) {\n            resolve(blob);\n        });\n    };\n    TextExport.prototype.serialize = function (viewer) {\n        var document = viewer.owner.sfdtExportModule.write();\n        this.setDocument(document);\n    };\n    TextExport.prototype.setDocument = function (document) {\n        this.document = document;\n        this.mSections = document.sections;\n    };\n    TextExport.prototype.writeInternal = function (streamWriter) {\n        var section = undefined;\n        var sectionCount = this.document.sections.length - 1;\n        var isLastSection = false;\n        this.updateLastParagraph();\n        for (var i = 0; i <= sectionCount; i++) {\n            section = this.document.sections[i];\n            isLastSection = (i === sectionCount) ? true : false;\n            this.writeBody(streamWriter, section.blocks);\n            this.writeNewLine(streamWriter);\n            this.writeSectionEnd(section, isLastSection);\n        }\n        for (var j = 0; j <= sectionCount; j++) {\n            section = this.document.sections[j];\n            this.writeHeadersFooters(streamWriter, section);\n        }\n    };\n    /// <summary>\n    /// Writes the specified document content to the text file.\n    /// </summary>\n    TextExport.prototype.writeBody = function (streamWriter, body) {\n        var bodyItemsCount = body.length - 1;\n        var bodyItem = undefined;\n        for (var i = 0; i <= bodyItemsCount; i++) {\n            bodyItem = body[i];\n            if (bodyItem.hasOwnProperty('inlines')) {\n                var isLastPara = (bodyItem === this.lastPara) ? true : false;\n                this.writeParagraph(streamWriter, bodyItem, isLastPara);\n            }\n            else {\n                this.writeTable(streamWriter, bodyItem);\n            }\n        }\n    };\n    TextExport.prototype.writeParagraph = function (streamWriter, paragraph, isLastPara) {\n        for (var i = 0; i < paragraph.inlines.length; i++) {\n            var item = paragraph.inlines[i];\n            if (item.hasOwnProperty('fieldType')) {\n                this.inField = item.fieldType === 0;\n            }\n            else if (item.hasOwnProperty('text') && !this.inField) {\n                this.writeText(streamWriter, item.text);\n            }\n        }\n        if (!isLastPara) {\n            this.writeNewLine(streamWriter);\n        }\n    };\n    /// }\n    /// <summary>\n    /// Writes the specified table text content to the text file.\n    /// </summary>\n    TextExport.prototype.writeTable = function (streamWriter, table) {\n        for (var i = 0; i < table.rows.length; i++) {\n            var row = table.rows[i];\n            for (var j = 0; j < row.cells.length; j++) {\n                var cell = row.cells[j];\n                this.writeBody(streamWriter, cell.blocks);\n            }\n        }\n    };\n    /// <summary>\n    /// Writes the specified Header Footer text content to the text file.\n    /// </summary>\n    TextExport.prototype.writeHeadersFooters = function (streamWriter, section) {\n        var headersFooters = section.headersFooters;\n        if (isNullOrUndefined(headersFooters)) {\n            return;\n        }\n        this.writeHeaderFooter(streamWriter, section.headersFooters.header);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.footer);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.evenFooter);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.evenHeader);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.firstPageHeader);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.firstPageFooter);\n    };\n    TextExport.prototype.writeHeaderFooter = function (streamWriter, headerFooter) {\n        if (headerFooter && headerFooter.blocks) {\n            this.writeBody(streamWriter, headerFooter.blocks);\n        }\n    };\n    /// <summary>\n    /// Writes the end of the section.\n    /// </summary>\n    TextExport.prototype.writeSectionEnd = function (section, lastSection) {\n        this.curSectionIndex++;\n    };\n    TextExport.prototype.writeNewLine = function (writer) {\n        writer.writeLine('');\n    };\n    TextExport.prototype.writeText = function (writer, text) {\n        writer.write(text);\n    };\n    TextExport.prototype.updateLastParagraph = function () {\n        var cnt = this.document.sections.length;\n        var sec;\n        if (cnt > 0) {\n            sec = this.document.sections[cnt - 1];\n        }\n        if (!isNullOrUndefined(sec)) {\n            var paragraphs = [];\n            for (var i = 0; i < sec.blocks.length; i++) {\n                if (sec.blocks[i].hasOwnProperty('inlines')) {\n                    paragraphs.push(sec.blocks[i]);\n                }\n            }\n            var pCount = paragraphs.length;\n            if (pCount > 0) {\n                this.lastPara = paragraphs[pCount - 1];\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.destroy = function () {\n        this.document = undefined;\n        this.lastPara = undefined;\n        this.mSections = undefined;\n        this.sections = undefined;\n    };\n    return TextExport;\n}());\nexport { TextExport };\n","import { LineWidget, ParagraphWidget, BodyWidget, TextElementBox, FieldElementBox, TableRowWidget, TableCellWidget, ImageElementBox, ListTextElementBox, BookmarkElementBox } from '../viewer/page';\nimport { BlockWidget } from '../viewer/page';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { StreamWriter } from '@syncfusion/ej2-file-utils';\n/**\n * Exports the document to Sfdt format.\n */\nvar SfdtExport = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SfdtExport(owner) {\n        /* tslint:disable:no-any */\n        this.endLine = undefined;\n        this.endOffset = undefined;\n        this.endCell = undefined;\n        this.startColumnIndex = undefined;\n        this.endColumnIndex = undefined;\n        this.lists = undefined;\n        this.viewer = undefined;\n        this.document = undefined;\n        this.writeInlineStyles = undefined;\n        this.viewer = owner;\n    }\n    SfdtExport.prototype.getModuleName = function () {\n        return 'SfdtExport';\n    };\n    SfdtExport.prototype.clear = function () {\n        this.writeInlineStyles = undefined;\n        this.endLine = undefined;\n        this.lists = undefined;\n        this.document = undefined;\n    };\n    /**\n     * Serialize the data as Syncfusion document text.\n     * @private\n     */\n    SfdtExport.prototype.serialize = function () {\n        return JSON.stringify(this.write());\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.saveAsBlob = function (viewer) {\n        var streamWriter = new StreamWriter();\n        streamWriter.write(this.serialize());\n        var blob = streamWriter.buffer;\n        streamWriter.destroy();\n        var promise;\n        return new Promise(function (resolve, reject) {\n            resolve(blob);\n        });\n    };\n    // tslint:disable-next-line:max-line-length\n    /**\n     * @private\n     */\n    SfdtExport.prototype.write = function (line, startOffset, endLine, endOffset, writeInlineStyles) {\n        if (writeInlineStyles) {\n            this.writeInlineStyles = true;\n        }\n        this.lists = [];\n        this.document = {};\n        this.document.sections = [];\n        this.document.characterFormat = this.writeCharacterFormat(this.viewer.characterFormat);\n        this.document.paragraphFormat = this.writeParagraphFormat(this.viewer.paragraphFormat);\n        if (line instanceof LineWidget && endLine instanceof LineWidget) {\n            // For selection\n            var startPara = line.paragraph;\n            var endPara = endLine.paragraph;\n            var startCell = startPara.associatedCell;\n            var endCell = endPara.associatedCell;\n            // Creates section\n            var bodyWidget = startPara.bodyWidget;\n            var section = this.createSection(line.paragraph.bodyWidget);\n            this.document.sections.push(section);\n            if (startCell === endCell || isNullOrUndefined(endCell)) {\n                this.endLine = endLine;\n                this.endOffset = endOffset;\n            }\n            else {\n                // Todo: Handle nested table cases\n                if (startCell instanceof TableCellWidget) {\n                    var startTable = startCell.getContainerTable();\n                    var endTable = endCell.getContainerTable();\n                    if (startTable.tableFormat === endTable.tableFormat) {\n                        this.endCell = endCell;\n                        this.endColumnIndex = this.endCell.columnIndex + this.endCell.cellFormat.columnSpan;\n                        this.startColumnIndex = startCell.columnIndex;\n                    }\n                }\n                else {\n                    this.endCell = endCell;\n                }\n            }\n            if (startCell === endCell || isNullOrUndefined(startCell)) {\n                var paragraph = this.createParagraph(line.paragraph);\n                section.blocks.push(paragraph);\n                if (!this.writeParagraph(line.paragraph, paragraph, section.blocks, line.indexInOwner, startOffset)) {\n                    // Todo:continue in next section\n                }\n            }\n            else {\n                var table = this.createTable(startCell.ownerTable);\n                section.blocks.push(table);\n                this.writeTable(startCell.ownerTable, table, startCell.ownerRow.indexInOwner, section.blocks);\n            }\n        }\n        else {\n            if (this.viewer.pages.length > 0) {\n                var page = this.viewer.pages[0];\n                if (page.bodyWidgets.length > 0) {\n                    this.writeBodyWidget(page.bodyWidgets[0], 0);\n                }\n            }\n        }\n        this.writeStyles(this.viewer);\n        this.writeLists(this.viewer);\n        var doc = this.document;\n        this.clear();\n        return doc;\n    };\n    SfdtExport.prototype.writeBodyWidget = function (bodyWidget, index) {\n        if (!(bodyWidget instanceof BodyWidget)) {\n            return true;\n        }\n        var section = this.createSection(bodyWidget);\n        this.document.sections.push(section);\n        this.writeHeaderFooters(this.viewer.headersFooters[bodyWidget.index], section);\n        if (this.writeBlock(bodyWidget.childWidgets[index], 0, section.blocks)) {\n            return true;\n        }\n        var next = bodyWidget;\n        do {\n            bodyWidget = next;\n            next = next.nextRenderedWidget;\n        } while (next instanceof BodyWidget && next.index === bodyWidget.index);\n        return this.writeBodyWidget(next, index);\n    };\n    SfdtExport.prototype.writeHeaderFooters = function (hfs, section) {\n        if (isNullOrUndefined(hfs)) {\n            return;\n        }\n        section.headersFooters.header = this.writeHeaderFooter(hfs[0]);\n        section.headersFooters.footer = this.writeHeaderFooter(hfs[1]);\n        section.headersFooters.evenHeader = this.writeHeaderFooter(hfs[2]);\n        section.headersFooters.evenFooter = this.writeHeaderFooter(hfs[3]);\n        section.headersFooters.firstPageHeader = this.writeHeaderFooter(hfs[4]);\n        section.headersFooters.firstPageFooter = this.writeHeaderFooter(hfs[5]);\n    };\n    SfdtExport.prototype.writeHeaderFooter = function (widget) {\n        if (isNullOrUndefined(widget)) {\n            return undefined;\n        }\n        var headerFooter = {};\n        if (widget && widget.childWidgets && widget.childWidgets.length > 0) {\n            headerFooter.blocks = [];\n            this.writeBlock(widget.firstChild, 0, headerFooter.blocks);\n        }\n        return headerFooter;\n    };\n    SfdtExport.prototype.createSection = function (bodyWidget) {\n        var section = {};\n        section.sectionFormat = {};\n        section.sectionFormat.pageWidth = bodyWidget.sectionFormat.pageWidth;\n        section.sectionFormat.pageHeight = bodyWidget.sectionFormat.pageHeight;\n        section.sectionFormat.leftMargin = bodyWidget.sectionFormat.leftMargin;\n        section.sectionFormat.rightMargin = bodyWidget.sectionFormat.rightMargin;\n        section.sectionFormat.topMargin = bodyWidget.sectionFormat.topMargin;\n        section.sectionFormat.bottomMargin = bodyWidget.sectionFormat.bottomMargin;\n        section.sectionFormat.differentFirstPage = bodyWidget.sectionFormat.differentFirstPage;\n        section.sectionFormat.differentOddAndEvenPages = bodyWidget.sectionFormat.differentOddAndEvenPages;\n        section.sectionFormat.headerDistance = bodyWidget.sectionFormat.headerDistance;\n        section.sectionFormat.footerDistance = bodyWidget.sectionFormat.footerDistance;\n        section.blocks = [];\n        section.headersFooters = {};\n        return section;\n    };\n    SfdtExport.prototype.writeBlock = function (widget, index, blocks) {\n        if (!(widget instanceof BlockWidget)) {\n            return true;\n        }\n        if (widget instanceof ParagraphWidget) {\n            var paragraph = this.createParagraph(widget);\n            blocks.push(paragraph);\n            if (this.writeParagraph(widget, paragraph, blocks)) {\n                return true;\n            }\n        }\n        else {\n            var tableWidget = widget;\n            var table = this.createTable(tableWidget);\n            blocks.push(table);\n            if (this.writeTable(tableWidget, table, 0, blocks)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    SfdtExport.prototype.writeNextBlock = function (widget, blocks) {\n        var next = widget.nextRenderedWidget;\n        if (next instanceof BlockWidget && next.containerWidget.index === widget.containerWidget.index) {\n            return this.writeBlock(widget.nextRenderedWidget, 0, blocks);\n        }\n        return false;\n    };\n    SfdtExport.prototype.writeParagraph = function (paragraphWidget, paragraph, blocks, lineIndex, start) {\n        if (isNullOrUndefined(lineIndex)) {\n            lineIndex = 0;\n        }\n        if (isNullOrUndefined(start)) {\n            start = 0;\n        }\n        var next = paragraphWidget;\n        while (next instanceof ParagraphWidget) {\n            if (this.writeLines(next, lineIndex, start, paragraph.inlines)) {\n                return true;\n            }\n            lineIndex = 0;\n            start = 0;\n            paragraphWidget = next;\n            next = paragraphWidget.nextSplitWidget;\n        }\n        return this.writeNextBlock(paragraphWidget, blocks);\n    };\n    SfdtExport.prototype.writeInlines = function (line, inlines) {\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            var inline = this.writeInline(element);\n            if (!isNullOrUndefined(inline)) {\n                inlines.push(inline);\n            }\n        }\n    };\n    SfdtExport.prototype.writeInline = function (element) {\n        var inline = {};\n        inline.characterFormat = this.writeCharacterFormat(element.characterFormat);\n        if (element instanceof FieldElementBox) {\n            inline.fieldType = element.fieldType;\n        }\n        else if (element instanceof ImageElementBox) {\n            inline.imageString = element.imageString;\n            inline.width = HelperMethods.convertPixelToPoint(element.width);\n            inline.height = HelperMethods.convertPixelToPoint(element.height);\n        }\n        else if (element instanceof BookmarkElementBox) {\n            inline.bookmarkType = element.bookmarkType;\n            inline.name = element.name;\n        }\n        else if (element instanceof TextElementBox) {\n            inline.text = element.text;\n        }\n        else {\n            inline = undefined;\n        }\n        return inline;\n    };\n    SfdtExport.prototype.writeLines = function (paragraph, lineIndex, offset, inlines) {\n        var startIndex = lineIndex;\n        var endParagraph = this.endLine instanceof LineWidget && this.endLine.paragraph === paragraph;\n        var endIndex = endParagraph ? this.endLine.indexInOwner : paragraph.childWidgets.length - 1;\n        for (var i = startIndex; i <= endIndex; i++) {\n            var child = paragraph.childWidgets[i];\n            if (this.endLine === child || (lineIndex === i && offset !== 0)) {\n                this.writeLine(child, offset, inlines);\n            }\n            else {\n                this.writeInlines(child, inlines);\n            }\n        }\n        return endParagraph;\n    };\n    SfdtExport.prototype.writeLine = function (line, offset, inlines) {\n        var isEnd = line === this.endLine;\n        var started = false;\n        var ended = false;\n        var length = 0;\n        for (var j = 0; j < line.children.length; j++) {\n            var element = line.children[j];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            var inline = undefined;\n            length += element.length;\n            started = length > offset;\n            ended = isEnd && length >= this.endOffset;\n            if (!started) {\n                continue;\n            }\n            inline = this.writeInline(element);\n            inlines[inlines.length] = inline;\n            if (length > offset || ended) {\n                if (inline.hasOwnProperty('text')) {\n                    var startIndex = length - element.length;\n                    var indexInInline = offset - startIndex;\n                    var endIndex = ended ? this.endOffset - startIndex : element.length;\n                    inline.text = inline.text.substring(indexInInline, endIndex);\n                }\n                offset = -1;\n            }\n            if (ended) {\n                break;\n            }\n        }\n    };\n    SfdtExport.prototype.createParagraph = function (paragraphWidget) {\n        var paragraph = {};\n        paragraph.paragraphFormat = this.writeParagraphFormat(paragraphWidget.paragraphFormat);\n        paragraph.characterFormat = this.writeCharacterFormat(paragraphWidget.characterFormat);\n        paragraph.inlines = [];\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.writeCharacterFormat = function (format, isInline) {\n        var characterFormat = {};\n        HelperMethods.writeCharacterFormat(characterFormat, isInline, format);\n        if (this.writeInlineStyles && !isInline) {\n            characterFormat.inlineFormat = this.writeCharacterFormat(format, true);\n        }\n        return characterFormat;\n    };\n    SfdtExport.prototype.writeParagraphFormat = function (format, isInline) {\n        var paragraphFormat = {};\n        paragraphFormat.leftIndent = isInline ? format.leftIndent : format.getValue('leftIndent');\n        paragraphFormat.rightIndent = isInline ? format.rightIndent : format.getValue('rightIndent');\n        paragraphFormat.firstLineIndent = isInline ? format.firstLineIndent : format.getValue('firstLineIndent');\n        paragraphFormat.textAlignment = isInline ? format.textAlignment : format.getValue('textAlignment');\n        paragraphFormat.beforeSpacing = isInline ? format.beforeSpacing : format.getValue('beforeSpacing');\n        paragraphFormat.afterSpacing = isInline ? format.afterSpacing : format.getValue('afterSpacing');\n        paragraphFormat.lineSpacing = isInline ? format.lineSpacing : format.getValue('lineSpacing');\n        paragraphFormat.lineSpacingType = isInline ? format.lineSpacingType : format.getValue('lineSpacingType');\n        paragraphFormat.styleName = !isNullOrUndefined(format.baseStyle) ? format.baseStyle.name : undefined;\n        paragraphFormat.outlineLevel = isInline ? format.outlineLevel : format.getValue('outlineLevel');\n        paragraphFormat.listFormat = this.writeListFormat(format.listFormat, isInline);\n        paragraphFormat.tabs = this.writeTabs(format.tabs);\n        if (this.writeInlineStyles && !isInline) {\n            paragraphFormat.inlineFormat = this.writeParagraphFormat(format, true);\n        }\n        return paragraphFormat;\n    };\n    SfdtExport.prototype.writeTabs = function (tabStops) {\n        if (isNullOrUndefined(tabStops) || tabStops.length < 1) {\n            return undefined;\n        }\n        var tabs = [];\n        for (var i = 0; i < tabStops.length; i++) {\n            var tabStop = tabStops[i];\n            var tab = {};\n            tab.position = tabStop.position;\n            tab.deletePosition = tabStop.deletePosition;\n            tab.tabJustification = tabStop.tabJustification;\n            tab.tabLeader = tabStop.tabLeader;\n            tabs.push(tab);\n        }\n        return tabs;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.writeListFormat = function (format, isInline) {\n        var listFormat = {};\n        var listIdValue = format.getValue('listId');\n        if (!isNullOrUndefined(listIdValue) && listIdValue > -1) {\n            listFormat.listId = listIdValue;\n            listFormat.listLevelNumber = format.getValue('listLevelNumber');\n            if (this.lists.indexOf(format.listId) < 0) {\n                this.lists.push(format.listId);\n            }\n        }\n        return listFormat;\n    };\n    SfdtExport.prototype.writeTable = function (tableWidget, table, index, blocks) {\n        var widget = tableWidget.childWidgets[index];\n        if (widget instanceof TableRowWidget) {\n            if (this.writeRow(widget, table.rows)) {\n                return true;\n            }\n        }\n        var next = tableWidget;\n        do {\n            tableWidget = next;\n            next = tableWidget.nextSplitWidget;\n        } while (next instanceof BlockWidget);\n        return this.writeNextBlock(tableWidget, blocks);\n    };\n    SfdtExport.prototype.writeRow = function (rowWidget, rows) {\n        if (!(rowWidget instanceof TableRowWidget)) {\n            return false;\n        }\n        var row = this.createRow(rowWidget);\n        rows.push(row);\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var widget = rowWidget.childWidgets[i];\n            if (widget instanceof TableCellWidget) {\n                if (rowWidget.index === widget.rowIndex\n                    && (isNullOrUndefined(this.startColumnIndex) || widget.columnIndex >= this.startColumnIndex)\n                    && (isNullOrUndefined(this.endColumnIndex) || widget.columnIndex < this.endColumnIndex)) {\n                    if (this.writeCell(widget, row.cells)) {\n                        return true;\n                    }\n                }\n            }\n        }\n        var next = rowWidget;\n        do {\n            rowWidget = next;\n            next = rowWidget.nextRenderedWidget;\n        } while (next instanceof TableRowWidget && next.index === rowWidget.index);\n        return this.writeRow(next, rows);\n    };\n    SfdtExport.prototype.writeCell = function (cellWidget, cells) {\n        var cell = this.createCell(cellWidget);\n        cells.push(cell);\n        if (this.writeBlock(cellWidget.firstChild, 0, cell.blocks)) {\n            return true;\n        }\n        return this.endCell instanceof TableCellWidget ? this.endCell.cellFormat === cellWidget.cellFormat : false;\n    };\n    SfdtExport.prototype.createTable = function (tableWidget) {\n        var table = {};\n        table.rows = [];\n        table.grid = [];\n        for (var i = 0; i < tableWidget.tableHolder.columns.length; i++) {\n            table.grid[i] = tableWidget.tableHolder.columns[i].preferredWidth;\n        }\n        table.tableFormat = this.writeTableFormat(tableWidget.tableFormat);\n        table.description = tableWidget.description;\n        table.title = tableWidget.title;\n        return table;\n    };\n    SfdtExport.prototype.createRow = function (rowWidget) {\n        var row = {};\n        row.cells = [];\n        row.rowFormat = this.writeRowFormat(rowWidget.rowFormat);\n        return row;\n    };\n    SfdtExport.prototype.createCell = function (cellWidget) {\n        var cell = {};\n        cell.blocks = [];\n        cell.cellFormat = this.writeCellFormat(cellWidget.cellFormat);\n        cell.columnIndex = cellWidget.columnIndex;\n        return cell;\n    };\n    SfdtExport.prototype.writeShading = function (wShading) {\n        var shading = {};\n        shading.backgroundColor = wShading.backgroundColor;\n        shading.foregroundColor = wShading.foregroundColor;\n        shading.textureStyle = wShading.textureStyle;\n        return shading;\n    };\n    SfdtExport.prototype.writeBorder = function (wBorder) {\n        var border = {};\n        border.color = wBorder.color;\n        border.hasNoneStyle = wBorder.hasNoneStyle;\n        border.lineStyle = wBorder.lineStyle;\n        border.lineWidth = wBorder.lineWidth;\n        border.shadow = wBorder.shadow;\n        border.space = wBorder.space;\n        return border;\n    };\n    SfdtExport.prototype.writeBorders = function (wBorders) {\n        var borders = {};\n        borders.top = this.writeBorder(wBorders.top);\n        borders.left = this.writeBorder(wBorders.left);\n        borders.right = this.writeBorder(wBorders.right);\n        borders.bottom = this.writeBorder(wBorders.bottom);\n        borders.diagonalDown = this.writeBorder(wBorders.diagonalDown);\n        borders.diagonalUp = this.writeBorder(wBorders.diagonalUp);\n        borders.horizontal = this.writeBorder(wBorders.horizontal);\n        borders.vertical = this.writeBorder(wBorders.vertical);\n        return borders;\n    };\n    SfdtExport.prototype.writeCellFormat = function (wCellFormat) {\n        var cellFormat = {};\n        cellFormat.borders = this.writeBorders(wCellFormat.borders);\n        cellFormat.shading = this.writeShading(wCellFormat.shading);\n        cellFormat.topMargin = wCellFormat.topMargin;\n        cellFormat.rightMargin = wCellFormat.rightMargin;\n        cellFormat.leftMargin = wCellFormat.leftMargin;\n        cellFormat.bottomMargin = wCellFormat.bottomMargin;\n        cellFormat.preferredWidth = wCellFormat.preferredWidth;\n        cellFormat.preferredWidthType = wCellFormat.preferredWidthType;\n        cellFormat.cellWidth = wCellFormat.cellWidth;\n        cellFormat.columnSpan = wCellFormat.columnSpan;\n        cellFormat.rowSpan = wCellFormat.rowSpan;\n        cellFormat.verticalAlignment = wCellFormat.verticalAlignment;\n        return cellFormat;\n    };\n    SfdtExport.prototype.writeRowFormat = function (wRowFormat) {\n        var rowFormat = {};\n        rowFormat.height = wRowFormat.height;\n        rowFormat.allowBreakAcrossPages = wRowFormat.allowBreakAcrossPages;\n        rowFormat.heightType = wRowFormat.heightType;\n        rowFormat.isHeader = wRowFormat.isHeader;\n        rowFormat.borders = this.writeBorders(wRowFormat.borders);\n        rowFormat.gridBefore = wRowFormat.gridBefore;\n        rowFormat.gridBeforeWidth = wRowFormat.gridBeforeWidth;\n        rowFormat.gridBeforeWidthType = wRowFormat.gridBeforeWidthType;\n        rowFormat.gridAfter = wRowFormat.gridAfter;\n        rowFormat.gridAfterWidth = wRowFormat.gridAfterWidth;\n        rowFormat.gridAfterWidthType = wRowFormat.gridAfterWidthType;\n        return rowFormat;\n    };\n    SfdtExport.prototype.writeTableFormat = function (wTableFormat) {\n        var tableFormat = {};\n        tableFormat.borders = this.writeBorders(wTableFormat.borders);\n        tableFormat.shading = this.writeShading(wTableFormat.shading);\n        tableFormat.cellSpacing = wTableFormat.cellSpacing;\n        tableFormat.leftIndent = wTableFormat.leftIndent;\n        tableFormat.tableAlignment = wTableFormat.tableAlignment;\n        tableFormat.topMargin = wTableFormat.topMargin;\n        tableFormat.rightMargin = wTableFormat.rightMargin;\n        tableFormat.leftMargin = wTableFormat.leftMargin;\n        tableFormat.bottomMargin = wTableFormat.bottomMargin;\n        tableFormat.preferredWidth = wTableFormat.preferredWidth;\n        tableFormat.preferredWidthType = wTableFormat.preferredWidthType;\n        return tableFormat;\n    };\n    SfdtExport.prototype.writeStyles = function (viewer) {\n        var styles = [];\n        this.document.styles = [];\n        for (var i = 0; i < viewer.styles.length; i++) {\n            this.document.styles.push(this.writeStyle(viewer.styles.getItem(i)));\n        }\n    };\n    SfdtExport.prototype.writeStyle = function (style) {\n        var wStyle = {};\n        wStyle.name = style.name;\n        if (style.type === 'Paragraph') {\n            wStyle.type = 'Paragraph';\n            wStyle.paragraphFormat = this.writeParagraphFormat(style.paragraphFormat);\n            wStyle.characterFormat = this.writeCharacterFormat(style.characterFormat);\n        }\n        if (style.type === 'Character') {\n            wStyle.type = 'Character';\n            wStyle.characterFormat = this.writeCharacterFormat(style.characterFormat);\n        }\n        if (!isNullOrUndefined(style.basedOn)) {\n            wStyle.basedOn = style.basedOn.name;\n        }\n        if (!isNullOrUndefined(style.link)) {\n            wStyle.link = style.link.name;\n        }\n        if (!isNullOrUndefined(style.next)) {\n            wStyle.next = style.next.name;\n        }\n        return wStyle;\n    };\n    SfdtExport.prototype.writeLists = function (viewer) {\n        var abstractLists = [];\n        this.document.lists = [];\n        for (var i = 0; i < viewer.lists.length; i++) {\n            var list = viewer.lists[i];\n            if (this.lists.indexOf(list.listId) > -1) {\n                this.document.lists.push(this.writeList(list));\n                if (abstractLists.indexOf(list.abstractListId) < 0) {\n                    abstractLists.push(list.abstractListId);\n                }\n            }\n        }\n        this.document.abstractLists = [];\n        for (var i = 0; i < viewer.abstractLists.length; i++) {\n            var abstractList = viewer.abstractLists[i];\n            if (this.lists.indexOf(abstractList.abstractListId) > -1) {\n                this.document.abstractLists.push(this.writeAbstractList(abstractList));\n            }\n        }\n    };\n    SfdtExport.prototype.writeAbstractList = function (wAbstractList) {\n        var abstractList = {};\n        abstractList.abstractListId = wAbstractList.abstractListId;\n        abstractList.levels = [];\n        for (var i = 0; i < wAbstractList.levels.length; i++) {\n            abstractList.levels[i] = this.writeListLevel(wAbstractList.levels[i]);\n        }\n        return abstractList;\n    };\n    SfdtExport.prototype.writeList = function (wList) {\n        var list = {};\n        list.abstractListId = wList.abstractListId;\n        //list.levelOverrides = wList.levelOverrides;\n        list.listId = wList.listId;\n        return list;\n    };\n    SfdtExport.prototype.writeListLevel = function (wListLevel) {\n        var listLevel = {};\n        listLevel.characterFormat = this.writeCharacterFormat(wListLevel.characterFormat);\n        listLevel.paragraphFormat = this.writeParagraphFormat(wListLevel.paragraphFormat);\n        listLevel.followCharacter = wListLevel.followCharacter;\n        listLevel.listLevelPattern = wListLevel.listLevelPattern;\n        listLevel.numberFormat = wListLevel.numberFormat;\n        listLevel.restartLevel = wListLevel.restartLevel;\n        listLevel.startAt = wListLevel.startAt;\n        return listLevel;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.destroy = function () {\n        this.lists = undefined;\n        this.endLine = undefined;\n        this.endOffset = undefined;\n        this.viewer = undefined;\n    };\n    return SfdtExport;\n}());\nexport { SfdtExport };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\n/**\n * The Hyperlink dialog is used to insert or edit hyperlink at selection.\n */\n/* tslint:disable:max-line-length */\nvar HyperlinkDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function HyperlinkDialog(viewer) {\n        var _this = this;\n        this.displayText = '';\n        this.navigationUrl = undefined;\n        this.bookmarkDropdown = undefined;\n        this.bookmarkCheckbox = undefined;\n        this.bookmarks = [];\n        /**\n         * @private\n         */\n        this.onKeyUpOnUrlBox = function (event) {\n            if (event.keyCode === 13) {\n                if (_this.displayTextBox.value !== '' && _this.urlTextBox.value !== '') {\n                    _this.onInsertHyperlink();\n                }\n                return;\n            }\n            var selectedText = _this.owner.selection.text;\n            var urlValue = _this.urlTextBox.value;\n            if (urlValue.substring(0, 4).toLowerCase() === 'www.') {\n                _this.urlTextBox.value = 'http://' + urlValue;\n            }\n            if (_this.displayText === '') {\n                _this.displayTextBox.value = urlValue;\n            }\n            _this.enableOrDisableInsertButton();\n        };\n        /**\n         * @private\n         */\n        this.onKeyUpOnDisplayBox = function () {\n            _this.displayText = _this.displayTextBox.value;\n            _this.enableOrDisableInsertButton();\n        };\n        /**\n         * @private\n         */\n        this.onInsertButtonClick = function () {\n            _this.onInsertHyperlink();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.clearValue();\n        };\n        /**\n         * @private\n         */\n        this.loadHyperlinkDialog = function () {\n            _this.owner.updateFocus();\n            _this.bookmarks = [];\n            for (var i = 0; i < _this.owner.bookmarks.keys.length; i++) {\n                var bookmark = _this.owner.bookmarks.keys[i];\n                if (bookmark.indexOf('_') !== 0) {\n                    _this.bookmarks.push(bookmark);\n                }\n            }\n            var fieldBegin = _this.owner.selection.getHyperlinkField();\n            if (!isNullOrUndefined(fieldBegin)) {\n                if (!isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    var format = undefined;\n                    // tslint:disable-next-line:max-line-length\n                    var fieldObj = _this.owner.selection.getHyperlinkDisplayText(fieldBegin.fieldSeparator.line.paragraph, fieldBegin.fieldSeparator, fieldBegin.fieldEnd, false, format);\n                    _this.displayText = fieldObj.displayText;\n                    _this.displayTextBox.disabled = fieldObj.isNestedField;\n                }\n                _this.displayTextBox.value = _this.displayText;\n                var link = _this.owner.selection.getLinkText(fieldBegin);\n                _this.urlTextBox.value = _this.navigationUrl = link;\n                _this.owner.dialog.header = _this.localObj.getConstant('Edit Hyperlink');\n            }\n            else {\n                _this.displayText = _this.owner.selection.getText(true);\n                if (_this.displayText !== '') {\n                    if (_this.displayText.indexOf(String.fromCharCode(65532)) !== -1 ||\n                        _this.displayText.indexOf('\\r') !== -1 && (_this.displayText.lastIndexOf('\\r') !== -1 &&\n                            _this.displayText.slice(0, -1).indexOf('\\r') !== -1)) {\n                        _this.displayTextBox.value = '<<Selection in document>>';\n                        _this.displayTextBox.disabled = true;\n                    }\n                    else {\n                        _this.displayTextBox.value = _this.displayText;\n                    }\n                }\n            }\n            _this.bookmarkDiv.style.display = 'none';\n            _this.addressText.style.display = 'block';\n            _this.urlTextBox.style.display = 'block';\n            _this.bookmarkCheckbox.checked = false;\n            _this.bookmarkDropdown.dataSource = _this.owner.bookmarks.keys;\n            _this.insertButton = document.getElementsByClassName('e-hyper-insert')[0];\n            _this.enableOrDisableInsertButton();\n            _this.urlTextBox.focus();\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.closeHyperlinkDialog = function () {\n            _this.clearValue();\n            _this.owner.updateFocus();\n        };\n        /* tslint:disable:no-any */\n        this.onUseBookmarkChange = function (args) {\n            if (args.checked) {\n                _this.bookmarkDiv.style.display = 'block';\n                _this.bookmarkDropdown.dataSource = _this.bookmarks;\n                _this.addressText.style.display = 'none';\n                _this.urlTextBox.style.display = 'none';\n            }\n            else {\n                _this.bookmarkDiv.style.display = 'none';\n                _this.addressText.style.display = 'block';\n                _this.urlTextBox.style.display = 'block';\n            }\n        };\n        this.onBookmarkchange = function (args) {\n            if (_this.bookmarkDropdown.value !== '') {\n                _this.insertButton.disabled = false;\n            }\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.getModuleName = function () {\n        return 'HyperlinkDialog';\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.initHyperlinkDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_hyperlink';\n        this.target = createElement('div', { id: id, className: 'e-de-hyperlink' });\n        var container = createElement('div');\n        var displayText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Text to display') });\n        this.displayTextBox = createElement('input', { id: this.owner.owner.containerId + '_display_text', className: 'e-input e-de-hyperlink-dlg-input' });\n        this.displayTextBox.addEventListener('keyup', instance.onKeyUpOnDisplayBox);\n        container.appendChild(displayText);\n        container.appendChild(this.displayTextBox);\n        this.addressText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Address') });\n        this.urlTextBox = createElement('input', { id: this.owner.owner.containerId + '_url_text', className: 'e-input e-de-hyperlink-dlg-input', attrs: { autofocus: 'true' } });\n        this.urlTextBox.addEventListener('input', instance.onKeyUpOnUrlBox);\n        this.urlTextBox.addEventListener('keyup', instance.onKeyUpOnUrlBox);\n        container.appendChild(this.addressText);\n        container.appendChild(this.urlTextBox);\n        this.bookmarkDiv = createElement('div', { styles: 'display:none;' });\n        var bookmarkText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Bookmark') });\n        var bookmarkTextElement = createElement('div', { className: 'e-de-hyperlink-dlg-bookmark' });\n        // tslint:disable-next-line:max-line-length\n        var bookmarkValue = createElement('input', { id: 'e-de-hyperlink-dlg-bookmark-value' });\n        bookmarkTextElement.appendChild(bookmarkValue);\n        // tslint:disable-next-line:max-line-length\n        this.bookmarkDropdown = new DropDownList({ dataSource: [], change: this.onBookmarkchange, popupHeight: '230px', width: '230px', noRecordsTemplate: localValue.getConstant('No bookmarks found') });\n        this.bookmarkDropdown.appendTo(bookmarkValue);\n        this.bookmarkDiv.appendChild(bookmarkText);\n        this.bookmarkDiv.appendChild(bookmarkTextElement);\n        container.appendChild(this.bookmarkDiv);\n        // tslint:disable-next-line:max-line-length\n        var bookmarkCheckDiv = createElement('div', { className: 'e-de-hyperlink-bookmark-check e-de-hyperlink-dlg-title' });\n        var bookmarkCheck = createElement('input', { attrs: { type: 'checkbox' }, id: this.target.id + '_bookmark', className: this.target.id + '_bookmarkcheck' });\n        bookmarkCheckDiv.appendChild(bookmarkCheck);\n        this.bookmarkCheckbox = new CheckBox({ label: localValue.getConstant('Use bookmarks'), change: this.onUseBookmarkChange });\n        this.bookmarkCheckbox.appendTo(bookmarkCheck);\n        container.appendChild(bookmarkCheckDiv);\n        this.target.appendChild(container);\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.show = function () {\n        this.localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        this.localObj.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initHyperlinkDialog(this.localObj);\n        }\n        this.owner.dialog.header = this.localObj.getConstant('Insert Hyperlink');\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertButtonClick,\n                buttonModel: { content: this.localObj.getConstant('Ok'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: this.localObj.getConstant('Cancel'), cssClass: 'e-flat e-hyper-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.beforeOpen = this.loadHyperlinkDialog;\n        this.owner.dialog.close = this.closeHyperlinkDialog;\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.hide = function () {\n        this.closeHyperlinkDialog();\n    };\n    HyperlinkDialog.prototype.enableOrDisableInsertButton = function () {\n        if (!isNullOrUndefined(this.insertButton)) {\n            // tslint:disable-next-line:max-line-length\n            this.insertButton.disabled = (this.urlTextBox.value === '' || this.displayTextBox.value === '');\n        }\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.onInsertHyperlink = function () {\n        var displayText = this.displayTextBox.value.trim();\n        var address = this.urlTextBox.value.trim();\n        var isBookmark = false;\n        if (!isNullOrUndefined(this.bookmarkDropdown.value) && this.bookmarkDropdown.value !== '') {\n            address = this.bookmarkDropdown.value;\n            isBookmark = true;\n        }\n        if (address === '') {\n            this.owner.dialog.hide();\n            return;\n        }\n        if (displayText === '' && address !== '') {\n            displayText = address;\n        }\n        else {\n            displayText = this.displayTextBox.value;\n        }\n        if (!isNullOrUndefined(this.navigationUrl)) {\n            this.owner.owner.editorModule.editHyperlink(this.owner.selection, address, displayText, isBookmark);\n        }\n        else {\n            var remove = this.owner.selection.text !== displayText && !this.displayTextBox.disabled;\n            this.owner.owner.editorModule.insertHyperlink(address, displayText, remove, isBookmark);\n        }\n        this.owner.dialog.hide();\n        this.navigationUrl = undefined;\n    };\n    /* tslint:enable:no-any */\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.clearValue = function () {\n        this.displayTextBox.value = '';\n        this.urlTextBox.value = '';\n        this.displayText = '';\n        this.displayTextBox.disabled = false;\n        this.bookmarks = [];\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.destroy = function () {\n        if (this.displayTextBox) {\n            this.displayTextBox.innerHTML = '';\n            this.displayTextBox = undefined;\n        }\n        if (this.urlTextBox) {\n            this.urlTextBox.parentElement.removeChild(this.urlTextBox);\n            this.urlTextBox = undefined;\n        }\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            this.target.innerHTML = '';\n            this.target = undefined;\n        }\n    };\n    return HyperlinkDialog;\n}());\nexport { HyperlinkDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { L10n, createElement, setCulture, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The Table dialog is used to insert table at selection.\n */\nvar TableDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.keyUpInsertTable = function (event) {\n            if (event.keyCode === 13) {\n                if (_this.rowsCountBox.value !== '' && _this.columnsCountBox.value !== '') {\n                    _this.onInsertTableClick();\n                }\n            }\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.onInsertTableClick = function () {\n            var rowCount = _this.rowValueTextBox.value;\n            var columnCount = _this.columnValueTexBox.value;\n            if (!(isNullOrUndefined(rowCount) && isNullOrUndefined(columnCount))) {\n                _this.owner.owner.editor.insertTable(rowCount, columnCount);\n            }\n            _this.owner.dialog.hide();\n        };\n        this.owner = viewer;\n    }\n    TableDialog.prototype.getModuleName = function () {\n        return 'TableDialog';\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.initTableDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_Table';\n        this.target = createElement('div', { id: id, className: 'e-de-insert-table' });\n        var parentDiv = createElement('div');\n        var columnContainer = createElement('div', {\n            className: 'e-de-insert-table-dlg-sub-header', innerHTML: localValue.getConstant('Number of columns')\n        });\n        var columnValue = createElement('div', { className: 'e-de-insert-table-dlg-input' });\n        this.columnsCountBox = createElement('input', {\n            attrs: { type: 'text' }, id: this.owner.owner.containerId + '_column'\n        });\n        columnValue.appendChild(this.columnsCountBox);\n        var rowContainer = createElement('div', {\n            className: 'e-de-insert-table-dlg-sub-header', innerHTML: localValue.getConstant('Number of rows')\n        });\n        var rowValue = createElement('div', { className: 'e-de-insert-table-dlg-input' });\n        this.rowsCountBox = createElement('input', {\n            attrs: { type: 'text' }, id: this.owner.owner.containerId + 'row'\n        });\n        rowValue.appendChild(this.rowsCountBox);\n        parentDiv.appendChild(columnContainer);\n        parentDiv.appendChild(columnValue);\n        parentDiv.appendChild(rowContainer);\n        parentDiv.appendChild(rowValue);\n        this.target.appendChild(parentDiv);\n        this.columnsCountBox.addEventListener('keyup', instance.keyUpInsertTable);\n        this.rowsCountBox.addEventListener('keyup', instance.keyUpInsertTable);\n        this.rowValueTextBox = new NumericTextBox({\n            format: '#',\n            value: 2,\n            min: 1,\n            max: 32767,\n            enablePersistence: false\n        });\n        this.rowValueTextBox.appendTo(this.rowsCountBox);\n        this.columnValueTexBox = new NumericTextBox({\n            format: '#',\n            value: 2,\n            min: 1,\n            max: 63,\n            enablePersistence: false\n        });\n        this.columnValueTexBox.appendTo(this.columnsCountBox);\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableDialog(localValue);\n        }\n        if (this.owner.selection.caret.style.display !== 'none') {\n            this.owner.selection.caret.style.display = 'none';\n        }\n        this.owner.dialog.header = localValue.getConstant('Insert Table');\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertTableClick,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-table-ok', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-table-cancel' }\n            }];\n        this.rowValueTextBox.value = 2;\n        this.columnValueTexBox.value = 2;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.destroy = function () {\n        if (this.columnsCountBox) {\n            if (this.columnsCountBox.parentElement) {\n                this.columnsCountBox.parentElement.removeChild(this.columnsCountBox);\n            }\n            this.columnsCountBox = undefined;\n        }\n        if (this.rowsCountBox) {\n            if (this.rowsCountBox.parentElement) {\n                this.rowsCountBox.parentElement.removeChild(this.rowsCountBox);\n            }\n            this.rowsCountBox = undefined;\n        }\n        if (this.columnValueTexBox) {\n            this.columnValueTexBox.destroy();\n            this.columnValueTexBox = undefined;\n        }\n        if (this.rowValueTextBox) {\n            this.rowValueTextBox.destroy();\n            this.rowValueTextBox = undefined;\n        }\n        this.columnsCountBox = undefined;\n        this.rowsCountBox = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var i = 0; i < this.target.childNodes.length; i++) {\n                this.target.removeChild(this.target.childNodes[i]);\n                i--;\n            }\n            this.target = undefined;\n        }\n    };\n    return TableDialog;\n}());\nexport { TableDialog };\n","import { ListView } from '@syncfusion/ej2-lists';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\n/**\n * The Bookmark dialog is used to add, navigate or delete bookmarks.\n */\nvar BookmarkDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BookmarkDialog(viewer) {\n        var _this = this;\n        this.addBookmark = function () {\n            _this.owner.owner.editorModule.insertBookmark(_this.textBoxInput.value);\n            _this.owner.dialog.hide();\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.textBoxInput.value = args.text;\n            /* tslint:disable:no-any */\n            var value = document.getElementById('bookmark_text_box');\n            value.setSelectionRange(0, args.text.length);\n            value.focus();\n        };\n        this.gotoBookmark = function () {\n            _this.owner.selection.selectBookmark(_this.textBoxInput.value);\n        };\n        this.deleteBookmark = function () {\n            _this.owner.owner.editorModule.deleteBookmark(_this.textBoxInput.value);\n            _this.show();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.getModuleName = function () {\n        return 'BookmarkDialog';\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.initBookmarkDialog = function (localValue, bookmarks) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_bookmark';\n        this.target = createElement('div', { id: id, className: 'e-de-bookmark' });\n        var headerValue = localValue.getConstant('Bookmark name') + ':';\n        var dlgFields = createElement('div', { innerHTML: headerValue, className: 'e-bookmark-dlgfields' });\n        this.target.appendChild(dlgFields);\n        var commonDiv = createElement('div', { className: 'e-bookmark-common' });\n        this.target.appendChild(commonDiv);\n        var searchDiv = createElement('div', { className: 'e-bookmark-list' });\n        commonDiv.appendChild(searchDiv);\n        var textBoxDiv = createElement('div', { className: 'e-bookmark-textboxdiv' });\n        searchDiv.appendChild(textBoxDiv);\n        // tslint:disable-next-line:max-line-length\n        this.textBoxInput = createElement('input', { className: 'e-input e-bookmark-textbox-input', id: 'bookmark_text_box' });\n        this.textBoxInput.setAttribute('type', 'text');\n        textBoxDiv.appendChild(this.textBoxInput);\n        var listviewDiv = createElement('div', { className: 'e-bookmark-listViewDiv', id: 'bookmark_listview' });\n        searchDiv.appendChild(listviewDiv);\n        var arts = this.owner.bookmarks.keys;\n        this.listviewInstance = new ListView({\n            dataSource: bookmarks,\n            cssClass: 'e-bookmark-listview',\n        });\n        this.listviewInstance.appendTo(listviewDiv);\n        this.listviewInstance.addEventListener('select', this.selectHandler);\n        var buttonDiv = createElement('div', { className: 'e-bookmark-button' });\n        commonDiv.appendChild(buttonDiv);\n        var addbuttonDiv = createElement('div', { className: 'e-bookmark-addbutton' });\n        buttonDiv.appendChild(addbuttonDiv);\n        var addButtonElement = createElement('button', { innerHTML: 'Add', id: 'add' });\n        addbuttonDiv.appendChild(addButtonElement);\n        var addbutton = new Button({ cssClass: 'e-button-custom' });\n        addbutton.appendTo(addButtonElement);\n        addButtonElement.addEventListener('click', this.addBookmark);\n        var deleteButtonDiv = createElement('div', { className: 'e-bookmark-deletebutton' });\n        buttonDiv.appendChild(deleteButtonDiv);\n        var deleteButtonElement = createElement('button', { innerHTML: 'Delete', id: 'delete' });\n        deleteButtonDiv.appendChild(deleteButtonElement);\n        var deletebutton = new Button({ cssClass: 'e-button-custom' });\n        deletebutton.appendTo(deleteButtonElement);\n        deleteButtonElement.addEventListener('click', this.deleteBookmark);\n        var gotoButtonDiv = createElement('div', { className: 'e-bookmark-gotobutton' });\n        buttonDiv.appendChild(gotoButtonDiv);\n        var gotoButtonElement = createElement('button', { innerHTML: 'Go To', id: 'goto' });\n        gotoButtonDiv.appendChild(gotoButtonElement);\n        var gotobutton = new Button({ cssClass: 'e-button-custom' });\n        gotobutton.appendTo(gotoButtonElement);\n        gotoButtonElement.addEventListener('click', this.gotoBookmark);\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.show = function () {\n        var bookmarks = this.owner.getBookmarks();\n        var localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localObj.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        // if (!this.target) {\n        this.initBookmarkDialog(localObj, bookmarks);\n        //}\n        this.owner.dialog.header = 'Bookmark';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.buttons = [{\n                click: this.removeObjects.bind(this),\n                buttonModel: { content: localObj.getConstant('Cancel'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BookmarkDialog.prototype.removeObjects = function () {\n        this.owner.dialog.hide();\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.destroy = function () {\n        if (this.textBoxInput) {\n            this.textBoxInput.remove();\n            this.textBoxInput = undefined;\n        }\n        if (this.listviewInstance) {\n            this.listviewInstance.destroy();\n            this.listviewInstance = undefined;\n        }\n    };\n    return BookmarkDialog;\n}());\nexport { BookmarkDialog };\n","import { L10n, setCulture, createElement, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { CheckBox, Button } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { ListView } from '@syncfusion/ej2-lists';\n/**\n * The Table of contents dialog is used to insert or edit table of contents at selection.\n */\nvar TableOfContentsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableOfContentsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.loadTableofContentDialog = function () {\n            _this.owner.updateFocus();\n            _this.pageNumber.checked = true;\n            _this.rightAlign.disabled = false;\n            _this.rightAlign.checked = true;\n            _this.tabLeader.enabled = true;\n            _this.hyperlink.checked = true;\n            _this.style.checked = true;\n            _this.outline.checked = true;\n            _this.outline.disabled = false;\n            _this.showLevel.enabled = true;\n        };\n        /**\n         * @private\n         */\n        this.closeTableOfContentDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.textBoxInput.value = args.text;\n            /* tslint:disable:no-any */\n            var value = document.getElementById('toclist');\n            value.setSelectionRange(0, args.text.length);\n            value.focus();\n        };\n        this.showStyleDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.styleDialogModule)) {\n                _this.owner.owner.styleDialogModule.show(_this.textBoxInput.value);\n            }\n        };\n        this.changeShowLevelValue = function (event) {\n            var levels = event.value;\n            var values = [];\n            switch (levels) {\n                case 1:\n                    values = ['1', null, null, null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 2:\n                    values = ['1', '2', null, null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 3:\n                    values = ['1', '2', '3', null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 4:\n                    values = ['1', '2', '3', '4', null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 5:\n                    values = ['1', '2', '3', '4', '5', null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 6:\n                    values = ['1', '2', '3', '4', '5', '6', null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 7:\n                    values = ['1', '2', '3', '4', '5', '6', '7', null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 8:\n                    values = ['1', '2', '3', '4', '5', '6', '7', '8', null];\n                    _this.changeByValue(values);\n                    break;\n                case 9:\n                    values = ['1', '2', '3', '4', '5', '6', '7', '8', '9'];\n                    _this.changeByValue(values);\n                    break;\n            }\n        };\n        this.changeByValue = function (headings) {\n            _this.heading1.value = headings[0];\n            _this.heading2.value = headings[1];\n            _this.heading3.value = headings[2];\n            _this.heading4.value = headings[3];\n            _this.heading5.value = headings[4];\n            _this.heading6.value = headings[5];\n            _this.heading7.value = headings[6];\n            _this.heading8.value = headings[7];\n            _this.heading9.value = headings[8];\n        };\n        this.reset = function () {\n            _this.showLevel.enabled = true;\n            _this.showLevel.value = 3;\n            _this.outline.disabled = false;\n            _this.outline.checked = true;\n            var values = ['1', '2', '3', null, null, null, null, null, null];\n            _this.changeByValue(values);\n            _this.normal.value = null;\n        };\n        this.changeStyle = function (args) {\n            var headingValue = args.srcElement.value;\n            var value = _this.getElementValue(args.srcElement);\n            if (headingValue !== value && headingValue !== '') {\n                _this.showLevel.enabled = false;\n            }\n            else {\n                _this.showLevel.enabled = true;\n                _this.checkLevel();\n            }\n        };\n        this.changeHeadingStyle = function (args) {\n            var headingValue = args.srcElement.value;\n            if (headingValue === '') {\n                _this.showLevel.enabled = true;\n            }\n            else {\n                _this.showLevel.enabled = false;\n            }\n            if (_this.normal === args.srcElement) {\n                _this.outline.checked = false;\n                _this.outline.disabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changePageNumberValue = function (args) {\n            if (args.checked) {\n                _this.rightAlign.checked = true;\n                _this.rightAlign.disabled = false;\n                _this.tabLeader.enabled = true;\n            }\n            else {\n                _this.rightAlign.disabled = true;\n                _this.tabLeader.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeRightAlignValue = function (args) {\n            if (args.checked) {\n                _this.tabLeader.enabled = true;\n            }\n            else {\n                _this.tabLeader.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeStyleValue = function (args) {\n            if (args.checked) {\n                _this.heading1.disabled = false;\n                _this.heading2.disabled = false;\n                _this.heading3.disabled = false;\n                _this.heading4.disabled = false;\n                _this.heading5.disabled = false;\n                _this.heading6.disabled = false;\n                _this.heading7.disabled = false;\n                _this.heading8.disabled = false;\n                _this.heading9.disabled = false;\n                _this.normal.disabled = false;\n            }\n            else {\n                _this.heading1.disabled = true;\n                _this.heading2.disabled = true;\n                _this.heading3.disabled = true;\n                _this.heading4.disabled = true;\n                _this.heading5.disabled = true;\n                _this.heading6.disabled = true;\n                _this.heading7.disabled = true;\n                _this.heading8.disabled = true;\n                _this.heading9.disabled = true;\n                _this.normal.disabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyTableOfContentProperties = function () {\n            var tocSettings = {\n                startLevel: 1,\n                endLevel: _this.showLevel.value,\n                includeHyperlink: _this.hyperlink.checked,\n                includePageNumber: _this.pageNumber.checked,\n                rightAlign: _this.rightAlign.checked,\n                tabLeader: _this.tabLeader.value,\n                includeOutlineLevels: _this.outline.checked\n            };\n            _this.applyLevelSetting(tocSettings);\n            _this.owner.owner.editorModule.insertTableOfContents(tocSettings);\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.unWireEventsAndBindings = function () {\n            _this.pageNumber.checked = false;\n            _this.rightAlign.checked = false;\n            _this.tabLeader.value = '';\n            _this.hyperlink.checked = false;\n            _this.style.checked = false;\n            _this.outline.checked = false;\n            _this.normal.value = '';\n        };\n        this.owner = viewer;\n    }\n    TableOfContentsDialog.prototype.getModuleName = function () {\n        return 'TableOfContentsDialog';\n    };\n    /*tslint:disable max-func-body-length*/\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.initTableOfContentDialog = function (locale) {\n        var instance = this;\n        var ownerId = this.owner.owner.containerId;\n        var id = ownerId + '_toc_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-toc-dlg-container' });\n        this.owner.owner.element.appendChild(this.target);\n        // tslint:disable-next-line:max-line-length\n        var generalDiv = createElement('div', { id: 'general_div', className: 'e-de-toc-dlg-sub-container' });\n        this.target.appendChild(generalDiv);\n        // tslint:disable-next-line:max-line-length\n        var genLabel = createElement('div', { id: ownerId + '_genLabel', className: 'e-de-toc-dlg-main-heading', styles: 'margin-bottom: 13px;', innerHTML: locale.getConstant('General') });\n        generalDiv.appendChild(genLabel);\n        // tslint:disable-next-line:max-line-length\n        var leftGeneralDiv = createElement('div', { id: 'left_general', styles: 'float:left;position:relative;' });\n        generalDiv.appendChild(leftGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightGeneralDiv = createElement('div', { styles: 'position:relative;', className: 'e-de-toc-dlg-right-general-div' });\n        generalDiv.appendChild(rightGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var leftBottomGeneralDiv = createElement('div', { id: 'leftBottom_general', styles: 'float:left;position:absolute;top:210px;' });\n        generalDiv.appendChild(leftBottomGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightBottomGeneralDiv = createElement('div', { className: 'e-de-toc-dlg-right-sub-container', styles: 'float:right;' });\n        generalDiv.appendChild(rightBottomGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var pageNumberDiv = createElement('div', { id: 'pageNumber_div', className: 'e-de-toc-dlg-sub-container' });\n        var pageNumber = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_pageNumber'\n        });\n        pageNumberDiv.appendChild(pageNumber);\n        // tslint:disable-next-line:max-line-length\n        var rightAlignDiv = createElement('div', { id: 'rightAlign_div', className: 'e-de-toc-dlg-sub-container' });\n        var rightAlign = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_rightAlign'\n        });\n        rightAlignDiv.appendChild(rightAlign);\n        // tslint:disable-next-line:max-line-length\n        this.pageNumber = new CheckBox({ label: locale.getConstant('Show page numbers'), checked: true, change: this.changePageNumberValue });\n        // tslint:disable-next-line:max-line-length\n        this.rightAlign = new CheckBox({ label: locale.getConstant('Right align page numbers'), checked: true, change: this.changeRightAlignValue });\n        this.pageNumber.appendTo(pageNumber);\n        this.rightAlign.appendTo(rightAlign);\n        var tabDiv = createElement('div', { id: 'tab_div', className: 'e-de-toc-dlg-tab-div' });\n        // tslint:disable-next-line:max-line-length\n        var tabLeaderLabelDiv = createElement('div', { id: 'tabLeaderLabel_div' });\n        // tslint:disable-next-line:max-line-length\n        var tabLeaderLabel = createElement('label', { id: ownerId + '_tabLeaderLabel', className: 'e-de-toc-dlg-heading', innerHTML: locale.getConstant('Tab leader') + ':' });\n        tabLeaderLabelDiv.appendChild(tabLeaderLabel);\n        var tabLeaderDiv = createElement('div', { id: 'tabLeader_div' });\n        var tabLeader = createElement('select', {\n            id: ownerId + '_tabLeader',\n            innerHTML: '<option value=\"None\">' + '(' + locale.getConstant('None').toLocaleLowerCase() + ')' +\n                '</option><option value=\"Dot\" selected>' + '....................' +\n                '</option><option value=\"Hyphen\">' + '-------------------' +\n                '</option><option value=\"Underscore\">' + '____________' + '</option>'\n        });\n        tabLeaderDiv.appendChild(tabLeader);\n        tabDiv.appendChild(tabLeaderLabelDiv);\n        tabDiv.appendChild(tabLeaderDiv);\n        leftGeneralDiv.appendChild(pageNumberDiv);\n        leftGeneralDiv.appendChild(rightAlignDiv);\n        leftGeneralDiv.appendChild(tabDiv);\n        this.tabLeader = new DropDownList({ width: 210 });\n        this.tabLeader.appendTo(tabLeader);\n        var hyperlink = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_hyperlink'\n        });\n        rightGeneralDiv.appendChild(hyperlink);\n        this.hyperlink = new CheckBox({ label: locale.getConstant('Use hyperlinks instead of page numbers'), checked: true });\n        this.hyperlink.appendTo(hyperlink);\n        // tslint:disable-next-line:max-line-length\n        var showDiv = createElement('div', { id: 'show_div', className: 'e-de-toc-dlg-style-label' });\n        // tslint:disable-next-line:max-line-length\n        var showLevelLabelDiv = createElement('div', { id: 'showLevelLabel_div', className: 'e-de-toc-dlg-show-level-div' });\n        // tslint:disable-next-line:max-line-length\n        var showLevelLabel = createElement('label', { id: ownerId + '_showLevelLabel', className: 'e-de-toc-dlg-heading', innerHTML: locale.getConstant('Show levels') + ':' });\n        showLevelLabelDiv.appendChild(showLevelLabel);\n        // tslint:disable-next-line:max-line-length\n        var showLevelDiv = createElement('div', { id: 'showLevel_div', className: 'e-de-toc-dlg-showlevel-div' });\n        // tslint:disable-next-line:max-line-length\n        var showLevel = createElement('input', { id: ownerId + '_showLevel', attrs: { 'type': 'text' } });\n        showLevelDiv.appendChild(showLevel);\n        showDiv.appendChild(showLevelLabelDiv);\n        showDiv.appendChild(showLevelDiv);\n        rightGeneralDiv.appendChild(showDiv);\n        this.showLevel = new NumericTextBox({ format: '#', value: 3, min: 1, max: 9, width: 210, change: this.changeShowLevelValue });\n        this.showLevel.appendTo(showLevel);\n        // tslint:disable-next-line:max-line-length\n        var buildTableDiv = createElement('div', { id: 'buildTable_div', className: 'e-de-toc-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var buildTableLabel = createElement('div', { id: ownerId + '_buildTableLabel', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-build-table', styles: 'margin-bottom: 13px;', innerHTML: locale.getConstant('Build table of contents from') + ':' });\n        leftBottomGeneralDiv.appendChild(buildTableDiv);\n        leftBottomGeneralDiv.appendChild(buildTableLabel);\n        var style = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_style',\n        });\n        leftBottomGeneralDiv.appendChild(style);\n        this.style = new CheckBox({ label: locale.getConstant('Styles'), checked: true, change: this.changeStyleValue });\n        this.style.appendTo(style);\n        var table = createElement('TABLE', { styles: 'margin-top:3px;' });\n        var tr1 = createElement('tr');\n        var td1 = createElement('td', { styles: 'width:120px;padding-left:10px;' });\n        var availableLabel = createElement('label', {\n            // tslint:disable-next-line:max-line-length\n            innerHTML: locale.getConstant('Available styles'), className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading', id: this.target.id + '_availableLabel'\n        });\n        td1.appendChild(availableLabel);\n        var td2 = createElement('td');\n        var tocLabel = createElement('label', {\n            innerHTML: locale.getConstant('TOC level') + ':', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading',\n            id: this.target.id + '_tocLabel'\n        });\n        td2.appendChild(tocLabel);\n        tr1.appendChild(td1);\n        tr1.appendChild(td2);\n        table.appendChild(tr1);\n        // tslint:disable-next-line:max-line-length\n        var tableDiv = createElement('div', { id: 'table_div', className: 'e-de-toc-table-div' });\n        var table1 = createElement('TABLE');\n        var tr2 = createElement('tr');\n        var td3 = createElement('td');\n        var heading1Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 1',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading1Label'\n        });\n        td3.appendChild(heading1Label);\n        var td4 = createElement('td');\n        this.heading1 = createElement('input', { id: '_heading1', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading1.value = '1';\n        this.heading1.addEventListener('keyup', this.changeStyle);\n        td4.appendChild(this.heading1);\n        tr2.appendChild(td3);\n        tr2.appendChild(td4);\n        var tr3 = createElement('tr');\n        var td5 = createElement('td');\n        var heading2Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 2',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading2Label'\n        });\n        td5.appendChild(heading2Label);\n        var td6 = createElement('td');\n        this.heading2 = createElement('input', { id: '_heading2', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading2.value = '2';\n        this.heading2.addEventListener('keyup', this.changeStyle);\n        td6.appendChild(this.heading2);\n        tr3.appendChild(td5);\n        tr3.appendChild(td6);\n        var tr4 = createElement('tr');\n        var td7 = createElement('td');\n        var heading3Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 3',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading3Label'\n        });\n        td7.appendChild(heading3Label);\n        var td8 = createElement('td');\n        this.heading3 = createElement('input', { id: '_heading3', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading3.value = '3';\n        this.heading3.addEventListener('keyup', this.changeStyle);\n        td8.appendChild(this.heading3);\n        tr4.appendChild(td7);\n        tr4.appendChild(td8);\n        var tr5 = createElement('tr');\n        var td9 = createElement('td');\n        var heading4Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 4',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading4Label'\n        });\n        td9.appendChild(heading4Label);\n        var td10 = createElement('td');\n        this.heading4 = createElement('input', { id: '_heading4', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading4.addEventListener('keyup', this.changeStyle);\n        td10.appendChild(this.heading4);\n        tr5.appendChild(td9);\n        tr5.appendChild(td10);\n        var tr6 = createElement('tr');\n        var td11 = createElement('td');\n        var heading5Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 5',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading5Label'\n        });\n        td11.appendChild(heading5Label);\n        var td12 = createElement('td');\n        this.heading5 = createElement('input', { id: '_heading5', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading5.addEventListener('keyup', this.changeStyle);\n        td12.appendChild(this.heading5);\n        tr6.appendChild(td11);\n        tr6.appendChild(td12);\n        var tr7 = createElement('tr');\n        var td13 = createElement('td');\n        var heading6Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 6',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading6Label'\n        });\n        td13.appendChild(heading6Label);\n        var td14 = createElement('td');\n        this.heading6 = createElement('input', { id: '_heading6', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading6.addEventListener('keyup', this.changeStyle);\n        td14.appendChild(this.heading6);\n        tr7.appendChild(td13);\n        tr7.appendChild(td14);\n        var tr8 = createElement('tr');\n        var td15 = createElement('td');\n        var heading7Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 7',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading7Label'\n        });\n        td15.appendChild(heading7Label);\n        var td16 = createElement('td');\n        this.heading7 = createElement('input', { id: '_heading7', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading7.addEventListener('keyup', this.changeStyle);\n        td16.appendChild(this.heading7);\n        tr8.appendChild(td15);\n        tr8.appendChild(td16);\n        var tr9 = createElement('tr');\n        var td17 = createElement('td');\n        var heading8Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 8',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading8Label'\n        });\n        td17.appendChild(heading8Label);\n        var td18 = createElement('td');\n        this.heading8 = createElement('input', { id: '_heading8', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading8.addEventListener('keyup', this.changeStyle);\n        td18.appendChild(this.heading8);\n        tr9.appendChild(td17);\n        tr9.appendChild(td18);\n        var tr10 = createElement('tr');\n        var td19 = createElement('td');\n        var heading9Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 9',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading9Label'\n        });\n        td19.appendChild(heading9Label);\n        var td20 = createElement('td');\n        this.heading9 = createElement('input', { id: '_heading9', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading9.addEventListener('keyup', this.changeStyle);\n        td20.appendChild(this.heading9);\n        tr10.appendChild(td19);\n        tr10.appendChild(td20);\n        var tr12 = createElement('tr');\n        var td23 = createElement('td');\n        var normalLabel = createElement('label', {\n            innerHTML: locale.getConstant('Normal'),\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_normalLabel'\n        });\n        td23.appendChild(normalLabel);\n        var td24 = createElement('td');\n        this.normal = createElement('input', { id: '_normal', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.normal.addEventListener('keyup', this.changeHeadingStyle);\n        td24.appendChild(this.normal);\n        tr12.appendChild(td23);\n        tr12.appendChild(td24);\n        table1.appendChild(tr2);\n        table1.appendChild(tr3);\n        table1.appendChild(tr4);\n        table1.appendChild(tr5);\n        table1.appendChild(tr6);\n        table1.appendChild(tr7);\n        table1.appendChild(tr8);\n        table1.appendChild(tr9);\n        table1.appendChild(tr10);\n        table1.appendChild(tr12);\n        tableDiv.appendChild(table1);\n        var stylesLevelDiv = createElement('div', { className: 'e-de-toc-styles-table-div' });\n        stylesLevelDiv.appendChild(table);\n        stylesLevelDiv.appendChild(tableDiv);\n        leftBottomGeneralDiv.appendChild(stylesLevelDiv);\n        //leftBottomGeneralDiv.appendChild(table); leftBottomGeneralDiv.appendChild(tableDiv);\n        var fieldsDiv = createElement('div', { id: 'fields_div', styles: 'display: flex;' });\n        leftBottomGeneralDiv.appendChild(fieldsDiv);\n        var outDiv = createElement('div', { id: 'out_div' });\n        // tslint:disable-next-line:max-line-length\n        var outlineDiv = createElement('div', { id: 'outline_div', className: 'e-de-toc-dlg-sub-container e-de-toc-dlg-outline-levels' });\n        var outline = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: '_outline'\n        });\n        outlineDiv.appendChild(outline);\n        outDiv.appendChild(outlineDiv);\n        fieldsDiv.appendChild(outDiv);\n        this.outline = new CheckBox({ label: locale.getConstant('Outline levels'), checked: true });\n        this.outline.appendTo(outline);\n        var resetButtonDiv = createElement('div', { className: 'e-de-toc-reset-button' });\n        fieldsDiv.appendChild(resetButtonDiv);\n        var resetElement = createElement('button', { innerHTML: 'Reset', id: 'reset' });\n        resetButtonDiv.appendChild(resetElement);\n        var resetButton = new Button({ cssClass: 'e-btn e-flat' });\n        resetButton.appendTo(resetElement);\n        resetElement.addEventListener('click', this.reset);\n        // tslint:disable-next-line:max-line-length\n        var tocStylesDiv = createElement('div', { id: 'tocStyles_div', className: 'e-de-toc-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var tocStylesLabel = createElement('div', {\n            id: ownerId + '_tocStylesLabel', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-styles',\n            innerHTML: locale.getConstant('Styles') + ':'\n        });\n        rightBottomGeneralDiv.appendChild(tocStylesDiv);\n        rightBottomGeneralDiv.appendChild(tocStylesLabel);\n        var textBoxDiv = createElement('div', { className: 'e-de-toc-dlg-style-input' });\n        rightBottomGeneralDiv.appendChild(textBoxDiv);\n        this.textBoxInput = createElement('input', { className: 'e-input', id: 'toclist' });\n        this.textBoxInput.setAttribute('type', 'text');\n        textBoxDiv.appendChild(this.textBoxInput);\n        var listViewDiv = createElement('div', { className: 'e-de-toc-list-view' });\n        var styleValues = ['TOC 1', 'TOC 2', 'TOC 3', 'TOC 4', 'TOC 5', 'TOC 6', 'TOC 7', 'TOC 8', 'TOC 9'];\n        this.listViewInstance = new ListView({ dataSource: styleValues, cssClass: 'e-toc-list-view' });\n        this.listViewInstance.appendTo(listViewDiv);\n        this.listViewInstance.addEventListener('select', this.selectHandler);\n        rightBottomGeneralDiv.appendChild(listViewDiv);\n        var modifyButtonDiv = createElement('div', { className: 'e-de-toc-modify-button' });\n        rightBottomGeneralDiv.appendChild(modifyButtonDiv);\n        var modifyElement = createElement('button', { innerHTML: 'Modify', id: 'modify' });\n        modifyButtonDiv.appendChild(modifyElement);\n        var modifyButton = new Button({ cssClass: 'e-btn e-flat' });\n        modifyButton.appendTo(modifyElement);\n        modifyElement.addEventListener('click', this.showStyleDialog);\n    };\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableOfContentDialog(localValue);\n        }\n        this.owner.dialog.header = localValue.getConstant('Table of Contents');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadTableofContentDialog;\n        this.owner.dialog.close = this.closeTableOfContentDialog;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableOfContentProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-toc-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-toc-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    TableOfContentsDialog.prototype.checkLevel = function () {\n        if (this.heading1.value !== '') {\n            this.showLevel.value = 1;\n        }\n        if (this.heading2.value !== '') {\n            this.showLevel.value = 2;\n        }\n        if (this.heading3.value !== '') {\n            this.showLevel.value = 3;\n        }\n        if (this.heading4.value !== '') {\n            this.showLevel.value = 4;\n        }\n        if (this.heading5.value !== '') {\n            this.showLevel.value = 5;\n        }\n        if (this.heading6.value !== '') {\n            this.showLevel.value = 6;\n        }\n        if (this.heading7.value !== '') {\n            this.showLevel.value = 7;\n        }\n        if (this.heading8.value !== '') {\n            this.showLevel.value = 8;\n        }\n        if (this.heading9.value !== '') {\n            this.showLevel.value = 9;\n        }\n    };\n    TableOfContentsDialog.prototype.getElementValue = function (element) {\n        switch (element) {\n            case this.heading1:\n                return '1';\n            case this.heading2:\n                return '2';\n            case this.heading3:\n                return '3';\n            case this.heading4:\n                return '4';\n            case this.heading5:\n                return '5';\n            case this.heading6:\n                return '6';\n            case this.heading7:\n                return '7';\n            case this.heading8:\n                return '8';\n            case this.heading9:\n                return '9';\n            default:\n                return '1';\n        }\n    };\n    TableOfContentsDialog.prototype.getHeadingLevel = function (index) {\n        switch (index) {\n            case 1:\n                return parseInt(this.heading1.value);\n            case 2:\n                return parseInt(this.heading2.value);\n            case 3:\n                return parseInt(this.heading3.value);\n            case 4:\n                return parseInt(this.heading4.value);\n            case 5:\n                return parseInt(this.heading5.value);\n            case 6:\n                return parseInt(this.heading6.value);\n            case 7:\n                return parseInt(this.heading7.value);\n            case 8:\n                return parseInt(this.heading8.value);\n            case 9:\n                return parseInt(this.heading9.value);\n            default:\n                return 0;\n        }\n    };\n    TableOfContentsDialog.prototype.applyLevelSetting = function (tocSettings) {\n        tocSettings.levelSettings = {};\n        var headingPrefix = 'Heading ';\n        var newStartLevel = 0;\n        var newEndLevel = 0;\n        var isEndLevel = false;\n        for (var i = 1; i <= tocSettings.endLevel; i++) {\n            var outlineLevel = this.getHeadingLevel(i);\n            if (i === outlineLevel) {\n                if (newStartLevel === 0) {\n                    newStartLevel = i;\n                    isEndLevel = false;\n                }\n                if (!isEndLevel) {\n                    newEndLevel = i;\n                }\n            }\n            else {\n                isEndLevel = true;\n                if (outlineLevel !== 0) {\n                    var headingStyle = headingPrefix + i.toString();\n                    tocSettings.levelSettings[headingStyle] = outlineLevel;\n                }\n            }\n        }\n        tocSettings.startLevel = newStartLevel;\n        tocSettings.endLevel = newEndLevel;\n        if (this.normal.value !== '') {\n            tocSettings.levelSettings['Normal'] = +this.normal.value;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.destroy = function () {\n        if (this.pageNumber) {\n            this.pageNumber.destroy();\n            this.pageNumber = undefined;\n        }\n        if (this.rightAlign) {\n            this.rightAlign.destroy();\n            this.rightAlign = undefined;\n        }\n        if (this.tabLeader) {\n            this.tabLeader.destroy();\n            this.tabLeader = undefined;\n        }\n        if (this.showLevel) {\n            this.showLevel.destroy();\n            this.showLevel = undefined;\n        }\n        if (this.hyperlink) {\n            this.hyperlink.destroy();\n            this.hyperlink = undefined;\n        }\n        if (this.style) {\n            this.style.destroy();\n            this.style = undefined;\n        }\n        if (this.outline) {\n            this.outline.destroy();\n            this.outline = undefined;\n        }\n        if (this.listViewInstance) {\n            this.listViewInstance.destroy();\n            this.listViewInstance = undefined;\n        }\n        this.heading1 = undefined;\n        this.heading2 = undefined;\n        this.heading3 = undefined;\n        this.heading4 = undefined;\n        this.heading5 = undefined;\n        this.heading6 = undefined;\n        this.heading7 = undefined;\n        this.heading8 = undefined;\n        this.heading9 = undefined;\n        this.normal = undefined;\n        this.textBoxInput = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var count = 0; count < this.target.childNodes.length; count++) {\n                this.target.removeChild(this.target.childNodes[count]);\n                count--;\n            }\n            this.target = undefined;\n        }\n    };\n    return TableOfContentsDialog;\n}());\nexport { TableOfContentsDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox, RadioButton } from '@syncfusion/ej2-buttons';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WSectionFormat } from './../../implementation/format/index';\nimport { Tab } from '@syncfusion/ej2-navigations';\n/**\n * The Page setup dialog is used to modify formatting of selected sections.\n */\nvar PageSetupDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function PageSetupDialog(viewer) {\n        var _this = this;\n        this.isPortrait = true;\n        /**\n         * @private\n         */\n        this.loadPageSetupDialog = function () {\n            _this.owner.updateFocus();\n            var sectionFormat = _this.owner.selection.sectionFormat;\n            _this.topMarginBox.value = sectionFormat.topMargin;\n            _this.leftMarginBox.value = sectionFormat.leftMargin;\n            _this.bottomMarginBox.value = sectionFormat.bottomMargin;\n            _this.rightMarginBox.value = sectionFormat.rightMargin;\n            _this.widthBox.value = sectionFormat.pageWidth;\n            _this.heightBox.value = sectionFormat.pageHeight;\n            _this.checkBox1.checked = sectionFormat.differentOddAndEvenPages;\n            _this.checkBox2.checked = sectionFormat.differentFirstPage;\n            _this.headerBox.value = sectionFormat.headerDistance;\n            _this.footerBox.value = sectionFormat.footerDistance;\n            if (_this.widthBox.value > _this.heightBox.value) {\n                _this.landscape.checked = true;\n            }\n            else {\n                _this.portrait.checked = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.closePageSetupDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.keyUpInsertPageSettings = function (event) {\n            if (event.keyCode === 13) {\n                _this.applyPageSetupProperties();\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyPageSetupProperties = function () {\n            var sectionFormat = new WSectionFormat();\n            sectionFormat.bottomMargin = _this.bottomMarginBox.value;\n            sectionFormat.topMargin = _this.topMarginBox.value;\n            sectionFormat.leftMargin = _this.leftMarginBox.value;\n            sectionFormat.rightMargin = _this.rightMarginBox.value;\n            sectionFormat.pageWidth = _this.widthBox.value;\n            sectionFormat.pageHeight = _this.heightBox.value;\n            sectionFormat.differentOddAndEvenPages = _this.checkBox1.checked;\n            sectionFormat.differentFirstPage = _this.checkBox2.checked;\n            sectionFormat.headerDistance = _this.headerBox.value;\n            sectionFormat.footerDistance = _this.footerBox.value;\n            _this.owner.owner.editorModule.onApplySectionFormat(undefined, sectionFormat);\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.changeByPaperSize = function (event) {\n            var value = event.value;\n            var sectionFormat = _this.owner.selection.sectionFormat;\n            var width = sectionFormat.pageWidth;\n            var height = sectionFormat.pageHeight;\n            if (_this.owner.selection.sectionFormat.pageWidth > _this.owner.selection.sectionFormat.pageHeight || _this.landscape.checked) {\n                _this.isPortrait = false;\n            }\n            else {\n                _this.isPortrait = true;\n            }\n            if (value === 'letter') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 792;\n                }\n                else {\n                    _this.widthBox.value = 792;\n                    _this.heightBox.value = 612;\n                }\n            }\n            else if (value === 'tabloid') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 792;\n                    _this.heightBox.value = 1224;\n                }\n                else {\n                    _this.widthBox.value = 1224;\n                    _this.heightBox.value = 792;\n                }\n            }\n            else if (value === 'legal') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 1008;\n                }\n                else {\n                    _this.widthBox.value = 1008;\n                    _this.heightBox.value = 612;\n                }\n            }\n            else if (value === 'statement') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 392;\n                    _this.heightBox.value = 612;\n                }\n                else {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 392;\n                }\n            }\n            else if (value === 'executive') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 522;\n                    _this.heightBox.value = 756;\n                }\n                else {\n                    _this.widthBox.value = 756;\n                    _this.heightBox.value = 522;\n                }\n            }\n            else if (value === 'a3') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 841.9;\n                    _this.heightBox.value = 1190.55;\n                }\n                else {\n                    _this.widthBox.value = 1190.55;\n                    _this.heightBox.value = 841.9;\n                }\n            }\n            else if (value === 'a4') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 595.3;\n                    _this.heightBox.value = 841.9;\n                }\n                else {\n                    _this.widthBox.value = 841.9;\n                    _this.heightBox.value = 595.3;\n                }\n            }\n            else if (value === 'a5') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 419.55;\n                    _this.heightBox.value = 595.3;\n                }\n                else {\n                    _this.widthBox.value = 595.3;\n                    _this.heightBox.value = 419.55;\n                }\n            }\n            else if (value === 'b4') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 1031.8;\n                }\n                else {\n                    _this.widthBox.value = 1031.8;\n                    _this.heightBox.value = 728.5;\n                }\n            }\n            else if (value === 'b5') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 515.9;\n                    _this.heightBox.value = 728.5;\n                }\n                else {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 515.9;\n                }\n            }\n            else if (value === 'customsize') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 515.9;\n                    _this.heightBox.value = 728.5;\n                }\n                else {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 515.9;\n                }\n            }\n        };\n        /**\n         * @private\n         */\n        this.onPortrait = function (event) {\n            _this.landscape.checked = false;\n            var width = _this.widthBox.value;\n            var height = _this.heightBox.value;\n            if (width > height) {\n                _this.widthBox.value = height;\n                _this.heightBox.value = width;\n            }\n        };\n        /**\n         * @private\n         */\n        this.onLandscape = function (event) {\n            _this.portrait.checked = false;\n            var width = _this.widthBox.value;\n            var height = _this.heightBox.value;\n            if (width < height) {\n                _this.widthBox.value = height;\n                _this.heightBox.value = width;\n            }\n        };\n        /**\n         * @private\n         */\n        this.unWireEventsAndBindings = function () {\n            _this.paperSize.value = undefined;\n            _this.topMarginBox.value = undefined;\n            _this.bottomMarginBox.value = undefined;\n            _this.leftMarginBox.value = undefined;\n            _this.rightMarginBox.value = undefined;\n            _this.headerBox.value = undefined;\n            _this.footerBox.value = undefined;\n            _this.widthBox.value = undefined;\n            _this.heightBox.value = undefined;\n            _this.checkBox1.checked = false;\n            _this.checkBox2.checked = false;\n            _this.portrait.checked = false;\n            _this.landscape.checked = false;\n        };\n        this.owner = viewer;\n    }\n    PageSetupDialog.prototype.getModuleName = function () {\n        return 'PageSetupDialog';\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initPageSetupDialog = function (locale) {\n        var id = this.owner.owner.containerId + '_pagesetup_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-pagesetup-dlg-container' });\n        this.owner.owner.element.appendChild(this.target);\n        var ejtabContainer = createElement('div', { id: this.target.id + '_MarginTabContainer' });\n        this.target.appendChild(ejtabContainer);\n        this.marginTab = createElement('div', {\n            id: this.target.id + '_marginPropertyTab', styles: 'position: relative;width:400px;'\n        });\n        this.paperTab = createElement('div', {\n            id: this.target.id + '_paperSizePropertyTab', styles: 'position: relative;width:400px;'\n        });\n        this.layoutTab = createElement('div', {\n            id: this.target.id + '_CellPropertiesDialogTab', styles: 'position: relative;width:400px;'\n        });\n        // tslint:disable-next-line:max-line-length\n        var ejtab = createElement('div', { id: this.target.id + '_PageSetupDialogTab', className: 'e-de-page-setup-ppty-tab' });\n        var headerContainer = createElement('div', { className: 'e-tab-header' });\n        var marginHeader = createElement('div', {\n            id: this.target.id + '_marginHeader', innerHTML: locale.getConstant('Margin')\n        });\n        var paperHeader = createElement('div', {\n            id: this.target.id + '_paperHeader', innerHTML: locale.getConstant('Paper')\n        });\n        var layoutHeader = createElement('div', {\n            id: this.target.id + '_layoutHeader', innerHTML: locale.getConstant('Layout')\n        });\n        headerContainer.appendChild(marginHeader);\n        headerContainer.appendChild(paperHeader);\n        headerContainer.appendChild(layoutHeader);\n        var contentContainer = createElement('div', { className: 'e-content' });\n        var marginContent = createElement('div', { id: this.target.id + '_marginContent' });\n        var paperContent = createElement('div', { id: this.target.id + '_paperContent' });\n        var layoutContent = createElement('div', { id: this.target.id + '_layoutContent' });\n        marginContent.appendChild(this.marginTab);\n        paperContent.appendChild(this.paperTab);\n        layoutContent.appendChild(this.layoutTab);\n        contentContainer.appendChild(marginContent);\n        contentContainer.appendChild(paperContent);\n        contentContainer.appendChild(layoutContent);\n        ejtab.appendChild(headerContainer);\n        ejtab.appendChild(contentContainer);\n        ejtabContainer.appendChild(ejtab);\n        this.initMarginProperties(this.marginTab, locale);\n        this.initPaperSizeProperties(this.paperTab, locale);\n        this.initLayoutProperties(this.layoutTab, locale);\n        var tabObj = new Tab({}, ejtab);\n        this.target.addEventListener('keyup', this.keyUpInsertPageSettings);\n        var marginTabHeader = tabObj.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        var marginTabHeaderItem = marginTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        marginTabHeaderItem.classList.add('e-de-page-setup-dlg-margin-tab-header');\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initMarginProperties = function (element, locale) {\n        var marginDiv = createElement('div', {\n            id: 'margin_div',\n            className: 'e-de-page-setup-dlg-sub-container', styles: 'height:135px;'\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftMarginDiv = createElement('div', { id: 'left_margin', className: 'e-de-page-setup-dlg-left-sub-container' });\n        marginDiv.appendChild(leftMarginDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightMarginDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-sub-container' });\n        marginDiv.appendChild(rightMarginDiv);\n        var topLabel = createElement('label', {\n            innerHTML: locale.getConstant('Top'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_TopLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var topTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_Top'\n        });\n        var bottomBoxLabel = createElement('label', {\n            innerHTML: locale.getConstant('Bottom'),\n            className: 'e-de-page-setup-dlg-sub-title-header', id: this.target.id + '_bottomLabel'\n        });\n        var bottomTextBox = createElement('input', {\n            attrs: { 'type': 'text' },\n            id: this.target.id + '_bottom'\n        });\n        leftMarginDiv.appendChild(topLabel);\n        leftMarginDiv.appendChild(topTextBox);\n        leftMarginDiv.appendChild(bottomBoxLabel);\n        leftMarginDiv.appendChild(bottomTextBox);\n        var leftBoxLabel = createElement('label', {\n            innerHTML: locale.getConstant('Left'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_leftLabel'\n        });\n        var leftTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_left'\n        });\n        var rightLabel = createElement('label', {\n            innerHTML: locale.getConstant('Right'),\n            id: this.target.id + '_rightLabel', className: 'e-de-page-setup-dlg-sub-title-header'\n        });\n        var rightTextBox = createElement('input', {\n            attrs: { 'type': 'text' },\n            id: this.target.id + '_right'\n        });\n        rightMarginDiv.appendChild(leftBoxLabel);\n        rightMarginDiv.appendChild(leftTextBox);\n        rightMarginDiv.appendChild(rightLabel);\n        rightMarginDiv.appendChild(rightTextBox);\n        element.appendChild(marginDiv);\n        this.topMarginBox = new NumericTextBox({ value: 71, width: 170, decimals: 2 });\n        this.topMarginBox.appendTo(topTextBox);\n        this.leftMarginBox = new NumericTextBox({ value: 73, width: 170, decimals: 2 });\n        this.leftMarginBox.appendTo(leftTextBox);\n        this.bottomMarginBox = new NumericTextBox({ value: 72, width: 170, decimals: 2 });\n        this.bottomMarginBox.appendTo(bottomTextBox);\n        this.rightMarginBox = new NumericTextBox({ value: 74, width: 170, decimals: 2 });\n        this.rightMarginBox.appendTo(rightTextBox);\n        // tslint:disable-next-line:max-line-length\n        var orientationDiv = createElement('div', { id: 'orientation_div', className: 'e-de-page-setup-dlg-sub-container-port' });\n        // tslint:disable-next-line:max-line-length\n        var orientationLabeldiv = createElement('div', { id: '_orientationLabelDiv', className: 'e-de-page-setup-dlg-sub-label', innerHTML: locale.getConstant('Orientation') });\n        var orientationPropDiv = createElement('div', { id: '_orientationPropDiv', styles: 'display: flex;', className: 'e-de-page-setup-dlg-orientation-prop' });\n        var portraitDiv = createElement('div', { id: '_portraitDiv', styles: 'padding-right: 30px;' });\n        var portrait = createElement('input', {\n            attrs: { 'type': 'radiobutton' }, id: this.target.id + '_portrait'\n        });\n        var landscapeDiv = createElement('div', { id: '_landscapeDiv' });\n        var landscape = createElement('input', {\n            attrs: { 'type': 'radiobutton' }, id: this.target.id + '_landscape'\n        });\n        portraitDiv.appendChild(portrait);\n        landscapeDiv.appendChild(landscape);\n        orientationPropDiv.appendChild(portraitDiv);\n        orientationPropDiv.appendChild(landscapeDiv);\n        orientationDiv.appendChild(orientationLabeldiv);\n        orientationDiv.appendChild(orientationPropDiv);\n        this.portrait = new RadioButton({ label: locale.getConstant('Portrait'), checked: true, change: this.onPortrait });\n        this.landscape = new RadioButton({ label: locale.getConstant('Landscape'), change: this.onLandscape });\n        this.portrait.appendTo(portrait);\n        this.landscape.appendTo(landscape);\n        element.appendChild(orientationDiv);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initPaperSizeProperties = function (element, locale) {\n        var sizeDiv = createElement('div', {\n            id: 'size_div',\n            className: 'e-de-page-setup-dlg-sub-size-container'\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftSizeDiv = createElement('div', { id: 'left_size', className: 'e-de-page-setup-dlg-left-sub-container' });\n        sizeDiv.appendChild(leftSizeDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightSizeDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-sub-container' });\n        sizeDiv.appendChild(rightSizeDiv);\n        var widthLabel = createElement('label', {\n            innerHTML: locale.getConstant('Width'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_widthLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var widthTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_Width'\n        });\n        leftSizeDiv.appendChild(widthLabel);\n        leftSizeDiv.appendChild(widthTextBox);\n        var heightLabel = createElement('label', {\n            innerHTML: locale.getConstant('Height'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_heightLabel'\n        });\n        var heightTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_height'\n        });\n        rightSizeDiv.appendChild(heightLabel);\n        rightSizeDiv.appendChild(heightTextBox);\n        element.appendChild(sizeDiv);\n        this.widthBox = new NumericTextBox({ value: 612, width: 170, decimals: 2 });\n        this.widthBox.appendTo(widthTextBox);\n        this.heightBox = new NumericTextBox({ value: 792, width: 170, decimals: 2 });\n        this.heightBox.appendTo(heightTextBox);\n        // tslint:disable-next-line:max-line-length\n        var paperSizeDiv = createElement('div', { id: '_paperSizeDiv', styles: 'height:37px;', className: 'e-de-page-setup-dlg-sub-container' });\n        var paperSize = createElement('select', {\n            id: this.target.id + '_papersize', styles: 'width:170px;padding-bottom: 20px;',\n            innerHTML: '<option value=\"letter\">' + locale.getConstant('Letter') +\n                '</option><option value=\"tabloid\">' + locale.getConstant('Tabloid') +\n                '</option><option value=\"legal\">' + locale.getConstant('Legal') +\n                '</option><option value=\"statement\">' + locale.getConstant('Statement') +\n                '</option><option value=\"executive\">' + locale.getConstant('Executive') +\n                '</option><option value=\"a3\">' + locale.getConstant('A3') +\n                '</option><option value=\"a4\">' + locale.getConstant('A4') +\n                '</option><option value=\"a5\">' + locale.getConstant('A5') +\n                '</option><option value=\"b4\">' + locale.getConstant('B4') +\n                '</option><option value=\"b5\">' + locale.getConstant('B5') +\n                '</option><option value=\"customsize\">' + locale.getConstant('Custom Size') + '</option>'\n        });\n        paperSizeDiv.appendChild(paperSize);\n        this.paperSize = new DropDownList({ change: this.changeByPaperSize, width: '170px' });\n        this.paperSize.appendTo(paperSize);\n        element.appendChild(paperSizeDiv);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initLayoutProperties = function (element, locale) {\n        // tslint:disable-next-line:max-line-length\n        var layoutDiv = createElement('div', { id: '_layoutDiv', className: 'e-de-page-setup-dlg-layout-sub-container', });\n        // tslint:disable-next-line:max-line-length\n        var firstPageDiv = createElement('div', { id: '_firstPageDiv', styles: 'height: 27px;', className: 'e-de-page-setup-dlg-first-page-prop' });\n        var checkBox1 = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_oddoreven'\n        });\n        firstPageDiv.appendChild(checkBox1);\n        // tslint:disable-next-line:max-line-length\n        var oddOrEvenDiv = createElement('div', { id: '_oddOrEvenDiv', styles: 'height: 27px;', className: 'e-de-page-setup-dlg-odd-or-even-prop' });\n        var checkBox2 = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_even'\n        });\n        oddOrEvenDiv.appendChild(checkBox2);\n        layoutDiv.appendChild(firstPageDiv);\n        layoutDiv.appendChild(oddOrEvenDiv);\n        this.checkBox1 = new CheckBox({ label: locale.getConstant('Different odd and even') });\n        this.checkBox2 = new CheckBox({ label: locale.getConstant('Different first page') });\n        this.checkBox1.appendTo(checkBox1);\n        this.checkBox2.appendTo(checkBox2);\n        element.appendChild(layoutDiv);\n        // tslint:disable-next-line:max-line-length\n        var textLabelDiv = createElement('div', { id: '_textLabelDiv', className: 'e-de-page-setup-dlg-sub-label' });\n        var textLabel = createElement('label', {\n            innerHTML: locale.getConstant('From edge'), id: this.target.id + '_textLabel'\n        });\n        textLabelDiv.appendChild(textLabel);\n        element.appendChild(textLabelDiv);\n        // tslint:disable-next-line:max-line-length\n        var propertyDiv = createElement('div', { id: '_headerFooeterPropDiv', className: 'e-de-page-setup-dlg-sub-container', styles: 'height: 65px;' });\n        // tslint:disable-next-line:max-line-length\n        var leftLayoutDiv = createElement('div', { id: '_leftLayoutDiv', className: 'e-de-page-setup-dlg-left-layout-container' });\n        propertyDiv.appendChild(leftLayoutDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightLayoutDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-layout-container' });\n        propertyDiv.appendChild(rightLayoutDiv);\n        var headerLabel = createElement('label', {\n            innerHTML: locale.getConstant('Header'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_headerLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var headerBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_header'\n        });\n        leftLayoutDiv.appendChild(headerLabel);\n        leftLayoutDiv.appendChild(headerBox);\n        var footerLabel = createElement('label', {\n            innerHTML: locale.getConstant('Footer'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_footerLabel'\n        });\n        var footerBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_footer'\n        });\n        rightLayoutDiv.appendChild(footerLabel);\n        rightLayoutDiv.appendChild(footerBox);\n        element.appendChild(propertyDiv);\n        this.headerBox = new NumericTextBox({ value: 612, width: 170, decimals: 2 });\n        this.headerBox.appendTo(headerBox);\n        this.footerBox = new NumericTextBox({ value: 792, width: 170, decimals: 2 });\n        this.footerBox.appendTo(footerBox);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initPageSetupDialog(localValue);\n        }\n        this.owner.dialog.header = localValue.getConstant('Page Setup');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadPageSetupDialog;\n        this.owner.dialog.close = this.closePageSetupDialog;\n        this.owner.dialog.buttons = [{\n                click: this.applyPageSetupProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-layout-ppty-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-layout-ppty-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.destroy = function () {\n        if (this.topMarginBox) {\n            this.topMarginBox.destroy();\n            this.topMarginBox = undefined;\n        }\n        if (this.leftMarginBox) {\n            this.leftMarginBox.destroy();\n            this.leftMarginBox = undefined;\n        }\n        if (this.bottomMarginBox) {\n            this.bottomMarginBox.destroy();\n            this.bottomMarginBox = undefined;\n        }\n        if (this.rightMarginBox) {\n            this.rightMarginBox.destroy();\n            this.rightMarginBox = undefined;\n        }\n        if (this.headerBox) {\n            this.headerBox.destroy();\n            this.headerBox = undefined;\n        }\n        if (this.footerBox) {\n            this.footerBox.destroy();\n            this.footerBox = undefined;\n        }\n        if (this.widthBox) {\n            this.widthBox.destroy();\n            this.widthBox = undefined;\n        }\n        if (this.heightBox) {\n            this.heightBox.destroy();\n            this.heightBox = undefined;\n        }\n        if (this.paperSize) {\n            this.paperSize.destroy();\n            this.paperSize = undefined;\n        }\n        if (this.checkBox1) {\n            this.checkBox1.destroy();\n            this.checkBox1 = undefined;\n        }\n        if (this.checkBox2) {\n            this.checkBox2.destroy();\n            this.checkBox2 = undefined;\n        }\n        if (this.portrait) {\n            this.portrait.destroy();\n            this.portrait = undefined;\n        }\n        if (this.landscape) {\n            this.landscape.destroy();\n            this.landscape = undefined;\n        }\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var s = 0; s < this.target.childNodes.length; s++) {\n                this.target.removeChild(this.target.childNodes[s]);\n                s--;\n            }\n            this.target = undefined;\n        }\n    };\n    return PageSetupDialog;\n}());\nexport { PageSetupDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { WParagraphFormat } from '../index';\n/**\n * The Paragraph dialog is used to modify formatting of selected paragraphs.\n */\nvar ParagraphDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ParagraphDialog(viewer) {\n        var _this = this;\n        //paragraph Format properties\n        this.leftIndent = undefined;\n        this.rightIndent = undefined;\n        this.beforeSpacing = undefined;\n        this.afterSpacing = undefined;\n        this.textAlignment = undefined;\n        this.firstLineIndent = undefined;\n        this.lineSpacingIn = undefined;\n        this.lineSpacingType = undefined;\n        this.paragraphFormat = undefined;\n        /**\n         * @private\n         */\n        this.keyUpParagraphSettings = function (event) {\n            if (event.keyCode === 13) {\n                _this.applyParagraphFormat();\n            }\n        };\n        this.changeBeforeSpacing = function (event) {\n            _this.beforeSpacing = event.value;\n        };\n        this.changeAfterSpacing = function (event) {\n            _this.afterSpacing = event.value;\n        };\n        this.changeLeftIndent = function (event) {\n            _this.leftIndent = event.value;\n        };\n        this.changeRightIndent = function (event) {\n            _this.rightIndent = event.value;\n        };\n        this.changeLineSpacingValue = function (event) {\n            _this.lineSpacingIn = event.value;\n        };\n        this.changeFirstLineIndent = function (event) {\n            _this.firstLineIndent = event.value;\n        };\n        this.changeByTextAlignment = function (args) {\n            _this.textAlignment = args.value;\n        };\n        /**\n         * @private\n         */\n        this.changeByValue = function (event) {\n            var paragraphFormat = _this.owner.selection.paragraphFormat;\n            switch (_this.special.index) {\n                case 0:\n                    if (paragraphFormat.firstLineIndent !== 0) {\n                        _this.byIn.value = 0;\n                    }\n                    break;\n                case 1:\n                    if (paragraphFormat.firstLineIndent === 0 || isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n                        _this.byIn.value = 0.1;\n                    }\n                    else if (paragraphFormat.firstLineIndent < 0) {\n                        _this.byIn.value = -(paragraphFormat.firstLineIndent);\n                    }\n                    break;\n                case 2:\n                    if (paragraphFormat.firstLineIndent === 0 || isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n                        paragraphFormat.firstLineIndent = -0.1;\n                    }\n                    else if (paragraphFormat.firstLineIndent > 0) {\n                        _this.byIn.value = -(paragraphFormat.firstLineIndent);\n                    }\n                    break;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeBySpacing = function (event) {\n            if (isNullOrUndefined(_this.lineSpacing)) {\n                return;\n            }\n            switch (_this.lineSpacing.index) {\n                case 0:\n                    _this.lineSpacingType = 'AtLeast';\n                    _this.atIn.value = 12;\n                    break;\n                case 1:\n                    _this.lineSpacingType = 'Exactly';\n                    _this.atIn.value = 12;\n                    break;\n                case 2:\n                    _this.lineSpacingType = 'Multiple';\n                    _this.atIn.value = 1;\n                    break;\n            }\n        };\n        /* tslint:enable */\n        /**\n         * @private\n         */\n        this.loadParagraphDialog = function () {\n            var selectionFormat;\n            if (_this.paragraphFormat) {\n                selectionFormat = _this.paragraphFormat;\n            }\n            else {\n                selectionFormat = _this.owner.selection.paragraphFormat;\n            }\n            var alignValue = _this.alignment.index;\n            if (selectionFormat.textAlignment === 'Center') {\n                alignValue = 0;\n            }\n            else if (selectionFormat.textAlignment === 'Left') {\n                alignValue = 1;\n            }\n            else if (selectionFormat.textAlignment === 'Right') {\n                alignValue = 2;\n            }\n            else {\n                alignValue = 3;\n            }\n            _this.alignment.index = alignValue;\n            _this.beforeSpacingIn.value = selectionFormat.beforeSpacing;\n            _this.afterSpacingIn.value = selectionFormat.afterSpacing;\n            _this.leftIndentIn.value = selectionFormat.leftIndent;\n            _this.rightIndentIn.value = selectionFormat.rightIndent;\n            _this.byIn.value = selectionFormat.firstLineIndent;\n            var lineSpaceValue = _this.lineSpacing.index;\n            if (selectionFormat.lineSpacingType === 'AtLeast') {\n                lineSpaceValue = 0;\n            }\n            else if (selectionFormat.lineSpacingType === 'Exactly') {\n                lineSpaceValue = 1;\n            }\n            else {\n                lineSpaceValue = 2;\n            }\n            _this.lineSpacing.index = lineSpaceValue;\n            _this.atIn.value = selectionFormat.lineSpacing;\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyParagraphFormat = function () {\n            var paraFormat;\n            var isApply;\n            if (_this.paragraphFormat) {\n                paraFormat = _this.paragraphFormat;\n                isApply = false;\n            }\n            else {\n                paraFormat = new WParagraphFormat();\n                isApply = true;\n            }\n            if (!isNullOrUndefined(_this.beforeSpacing)) {\n                paraFormat.beforeSpacing = _this.beforeSpacing;\n            }\n            if (!isNullOrUndefined(_this.afterSpacing)) {\n                paraFormat.afterSpacing = _this.afterSpacing;\n            }\n            if (!isNullOrUndefined(_this.lineSpacingType)) {\n                paraFormat.lineSpacingType = _this.lineSpacingType;\n            }\n            if (!isNullOrUndefined(_this.leftIndent)) {\n                paraFormat.leftIndent = _this.leftIndent;\n            }\n            if (!isNullOrUndefined(_this.rightIndent)) {\n                paraFormat.rightIndent = _this.rightIndent;\n            }\n            if (!isNullOrUndefined(_this.lineSpacingIn)) {\n                paraFormat.lineSpacing = _this.lineSpacingIn;\n            }\n            if (!isNullOrUndefined(_this.firstLineIndent)) {\n                paraFormat.firstLineIndent = _this.firstLineIndent;\n            }\n            if (!isNullOrUndefined(_this.textAlignment)) {\n                paraFormat.textAlignment = _this.textAlignment;\n            }\n            if (isApply) {\n                _this.onParagraphFormat(paraFormat);\n            }\n            else {\n                _this.owner.owner.styleDialogModule.updateParagraphFormat();\n            }\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.closeParagraphDialog = function () {\n            _this.leftIndent = undefined;\n            _this.afterSpacing = undefined;\n            _this.beforeSpacing = undefined;\n            _this.firstLineIndent = undefined;\n            _this.textAlignment = undefined;\n            _this.rightIndent = undefined;\n            _this.lineSpacingIn = undefined;\n            _this.lineSpacingType = undefined;\n            _this.paragraphFormat = undefined;\n            _this.owner.dialog.hide();\n            _this.owner.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.getModuleName = function () {\n        return 'ParagraphDialog';\n    };\n    /*tslint:disable max-func-body-length*/\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.initParagraphDialog = function (locale) {\n        var instance = this;\n        var ownerId = this.owner.owner.containerId;\n        var id = ownerId + '_paragraph_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-para-dlg-container' });\n        // tslint:disable-next-line:max-line-length\n        var div = createElement('div', { id: 'property_div', styles: 'width:400px;' });\n        var generalDiv = createElement('div', { id: 'genral_div', styles: 'width:200px;height:85px;', className: 'e-de-para-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var genLabel = createElement('div', { id: ownerId + '_genLabel', className: 'e-de-para-dlg-heading', innerHTML: locale.getConstant('General') });\n        var alignLabel = createElement('div', { id: ownerId + '_AlignLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Alignment') });\n        var alignment = createElement('select', {\n            id: ownerId + '_Alignment',\n            innerHTML: '<option value=\"Center\">' + locale.getConstant('Center') +\n                '</option><option value=\"Left\">' + locale.getConstant('Left') +\n                '</option><option value=\"Right\">' + locale.getConstant('Right') +\n                '</option><option value=\"Justify\">' + locale.getConstant('Justify') + '</option>'\n        });\n        generalDiv.appendChild(genLabel);\n        generalDiv.appendChild(alignLabel);\n        generalDiv.appendChild(alignment);\n        // tslint:disable-next-line:max-line-length\n        var indentionDiv = createElement('div', { id: 'indention_div', styles: 'width: 400px;height: 150px;', className: 'e-de-para-dlg-sub-container' });\n        var leftIndentionDiv = createElement('div', { id: 'left_indention', styles: 'float:left;position:relative;' });\n        indentionDiv.appendChild(leftIndentionDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightIndentionDiv = createElement('div', { className: 'e-de-para-dlg-right-sub-container', styles: 'float:right;position:relative;' });\n        indentionDiv.appendChild(rightIndentionDiv);\n        // tslint:disable-next-line:max-line-length\n        var spacingDiv = createElement('div', { id: 'spacing_div', styles: 'width: 400px;height: 150px;', className: 'e-de-para-dlg-sub-container' });\n        var leftSpacingDiv = createElement('div', { id: 'left_spacing', styles: 'float:left;position:relative;' });\n        spacingDiv.appendChild(leftSpacingDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightSpacingDiv = createElement('div', { className: 'e-de-para-dlg-right-sub-container', styles: 'float:right;position:relative;' });\n        spacingDiv.appendChild(rightSpacingDiv);\n        // tslint:disable-next-line:max-line-length\n        var indentLabel = createElement('div', {\n            id: ownerId + '_indentLabel', className: 'e-de-para-dlg-heading', innerHTML: locale.getConstant('Indentation')\n        });\n        var beforeTextLabel = createElement('div', {\n            id: ownerId + '_bfTextLabel',\n            className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Before text')\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftIndent = createElement('input', { id: ownerId + '_leftIndent', attrs: { 'type': 'text' } });\n        var specialLabel = createElement('div', { id: ownerId + '_specialLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Special') });\n        var special = createElement('select', {\n            id: ownerId + '_special',\n            innerHTML: '<option value=\"None\">' + locale.getConstant('None') +\n                '</option><option value=\"First Line\">' + locale.getConstant('First line') +\n                '</option><option value=\"Hanging\">' + locale.getConstant('Hanging') + '</option> '\n        });\n        leftIndentionDiv.appendChild(indentLabel);\n        leftIndentionDiv.appendChild(beforeTextLabel);\n        leftIndentionDiv.appendChild(leftIndent);\n        leftIndentionDiv.appendChild(specialLabel);\n        leftIndentionDiv.appendChild(special);\n        // tslint:disable-next-line:max-line-length\n        var afterTextLabel = createElement('div', { id: ownerId + '_afTextLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('After text') });\n        var rightIndent = createElement('input', { id: ownerId + '_rightIndent', attrs: { 'type': 'text' } });\n        // tslint:disable-next-line:max-line-length\n        var byLabel = createElement('label', { id: ownerId + '_byLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('By') });\n        var by = createElement('input', { id: ownerId + '_By', attrs: { 'type': 'text' } });\n        rightIndentionDiv.appendChild(afterTextLabel);\n        rightIndentionDiv.appendChild(rightIndent);\n        rightIndentionDiv.appendChild(byLabel);\n        rightIndentionDiv.appendChild(by);\n        // tslint:disable-next-line:max-line-length\n        var spaceLabel = createElement('div', { innerHTML: locale.getConstant('Spacing'), className: 'e-de-para-dlg-heading', id: ownerId + '_spaceLabel' });\n        var beforeLabel = createElement('div', { className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Before'), id: ownerId + '_beforeLabel' });\n        // tslint:disable-next-line:max-line-length\n        var beforeSpacing = createElement('input', { id: ownerId + '_beforeSpacing', attrs: { 'type': 'text' } });\n        var lineSpaceLabel = createElement('div', { id: ownerId + '_lineSpaceLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Line Spacing') });\n        // tslint:disable-next-line:max-line-length\n        var lineSpacing = createElement('select', {\n            id: ownerId + '_lineSpacing', styles: 'width:180px;',\n            innerHTML: '<option value=\"At least\">' + locale.getConstant('At least') +\n                '</option><option value=\"Exactly\">' + locale.getConstant('Exactly') +\n                '</option><option value=\"Multiple\">' + locale.getConstant('Multiple') + '</option>'\n        });\n        leftSpacingDiv.appendChild(spaceLabel);\n        leftSpacingDiv.appendChild(beforeLabel);\n        leftSpacingDiv.appendChild(beforeSpacing);\n        leftSpacingDiv.appendChild(lineSpaceLabel);\n        leftSpacingDiv.appendChild(lineSpacing);\n        // tslint:disable-next-line:max-line-length\n        var afterLabel = createElement('div', { innerHTML: locale.getConstant('After'), className: 'e-de-dlg-sub-header', id: ownerId + '_afterLabel' });\n        var afterSpacing = createElement('input', { id: ownerId + '_afterSpacing', attrs: { 'type': 'text' } });\n        // tslint:disable-next-line:max-line-length\n        var atLabel = createElement('div', { innerHTML: locale.getConstant('At'), id: ownerId + '_atLabel', className: 'e-de-dlg-sub-header' });\n        var lineSpacingAt = createElement('input', { id: ownerId + '_lineSpacingAt', attrs: { 'type': 'text' } });\n        rightSpacingDiv.appendChild(afterLabel);\n        rightSpacingDiv.appendChild(afterSpacing);\n        rightSpacingDiv.appendChild(atLabel);\n        rightSpacingDiv.appendChild(lineSpacingAt);\n        div.appendChild(generalDiv);\n        div.appendChild(indentionDiv);\n        div.appendChild(spacingDiv);\n        this.target.appendChild(div);\n        this.leftIndentIn = new NumericTextBox({\n            format: 'n1', value: 0, min: -1584, max: 1584, width: 180, enablePersistence: false, change: this.changeLeftIndent\n        });\n        this.leftIndentIn.appendTo(leftIndent);\n        this.rightIndentIn = new NumericTextBox({\n            format: 'n1', value: 0, min: -1584, max: 1584, width: 180, enablePersistence: false, change: this.changeRightIndent\n        });\n        this.rightIndentIn.appendTo(rightIndent);\n        this.byIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, enablePersistence: false, change: this.changeFirstLineIndent\n        });\n        this.byIn.appendTo(by);\n        this.beforeSpacingIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, step: 6, enablePersistence: false,\n            change: this.changeBeforeSpacing\n        });\n        this.beforeSpacingIn.appendTo(beforeSpacing);\n        this.afterSpacingIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, step: 6, enablePersistence: false,\n            change: this.changeAfterSpacing\n        });\n        this.afterSpacingIn.appendTo(afterSpacing);\n        this.atIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 1, max: 1584, width: 180, step: 0.5, enablePersistence: false, change: this.changeLineSpacingValue\n        });\n        this.special = new DropDownList({ change: this.changeByValue, width: 180 });\n        this.special.appendTo(special);\n        this.lineSpacing = new DropDownList({ change: this.changeBySpacing, width: '180px' });\n        this.lineSpacing.appendTo(lineSpacing);\n        this.alignment = new DropDownList({ width: 180, change: this.changeByTextAlignment });\n        this.alignment.appendTo(alignment);\n        this.atIn.appendTo(lineSpacingAt);\n        this.target.addEventListener('keyup', instance.keyUpParagraphSettings);\n    };\n    /**\n     * Applies Paragraph Format\n     * @param  {WParagraphFormat} paragraphFormat\n     * @private\n     */\n    ParagraphDialog.prototype.onParagraphFormat = function (paragraphFormat) {\n        this.owner.owner.editorModule.initHistory('ParagraphFormat');\n        var selection = this.owner.selection;\n        this.owner.owner.isShiftingEnabled = true;\n        if (this.owner.selection.isEmpty) {\n            this.owner.owner.editorModule.applyParaFormatProperty(selection.start.paragraph, undefined, paragraphFormat, false);\n            this.owner.owner.editor.layoutItemBlock(selection.start.paragraph, false);\n        }\n        else {\n            this.owner.owner.editorModule.updateSelectionParagraphFormatting('ParagraphFormat', paragraphFormat, false);\n        }\n        this.owner.owner.editorModule.reLayout(selection);\n    };\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.show = function (paragraphFormat) {\n        if (paragraphFormat) {\n            this.paragraphFormat = paragraphFormat;\n        }\n        var local = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        local.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initParagraphDialog(local);\n        }\n        this.loadParagraphDialog();\n        this.owner.dialog.header = 'Paragraph';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.applyParagraphFormat,\n                buttonModel: { content: local.getConstant('Ok'), cssClass: 'e-flat e-para-okay', isPrimary: true }\n            },\n            {\n                click: this.closeParagraphDialog,\n                buttonModel: { content: local.getConstant('Cancel'), cssClass: 'e-flat e-para-cancel' }\n            }];\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.destroy = function () {\n        if (this.afterSpacingIn) {\n            this.afterSpacingIn.destroy();\n            this.afterSpacingIn = undefined;\n        }\n        if (this.beforeSpacingIn) {\n            this.beforeSpacingIn.destroy();\n            this.beforeSpacingIn = undefined;\n        }\n        if (this.leftIndentIn) {\n            this.leftIndentIn.destroy();\n            this.leftIndentIn = undefined;\n        }\n        if (this.rightIndentIn) {\n            this.rightIndentIn.destroy();\n            this.rightIndentIn = undefined;\n        }\n        if (this.byIn) {\n            this.byIn.destroy();\n            this.byIn = undefined;\n        }\n        if (this.atIn) {\n            this.atIn.destroy();\n            this.atIn = undefined;\n        }\n        if (this.alignment) {\n            this.alignment.change = undefined;\n            this.alignment.destroy();\n        }\n        this.alignment = undefined;\n        if (this.lineSpacing) {\n            this.lineSpacing.change = undefined;\n            this.lineSpacing.destroy();\n        }\n        this.lineSpacing = undefined;\n        if (this.special) {\n            this.special.change = undefined;\n            this.special.destroy();\n        }\n        this.special = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var q = 0; q < this.target.childNodes.length; q++) {\n                this.target.removeChild(this.target.childNodes[q]);\n                q--;\n            }\n            this.target = undefined;\n        }\n    };\n    return ParagraphDialog;\n}());\nexport { ParagraphDialog };\n","import { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * List view model implementation\n * @private\n */\nvar ListViewModel = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ListViewModel() {\n        this.listIn = undefined;\n        this.levelNumberIn = undefined;\n        /**\n         * @private\n         */\n        this.dialog = undefined;\n        this.levelNumber = 0;\n    }\n    Object.defineProperty(ListViewModel.prototype, \"levelNumber\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.levelNumberIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.levelNumberIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"list\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.listIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (isNullOrUndefined(value)) {\n                this.createList();\n            }\n            else {\n                this.listIn = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"listLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.list) && this.levelNumber >= 0 && this.levelNumber < 9) {\n                if (!isNullOrUndefined(this.dialog.owner.getAbstractListById(this.list.abstractListId))) {\n                    if (this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.length <= this.levelNumber) {\n                        this.addListLevels();\n                    }\n                    return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels[this.levelNumber];\n                }\n                else {\n                    this.dialog.owner.lists.push(this.list);\n                    var abstractList = this.list.abstractList;\n                    if (!this.list.abstractList) {\n                        abstractList = new WAbstractList();\n                        abstractList.abstractListId = this.list.abstractListId;\n                    }\n                    var listLevelAdv = new WListLevel(abstractList);\n                    listLevelAdv.characterFormat = new WCharacterFormat(listLevelAdv);\n                    listLevelAdv.paragraphFormat = new WParagraphFormat(listLevelAdv);\n                    listLevelAdv.paragraphFormat.leftIndent = (1) * 48;\n                    listLevelAdv.paragraphFormat.firstLineIndent = -24;\n                    listLevelAdv.numberFormat = '%' + (1).toString() + '.';\n                    listLevelAdv.listLevelPattern = 'UpRoman';\n                    listLevelAdv.followCharacter = 'Tab';\n                    listLevelAdv.startAt = 1;\n                    listLevelAdv.restartLevel = 1;\n                    this.dialog.owner.abstractLists.push(abstractList);\n                    return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels[0];\n                    // return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.getItem(0);\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"listLevelPattern\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.listLevel)) {\n                return this.listLevel.listLevelPattern;\n            }\n            return 'Arabic';\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (!isNullOrUndefined(this.listLevel)) {\n                this.listLevel.listLevelPattern = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"followCharacter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.listLevel)) {\n                return this.listLevel.followCharacter;\n            }\n            return 'None';\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (!isNullOrUndefined(this.listLevel)) {\n                this.listLevel.followCharacter = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ListViewModel.prototype.createList = function () {\n        this.list = new WList();\n        this.list.listId = this.dialog.owner.lists.length + 1;\n        var abstractList = new WAbstractList();\n        abstractList.abstractListId = this.dialog.owner.abstractLists.length + 1;\n        this.list.abstractListId = abstractList.abstractListId;\n        this.dialog.owner.lists.push(this.list);\n        var listLevel = new WListLevel(abstractList);\n        listLevel.paragraphFormat = new WParagraphFormat(listLevel);\n        listLevel.paragraphFormat.leftIndent = 48;\n        listLevel.paragraphFormat.firstLineIndent = -24;\n        listLevel.characterFormat = new WCharacterFormat(listLevel);\n        listLevel.numberFormat = '%1.';\n        listLevel.startAt = 1;\n        abstractList.levels.push(listLevel);\n        this.dialog.owner.abstractLists.push(abstractList);\n    };\n    ListViewModel.prototype.addListLevels = function () {\n        if (!isNullOrUndefined(this.list) && !isNullOrUndefined(this.list.abstractListId)) {\n            for (var i = this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.length; i < 9; i++) {\n                var listLevelAdv = new WListLevel(this.dialog.owner.getAbstractListById(this.list.abstractListId));\n                listLevelAdv.characterFormat = new WCharacterFormat(listLevelAdv);\n                listLevelAdv.paragraphFormat = new WParagraphFormat(listLevelAdv);\n                listLevelAdv.paragraphFormat.leftIndent = (i + 1) * 48;\n                listLevelAdv.paragraphFormat.firstLineIndent = -24;\n                listLevelAdv.numberFormat = '%' + (i + 1).toString() + '.';\n                listLevelAdv.listLevelPattern = 'Arabic';\n                listLevelAdv.followCharacter = 'Tab';\n                listLevelAdv.startAt = 1;\n                listLevelAdv.restartLevel = i;\n                (this.dialog.owner).getAbstractListById(this.list.abstractListId).levels.push(listLevelAdv);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    ListViewModel.prototype.destroy = function () {\n        this.list = undefined;\n        this.followCharacter = undefined;\n        this.levelNumber = undefined;\n        this.listLevelPattern = undefined;\n    };\n    return ListViewModel;\n}());\nexport { ListViewModel };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n// tslint:disable-next-line:max-line-length\nimport { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { Tooltip } from '@syncfusion/ej2-popups';\nimport { ListViewModel } from './list-view-model';\n/**\n * The List dialog is used to create or modify lists.\n */\n/* tslint:disable:no-any */\nvar ListDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ListDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.dialog = undefined;\n        this.target = undefined;\n        /**\n         * @private\n         */\n        this.owner = undefined;\n        this.viewModel = undefined;\n        this.startAt = undefined;\n        this.textIndent = undefined;\n        this.alignedAt = undefined;\n        this.listLevelElement = undefined;\n        this.followNumberWith = undefined;\n        this.numberStyle = undefined;\n        this.numberFormat = undefined;\n        this.restartBy = undefined;\n        /**\n         * @private\n         */\n        this.isListCharacterFormat = false;\n        this.onTextIndentChanged = function (args) {\n            _this.viewModel.listLevel.paragraphFormat.leftIndent = args.value;\n        };\n        this.onStartValueChanged = function (args) {\n            _this.viewModel.listLevel.startAt = args.value;\n        };\n        this.onListLevelValueChanged = function (args) {\n            _this.viewModel.levelNumber = parseInt(args.value.slice(args.value.length - 1), 10) - 1;\n            if (isNullOrUndefined(_this.listLevel)) {\n                return;\n            }\n            if (isNullOrUndefined(_this.listLevel.characterFormat)) {\n                _this.listLevel.characterFormat = new WCharacterFormat(_this.viewModel.listLevel);\n            }\n            if (!isNullOrUndefined(_this.listLevel.paragraphFormat)) {\n                _this.listLevel.paragraphFormat = new WParagraphFormat(_this.viewModel.listLevel);\n            }\n            _this.updateDialogValues();\n            _this.updateRestartLevelBox();\n        };\n        this.onNumberFormatChanged = function (args) {\n            _this.viewModel.listLevel.numberFormat = args.target.value;\n        };\n        this.onAlignedAtValueChanged = function (args) {\n            _this.viewModel.listLevel.paragraphFormat.firstLineIndent = args.value;\n        };\n        this.onFollowCharacterValueChanged = function (args) {\n            if (args.value) {\n                _this.viewModel.followCharacter = args.value;\n            }\n        };\n        this.onLevelPatternValueChanged = function (args) {\n            _this.viewModel.listLevelPattern = args.value;\n            var numberFormat = '%' + (_this.levelNumber + 1).toString();\n            // tslint:disable-next-line:max-line-length\n            var numberFormatTextBox = document.getElementById(_this.owner.owner.containerId + '_numberFormat');\n            if (_this.listLevel.listLevelPattern === 'Bullet') {\n                _this.listLevel.numberFormat = '\\uf0b7';\n                numberFormatTextBox.value = _this.listLevel.numberFormat;\n                _this.listLevel.characterFormat.fontFamily = 'Wingdings';\n            }\n            else {\n                if (_this.listLevel.listLevelPattern === 'None') {\n                    _this.listLevel.numberFormat = '';\n                }\n                if (!_this.listLevel.numberFormat.match(numberFormat) && _this.listLevel.listLevelPattern !== 'None') {\n                    _this.listLevel.numberFormat = numberFormat + '.';\n                }\n                numberFormatTextBox.value = _this.listLevel.numberFormat;\n            }\n        };\n        this.loadListDialog = function () {\n            _this.owner.updateFocus();\n            if (isNullOrUndefined(_this.owner.owner)) {\n                return;\n            }\n            _this.viewModel = new ListViewModel();\n            _this.viewModel.dialog = _this;\n            if (_this.owner.selection.paragraphFormat.listLevelNumber > 0) {\n                _this.viewModel.levelNumber = _this.owner.selection.paragraphFormat.listLevelNumber;\n            }\n            _this.viewModel.list = _this.owner.selection.paragraphFormat.getList();\n            if (isNullOrUndefined(_this.listLevel)) {\n                return;\n            }\n            if (isNullOrUndefined(_this.listLevel.characterFormat)) {\n                _this.listLevel.characterFormat = new WCharacterFormat(_this.viewModel.listLevel);\n            }\n            if (isNullOrUndefined(_this.listLevel.paragraphFormat)) {\n                _this.listLevel.paragraphFormat = new WParagraphFormat(_this.viewModel.listLevel);\n            }\n            _this.updateDialogValues();\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        this.showFontDialog = function () {\n            _this.owner.owner.fontDialogModule.showFontDialog(_this.listLevel.characterFormat);\n        };\n        this.onApplyList = function () {\n            if (!isNullOrUndefined(_this.owner)) {\n                _this.owner.selection.paragraphFormat.setList(_this.list);\n            }\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n        };\n        this.onCancelButtonClick = function () {\n            _this.disposeBindingForListUI();\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n            _this.isListCharacterFormat = false;\n        };\n        this.closeListDialog = function () {\n            _this.disposeBindingForListUI();\n            _this.owner.updateFocus();\n            _this.isListCharacterFormat = false;\n        };\n        this.owner = viewer;\n        this.viewModel = new ListViewModel();\n    }\n    Object.defineProperty(ListDialog.prototype, \"listLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.viewModel)) {\n                return this.viewModel.listLevel;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListDialog.prototype, \"list\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.viewModel)) {\n                return this.viewModel.list;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListDialog.prototype, \"levelNumber\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.listLevel.ownerBase instanceof WLevelOverride) {\n                return this.listLevel.ownerBase.levelNumber;\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (this.listLevel.ownerBase instanceof WAbstractList && !isNullOrUndefined(this.listLevel.ownerBase.levels)) {\n                return this.listLevel.ownerBase.levels.indexOf(this.listLevel);\n            }\n            else {\n                return -1;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ListDialog.prototype.getModuleName = function () {\n        return 'ListDialog';\n    };\n    /**\n     * @private\n     */\n    ListDialog.prototype.showListDialog = function () {\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initListDialog(locale);\n        }\n        this.isListCharacterFormat = true;\n        this.owner.dialog2.header = locale.getConstant('Define new Multilevel list');\n        this.owner.dialog2.height = 'auto';\n        this.owner.dialog2.width = 'auto';\n        this.owner.dialog2.content = this.target;\n        this.owner.dialog2.buttons = [{\n                click: this.showFontDialog,\n                buttonModel: { content: locale.getConstant('Font'), cssClass: 'e-flat e-list-dlg-font e-font' }\n            }, {\n                click: this.onApplyList,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-list-dlg', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-list-dlg' }\n            }];\n        this.owner.dialog2.dataBind();\n        this.owner.dialog2.beforeOpen = this.loadListDialog;\n        this.owner.dialog2.close = this.closeListDialog;\n        this.owner.dialog2.position = { X: 'center', Y: 'top' };\n        this.owner.dialog2.show();\n    };\n    /**\n     * Shows the table properties dialog\n     * @private\n     */\n    ListDialog.prototype.initListDialog = function (locale) {\n        var instance = this;\n        var containerId = this.owner.owner.containerId;\n        var id = containerId + '_insert_list';\n        this.target = createElement('div', { id: id, className: 'e-de-list-dlg' });\n        this.owner.owner.element.appendChild(this.target);\n        // tslint:disable-next-line:max-line-length\n        var listLevelDiv = createElement('div', { innerHTML: '<label id=\"' + containerId + '_listLevellabel\" style=\"display:block;\" class=e-de-list-ddl-header-list-level>' + locale.getConstant('List level') + '</label><label id=\"' + containerId + '_modifyLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Choose level to modify') + '</label><select style=\"height:20px;width:43%\" id=\"' + containerId + '_listLevel\"><option>' + locale.getConstant('Level') + ' 1' + '</option><option>' + locale.getConstant('Level') + ' 2' + '</option><option>' + locale.getConstant('Level') + ' 3' + '</option><option>' + locale.getConstant('Level') + ' 4' + '</option><option>' + locale.getConstant('Level') + ' 5' + '</option><option>' + locale.getConstant('Level') + ' 6' + '</option><option>' + locale.getConstant('Level') + ' 7' + '</option><option>' + locale.getConstant('Level') + ' 8' + '</option><option>' + locale.getConstant('Level') + ' 9' + '</option></select>' });\n        this.target.appendChild(listLevelDiv);\n        var div = createElement('div');\n        // tslint:disable-next-line:max-line-length\n        var numberStyleDiv = createElement('div', { innerHTML: '<div style=\"float:left;display:block;\"><label id=\"' + containerId + '_numberFormatLabel\" style=\"display:block;\" class=e-de-list-ddl-header>' + locale.getConstant('Number format') + '</label><label id=\"' + containerId + '_numberStyleLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Number style for this level') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_numberStyle\"><option>' + locale.getConstant('Arabic') + '</option><option>' + locale.getConstant('UpRoman') + '</option><option>' + locale.getConstant('LowRoman') + '</option><option>' + locale.getConstant('UpLetter') + '</option><option>' + locale.getConstant('LowLetter') + '</option><option>' + locale.getConstant('Number') + '</option><option>' + locale.getConstant('Leading zero') + '</option><option>' + locale.getConstant('Bullet') + '</option><option>' + locale.getConstant('Ordinal') + '</option><option>' + locale.getConstant('Ordinal Text') + '</option><option>' + locale.getConstant('Special') + '</option><option>' + locale.getConstant('For East') + '</option></select><label id=\"' + containerId + '_startAtLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Start at') + '</label><input type=\"text\" id=\"' + containerId + '_startAt\">' });\n        div.appendChild(numberStyleDiv);\n        // tslint:disable-next-line:max-line-length\n        var numberFormatDiv = createElement('div', { className: 'e-de-list-dlg-subdiv', innerHTML: '<div><div><label id=\"' + containerId + '_formatLabel\" style=\"display:inline-block;width:86%\" class=e-de-list-ddl-subheader>' + locale.getConstant('Enter formatting for number') + '</label><button id=\"' + containerId + '_list_info\" class=\"e-control e-btn e-primary e-de-list-format-info\">i</button></div><input style=width:180px; type=\"text\" id=\"' + containerId + '_numberFormat\" class=e-input></div><label id=\"' + containerId + '_restartLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Restart list after') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_restartBy\"><option>' + locale.getConstant('No Restart') + '</option></select></div>' });\n        div.appendChild(numberFormatDiv);\n        this.target.appendChild(div);\n        // tslint:disable-next-line:max-line-length\n        var indentsDiv = createElement('div', { innerHTML: '<div style=\"float:left;display:block;\"><label id=\"' + containerId + '_IndentsLabel\" style=\"display:block;\" class=e-de-list-ddl-header>' + locale.getConstant('Position') + '</label><label id=\"' + containerId + '_textIndentLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Text indent at') + '</label><input type=\"text\" id=\"' + containerId + '_textIndent\"><label id=\"' + containerId + '_followCharacterLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Follow number with') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_followCharacter\"><option>' + locale.getConstant('Tab character') + '</option><option>' + locale.getConstant('Space') + '</option><option>' + locale.getConstant('Nothing') + '</option></select></div><div class=\"e-de-list-dlg-div\"><label id=\"' + containerId + '_alignedAtLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Aligned at') + '</label><input type=\"text\" id=\"' + containerId + '_alignedAt\"></div>', });\n        this.target.appendChild(indentsDiv);\n        var startAtTextBox = document.getElementById(containerId + '_startAt');\n        var textIndentAtTextBox = document.getElementById(containerId + '_textIndent');\n        var alignedAtTextBox = document.getElementById(containerId + '_alignedAt');\n        this.startAt = new NumericTextBox({\n            format: '#',\n            decimals: 0,\n            min: 0,\n            max: 50,\n            width: '180px',\n            enablePersistence: false,\n        });\n        this.startAt.addEventListener('change', instance.onStartValueChanged);\n        this.startAt.appendTo(startAtTextBox);\n        this.textIndent = new NumericTextBox({\n            format: '#',\n            decimals: 0,\n            min: 0,\n            max: 1584,\n            width: '180px',\n            step: 4,\n            enablePersistence: false\n        });\n        this.textIndent.addEventListener('change', instance.onTextIndentChanged);\n        this.textIndent.appendTo(textIndentAtTextBox);\n        this.alignedAt = new NumericTextBox({\n            format: '#',\n            max: 1584,\n            step: 6,\n            width: '180px',\n            enablePersistence: false\n        });\n        this.alignedAt.addEventListener('change', instance.onAlignedAtValueChanged);\n        this.alignedAt.appendTo(alignedAtTextBox);\n        var listLevel = document.getElementById(containerId + '_listLevel');\n        this.listLevelElement = new DropDownList({ popupHeight: '150px', width: '180px', change: instance.onListLevelValueChanged });\n        this.listLevelElement.appendTo(listLevel);\n        var followCharacterElement = document.getElementById(containerId + '_followCharacter');\n        this.followNumberWith = new DropDownList({ popupHeight: '150px', width: '180px', change: instance.onFollowCharacterValueChanged });\n        this.followNumberWith.appendTo(followCharacterElement);\n        var numberStyleEle = document.getElementById(containerId + '_numberStyle');\n        this.numberStyle = new DropDownList({ popupHeight: '150px', width: '180px', change: instance.onLevelPatternValueChanged });\n        this.numberStyle.appendTo(numberStyleEle);\n        this.numberFormat = document.getElementById(containerId + '_numberFormat');\n        this.numberFormat.addEventListener('change', instance.onNumberFormatChanged);\n        var restartElement = document.getElementById(containerId + '_restartBy');\n        this.restartBy = new DropDownList({ popupHeight: '150px', width: '180px' });\n        this.restartBy.appendTo(restartElement);\n        var button = document.getElementById(containerId + '_list_info');\n        this.formatInfoToolTip = new Tooltip({ width: 200 });\n        // tslint:disable-next-line:max-line-length\n        this.formatInfoToolTip.content = locale.getConstant('Number format tooltip information');\n        this.formatInfoToolTip.position = 'RightTop';\n        this.formatInfoToolTip.appendTo(button);\n    };\n    ListDialog.prototype.updateRestartLevelBox = function () {\n        var containerId = this.owner.owner.containerId;\n        var listLevel = document.getElementById(containerId + '_listLevel');\n        var restartBy = document.getElementById(containerId + '_restartBy');\n        for (var i = 0; i < restartBy.options.length; i) {\n            restartBy.options.remove(i);\n        }\n        if (listLevel.selectedIndex === 0) {\n            var option = document.createElement('option');\n            option.value = 'No Restart';\n            option.innerHTML = 'No Restart';\n            restartBy.appendChild(option);\n        }\n        else {\n            for (var i = listLevel.selectedIndex; i > 0; i--) {\n                var option_1 = document.createElement('option');\n                option_1.value = 'Level ' + i;\n                option_1.innerHTML = 'Level ' + i;\n                restartBy.appendChild(option_1);\n            }\n            var option = document.createElement('option');\n            option.value = 'No Restart';\n            option.innerHTML = 'No Restart';\n            restartBy.appendChild(option);\n        }\n        restartBy.selectedIndex = 0;\n    };\n    ListDialog.prototype.listPatternConverter = function (listLevelPattern) {\n        switch (listLevelPattern) {\n            case 'Arabic': return 0;\n            case 'UpRoman': return 1;\n            case 'LowRoman': return 2;\n            case 'UpLetter': return 3;\n            case 'LowLetter': return 4;\n            case 'Number': return 5;\n            case 'LeadingZero': return 6;\n            case 'Bullet': return 7;\n            case 'Ordinal': return 8;\n            case 'OrdinalText': return 9;\n            case 'Special': return 10;\n            case 'FarEast': return 11;\n            default: return 12;\n        }\n    };\n    ListDialog.prototype.followCharacterConverter = function (followCharacter) {\n        switch (followCharacter) {\n            case 'Tab':\n                return 0;\n            case 'Space':\n                return 1;\n            default:\n                return 2;\n        }\n    };\n    ListDialog.prototype.updateDialogValues = function () {\n        // tslint:disable-next-line:max-line-length\n        var restartByTextBox = document.getElementById(this.owner.owner.containerId + '_restartBy');\n        this.startAt.value = this.viewModel.listLevel.startAt;\n        this.textIndent.value = this.viewModel.listLevel.paragraphFormat.leftIndent;\n        this.alignedAt.value = this.viewModel.listLevel.paragraphFormat.firstLineIndent;\n        this.followNumberWith.index = this.followCharacterConverter(this.viewModel.followCharacter);\n        this.numberFormat.value = this.viewModel.listLevel.numberFormat;\n        this.numberStyle.index = this.listPatternConverter(this.viewModel.listLevelPattern);\n        this.listLevelElement.index = this.viewModel.levelNumber;\n        this.viewModel.levelNumber = this.viewModel.levelNumber;\n    };\n    ListDialog.prototype.disposeBindingForListUI = function () {\n        this.followNumberWith.index = -1;\n        this.numberFormat.value = ' ';\n        this.numberStyle.index = -1;\n        this.listLevelElement.index = -1;\n        this.restartBy.index = -1;\n        this.viewModel.destroy();\n    };\n    /**\n     * @private\n     */\n    ListDialog.prototype.destroy = function () {\n        if (this.alignedAt) {\n            this.alignedAt.destroy();\n        }\n        this.alignedAt = undefined;\n        this.dialog = undefined;\n        if (this.followNumberWith) {\n            this.followNumberWith.destroy();\n        }\n        this.followNumberWith = undefined;\n        if (this.listLevelElement) {\n            this.listLevelElement.destroy();\n        }\n        this.listLevelElement = undefined;\n        if (this.textIndent) {\n            this.textIndent.destroy();\n        }\n        this.textIndent = undefined;\n        if (this.startAt) {\n            this.startAt.destroy();\n        }\n        this.startAt = undefined;\n        if (this.numberStyle) {\n            this.numberStyle.destroy();\n        }\n        this.numberStyle = undefined;\n        this.numberFormat = undefined;\n        if (this.restartBy) {\n            this.restartBy.destroy();\n        }\n        this.restartBy = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var l = 0; l < this.target.childNodes.length; l++) {\n                this.target.removeChild(this.target.childNodes[l]);\n                l--;\n            }\n            this.target = undefined;\n        }\n        this.owner = undefined;\n        this.viewModel = undefined;\n    };\n    return ListDialog;\n}());\nexport { ListDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList, ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { WCharacterStyle, WParagraphStyle } from '../../implementation/format/style';\nimport { BulletsAndNumberingDialog } from './index';\nimport { WAbstractList } from '../list/abstract-list';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\n/**\n * The Style dialog is used to create or modify styles.\n */\nvar StyleDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function StyleDialog(viewer) {\n        var _this = this;\n        this.target = undefined;\n        this.styleType = undefined;\n        this.styleBasedOn = undefined;\n        this.styleParagraph = undefined;\n        this.onlyThisDocument = undefined;\n        this.template = undefined;\n        this.fontFamily = undefined;\n        this.fontSize = undefined;\n        this.characterFormat = undefined;\n        this.paragraphFormat = undefined;\n        /* tslint:disable-next-line:no-any */\n        this.openDialog = function (args) {\n            switch (args.item.id) {\n                case 'style_font':\n                    _this.showFontDialog();\n                    break;\n                case 'style_paragraph':\n                    _this.showParagraphDialog();\n                    break;\n                case 'style_numbering':\n                    _this.showNumberingBulletDialog();\n                    break;\n            }\n        };\n        this.setBoldProperty = function () {\n            _this.characterFormat.bold = !_this.characterFormat.bold;\n            _this.fontButtonClicked(undefined);\n        };\n        this.setItalicProperty = function () {\n            _this.characterFormat.italic = !_this.characterFormat.italic;\n            _this.fontButtonClicked(undefined);\n        };\n        this.setUnderlineProperty = function () {\n            _this.characterFormat.underline = _this.characterFormat.underline === 'None' ? 'Single' : 'None';\n            _this.fontButtonClicked(undefined);\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontButtonClicked = function (args) {\n            if (_this.characterFormat.bold) {\n                if (!_this.bold.classList.contains('e-active')) {\n                    _this.bold.classList.add('e-active');\n                }\n            }\n            else {\n                if (_this.bold.classList.contains('e-active')) {\n                    _this.bold.classList.remove('e-active');\n                }\n            }\n            if (_this.characterFormat.italic) {\n                if (!_this.italic.classList.contains('e-active')) {\n                    _this.italic.classList.add('e-active');\n                }\n            }\n            else {\n                if (_this.italic.classList.contains('e-active')) {\n                    _this.italic.classList.remove('e-active');\n                }\n            }\n            if (_this.characterFormat.underline !== undefined && _this.characterFormat.underline !== 'None') {\n                if (!_this.underline.classList.contains('e-active')) {\n                    _this.underline.classList.add('e-active');\n                    _this.characterFormat.underline = 'Single';\n                }\n            }\n            else {\n                if (_this.underline.classList.contains('e-active')) {\n                    _this.underline.classList.remove('e-active');\n                    _this.characterFormat.underline = 'None';\n                }\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontSizeUpdate = function (args) {\n            _this.characterFormat.fontSize = args.value;\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontFamilyChanged = function (args) {\n            _this.characterFormat.fontFamily = args.value;\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontColorUpdate = function (args) {\n            _this.characterFormat.fontColor = args.currentValue.rgba;\n        };\n        this.setLeftAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Left') {\n                _this.paragraphFormat.textAlignment = 'Justify';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setRightAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Right') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Right';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setCenterAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Center') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Center';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setJustifyAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Justify') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Justify';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.increaseBeforeAfterSpacing = function () {\n            _this.paragraphFormat.beforeSpacing += 6;\n            _this.paragraphFormat.afterSpacing += 6;\n        };\n        this.decreaseBeforeAfterSpacing = function () {\n            if (_this.paragraphFormat.beforeSpacing >= 6) {\n                _this.paragraphFormat.beforeSpacing -= 6;\n            }\n            else {\n                _this.paragraphFormat.beforeSpacing = 0;\n            }\n            if (_this.paragraphFormat.afterSpacing >= 6) {\n                _this.paragraphFormat.afterSpacing -= 6;\n            }\n            else {\n                _this.paragraphFormat.afterSpacing = 0;\n            }\n        };\n        /**\n         * @private\n         */\n        this.updateNextStyle = function (args) {\n            var typedName = args.srcElement.value;\n            if (_this.getTypeValue() === 'Paragraph' && !isNullOrUndefined(typedName) && typedName !== '' && !_this.isUserNextParaUpdated) {\n                var styles = _this.owner.owner.viewer.styles.getStyleNames(_this.getTypeValue());\n                if (_this.isEdit) {\n                    styles = styles.filter(function (e) { return e !== _this.editStyleName; });\n                }\n                styles.push(typedName);\n                _this.styleParagraph.dataSource = styles;\n                _this.styleParagraph.index = null;\n                _this.styleParagraph.index = styles.indexOf(typedName);\n                _this.styleParagraph.dataBind();\n            }\n        };\n        /**\n         * @private\n         */\n        this.updateOkButton = function () {\n            var styleName = _this.target.getElementsByClassName('e-input e-de-style-dlg-name-input').item(0).value;\n            _this.enableOrDisableOkButton();\n        };\n        /**\n         * @private\n         */\n        /* tslint:disable-next-line:no-any */\n        this.styleTypeChange = function (args) {\n            if (args.isInteracted) {\n                var type = void 0;\n                if (args.value === 'Character') {\n                    _this.style = new WCharacterStyle();\n                    type = 'Character';\n                }\n                if (args.value === 'Paragraph' || args.value === 'Linked(Paragraph and Character)') {\n                    _this.style = new WParagraphStyle();\n                    type = 'Paragraph';\n                }\n                _this.toggleDisable();\n                _this.updateStyleNames(type);\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.styleBasedOnChange = function (args) {\n            //Based on change\n        };\n        /**\n         * @private\n         */\n        /* tslint:disable-next-line:no-any */\n        this.styleParagraphChange = function (args) {\n            if (args.isInteracted) {\n                _this.isUserNextParaUpdated = true;\n            }\n            //Next change\n        };\n        /**\n         * @private\n         */\n        this.showFontDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.fontDialogModule)) {\n                _this.owner.owner.showFontDialog(_this.characterFormat);\n            }\n            _this.updateCharacterFormat();\n        };\n        /**\n         * @private\n         */\n        this.showParagraphDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.paragraphDialogModule)) {\n                _this.owner.owner.showParagraphDialog(_this.paragraphFormat);\n            }\n        };\n        /**\n         * @private\n         */\n        this.showNumberingBulletDialog = function () {\n            _this.numberingBulletDialog = new BulletsAndNumberingDialog(_this.owner.owner.viewer);\n            if (_this.style instanceof WParagraphStyle && (!isNullOrUndefined(_this.style.paragraphFormat))) {\n                // tslint:disable-next-line:max-line-length\n                _this.numberingBulletDialog.showNumberBulletDialog(_this.style.paragraphFormat.listFormat, _this.abstractList);\n            }\n        };\n        /**\n         * @private\n         */\n        this.onOkButtonClick = function () {\n            var styleName = _this.styleNameElement.value;\n            if (styleName.length > 0) {\n                var style = _this.owner.owner.viewer.styles.findByName(styleName);\n                var name_1;\n                if (!isNullOrUndefined(style)) {\n                    _this.style.type = _this.getTypeValue();\n                    _this.style.basedOn = _this.owner.owner.viewer.styles.findByName(_this.styleBasedOn.value);\n                    if (_this.styleType.value === 'Paragraph' || _this.styleType.value === 'Linked(Paragraph and Character)') {\n                        _this.style.next = _this.owner.owner.viewer.styles.findByName(_this.styleParagraph.value);\n                        _this.style.characterFormat.mergeFormat(style.characterFormat);\n                        _this.style.paragraphFormat.mergeFormat(style.paragraphFormat);\n                        _this.updateList();\n                        // tslint:disable-next-line:max-line-length\n                        _this.style.link = (_this.styleType.value === 'Linked(Paragraph and Character)') ? _this.createLinkStyle(styleName, _this.isEdit) : undefined;\n                    }\n                    //Updating existing style implementation\n                    _this.style.name = style.name;\n                    name_1 = style.name;\n                    style = _this.style;\n                    _this.owner.owner.isShiftingEnabled = true;\n                    _this.owner.owner.editorModule.layoutWholeDocument();\n                    _this.owner.owner.isShiftingEnabled = false;\n                }\n                else {\n                    /* tslint:disable-next-line:no-any */\n                    var basedOn = _this.owner.owner.viewer.styles.findByName(_this.styleBasedOn.value);\n                    if (_this.styleType.value === 'Paragraph' || _this.styleType.value === 'Linked(Paragraph and Character)') {\n                        if (styleName === _this.styleParagraph.value) {\n                            _this.style.next = _this.style;\n                        }\n                        else {\n                            _this.style.next = _this.owner.owner.viewer.styles.findByName(_this.styleParagraph.value);\n                        }\n                        _this.updateList();\n                    }\n                    // tslint:disable-next-line:max-line-length\n                    _this.style.link = (_this.styleType.value === 'Linked(Paragraph and Character)') ? _this.createLinkStyle(styleName) : undefined;\n                    _this.style.type = _this.getTypeValue();\n                    _this.style.name = styleName;\n                    _this.style.basedOn = basedOn;\n                    /* tslint:disable-next-line:no-any */\n                    _this.owner.owner.viewer.styles.push(_this.style);\n                    name_1 = styleName;\n                    _this.owner.owner.editorModule.applyStyle(name_1);\n                }\n                _this.owner.owner.viewer.dialog2.hide();\n            }\n            else {\n                throw new Error('Enter valid Style name');\n            }\n            if (_this.style) {\n                //this.style.destroy();\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.loadStyleDialog = function (args) {\n            _this.owner.owner.viewer.updateFocus();\n            _this.isUserNextParaUpdated = false;\n            /* tslint:disable-next-line:max-line-length */\n            _this.styleNameElement = _this.target.getElementsByClassName('e-input e-de-style-dlg-name-input').item(0);\n            _this.styleNameElement.value = null;\n            if (!_this.isEdit) {\n                _this.styleType.index = 0; //Set to paragraph            \n            }\n            var name;\n            if (_this.isEdit) {\n                _this.styleNameElement.value = _this.editStyleName;\n                name = _this.editStyleName;\n            }\n            /* tslint:disable-next-line:max-line-length */\n            _this.okButton = _this.owner.dialog2.element.getElementsByClassName('e-flat e-style-okay').item(0);\n            _this.enableOrDisableOkButton();\n            _this.updateStyleNames(_this.getTypeValue(), name);\n            _this.updateCharacterFormat(_this.style.characterFormat);\n            _this.updateParagraphFormat(_this.style.paragraphFormat);\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            if (!_this.isEdit && _this.style) {\n                _this.style.destroy();\n            }\n            _this.owner.owner.viewer.dialog2.hide();\n        };\n        /**\n         * @private\n         */\n        this.closeStyleDialog = function () {\n            _this.owner.owner.viewer.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    StyleDialog.prototype.getModuleName = function () {\n        return 'StyleDialog';\n    };\n    /**\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    StyleDialog.prototype.initStyleDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_style';\n        this.target = createElement('div', { id: id, className: 'e-de-style-dialog' });\n        var container = createElement('div');\n        // tslint:disable-next-line:max-line-length\n        var properties = createElement('div', { className: 'e-de-style-properties', innerHTML: localValue.getConstant('Properties') });\n        container.appendChild(properties);\n        var styleNameTypeDiv = createElement('div', { styles: 'display:flex', className: 'e-de-style-nametype-div' });\n        container.appendChild(styleNameTypeDiv);\n        var nameWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleNameTypeDiv.appendChild(nameWholeDiv);\n        var name = createElement('div', { className: 'e-de-style-name', innerHTML: localValue.getConstant('Name') + ':' });\n        nameWholeDiv.appendChild(name);\n        // tslint:disable-next-line:max-line-length\n        var nameValue = createElement('input', { id: this.owner.owner.containerId + '_style_name', styles: 'width:210px;', className: 'e-input e-de-style-dlg-name-input' });\n        nameValue.addEventListener('keyup', this.updateOkButton);\n        nameValue.addEventListener('input', this.updateOkButton);\n        nameValue.addEventListener('blur', this.updateNextStyle);\n        nameWholeDiv.appendChild(nameValue);\n        var styleTypeWholeDiv = createElement('div');\n        styleNameTypeDiv.appendChild(styleTypeWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleType = createElement('div', { className: 'e-de-style-styletype', innerHTML: localValue.getConstant('Style type') + ':' });\n        styleTypeWholeDiv.appendChild(styleType);\n        var styleTypeDivElement = createElement('div', { className: 'e-de-style-style-type-div' });\n        var styleTypeValue = createElement('select', { id: 'e-de-style-style-type' });\n        // tslint:disable-next-line:max-line-length\n        styleTypeValue.innerHTML = '<option>Paragraph</option><option>Character</option><option>Linked(Paragraph and Character)</option>'; //<option>Linked(Paragraph and Character)</option><option>Table</option><option>List</option>';\n        styleTypeDivElement.appendChild(styleTypeValue);\n        this.styleType = new DropDownList({ change: this.styleTypeChange, popupHeight: '253px', width: '210px' });\n        this.styleType.appendTo(styleTypeValue);\n        styleTypeWholeDiv.appendChild(styleTypeDivElement);\n        // tslint:disable-next-line:max-line-length\n        var styleBasedParaDiv = createElement('div', { styles: 'display:flex', className: 'e-de-style-based-para-div' });\n        container.appendChild(styleBasedParaDiv);\n        var styleBasedOnWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleBasedParaDiv.appendChild(styleBasedOnWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleBasedOn = createElement('div', { className: 'e-de-style-style-based-on', innerHTML: localValue.getConstant('Style based on') + ':' });\n        styleBasedOnWholeDiv.appendChild(styleBasedOn);\n        var styleBasedOnDivElement = createElement('div', { className: 'e-de-style-style-based-on-div' });\n        // tslint:disable-next-line:max-line-length\n        var styleBasedOnValue = createElement('input', { id: 'e-de-style-style-based-on-value' });\n        //styleBasedOnValue.innerHTML = '<option>Normal</option><option>Heading 1</option><option>Heading 2</option><option>Heading 3</option><option>Heading 4</option><option>Heading 5</option><option>Heading 6</option>';\n        styleBasedOnDivElement.appendChild(styleBasedOnValue);\n        this.styleBasedOn = new DropDownList({ dataSource: [], select: this.styleBasedOnChange, popupHeight: '253px', width: '210px' });\n        this.styleBasedOn.appendTo(styleBasedOnValue);\n        styleBasedOnWholeDiv.appendChild(styleBasedOnDivElement);\n        var styleParagraphWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleBasedParaDiv.appendChild(styleParagraphWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleParagraph = createElement('div', { className: 'e-de-style-style-paragraph', innerHTML: localValue.getConstant('Style for following paragraph') + ':' });\n        styleParagraphWholeDiv.appendChild(styleParagraph);\n        var styleParagraphDivElement = createElement('div', { className: 'e-de-style-style-paragraph-div' });\n        // tslint:disable-next-line:max-line-length\n        var styleParagraphValue = createElement('input', { id: 'e-de-style-style-paragraph-value' });\n        // tslint:disable-next-line:max-line-length\n        //styleParagraphValue.innerHTML = '<option>Normal</option><option>Heading 1</option><option>Heading 2</option><option>Heading 3</option><option>Heading 4</option><option>Heading 5</option><option>Heading 6</option>';\n        styleParagraphDivElement.appendChild(styleParagraphValue);\n        this.styleParagraph = new DropDownList({ dataSource: [], select: this.styleParagraphChange, popupHeight: '253px', width: '210px' });\n        this.styleParagraph.appendTo(styleParagraphValue);\n        styleParagraphWholeDiv.appendChild(styleParagraphDivElement);\n        // tslint:disable-next-line:max-line-length\n        var formatting = createElement('div', { className: 'e-de-style-formatting', innerHTML: localValue.getConstant('Formatting') });\n        container.appendChild(formatting);\n        var optionsDiv = createElement('div', { className: 'e-de-style-options-div' });\n        container.appendChild(optionsDiv);\n        var fontOptionsDiv = createElement('div', { styles: 'display:flex;margin-bottom: 15px;' });\n        optionsDiv.appendChild(fontOptionsDiv);\n        this.createFontOptions(fontOptionsDiv);\n        var paragraphOptionsDiv = createElement('div', { styles: 'display:flex', className: 'e-style-paragraph' });\n        optionsDiv.appendChild(paragraphOptionsDiv);\n        this.createParagraphOptions(paragraphOptionsDiv);\n        // let radioOptionsDiv: HTMLElement = createElement('div', { styles: 'display:flex' });\n        // container.appendChild(radioOptionsDiv);\n        // let onlyThisDocumentDiv: HTMLElement = createElement('div', { className: 'e-de-style-radio-button' });\n        // tslint:disable-next-line:max-line-length\n        // let onlyThisDocument: HTMLInputElement = createElement('input', { className: 'e-de-style-only-this-doc', attrs: { type: 'radio' } }) as HTMLInputElement;\n        // onlyThisDocumentDiv.appendChild(onlyThisDocument);\n        // tslint:disable-next-line:max-line-length\n        // this.onlyThisDocument = new RadioButton({ label: 'Only in this document', value: 'only in this document', checked: true, name: 'styles' });\n        // this.onlyThisDocument.appendTo(onlyThisDocument);\n        // radioOptionsDiv.appendChild(onlyThisDocumentDiv);\n        // let templateDiv: HTMLElement = createElement('div', { className: 'e-de-style-radio-button' });\n        // tslint:disable-next-line:max-line-length\n        // let template: HTMLInputElement = createElement('input', { className: 'e-de-style-temp', attrs: { type: 'radio' } }) as HTMLInputElement;\n        // templateDiv.appendChild(template);\n        // this.template = new RadioButton({ label: 'Template', value: 'template', name: 'styles' });\n        // this.template.appendTo(template);\n        // radioOptionsDiv.appendChild(templateDiv);\n        this.createFormatDropdown(container, localValue);\n        this.target.appendChild(container);\n    };\n    StyleDialog.prototype.createFormatDropdown = function (parentDiv, localValue) {\n        var _this = this;\n        var formatBtn = createElement('button', { id: 'style_format_dropdown', innerHTML: localValue.getConstant('Format') });\n        formatBtn.style.height = '35px';\n        parentDiv.appendChild(formatBtn);\n        var items = [{ text: localValue.getConstant('Font') + '..', id: 'style_font' },\n            { text: localValue.getConstant('Paragraph') + '..', id: 'style_paragraph' },\n            { text: localValue.getConstant('Numbering') + '..', id: 'style_numbering' }];\n        var dropDownbtn = new DropDownButton({\n            items: items, cssClass: 'e-de-style-format-dropdwn',\n            beforeItemRender: function (args) {\n                if (_this.styleType.value === 'Character') {\n                    if (args.item.text === 'Paragraph') {\n                        args.element.classList.add('e-disabled');\n                    }\n                    if (args.item.text === 'Numbering') {\n                        args.element.classList.add('e-disabled');\n                    }\n                }\n                else {\n                    if (args.item.text === 'Paragraph') {\n                        args.element.classList.remove('e-disabled');\n                    }\n                    if (args.item.text === 'Numbering') {\n                        args.element.classList.remove('e-disabled');\n                    }\n                }\n            }\n        });\n        dropDownbtn.appendTo(formatBtn);\n        dropDownbtn.addEventListener('select', this.openDialog);\n    };\n    StyleDialog.prototype.createFontOptions = function (parentDiv) {\n        var fontFamilyElement = createElement('select', { id: this.target.id + '_fontName' });\n        fontFamilyElement.innerHTML = '<option>Arial</option><option>Calibri</option><option>Candara</option>' +\n            '<option>Comic Sans MS</option><option>Consolas</option><option>Constantia</option><option>Corbel</option>' +\n            '<option>Courier New</option><option>Ebrima</option><option>Franklin Gothic</option>' +\n            '<option>Gabriola</option><option>Gadugi</option><option>Georgia</option><option>Impact</option>' +\n            '<option>Javanese Text</option><option>Microsoft Sans Serif</option><option>MS Gothic</option><option>MS UI Gothic</option>' +\n            '<option>Segoe Print</option><option>Times New Roman</option><option>Verdana</option><option>Segoe UI</option>' +\n            '<option>Algerian</option><option>Cambria</option><option>Georgia</option><option>Consolas</option>';\n        parentDiv.appendChild(fontFamilyElement);\n        this.fontFamily = new ComboBox({\n            width: '123px', popupWidth: '123px',\n            cssClass: 'e-style-font-fmaily-right', change: this.fontFamilyChanged\n        });\n        this.fontFamily.showClearButton = false;\n        this.fontFamily.appendTo(fontFamilyElement);\n        var fontSizeElement = createElement('input');\n        parentDiv.appendChild(fontSizeElement);\n        var sizeDataSource = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72];\n        this.fontSize = new ComboBox({\n            dataSource: sizeDataSource, width: '73px', cssClass: 'e-style-font-fmaily-right',\n            change: this.fontSizeUpdate\n        });\n        this.fontSize.showClearButton = false;\n        this.fontSize.appendTo(fontSizeElement);\n        var fontGroupButton = createElement('div', { className: 'e-de-style-font-group-button' });\n        parentDiv.appendChild(fontGroupButton);\n        // tslint:disable-next-line:max-line-length\n        this.bold = this.createButtonElement(fontGroupButton, 'e-de-bold', 'e-de-style-bold-button-size', this.owner.owner.containerId + '_style_bold');\n        this.bold.addEventListener('click', this.setBoldProperty);\n        // tslint:disable-next-line:max-line-length\n        this.italic = this.createButtonElement(fontGroupButton, 'e-de-italic', 'e-de-style-icon-button-size', this.owner.owner.containerId + '_style_italic');\n        this.italic.addEventListener('click', this.setItalicProperty);\n        // tslint:disable-next-line:max-line-length\n        this.underline = this.createButtonElement(fontGroupButton, 'e-de-underline', 'e-de-style-icon-button-size', this.owner.owner.containerId + '_style_underline');\n        this.underline.addEventListener('click', this.setUnderlineProperty);\n        var fontColorElement = createElement('input', { attrs: { type: 'color' }, className: 'e-de-style-icon-button-size' });\n        parentDiv.appendChild(fontColorElement);\n        this.fontColor = new ColorPicker({ cssClass: 'e-de-style-font-color-picker', change: this.fontColorUpdate });\n        this.fontColor.appendTo(fontColorElement);\n    };\n    StyleDialog.prototype.createParagraphOptions = function (parentDiv) {\n        var _this = this;\n        var alignmentDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(alignmentDiv);\n        this.leftAlign = this.createButtonElement(alignmentDiv, 'e-de-align-left', 'e-de-style-icon-button-size');\n        this.leftAlign.addEventListener('click', this.setLeftAlignment);\n        this.centerAlign = this.createButtonElement(alignmentDiv, 'e-de-align-center', 'e-de-style-icon-button-size');\n        this.centerAlign.addEventListener('click', this.setCenterAlignment);\n        this.rightAlign = this.createButtonElement(alignmentDiv, 'e-de-align-right', 'e-de-style-icon-button-size');\n        this.rightAlign.addEventListener('click', this.setRightAlignment);\n        this.justify = this.createButtonElement(alignmentDiv, 'e-de-justify', 'e-de-style-icon-button-last-size');\n        this.justify.addEventListener('click', this.setJustifyAlignment);\n        var lineSpacingDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(lineSpacingDiv);\n        this.singleLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-single-spacing', 'e-de-style-icon-button-first-size');\n        this.singleLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 1;\n            _this.updateParagraphFormat();\n        });\n        // tslint:disable-next-line:max-line-length\n        this.onePointFiveLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-one-point-five-spacing', 'e-de-style-icon-button-size');\n        this.onePointFiveLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 1.5;\n            _this.updateParagraphFormat();\n        });\n        this.doubleLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-double-spacing', 'e-de-style-icon-button-last-size');\n        this.doubleLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 2;\n            _this.updateParagraphFormat();\n        });\n        var spacingDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(spacingDiv);\n        var beforeSpacing = this.createButtonElement(spacingDiv, 'e-de-before-spacing', 'e-de-style-icon-button-first-size');\n        var afterSpacing = this.createButtonElement(spacingDiv, 'e-de-after-spacing', 'e-de-style-icon-button-last-size');\n        beforeSpacing.addEventListener('click', this.increaseBeforeAfterSpacing);\n        afterSpacing.addEventListener('click', this.decreaseBeforeAfterSpacing);\n        var indentingDiv = createElement('div', { className: 'e-de-style-paragraph-indent-group-button' });\n        parentDiv.appendChild(indentingDiv);\n        var decreaseIndent = this.createButtonElement(indentingDiv, 'e-de-indent', 'e-de-style-icon-button-first-size');\n        decreaseIndent.addEventListener('click', function () {\n            if (_this.paragraphFormat.leftIndent >= 36) {\n                _this.paragraphFormat.leftIndent -= 36;\n            }\n            else {\n                _this.paragraphFormat.leftIndent = 0;\n            }\n        });\n        var increaseindent = this.createButtonElement(indentingDiv, 'e-de-outdent', 'e-de-style-icon-button-size');\n        increaseindent.addEventListener('click', function () {\n            _this.paragraphFormat.leftIndent += 36;\n        });\n    };\n    StyleDialog.prototype.createButtonElement = function (parentDiv, iconCss, className, id) {\n        var buttonElement = createElement('button');\n        if (!isNullOrUndefined(id)) {\n            buttonElement.id = id;\n        }\n        parentDiv.appendChild(buttonElement);\n        var button = new Button({ iconCss: iconCss, cssClass: className });\n        button.appendTo(buttonElement);\n        return buttonElement;\n    };\n    StyleDialog.prototype.toggleDisable = function () {\n        if (this.styleType.value === 'Character') {\n            this.styleParagraph.enabled = false;\n            // tslint:disable-next-line:max-line-length\n            this.target.getElementsByClassName('e-style-paragraph').item(0).setAttribute('style', 'display:flex;pointer-events:none;opacity:0.5');\n        }\n        else {\n            this.styleParagraph.enabled = true;\n            this.target.getElementsByClassName('e-style-paragraph').item(0).removeAttribute('style');\n            this.target.getElementsByClassName('e-style-paragraph').item(0).setAttribute('style', 'display:flex');\n        }\n        this.styleBasedOn.enabled = true;\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.show = function (styleName, header) {\n        var localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        this.isEdit = (!isNullOrUndefined(styleName) && styleName.length > 0) ? true : false;\n        this.editStyleName = styleName;\n        this.abstractList = new WAbstractList();\n        // tslint:disable-next-line:max-line-length\n        var style = this.owner.owner.viewer.styles.findByName(styleName);\n        this.style = !this.isEdit ? new WParagraphStyle() : style ? style : this.getStyle(styleName);\n        localObj.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initStyleDialog(localObj);\n        }\n        if (isNullOrUndefined(header)) {\n            header = localObj.getConstant('Create New Style');\n        }\n        this.owner.owner.viewer.dialog2.header = header;\n        this.owner.owner.viewer.dialog2.height = 'auto';\n        this.owner.owner.viewer.dialog2.width = 'auto';\n        this.owner.owner.viewer.dialog2.content = this.target;\n        this.owner.owner.viewer.dialog2.buttons = [{\n                click: this.onOkButtonClick,\n                buttonModel: { content: localObj.getConstant('Ok'), cssClass: 'e-flat e-style-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localObj.getConstant('Cancel'), cssClass: 'e-flat e-style-cancel' }\n            }];\n        this.toggleDisable();\n        this.owner.owner.viewer.dialog2.dataBind();\n        this.owner.owner.viewer.dialog2.beforeOpen = this.loadStyleDialog;\n        this.owner.owner.viewer.dialog2.close = this.closeStyleDialog;\n        this.owner.owner.viewer.dialog2.position = { X: 'center', Y: 'center' };\n        this.owner.owner.viewer.dialog2.show();\n    };\n    StyleDialog.prototype.updateList = function () {\n        var listId = this.style.paragraphFormat.listFormat.listId;\n        if (listId > -1) {\n            if (this.owner.owner.viewer.lists.filter(function (a) { return (a.listId === listId); }).length === 0) {\n                this.owner.owner.viewer.lists.push(this.style.paragraphFormat.listFormat.list);\n            }\n            else {\n                this.owner.owner.viewer.lists = this.owner.owner.viewer.lists.filter(function (a) { return (a.listId !== listId); });\n                this.owner.owner.viewer.lists.push(this.style.paragraphFormat.listFormat.list);\n            }\n        }\n        if (this.abstractList.abstractListId !== -1) {\n            this.owner.owner.viewer.abstractLists.push(this.abstractList);\n        }\n    };\n    StyleDialog.prototype.createLinkStyle = function (name, isEdit) {\n        var charStyle;\n        if (isEdit) {\n            charStyle = this.owner.owner.viewer.styles.findByName((name + ' Char'), 'Character');\n        }\n        else {\n            charStyle = new WCharacterStyle();\n        }\n        charStyle.type = 'Character';\n        charStyle.name = name + ' Char';\n        charStyle.characterFormat = this.style.characterFormat.cloneFormat();\n        charStyle.basedOn = this.style.basedOn;\n        if (!isEdit) {\n            this.owner.owner.viewer.styles.push(charStyle);\n        }\n        return this.owner.owner.viewer.styles.findByName(charStyle.name, 'Character');\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.updateCharacterFormat = function (characterFormat) {\n        if (!isNullOrUndefined(characterFormat)) {\n            this.characterFormat = characterFormat;\n        }\n        this.fontFamily.value = this.characterFormat.fontFamily;\n        this.fontSize.value = this.characterFormat.fontSize;\n        this.fontColor.value = this.characterFormat.fontColor;\n        this.fontButtonClicked(undefined);\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.updateParagraphFormat = function (paragraphFOrmat) {\n        if (!isNullOrUndefined(paragraphFOrmat)) {\n            this.paragraphFormat = paragraphFOrmat;\n        }\n        if (this.paragraphFormat.textAlignment === 'Left') {\n            if (!this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.add('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Right') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (!this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.add('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Center') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (!this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.add('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Justify') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (!this.justify.classList.contains('e-active')) {\n                this.justify.classList.add('e-active');\n            }\n        }\n        if (this.paragraphFormat.lineSpacing === 1) {\n            this.singleLineSpacing.classList.add('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n        else if (this.paragraphFormat.lineSpacing === 1.5) {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.add('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n        else if (this.paragraphFormat.lineSpacing === 2) {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.add('e-active');\n        }\n        else {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n    };\n    StyleDialog.prototype.enableOrDisableOkButton = function () {\n        if (!isNullOrUndefined(this.okButton)) {\n            this.okButton.disabled = (this.styleNameElement.value === '');\n        }\n    };\n    StyleDialog.prototype.getTypeValue = function () {\n        var type;\n        if (this.styleType.value === 'Linked(Paragraph and Character)' || this.styleType.value === 'Paragraph') {\n            return 'Paragraph';\n        }\n        else {\n            return 'Character';\n        }\n    };\n    StyleDialog.prototype.updateStyleNames = function (type, name) {\n        var styles = this.owner.owner.viewer.styles.getStyleNames(type);\n        this.styleParagraph.dataSource = styles;\n        this.styleParagraph.index = null;\n        if (name) {\n            this.styleBasedOn.dataSource = styles.filter(function (e) { return e !== name; });\n            this.styleBasedOn.index = null;\n            var style = this.getStyle(name);\n            if (style.basedOn instanceof String || isNullOrUndefined(style.basedOn)) {\n                this.styleBasedOn.enabled = false;\n            }\n            else {\n                /* tslint:disable-next-line:max-line-length */\n                this.styleBasedOn.index = styles.indexOf(style.basedOn.name) > -1 ? styles.indexOf(style.basedOn.name) : 0;\n            }\n            if (style.type === 'Paragraph') {\n                if (!isNullOrUndefined(style.link)) {\n                    this.styleType.index = 2;\n                }\n                else {\n                    this.styleType.index = 0;\n                }\n            }\n            else {\n                this.styleType.index = 1;\n            }\n            if (!isNullOrUndefined(style.next)) {\n                var nxtName = style.next.name;\n                var index = 0;\n                if (styles.indexOf(nxtName) > -1) {\n                    index = styles.indexOf(nxtName);\n                }\n                this.styleParagraph.index = index;\n                this.isUserNextParaUpdated = (nxtName === name) ? false : true;\n            }\n        }\n        else {\n            this.styleBasedOn.dataSource = styles;\n            this.styleBasedOn.index = null;\n            var basedOnIndex = 0;\n            if (this.owner.owner.selectionModule) {\n                var styleName = void 0;\n                if (type === 'Character') {\n                    styleName = this.owner.owner.selection.characterFormat.styleName;\n                }\n                else {\n                    styleName = this.owner.owner.selection.paragraphFormat.styleName;\n                }\n                basedOnIndex = styles.indexOf(styleName);\n            }\n            this.styleBasedOn.index = basedOnIndex;\n            this.styleParagraph.index = 0;\n        }\n        if (this.isEdit) {\n            this.styleType.enabled = false;\n        }\n        else {\n            this.styleType.enabled = true;\n        }\n        this.styleBasedOn.dataBind();\n        this.styleParagraph.dataBind();\n    };\n    StyleDialog.prototype.getStyle = function (styleName) {\n        /* tslint:disable-next-line:max-line-length */\n        if (isNullOrUndefined(this.owner.owner.viewer.styles.findByName(styleName))) {\n            /* tslint:disable-next-line:max-line-length */\n            this.owner.owner.editor.createStyle(this.owner.owner.viewer.preDefinedStyles.get(styleName));\n        }\n        return this.owner.owner.viewer.styles.findByName(styleName);\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var n = 0; n < this.target.childNodes.length; n++) {\n                this.target.removeChild(this.target.childNodes[n]);\n                n--;\n            }\n            this.target = undefined;\n        }\n        if (this.styleType) {\n            this.styleType.destroy();\n        }\n        this.styleType = undefined;\n        if (this.styleBasedOn) {\n            this.styleBasedOn.destroy();\n        }\n        this.styleBasedOn = undefined;\n        if (this.styleParagraph) {\n            this.styleParagraph.destroy();\n        }\n        this.styleParagraph = undefined;\n        if (this.onlyThisDocument) {\n            this.onlyThisDocument.destroy();\n        }\n        this.onlyThisDocument = undefined;\n        if (this.template) {\n            this.template.destroy();\n        }\n        this.template = undefined;\n        if (this.style) {\n            this.style = undefined;\n        }\n        if (this.abstractList) {\n            this.abstractList = undefined;\n        }\n        if (this.numberingBulletDialog) {\n            this.numberingBulletDialog.destroy();\n        }\n        this.numberingBulletDialog = undefined;\n    };\n    return StyleDialog;\n}());\nexport { StyleDialog };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { WListFormat } from '../../implementation/format/list-format';\n/**\n * The Bullets and Numbering dialog is used to apply list format for a paragraph style.\n */\n/* tslint:disable:no-any */\nvar BulletsAndNumberingDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BulletsAndNumberingDialog(layoutViewer) {\n        var _this = this;\n        this.isBullet = false;\n        /**\n         * @private\n         */\n        this.numberListClick = function (args) {\n            _this.isBullet = false;\n            _this.setActiveElement(args);\n            if (args.currentTarget.classList.contains('e-de-list-numbered-none')) {\n                _this.numberFormat = undefined;\n                _this.listLevelPattern = undefined;\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-number-dot')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'Arabic';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-number-brace')) {\n                _this.numberFormat = '%1)';\n                _this.listLevelPattern = 'Arabic';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-up-roman')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'UpRoman';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-up-letter')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'UpLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-low-letter-brace')) {\n                _this.numberFormat = '%1)';\n                _this.listLevelPattern = 'LowLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-numbered-low-letter-dot')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'LowLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-low-roman')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'LowRoman';\n            }\n        };\n        /**\n         * @private\n         */\n        this.bulletListClick = function (args) {\n            _this.isBullet = true;\n            _this.setActiveElement(args);\n            if (args.currentTarget.classList.contains('e-bullet-none')) {\n                _this.symbol = undefined;\n                _this.fontFamily = undefined;\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-dot')) {\n                _this.symbol = '\\uf0b7';\n                _this.fontFamily = 'Symbol';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-circle')) {\n                _this.symbol = '\\uf06f' + '\\u0020';\n                _this.fontFamily = 'Symbol';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-square')) {\n                _this.symbol = '\\uf0a7';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-flower')) {\n                _this.symbol = '\\uf076';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-arrow')) {\n                _this.symbol = '\\uf0d8';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-tick')) {\n                _this.symbol = '\\uf0fc';\n                _this.fontFamily = 'Wingdings';\n            }\n        };\n        /**\n         * @private\n         */\n        this.loadNumberingBulletDialog = function () {\n            //Load \n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.closeNumberingBulletDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.isBullet = false;\n            _this.listLevelPattern = undefined;\n            _this.numberFormat = undefined;\n            _this.symbol = undefined;\n            _this.fontFamily = undefined;\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.onOkButtonClick = function () {\n            if (_this.owner.owner.viewer.lists.length > 0) {\n                _this.listFormat.list.listId = _this.owner.owner.viewer.lists[_this.owner.owner.viewer.lists.length - 1].listId + 1;\n                _this.listFormat.listId = _this.listFormat.list.listId;\n            }\n            else {\n                _this.listFormat.list.listId = 0;\n                _this.listFormat.listId = 0;\n            }\n            if (_this.owner.owner.viewer.abstractLists.length > 0) {\n                /* tslint:disable-next-line:max-line-length */\n                _this.abstractList.abstractListId = _this.owner.owner.viewer.abstractLists[_this.owner.owner.viewer.abstractLists.length - 1].abstractListId + 1;\n            }\n            else {\n                _this.abstractList.abstractListId = 0;\n            }\n            _this.listFormat.list.abstractListId = _this.abstractList.abstractListId;\n            var listLevel = new WListLevel(_this.abstractList);\n            listLevel.listLevelPattern = !isNullOrUndefined(_this.listLevelPattern) ? _this.listLevelPattern : 'Bullet';\n            listLevel.numberFormat = _this.isBullet ? _this.symbol : _this.numberFormat;\n            if (listLevel.listLevelPattern !== 'Bullet') {\n                listLevel.startAt = 1;\n            }\n            listLevel.characterFormat.fontFamily = !isNullOrUndefined(_this.fontFamily) ? _this.fontFamily : 'Verdana';\n            listLevel.paragraphFormat.leftIndent = 36;\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            _this.abstractList.levels.push(listLevel);\n            _this.listFormat.listLevelNumber = 0;\n            _this.listFormat.list.abstractList = _this.abstractList;\n            _this.owner.dialog.hide();\n        };\n        this.owner = layoutViewer;\n    }\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.getModuleName = function () {\n        return 'BulletsAndNumberingDialog';\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.initNumberingBulletDialog = function (locale) {\n        var instance = this;\n        var id = this.owner.owner.containerId;\n        this.target = createElement('div', { id: id + '_insertNumberBulletDialog', className: 'e-de-number-bullet-dlg' });\n        var tabTarget = createElement('div', { id: id + '_tabNumberBulletDialog', className: 'e-de-tab-number-bullet-dlg' });\n        this.target.appendChild(tabTarget);\n        this.createNumberList(id);\n        this.createBulletList(id);\n        //Initialize Tab component\n        var tabObj = new Tab({\n            items: [\n                {\n                    header: { 'text': locale.getConstant('Numbering') },\n                    /* tslint:disable-next-line:max-line-length */\n                    content: ('#' + id + '_Number'),\n                },\n                {\n                    header: { 'text': locale.getConstant('Bullets') },\n                    /* tslint:disable-next-line:max-line-length */\n                    content: ('#' + id + '_Bullet'),\n                },\n            ],\n            heightAdjustMode: 'None',\n            width: 272,\n        });\n        //Render initialized Tab component\n        tabObj.appendTo(tabTarget);\n        this.owner.owner.element.appendChild(this.target);\n        tabObj.refresh();\n    };\n    BulletsAndNumberingDialog.prototype.createNumberList = function (id) {\n        var numberListDiv = createElement('div', { className: 'e-de-style-numbered-list', id: id + '_Number' });\n        numberListDiv.style.display = 'none';\n        numberListDiv.style.height = '270px';\n        var ulTag = createElement('ul', {\n            styles: 'display: block; outline: 0px;',\n            id: 'listMenu',\n            className: 'e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail'\n        });\n        numberListDiv.appendChild(ulTag);\n        var numberedNone = this.createNumberNoneListTag(ulTag);\n        var numberedNumberDot = this.createNumberListTag(ulTag, '1.', '2.', '3.', 'e-de-list-numbered-number-dot');\n        var numberedNumberBrace = this.createNumberListTag(ulTag, '1)', '2)', '3)', 'e-de-list-numbered-number-brace');\n        var numberedUpRoman = this.createNumberListTag(ulTag, 'I.', 'II.', 'III.', 'e-de-list-numbered-up-roman');\n        var numberedUpLettter = this.createNumberListTag(ulTag, 'A.', 'B.', 'C.', 'e-de-list-numbered-up-letter');\n        var numberedLowLetterDot = this.createNumberListTag(ulTag, 'a.', 'b.', 'c.', 'e-de-numbered-low-letter-dot');\n        var numberedLowLetterBrace = this.createNumberListTag(ulTag, 'a)', 'b)', 'c)', 'e-de-list-numbered-low-letter-brace');\n        var numberedLowRoman = this.createNumberListTag(ulTag, 'i.', 'ii.', 'iii.', 'e-de-list-numbered-low-roman');\n        numberedNone.addEventListener('click', this.numberListClick);\n        numberedNumberDot.addEventListener('click', this.numberListClick);\n        numberedNumberBrace.addEventListener('click', this.numberListClick);\n        numberedUpRoman.addEventListener('click', this.numberListClick);\n        numberedUpLettter.addEventListener('click', this.numberListClick);\n        numberedLowLetterBrace.addEventListener('click', this.numberListClick);\n        numberedLowLetterDot.addEventListener('click', this.numberListClick);\n        numberedLowRoman.addEventListener('click', this.numberListClick);\n        this.target.appendChild(numberListDiv);\n    };\n    BulletsAndNumberingDialog.prototype.createNumberListTag = function (ulTag, text1, text2, text3, className) {\n        var liTag = createElement('li', {\n            styles: 'display:block',\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size ' + className\n        });\n        ulTag.appendChild(liTag);\n        /* tslint:disable-next-line:max-line-length */\n        var innerHTML = '<div>' + text1 + '<span class=\"e-de-ui-list-line\"></span></div><div>' + text2 + '<span class=\"e-de-ui-list-line\">';\n        innerHTML += '</span></div><div>' + text3 + '<span class=\"e-de-ui-list-line\"> </span></div >';\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-ui-list-header-presetmenu',\n            id: 'e-de-ui-zlist0', innerHTML: innerHTML\n        });\n        liTag.style.cssFloat = 'left';\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createNumberNoneListTag = function (ulTag) {\n        var liTag = createElement('li', {\n            styles: 'display:block',\n            /* tslint:disable-next-line:max-line-length */\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size e-de-list-numbered-none'\n        });\n        ulTag.appendChild(liTag);\n        var innerHTML = '<div class=\"e-de-ui-bullets e-de-bullet-icons\">None</div>';\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-ui-list-header-presetmenu',\n            id: 'e-de-ui-zlist0', innerHTML: innerHTML\n        });\n        liTag.style.cssFloat = 'left';\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createBulletListTag = function (ulTag, iconCss, className) {\n        var liTag = createElement('li', {\n            styles: 'display:block;',\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-bullet-menuitem-md e-de-list-items  e-de-list-item-size ' + className\n        });\n        ulTag.appendChild(liTag);\n        /* tslint:disable-next-line:max-line-length */\n        var liInnerDiv = createElement('div', { className: 'e-de-ui-bullet-list-header-presetmenu e-de-bullet-icon-size', id: 'e-de-ui-zlist0' });\n        var liNextDiv = createElement('div', { className: iconCss });\n        liInnerDiv.appendChild(liNextDiv);\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createBulletList = function (id) {\n        var bulletListDiv = createElement('div', { className: 'e-de-ui-bullet-list-header-presetmenu', id: id + '_Bullet' });\n        bulletListDiv.style.display = 'none';\n        bulletListDiv.style.height = '270px';\n        var ulTag = createElement('ul', {\n            styles: 'display: block; outline: 0px;', id: 'listMenu',\n            className: 'e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail'\n        });\n        bulletListDiv.appendChild(ulTag);\n        var bulletNone = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-none e-de-bullet-icons', 'e-bullet-none');\n        var bulletDot = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-dot e-de-bullet-icons', 'e-bullet-dot');\n        /* tslint:disable-next-line:max-line-length */\n        var bulletCircle = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-circle e-de-bullet-icons', 'e-bullet-circle');\n        var bulletSquare = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-square e-de-bullet-icons', 'e-bullet-square');\n        /* tslint:disable-next-line:max-line-length */\n        var bulletFlower = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-flower e-de-bullet-icons', 'e-bullet-flower');\n        var bulletArrow = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-arrow e-de-bullet-icons', 'e-bullet-arrow');\n        var bulletTick = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-tick e-de-bullet-icons', 'e-bullet-tick');\n        bulletNone.addEventListener('click', this.bulletListClick);\n        bulletDot.addEventListener('click', this.bulletListClick);\n        bulletCircle.addEventListener('click', this.bulletListClick);\n        bulletSquare.addEventListener('click', this.bulletListClick);\n        bulletFlower.addEventListener('click', this.bulletListClick);\n        bulletArrow.addEventListener('click', this.bulletListClick);\n        bulletTick.addEventListener('click', this.bulletListClick);\n        // bulletListDiv.appendChild(table1);        \n        this.target.appendChild(bulletListDiv);\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.showNumberBulletDialog = function (listFormat, abstractList) {\n        if (!isNullOrUndefined(listFormat)) {\n            this.listFormat = listFormat;\n        }\n        else {\n            this.listFormat = new WListFormat();\n        }\n        if (isNullOrUndefined(this.listFormat.list)) {\n            this.listFormat.list = new WList();\n        }\n        if (!isNullOrUndefined(abstractList)) {\n            this.abstractList = abstractList;\n        }\n        else {\n            this.abstractList = new WAbstractList();\n        }\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initNumberingBulletDialog(locale);\n        }\n        this.owner.dialog.header = locale.getConstant('Numbering and Bullets');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadNumberingBulletDialog;\n        this.owner.dialog.close = this.closeNumberingBulletDialog;\n        this.owner.dialog.position = { X: 'center', Y: 'center' };\n        this.owner.dialog.buttons = [{\n                click: this.onOkButtonClick,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-numbering-bullet-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-numbering-bullet-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BulletsAndNumberingDialog.prototype.setActiveElement = function (args) {\n        var html = args.currentTarget.parentElement;\n        for (var i = 0; i < html.childElementCount; i++) {\n            if (html.childNodes[i].classList.contains('e-de-list-active')) {\n                html.childNodes[i].classList.remove('e-de-list-active');\n            }\n        }\n        args.currentTarget.classList.add('e-de-list-active');\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.unWireEventsAndBindings = function () {\n        //Unwire events\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (this.listFormat) {\n            this.listFormat.destroy();\n            this.listFormat = undefined;\n        }\n        if (this.abstractList) {\n            this.abstractList.destroy();\n            this.abstractList = undefined;\n        }\n        if (this.target && this.target.parentElement) {\n            this.target.parentElement.removeChild(this.target);\n            for (var m = 0; m < this.target.childNodes.length; m++) {\n                this.target.removeChild(this.target.childNodes[m]);\n                m--;\n            }\n            this.target = undefined;\n        }\n    };\n    return BulletsAndNumberingDialog;\n}());\nexport { BulletsAndNumberingDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList, ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { WCharacterFormat } from '../format/character-format';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\n/**\n * The Font dialog is used to modify formatting of selected text.\n */\n/* tslint:disable:no-any */\nvar FontDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function FontDialog(layoutViewer) {\n        var _this = this;\n        this.fontStyleInternal = undefined;\n        this.fontNameList = undefined;\n        this.fontStyleText = undefined;\n        this.fontSizeText = undefined;\n        this.colorPicker = undefined;\n        this.underlineDrop = undefined;\n        this.strikethroughBox = undefined;\n        this.doublestrikethrough = undefined;\n        this.superscript = undefined;\n        this.subscript = undefined;\n        //Character Format Property\n        this.bold = undefined;\n        this.italic = undefined;\n        this.underline = undefined;\n        this.strikethrough = undefined;\n        this.baselineAlignment = undefined;\n        this.fontSize = undefined;\n        this.fontFamily = undefined;\n        this.fontColor = undefined;\n        /**\n         * @private\n         */\n        this.characterFormat = undefined;\n        /**\n         * @private\n         */\n        this.loadFontDialog = function () {\n            _this.owner.updateFocus();\n            var characterFormat;\n            if (_this.characterFormat) {\n                characterFormat = _this.characterFormat;\n            }\n            else {\n                characterFormat = _this.owner.owner.selection.characterFormat;\n            }\n            _this.fontNameList.value = characterFormat.fontFamily;\n            if (!characterFormat.bold && !characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 0;\n            }\n            else if (characterFormat.bold && !characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 1;\n            }\n            else if (!characterFormat.bold && characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 2;\n            }\n            else if (characterFormat.bold && characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 3;\n            }\n            if (!isNullOrUndefined(characterFormat.fontSize)) {\n                for (var i = 0; i <= 15; i++) {\n                    var items = _this.fontSizeText.getItems();\n                    if (characterFormat.fontSize.toString() === items[i].innerHTML) {\n                        _this.fontSizeText.value = characterFormat.fontSize;\n                        _this.fontSizeText.index = i;\n                        break;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(characterFormat.fontColor)) {\n                _this.colorPicker.value = characterFormat.fontColor;\n            }\n            else {\n                _this.colorPicker.value = '#000000';\n            }\n            if (characterFormat.underline === 'None') {\n                _this.underlineDrop.index = 0;\n            }\n            else if (characterFormat.underline === 'Single') {\n                _this.underlineDrop.index = 1;\n            }\n            if (characterFormat.strikethrough === 'SingleStrike') {\n                _this.strikethroughBox.checked = true;\n            }\n            else if (characterFormat.strikethrough === 'DoubleStrike') {\n                _this.doublestrikethrough.checked = true;\n            }\n            else {\n                _this.strikethroughBox.checked = false;\n                _this.doublestrikethrough.checked = false;\n            }\n            if (characterFormat.baselineAlignment === 'Superscript') {\n                _this.superscript.checked = true;\n            }\n            else if (characterFormat.baselineAlignment === 'Subscript') {\n                _this.subscript.checked = true;\n            }\n            else {\n                _this.superscript.checked = false;\n                _this.subscript.checked = false;\n            }\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.closeFontDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.onInsertFontFormat = function () {\n            var format;\n            if (_this.characterFormat) {\n                format = _this.characterFormat;\n            }\n            else {\n                format = new WCharacterFormat(undefined);\n            }\n            if (!isNullOrUndefined(_this.bold)) {\n                format.bold = _this.bold;\n            }\n            if (!isNullOrUndefined(_this.italic)) {\n                format.italic = _this.italic;\n            }\n            if (!isNullOrUndefined(_this.fontSize) && _this.fontSize > 0) {\n                format.fontSize = _this.fontSize;\n            }\n            if (!isNullOrUndefined(_this.fontColor)) {\n                format.fontColor = _this.fontColor;\n            }\n            if (!isNullOrUndefined(_this.baselineAlignment)) {\n                format.baselineAlignment = _this.baselineAlignment;\n            }\n            if (!isNullOrUndefined(_this.strikethrough)) {\n                format.strikethrough = _this.strikethrough;\n            }\n            if (!isNullOrUndefined(_this.underline)) {\n                format.underline = _this.underline;\n            }\n            if (!isNullOrUndefined(_this.fontFamily)) {\n                format.fontFamily = _this.fontFamily;\n            }\n            if (!_this.characterFormat) {\n                _this.onCharacterFormat(_this.owner.selection, format);\n            }\n            else {\n                _this.owner.owner.styleDialogModule.updateCharacterFormat();\n            }\n            _this.owner.dialog.hide();\n        };\n        this.fontSizeUpdate = function (args) {\n            _this.fontSize = args.value;\n        };\n        this.fontStyleUpdate = function (args) {\n            _this.fontStyle = args.value;\n        };\n        this.fontFamilyUpdate = function (args) {\n            _this.fontFamily = args.value;\n        };\n        this.underlineUpdate = function (args) {\n            _this.underline = args.value;\n        };\n        this.fontColorUpdate = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                _this.fontColor = args.currentValue.hex;\n            }\n        };\n        this.singleStrikeUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.strikethrough = 'SingleStrike';\n            }\n            else {\n                _this.strikethrough = 'None';\n            }\n        };\n        this.doubleStrikeUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.strikethrough = 'DoubleStrike';\n            }\n            else {\n                _this.strikethrough = 'None';\n            }\n        };\n        this.superscriptUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.baselineAlignment = 'Superscript';\n            }\n            else {\n                _this.baselineAlignment = 'Normal';\n            }\n        };\n        this.subscriptUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.baselineAlignment = 'Subscript';\n            }\n            else {\n                _this.baselineAlignment = 'Normal';\n            }\n        };\n        this.owner = layoutViewer;\n    }\n    Object.defineProperty(FontDialog.prototype, \"fontStyle\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.fontStyleInternal;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.fontStyleInternal = value;\n            switch (this.fontStyle) {\n                case 'Bold':\n                    this.bold = true;\n                    this.italic = false;\n                    break;\n                case 'Italic':\n                    this.bold = false;\n                    this.italic = true;\n                    break;\n                case 'BoldItalic':\n                    this.bold = true;\n                    this.italic = true;\n                    break;\n                case 'Regular':\n                    this.bold = false;\n                    this.italic = false;\n                    break;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FontDialog.prototype.getModuleName = function () {\n        return 'FontDialog';\n    };\n    FontDialog.prototype.createInputElement = function (type, id, className) {\n        var element = createElement('input', {\n            attrs: { type: type },\n            id: id,\n            className: className\n        });\n        return element;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.initFontDialog = function (locale) {\n        var instance = this;\n        var effectLabel;\n        var strikeThroughElement;\n        var superScriptElement;\n        var subScriptElement;\n        var doubleStrikeThroughElement;\n        var id = this.owner.owner.containerId;\n        this.target = createElement('div', { id: id + '_insertFontDialog', className: 'e-de-font-dlg' });\n        var fontDiv = this.getFontDiv(locale);\n        this.target.appendChild(fontDiv);\n        var sizeDiv = this.getFontSizeDiv(locale);\n        this.target.appendChild(sizeDiv);\n        var colorDiv = createElement('div', { id: id + '_fontColor', styles: 'margin-top:15px;' });\n        this.fontColorDiv = createElement('div', { id: id + '_fontColorDiv', className: 'e-de-font-dlg-display' });\n        var fontColorLabel = createElement('label', {\n            className: 'e-de-font-dlg-header-font-color e-de-font-color-margin', innerHTML: locale.getConstant('Font color')\n        });\n        this.fontColorDiv.appendChild(fontColorLabel);\n        var fontColorElement = this.createInputElement('color', this.target.id + '_ColorDiv', 'e-de-font-dlg-color');\n        this.fontColorDiv.appendChild(fontColorElement);\n        colorDiv.appendChild(this.fontColorDiv);\n        this.target.appendChild(colorDiv);\n        var fontEffectsDiv = createElement('div', { id: id + '_fontEffectsDiv' });\n        var fontEffectSubDiv1 = createElement('div', {\n            className: 'e-de-font-color-label e-de-font-dlg-display',\n            id: this.target.id + '_fontEffectsSubDiv1'\n        });\n        effectLabel = createElement('label', { className: 'e-de-font-dlg-header-effects', innerHTML: locale.getConstant('Effects') });\n        fontEffectSubDiv1.appendChild(effectLabel);\n        strikeThroughElement = this.createInputElement('checkbox', this.target.id + '_strikeThrough', '');\n        fontEffectSubDiv1.appendChild(strikeThroughElement);\n        superScriptElement = this.createInputElement('checkbox', this.target.id + '_superScript', '');\n        fontEffectSubDiv1.appendChild(superScriptElement);\n        fontEffectsDiv.appendChild(fontEffectSubDiv1);\n        var fontEffectSubDiv2 = createElement('div', { className: 'e-de-font-checkbox', id: id + '_fontEffectsSubDiv2' });\n        subScriptElement = this.createInputElement('checkbox', this.target.id + '_subScript', '');\n        fontEffectSubDiv2.appendChild(subScriptElement);\n        doubleStrikeThroughElement = this.createInputElement('checkbox', this.target.id + '_doubleStrikeThrough', '');\n        fontEffectSubDiv2.appendChild(doubleStrikeThroughElement);\n        fontEffectsDiv.appendChild(fontEffectSubDiv2);\n        this.target.appendChild(fontEffectsDiv);\n        this.owner.owner.element.appendChild(this.target);\n        this.colorPicker = new ColorPicker({\n            change: this.fontColorUpdate, value: '#000000',\n        });\n        this.colorPicker.appendTo(fontColorElement);\n        this.strikethroughBox = new CheckBox({\n            change: this.singleStrikeUpdate,\n            cssClass: 'e-de-font-content-label',\n            label: locale.getConstant('Strikethrough')\n        });\n        this.strikethroughBox.appendTo(strikeThroughElement);\n        this.doublestrikethrough = new CheckBox({\n            change: this.doubleStrikeUpdate,\n            cssClass: 'e-de-font-content-checkbox-label',\n            label: locale.getConstant('Double strikethrough')\n        });\n        this.doublestrikethrough.appendTo(doubleStrikeThroughElement);\n        this.subscript = new CheckBox({\n            label: locale.getConstant('Subscript'),\n            change: this.subscriptUpdate\n        });\n        this.subscript.appendTo(subScriptElement);\n        this.superscript = new CheckBox({\n            label: locale.getConstant('Superscript'),\n            cssClass: 'e-de-font-content-label', change: this.superscriptUpdate\n        });\n        this.superscript.appendTo(superScriptElement);\n    };\n    FontDialog.prototype.getFontSizeDiv = function (locale) {\n        var fontSize;\n        var sizeDiv;\n        var id = this.owner.owner.containerId;\n        sizeDiv = createElement('div', { id: id + '_fontSizeAndUnderlineDiv', className: 'e-de-font-dlg-padding e-de-font-dlg-display' });\n        var sizeSubDiv1 = createElement('div', { id: id + '_fontSizeAndUnderlineSubDiv1' });\n        var sizeLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: locale.getConstant('Size') });\n        var styles = 'font-family:Roboto;font-size:14px;opacity:0.8;';\n        fontSize = createElement('select', { id: this.target.id + '_fontSize', styles: styles });\n        fontSize.innerHTML = '<option>8</option><option>9</option><option>10</option><option>11</option><option>12</option>' +\n            '<option>14</option><option>16</option><option>18</option><option>20</option><option>24</option><option>26</option>' +\n            '<option>28</option><option>36</option><option>48</option><option>72</option><option>96</option>';\n        sizeSubDiv1.appendChild(sizeLabel);\n        sizeSubDiv1.appendChild(fontSize);\n        sizeDiv.appendChild(sizeSubDiv1);\n        var sizeSubDiv2 = createElement('div', {\n            className: 'e-de-font-dlg-cb-right',\n            id: id + '_fontSizeAndUnderlineSubDiv2'\n        });\n        var html = locale.getConstant('Underline style');\n        var underlineLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: html });\n        var underlineElement;\n        underlineElement = createElement('select', { id: this.target.id + '_underLine', styles: styles });\n        underlineElement.innerHTML = '<option>' + locale.getConstant('None') + '</option><option>________</option>';\n        sizeSubDiv2.appendChild(underlineLabel);\n        sizeSubDiv2.appendChild(underlineElement);\n        sizeDiv.appendChild(sizeSubDiv2);\n        this.fontSizeText = new ComboBox({ change: this.fontSizeUpdate, popupHeight: '170px', width: '170px' });\n        this.fontSizeText.showClearButton = false;\n        this.fontSizeText.appendTo(fontSize);\n        this.underlineDrop = new DropDownList({ change: this.underlineUpdate, popupHeight: '100px', width: '170px' });\n        this.underlineDrop.appendTo(underlineElement);\n        return sizeDiv;\n    };\n    FontDialog.prototype.getFontDiv = function (locale) {\n        var id = this.owner.owner.containerId;\n        var fontDiv = createElement('div', { id: id + '_fontDiv', className: 'e-de-font-dlg-display' });\n        var fontSubDiv1 = createElement('div', { id: id + '_fontSubDiv1' });\n        var fontNameLabel = createElement('label', {\n            className: 'e-de-font-dlg-header',\n            innerHTML: locale.getConstant('Font')\n        });\n        var fontNameValues = createElement('select', { id: this.target.id + '_fontName' });\n        fontNameValues.innerHTML = '<option>Arial</option><option>Calibri</option><option>Candara</option><option>Comic Sans MS</option>' +\n            '<option>Consolas</option><option>Constantia</option><option>Corbel</option>' +\n            '<option>Courier New</option><option>Ebrima</option><option>Franklin Gothic</option>' +\n            '<option>Gabriola</option><option>Gadugi</option><option>Georgia</option><option>Impact</option>' +\n            '<option>Javanese Text</option><option>Microsoft Sans Serif</option><option>MS Gothic</option><option>MS UI Gothic</option>' +\n            '<option>Segoe Print</option><option>Times New Roman</option><option>Verdana</option><option>Segoe UI</option>' +\n            '<option>Algerian</option><option>Cambria</option><option>Georgia</option><option>Consolas</option>';\n        fontSubDiv1.appendChild(fontNameLabel);\n        fontSubDiv1.appendChild(fontNameValues);\n        fontDiv.appendChild(fontSubDiv1);\n        var fontSubDiv2;\n        var fontStyleLabel;\n        var fontStyleValues;\n        fontSubDiv2 = createElement('div', { className: 'e-de-font-dlg-cb-right', id: id + '_fontSubDiv2', styles: 'float:right;' });\n        fontStyleLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: locale.getConstant('Font style') });\n        var fontStyle = 'font-family:Roboto;font-size:14px;opacity:0.8;';\n        fontStyleValues = createElement('select', { id: this.target.id + '_fontStyle', styles: fontStyle });\n        fontStyleValues.innerHTML = '<option>' +\n            locale.getConstant('Regular') + '</option><option>' + locale.getConstant('Bold') + '</option><option>' +\n            locale.getConstant('Italic') + '</option><option>' + locale.getConstant('Bold') + locale.getConstant('Italic') + '</option>';\n        fontSubDiv2.appendChild(fontStyleLabel);\n        fontSubDiv2.appendChild(fontStyleValues);\n        fontDiv.appendChild(fontSubDiv2);\n        this.fontNameList = new ComboBox({ change: this.fontFamilyUpdate, popupHeight: '200px', width: '170px' });\n        this.fontNameList.showClearButton = false;\n        this.fontNameList.appendTo(fontNameValues);\n        this.fontStyleText = new DropDownList({ change: this.fontStyleUpdate, popupHeight: '170px', width: '170px' });\n        this.fontStyleText.appendTo(fontStyleValues);\n        return fontDiv;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.showFontDialog = function (characterFormat) {\n        if (characterFormat) {\n            this.characterFormat = characterFormat;\n        }\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initFontDialog(locale);\n        }\n        this.owner.dialog.header = locale.getConstant('Font');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadFontDialog;\n        this.owner.dialog.close = this.closeFontDialog;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertFontFormat,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-font-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-font-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * Applies character format\n     * @param  {Selection} selection\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    FontDialog.prototype.onCharacterFormat = function (selection, format) {\n        this.owner.owner.editorModule.initHistory('CharacterFormat');\n        if (selection.isEmpty) {\n            if (selection.start.offset === selection.getParagraphLength(selection.start.paragraph)) {\n                // tslint:disable-next-line:max-line-length\n                this.owner.owner.editorModule.applyCharFormatValueInternal(selection, selection.start.paragraph.characterFormat, undefined, format);\n                this.owner.owner.editorModule.reLayout(selection);\n            }\n            this.owner.updateFocus();\n            return;\n        }\n        else {\n            //Iterate and update formating.\n            this.owner.owner.editorModule.setOffsetValue(this.owner.selection);\n            this.owner.owner.editorModule.updateSelectionCharacterFormatting('CharacterFormat', format, false);\n        }\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.enableCheckBoxProperty = function (args) {\n        if (this.strikethroughBox.checked && this.doublestrikethrough.checked) {\n            this.strikethroughBox.checked = false;\n            this.doublestrikethrough.checked = false;\n            if (args.event.currentTarget.id === this.target.id + '_doubleStrikeThrough') {\n                this.doublestrikethrough.checked = true;\n            }\n            else {\n                this.strikethroughBox.checked = true;\n            }\n        }\n        if (this.superscript.checked && this.subscript.checked) {\n            this.subscript.checked = false;\n            this.superscript.checked = false;\n            if (args.event.currentTarget.id === this.target.id + '_subScript') {\n                this.subscript.checked = true;\n            }\n            else {\n                this.superscript.checked = true;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.unWireEventsAndBindings = function () {\n        this.fontNameList.value = '';\n        this.fontSizeText.value = '';\n        this.fontStyleText.value = '';\n        this.strikethroughBox.checked = false;\n        this.doublestrikethrough.checked = false;\n        this.superscript.checked = false;\n        this.subscript.checked = false;\n        this.bold = undefined;\n        this.italic = undefined;\n        this.underline = undefined;\n        this.strikethrough = undefined;\n        this.baselineAlignment = undefined;\n        this.fontColor = undefined;\n        this.fontSize = undefined;\n        this.fontFamily = undefined;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (this.characterFormat) {\n            this.characterFormat.destroy();\n            this.characterFormat = undefined;\n        }\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var m = 0; m < this.target.childNodes.length; m++) {\n                this.target.removeChild(this.target.childNodes[m]);\n                m--;\n            }\n            this.target = undefined;\n        }\n        if (this.fontNameList) {\n            this.fontNameList.destroy();\n        }\n        this.fontNameList = undefined;\n        if (this.fontStyleText) {\n            this.fontStyleText.destroy();\n        }\n        this.fontStyleText = undefined;\n        if (this.fontSizeText) {\n            this.fontSizeText.destroy();\n        }\n        this.fontSizeText = undefined;\n        if (this.colorPicker) {\n            this.colorPicker.destroy();\n        }\n        this.colorPicker = undefined;\n        if (this.underlineDrop) {\n            this.underlineDrop.destroy();\n        }\n        this.underlineDrop = undefined;\n        if (this.strikethroughBox) {\n            this.strikethroughBox.destroy();\n        }\n        this.strikethroughBox = undefined;\n        if (this.doublestrikethrough) {\n            this.doublestrikethrough.destroy();\n        }\n        this.doublestrikethrough = undefined;\n        if (this.superscript) {\n            this.superscript.destroy();\n        }\n        this.superscript = undefined;\n        if (this.subscript) {\n            this.subscript.destroy();\n        }\n        this.subscript = undefined;\n    };\n    return FontDialog;\n}());\nexport { FontDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat, WRowFormat, WCellFormat } from '../format/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { classList } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * The Table properties dialog is used to modify properties of selected table.\n */\nvar TablePropertiesDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TablePropertiesDialog(viewer) {\n        var _this = this;\n        this.hasTableWidth = false;\n        this.hasCellWidth = false;\n        /**\n         * @private\n         */\n        this.isTableBordersAndShadingUpdated = false;\n        /**\n         * @private\n         */\n        this.isCellBordersAndShadingUpdated = false;\n        this.tabObj = undefined;\n        /**\n         * @private\n         */\n        this.isCellOptionsUpdated = false;\n        /**\n         * @private\n         */\n        this.isTableOptionsUpdated = false;\n        this.onBeforeOpen = function () {\n            _this.owner.updateFocus();\n            _this.loadTableProperties();\n        };\n        /**\n         * @private\n         */\n        this.onCloseTablePropertyDialog = function () {\n            _this.unWireEvent.bind(_this);\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.applyTableProperties = function () {\n            var selection = _this.owner.selection;\n            if (!_this.preferCheckBox.checked && !_this.preferCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.tableFormat.preferredWidth) || selection.tableFormat.preferredWidth !== 0) {\n                    _this.tableFormat.preferredWidth = 0;\n                    _this.tableFormat.preferredWidthType = 'Point';\n                }\n            }\n            if (_this.tableFormat.hasValue('tableAlignment') && _this.tableFormat.tableAlignment !== 'Left') {\n                if (isNullOrUndefined(selection.tableFormat.leftIndent) || selection.tableFormat.leftIndent !== 0) {\n                    _this.tableFormat.leftIndent = 0;\n                }\n            }\n            if (!_this.rowHeightCheckBox.checked && !_this.rowHeightCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.rowFormat.height) || selection.rowFormat.height !== 0) {\n                    _this.rowFormat.heightType = 'AtLeast';\n                    _this.rowFormat.height = 0;\n                }\n            }\n            if (!_this.preferredCellWidthCheckBox.checked && !_this.preferredCellWidthCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.cellFormat.preferredWidth) || selection.cellFormat.preferredWidth === 0) {\n                    _this.cellFormat.preferredWidthType = 'Point';\n                    _this.cellFormat.preferredWidth = 0;\n                }\n            }\n            else {\n                if (_this.cellFormat.preferredWidthType === 'Percent') {\n                    if (!_this.tableFormat.hasValue('preferredWidth') && !_this.tableFormat.hasValue('preferredWidthType')\n                        && _this.owner.selection.start.paragraph.associatedCell.ownerTable.tableFormat.preferredWidth === 0) {\n                        // tslint:disable-next-line:max-line-length\n                        var containerWidth = _this.owner.selection.start.paragraph.associatedCell.ownerTable.getOwnerWidth(true);\n                        var tableWidth = _this.owner.selection.start.paragraph.associatedCell.ownerTable.getTableClientWidth(containerWidth);\n                        _this.tableFormat.preferredWidthType = 'Percent';\n                        _this.tableFormat.preferredWidth = tableWidth / HelperMethods.convertPixelToPoint(_this.owner.clientArea.width) * 100;\n                    }\n                }\n            }\n            if (_this.rowHeightValue) {\n                _this.rowFormat.height = _this.rowHeightValue;\n            }\n            _this.owner.owner.editorModule.initComplexHistory('TableProperties');\n            _this.owner.owner.editorModule.onTableFormat(_this.tableFormat);\n            _this.owner.owner.editorModule.onRowFormat(_this.rowFormat);\n            _this.owner.owner.editorModule.onCellFormat(_this.cellFormat);\n            _this.owner.owner.editorHistory.updateComplexHistory();\n            _this.closeTablePropertiesDialog();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.applyTableSubProperties = function () {\n            if (_this.isCellOptionsUpdated) {\n                var cellFormat = _this.owner.owner.cellOptionsDialogModule.cellFormat;\n                _this.owner.owner.cellOptionsDialogModule.applySubCellOptions(cellFormat);\n            }\n            if (_this.isTableOptionsUpdated) {\n                var tableFormat = _this.owner.owner.tableOptionsDialogModule.tableFormat;\n                _this.owner.owner.tableOptionsDialogModule.applySubTableOptions(tableFormat);\n            }\n            _this.isCellOptionsUpdated = false;\n            _this.isTableOptionsUpdated = false;\n        };\n        /**\n         * @private\n         */\n        this.unWireEvent = function () {\n            //Table Format\n            _this.preferCheckBox.change = undefined;\n            _this.tableWidthBox.change = undefined;\n            _this.tableWidthType.change = undefined;\n            _this.leftIndentBox.change = undefined;\n            //Row Format\n            _this.rowHeightCheckBox.change = undefined;\n            _this.rowHeightBox.change = undefined;\n            _this.rowHeightType.change = undefined;\n            _this.repeatHeader.change = undefined;\n            _this.allowRowBreak.change = undefined;\n            //Cell Format\n            _this.preferredCellWidthCheckBox.change = undefined;\n            _this.cellWidthBox.change = undefined;\n            _this.cellWidthType.change = undefined;\n            _this.cellFormat.destroy();\n            _this.rowFormat.destroy();\n            _this.tableFormat.destroy();\n            _this.rowHeightValue = undefined;\n            _this.owner.dialog2.open = _this.owner.selection.hideCaret.bind(_this.owner);\n        };\n        /**\n         * @private\n         */\n        this.closeTablePropertiesDialog = function () {\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeTableCheckBox = function () {\n            var enable = (_this.preferCheckBox.checked || _this.preferCheckBox.indeterminate);\n            _this.tableWidthBox.enabled = enable;\n            _this.tableWidthType.enabled = enable;\n            if (enable) {\n                _this.tableFormat.preferredWidthType = (_this.tableWidthType.value === 'Points') ?\n                    'Point' : _this.tableWidthType.value;\n            }\n            else {\n                _this.tableFormat.preferredWidthType = _this.owner.selection.tableFormat.preferredWidthType;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeTableAlignment = function (event) {\n            _this.updateClassForAlignmentProperties(_this.tableTab);\n            var element = event.target;\n            classList(element, ['e-de-table-alignment-active'], ['e-de-table-properties-alignment']);\n            if (element.classList.contains('e-de-table-left-alignment')) {\n                _this.leftIndentBox.enabled = true;\n            }\n            else {\n                _this.leftIndentBox.enabled = false;\n            }\n            _this.tableFormat.tableAlignment = _this.getTableAlignment();\n        };\n        /**\n         * @private\n         */\n        this.changeTableRowCheckBox = function () {\n            _this.rowHeightType.enabled = _this.rowHeightCheckBox.checked;\n            _this.rowHeightBox.enabled = _this.rowHeightCheckBox.checked;\n            if (_this.rowHeightType.enabled) {\n                _this.rowFormat.heightType = _this.rowHeightType.value;\n            }\n            else {\n                _this.rowFormat.heightType = _this.owner.selection.rowFormat.heightType;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeTableCellCheckBox = function () {\n            _this.cellWidthType.enabled = _this.preferredCellWidthCheckBox.checked;\n            _this.cellWidthBox.enabled = _this.preferredCellWidthCheckBox.checked;\n        };\n        /**\n         * @private\n         */\n        this.changeCellAlignment = function (event) {\n            _this.updateClassForCellAlignment(_this.cellTab);\n            var element = event.target;\n            classList(element, ['e-de-table-alignment-active'], ['e-de-tablecell-alignment']);\n            _this.cellFormat.verticalAlignment = _this.getCellAlignment();\n        };\n        //#endregion\n        /**\n         * @private\n         */\n        this.showTableOptionsDialog = function () {\n            _this.owner.owner.tableOptionsDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        /**\n         * @private\n         */\n        this.showBordersShadingsPropertiesDialog = function () {\n            _this.owner.owner.bordersAndShadingDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        /**\n         * @private\n         */\n        this.showCellOptionsDialog = function () {\n            _this.owner.owner.cellOptionsDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(TablePropertiesDialog.prototype, \"cellFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.cellFormatIn)) {\n                return this.cellFormatIn = new WCellFormat();\n            }\n            return this.cellFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.cellFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TablePropertiesDialog.prototype, \"tableFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.tableFormatIn)) {\n                this.tableFormatIn = new WTableFormat();\n                return this.tableFormatIn;\n            }\n            return this.tableFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.tableFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TablePropertiesDialog.prototype, \"rowFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.rowFormatInternal)) {\n                this.rowFormatInternal = new WRowFormat();\n                return this.rowFormatInternal;\n            }\n            return this.rowFormatInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TablePropertiesDialog.prototype.getModuleName = function () {\n        return 'TablePropertiesDialog';\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTablePropertyDialog = function (localValue) {\n        var id = this.owner.owner.containerId + '_TablePropertiesDialog';\n        this.target = createElement('div', { id: id, className: 'e-de-table-properties-dlg' });\n        this.owner.owner.element.appendChild(this.target);\n        var ejtabContainer = createElement('div', { id: this.target.id + '_TabContainer' });\n        this.target.appendChild(ejtabContainer);\n        this.tableTab = createElement('div', {\n            id: this.target.id + '_TablePropertiesContentDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        this.rowTab = createElement('div', {\n            id: this.target.id + '_RowPropertiesDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        this.cellTab = createElement('div', {\n            id: this.target.id + '_CellPropertiesDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        var separatorLine = createElement('div', { className: 'e-de-table-dialog-separator-line' });\n        // tslint:disable-next-line:max-line-length\n        var ejtab = createElement('div', { id: this.target.id + '_TablePropertiesDialogTab', className: 'e-de-table-ppty-tab' });\n        var headerContainer = createElement('div', { className: 'e-tab-header' });\n        var tableHeader = createElement('div', {\n            id: this.target.id + '_tableHeader', innerHTML: localValue.getConstant('Table')\n        });\n        var rowHeader = createElement('div', {\n            id: this.target.id + '_rowHeader', innerHTML: localValue.getConstant('Row')\n        });\n        var cellHeader = createElement('div', {\n            id: this.target.id + '_cellHeader', innerHTML: localValue.getConstant('Cell')\n        });\n        headerContainer.appendChild(tableHeader);\n        headerContainer.appendChild(rowHeader);\n        headerContainer.appendChild(cellHeader);\n        var contentContainer = createElement('div', { className: 'e-content' });\n        var tableContent = createElement('div', { id: this.target.id + '_tableContent' });\n        var rowContent = createElement('div', { id: this.target.id + '_rowContent' });\n        var cellContent = createElement('div', { id: this.target.id + '_cellContent' });\n        tableContent.appendChild(this.tableTab);\n        rowContent.appendChild(this.rowTab);\n        cellContent.appendChild(this.cellTab);\n        contentContainer.appendChild(tableContent);\n        contentContainer.appendChild(rowContent);\n        contentContainer.appendChild(cellContent);\n        ejtab.appendChild(headerContainer);\n        ejtab.appendChild(contentContainer);\n        ejtabContainer.appendChild(ejtab);\n        this.initTableProperties(this.tableTab, localValue);\n        this.initTableRowProperties(this.rowTab, localValue);\n        this.initTableCellProperties(this.cellTab, localValue);\n        this.tabObj = new Tab({}, ejtab);\n        this.target.appendChild(separatorLine);\n        var alignMentButtons = this.tableTab.getElementsByClassName(this.tableTab.id + 'e-de-table-alignment');\n        for (var i = 0; i < alignMentButtons.length; i++) {\n            alignMentButtons[i].addEventListener('click', this.changeTableAlignment);\n        }\n        var cellAlignment = this.cellTab.getElementsByClassName(this.cellTab.id + 'e-de-table-cell-alignment');\n        for (var i = 0; i < cellAlignment.length; i++) {\n            cellAlignment[i].addEventListener('click', this.changeCellAlignment);\n        }\n        var tableTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        var tableTabHeaderItem = tableTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        tableTabHeaderItem.classList.add('e-de-table-ppty-dlg-table-header');\n        var rowTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[1];\n        var rowTabHeaderItem = rowTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        rowTabHeaderItem.classList.add('e-de-table-ppty-dlg-row-header');\n        var cellTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[2];\n        var cellTabHeaderItem = cellTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        cellTabHeaderItem.classList.add('e-de-table-ppty-dlg-cell-header');\n        this.tabObj.element.getElementsByClassName('e-indicator')[0].style.right = '155px';\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTablePropertyDialog(localValue);\n        }\n        if (this.owner.selection.caret.style.display !== 'none') {\n            this.owner.selection.caret.style.display = 'none';\n        }\n        this.owner.dialog2.header = localValue.getConstant('Table Properties');\n        this.owner.dialog2.position = { X: 'center', Y: 'center' };\n        this.owner.dialog2.width = 'auto';\n        this.owner.dialog2.height = 'auto';\n        this.owner.dialog2.content = this.target;\n        this.owner.dialog2.beforeOpen = this.onBeforeOpen;\n        this.owner.dialog2.close = this.onCloseTablePropertyDialog;\n        this.owner.dialog2.open = this.wireEvent.bind(this);\n        this.owner.dialog2.buttons = [{\n                click: this.applyTableProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-table-ppty-okay', isPrimary: true }\n            },\n            {\n                click: this.closeTablePropertiesDialog,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-table-ppty-cancel' }\n            }];\n        //this.tabObj.select(0);\n        this.owner.dialog2.dataBind();\n        this.owner.dialog2.show();\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.calculateGridValue = function (table) {\n        table.calculateGrid();\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.owner.selection.owner.isLayoutEnabled = true;\n        this.owner.layout.reLayoutTable(table);\n        this.owner.owner.editorModule.reLayout(this.owner.selection);\n        this.owner.owner.editorModule.updateSelectionTextPosition(true);\n        var history = this.owner.owner.editorHistory;\n        if (history && history.currentBaseHistoryInfo) {\n            if (history.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                history.currentBaseHistoryInfo.updateSelection();\n            }\n            history.updateHistory();\n        }\n        this.owner.owner.editorModule.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.loadTableProperties = function () {\n        this.setTableProperties();\n        this.setTableRowProperties();\n        this.setTableCellProperties();\n        if (!this.owner.owner.bordersAndShadingDialogModule) {\n            this.bordersAndShadingButton.disabled = true;\n        }\n        else {\n            this.bordersAndShadingButton.disabled = false;\n        }\n        // if (!this.owner.owner.tableOptionsDialogModule) {\n        //     this.tableOptionButton.disabled = true;\n        // } else {\n        this.tableOptionButton.disabled = false;\n        // }\n        // if (!this.owner.owner.cellOptionsDialogModule) {\n        //     this.cellOptionButton.disabled = true;\n        // } else {\n        this.cellOptionButton.disabled = false;\n        // }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.wireEvent = function () {\n        this.owner.selection.hideCaret();\n        //Table Format\n        this.preferCheckBox.change = this.changeTableCheckBox.bind(this);\n        this.tableWidthBox.change = this.onTableWidthChange.bind(this);\n        this.tableWidthType.change = this.onTableWidthTypeChange.bind(this);\n        this.leftIndentBox.change = this.onLeftIndentChange.bind(this);\n        //Row Format\n        this.rowHeightCheckBox.change = this.changeTableRowCheckBox.bind(this);\n        this.rowHeightBox.change = this.onRowHeightChange.bind(this);\n        this.rowHeightType.change = this.onRowHeightTypeChange.bind(this);\n        this.allowRowBreak.change = this.onAllowBreakAcrossPage.bind(this);\n        this.repeatHeader.change = this.onRepeatHeader.bind(this);\n        //Cell Format\n        this.preferredCellWidthCheckBox.change = this.changeTableCellCheckBox.bind(this);\n        this.cellWidthBox.change = this.onCellWidthChange.bind(this);\n        this.cellWidthType.change = this.onCellWidthTypeChange.bind(this);\n    };\n    //#region Table Format\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    TablePropertiesDialog.prototype.initTableProperties = function (element, localValue) {\n        var container = createElement('div', { id: element.id + '_table_TabContainer' });\n        var sizeHeader = createElement('div', {\n            id: container.id + '_sizeLabel', innerHTML: localValue.getConstant('Size'),\n            styles: 'width:100%;margin:0px;padding-top: 20px;padding-bottom: 0px;', className: 'e-de-table-dialog-options-label'\n        });\n        var parentContainer = createElement('div', { styles: 'display: inline-flex;' });\n        var childContainer1 = createElement('div', {\n            styles: 'float: left;',\n            className: 'e-de-table-container-div'\n        });\n        var childContainer2 = createElement('div', {\n            className: 'e-de-table-ppty-dlg-preferred-width-div'\n        });\n        var child1 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-measure-div'\n        });\n        var child2 = createElement('div', {\n            styles: 'display: inline;position: absolute;',\n            className: 'e-de-table-ppty-dlg-measure-drop-down-div'\n        });\n        var childContainer3 = createElement('div');\n        var preferCheckBox = createElement('input', {\n            id: element.id + '_Prefer_Width_CheckBox', attrs: { 'type': 'checkbox' }\n        });\n        this.preferredWidth = createElement('input', { id: element.id + 'preferred_Width' });\n        var controlDiv = createElement('div');\n        var tableWidthType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('Points') +\n                '</option><option>' + localValue.getConstant('Percent') + '</option>', id: element.id + '_width_dropdown'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Measure in'), styles: 'width: 60px;font-size: 11px; font-weight: normal;'\n        });\n        var alignmentHeader = createElement('div', {\n            innerHTML: localValue.getConstant('Alignment'), className: 'e-de-table-dialog-options-label',\n            styles: 'width: 100%;margin: 0px;padding-bottom: 15px'\n        });\n        var alignmentContainer = createElement('div', { styles: 'height:70px;' });\n        var classDivName = element.id + 'e-de-table-alignment';\n        var leftAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.left = createElement('div', {\n            className: 'e-icons e-de-table-properties-alignment e-de-table-left-alignment ' + classDivName,\n            id: element.id + '_left_alignment', styles: 'width:54px;height:54px;margin:2px'\n        });\n        leftAlignDiv.appendChild(this.left);\n        var centerAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.center = createElement('div', {\n            className: 'e-icons e-de-table-properties-alignment  e-de-table-center-alignment ' + classDivName,\n            id: element.id + '_center_alignment', styles: 'width:54px;height:54px;margin:2px'\n        });\n        centerAlignDiv.appendChild(this.center);\n        this.right = createElement('div', {\n            styles: 'width:54px;height:54px;margin:2px', id: element.id + '_right_alignment',\n            className: 'e-icons e-de-table-properties-alignment  e-de-table-right-alignment ' + classDivName\n        });\n        var rightAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        rightAlignDiv.appendChild(this.right);\n        var leftlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Left'), className: 'e-de-table-dia-align-label'\n        });\n        var centerlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Center'), className: 'e-de-table-dia-align-label'\n        });\n        var rightlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Right'), className: 'e-de-table-dia-align-label'\n        });\n        var leftIndenetContainer = createElement('div', {\n            className: 'e-de-table-ppty-dlg-left-indent-container'\n        });\n        var leftIndentLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Indent from left'),\n            styles: 'font-weight: normal;font-size: 11px;float:right;margin-right:121px;'\n        });\n        var leftIndentBox = createElement('div', {\n            styles: 'margin-top: 27px;'\n        });\n        this.leftIndent = createElement('input', { id: element.id + '_left_indent' });\n        var tableOptionContiner = createElement('div', {\n            className: 'e-de-tbl-dlg-border-btn'\n        });\n        this.bordersAndShadingButton = createElement('button', {\n            innerHTML: localValue.getConstant('Borders and Shading'),\n            id: element.id + '_borders_and_shadings', className: 'e-control e-btn e-flat e-de-ok-button'\n        });\n        this.tableOptionButton = createElement('button', {\n            className: 'e-control e-btn e-flat', innerHTML: localValue.getConstant('Options'),\n            id: element.id + '_table_cellmargin'\n        });\n        this.tableOptionButton.addEventListener('click', this.showTableOptionsDialog);\n        this.bordersAndShadingButton.addEventListener('click', this.showBordersShadingsPropertiesDialog);\n        tableOptionContiner.appendChild(this.bordersAndShadingButton);\n        tableOptionContiner.appendChild(this.tableOptionButton);\n        leftIndenetContainer.appendChild(leftIndentLabel);\n        leftIndentBox.appendChild(this.leftIndent);\n        leftIndenetContainer.appendChild(leftIndentBox);\n        alignmentContainer.appendChild(leftAlignDiv);\n        alignmentContainer.appendChild(centerAlignDiv);\n        alignmentContainer.appendChild(rightAlignDiv);\n        leftAlignDiv.appendChild(leftlabel);\n        centerAlignDiv.appendChild(centerlabel);\n        rightAlignDiv.appendChild(rightlabel);\n        alignmentContainer.appendChild(leftIndenetContainer);\n        container.appendChild(sizeHeader);\n        element.appendChild(container);\n        childContainer1.appendChild(preferCheckBox);\n        parentContainer.appendChild(childContainer1);\n        childContainer2.appendChild(this.preferredWidth);\n        parentContainer.appendChild(childContainer2);\n        controlDiv.appendChild(tableWidthType);\n        child1.appendChild(labeltext);\n        child2.appendChild(controlDiv);\n        childContainer3.appendChild(child1);\n        childContainer3.appendChild(child2);\n        parentContainer.appendChild(childContainer3);\n        element.appendChild(parentContainer);\n        element.appendChild(alignmentHeader);\n        element.appendChild(alignmentContainer);\n        element.appendChild(tableOptionContiner);\n        this.tableWidthBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.tableWidthBox.appendTo(this.preferredWidth);\n        this.leftIndentBox = new NumericTextBox({\n            value: 0, decimals: 2, min: -1584, max: 1584, width: 140, enablePersistence: false\n        });\n        this.leftIndentBox.appendTo(this.leftIndent);\n        this.preferCheckBox = new CheckBox({\n            label: localValue.getConstant('Preferred Width')\n        });\n        this.preferCheckBox.appendTo(preferCheckBox);\n        this.tableWidthType = new DropDownList({ width: '120px' });\n        this.tableWidthType.appendTo(tableWidthType);\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onTableWidthChange = function () {\n        this.tableFormat.preferredWidth = this.tableWidthBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onTableWidthTypeChange = function () {\n        var value;\n        var table = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        var width = HelperMethods.convertPixelToPoint(this.owner.clientArea.width);\n        if (this.tableWidthType.text === 'Percent' && this.owner.selection.tableFormat.preferredWidthType !== 'Percent') {\n            value = this.tableWidthBox.value / width * 100;\n            this.formatNumericTextBox(this.tableWidthBox, 'Percent', value);\n        }\n        else if (this.tableWidthType.text === 'Points' && this.owner.selection.tableFormat.preferredWidthType !== 'Point') {\n            value = width / 100 * this.tableWidthBox.value;\n            this.formatNumericTextBox(this.tableWidthBox, 'Point', value);\n        }\n        else {\n            if (this.tableWidthBox.format === '#\\'\\%\\'') {\n                if (this.tableWidthType.text === 'Points') {\n                    value = width / 100 * this.tableWidthBox.value;\n                }\n                else {\n                    value = this.tableWidthBox.value;\n                }\n            }\n            else {\n                if (this.tableWidthType.text === 'Percent') {\n                    value = this.tableWidthBox.value / width * 100;\n                }\n                else {\n                    value = this.tableWidthBox.value;\n                }\n            }\n            // tslint:disable-next-line:max-line-length\n            this.formatNumericTextBox(this.tableWidthBox, (this.tableWidthType.text === 'Points') ? 'Point' : this.tableWidthType.text, value);\n        }\n        this.tableFormat.preferredWidthType = (this.tableWidthType.text === 'Points') ? 'Point' : this.tableWidthType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onLeftIndentChange = function () {\n        this.tableFormat.leftIndent = this.leftIndentBox.value;\n    };\n    TablePropertiesDialog.prototype.setTableProperties = function () {\n        //instance of Table Property values\n        var tableFormat = this.owner.selection.tableFormat;\n        var tableHasWidth = tableFormat.preferredWidth > 0;\n        var preferredWidth = tableFormat.preferredWidth;\n        if (isNullOrUndefined(tableFormat.preferredWidth)) {\n            this.preferCheckBox.indeterminate = true;\n            var startTable = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n            var table = startTable.combineWidget(this.owner);\n            preferredWidth = table.tableFormat.preferredWidth;\n        }\n        else {\n            this.preferCheckBox.checked = tableHasWidth;\n        }\n        this.tableWidthBox.enabled = tableHasWidth;\n        this.tableWidthType.enabled = tableHasWidth;\n        this.formatNumericTextBox(this.tableWidthBox, tableFormat.preferredWidthType, preferredWidth);\n        if (tableFormat.preferredWidthType === 'Auto' || tableFormat.preferredWidthType === 'Point') {\n            this.tableWidthType.index = 0;\n        }\n        else {\n            this.tableWidthType.index = 1;\n        }\n        this.leftIndentBox.value = tableFormat.leftIndent;\n        this.leftIndentBox.enabled = tableFormat.tableAlignment === 'Left';\n        classList(this.left, [], ['e-de-table-alignment-active']);\n        classList(this.right, [], ['e-de-table-alignment-active']);\n        classList(this.center, [], ['e-de-table-alignment-active']);\n        if (tableFormat.tableAlignment === 'Left') {\n            this.left.classList.add('e-de-table-alignment-active');\n        }\n        else if (tableFormat.tableAlignment === 'Center') {\n            this.center.classList.add('e-de-table-alignment-active');\n        }\n        else if (tableFormat.tableAlignment === 'Right') {\n            this.right.classList.add('e-de-table-alignment-active');\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.getTableAlignment = function () {\n        var id = this.tableTab.id;\n        var groupButtons = this.tableTab.getElementsByClassName(id + 'e-de-table-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                if (j === 0) {\n                    return 'Left';\n                }\n                else if (j === 1) {\n                    return 'Center';\n                }\n                else {\n                    return 'Right';\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.updateClassForAlignmentProperties = function (element) {\n        var id = element.id;\n        var groupButtons = element.getElementsByClassName(id + 'e-de-table-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                classList(groupButton, ['e-de-table-properties-alignment'], ['e-de-table-alignment-active']);\n            }\n        }\n    };\n    //#endregion\n    //#region Row Format\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTableRowProperties = function (element, localValue) {\n        var rowDiv = createElement('div', { styles: 'width: 100%;' });\n        var sizeLabeldiv = createElement('div', {\n            innerHTML: localValue.getConstant('Size'),\n            styles: 'width: 100%;padding-top: 20px;padding-bottom: 10px;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        var parentDiv = createElement('div', { styles: 'display: inline;width: 100%;' });\n        var childDiv1 = createElement('div', {\n            styles: 'display: inline;float: left;',\n            className: 'e-de-table-header-div'\n        });\n        var rowHeightCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_height_CheckBox'\n        });\n        var childdiv2 = createElement('div', {\n            styles: 'display: inline-block;',\n            className: 'e-de-row-ht-top'\n        });\n        this.rowHeight = createElement('input', {\n            attrs: { 'type': 'text' }, 'id': element.id + '_table_row_height'\n        });\n        var child2 = createElement('div', {\n            styles: 'float: right;display: inline;width: auto;margin-top: 5px;'\n        });\n        var child3 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-row-height-label'\n        });\n        var child4 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-subheader-div'\n        });\n        var controlDiv = createElement('div');\n        var rowHeightType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('At least')\n                + '</option><option>' + localValue.getConstant('Exactly') + '</option>',\n            id: element.id + '_height_type'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Row height is'), styles: 'font-size: 11px;font-weight: normal;width: 75px;'\n        });\n        rowDiv.appendChild(sizeLabeldiv);\n        element.appendChild(rowDiv);\n        childDiv1.appendChild(rowHeightCheckBox);\n        parentDiv.appendChild(childDiv1);\n        childdiv2.appendChild(this.rowHeight);\n        parentDiv.appendChild(childdiv2);\n        controlDiv.appendChild(rowHeightType);\n        child3.appendChild(labeltext);\n        child4.appendChild(controlDiv);\n        child2.appendChild(child3);\n        child2.appendChild(child4);\n        parentDiv.appendChild(child2);\n        element.appendChild(parentDiv);\n        var alignmentDiv = createElement('div', {\n            innerHTML: localValue.getConstant('Options'), styles: 'width: 100%;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        // tslint:disable-next-line:max-line-length\n        var allowRowContainer = createElement('div', { className: 'e-de-table-ppty-options-break' });\n        var repeatHeaderContaniner = createElement('div', { className: 'e-de-table-ppty-options-header-row' });\n        var allowRowBreak = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_allow_row_break'\n        });\n        var repeatHeader = createElement('input', {\n            attrs: { 'type': 'checkbox' }, 'id': element.id + '_repeat_header'\n        });\n        allowRowContainer.appendChild(allowRowBreak);\n        repeatHeaderContaniner.appendChild(repeatHeader);\n        element.appendChild(alignmentDiv);\n        element.appendChild(allowRowContainer);\n        element.appendChild(repeatHeaderContaniner);\n        this.rowHeightBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.rowHeightBox.appendTo(this.rowHeight);\n        this.rowHeightCheckBox = new CheckBox({\n            label: localValue.getConstant('Specify height')\n        });\n        this.rowHeightCheckBox.appendTo(rowHeightCheckBox);\n        this.rowHeightType = new DropDownList({ width: '120px' });\n        this.rowHeightType.appendTo(rowHeightType);\n        this.allowRowBreak = new CheckBox({\n            label: localValue.getConstant('Allow row to break across pages')\n        });\n        this.allowRowBreak.appendTo(allowRowBreak);\n        this.repeatHeader = new CheckBox({\n            label: localValue.getConstant('Repeat as header row at the top of each page')\n        });\n        this.repeatHeader.appendTo(repeatHeader);\n    };\n    TablePropertiesDialog.prototype.setTableRowProperties = function () {\n        var rowFormat = this.owner.selection.rowFormat;\n        var enableRowHeight = (rowFormat.height > 0 || rowFormat.heightType === 'Exactly');\n        //instance of table row values\n        if (enableRowHeight) {\n            this.rowHeightCheckBox.checked = true;\n        }\n        else {\n            if (rowFormat.heightType === undefined) {\n                this.rowHeightCheckBox.indeterminate = true;\n                enableRowHeight = true;\n            }\n            else {\n                this.rowHeightCheckBox.checked = false;\n            }\n        }\n        this.rowHeightBox.enabled = enableRowHeight;\n        this.rowHeightType.enabled = enableRowHeight;\n        // let enabledHeader: boolean = this.enableRepeatHeader() ? false : true;\n        var enabledHeader = true;\n        if (isNullOrUndefined(this.owner.selection.rowFormat.isHeader)) {\n            this.repeatHeader.indeterminate = true;\n            this.repeatHeader.disabled = true;\n        }\n        else if (this.owner.selection.rowFormat.isHeader) {\n            this.repeatHeader.checked = !enabledHeader;\n            this.repeatHeader.indeterminate = enabledHeader;\n            this.repeatHeader.disabled = enabledHeader;\n        }\n        else {\n            this.repeatHeader.checked = false;\n            this.repeatHeader.indeterminate = false;\n            this.repeatHeader.disabled = enabledHeader;\n        }\n        if (isNullOrUndefined(rowFormat.allowBreakAcrossPages)) {\n            this.allowRowBreak.indeterminate = true;\n        }\n        else {\n            this.allowRowBreak.checked = rowFormat.allowBreakAcrossPages;\n        }\n        this.rowHeightBox.value = rowFormat.height;\n        if (rowFormat.heightType === 'Auto' || rowFormat.heightType === 'AtLeast') {\n            this.rowHeightType.index = 0;\n        }\n        else {\n            this.rowHeightType.index = 1;\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRowHeightChange = function () {\n        this.rowHeightValue = this.rowHeightBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRowHeightTypeChange = function () {\n        this.rowFormat.heightType = this.rowHeightType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onAllowBreakAcrossPage = function () {\n        this.rowFormat.allowBreakAcrossPages = this.allowRowBreak.checked;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRepeatHeader = function () {\n        this.rowFormat.isHeader = this.repeatHeader.checked;\n    };\n    /**\n     * @private\n     */\n    // public enableRepeatHeader(): boolean {\n    //     let isFirstRow: number = 0;\n    //     for (let i: number = 0; i < this.owner.selection.selectionRanges.length; i++) {\n    //         let range: SelectionRange = this.owner.selection.selectionRanges.getRange(i);\n    //         let table: WTable = range.start.paragraph.associatedCell.ownerTable;\n    //         if (table.childNodes.indexOf(range.start.paragraph.associatedCell.ownerRow) === 0 ||\n    //             table.childNodes.indexOf(range.start.paragraph.associatedCell.ownerRow) === 0) {\n    //             isFirstRow++;\n    //         }\n    //     }\n    //     return isFirstRow === this.owner.selection.selectionRanges.length;\n    // }\n    //#endregion\n    //#region Cell Format\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTableCellProperties = function (element, localValue) {\n        var sizeDiv = createElement('div', { styles: 'width: 100%;' });\n        var div = createElement('div', {\n            innerHTML: localValue.getConstant('Size'), className: 'e-de-table-dialog-options-label',\n            styles: 'width: 100%;padding-top: 20px;padding-bottom: 10px;',\n        });\n        var parentdiv = createElement('div', { styles: 'display: inline;width: 100%;' });\n        var childdiv1 = createElement('div', {\n            styles: 'display: inline;float: left;',\n            className: 'e-de-table-cell-header-div'\n        });\n        var preferredCellWidthCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_Prefer_Width_CheckBox_cell'\n        });\n        var childdiv2 = createElement('div', {\n            styles: 'display: inline-block;',\n            className: 'e-de-cell-width-top'\n        });\n        this.preferredCellWidth = createElement('input', {\n            id: element.id + 'tablecell_Width_textBox', attrs: { 'type': 'text' }\n        });\n        var child2 = createElement('div', {\n            styles: 'float: right;display: inline;width: auto;margin-top: 5px;'\n        });\n        var child3 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-cell-tab-measure-label'\n        });\n        var child4 = createElement('div', {\n            styles: 'display: inline;float: right;', className: 'e-de-table-cell-subheader-div'\n        });\n        var controlDiv = createElement('div');\n        var cellWidthType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('Points') + '</option><option>' +\n                localValue.getConstant('Percent') + '</option>', 'id': element.id + '_measure_type_cell'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Measure in'),\n            styles: 'font-size: 11px;font-weight: normal;'\n        });\n        sizeDiv.appendChild(div);\n        element.appendChild(sizeDiv);\n        childdiv1.appendChild(preferredCellWidthCheckBox);\n        parentdiv.appendChild(childdiv1);\n        childdiv2.appendChild(this.preferredCellWidth);\n        parentdiv.appendChild(childdiv2);\n        controlDiv.appendChild(cellWidthType);\n        child3.appendChild(labeltext);\n        child4.appendChild(controlDiv);\n        child2.appendChild(child3);\n        child2.appendChild(child4);\n        parentdiv.appendChild(child2);\n        element.appendChild(parentdiv);\n        var alignmentDiv = createElement('div', {\n            innerHTML: localValue.getConstant('Vertical alignment'),\n            styles: 'width: 100%;margin: 0px;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        var classDivName = element.id + 'e-de-table-cell-alignment';\n        var divAlignment = createElement('div', {\n            styles: 'width: 100%;height: 100px;'\n        });\n        var divStyle = 'width:54px;height:54px;margin:2px;border-style:solid;border-width:1px';\n        var topAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellTopAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_top-alignment',\n            className: 'e-icons e-de-tablecell-alignment  e-de-tablecell-top-alignment ' + classDivName\n        });\n        topAlignDiv.appendChild(this.cellTopAlign);\n        var centerAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellCenterAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_center-alignment',\n            className: 'e-icons e-de-tablecell-alignment  e-de-tablecell-center-alignment ' + classDivName\n        });\n        centerAlignDiv.appendChild(this.cellCenterAlign);\n        var bottomAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellBottomAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_bottom-alignment',\n            className: 'e-icons e-de-tablecell-alignment e-de-tablecell-bottom-alignment  ' + classDivName\n        });\n        bottomAlignDiv.appendChild(this.cellBottomAlign);\n        var topLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Top'), className: 'e-de-table-dia-align-label'\n        });\n        var centerLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Center'), className: 'e-de-table-dia-align-label'\n        });\n        var bottomLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Bottom'), className: 'e-de-table-dia-align-label'\n        });\n        this.cellOptionButton = createElement('button', {\n            innerHTML: localValue.getConstant('Options'), id: element.id + '_table_cellmargin',\n            className: 'e-de-tbl-dlg-op-btn e-control e-btn e-flat e-de-cell-options',\n        });\n        divAlignment.appendChild(topAlignDiv);\n        divAlignment.appendChild(centerAlignDiv);\n        divAlignment.appendChild(bottomAlignDiv);\n        topAlignDiv.appendChild(topLabel);\n        centerAlignDiv.appendChild(centerLabel);\n        bottomAlignDiv.appendChild(bottomLabel);\n        element.appendChild(alignmentDiv);\n        element.appendChild(divAlignment);\n        element.appendChild(this.cellOptionButton);\n        this.cellOptionButton.addEventListener('click', this.showCellOptionsDialog);\n        this.cellWidthBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.cellWidthBox.appendTo(this.preferredCellWidth);\n        this.preferredCellWidthCheckBox = new CheckBox({ label: localValue.getConstant('Preferred Width') });\n        this.preferredCellWidthCheckBox.appendTo(preferredCellWidthCheckBox);\n        this.cellWidthType = new DropDownList({ width: '120px' });\n        this.cellWidthType.appendTo(cellWidthType);\n    };\n    TablePropertiesDialog.prototype.setTableCellProperties = function () {\n        var cellFormat = this.owner.selection.cellFormat;\n        //instance of table cell Values\n        this.hasCellWidth = cellFormat.preferredWidth > 0;\n        var preferredWidth = cellFormat.preferredWidth;\n        if (isNullOrUndefined(cellFormat.preferredWidth)) {\n            this.preferredCellWidthCheckBox.indeterminate = true;\n            preferredWidth = this.owner.selection.start.paragraph.associatedCell.cellFormat.preferredWidth;\n        }\n        else {\n            this.preferredCellWidthCheckBox.checked = this.hasCellWidth;\n        }\n        this.cellWidthBox.enabled = this.hasCellWidth;\n        this.cellWidthType.enabled = this.hasCellWidth;\n        if (cellFormat.preferredWidthType === 'Auto' || cellFormat.preferredWidthType === 'Point') {\n            this.cellWidthType.index = 0;\n        }\n        else {\n            this.cellWidthType.index = 1;\n        }\n        this.formatNumericTextBox(this.cellWidthBox, cellFormat.preferredWidthType, preferredWidth);\n        classList(this.cellTopAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        classList(this.cellCenterAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        classList(this.cellBottomAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        if (cellFormat.verticalAlignment === 'Top') {\n            this.cellTopAlign.classList.add('e-de-table-alignment-active');\n        }\n        else if (cellFormat.verticalAlignment === 'Center') {\n            this.cellCenterAlign.classList.add('e-de-table-alignment-active');\n        }\n        else if (cellFormat.verticalAlignment === 'Bottom') {\n            this.cellBottomAlign.classList.add('e-de-table-alignment-active');\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.updateClassForCellAlignment = function (element) {\n        var cellAlignments = element.getElementsByClassName(element.id + 'e-de-table-cell-alignment');\n        for (var j = 0; j < cellAlignments.length; j++) {\n            var cellAlignment = cellAlignments[j];\n            if (cellAlignment.classList.contains('e-de-table-alignment-active')) {\n                classList(cellAlignment, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.formatNumericTextBox = function (textBox, format, value) {\n        if (format === 'Auto' || format === 'Point') {\n            textBox.format = 'n2';\n        }\n        else {\n            textBox.format = '#\\'\\%\\'';\n        }\n        textBox.step = 1;\n        textBox.decimals = 2;\n        textBox.value = value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.getCellAlignment = function () {\n        var id = this.cellTab.id;\n        var groupButtons = this.cellTab.getElementsByClassName(id + 'e-de-table-cell-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                if (j === 0) {\n                    return 'Top';\n                }\n                else if (j === 1) {\n                    return 'Center';\n                }\n                else {\n                    return 'Bottom';\n                }\n            }\n        }\n        return this.owner.selection.cellFormat.verticalAlignment;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onCellWidthChange = function () {\n        this.cellFormat.preferredWidth = this.cellWidthBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onCellWidthTypeChange = function () {\n        var value;\n        var table = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        var containerWidth = table.getOwnerWidth(true);\n        var tableWidth = table.getTableClientWidth(containerWidth);\n        if (this.cellWidthType.text === 'Percent' && this.owner.selection.cellFormat.preferredWidthType !== 'Percent') {\n            value = this.cellWidthBox.value / tableWidth * 100;\n            this.formatNumericTextBox(this.cellWidthBox, 'Percent', value);\n        }\n        else if (this.cellWidthType.text === 'Points' && this.owner.selection.cellFormat.preferredWidthType !== 'Point') {\n            value = tableWidth / 100 * this.cellWidthBox.value;\n            this.formatNumericTextBox(this.cellWidthBox, 'Point', value);\n        }\n        else {\n            if (this.cellWidthBox.format === '#\\'\\%\\'') {\n                if (this.cellWidthType.text === 'Points') {\n                    value = tableWidth / 100 * this.cellWidthBox.value;\n                }\n                else {\n                    value = this.cellWidthBox.value;\n                }\n            }\n            else {\n                if (this.cellWidthType.text === 'Percent') {\n                    value = this.cellWidthBox.value / tableWidth * 100;\n                }\n                else {\n                    value = this.cellWidthBox.value;\n                }\n            }\n            // tslint:disable-next-line:max-line-length\n            this.formatNumericTextBox(this.cellWidthBox, (this.cellWidthType.text === 'Points') ? 'Point' : this.cellWidthType.text, value);\n        }\n        this.cellFormat.preferredWidthType = (this.cellWidthType.text === 'Points') ? 'Point' : this.cellWidthType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var s = 0; s < this.target.childNodes.length; s++) {\n                this.target.removeChild(this.target.childNodes[s]);\n                s--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.cellAlignment = undefined;\n        this.tableAlignment = undefined;\n        this.owner = undefined;\n        this.preferCheckBox = undefined;\n        this.tableWidthType = undefined;\n        this.preferredWidth = undefined;\n        this.rowHeightType = undefined;\n        this.rowHeightCheckBox = undefined;\n        this.rowHeight = undefined;\n        this.cellWidthType = undefined;\n        this.preferredCellWidthCheckBox = undefined;\n        this.preferredCellWidth = undefined;\n        this.tableTab = undefined;\n        this.rowTab = undefined;\n        this.cellTab = undefined;\n        this.left = undefined;\n        this.center = undefined;\n        this.right = undefined;\n        this.leftIndent = undefined;\n        this.allowRowBreak = undefined;\n        this.repeatHeader = undefined;\n        this.cellTopAlign = undefined;\n        this.cellCenterAlign = undefined;\n        this.cellBottomAlign = undefined;\n        this.tableFormat.destroy();\n        this.cellFormat.destroy();\n        this.tableFormat = undefined;\n        this.cellFormat = undefined;\n    };\n    return TablePropertiesDialog;\n}());\nexport { TablePropertiesDialog };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat, WBorder, WBorders, WShading, WCellFormat } from '../format/index';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\n/**\n * The Borders and Shading dialog is used to modify borders and shading options for selected table or cells.\n */\nvar BordersAndShadingDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BordersAndShadingDialog(viewer) {\n        var _this = this;\n        this.cellFormat = new WCellFormat();\n        this.tableFormat = new WTableFormat();\n        this.applyBordersShadingsProperties = function () {\n            var tablePropertiesDialog = _this.owner.owner.tablePropertiesDialogModule;\n            var selectedCell = _this.owner.selection.start.paragraph.associatedCell;\n            //Need to bind the properties with current cell and current table formats.\n            var borders = undefined;\n            if (_this.checkClassName(_this.previewDivTopTop) || _this.checkClassName(_this.previewDivTopBottom)\n                || _this.checkClassName(_this.previewDivTopCenter) || _this.checkClassName(_this.previewDivBottomcenter)\n                || _this.checkClassName(_this.previewDivBottomLeft) || _this.checkClassName(_this.previewDivBottomRight)\n                || _this.checkClassName(_this.previewDivDiagonalRight) || _this.checkClassName(_this.previewDivLeftDiagonal)) {\n                borders = new WBorders();\n                if (_this.checkClassName(_this.previewDivTopTop)) {\n                    borders.top = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivTopBottom)) {\n                    borders.bottom = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomLeft)) {\n                    borders.left = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomRight)) {\n                    borders.right = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivTopCenter)) {\n                    borders.horizontal = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomcenter)) {\n                    borders.vertical = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivLeftDiagonal)) {\n                    borders.diagonalDown = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivDiagonalRight)) {\n                    borders.diagonalUp = _this.getBorder();\n                }\n            }\n            var shading = new WShading();\n            var editorModule = _this.owner.owner.editorModule;\n            shading.backgroundColor = _this.shadingColorPicker.value;\n            if (_this.ulelementShading.index === 0) {\n                _this.applyTo = 0;\n                if (tablePropertiesDialog) {\n                    tablePropertiesDialog.isCellBordersAndShadingUpdated = true;\n                }\n                _this.cellFormat.borders = new WBorders();\n                if (!isNullOrUndefined(borders)) {\n                    editorModule.applyBordersInternal(_this.cellFormat.borders, borders);\n                }\n                else if (_this.noneDiv.classList.contains('e-de-table-border-inside-setting-click')) {\n                    editorModule.applyBordersInternal(_this.cellFormat.borders, new WBorders());\n                }\n                // Once option has been added for texture and foreground, need to handle this similar to Shading Fill.\n                if (!isNullOrUndefined(selectedCell.cellFormat.shading)) {\n                    shading.foregroundColor = selectedCell.cellFormat.shading.foregroundColor;\n                    shading.textureStyle = selectedCell.cellFormat.shading.textureStyle;\n                }\n                _this.cellFormat.shading = new WShading();\n                editorModule.applyShading(_this.cellFormat.shading, shading);\n            }\n            else {\n                if (tablePropertiesDialog) {\n                    tablePropertiesDialog.isTableBordersAndShadingUpdated = true;\n                }\n                _this.applyTo = 1;\n                var currentTableFormat = _this.owner.owner.selection.tableFormat.table.tableFormat;\n                _this.tableFormat.copyFormat(currentTableFormat);\n                _this.tableFormat.borders = new WBorders();\n                if (!isNullOrUndefined(borders)) {\n                    editorModule.applyBordersInternal(_this.tableFormat.borders, borders);\n                }\n                else if (_this.noneDiv.classList.contains('e-de-table-border-inside-setting-click')) {\n                    editorModule.applyBordersInternal(_this.tableFormat.borders, new WBorders());\n                }\n                // Once option has been added for texture and foreground, need to handle this similar to Shading Fill.\n                if (!isNullOrUndefined(currentTableFormat.shading)) {\n                    shading.foregroundColor = currentTableFormat.shading.foregroundColor;\n                    shading.textureStyle = currentTableFormat.shading.textureStyle;\n                }\n                _this.tableFormat.shading = new WShading();\n                editorModule.applyShading(_this.tableFormat.shading, shading);\n            }\n            _this.applyFormat();\n            _this.closeDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeDialog = function () {\n            _this.owner.dialog.hide();\n            _this.closeBordersShadingsDialog();\n        };\n        this.closeBordersShadingsDialog = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        this.handleSettingCheckBoxAction = function (event) {\n            var targetId = event.target.id;\n            var tableBorderDialogId = _this.target.id;\n            var targetDiv;\n            if (targetId === tableBorderDialogId + '_None_Div' || targetId === tableBorderDialogId + '_None_Div_Container'\n                || targetId === tableBorderDialogId + '_None_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('none');\n            }\n            else if (targetId === tableBorderDialogId + '_Box_Div' || targetId === tableBorderDialogId + '_Box_Div_Container'\n                || targetId === tableBorderDialogId + '_Box_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.boxDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('box');\n            }\n            else if (targetId === tableBorderDialogId + '_All_Div' || targetId === tableBorderDialogId + '_All_Div_Container'\n                || targetId === tableBorderDialogId + '_All_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.allDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('all');\n            }\n            else {\n                _this.updateClassForSettingDivElements();\n                _this.customDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('customDiv');\n            }\n        };\n        this.handlePreviewCheckBoxAction = function (event) {\n            var target = event.target;\n            var targetId = target.id;\n            var tableBorderDialog = _this.target;\n            var tableBorderDialogId = _this.target.id;\n            var checkBox;\n            var compareClass = 'e-de-table-border-inside-preview-click';\n            _this.customDiv.click();\n            if (targetId === tableBorderDialogId + '_Preview_Div_TopTop_Container' || targetId === tableBorderDialogId + '_Preview_Div_TopTop'\n                || targetId === tableBorderDialogId + '_previewDivTopTopTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopTop);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_TopTop', 'TopTop');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_TopCenter_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_TopCenter'\n                || targetId === tableBorderDialogId + '_previewDivTopCenterTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopCenter);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Horizontal', '_Preview_Div_TopCenter', 'TopCenter');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_TopBottom_Container' || targetId === tableBorderDialogId + '_Preview_Div_TopBottom'\n                || targetId === tableBorderDialogId + '_previewDivTopBottomTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopBottom);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_TopBottom', 'TopBottom');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_LeftDiagonal_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_LeftDiagonal'\n                || targetId === tableBorderDialogId + '_previewDivLeftDiagonalTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivLeftDiagonal);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Left_Diagonal', '_Preview_Div_LeftDiagonal', 'LeftDiagonal');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomLeft_Container' || targetId === tableBorderDialogId + '_Preview_Div_BottomLeft'\n                || targetId === tableBorderDialogId + '_previewDivBottomLeftTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomLeft);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_BottomLeft', 'BottomLeft');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomCenter_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_BottomCenter'\n                || targetId === tableBorderDialogId + '_previewDivBottomcenterTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomcenter);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Vertical', '_Preview_Div_BottomCenter', 'BottomCenter');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomRight_Container' || targetId === tableBorderDialogId + '_Preview_Div_BottomRight'\n                || targetId === tableBorderDialogId + '_previewDivBottomRightTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomRight);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_BottomRight', 'BottomRight');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_RightDiagonal_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_RightDiagonal'\n                || targetId === tableBorderDialogId + '_previewDivDiagonalRightTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivDiagonalRight);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Right_Diagonal', '_Preview_Div_RightDiagonal', 'RightDiagonal');\n            }\n        };\n        this.applyTableCellPreviewBoxes = function () {\n            _this.customDiv.click();\n            if (!isNullOrUndefined(_this.ulelementShading)) {\n                if (_this.ulelementShading.index === 0) {\n                    _this.previewDivBottomcenterContainer.style.display = 'none';\n                    _this.previewDivTopCenterContainer.style.display = 'none';\n                    _this.previewVerticalDiv.style.display = 'none';\n                    _this.previewHorizontalDiv.style.display = 'none';\n                    _this.previewDivLeftDiagonal.style.display = '';\n                    _this.previewDivDiagonalRight.style.display = '';\n                    _this.previewDivBottomRightContainer.style.left = '80px';\n                }\n                else {\n                    _this.previewDivLeftDiagonal.style.display = 'none';\n                    _this.previewDivDiagonalRight.style.display = 'none';\n                    _this.previewDivBottomcenterContainer.style.display = '';\n                    _this.previewDivTopCenterContainer.style.display = '';\n                    _this.previewVerticalDiv.style.display = '';\n                    _this.previewHorizontalDiv.style.display = '';\n                    _this.previewDivBottomRightContainer.style.left = '110px';\n                }\n            }\n        };\n        this.applyPreviewTableBackgroundColor = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                var color = args.currentValue.hex;\n                _this.previewDiv.style.backgroundColor = color;\n            }\n        };\n        this.applyPreviewTableBorderColor = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                var color = args.currentValue.hex;\n                _this.previewDiv.style.borderColor = color;\n                _this.previewRightDiagonalDiv.style.backgroundColor = color;\n                _this.previewLeftDiagonalDiv.style.backgroundColor = color;\n                _this.previewVerticalDiv.style.backgroundColor = color;\n                _this.previewHorizontalDiv.style.backgroundColor = color;\n            }\n        };\n        this.owner = viewer;\n    }\n    BordersAndShadingDialog.prototype.getModuleName = function () {\n        return 'BordersAndShadingDialog';\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    BordersAndShadingDialog.prototype.initBordersAndShadingsDialog = function (localeValue) {\n        var instance = this;\n        this.target = createElement('div', {\n            id: instance.owner.owner.containerId + '_table_border_shadings',\n            className: 'e-de-table-border-shading-dlg'\n        });\n        this.owner.owner.element.appendChild(this.target);\n        var displayText = createElement('div', {\n            innerHTML: localeValue.getConstant('Borders'), styles: 'position: absolute;top: 65px;',\n            id: this.target.id + '_border_label', className: 'e-de-table-border-heading'\n        });\n        var settingsContiner = createElement('div', {\n            styles: 'display: inline-block;position: absolute;top: 105px;width: 100px;height: 235px;border-style: none;',\n            id: this.target.id + '_border_settings'\n        });\n        var styleContainer = createElement('div', {\n            // tslint:disable-next-line:max-line-length\n            styles: 'display: inline-block;position: absolute;left: 125px;top: 125px;width: 150px;height: 235px;padding-left: 40px;border-style: none;padding-right: 40px;',\n            id: this.target.id + '_border_style'\n        });\n        var previewContiner = createElement('div', {\n            // tslint:disable-next-line:max-line-length\n            styles: 'display: inline-block;position: absolute;left: 345px;top: 87px;width: 180px;height: 235px;padding: 0px;border-style: none;',\n            id: this.target.id + '_border_preview'\n        });\n        var styleText = createElement('div', {\n            innerHTML: localeValue.getConstant('Style'), styles: 'width: 100%;padding-bottom: 10px;',\n            className: 'e-de-table-element-subheading'\n        });\n        var dropDownList = createElement('select', {\n            id: this.target.id + '_border_style_dropDown'\n        });\n        dropDownList.innerHTML = '<option>' + localeValue.getConstant('None') + '</option><option>'\n            + localeValue.getConstant('Single') + '</option><option>' + localeValue.getConstant('Dot') + '</option><option>'\n            + localeValue.getConstant('DashSmallGap') + '</option><option>' + localeValue.getConstant('DashLargeGap') + '</option><option>'\n            + localeValue.getConstant('DashDot') + '</option><option>' + localeValue.getConstant('DashDotDot') + '</option><option>'\n            + localeValue.getConstant('Double') + '</option><option>' + localeValue.getConstant('Triple') + '</option><option>'\n            + localeValue.getConstant('ThinThickSmallGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinSmallGap') + '</option><option>' + localeValue.getConstant('ThinThickThinSmallGap')\n            + '</option><option>' + localeValue.getConstant('ThinThickMediumGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinMediumGap') + '</option><option>' + localeValue.getConstant('ThinThickThinMediumGap')\n            + '</option><option>' + localeValue.getConstant('ThinThickLargeGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinLargeGap') + '</option><option>' + localeValue.getConstant('ThinThickThinLargeGap')\n            + '</option><option>' + localeValue.getConstant('SingleWavy') + '</option><option>'\n            + localeValue.getConstant('DoubleWavy') + '</option><option>' + localeValue.getConstant('DashDotStroked')\n            + '</option><option>' + localeValue.getConstant('Emboss3D') + '</option><option>' + localeValue.getConstant('Engrave3D')\n            + '</option><option>' + localeValue.getConstant('Outset') + '</option><option>'\n            + localeValue.getConstant('Inset') + '</option><option>' + localeValue.getConstant('Thick') + '</option>';\n        var widthText = createElement('div', {\n            innerHTML: localeValue.getConstant('Width'), styles: 'width:100%;padding-top: 20px;padding-bottom: 10px;',\n            className: 'e-de-table-element-subheading'\n        });\n        var widthNumeric = createElement('input', {\n            id: this.target.id + '_width'\n        });\n        var colorText = createElement('div', {\n            innerHTML: localeValue.getConstant('Color'), styles: 'padding-top: 25px;',\n            className: 'e-de-table-setting-heading'\n        });\n        var borderColorPickerElement = createElement('input', {\n            attrs: { 'type': 'color' },\n            id: this.target.id + '_border_color',\n            styles: 'width: 30px;position: absolute;left: 90px;',\n            className: 'e-dlg-clr-pkr-top'\n        });\n        var settingText = createElement('div', {\n            innerHTML: localeValue.getConstant('Setting'), styles: 'width: 100%;position: absolute;',\n            className: 'e-de-table-setting-heading'\n        });\n        var noneDivContainer = createElement('div', {\n            id: this.target.id + '_None_Div_Container', className: 'e-de-table-border-none'\n        });\n        this.noneDiv = createElement('div', {\n            id: this.target.id + '_None_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var noneDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('None'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 20px;position: absolute;',\n            id: this.target.id + '_None_Div_Label'\n        });\n        var boxDivContainer = createElement('div', {\n            id: this.target.id + '_Box_Div_Container', className: 'e-de-table-border-box'\n        });\n        this.boxDiv = createElement('div', {\n            id: this.target.id + '_Box_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var boxDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('Box'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 20px;position: absolute;',\n            id: this.target.id + '_Box_Div_Label'\n        });\n        var allDivContainer = createElement('div', {\n            id: this.target.id + '_All_Div_Container', className: 'e-de-table-border-all'\n        });\n        this.allDiv = createElement('div', {\n            id: this.target.id + '_All_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var allDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('All'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 25px;position: absolute;',\n            id: this.target.id + '_All_Div_Label'\n        });\n        var customDivContainer = createElement('div', {\n            id: this.target.id + '_Custom_Div_Container', className: 'e-de-table-border-custom'\n        });\n        this.customDiv = createElement('div', {\n            id: this.target.id + '_Custom_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var customDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('Custom'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 25px;position: absolute;',\n            id: this.target.id + '_Custom_Div_Label'\n        });\n        this.noneDivTransparent = createElement('div', {\n            id: this.target.id + '_None_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-none-setting'\n        });\n        this.boxDivTransparent = createElement('div', {\n            id: this.target.id + '_Box_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-box-setting'\n        });\n        this.allDivTransparent = createElement('div', {\n            id: this.target.id + '_All_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-all-setting'\n        });\n        this.customDivTransparent = createElement('div', {\n            id: this.target.id + '_Custom_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-custom-setting'\n        });\n        var previewText = createElement('div', {\n            innerHTML: localeValue.getConstant('Preview'), className: 'e-de-table-setting-heading',\n            styles: 'position: absolute;top: 20px;left: 10px;'\n        });\n        this.previewDiv = createElement('div', {\n            styles: 'width: 80px;height: 80px;position: absolute; left: 50px;top: 50px;',\n            id: this.target.id + '_Preview_Div', className: 'e-de-border-dlg-preview-div'\n        });\n        this.previewRightDiagonalDiv = createElement('div', {\n            styles: 'position: absolute;width:1px;height:113px;left: 90px;top: 34px;transform: rotate(135deg);',\n            id: this.target.id + '_Preview_Div_Right_Diagonal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewLeftDiagonalDiv = createElement('div', {\n            styles: 'position: absolute;width: 1px;height: 113px;left: 90px;top: 34px;transform:rotate(45deg);',\n            id: this.target.id + '_Preview_Div_Left_Diagonal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewVerticalDiv = createElement('div', {\n            styles: 'width: 1px;height: 81px;position: absolute;left: 90px;top: 50px;',\n            id: this.target.id + '_Preview_Div_Vertical',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewHorizontalDiv = createElement('div', {\n            styles: 'width: 81px;height: 1px;position: absolute;left: 50px;top: 90px;',\n            id: this.target.id + '_Preview_Div_Horizontal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewDivTopTopContainer = createElement('div', {\n            styles: 'top: 50px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_TopTop_Container'\n        });\n        this.previewDivTopTop = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopTop',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopCenterContainer = createElement('div', {\n            styles: 'top: 80px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_TopCenter_Container'\n        });\n        this.previewDivTopCenter = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopCenter',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopBottomContainer = createElement('div', {\n            styles: 'top: 110px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_TopBottom_Container'\n        });\n        this.previewDivTopBottom = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopBottom',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivLeftDiagonalContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_LeftDiagonal_Container'\n        });\n        this.previewDivLeftDiagonal = createElement('div', {\n            id: this.target.id + '_Preview_Div_LeftDiagonal',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomLeftContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 50px', id: this.target.id + '_Preview_Div_BottomLeft_Container'\n        });\n        this.previewDivBottomLeft = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomLeft',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomcenterContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 80px;', id: this.target.id + '_Preview_Div_BottomCenter_Container'\n        });\n        this.previewDivBottomcenter = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomCenter',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomRightContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 110px;', id: this.target.id + '_Preview_Div_BottomRight_Container'\n        });\n        this.previewDivBottomRight = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomRight',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivDiagonalRightContainer = createElement('div', {\n            styles: 'top: 145px; position: absolute; left: 110px;', id: this.target.id + '_Preview_Div_RightDiagonal_Container'\n        });\n        this.previewDivDiagonalRight = createElement('div', {\n            id: this.target.id + '_Preview_Div_RightDiagonal',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopTopTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopTopTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-toptop-alignment'\n        });\n        this.previewDivTopCenterTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopCenterTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-topcenter-alignment'\n        });\n        this.previewDivTopBottomTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopBottomTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-topbottom-alignment'\n        });\n        this.previewDivLeftDiagonalTransParent = createElement('div', {\n            id: this.target.id + '_previewDivLeftDiagonalTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-diagionalup-alignment'\n        });\n        this.previewDivBottomLeftTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomLeftTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomleft-alignment'\n        });\n        this.previewDivBottomcenterTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomcenterTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomcenter-alignment'\n        });\n        this.previewDivBottomRightTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomRightTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomright-alignment'\n        });\n        this.previewDivDiagonalRightTransparent = createElement('div', {\n            id: this.target.id + '_previewDivDiagonalRightTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-diagionaldown-alignment'\n        });\n        this.shadingContiner = createElement('div', {\n            /* tslint:disable:max-line-length */\n            styles: 'display:inline-block;position:absolute;left:17px;width:400px;height:100px;padding:0px;border-style: none;margin-left:10px;',\n            id: this.target.id + '_shading_preview', className: 'e-de-table-shading-preview'\n        });\n        var shadingText = createElement('div', {\n            innerHTML: localeValue.getConstant('Shading'), className: 'e-de-table-border-heading',\n            styles: 'padding-top: 30px;left: 5px;'\n        });\n        var shadings = createElement('div', { styles: 'display:flex;' });\n        var label = createElement('div', {\n            innerHTML: localeValue.getConstant('Fill'), className: 'e-de-table-setting-heading e-de-table-border-fill',\n            styles: 'top: 50px;left: 10px;'\n        });\n        var shadingColorPickerElement = createElement('input', {\n            attrs: { 'type': 'color' },\n            id: this.target.id + '_shading_color', styles: 'position: absolute;top: 75px;left: 40px;width: 30px;'\n        });\n        var shdApply = createElement('div', {\n            styles: 'position:absolute;top:41px;left:150px;width:180px;'\n        });\n        var div = createElement('div', {\n            styles: 'width:100px;padding-bottom: 10px;', innerHTML: localeValue.getConstant('Apply To'),\n            className: 'e-de-table-element-subheading'\n        });\n        var divsion = createElement('div', { styles: 'width:100px;position:absolute;' });\n        var ulelementShading = createElement('select', {\n            innerHTML: '<option>' + localeValue.getConstant('Cell') + '</option>'\n                + '<option>' + localeValue.getConstant('Table') + '</option>',\n            id: this.target.id + '_shading'\n        });\n        divsion.appendChild(ulelementShading);\n        this.noneDiv.appendChild(this.noneDivTransparent);\n        this.boxDiv.appendChild(this.boxDivTransparent);\n        this.allDiv.appendChild(this.allDivTransparent);\n        this.customDiv.appendChild(this.customDivTransparent);\n        noneDivContainer.appendChild(this.noneDiv);\n        noneDivContainer.appendChild(noneDivLabel);\n        boxDivContainer.appendChild(this.boxDiv);\n        boxDivContainer.appendChild(boxDivLabel);\n        allDivContainer.appendChild(this.allDiv);\n        allDivContainer.appendChild(allDivLabel);\n        customDivContainer.appendChild(this.customDiv);\n        customDivContainer.appendChild(customDivLabel);\n        settingsContiner.appendChild(settingText);\n        settingsContiner.appendChild(noneDivContainer);\n        settingsContiner.appendChild(boxDivContainer);\n        settingsContiner.appendChild(allDivContainer);\n        settingsContiner.appendChild(customDivContainer);\n        this.previewDivBottomcenter.appendChild(this.previewDivBottomcenterTransparent);\n        this.previewDivBottomRight.appendChild(this.previewDivBottomRightTransparent);\n        this.previewDivBottomLeft.appendChild(this.previewDivBottomLeftTransparent);\n        this.previewDivTopTop.appendChild(this.previewDivTopTopTransParent);\n        this.previewDivTopCenter.appendChild(this.previewDivTopCenterTransParent);\n        this.previewDivTopBottom.appendChild(this.previewDivTopBottomTransParent);\n        this.previewDivDiagonalRight.appendChild(this.previewDivDiagonalRightTransparent);\n        this.previewDivLeftDiagonal.appendChild(this.previewDivLeftDiagonalTransParent);\n        this.previewDivBottomcenterContainer.appendChild(this.previewDivBottomcenter);\n        this.previewDivBottomLeftContainer.appendChild(this.previewDivBottomLeft);\n        this.previewDivBottomRightContainer.appendChild(this.previewDivBottomRight);\n        this.previewDivDiagonalRightContainer.appendChild(this.previewDivDiagonalRight);\n        this.previewDivLeftDiagonalContainer.appendChild(this.previewDivLeftDiagonal);\n        this.previewDivTopBottomContainer.appendChild(this.previewDivTopBottom);\n        this.previewDivTopCenterContainer.appendChild(this.previewDivTopCenter);\n        this.previewDivTopTopContainer.appendChild(this.previewDivTopTop);\n        previewContiner.appendChild(previewText);\n        previewContiner.appendChild(this.previewDiv);\n        previewContiner.appendChild(this.previewRightDiagonalDiv);\n        previewContiner.appendChild(this.previewHorizontalDiv);\n        previewContiner.appendChild(this.previewLeftDiagonalDiv);\n        previewContiner.appendChild(this.previewVerticalDiv);\n        previewContiner.appendChild(this.previewDivBottomcenterContainer);\n        previewContiner.appendChild(this.previewDivBottomLeftContainer);\n        previewContiner.appendChild(this.previewDivBottomRightContainer);\n        previewContiner.appendChild(this.previewDivDiagonalRightContainer);\n        previewContiner.appendChild(this.previewDivLeftDiagonalContainer);\n        previewContiner.appendChild(this.previewDivTopBottomContainer);\n        previewContiner.appendChild(this.previewDivTopCenterContainer);\n        previewContiner.appendChild(this.previewDivTopTopContainer);\n        shdApply.appendChild(div);\n        shdApply.appendChild(divsion);\n        shadings.appendChild(label);\n        shadings.appendChild(shadingColorPickerElement);\n        shadings.appendChild(shdApply);\n        this.shadingContiner.appendChild(shadingText);\n        this.shadingContiner.appendChild(shadings);\n        styleContainer.appendChild(styleText);\n        styleContainer.appendChild(dropDownList);\n        styleContainer.appendChild(widthText);\n        styleContainer.appendChild(widthNumeric);\n        styleContainer.appendChild(colorText);\n        styleContainer.appendChild(borderColorPickerElement);\n        this.target.appendChild(displayText);\n        this.target.appendChild(settingsContiner);\n        this.target.appendChild(styleContainer);\n        this.target.appendChild(previewContiner);\n        this.target.appendChild(this.shadingContiner);\n        // Handling Setting Container\n        noneDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        boxDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        allDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        customDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        // Handling Preview Div Container\n        this.previewDivBottomcenterContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivBottomLeftContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivBottomRightContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopTopContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopBottomContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopCenterContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivDiagonalRightContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivLeftDiagonalContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        // handling dropdown change\n        this.borderWidth = new NumericTextBox({\n            value: 0, min: 0, max: 6, decimals: 2,\n            width: 150, enablePersistence: false\n        });\n        this.borderWidth.appendTo(widthNumeric);\n        this.borderStyle = new DropDownList({\n            width: '150px', popupHeight: '150px', index: 1\n        });\n        this.borderStyle.appendTo(dropDownList);\n        this.ulelementShading = new DropDownList({\n            width: '150px', change: this.applyTableCellPreviewBoxes, index: 1\n        });\n        this.ulelementShading.appendTo(ulelementShading);\n        this.borderColorPicker = new ColorPicker({\n            value: '#000000', change: this.applyPreviewTableBorderColor\n        });\n        this.borderColorPicker.appendTo(borderColorPickerElement);\n        this.shadingColorPicker = new ColorPicker({\n            value: '#000000', change: this.applyPreviewTableBackgroundColor\n        });\n        this.shadingColorPicker.appendTo(shadingColorPickerElement);\n    };\n    BordersAndShadingDialog.prototype.applyFormat = function () {\n        var selection = this.owner.selection;\n        var editorModule = this.owner.owner.editorModule;\n        editorModule.initComplexHistory('BordersAndShading');\n        editorModule.isBordersAndShadingDialog = true;\n        if (this.applyTo === 0) {\n            editorModule.onCellFormat(this.cellFormat);\n        }\n        else {\n            editorModule.onTableFormat(this.tableFormat);\n        }\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n        editorModule.isBordersAndShadingDialog = false;\n    };\n    BordersAndShadingDialog.prototype.getBorder = function () {\n        var border = new WBorder();\n        border.color = this.borderColorPicker.value;\n        border.lineStyle = this.borderStyle.text;\n        border.lineWidth = this.borderWidth.value;\n        return border;\n    };\n    BordersAndShadingDialog.prototype.checkClassName = function (element) {\n        return element.classList.contains('e-de-table-border-inside-preview-click');\n    };\n    /**\n     * @private\n     */\n    BordersAndShadingDialog.prototype.show = function () {\n        var localeValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localeValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initBordersAndShadingsDialog(localeValue);\n        }\n        this.loadBordersShadingsPropertiesDialog();\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.header = localeValue.getConstant('Borders and Shading');\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.closeBordersShadingsDialog;\n        this.owner.dialog.position = { X: 'center', Y: 'center' };\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.applyBordersShadingsProperties,\n                buttonModel: { content: localeValue.getConstant('Ok'), cssClass: 'e-flat e-table-border-shading-okay', isPrimary: true }\n            },\n            {\n                click: this.closeDialog,\n                buttonModel: { content: localeValue.getConstant('Cancel'), cssClass: 'e-flat e-table-border-shading-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BordersAndShadingDialog.prototype.updateClassForSettingDivElements = function () {\n        var settingDivs = this.target.getElementsByClassName('e-de-table-border-inside-setting');\n        for (var j = 0; j < settingDivs.length; j++) {\n            if (settingDivs[j].className.indexOf('e-de-table-border-inside-setting-click') !== -1) {\n                var tempClassName = settingDivs[j].className;\n                tempClassName = tempClassName.replace('e-de-table-border-inside-setting-click', '');\n                settingDivs[j].className = tempClassName;\n            }\n        }\n    };\n    BordersAndShadingDialog.prototype.setSettingPreviewDivElement = function (position) {\n        switch (position) {\n            case 'none':\n                this.previewDivTopTop.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('none');\n                break;\n            case 'box':\n                this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('box');\n                break;\n            case 'all':\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopCenter.classList.add('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('all');\n                break;\n        }\n    };\n    BordersAndShadingDialog.prototype.isShowHidePreviewTableElements = function (settingDiv) {\n        switch (settingDiv) {\n            case 'none':\n                this.previewDiv.style.border = 'none';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'none';\n                this.previewVerticalDiv.style.display = 'none';\n                break;\n            case 'box':\n                this.previewDiv.style.border = '1px solid rgba(0, 0, 0, .54)';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'none';\n                this.previewVerticalDiv.style.display = 'none';\n                break;\n            case 'all':\n                this.previewDiv.style.border = '1px solid rgba(0, 0, 0, .54)';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'block';\n                this.previewVerticalDiv.style.display = 'block';\n                break;\n        }\n    };\n    BordersAndShadingDialog.prototype.handlePreviewCheckBoxShowHide = function (tableBorderDialogId, compareClass, element) {\n        if (element.classList.contains(compareClass)) {\n            element.classList.remove(compareClass);\n        }\n        else {\n            element.classList.add(compareClass);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    BordersAndShadingDialog.prototype.showHidePreviewDivElements = function (tableBorderDialogId, compareClass, elementClass, compareElementClass, position) {\n        var setElement = document.getElementById(tableBorderDialogId + elementClass);\n        var compareElement = document.getElementById(tableBorderDialogId + compareElementClass);\n        if (position === 'TopTop') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-top');\n        }\n        else if (position === 'TopCenter') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'TopBottom') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-bottom');\n        }\n        else if (position === 'LeftDiagonal') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'BottomLeft') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-left');\n        }\n        else if (position === 'BottomCenter') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'BottomRight') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-right');\n        }\n        else if (position === 'RightDiagonal') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n    };\n    BordersAndShadingDialog.prototype.setPropertyPreviewDivElement = function (ele, compareElement, compareClass, property) {\n        if (compareElement.classList.contains(compareClass) && property.split('-')[0] === 'border') {\n            /* tslint:disable:no-any */\n            ele.style[property] = '1px solid rgba(0, 0, 0, .54)';\n        }\n        else if (compareElement.classList.contains(compareClass) && property === 'display') {\n            ele.style[property] = 'block';\n        }\n        else {\n            ele.style[property] = 'none';\n            /* tslint:enable:no-any */\n        }\n    };\n    BordersAndShadingDialog.prototype.loadBordersShadingsPropertiesDialog = function () {\n        var tableFormat = this.owner.selection.tableFormat.table.tableFormat;\n        var lineStyle;\n        var borderColor;\n        var fillColor;\n        var borderWidth;\n        if (!isNullOrUndefined(tableFormat) && !isNullOrUndefined(tableFormat.borders)) {\n            this.cloneBorders(tableFormat.borders);\n            if (isNullOrUndefined(tableFormat.borders) || isNullOrUndefined(tableFormat.borders.top)) {\n                lineStyle = 1;\n                borderColor = '#000000';\n                borderWidth = 0;\n                fillColor = '#000000';\n            }\n            else {\n                lineStyle = this.getLineStyle(tableFormat.borders.top.lineStyle);\n                borderColor = tableFormat.borders.top.color;\n                borderWidth = tableFormat.borders.top.getLineWidth();\n                fillColor = tableFormat.shading.backgroundColor;\n            }\n        }\n        this.borderColorPicker.value = borderColor;\n        this.shadingColorPicker.value = fillColor;\n        /* tslint:disable:no-any */\n        var colorPickerEvent = {\n            target: this.borderColorPicker, ctrlKey: false,\n            shiftKey: false, which: 0\n        };\n        var fillColorEvent = {\n            target: this.shadingColorPicker, ctrlKey: false,\n            shiftKey: false, which: 0\n        };\n        /* tslint:enable:no-any */\n        this.applyPreviewTableBackgroundColor(fillColorEvent);\n        this.applyPreviewTableBorderColor(colorPickerEvent);\n        this.ulelementShading.index = 1;\n        this.previewDivLeftDiagonal.style.display = 'none';\n        this.previewDivDiagonalRight.style.display = 'none';\n        this.borderWidth.value = borderWidth;\n        this.borderStyle.index = lineStyle;\n    };\n    // tslint:disable:max-func-body-length\n    BordersAndShadingDialog.prototype.cloneBorders = function (borders) {\n        var topBorder = false;\n        var bottomBorder = false;\n        var leftBorder = false;\n        var rightBorder = false;\n        var horizontalBorder = false;\n        var verticalBorder = false;\n        var diagonalDownBorder = false;\n        var customBorder = false;\n        var diagonalUpBorder = false;\n        if (borders !== null) {\n            if (borders.top && (borders.top.hasNoneStyle || borders.top.lineStyle !== 'None')) {\n                topBorder = true;\n            }\n            if (borders.bottom && (borders.bottom.hasNoneStyle || borders.bottom.lineStyle !== 'None')) {\n                bottomBorder = true;\n            }\n            if (borders.left && (borders.left.hasNoneStyle || borders.left.lineStyle !== 'None')) {\n                leftBorder = true;\n            }\n            if (borders.right && (borders.right.hasNoneStyle || borders.right.lineStyle !== 'None')) {\n                rightBorder = true;\n            }\n            if (borders.horizontal && (borders.horizontal.hasNoneStyle || borders.horizontal.lineStyle !== 'None')) {\n                horizontalBorder = true;\n            }\n            if (borders.vertical && (borders.vertical.hasNoneStyle || borders.vertical.lineStyle !== 'None')) {\n                verticalBorder = true;\n            }\n            if (borders.diagonalDown && (borders.diagonalDown.hasNoneStyle || borders.diagonalDown.lineStyle !== 'None')) {\n                diagonalDownBorder = true;\n            }\n            if (borders.diagonalUp && (borders.diagonalUp.hasNoneStyle || borders.diagonalUp.lineStyle !== 'None')) {\n                diagonalUpBorder = true;\n            }\n            if (!(!topBorder || !bottomBorder || !leftBorder || !rightBorder)) {\n                if (!(!topBorder || !bottomBorder || !leftBorder || !rightBorder || !horizontalBorder\n                    || !verticalBorder || diagonalUpBorder || diagonalDownBorder)) {\n                    if ((topBorder && bottomBorder && leftBorder && rightBorder && horizontalBorder && verticalBorder\n                        && !diagonalUpBorder && !diagonalDownBorder)) {\n                        if (borders.top.hasNoneStyle && borders.bottom.hasNoneStyle && borders.left.hasNoneStyle\n                            && borders.right.hasNoneStyle && borders.horizontal.hasNoneStyle && borders.vertical.hasNoneStyle) {\n                            this.setSettingPreviewDivElement('none');\n                            this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                            this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        }\n                        else {\n                            this.setSettingPreviewDivElement('all');\n                            this.allDiv.classList.add('e-de-table-border-inside-setting-click');\n                            this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        }\n                    }\n                }\n                else if ((leftBorder && bottomBorder && topBorder && rightBorder && !horizontalBorder && !verticalBorder)) {\n                    if (borders.top.hasNoneStyle && borders.bottom.hasNoneStyle && borders.left.hasNoneStyle\n                        && borders.right.hasNoneStyle && borders.horizontal.hasNoneStyle && borders.vertical.hasNoneStyle) {\n                        this.setSettingPreviewDivElement('none');\n                        this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                    }\n                    else {\n                        this.setSettingPreviewDivElement('box');\n                        this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.boxDiv.classList.add('e-de-table-border-inside-setting-click');\n                        this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                    }\n                }\n                else {\n                    customBorder = true;\n                }\n            }\n            else {\n                customBorder = true;\n            }\n            this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n            this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n            if (customBorder) {\n                this.customDiv.classList.add('e-de-table-border-inside-setting-click');\n                this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                if (topBorder) {\n                    this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopTop.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (bottomBorder) {\n                    this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopBottom.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (leftBorder) {\n                    this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomLeft.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (rightBorder) {\n                    this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomRight.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (verticalBorder) {\n                    this.previewDivBottomcenter.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (horizontalBorder) {\n                    this.previewDivTopCenter.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                }\n            }\n        }\n    };\n    BordersAndShadingDialog.prototype.getLineStyle = function (lineStyle) {\n        switch (lineStyle) {\n            case 'Single': return 1;\n            case 'Dot': return 2;\n            case 'DashSmallGap': return 3;\n            case 'DashLargeGap': return 4;\n            case 'DashDot': return 5;\n            case 'DashDotDot': return 6;\n            case 'Double': return 7;\n            case 'Triple': return 8;\n            case 'ThinThickSmallGap': return 9;\n            case 'ThickThinSmallGap': return 10;\n            case 'ThinThickThinSmallGap': return 11;\n            case 'ThinThickMediumGap': return 12;\n            case 'ThickThinMediumGap': return 13;\n            case 'ThinThickThinMediumGap': return 14;\n            case 'ThinThickLargeGap': return 15;\n            case 'ThickThinLargeGap': return 16;\n            case 'ThinThickThinLargeGap': return 17;\n            case 'SingleWavy': return 18;\n            case 'DoubleWavy': return 19;\n            case 'DashDotStroked': return 20;\n            case 'Emboss3D': return 21;\n            case 'Engrave3D': return 22;\n            case 'Outset': return 23;\n            case 'Inset': return 24;\n            case 'Thick': return 25;\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    BordersAndShadingDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var k = 0; k < this.target.childNodes.length; k++) {\n                this.target.removeChild(this.target.childNodes[k]);\n                k--;\n            }\n            this.target = undefined;\n        }\n        if (this.cellFormat) {\n            this.cellFormat.destroy();\n            this.cellFormat = undefined;\n        }\n        if (this.tableFormat) {\n            this.tableFormat.destroy();\n            this.tableFormat = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        if (!isNullOrUndefined(this.borderStyle)) {\n            this.borderStyle.destroy();\n        }\n        this.borderStyle = undefined;\n        if (!isNullOrUndefined(this.borderColorPicker)) {\n            this.borderColorPicker.destroy();\n        }\n        this.borderColorPicker = undefined;\n        if (!isNullOrUndefined(this.shadingColorPicker)) {\n            this.shadingColorPicker.destroy();\n        }\n        this.shadingColorPicker = undefined;\n        if (!isNullOrUndefined(this.ulelementShading)) {\n            this.ulelementShading.destroy();\n        }\n        this.ulelementShading = undefined;\n        this.noneDivTransparent = undefined;\n        this.boxDivTransparent = undefined;\n        this.allDivTransparent = undefined;\n        this.customDivTransparent = undefined;\n        this.previewDiv = undefined;\n        this.previewRightDiagonalDiv = undefined;\n        this.previewLeftDiagonalDiv = undefined;\n        this.previewVerticalDiv = undefined;\n        this.previewHorizontalDiv = undefined;\n        this.previewDivTopTopContainer = undefined;\n        this.previewDivTopTop = undefined;\n        this.previewDivTopCenterContainer = undefined;\n        this.previewDivTopCenter = undefined;\n        this.previewDivTopBottomContainer = undefined;\n        this.previewDivTopBottom = undefined;\n        this.previewDivLeftDiagonalContainer = undefined;\n        this.previewDivLeftDiagonal = undefined;\n        this.previewDivBottomLeftContainer = undefined;\n        this.previewDivBottomLeft = undefined;\n        this.previewDivBottomcenterContainer = undefined;\n        this.previewDivBottomcenter = undefined;\n        this.previewDivBottomRightContainer = undefined;\n        this.previewDivBottomRight = undefined;\n        this.previewDivDiagonalRightContainer = undefined;\n        this.previewDivDiagonalRight = undefined;\n        this.previewDivTopTopTransParent = undefined;\n        this.previewDivTopCenterTransParent = undefined;\n        this.previewDivTopBottomTransParent = undefined;\n        this.previewDivLeftDiagonalTransParent = undefined;\n        this.previewDivBottomLeftTransparent = undefined;\n        this.previewDivBottomcenterTransparent = undefined;\n        this.previewDivBottomRightTransparent = undefined;\n        this.previewDivDiagonalRightTransparent = undefined;\n        this.shadingContiner = undefined;\n        this.noneDiv = undefined;\n        this.customDiv = undefined;\n        this.allDiv = undefined;\n        this.boxDiv = undefined;\n    };\n    return BordersAndShadingDialog;\n}());\nexport { BordersAndShadingDialog };\n","import { CheckBox } from '@syncfusion/ej2-buttons';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat } from '../index';\nimport { isNullOrUndefined, L10n, createElement, setCulture } from '@syncfusion/ej2-base';\nimport { CellOptionsDialog } from './index';\n/**\n * The Table options dialog is used to modify default cell margins and cell spacing of selected table.\n */\nvar TableOptionsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableOptionsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.applyTableCellProperties = function () {\n            var tableFormat = _this.owner.selection.tableFormat;\n            if (!isNullOrUndefined(_this.bottomMarginBox.value || _this.leftMarginBox.value\n                || _this.rightMarginBox.value || _this.topMarginBox.value || _this.cellSpaceTextBox.value)\n                && (tableFormat.bottomMargin !== _this.bottomMarginBox.value\n                    || tableFormat.leftMargin !== _this.leftMarginBox.value\n                    || tableFormat.rightMargin !== _this.rightMarginBox.value\n                    || tableFormat.topMargin !== _this.topMarginBox.value\n                    || tableFormat.cellSpacing !== _this.cellSpaceTextBox.value)) {\n                _this.owner.owner.tablePropertiesDialogModule.isTableOptionsUpdated = true;\n                _this.applyTableOptions(_this.tableFormat);\n                _this.owner.owner.tablePropertiesDialogModule.applyTableSubProperties();\n            }\n            _this.closeCellMarginsDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeCellMarginsDialog = function () {\n            _this.owner.dialog.hide();\n            _this.owner.dialog.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeAllowSpaceCheckBox = function () {\n            if (_this.allowSpaceCheckBox.checked) {\n                _this.cellSpaceTextBox.enabled = true;\n            }\n            else {\n                _this.cellSpaceTextBox.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.removeEvents = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(TableOptionsDialog.prototype, \"tableFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.tableFormatIn)) {\n                return this.tableFormatIn = new WTableFormat();\n            }\n            return this.tableFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.getModuleName = function () {\n        return 'TableOptionsDialog';\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.initTableOptionsDialog = function (localValue) {\n        var instance = this.owner;\n        this.target = createElement('div', {\n            id: this.owner.owner.containerId + '_insertCellMarginsDialog', className: 'e-de-table-options-dlg'\n        });\n        this.owner.owner.element.appendChild(this.target);\n        var innerDiv = createElement('div', { styles: 'width: 475px;position: relative;height: 180px;' });\n        var innerDivLabel = createElement('Label', {\n            id: this.target.id + '_innerDivLabel', className: 'e-de-cell-dia-options-label',\n            innerHTML: localValue.getConstant('Default cell margins')\n        });\n        innerDiv.appendChild(innerDivLabel);\n        CellOptionsDialog.getCellMarginDialogElements(this, innerDiv, localValue);\n        var div = createElement('div', { styles: 'width: 475px; position: relative;' });\n        var cellSpaceLabel = createElement('Label', {\n            className: 'e-de-cell-dia-options-label',\n            id: this.target.id + '_cellSpaceLabel'\n        });\n        cellSpaceLabel.innerHTML = localValue.getConstant('Default cell spacing');\n        div.appendChild(cellSpaceLabel);\n        var table2 = createElement('TABLE', {\n            styles: 'height: 30px;padding-bottom: 15px;'\n        });\n        var tr3 = createElement('tr');\n        var td5 = createElement('td');\n        var allowSpaceCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_cellcheck'\n        });\n        var td6 = createElement('td', { styles: 'padding-left: 15px;', });\n        this.cellspacingTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_cellspacing'\n        });\n        td5.appendChild(allowSpaceCheckBox);\n        td6.appendChild(this.cellspacingTextBox);\n        tr3.appendChild(td5);\n        tr3.appendChild(td6);\n        table2.appendChild(tr3);\n        div.appendChild(table2);\n        var divBtn = document.createElement('div');\n        this.target.appendChild(div);\n        this.target.appendChild(divBtn);\n        this.cellSpaceTextBox = new NumericTextBox({\n            value: 0, min: 0, max: 264.5, width: 150,\n            decimals: 2, enablePersistence: false\n        });\n        this.cellSpaceTextBox.appendTo(this.cellspacingTextBox);\n        this.allowSpaceCheckBox = new CheckBox({\n            label: localValue.getConstant('Allow spacing between cells'),\n            change: this.changeAllowSpaceCheckBox,\n            cssClass: 'e-de-tbl-margin-sub-header',\n        });\n        this.allowSpaceCheckBox.appendTo(allowSpaceCheckBox);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.loadCellMarginsDialog = function () {\n        var tableFormat = this.owner.selection.tableFormat;\n        this.cellSpaceTextBox.value = tableFormat.cellSpacing;\n        this.bottomMarginBox.value = tableFormat.bottomMargin;\n        this.topMarginBox.value = tableFormat.topMargin;\n        this.rightMarginBox.value = tableFormat.rightMargin;\n        this.leftMarginBox.value = tableFormat.leftMargin;\n        if (tableFormat.cellSpacing > 0) {\n            this.allowSpaceCheckBox.checked = true;\n            this.cellSpaceTextBox.enabled = true;\n        }\n        else {\n            this.allowSpaceCheckBox.checked = false;\n            this.cellSpaceTextBox.enabled = false;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applySubTableOptions = function (tableFormat) {\n        this.owner.owner.editorHistory.initComplexHistory(this.owner.selection, 'TableMarginsSelection');\n        this.applyTableOptionsHistory(tableFormat);\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptionsHelper = function (tableFormat) {\n        this.applySubTableOptionsHelper(tableFormat);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptionsHistory = function (tableFormat) {\n        this.owner.owner.editorModule.initHistory('TableOptions');\n        this.applySubTableOptionsHelper(tableFormat);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applySubTableOptionsHelper = function (tableFormat) {\n        var ownerTable = this.owner.selection.start.currentWidget.paragraph.associatedCell.ownerTable;\n        ownerTable = ownerTable.combineWidget(this.owner);\n        var currentTableFormat = ownerTable.tableFormat;\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentBaseHistoryInfo)) {\n            this.owner.owner.editorHistory.currentBaseHistoryInfo.addModifiedTableOptions(currentTableFormat);\n        }\n        currentTableFormat.cellSpacing = tableFormat.cellSpacing;\n        currentTableFormat.leftMargin = tableFormat.leftMargin;\n        currentTableFormat.topMargin = tableFormat.topMargin;\n        currentTableFormat.rightMargin = tableFormat.rightMargin;\n        currentTableFormat.bottomMargin = tableFormat.bottomMargin;\n        this.owner.owner.tablePropertiesDialogModule.calculateGridValue(ownerTable);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptions = function (tableFormat) {\n        tableFormat.leftMargin = this.leftMarginBox.value;\n        tableFormat.topMargin = this.topMarginBox.value;\n        tableFormat.bottomMargin = this.bottomMarginBox.value;\n        tableFormat.rightMargin = this.rightMarginBox.value;\n        if (this.allowSpaceCheckBox.checked) {\n            tableFormat.cellSpacing = this.cellSpaceTextBox.value;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.show = function () {\n        var documentLocale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        documentLocale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableOptionsDialog(documentLocale);\n        }\n        this.loadCellMarginsDialog();\n        this.owner.dialog.header = documentLocale.getConstant('Table Options');\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = undefined;\n        this.owner.dialog.position = { X: 'center', Y: 'center' };\n        //  this.owner.dialog.cssClass = 'e-de-table-margin-size';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.open = undefined;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.removeEvents;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableCellProperties,\n                buttonModel: { content: documentLocale.getConstant('Ok'), cssClass: 'e-flat e-table-cell-okay', isPrimary: true }\n            },\n            {\n                click: this.closeCellMarginsDialog,\n                buttonModel: { content: documentLocale.getConstant('Cancel'), cssClass: 'e-flat e-table-cell-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var p = 0; p < this.target.childNodes.length; p++) {\n                this.target.removeChild(this.target.childNodes[p]);\n                p--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.owner = undefined;\n        this.cellspacingTextBox = undefined;\n        this.allowSpaceCheckBox = undefined;\n    };\n    return TableOptionsDialog;\n}());\nexport { TableOptionsDialog };\n","import { CheckBox } from '@syncfusion/ej2-buttons';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WCellFormat } from '../index';\nimport { isNullOrUndefined, L10n, createElement, setCulture } from '@syncfusion/ej2-base';\n/**\n * The Cell options dialog is used to modify margins of selected cells.\n */\nvar CellOptionsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function CellOptionsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.removeEvents = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeSameAsTable = function () {\n            if (_this.sameAsTableCheckBox.checked) {\n                _this.leftMarginBox.enabled = false;\n                _this.rightMarginBox.enabled = false;\n                _this.bottomMarginBox.enabled = false;\n                _this.topMarginBox.enabled = false;\n            }\n            else {\n                _this.leftMarginBox.enabled = true;\n                _this.rightMarginBox.enabled = true;\n                _this.bottomMarginBox.enabled = true;\n                _this.topMarginBox.enabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyTableCellProperties = function () {\n            var cellFormat = _this.owner.selection.cellFormat;\n            if (!isNullOrUndefined(_this.bottomMarginBox.value || _this.leftMarginBox.value\n                || _this.rightMarginBox.value || _this.topMarginBox.value) &&\n                (cellFormat.bottomMargin !== _this.bottomMarginBox.value || cellFormat.leftMargin !== _this.leftMarginBox.value\n                    || cellFormat.rightMargin !== _this.rightMarginBox.value || cellFormat.topMargin !== _this.topMarginBox.value)) {\n                _this.owner.owner.tablePropertiesDialogModule.isCellOptionsUpdated = true;\n                _this.applyTableOptions(_this.cellFormat);\n                _this.owner.owner.tablePropertiesDialogModule.applyTableSubProperties();\n            }\n            _this.closeCellMarginsDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeCellMarginsDialog = function () {\n            _this.owner.dialog.hide();\n            _this.owner.dialog.element.style.pointerEvents = '';\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(CellOptionsDialog.prototype, \"cellFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.cellFormatIn)) {\n                return this.cellFormatIn = new WCellFormat();\n            }\n            return this.cellFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.getModuleName = function () {\n        return 'CellOptionsDialog';\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.initCellMarginsDialog = function (localValue) {\n        var instance = this.owner;\n        this.target = createElement('div', {\n            id: this.owner.owner.containerId + '_tableCellMarginsDialog', className: 'e-de-table-cell-margin-dlg'\n        });\n        this.owner.owner.element.appendChild(this.target);\n        var innerDiv = createElement('div', { styles: 'width: 475px;position: relative;height: 165px;' });\n        var innerDivLabel = createElement('Label', {\n            className: 'e-de-cell-dia-options-label', id: this.target.id + '_innerDivLabel'\n        });\n        innerDivLabel.innerHTML = localValue.getConstant('Cell margins');\n        innerDiv.appendChild(innerDivLabel);\n        var table = createElement('TABLE', {\n            styles: 'height: 40px;padding-bottom: 0px;', className: 'e-de-cell-margin-top'\n        });\n        var tr = createElement('tr');\n        var td = createElement('td', { className: 'e-de-tbl-btn-seperator' });\n        var sameAsTableCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_sameAsCheckBox'\n        });\n        td.appendChild(sameAsTableCheckBox);\n        tr.appendChild(td);\n        table.appendChild(tr);\n        innerDiv.appendChild(table);\n        CellOptionsDialog.getCellMarginDialogElements(this, innerDiv, localValue);\n        var divBtn = document.createElement('div');\n        this.target.appendChild(divBtn);\n        this.sameAsTableCheckBox = new CheckBox({\n            label: localValue.getConstant('Same as the whole table'),\n            change: this.changeSameAsTable\n        });\n        this.sameAsTableCheckBox.appendTo(sameAsTableCheckBox);\n        this.sameAsTableCheckBox.addEventListener('change', this.changeSameAsTable);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.show = function () {\n        var localizeValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localizeValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initCellMarginsDialog(localizeValue);\n        }\n        this.loadCellMarginsDialog();\n        this.owner.dialog.header = localizeValue.getConstant('Cell Options');\n        this.owner.dialog.position = { X: 'center', Y: 'top' };\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = undefined;\n        this.owner.dialog.open = undefined;\n        this.owner.dialog.close = this.removeEvents;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableCellProperties,\n                buttonModel: { content: localizeValue.getConstant('Ok'), cssClass: 'e-flat e-table-cell-margin-okay', isPrimary: true }\n            },\n            {\n                click: this.closeCellMarginsDialog,\n                buttonModel: { content: localizeValue.getConstant('Cancel'), cssClass: 'e-flat e-table-cell-margin-cancel' }\n            }];\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.loadCellMarginsDialog = function () {\n        var cellFormat = this.owner.selection.cellFormat;\n        this.sameAsTable = isNullOrUndefined(cellFormat.leftMargin || cellFormat.topMargin\n            || cellFormat.rightMargin || cellFormat.bottomMargin);\n        if (this.sameAsTable) {\n            var tableFormat = this.owner.selection.tableFormat;\n            this.loadCellProperties(tableFormat, false, true);\n        }\n        else {\n            this.loadCellProperties(cellFormat, true, false);\n        }\n    };\n    CellOptionsDialog.prototype.loadCellProperties = function (format, enableTextBox, enableCheckBox) {\n        this.leftMarginBox.value = format.leftMargin;\n        this.rightMarginBox.value = format.rightMargin;\n        this.topMarginBox.value = format.topMargin;\n        this.bottomMarginBox.value = format.bottomMargin;\n        this.leftMarginBox.enabled = enableTextBox;\n        this.rightMarginBox.enabled = enableTextBox;\n        this.topMarginBox.enabled = enableTextBox;\n        this.bottomMarginBox.enabled = enableTextBox;\n        this.sameAsTableCheckBox.checked = enableCheckBox;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applySubCellOptions = function (cellFormat) {\n        this.owner.owner.editorHistory.initComplexHistory(this.owner.selection, 'CellMarginsSelection');\n        this.owner.owner.editorModule.initHistory('CellOptions');\n        /* tslint:disable:max-line-length */\n        var startTable = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        startTable = startTable.combineWidget(this.owner);\n        this.applyCellmarginsValue(this.owner.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.owner), this.owner.selection.start, this.owner.selection.end, cellFormat);\n        this.owner.owner.editorModule.reLayout(this.owner.selection, false);\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyCellmarginsValue = function (row, start, end, cellFormat) {\n        this.applyCellMarginsInternal(row, cellFormat);\n        if (end.paragraph.associatedCell.ownerRow === row) {\n            return;\n        }\n        var newRow = row.nextWidget;\n        if (!isNullOrUndefined(newRow)) {\n            this.applyCellmarginsValue(newRow, start, end, cellFormat);\n        }\n    };\n    CellOptionsDialog.prototype.applyCellMarginsInternal = function (row, cellFormat) {\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentBaseHistoryInfo)) {\n            var currentFormat = row.childWidgets[0].cellFormat;\n            /* tslint:disable:max-line-length */\n            cellFormat = this.owner.owner.editorHistory.currentBaseHistoryInfo.addModifiedCellOptions(currentFormat, cellFormat, row.ownerTable);\n        }\n        if (!isNullOrUndefined(cellFormat)) {\n            this.applyCellMarginsForCells(row, cellFormat);\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyCellMarginsForCells = function (row, cellFormat) {\n        var rowCells = row.childWidgets;\n        this.iterateCells(rowCells, cellFormat);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.iterateCells = function (cells, cellFormat) {\n        for (var i = 0; i < cells.length; i++) {\n            this.applySubCellMargins(cells[i].cellFormat, cellFormat);\n        }\n        this.owner.owner.tablePropertiesDialogModule.calculateGridValue(cells[0].ownerTable);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applySubCellMargins = function (sourceFormat, cellFormat) {\n        sourceFormat.leftMargin = cellFormat.leftMargin;\n        sourceFormat.topMargin = cellFormat.topMargin;\n        sourceFormat.rightMargin = cellFormat.rightMargin;\n        sourceFormat.bottomMargin = cellFormat.bottomMargin;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyTableOptions = function (cellFormat) {\n        if (!this.sameAsTableCheckBox.checked) {\n            cellFormat.leftMargin = this.leftMarginBox.value;\n            cellFormat.topMargin = this.topMarginBox.value;\n            cellFormat.bottomMargin = this.bottomMarginBox.value;\n            cellFormat.rightMargin = this.rightMarginBox.value;\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var y = 0; y < this.target.childNodes.length; y++) {\n                this.target.removeChild(this.target.childNodes[y]);\n                y--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.owner = undefined;\n        this.sameAsTableCheckBox = undefined;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.getCellMarginDialogElements = function (dialog, div, locale) {\n        if (!isNullOrUndefined(dialog)) {\n            var table = createElement('TABLE', { className: 'e-de-cell-margin-top' });\n            var tr1 = createElement('tr', { styles: 'height: 50px;color:black;' });\n            var td1 = createElement('td');\n            var topLabel = createElement('label', {\n                innerHTML: locale.getConstant('Top'), className: 'e-de-cell-dia-label-common',\n                id: dialog.target.id + '_TopLabel'\n            });\n            var topTextBox = createElement('input', {\n                attrs: { 'type': 'text' }, styles: 'width:100%', id: dialog.target.id + '_Top'\n            });\n            td1.appendChild(topLabel);\n            td1.appendChild(topTextBox);\n            var td2 = createElement('td', { className: 'e-de-tbl-btn-seperator' });\n            var leftLabel = createElement('label', {\n                innerHTML: locale.getConstant('Left'), className: 'e-de-cell-dia-label-common',\n                id: dialog.target.id + '_leftLabel'\n            });\n            var leftTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_left'\n            });\n            td2.appendChild(leftLabel);\n            td2.appendChild(leftTextBox);\n            tr1.appendChild(td1);\n            tr1.appendChild(td2);\n            var tr2 = createElement('tr', { styles: 'height: 50px;color:black;' });\n            var td3 = createElement('td', { styles: 'width:40%;' });\n            var bottomLabel = createElement('label', {\n                innerHTML: locale.getConstant('Bottom'),\n                className: 'e-de-cell-dia-label-common', id: dialog.target.id + '_bottomLabel'\n            });\n            var bottomTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_bottom'\n            });\n            td3.appendChild(bottomLabel);\n            td3.appendChild(bottomTextBox);\n            var td4 = createElement('td', { styles: 'width:40%;' });\n            var rightLabel = createElement('label', {\n                innerHTML: locale.getConstant('Right'), id: dialog.target.id + '_rightLabel',\n                className: 'e-de-cell-dia-label-common'\n            });\n            var rightTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_right'\n            });\n            td4.appendChild(rightLabel);\n            td4.appendChild(rightTextBox);\n            tr2.appendChild(td3);\n            tr2.appendChild(td4);\n            table.appendChild(tr1);\n            table.appendChild(tr2);\n            div.appendChild(table);\n            dialog.target.appendChild(div);\n            dialog.topMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150, decimals: 2,\n                enablePersistence: false\n            });\n            dialog.topMarginBox.appendTo(topTextBox);\n            dialog.leftMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150,\n                decimals: 2, enablePersistence: false\n            });\n            dialog.leftMarginBox.appendTo(leftTextBox);\n            dialog.bottomMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150, decimals: 2,\n                enablePersistence: false\n            });\n            dialog.bottomMarginBox.appendTo(bottomTextBox);\n            dialog.rightMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150,\n                decimals: 2, enablePersistence: false\n            });\n            dialog.rightMarginBox.appendTo(rightTextBox);\n        }\n    };\n    return CellOptionsDialog;\n}());\nexport { CellOptionsDialog };\n","import { ListView } from '@syncfusion/ej2-lists';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\n/**\n * The Styles dialog is used to create or modify styles.\n */\nvar StylesDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function StylesDialog(viewer) {\n        var _this = this;\n        this.updateStyleNames = function () {\n            var collection = _this.owner.owner.viewer.styles.getStyleNames('Paragraph');\n            var defaultStyleNames = ['Normal', 'Heading 1', 'Heading 2', 'Heading 3', 'Heading 4', 'Heading 5', 'Heading 6'];\n            var finalList = collection.concat(defaultStyleNames).filter(function (v, i, a) { return a.indexOf(v) === i; });\n            return finalList;\n        };\n        this.modifyStyles = function () {\n            _this.owner.dialog.hide();\n            _this.owner.owner.styleDialogModule.show(_this.styleName, _this.localValue.getConstant('Modify Style'));\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.styleName = args.text;\n        };\n        this.addNewStyles = function () {\n            _this.owner.dialog.hide();\n            _this.owner.owner.styleDialogModule.show();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    StylesDialog.prototype.getModuleName = function () {\n        return 'StylesDialog';\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.initStylesDialog = function (localValue, styles) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_styles';\n        this.target = createElement('div', { id: id, className: 'e-de-styles' });\n        var headerValue = localValue.getConstant('Styles');\n        var dlgFields = createElement('div', { innerHTML: headerValue, className: 'e-styles-dlgfields' });\n        this.target.appendChild(dlgFields);\n        var commonDiv = createElement('div', { className: 'e-styles-common' });\n        this.target.appendChild(commonDiv);\n        var searchDiv = createElement('div', { className: 'e-styles-list' });\n        commonDiv.appendChild(searchDiv);\n        var listviewDiv = createElement('div', { className: 'e-styles-listViewDiv', id: 'styles_listview' });\n        searchDiv.appendChild(listviewDiv);\n        this.listviewInstance = new ListView({\n            dataSource: styles,\n            cssClass: 'e-styles-listview',\n        });\n        this.listviewInstance.appendTo(listviewDiv);\n        this.listviewInstance.addEventListener('select', this.selectHandler);\n        var buttonDiv = createElement('div', { className: 'e-styles-button' });\n        commonDiv.appendChild(buttonDiv);\n        var newButtonDiv = createElement('div', { className: 'e-styles-addbutton' });\n        buttonDiv.appendChild(newButtonDiv);\n        var newButtonElement = createElement('button', { innerHTML: localValue.getConstant('New'), id: 'new' });\n        newButtonDiv.appendChild(newButtonElement);\n        var newbutton = new Button({ cssClass: 'e-button-custom' });\n        newbutton.appendTo(newButtonElement);\n        newButtonElement.addEventListener('click', this.addNewStyles);\n        var modifybuttonDiv = createElement('div', { className: 'e-styles-addbutton' });\n        buttonDiv.appendChild(modifybuttonDiv);\n        var modifyButtonElement = createElement('button', { innerHTML: localValue.getConstant('Modify'), id: 'modify' });\n        modifybuttonDiv.appendChild(modifyButtonElement);\n        var addbutton = new Button({ cssClass: 'e-button-custom' });\n        addbutton.appendTo(modifyButtonElement);\n        modifyButtonElement.addEventListener('click', this.modifyStyles);\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.show = function () {\n        var styles = this.updateStyleNames();\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        this.localValue = localValue;\n        this.initStylesDialog(localValue, styles);\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.header = 'Styles';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.hideObjects.bind(this),\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    StylesDialog.prototype.hideObjects = function () {\n        this.owner.dialog.hide();\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.destroy = function () {\n        if (this.listviewInstance) {\n            this.listviewInstance.destroy();\n            this.listviewInstance = undefined;\n        }\n    };\n    return StylesDialog;\n}());\nexport { StylesDialog };\n"],"names":["Dictionary","this","keysInternal","valuesInternal","item","Object","defineProperty","prototype","get","length","enumerable","configurable","getItem","i","push","add","key","value","isNullOrUndefined","ReferenceError","indexOf","index","RangeError","set","remove","splice","containsKey","clear","destroy","undefined","WUniqueFormat","type","referenceCount","uniqueFormatType","propertiesHash","isEqual","source","property","modifiedValue","isBorderEqual","isCharacterFormatEqual","isParagraphFormatEqual","isCellFormatEqual","isShadingEqual","isRowFormatEqual","isListFormatEqual","isTableFormatEqual","isListLevelEqual","isSectionFormatEqual","isNotEqual","modifiedProperty","targetValue","propertyType","getPropertyType","sourceValue","getBorderPropertyType","getCharacterFormatPropertyType","getParaFormatPropertyType","getCellFormatPropertyType","getShadingPropertyType","getRowFormatType","getListFormatType","getTableFormatType","getListLevelType","getSectionFormatType","cloneItems","format","keys","mergeProperties","hash","cloneProperties","WUniqueFormats","items","addUniqueFormat","matchedFormat","updateUniqueFormat","uniqueFormat","__extends","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","create","__decorate","decorators","target","desc","c","arguments","r","getOwnPropertyDescriptor","Reflect","decorate","DocumentEditor","_super","options","element","_this","call","enableHeaderFooterIn","isShiftingEnabled","isLayoutEnabled","isPastingContent","parser","disableHistoryIn","findResultsList","documentName","tablePropertiesDialogModule","bordersAndShadingDialogModule","cellOptionsDialogModule","tableOptionsDialogModule","paragraphDialogModule","imageResizerModule","useCtrlClickToFollowHyperlink","pageOutline","enableCursorOnReadOnly","enableLocalPaste","defaultLocale","Table","Row","Cell","Ok","Cancel","Size","Preferred Width","Points","Percent","Measure in","Alignment","Left","Center","Right","Justify","Indent from left","Borders and Shading","Options","Specify height","At least","Exactly","Row height is","Allow row to break across pages","Repeat as header row at the top of each page","Vertical alignment","Top","Bottom","Default cell margins","Default cell spacing","Allow spacing between cells","Cell margins","Same as the whole table","Borders","None","Single","Dot","DashSmallGap","DashLargeGap","DashDot","DashDotDot","Double","Triple","ThinThickSmallGap","ThickThinSmallGap","ThinThickThinSmallGap","ThinThickMediumGap","ThickThinMediumGap","ThinThickThinMediumGap","ThinThickLargeGap","ThickThinLargeGap","ThinThickThinLargeGap","SingleWavy","DoubleWavy","DashDotStroked","Emboss3D","Engrave3D","Outset","Inset","Thick","Style","Width","Height","Letter","Tabloid","Legal","Statement","Executive","A3","A4","A5","B4","B5","Custom Size","Different odd and even","Different first page","From edge","Header","Footer","Margin","Paper","Layout","Orientation","Landscape","Portrait","Table Of Contents","Show page numbers","Right align page numbers","Nothing","Tab leader","Show levels","Use hyperlinks instead of page numbers","Build table of contents from","Styles","Available styles","TOC level","Heading","List Paragraph","Normal","Outline levels","Table entry fields","Modify","Color","Setting","Box","All","Custom","Preview","Shading","Fill","Apply To","Table Properties","Cell Options","Table Options","Insert Table","Number of columns","Number of rows","Text to display","Address","Insert Hyperlink","Edit Hyperlink","Insert","General","Indentation","Before text","Special","First line","Hanging","After text","By","Before","Line Spacing","After","At","Multiple","Spacing","Define new Multilevel list","List level","Choose level to modify","Level","Number format","Number style for this level","Enter formatting for number","Start at","Restart list after","Position","Text indent at","Aligned at","Follow number with","Tab character","Space","Arabic","UpRoman","LowRoman","UpLetter","LowLetter","Number","Leading zero","Bullet","Ordinal","Ordinal Text","For East","No Restart","Font","Font style","Underline style","Font color","Effects","Strikethrough","Superscript","Subscript","Double strikethrough","Regular","Bold","Italic","Cut","Copy","Paste","Hyperlink","Open Hyperlink","Copy Hyperlink","Remove Hyperlink","Paragraph","Merge Cells","Insert Above","Insert Below","Insert Left","Insert Right","Delete","Delete Table","Delete Row","Delete Column","File Name","Format Type","Save","Navigation","Results","Replace","Replace All","We replaced all","Find","No matches","All Done","Result","of","instances","with","Click to follow link","Continue Numbering","Bookmark name","Close","Restart At","Properties","Name","Style type","Style based on","Style for following paragraph","Formatting","Numbering and Bullets","Numbering","Update Field","Edit Field","Bookmark","Page Setup","No bookmarks found","Number format tooltip information","Format","Create New Style","Modify Style","New","Bullets","Use bookmarks","Table of Contents","viewer","PageLayoutViewer","SfdtReader","DocumentEditor_1","updateScrollBars","isDocumentLoaded","pages","selectionModule","editorModule","editorHistoryModule","searchModule","contextMenuModule","id","isDocumentLoadedIn","enableEditorHistory","selection","getDocumentStart","getDocumentEnd","isReadOnly","enableImageResizer","preRender","render","initializeComponents","openBlank","container","style","minHeight","minWidth","getModuleName","onPropertyChanged","model","oldProp","_i","_a","zoomFactor","localizeDialogs","optionsPaneModule","isOptionsPaneShow","showHideOptionsPane","locale","l10n","L10n","setLocale","setCulture","initOptionsPane","initParagraphDialog","pageSetupDialogModule","initPageSetupDialog","fontDialogModule","initFontDialog","hyperlinkDialogModule","initHyperlinkDialog","initContextMenu","listDialogModule","initListDialog","initTablePropertyDialog","initBordersAndShadingsDialog","initCellMarginsDialog","initTableOptionsDialog","tableDialogModule","initTableDialog","styleDialogModule","initStyleDialog","tableOfContentsDialogModule","initTableOfContentDialog","getPersistData","clearPreservedCollectionsInViewer","LayoutViewer","clearDocumentItems","getDocumentEditorElement","fireContentChange","eventArgs","trigger","fireDocumentChange","fireSelectionChange","isCompositionStart","Browser","isDevice","predictText","fireZoomFactorChange","fireViewChange","visiblePages","startPage","endPage","showParagraphDialog","paragraphFormat","isReadOnlyMode","show","showPageSetupDialog","showFontDialog","characterFormat","showCellOptionsDialog","showTableOptionsDialog","showTableDialog","showTableOfContentsDialog","showStyleDialog","showHyperlinkDialog","showBookmarkDialog","bookmarkDialogModule","showStylesDialog","stylesDialogModule","showListDialog","showTablePropertiesDialog","showBordersAndShadingDialog","requiredModules","modules","enablePrint","member","args","enableSfdtExport","enableWordExport","enableTextExport","enableSelection","enableEditor","enableSearch","enableContextMenu","enableOptionsPane","enableHyperlinkDialog","enableTableDialog","enableBookmarkDialog","enableTableOfContentsDialog","enablePageSetupDialog","enableStyleDialog","enableListDialog","enableParagraphDialog","enableFontDialog","enableTablePropertiesDialog","enableBordersAndShadingDialog","enableTableOptionsDialog","open","sfdtText","lists","abstractLists","styles","WStyles","onDocumentChanged","convertJsonToDocument","intializeDefaultStyles","scrollToPage","pageNumber","enableAllModules","Inject","Print","SfdtExport","WordExport","TextExport","Selection","Search","Editor","ImageResizer","EditorHistory","ContextMenu","OptionsPane","HyperlinkDialog","TableDialog","BookmarkDialog","TableOfContentsDialog","PageSetupDialog","StyleDialog","ListDialog","ParagraphDialog","BulletsAndNumberingDialog","FontDialog","TablePropertiesDialog","BordersAndShadingDialog","TableOptionsDialog","CellOptionsDialog","StylesDialog","resize","width","height","updateViewerSize","focusIn","updateFocus","fitPage","pageFitType","print","printWindow","Error","printModule","serialize","sfdtExportModule","save","fileName","formatType","wordExportModule","textExportModule","jsonString","blob","Blob","saveAsBlob","Promise","resolve","reject","section","BodyWidget","sectionFormat","WSectionFormat","paragraph","ParagraphWidget","WParagraphFormat","WCharacterFormat","childWidgets","containerWidget","sections","hfs","parseHeaderFooter","header","footer","evenHeader","evenFooter","firstPageHeader","firstPageFooter","headersFooters","findByName","baseStyle","listFormat","getStyleNames","styleType","getStyles","showDialog","dialogType","showOptionsPane","destroyDependentModules","classList","innerHTML","Property","Event","NotifyPropertyChanges","Component","navigator","userAgent","browserUserAgent","getPageHeight","getPageWidth","printElement","document","createElement","overflow","generatePrintContent","window","write","toString","close","focus","interval","setInterval","ready","clearInterval","htmlString","page","pageHeight","boundingRectangle","pageWidth","isPrinting","renderWidgets","canvasURL","pageCanvas","toDataURL","node","uniqueSectionFormat","ownerBase","getPropertyValue","setPropertyValue","uniqueSectionFormats","hasValue","getPropertyDefaultValue","initializeUniqueSectionFormat","propValue","uniqueSectionFormatTemp","addUniqueSectionFormat","copyFormat","history","isUndoing","isRedoing","updateUniqueSectionFormat","cloneFormat","WLevelOverride","overrideListLevel","levelNumber","startAt","WList","listId","sourceListId","abstractListId","abstractList","levelOverrides","getListLevel","levelOverride","getLevelOverride","levels","mergeList","list","WListFormat","uniqueListFormat","baseListStyle","basedOn","listLevelNumber","WParagraphStyle","initializeUniqueListFormat","uniqueListFormats","uniqueListFormatTemp","addUniqueListFormat","clearFormat","ApplyStyle","getValue","mergeFormat","WTabStop","positionIn","deletePositionIn","justification","leader","position","deletePosition","tabJustification","uniqueParagraphFormat","tabs","getUpdatedTabs","inTabs","tabStops","tab","_b","_c","hasTabStop","concat","filter","a","sort","getListFormatParagraphFormat","level","listLevel","ifListFormat","getDefaultValue","docParagraphFormat","documentParagraphFormat","bodyWidget","initializeUniqueParagraphFormat","uniqueParagraphFormats","uniqueParaFormatTemp","addUniqueParaFormat","updateUniqueParagraphFormat","leftIndent","rightIndent","firstLineIndent","beforeSpacing","afterSpacing","lineSpacing","lineSpacingType","textAlignment","outlineLevel","uniqueCharacterFormat","baseCharStyle","charStyleValue","checkCharacterStyle","baseStyleValue","checkBaseStyle","docCharacterFormat","documentCharacterFormat","name","returnPropertyType","initializeUniqueCharacterFormat","uniqueCharacterFormats","uniqueCharFormatTemp","addUniqueCharacterFormat","isEqualFormat","fontSize","fontFamily","bold","italic","baselineAlignment","underline","fontColor","strikethrough","highlightColor","isSameFormat","updateUniqueCharacterFormat","HelperMethods","insert","spanText","text","slice","join","substring","indexOfAny","wordSplitCharacter","j","temp","lastIndexOfAny","addCssStyle","css","cssText","appendChild","createTextNode","getElementsByTagName","getHighlightColorCode","color","convertPointToPixel","point","round","convertPixelToPoint","pixel","isLinkedFieldCharacter","inline","FieldElementBox","fieldType","fieldEnd","fieldBegin","removeSpace","charAt","replace","trimStart","trimEnd","endsWith","writeCharacterFormat","isInline","styleName","decimalDigits","Math","wordBefore","wordAfter","wordSplitCharacters","Point","xPosition","yPosition","xIn","yIn","copy","WStyle","copyStyle","paraStyle","next","link","WCharacterStyle","charStyle","collection","contains","pop","returnStyle","map","styleObjects","styles_1","returnStyleObject","JSON","stringify","WBorder","uniqueBorderFormat","initializeUniqueBorder","uniqueBorderFormats","uniqueBorderFormatTemp","addUniqueBorderFormat","getLineWidth","lineStyle","lineArray","getBorderLineWidthArray","lineWidth","borderLineArray","abs","getBorderWeight","weight","numberOfLines","getNumberOfLines","borderNumber","getBorderNumber","getPrecedence","border","shadow","space","WBorders","leftIn","rightIn","topIn","bottomIn","horizontalIn","verticalIn","diagonalUpIn","diagonalDownIn","lineWidthIn","left","top","bottom","right","horizontal","vertical","diagonalDown","diagonalUp","valueIn","borders","WShading","uniqueShadingFormat","initializeUniqueShading","uniqueShadingFormats","uniqueShadingTemp","addUniqueShading","shading","backgroundColor","foregroundColor","textureStyle","WTableFormat","owner","uniqueTableFormat","assignTableMarginValue","initializeUniqueTableFormat","uniqueTableFormats","uniqueTableFormatTemp","addUniqueTableFormat","leftMargin","topMargin","rightMargin","bottomMargin","initializeTableBorders","tableFormat","tableAlignment","cellSpacing","preferredWidth","preferredWidthType","WRowFormat","uniqueRowFormat","beforeWidth","afterWidth","heightType","initializeUniqueRowFormat","uniqueRowFormats","uniqueRowFormatTemp","addUniqueRowFormat","allowBreakAcrossPages","isHeader","gridBefore","gridBeforeWidth","gridBeforeWidthType","gridAfter","gridAfterWidth","gridAfterWidthType","WCellFormat","uniqueCellFormat","initializeUniqueCellFormat","uniqueCellFormats","uniqueCellFormatTemp","addUniqueCellFormat","containsMargins","verticalAlignment","cellWidth","columnSpan","rowSpan","Rect","x","y","clone","Widget","bodyWidgets","widget","indexInOwner","previousPage","previousContainer","TableCellWidget","getPreviousSplitWidget","TableRowWidget","HeaderFooterWidget","previousRenderedWidget","lastChild","nextPage","nextContainer","getNextSplitWidget","nextRenderedWidget","firstChild","previous","equals","BlockWidget","getPreviousSplitWidgets","widgets","previousSplitWidget","unshift","getSplitWidgets","nextSplitWidget","combineWidget","root","shift","splitWidget","combine","TableWidget","combineRows","addWidgets","destroyInternal","LineWidget","removeChild","child","margin","BlockContainer","apply","sectionFormatIn","getHierarchicalIndex","hierarchicalIndex","headerFooterType","getTableCellWidget","touchPoint","tableCellWidget","n","chilgWidget","headerWidget","footerWidget","headerFooter","block","blockAdv","isPageBreak","children","getIndex","ownerTable","ownerRow","getContainerWidth","isInsideTable","associatedCell","cellFormat","isEndsWithPageBreak","isEmpty","inlineElement","TextElementBox","ImageElementBox","BookmarkElementBox","getInline","offset","indexInInline","count","isStarted","splittedWidget","k","line","ListTextElementBox","getLength","cloneLine","flags","leftBorderWidth","rightBorderWidth","topBorderWidth","bottomBorderWidth","tableHolder","WTableHolder","spannedRowCollection","row","combineCells","tableCell","getOwnerWidth","isBasedOnViewer","getTableWidth","rowWidth","getTableClientWidth","clientWidth","tableWidth","getCellWidth","containerWidth","cell","getMinimumPreferredWidth","fitCellsToClientArea","factor","rowFormat","calculateGrid","tempGrid","spannedCells","tableCellInfo","rowCellInfo","currOffset","startOffset","columnIndex","removeSpannedCell","rowIndex","m","cellIndex","columns","updateColumnSpans","getGridCount","buildTableColumns","isGridUpdated","resetColumns","rowSpannedCells","isAutoWidth","addColumns","rowSpannedCell","minWidth_1","ownerColumn","validateColumnWidths","fitColumns","setWidthToCells","rw","getMaxRowWidth","updateWidth","dragValue","totalPreferredWidth","getTotalWidth","convertPointToPercent","tablePreferredWidth","ownerWidth","table","getTableOf","getRowOf","fitChildToClientArea","getColumnCellsForSelection","startCell","endCell","cells","start","end","splitWidthToTableCells","tableClientWidth","splitWidthToRowCells","insertTableRowsInternal","tableRows","startIndex","updateRowIndex","getCellStartOffset","tableGrids","headerHeight","description","title","getCellOf","getCell","tableGrid","prevOffset","gridStartIndex","getOffsetIndex","getCellOffset","updateRowBySpannedCells","getPreviousRowSpannedCells","currentRowIndex","spannedCell","include","previousWidget","cellWidget","getContainerTable","previousCell","nextCell","cellPreferredWidth","getCellLeftBorder","leftBorder","cellBorder","rowBorders","tableBorders","getLeftBorderToRenderByHierarchy","prevCell","previousRow","prevRowCell","getPreviousCellLeftBorder","getLeftBorderWidth","getRightBorderWidth","getCellSpacing","actualCellSpacing","hasNoneStyle","prevCellRightBorder","getBorderBasedOnPriority","adjacentBorder","borderWeight","adjacentBorderWeight","borderPriority","adjacentBorderPriority","borderColInRGB","convertHexToRGB","R1","G1","g","B1","adjacentBorderColInRGB","R2","G2","B2","borderBrightness","adjacentBorderBrightness","getCellRightBorder","rightBorder","getRightBorderToRenderByHierarchy","nextWidget","getAdjacentCellRightBorder","nextCellLeftBorder","getCellTopBorder","topBorder","getTopBorderToRenderByHierarchy","prevTopCell","prevRow","getPreviousCellTopBorder","previousTopCell","prevTopCellBottomBorder","getCellBottomBorder","bottomBorder","getBottomBorderToRenderByHierarchy","nextBottomCell","nextRow","getAdjacentCellBottomBorder","prevBottomCellTopBorder","colorCode","colCodeNo","parseInt","paragraphWidget","lineIndex","splitParagraph","lastElement","isFirstLine","isLastLine","getOffset","textIndex","getEndOffset","previousLine","elementBox","ElementBox","linkFieldCharacter","linkFieldTraversingForward","fields","fieldSeparator","linkFieldTraversingBackwardSeparator","isFieldEnd","linkFieldTraversingBackward","previousNode","childNode","prevParagraph","nextLine","childElement","lineWidget","objectCharacter","String","fromCharCode","hasFieldEnd","fieldBeginInternal","fieldSeparatorInternal","fieldEndInternal","field","baselineOffset","span","FieldTextElementBox","fieldText","TabElementBox","tabText","tabLeader","bookmarkTypeIn","refereneceIn","nameIn","reference","bookmarkType","isInlineImage","imageStr","imgElement","isInlineImageIn","isMetaFile","src","image","imageString","isListFollowCharacter","isFollowCharacter","Page","repeatHeaderRowTableWidget","editor","removeFieldInWidget","removePage","tableColumns","getPreviousSpannedCellWidth","previousColumnIndex","curColumnIndex","currentColumnIndex","WColumn","availableWidth","endOffset","isFitColumns","preferredTableWidth","totalColumnWidth","isNaN","column","maxWidth","contextMenuInstance","onContextMenuInternal","event","showHideElements","preventDefault","localValue","contextMenu","containerId","body","ul","listStyle","padding","maxHeight","oncontextmenu","disableBrowserContextmenu","menuItems","getConstant","iconCss","separator","menuOptions","select","handleContextMenuItem","Menu","beforeOpen","caret","showCaret","onClose","cut","pasteInternal","updateToc","navigateHyperlink","copyHyperlink","removeHyperlink","mergeCells","insertRow","insertColumn","deleteTable","deleteRow","deleteColumn","applyContinueNumbering","applyRestartNumbering","getElementById","paste","updateField","editField","font","tableProperties","insertTable","hyperlink","openHyperlink","editHyperlink","continueNumbering","restartAt","display","nextSibling","hideToolTip","copiedData","contextType","listLevelPattern","isCellSelected","getHyperlinkField","isImageField","canMergeCells","previousSibling","parentElement","WAbstractList","abstractListIdIn","WListLevel","uniqueListLevel","followCharacter","numberFormat","restartLevel","initializeUniqueWListLevel","uniqueListLevels","uniqueListLevelTemp","addUniqueWListLevel","dotBullet","squareBullet","arrowBullet","circleBullet","allowLayout","isInitialLoad","maxTextHeight","maxBaseline","maxTextBaseline","isFieldCode","layout","layoutItems","createNewPage","addBodyWidget","clientActiveArea","pageIndex","i_1","prevPage","sectionIndex","insertPage","layoutSection","updateFieldElements","setTimeout","ownerWidget","nextBlock","updateClientAreaForBlock","layoutBlock","layoutHeaderFooter","headerFooterWidget","getCurrentPageHeaderFooter","updateHFClientArea","layoutHeaderFooterItems","updateHeaderFooterToParent","typeIndex","getHeaderFooter","clearTableWidget","linkFieldInHeaderFooter","linkFieldInParagraph","linkFieldInTable","updateClientAreaLocation","pargaraph","shiftChildLocation","clientArea","shiftTop","widgetTop","footerMaxHeight","max","childWidget","shiftChildLocationForTableWidget","tableWidget","shiftChildLocationForTableRowWidget","rowWidget","shiftChildLocationForTableCellWidget","moveToLine","layoutParagraph","layoutTable","addParagraphWidget","area","textHelper","getParagraphMarkWidth","addLineWidget","layoutListItems","layoutEmptyLineWidget","updateClientWidth","layoutLine","updateWidgetToPage","clearLineMeasures","moveElementFromNextLine","layoutElement","nextElement","layoutFieldCharacters","nextNode","moveToNextLine","moveFromNextPage","hasValidElement","getFieldResult","checkAndSplitTabOrLineBreakCharacter","getTextSize","getTabWidth","moveToNextPage","updateFieldText","previousElement","cutClientWidth","textWrap","addElementToLine","currentLine","addSplittedLineWidget","splitTextForClientArea","checkLineWidgetWithClientArea","splitElementForClientArea","elementIndex","getNextValidElementForField","char","character","splitByLineBreakOrTab","currentElement","splitCurrentWidget","cutFromLeft","splitTextElementWordByWord","fieldStacks","isEmptyLine","isShiftEnter","paragraphMarkSize","getParagraphMarkSize","getBeforeSpacing","getLineSpacing","BaselineOffset","cutFromTop","getListById","clearListElementBox","layoutList","currentListLevel","getListNumber","updateTextSize","addListLevels","val","getListLevelPattern","splittedElementBox","movedElementBox","newLineWidget","splitByWord","getSplitIndexByWord","getWidth","substr","splitByCharacter","textElement","getTextSplitIndexByCharacter","splitWidth","measureTextExcludingSpaceAtEnd","splittedElement","trim","getTextIndexAfterSpace","splittedText","isSplitByWord","textWidth","characterUptoWS","checkPreviousElement","spiltBy","inlineIndex","remainder","newSpan","newText","paraFormat","isParagraphStart","isParagraphEnd","maxDescent","updateLineWidget","measurement","measureText","subWidth","whiteSpaceCount","getWidthAndSpace","getSubWidth","spaceCount","addSubWidth","alignElements","alignLineElements","nextBody","moveBlocksToNextPage","updateClientArea","nextParagraph","insertIndex","isLastElement","getCellContentHeight","enableHeaderAndFooter","shiftFooterChildLocation","top_2","footerDistance","lastTextElement","index_1","lastIndexOf","updateListValues","getListText","getListStartValue","renderedLists","getAbstractListById","startVal","listAdv","listText","levelKey","match","getListTextListLevel","getAsLetter","number","quotient","letter","listValue","getAsRoman","toUpperCase","toLowerCase","getAsLeadingZero","generateNumber","magnitude","numberstring","retval","levelOverrideAdv","fposition","isCustomTab","defaultTabWidth","tabPosition","tabwidth","getRightTabWidth","diff","clientActiveWidth","nextIndex","totalClientWidth","clientActiveAreaWidth","justify","trimSpace","lineText","elementText","isParagraphFirstLine","isParagraphLastLine","lastLineWidget","lastInline","moveNextWidgetsToTable","rowWidgets","moveFromNext","currentRow","currentTable","nextWidgets","addTableCellWidget","maxCellMarginTop","maxCellMarginBottom","prevColumnIndex","cellspace","prevSpannedCellWidth","addWidgetToTable","tableCollection","rowCollection","endRowWidget","prevWidget","rowWidgetIndex","prevIndex","addTableWidget","updateRowHeightBySpannedCell","updateRowHeightByCellSpacing","updateHeightForRowWidget","updateRowHeight","updateSpannedRowCollection","prevRowWidget","mergedCellHeight","isRowSpanEnd","splittedCellWidgets","splittedCell","isVerticalMergedCellContinue","colIndex","splitWidgets","tableRowWidget","isLastRow","isFirstLineFitForRow","getSplittedWidgetForRow","insertSplittedCellWidgets","getSplittedWidget","updateWidgetLocation","updateWidgetsToTable","tableWidgets","rowHeight","getRowHeight","isAllowBreakAcrossPages","moveRowToNextTable","continueHeader","isInsertSplittedWidgets","updateWidgetsToPage","prevBodyWidget","curretTable","currentRenderingPage","updateChildLocationForRow","getHeader","getHeaderHeight","flag","row_1","updateWidgetToRow","lastWidget","cellHeight","isUpdateVerticalPosition","isLayouted","cellspacing","currentRowWidgetIndex","rowSpanWidgetEndIndex","splitSpannedCellWidget","spanEndRowWidget","childWidget_1","updateHeightForCellWidget","updateCellVerticalPosition","updateHeightForTableWidget","previousRowIndex","insertRowSpannedWidget","length_1","insertEmptySplittedCellWidget","previousLeft","emptyCellWidget","createCellWidget","splitMinimalWidget","splittedPara","getSplittedWidgetForPara","tableCol","tableHeight","splittedTable","getSplittedWidgetForTable","createTableWidget","newTable","lineBottom","rowBottom","splittedRow","allowRowBreakAcrossPages","isFirstLineFitForPara","paraWidget","cellwidget","isFirstLineFitInShiftWidgets","containerCellWidget","isFirstLineFitForTable","isFit","isFirstLineFitForCell","updateChildLocationForTable","spacing","updateChildLocationForCell","isUpdateToTop","displacement","getDisplacement","updateCellContentVerticalPosition","location","updateTableWidgetLocation","cellContentHeight","contentHeight","getTableLeftBorder","getTableRightBorder","getTableTopBorder","getTableBottomBorder","getCellDiagonalUpBorder","getCellDiagonalDownBorder","layoutNextItemsBlock","blockToShift","updateNextBlockList","currentWidget","blocks","isInsertingTOC","updateContainerWidget","getFirstParagraphInFirstCell","updateWholeListItems","updateListItemsTillEnd","updateClientAreaForLine","startLineWidget","getTop","getParentTable","reLayoutParagraph","elementBoxIndex","layoutBodyWidgetCollection","reLayoutTable","reLayoutLine","isInHeaderFooter","updateHCFClientAreaWithTop","isBlockInHeader","block_1","clearPosition","clearHeight","clearRowWidget","clearCellWidget","blockIndex","shiftNextWidget","curretBlock","checkAndGetBlock","currentParagraph","shiftNextWidgets","tableView","updateClientAreaTopOrLeft","layoutRow","tables","rows","addTableRowWidget","updateClientAreaForRow","layoutCell","getMaxTopOrBottomCellMargin","borderWidth","topOrBottom","updateClientAreaForCell","shiftLayoutedItems","reLayoutOrShiftWidgets","removeEmptyPages","fieldCode","getFieldCode","shiftWidgetsBlock","updateRenderedListItems","shiftWidgetsForPara","shiftWidgetsForTable","prevBodyObj","getBodyWidgetOfPreviousBlock","shiftToPreviousWidget","updateClientAreaByWidget","isFitInClientArea","nextBodyWidget","createOrGetNextBodyWidget","previousBlock","isSplittedToNewPage","shiftTableWidget","shiftRowWidget","shiftCellWidget","shiftParagraphWidget","prevObj","updateVerticalPositionToTop","combinedTable","isUpdateTop","tablewidget","previousBodyWidget","firstLine","maxElementHeight","getMaxElementHeight","paragraphView","widgetIndex","updateParagraphWidgetInternal","activeArea","lastLine","newParagraphWidget","destroyAndScroll","scrollToBottom","createSplitBody","lastBlock","newBody","lineToLayout","Renderer","pageLeft","pageTop","pageCanvasIn","getContext","containerCanvas","selectionCanvas","getColor","pageContext","fillStyle","beginPath","fillRect","closePath","strokeStyle","strokeRect","setPageSize","rect","clip","renderHFWidgets","renderHeaderSeparator","restore","clearRect","selectionContext","dpr","devicePixelRatio","globalAlpha","scale","cliped","widgetHeight","headerFooterHeight","getScaledValue","renderWidget","ctx","min","renderDashLine","getHeaderFooterType","renderHeaderFooterMark","renderHeaderFooterMarkText","footerHeight","differentFirstPage","differentOddAndEvenPages","isSmallDash","setLineDash","moveTo","lineTo","stroke","w","h","content","textBaseline","fillText","renderHeader","renderParagraphWidget","renderTableWidget","renderTableCellWidget","renderLine","renderTableRowWidget","renderTableOutline","visibleBounds","selectedWidgets","addSelectionHighlightTable","renderTableCellOutline","clipRect","addSelectionHighlight","searchHighlighters","widgetInfo","toSkipFieldCode","underlineY","getUnderlineYPosition","renderListTextElementBox","renderImageElementBox","renderTextElementBox","lineHeight","breakCharacterFormat","renderUnderline","renderStrikeThrough","isHeightType","scaledWidth","tabElement","getTabLeader","tabString","getTabLeaderString","floor","xPos","yPos","renderedHeight","underlineHeight","lineCount","widgetWidth","isClipped","containerWid","drawImage","renderSingleBorder","cellTopMargin","cellBottomMargin","cellLeftMargin","cellRightMargin","renderCellBackground","nextRowIsInCurrentTableWidget","nextRowWidget","bgColor","top_1","startX","startY","endX","endY","TextHelper","context","containerContext","paragraphMark","getHeight","textTrimEndWidth","getFormatText","heightInfoCollection","sizeInfo","getHeightInternal","formatText","toLocaleLowerCase","textHeight","spanElement","whiteSpace","innerText","applyStyle","parentDiv","tempDiv","setAttribute","offsetHeight","textTopVal","offsetTop","lineBreakMark","fontWeight","fontStyle","listCharacterFormat","Zoom","onMouseWheelInternal","ctrlKey","pageX","viewerContainer","offsetLeft","pageContainer","offsetWidth","wheel","detail","wheelDelta","setZoomFactor","onZoomFactorChanged","updateCaretPosition","updateTouchMarkPosition","updateImageResizerPosition","zoom","clearContent","handleZoom","currentPage","selectionStartPageIn","selectionEndPageIn","tableLefts","tapCount","timer","isTimerStarted","preZoomFactor","preDifference","fieldEndParagraph","fieldToLayout","containerTop","containerLeft","isMouseDown","isSelectionChangedOnMouseMoved","isControlPressed","isTouchInput","useTouchSelectionMark","touchDownOnSelectionMark","isComposingIME","lastComposedText","isCompositionUpdated","isCompositionCanceled","isCompositionEnd","prefix","suffix","preDefinedStyles","isRowOrCellResizing","isMouseDownInFooterRegion","pageFitTypeIn","fieldCollection","isPageField","mouseDownOffset","zoomFactorInternal","onTextInput","data","handleTextInput","compositionStart","positionEditableTarget","editorHistory","initComplexHistory","compositionUpdated","insertIMEText","getEditableDivTextContent","compositionEnd","iframe","editableDiv","updateComplexHistory","undo","redoStack","onImageResizer","isImageResizerVisible","isImageResizing","MouseEvent","onMouseUpInternal","TouchEvent","onTouchUpInternal","onKeyPressInternal","keyCode","charCode","onTextInputInternal","onPaste","onFocusOut","hideCaret","scrollHandler","vtHeight","scrollTop","onWindowResize","resizeTimer","updateViewerSizeInternal","clearTimeout","onContextMenu","onMouseDownInternal","offsetX","offsetY","clientHeight","updateCursor","isLeftButtonPressed","enableImageResizerMode","selectedResizeElement","cursorPoint","findFocusedPage","isCursorInsidePageRect","isCursorInFooterRegion","tableResize","isInCellResizerArea","isInRowResizerArea","startingPoint","handleResize","which","checkCursorIsInSelection","getLineWidget","onMouseMoveInternal","isImageMoveToNextPage","handleImageResizingOnMouse","handleResizing","updateTextPositionForSelection","touchY","textPosition","touchPoint_1","moveTextPosition","checkForCursorVisibility","onDoubleTap","checkAndEnableHeaderFooter","selectCurrentWord","isListTextSelected","isIE","updateResizingHistory","isImageSelected","navigateHyperLinkOnEvent","isSelectionInListText","selectListText","mouseUpInternal","scrollToPosition","updateHistoryForImageResizer","imageResizer","leftValue","topValue","onTouchStartInternal","touches","zoomX","clientX","zoomY","clientY","getTouchOffsetValue","resizeObj","getImagePointOnTouch","selectedElement","getCaretBottom","onTouchMoveInternal","touch","handleImageResizingOnTouch","currentDiff","sqrt","pow","onPinchOutInternal","onPinchInInternal","changedTouches","touchStart","touchEnd","onKeyUpInternal","getSelection","anchorOffset","setEditableDivCaretPosition","onKeyDownInternal","isHandled","keyEventArgs","ctrl","metaKey","shiftKey","alt","altKey","initalizeStyles","bookmarks","containerCanvasIn","selectionCanvasIn","visibleBoundsIn","zoomModule","dialogInternal","initDialog","dialogInternal2","initDialog2","onPageFitTypeChanged","getListLevelNumber","getBookmarks","includeHidden","bookmark","optionsPaneContainer","className","tabIndex","outline","pointerEvents","createEditableDiv","createEditableIFrame","initializeImageResizer","initTouchEllipse","wireEvent","contentEditable","attrs","scrolling","contentDocument","initCaret","addEventListener","info","textContent","getRect","getSelectionPage","updateCaretSize","iframeStyle","dialogTarget","Dialog","showCloseIcon","allowDragging","visible","isModal","X","Y","zIndex","beforeClose","appendTo","tocStyles","tocBookmarkId","selectRange","documentStart","ellipse","getPage","pageGap","getLeftValue","isInsideRect","selectionLineWidget","button","getBoundingClientRect","touchOffsetValues","pageY","updatedZoomFactor","optionsRect","optionsPane","ceil","beforeLayout","currentResizingTable","resizerPosition","headerDistance","updateClientAreaForTable","POSITIVE_INFINITY","updateTextPosition","selectCurrentParagraph","startPosition","endPosition","getLineWidgetInternal","prevLineWidget","prevTop","scrollLeft","caretInfo","caretHeight","updateCaretToPage","scrollBarWidth","isMouseDragged","pageBottom","getPageTop","getLineWidgetBodyWidget","clearSelectionHighlight","clearSelectionHighlightInSelectedWidgets","scrollToLastPage","containerHeight","fieldCodes","split","fieldCategory","fieldPattern","getFieldText","pattern","unWireEvent","removeEventListener","hyperlinkField","div","isRowResize","isCellResize","resizePosition","getImagePoint","lineLeft","getLineStartLeft","getHyperLinkFieldInCurrentSelection","updateTextPositionIn","getLeft","setHyperlinkContentToToolTip","cursor","currentPoint","updateCurrentPage","pageRight","prevScaleFactor","verticalHeight","horizontalWidth","horWidth","prevPageTop","prevY","prevValue","prevX","getCurrentHeaderFooter","createHeaderFooterWidget","viewerWidth","viewerHeight","displayPixelRatio","updateScrollBarPosition","parseFloat","updateVisiblePages","pageH","left_1","isTopFit","isBottomFit","isMiddleFit","addVisiblePage","setImageResizerPositions","renderPage","renderVisiblePages","json","jsonObject","parse","parseCharacterFormat","parseParagraphFormat","background","parseAbstractList","parseList","parseStyles","parseSections","parseStyle","wStyle","basedStyle","getStyle","styleString","linkStyle","charaStyle","nextStyleString","abstract","parseListLevel","listCollection","parseLevelOverride","parseSectionFormat","parseTextBody","oddHeader","oddFooter","parseBody","styleObj","inlines","parseParagraph","parseTable","parseTableFormat","tableRow","parseRowFormat","parseRowGridValues","parseCellFormat","writeInlineFormat","lineWidgetCount","bookmarkStart","sourceFormat","parseBorders","parseShading","isSamePaddingAsTable","parseCellMargin","sourceBorders","destBorder","parseBorder","sourceBorder","sourceShading","destShading","texture","inlineFormat","parseListFormat","parseTabStop","wTabs","tabStop","SelectionCharacterFormat","boldIn","italicIn","underlineIn","strikeThroughIn","baselineAlignmentIn","highlightColorIn","fontSizeIn","fontColorIn","notifyPropertyChanged","fontFamilyIn","propertyName","isCleared","isRetrieveFormatting","propertyValue","onApplyCharacterFormat","combineFormat","selectionCharacterFormat","SelectionParagraphFormat","leftIndentIn","rightIndentIn","beforeSpacingIn","afterSpacingIn","textAlignmentIn","firstLineIndentIn","lineSpacingIn","lineSpacingTypeIn","listLevelNumberIn","levelPattern","listTextElement","getListTextElementBox","onApplyListInternal","onApplyParagraphFormat","copyToFormat","getList","currentAbstractList","cloneListLevel","cloneLevelOverride","setList","onApplyList","history_1","setOffsetValue","updateListChangesInHistory","updateListParagraphs","applyListChanges","layoutWholeDocument","updateSelectionTextPosition","currentBaseHistoryInfo","modifiedProperties","updateSelection","updateHistory","SelectionSectionFormat","differentFirstPageIn","differentOddAndEvenPagesIn","pageHeightIn","pageWidthIn","leftMarginIn","bottomMarginIn","topMarginIn","rightMarginIn","headerDistanceIn","footerDistanceIn","getPropertyvalue","onApplySectionFormat","SelectionTableFormat","backgroundIn","tableAlignmentIn","cellSpacingIn","preferredWidthIn","tableIn","preferredWidthTypeIn","onApplyTableFormat","SelectionCellFormat","verticalAlignmentIn","onApplyTableCellFormat","clearCellFormat","SelectionRowFormat","heightIn","heightTypeIn","isHeaderIn","allowRowBreakAcrossPagesIn","onApplyTableRowFormat","clearRowFormat","SelectionImageFormat","updateImageFormat","onImageFormat","copyImageFormat","clearImageFormat","HtmlExport","fieldCheck","writeHtml","html","serializeSection","string","serializeParagraph","serializeTable","blockStyle","tagAttributes","serializeParagraphStyle","createAttributesTag","serializeInlines","endTag","serializeImageContainer","serializeInlineStyle","serializeSpan","spanClass","decodeHtmlNames","imageStyle","imageSource","serializeCell","cellHtml","serializeCellBordersStyle","createTableStartTag","serializeRow","createTableEndTag","createRowStartTag","isList","paragraphClass","serializeCharacterFormat","serializeParagraphFormat","serializeTableBorderStyle","borderStyle","convertBorderLineStyle","serializeBorderStyle","borderPosition","tagValue","localProperties","sb","createTag","s","tableStyle","createRowEndTag","htmlText","TextPosition","isUpdateLocation","getStartOffset","getLineLength","getHierarchicalIndexInternal","setPositionForSelection","physicalLocation","isLastRenderedInline","getParagraphLength","setPositionFromLine","setPosition","positionAtStart","updatePhysicalPosition","setPositionInternal","setPositionForCurrentIndex","getParagraphWidget","setPositionParagraph","newValue","moveNextLine","getPhysicalPositionInternal","isAtSamePosition","isInSameParagraph","isExistBefore","isExistAfter","startParagraph","endParagraph","offsetInLine","setPositionForLineWidget","lineLength","nextLineWidget","getNextRenderedBlock","prevLine","currentOffSet","moveNextPosition","isNavigate","getNextStartInline","moveNextPositionInternal","fieldEndOffset","fieldEndIndex","isForwardSelection","moveToInline","nextOffset","getNextValidOffset","nextValidInline","getNextValidElement","getStartLineOffset","inlineObj","updateOffsetToNextParagraph","moveToPreviousParagraphInTable","previousParagraph","currentPara","getPreviousSelectionCell","getPreviousParagraphBlock","isHighlight","getNextSelectionBlock","getContainerCellOf","getNextParagraphBlock","updateOffsetToPrevPosition","inlineInfo","getPreviousValidOffset","getPreviousSelectionBlock","previousInline","getPreviousValidElement","moveToNextParagraphStartInternal","movePreviousPosition","movePreviousPositionInternal","hasValidInline","moveBackward","nextInline","getNextRenderedElementBox","fieldBeginOffset","moveForward","fieldBeginIndex","selectionStartIndex","selectionStartInlineObj","selectionStartInline","inlineObj_1","selectionStart","selectionEnd","moveToWordStartInternal","getPreviousWordOffset","calculateOffset","getNextWordOffset","isInField","endSelection","excludeSpace","getNextWordOffsetSpan","getNextWordOffsetImage","getNextWordOffsetFieldBegin","getNextWordOffsetFieldSeperator","getNextWordOffsetFieldEnd","wordEndIndex","txt","getPreviousWordOffsetSpan","getPreviousWordOffsetImage","getPreviousWordOffsetFieldBegin","getPreviousWordOffsetFieldSeparator","getPreviousWordOffsetFieldEnd","getPreviousWordOffsetBookMark","wordStartIndex","setPreviousWordOffset","validateForwardFieldSelection","currentIndex","selectionEndIndex","isPositionMoved","validateBackwardFieldSelection","paragraphStartInternal","moveToPreviousParagraph","moveToNextParagraphInTableCheck","paragraphValue","moveToParagraphStartInternal","moveToParagraphEndInternal","moveToNextParagraph","splittedParagraph","moveToNextParagraphInTable","moveUp","moveToLineStartInternal","getFirstCellInRegion","lastParagraph","getLastParagraph","prevBlock","getLastBlockInLastCell","getLineWidgetParagraph","upDownSelectionLength","getLastCellInRegion","updateTextPositionWidget","moveDown","moveToLineEndInternal","getFirstParagraph","getFirstBlockInFirstCell","moveToPreviousLine","firstElement","getFirstElementInternal","getIndexInInline","prevInline","moveToWordEndInternal","incrementValue","getNextSelectionCell","moveUpInTable","lineStart","isMoveToLineEnd","moveDownInTable","firstItemWidth","getLeftInternal","isPositionUpdated","isBackwardSelection","containerCell","getSelectedCell","isInContainerCell","containsCell","isContainerCellSelected","isAtParagraphStart","getContainerCell","isForward","SelectionWidgetInfo","widthIn","fieldBeginAdv","linkInternal","localRef","opensNewWindow","parseFieldValues","typeInternal","codes","isLocalRef","code","parseFieldValue","setLinkType","endChar","endIndex","navigationLink","ImageFormat","imageContainer","documentEditor","isSkipLayouting","contextTypeInternal","skipFormatRetrieval","isMoveDownOrMoveUp","characterFormatIn","paragraphFormatIn","rowFormatIn","cellFormatIn","tableFormatIn","imageFormatInternal","htmlWriterIn","startInternal","endInternal","selectionStartPage","selectionEndPage","getText","goToHeader","enableHeadersFootersRegion","goToFooter","closeHeaderFooter","disableHeaderFooter","goToPage","updateTextPositionForBlockContainer","selectTable","selectTableInternal","selectRow","selectTableRow","selectColumn","selectColumnInternal","selectCell","selectTableCell","selectionSettings","pageCoordinates","extend","toggleBold","toggleItalic","toggleUnderline","toggleStrikethrough","toggleHighlightColor","toggleSubscript","toggleSuperscript","toggleTextAlignment","increaseIndent","decreaseIndent","fireRequestNavigate","linkType","localReference","navigateBookmark","hyperLinkField","linkText","getLinkText","copyToClipboard","highlightSelection","isSelectionChanged","hideImageResizer","highlightSelectedContent","createHighlightBorder","selectionWidget","clipSelection","createHighlightBorderInsideTable","isVisiblePage","canvasContext","fillColor","copyInsertFormat","heightInfo","descent","removeSelectionHighlight","currentParaWidget","pageRect","selectCurrentWordRange","fireSelectionChanged","wordStart","extendToParagraphStart","extendToParagraphEnd","updateForwardSelection","updateBackwardSelection","extendToPreviousLine","extendToLineEnd","extendToLineStart","firstrow","firstcell","selectionLength","isMovePrevious","cellStart","getCellLeft","cellEnd","cellLeft","firstBlock","getFirstParagraphBlock","lastrow","lastcell","moveToLineStart","moveToLineEnd","setPositionForBlock","lastPage","handleControlEndKey","documentEnd","selectContent","handleControlHomeKey","handleControlLeftKey","extendToWordStart","handleControlRightKey","extendToWordEnd","handleControlDownKey","handleControlUpKey","handleShiftLeftKey","extendBackward","handleShiftUpKey","handleShiftRightKey","extendForward","handleShiftDownKey","extendToNextLine","handleControlShiftLeftKey","handleControlShiftUpKey","handleControlShiftRightKey","handleControlShiftDownKey","handleLeftKey","handleUpKey","handleRightKey","handleEndKey","handleHomeKey","handleDownKey","handleShiftEndKey","handleShiftHomeKey","handleControlShiftEndKey","handleControlShiftHomeKey","handleTabKey","isNavigateInCell","isShiftTab","selectPreviousCell","selectNextCell","updateListLevel","selectTableCellInternal","clearMultiSelection","firstParagraph","selectParagraph","firstLineWidget","getTable","firstPara","lastPara","getLastParagraphBlock","selectPosition","startTextPos","endTextPos","columnCells","startCellColumnCells","endCellColumnCells","startPos","endPos","selectAll","getContainerWidget","extendToWordStartEnd","isNavigation","getTextPosition","includeObject","getTextInternal","startInlineObj","elementInfo","getRenderedInline","endInlineObj","endInline","getTextInline","nextParagraphWidget","paragarph","endParagraphWidget","startLineIndex","getFieldCodeInternal","getTocFieldInternal","getNextParagraph","getPreviousParagraph","getFirstParagraphInCell","getLastParagraphInLastCell","getLastParagraphInFirstRow","getPreviousTextInline","getNextTextInline","cell1","cell2","isExistBeforeInline","currentInline","isExistAfterInline","getPreviousRenderedBlock","getNextParagraphCell","getFirstBlockInNextHeaderFooter","getLastBlockInPreviousHeaderFooter","getPreviousParagraphCell","endLine","getLineInfo","childLength","getElementInfo","getPreviousParagraphSelection","getFirstParagraphInLastRow","getPreviousSelectionRow","getNextParagraphSelection","getNextSelection","getNextSelectionRow","getCellInTable","getPreviousSelection","selLength","isMovePrev","validOffset","size","maxBaselineOffset","getPhysicalPositionInline","startInline","fieldValue","elementBoxObj","getElementBoxInternal","positionImageResizer","showImageResizer","highlight","highlightCell","startElement","endElement","endLineWidget","startLineObj","getStartLineWidget","endLineObj","getEndLineWidget","highlightParagraph","highlightNextBlock","highlightTable","getLineWidgetInternalInline","linewidget","highlightCells","endCellLeft","endCellRight","tableWidgetCollection","startTableIndex","endTableIndex","highlightRow","startRowIndex","endRowIndex","highlightInternal","getNextParagraphRow","getPreviousParagraphRow","containsRow","highlightCellWidget","sourceCell","getSelectedCells","highlightContainer","previousValidInline","validateTextPosition","getElementBox","getFieldCharacterPosition","getNextLineWidget","getPreviousTextElement","getNextTextElement","measureObj","firstInline","getEndPosition","getRenderedField","elementObj","getCaretHeight","isEmptySelection","isItalic","getFieldCharacterHeight","heightElement","maxLineHeight","textSizeInfo","charHeight","elementHeight","top_3","isNonEmptySelection","clearChildSelectionHighlight","clearSelectionHighlightLineWidget","getLineWidgetParaWidget","getLineWidgetTableWidget","getLineWidgetRowWidget","leftCellSpacing","rightCellSpacing","topCellSpacing","bottomCellSpacing","getLineWidgetCellWidget","getFirstBlock","caretPosition","isImageSelectedObj","selectInternal","includeParagraphMark","elementValues","getFirstElement","selectParaMark","prevWidth","charIndex","curIndex","textMetrics","isLineEnd","updatePositionObj","selectFirstBlock","selects","skipSelectionChange","retrieveCurrentFormatProperties","retrieveImageFormat","retrieveCharacterFormat","retrieveParagraphFormat","retrieveSectionFormat","retrieveTableFormat","imageFormat","setCurrentContextType","contextIsinImage","contextIsinTable","tocField","isInHeader","tableAdv","retrieveCellFormat","retrieveRowFormat","getCellFormat","getRowFormat","tempTableRow","startTable","endTable","startParaSection","endParaSection","startPageIndex","endPageIndex","getParagraphFormatForSelection","getParagraphFormatInternalInParagraph","getParagraphFormatInternalInCell","getParagraphFormatInternalInBlock","getParagraphFormatInternalInTable","getParagraphFormatInCell","getParagraphFormatInBlock","getParagraphFormatInParagraph","getParagraphFormatInTable","cellAdv","getParagraphFormatInRow","getParaFormatForCell","startCellIn","endCellIn","para","elemInfo","getCharacterFormatForSelection","getCharacterFormatInTableCell","getCharacterFormat","getCharacterFormatForTableRow","tableRowAdv","getCharacterFormatForSelectionCell","getCharacterFormatForBlock","getCharacterFormatInternalInTable","startIn","endIn","getCharacterFormatInternal","setCharacterFormat","isFieldStartSelected","fieldInline","inlineAndIndex","getNextValidCharacterFormatOfField","getNextValidCharacterFormat","getCharacterFormatInTable","isSelected","top_4","copySelectionParagraphFormat","getHyperlinkDisplayText","isNestedField","displayText","toolTipElement","toolTipText","top_5","showToolTip","toolTipField","toolTipObject","Popup","relateTo","hide","cursorPosition","lineStartLeft","checkedFields","getHyperLinkFields","getHyperLinkFieldInternal","paragraphIsInFieldResult","inlineIsInFieldResult","getBlock","bodyIndex","getBlockInternal","fieldParagraph","selectionIndex","highlightListText","updateImageSize","getSelectedCellsInTable","startColumnIndex","endColumnIndex","startRowindex","copySelectedContent","isCut","htmlWriter","handleCut","htmlContent","removeAllRanges","range","createRange","selectNodeContents","addRange","copySuccess","execCommand","e","parentNode","caretLeft","caretStartLeft","caretEndLeft","page_1","childNodes","setStart","collapse","top_6","skipUpdate","paragraphInfo","transform","caretHeightInfo","searchResults","pagePoint","isCursorInHeaderRegion","moveToStart","bookmrkElmnt","bookmrkEnd","endoffset","selectBookmark","getTocField","tocPara","isTocStyle","TextSearch","isFooter","find","findOption","findNext","hierarchicalPosition","stringToRegex","textSearchResults","clearResults","results","findDocument","currentSearchResult","textToFind","option","RegExp","isPatternEmpty","wordEmpty","patternRegExp","findAll","isFirstMatch","hierachicalPosition","findInline","findInlineText","inlineEle","stringBuilder","spans","matchObject","matches","exec","result","addResult","spanKeys","spanLength","SearchWidgetInfo","leftInternal","widthInternal","TextSearchResult","TextSearchResults","innerList","textSearchResult","SearchResults","search","navigate","textToReplace","replaceInternal","replaceAll","replaceAllInternal","clearSearchHighlight","isHandledOddPageHeader","isHandledEvenPageHeader","isHandledOddPageFooter","isHandledEvenPageFooter","textSearch","searchResultsInternal","findOptions","replaceText","insertText","endTextPosition","currentHistoryInfo","updateComplexWithoutHistory","highlightResult","highlightSearchResult","highlightSearchResultParaWidget","findHighLight","addSearchHighlightBorder","highlighters","searchHighlight","addSearchResultItems","addFindResultView","addFindResultViewForSearch","suffixtext","lastIndex","boxObj","box","boxIndex","shiftIndex","headerFooterString","listElement","layoutViewer","matchCase","wholeWord","searchText","resultsText","messageDivText","replaceButtonText","replaceAllButtonText","focusedIndex","focusedElement","isOptionsPane","replacePaneText","findPaneText","matchDivReplaceText","tabInstance","isReplace","selectedTabItem","previousIndex","selectedIndex","previousTab","querySelector","nextTab","insertBefore","firstElementChild","onFindPane","onReplacePane","searchOptionChange","clearSearchResultItems","inputText","searchInput","navigateSearchResult","messageDiv","localeValue","resultContainer","resultsListBlock","clearFocusElement","wholeWordsChange","matchInput","checked","wholeInput","matchChange","onWireEvents","searchIcon","searchIconClickInternal","navigateToNextResult","navigateNextResultButtonClick","navigateToPreviousResult","navigatePreviousResultButtonClick","onKeyDown","onEnableDisableReplaceButton","resultListBlockClick","closeButton","replaceButton","onReplaceButtonClick","replaceAllButton","onReplaceAllButtonClick","replaceDiv","occurrenceDiv","replaceTabContentDiv","findDiv","findTabButtonHeader","replaceTabButtonHeader","getMessageDivHeight","disabled","replaceWith","onKeyDownOnOptionPane","focusIndex","HTMLInputElement","HTMLLIElement","click","findText","selectionText","inputElement","matchDiv","patterns","resultsContainerHeight","currentelement","listElementsDiv","liElement","listElements","currentlist","list_1","searchDiv","closeSpan","findTab","tabHeader","findTabButton","replaceTabButton","tabContent","findTabContent","findTabContentDiv","searchTextBoxContainer","placeholder","CheckBox","label","change","replaceTabContent","createReplacePane","Tab","selected","findHeader","getElementsByClassName","replaceHeader","replaceButtonDiv","emptyDiv6","currentIndexValue","blur","text_1","scrollHeight","hideTab","textBox","selectedText","resultListBox","message","TableResizer","resizeNode","initResizingHistory","getRowReSizerPosition","getCellReSizerPosition","getTableWidget","startingPointX","resizerBoundaryWidth","getCellReSizerPositionInternal","childTableWidget","getTableWidgetFromWidget","childCellWidget","getActualWidth","resizeTableCellColumn","resizeTableRow","parentTable","reLayout","currentHeight","selectionFlag","setPreferredWidth","newIndent","resizeColumnWithSelection","rightColumn","prevDragValue","newWidth","dragOffset","updateCellPreferredWidths","updateGridValue","resizeColumnAtLastColumnIndex","resizeCellAtMiddle","selectedCells","resizeColumnAtStart","leftColumnCollection","getColumnCells","increaseOrDecreaseWidth","updateRowsGridAfterWidth","rightColumnCollection","isColumnResizing","isColumnSelected","changeWidthOfCells","selectedRow","newGridBefore","updateGridBefore","leastGridBefore","getLeastGridBefore","updateWidthForCells","hasTableWidth","leftColumn","isContinue","isUpdate","getOffsetValue","isLeftSideCollection","ignoreRow","isIncrease","minimumWidth","isSelection","maxRowWidth","currentRowWidth","getRowWidth","toUpdateGridAfter","leftColumnCells","rightColumnCells","columnCell","applyProperties","tableHistoryInfo","isAutoFit","updateGridBeforeWidth","updateGridAfterWidth","nodes","editHyperlinkInternal","isHandledComplex","refListNumber","incrementListNumber","removedBookmarkElements","pageRefFields","isBordersAndShadingDialog","nbsp","lineFeed","textBoxText","handleBackKey","insertField","fieldCodeSpan","fieldResultSpan","pasteContentsInternal","clearDirectFormatting","clearFormatting","getCompleteStyles","action","getPrefixAndSuffix","boxInfo","spaceIndex","prefixAdded","endInlineInfo","suffixAdded","toggleBaselineAlignment","acceptTab","handleEnterKey","handleDelete","handleShiftEnter","insertPageBreak","redo","onBackSpace","onDelete","onEnter","animationTimer","insertFormat","sFormat","insertPosition","isRemoved","initHistory","getParagraphInfo","editPosition","removeSelectedContents","updateInsertPosition","insertTextInline","tempSpan","splittedSpan","updateEndPosition","isSelectionOnHyperlink","checkAndConvertList","checkAndConvertToHyperlink","insertSectionBreak","insertSection","newSectionFormat","newParagraph","splitTable","updateNextBlocksIndex","splitParagraphInternal","splitBodyWidget","startBlock","newBodyWidget","updateSectionIndex","insertRemoveHeaderFooter","updateBlockIndex","startBodyWidget","increaseIndex","currentSectionIndex","isTab","convertList","isLeadingZero","tabValue","previousText","checkNumberFormat","checkLeadingZero","deleteSelectedContents","leadingZeroText","autoConvertList","newList","newAbstractList","isBullet","isZero","getPageFromBlockWidget","insertImageText","insertFieldBeginText","insertFieldSeparatorText","insertFieldEndText","insertBookMarkText","spanObj","spanIndex","previousInlineObj","nextInlineObj","isEnter","tabCharIndex","lowerCaseText","containsURL","atIndex","dotIndex","autoFormatHyperlink","url","blockInfo","createHyperlinkElement","appylingHyperlinkFormat","updateCharacterFormatWithUpdate","initInsertInline","begin","insertHyperlinkfield","isBookmark","unLinkFieldCharacter","fieldIndex","insertHyperlink","insertHyperlinkInternal","fieldStartPosition","insertHyperlinkByFormat","insertElement","insertInlineInSelection","insertElementInCurrentLine","isReLayout","checkIsNotRedoing","checkEndPosition","updateHistoryPosition","fieldResult","fieldObj","newFieldBegin","insertInlineInternal","removedNodes","insertClonedFieldResult","getClonedFieldResultWithSel","getClonedFieldResult","insertParagraph","insertBlock","curParagraph","fieldSeparatorPosition","pasteWindow","pasteLocal","clipboardData","getData","pasteContents","document_1","getBlocks","pasteContent","arr","insertParaFormat","removeSelectedContentInternal","pasteCopiedData","insertTableRows","insertBlockInternal","insertTableInternal","moveRows","removeBlock","insertBlockTable","moveInlines","checkInsertPosition","deleteSelectedContent","curInline","insertElementInternal","prevElement","newElement","relayout","startPara","insertNewParagraphWidget","insertImage","insertPicture","createTable","startLine","above","rowPlacement","getOwnerCell","cloneTableToHistoryInfo","rowCount","getRowCountToInsert","isAffectedByRowSpannedCell","cellCountInfo","updateRowspan","newRow","createRowAndColumn","updateCellFormatForInsertedRow","cellFormats","isCellIncluded","isRowSpanned","clonedRowIndex","columnPlacement","newCell","columnCount","getColumnCountToInsert","createColumn","isCellInserted","j_1","rowCell","getOwnerRow","isStart","startRow","endRow","getOwnerTable","mergeSelectedCellsInTable","startOwnerCell","endOwnerCell","mergedCell","mergeSelectedCells","cellInfo","updateSelectedCellsInTable","rowStartIndex","mergeBorders","updateBlockIndexAfterMerge","mergedCellborders","cellBorders","startCellIndex","canMergeSelectedCellsInTable","startLeft","endLeft","selectionLeft","selectionRight","isRowLeftWithinSel","isRowRightWithinSel","rowLeft","rowRight","checkCellWithInSelection","isPrevCellWithinSel","checkPrevOrNextCellIsWithinSel","isNextCellWithinSel","isNoRowSpan","isCellWithInSel","checkCurrentCell","checkCellWidth","isPrev","prevOrNextCell","isPrevCellWithInSel","cellOwner","spannedCellOwner","checkRowSpannedCells","insertAfter","insertIndex_1","isMoved","moveContent","removeEmptyLine","updateHeaderFooterWidget","isHandledComplexHistory","updateHeaderFooterWidgetToPage","shiftPageContent","isEvenPage","updateHeaderFooterWidgetToPageInternal","hfWidget","headerOrFooter","removeFieldInBlock","removeFieldTable","removeField","checkAndShiftFromBottom","update","isAtParagraphEnd","applyCharFormatValue","applyCharacterFormatForListText","updateSelectionCharacterFormatting","values","applyListCharacterFormatByValue","updateListCharacterFormat","updateListTextSelRange","startPositionInternal","endPositionInternal","initHistoryPosition","startSelectionReLayouting","currentList","clearList","applyBullet","bullet","applyBulletOrNumbering","applyNumbering","baseAlignment","updateProperty","initializeHistory","updateParagraphFormatInternal","currentUnderline","script","completeStylesString","name_1","existingStyles","styleNames_1","name_2","createStyle","createStyleIn","getUniqueStyleName","uniqueName","getUniqueName","matchArray","updateCharacterFormat","applyCharFormatSelectedContent","applyCharFormat","applyCharFormatCell","applyCharFormatForSelectedPara","splittedLastParagraph","splittedWidets","getNextParagraphForCharacterFormatting","widgetCollection","applyCharFormatForTable","inlineLength","applyCharFormatInline","getCurrentSelectionValue","updateFontSize","fontsizeCollection","formatInline","getCharacterFormatValueOfCell","applyCharFormatForSelectedCell","applyCharFormatRow","applyCharFormatForTableCell","applyCharFormatForSelTable","startCellLeft","startCellRight","applyCharFormatValueInternal","copyInlineCharacterFormat","destFormat","addModifiedProperties","modifiedFormat","getIndentIncrementValue","applyParaFormatProperty","layoutItemBlock","updateSelectionParagraphFormatting","increaseLevel","nextListLevel","incrementFactor","currentParagraphIndent","getIndentIncrementValueInternal","fPosition","updateParagraphFormat","applyParaFormatSelectedContent","applyCharacterStyle","applyParaFormat","applyParaFormatInCell","addModifiedPropertiesForParagraphFormat","copyParagraphFormat","copyFromListLevelParagraphFormat","onListFormatChange","updateListParagraphFormat","listlevel","oldFormat","newFormat","applyContinueNumberingInternal","numberingInfo","getContinueNumberingInfo","getParagraphFormat","listPattern","changeListId","revertContinueNumbering","levelNum","listType","baseHistoryInfo","addModifiedPropertiesForContinueNumbering","checkNumberArabic","restartListAt","createListLevels","restartListAtInternal","changeRestartNumbering","addModifiedPropertiesForRestartNumbering","levelPatterns","indexOfLevelPattern","getNextParagraphForFormatting","obj","cellContainer","getParaFormatValueInCell","applyParaFormatCellInternal","applyParagraphFormatRow","applyParaFormatTableCell","wCell","applyParagraphFormatTableInternal","wRow","startValue","endValue","applyParaFormatTable","updateSectionFormat","startSectionIndex","endSectionIndex","applyPropertyValueForSection","getTableFormatAction","applyTablePropertyValue","updateSelectionTableFormat","getRowAction","applyRowPropertyValue","getTableCellAction","applyCellPropertyValue","addModifiedPropertiesForSection","startInfo","endInfo","combineSection","nextSection","combineSectionChild","updateTableFormat","updateCellFormat","updateRowFormat","tableStartPosition","newStartPosition","updateFormatForCell","rowStartPosition","rowEndPosition","applyRowFormat","reLayoutSelectionOfTable","reLayoutSelection","isEnded","reLayoutSelectionOfBlock","removeSelectedContent","editAction","deletePara","deleteTableCell","getParagraphForSelection","deleteCells","removeRow","updateTable","paragraphStart","endParagraphStartOffset","isCombineNextParagraph","lastLinelength","isEndInAdjacentTable","isStartParagraph","removeInlines","deleteSection","deleteBlock","insertParagraphPaste","addRemovedNodes","checkAndInsertBlock","combineSectionInternal","currentSection","lastBlockIndex","paragraphAdv","deleteTableBlock","deletePreviousBlock","updateEditPosition","deleteCellsInTable","deleteCell","deleteContainer","isDeleteCells","cell_1","setActionInternal","copyChildToClipboard","checkClearCells","deleteContent","splitEndRow","enableHistoryMode","clonedTable","deleteParagraphMark","removeContent","copyListLevel","destination","listParagraphs","updateListParagraphsInBlock","startListLevel","tempList","abstractListAdv","listName","bulletCharacters","isInsertPageBreak","initialStart","breakParagraph","pageBreak","updateIndex","currentCellIndex","increment","singleBackspace","skipBackSpace","insertRemoveBookMarkElements","bookMark","bookMarkStart","bookMarkEnd","isBackSpace","deleteSelectedContentInternal","getParagraph","lineInfo","canRedo","canUndo","historyInfo","undoStack","startBlockInfo","endBlockInfo","currentLineWidget","setPositionForHistory","removeOffset","removeAtOffset","singleDelete","nextRenderedInline","bookMarkBegin","paraEndOffset","singleDeleteInternal","updateEditPositionOnMerge","base64String","imageElementBox","insertPictureInternal","fitImageToPage","onPortrait","onLandscape","copyValues","changeMarginValue","onPaperSize","currentBlock","updateListItems","updateListItemsForPara","updateListItemsForTable","updateListItemsForRow","updateListItemsForCell","updateRenderedListItemsForPara","updateRenderedListItemsForTable","updateRenderedListItemsForRow","updateRenderedListItemsForCell","getParagraphInfoInternal","lineOffset","insertPageNumber","createFields","insertPageCount","fieldtext","insertBookmark","bookmarkEnd","insertElements","updateComplexHistoryInternal","deleteBookmark","bookmarkName","setBookmarkInfo","deleteBookmarkInternal","getSelectionInfo","startElementInfo","endElementInfo","endElements","startElements","insertElementsInternal","elements","hfString","getBodyWidget","getBlockByIndex","blockObj","getParagraphInternal","getHeaderFooterWidget","getBodyWidgetInternal","isInsertPosition","applyBorders","settings","getBorder","borderColor","clearAllBorderValues","selectedCell","getTopBorderCellsOnSelection","getLeftBorderCellsOnSelection","getRightBorderCellsOnSelection","getBottomBorderCellsOnSelection","getAdjacentCellToApplyBottomBorder","clearBorder","getAdjacentCellToApplyRightBorder","applyAllBorders","applyInsideBorders","updateGridForTableDialog","borderType","isLastSelectedRow","isLastRightCell","nextRowIndex","getAdjacentBottomBorderOnEmptyCells","rightBorderCells","getSelectedCellsNextWidgets","topBorderCells","leftBorderCells","bottomBorderCells","nextCellColIndex","isSingleCell","startPosIn","endPosIn","applyBordersInternal","applyBorder","applyShading","onTableFormat","applyTableFormat","addModifiedTableProperties","handleTableFormat","applyFormat","shiftNextItem","onRowFormat","rowStartPos","rowEndPos","addModifiedRowProperties","handleRowFormat","onCellFormat","updateCellMargins","cellStartPosition","cellEndPosition","applyCellmarginsValue","getSelectedCellInColumn","rowEndIndex","addModifiedCellProperties","handleCellFormat","isTocField","insertTableOfContents","validateTocSettings","getTocSettings","tocSettings","includePageNumber","rightAlign","startLevel","endLevel","swtiches","swtch","includeHyperlink","includeOutlineLevels","decodeTSwitch","tSwitch","levelSettings","tableOfContentsSettings","constructTocFieldCode","buildToc","tocLastPara","tocLastLine","appendEndField","appendEmptyPara","updatePageRef","emptyPara","emptyLine","tocFieldCode","constructTSwitch","isFirstPara","tocDomBody","createHeadingLevels","createOutlineLevels","isHeadingStyle","isOutlineLevelStyle","insertTocBookmark","createTOCWidgets","levelStyle","headingStyle","createTocFieldElement","tocLine","headingStyleName","tocStyleName","insertTocHyperlink","pageField","insertTocPageNumber","bookMarkname","isRightAlign","pageRef","generateBookmarkName","formatString","onCellContentAlignment","ModifiedLevel","modified","ownerListLevelIn","modifiedListLevelIn","ownerListLevel","modifiedListLevel","ModifiedParagraphFormat","ownerFormat","ownerFormatIn","modifiedFormatIn","RowHistoryFormat","rowHeightType","revertChanges","isRedo","currentRowHeightType","TableHistoryInfo","TableFormatHistoryInfo","copyProperties","RowFormatHistoryInfo","CellFormatHistoryInfo","tableHierarchicalIndex","CellHistoryFormat","BaseHistoryInfo","ownerIn","modifiedPropertiesIn","modifiedNodeLength","removedNodesIn","actionIn","selectionStartIn","selectionEndIn","insertPositionIn","endPositionIn","revertBookmark","bookmarkInfo","recordChanges","revert","selectionStartTextPosition","selectionEndTextPosition","revertModifiedProperties","deletedNodes","insertTextPosition","isRemoveContent","isRedoAction","revertModifiedNodes","isDelete","revertResizing","revertTableDialogProperties","revertProperties","redoAction","lastNode","firstNode","insertRemovedNodes","prevTableHistoryInfo","tableHistoryInfoCurrent","currentPropertyIndex","applyTableOptionsHelper","previousFormat","currentFormat","skipRemove","prevLength","nextFormat","addModifiedPropertiesForList","previousLevel","getProperty","modifiedLevel","updateListChanges","addModifiedCellOptions","copyCellOptions","addModifiedTableOptions","copyTableOptions","getCharacterPropertyValue","previousTableFormat","resizeContainerDiv","topLeftRect","topMiddleRect","topRightRect","bottomLeftRect","bottomMiddleRect","bottomRightRect","leftMiddleRect","rightMiddleRect","topLeftRectParent","topMiddleRectParent","topRightRectParent","bottomLeftRectParent","bottomMiddleRectParent","bottomRightRectParent","leftMiddleRectParent","rightMiddleRectParent","resizeMarkSizeIn","selectedImageWidget","imageResizerPoints","ImageResizingPoints","imageResizerDiv","currentImageElementBoxIn","imageResizerDivElement","resizeDiv","initResizeMarks","currentImageElementBox","currentPageDiv","currentPageDivWidth","currentPageDivHeight","imageResizerDivWidth","imageResizerDivHeight","resizeMarkSize","setImageResizerPosition","selectedImageInfo","SelectedImageInfo","initResizeContainerDiv","opacity","setImageResizingPoints","applyPropertiesForTouch","applyPropertiesForMouse","resizeRectElement","boxShadow","handleImageResizing","points","topRightResizing","topLeftResizing","topMiddleResizing","bottomRightResizing","bottomLeftResizing","leftMiddleResizing","imageHeight","initHistoryForImageResizer","getOuterResizingPoint","getInnerResizingPoint","touchEvent","imageResizingPoints","bottomMiddle","bottomRight","bottomLeft","topMiddle","topRight","topLeft","rightMiddle","leftMiddle","touchPoints","imageResizingPointsOnTouch","selectedElements","HistoryInfo","isChild","isChildHistoryInfo","modifiedActions","addModifiedAction","undoStackIn","redoStackIn","historyInfoStack","modifiedParaFormats","undoLimitIn","redoLimitIn","rowHistoryFormat","cellHistoryFormat","redoLimit","undoLimit","clearRedoStack","hasAction","modifiedLevelsInternal","modifiedCollection","revertListChanges","clearHistory","clearUndoStack","documentPath","stylePath","numberingPath","settingsPath","headerPath","footerPath","imagePath","appPath","corePath","contentTypesPath","generalRelationPath","wordRelationPath","headerRelationPath","footerRelationPath","xmlContentType","fontContentType","documentContentType","settingsContentType","footerContentType","headerContentType","numberingContentType","stylesContentType","webSettingsContentType","appContentType","coreContentType","customContentType","customXmlContentType","relationContentType","tableStyleContentType","settingsRelType","footerRelType","headerRelType","documentRelType","numberingRelType","stylesRelType","fontRelType","tableStyleRelType","coreRelType","appRelType","customRelType","imageRelType","hyperlinkRelType","controlRelType","packageRelType","customXmlRelType","customUIRelType","attachedTemplateRelType","wNamespace","wpNamespace","pictureNamespace","aNamespace","a14Namespace","rNamespace","rpNamespace","vNamespace","oNamespace","xmlNamespace","w10Namespace","cpNamespace","dcNamespace","docPropsNamespace","veNamespace","mNamespace","wneNamespace","customPropsNamespace","vtNamespace","chartNamespace","slNamespace","dtNamespace","wmlNamespace","w14Namespace","wpCanvasNamespace","wpDrawingNamespace","wpGroupNamespace","wpInkNamespace","wpShapeNamespace","w15Namespace","diagramNamespace","eNamespace","pNamespace","certNamespace","cRelationshipsTag","cRelationshipTag","cIdTag","cTypeTag","cTargetTag","cUserShapesTag","cExternalData","twipsInOnePoint","twentiethOfPoint","borderMultiplier","percentageFactor","emusPerPoint","cConditionalTableStyleTag","cTableFormatTag","cTowFormatTag","cCellFormatTag","cParagraphFormatTag","cCharacterFormatTag","packageType","relsPartPath","documentRelsPartPath","webSettingsPath","wordMLDocumentPath","wordMLStylePath","wordMLNumberingPath","wordMLSettingsPath","wordMLHeaderPath","wordMLFooterPath","wordMLCommentsPath","wordMLImagePath","wordMLFootnotesPath","wordMLEndnotesPath","wordMLAppPath","wordMLCorePath","wordMLCustomPath","wordMLFontTablePath","wordMLChartsPath","wordMLDefaultEmbeddingPath","wordMLEmbeddingPath","wordMLDrawingPath","wordMLThemePath","wordMLFontsPath","wordMLDiagramPath","wordMLControlPath","wordMLVbaProject","wordMLVbaData","wordMLVbaProjectPath","wordMLVbaDataPath","wordMLWebSettingsPath","wordMLCustomItemProp1Path","wordMLFootnoteRelPath","wordMLEndnoteRelPath","wordMLSettingsRelPath","wordMLNumberingRelPath","wordMLFontTableRelPath","wordMLCustomXmlPropsRelType","wordMLControlRelType","wordMLDiagramContentType","lastSection","mRelationShipID","mDocPrID","mDifferentFirstPage","mBookmarks","mDocumentImages","mExternalLinkImages","mHeaderFooterImages","mHeaderFooterColl","mArchive","then","clearDocument","setDocument","ZipArchive","compressionLevel","mVerticalMerge","mGridSpans","serializeDocument","serializeStyles","serializeNumberings","serializeSettings","serializeCoreProperties","serializeAppProperties","serializeFontTable","contenttype","serializeSettingsRelation","serializeHeaderFooters","serializeDocumentRelations","serializeGeneralRelations","serializeContentTypes","mSections","mLists","mAbstractLists","defCharacterFormat","defParagraphFormat","defaultTabWidthValue","mStyles","blockOwner","writer","XmlWriter","writeStartElement","writeCommonAttributeStrings","serializeDocumentBody","writeEndElement","archiveItem","ZipArchiveItem","buffer","addItem","writeAttributeString","writeCustom","writeDup","last","serializeBodyItems","serializeSectionProperties","serializeHFReference","serializeSectionType","serializePageSetup","serializeColumns","pageSetup","serializePageSize","serializePageMargins","roundToTwoDecimal","marginValue","sectionBreakCode","hfId","hf","getNextRelationShipID","addHeaderFooter","hfType","hfColl","blockCollection","isLastSection","serializeBodyItem","sec","serializeParagraphItems","paraItems","serializeFieldCharacter","serializePicture","serializeBookMark","serializeTextRange","bookmarkId","getBookmarkId","serializeDrawing","serializeInlinePicture","cx","cy","serializeDrawingGraphics","startsWith","sourceString","startString","picture","updateShapeId","documentImages","externalImages","tOwner","updateHFImageRels","addImageRelation","imageCollection","relationId","headerId","types","hfKeys","headerImages","headerFooterImages","serializeTableFormat","serializeTableGrid","serializeTableRows","grid","serializeGridColumns","serializeRowFormat","serializeCells","pointWidth","serializeCellFormat","itemIndex","serializeCellWidth","serializeCellMerge","serializeGridSpan","serializeBorders","serializeShading","serializeTableCellDirection","serializeCellVerticalAlign","cf","collKey","isserialized","createMerge","serializeColumnSpan","checkMergeCell","num","alignment","gridValue","serializeTableWidth","serializeTableAlignment","serializeCellSpacing","serializeTableIndentation","serializeTableBorders","serializeTblLayout","getTextureStyle","multipler","serializeBorder","tagName","multiplier","sz","getBorderStyle","tableIndent","writeElementString","isField","writeString","serializeListFormat","serializeParagraphSpacing","serializeIndentation","serializeParagraphAlignment","serializeTabs","serializeTab","getTabJustification","lf","txtAlignment","serializeDefaultStyles","serializeDocumentStyles","zipArchiveItem","serializeBoolProperty","getHighlightColor","getUnderlineStyle","underlineStyle","tag","serializeAbstractListStyles","serializeListInstances","listStyles","generateHex","ilvl","cnt","serializeListLevel","random","levelIndex","getLevelPattern","serializeLevelFollow","serializeLevelText","patternType","lvlIndex","fc","tabWidth","contentType","serializeHeaderFooter","headerFooterPath","headerFooterRelsPath","serializeHeader","serializeFooter","writeHFCommonAttributes","serializeHFRelations","serializeImagesRelations","serializeRelationShip","serializeHeaderFooterRelations","images","base64ImageString","extension","formatClippedString","imageBlob","encodedString","input","chr1","chr2","chr3","enc2","enc3","enc4","keyStr","resultIndex","totalLength","output","Uint8Array","serializeExternalLinkImages","serializeHFRelation","relType","relationshipID","relationshipType","targetPath","resetRelationShipID","serializeDefaultContentType","serializeOverrideContentType","serializeHFContentTypes","serializeHeaderFootersContentType","partName","curSectionIndex","inField","StreamWriter","writeInternal","streamWriter","sectionCount","updateLastParagraph","writeBody","writeNewLine","writeSectionEnd","writeHeadersFooters","bodyItemsCount","bodyItem","isLastPara","writeParagraph","writeTable","writeText","writeHeaderFooter","writeLine","paragraphs","pCount","writeInlineStyles","writeParagraphFormat","endPara","createSection","createParagraph","writeBodyWidget","writeStyles","writeLists","doc","writeHeaderFooters","writeBlock","writeNextBlock","writeLines","writeInlines","writeInline","isEnd","started","ended","writeListFormat","writeTabs","listIdValue","writeRow","createRow","writeCell","createCell","writeTableFormat","writeRowFormat","writeCellFormat","writeShading","wShading","writeBorder","wBorder","writeBorders","wBorders","wCellFormat","wRowFormat","wTableFormat","writeStyle","writeList","writeAbstractList","wAbstractList","writeListLevel","wList","wListLevel","navigationUrl","bookmarkDropdown","bookmarkCheckbox","onKeyUpOnUrlBox","displayTextBox","urlTextBox","onInsertHyperlink","urlValue","enableOrDisableInsertButton","onKeyUpOnDisplayBox","onInsertButtonClick","onCancelButtonClick","dialog","clearValue","loadHyperlinkDialog","localObj","bookmarkDiv","addressText","dataSource","insertButton","closeHyperlinkDialog","onUseBookmarkChange","onBookmarkchange","instance","autofocus","bookmarkText","bookmarkTextElement","bookmarkValue","DropDownList","popupHeight","noRecordsTemplate","bookmarkCheckDiv","bookmarkCheck","buttons","buttonModel","cssClass","isPrimary","dataBind","address","keyUpInsertTable","rowsCountBox","columnsCountBox","onInsertTableClick","rowValueTextBox","columnValueTexBox","columnContainer","columnValue","rowContainer","rowValue","NumericTextBox","enablePersistence","addBookmark","textBoxInput","selectHandler","setSelectionRange","gotoBookmark","initBookmarkDialog","headerValue","dlgFields","commonDiv","textBoxDiv","listviewDiv","listviewInstance","ListView","buttonDiv","addbuttonDiv","addButtonElement","Button","deleteButtonDiv","deleteButtonElement","gotoButtonDiv","gotoButtonElement","removeObjects","bind","loadTableofContentDialog","enabled","showLevel","closeTableOfContentDialog","unWireEventsAndBindings","changeShowLevelValue","changeByValue","headings","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9","reset","normal","changeStyle","headingValue","srcElement","getElementValue","checkLevel","changeHeadingStyle","changePageNumberValue","changeRightAlignValue","changeStyleValue","applyTableOfContentProperties","applyLevelSetting","ownerId","generalDiv","genLabel","leftGeneralDiv","rightGeneralDiv","leftBottomGeneralDiv","rightBottomGeneralDiv","pageNumberDiv","rightAlignDiv","tabDiv","tabLeaderLabelDiv","tabLeaderLabel","tabLeaderDiv","showDiv","showLevelLabelDiv","showLevelLabel","showLevelDiv","buildTableDiv","buildTableLabel","tr1","td1","availableLabel","td2","tocLabel","tableDiv","table1","tr2","td3","heading1Label","td4","tr3","td5","heading2Label","td6","tr4","td7","heading3Label","td8","tr5","td9","heading4Label","td10","tr6","td11","heading5Label","td12","tr7","td13","heading6Label","td14","tr8","td15","heading7Label","td16","tr9","td17","heading8Label","td18","tr10","td19","heading9Label","td20","tr12","td23","normalLabel","td24","stylesLevelDiv","fieldsDiv","outDiv","outlineDiv","resetButtonDiv","resetElement","tocStylesDiv","tocStylesLabel","listViewDiv","styleValues","listViewInstance","modifyButtonDiv","modifyElement","getHeadingLevel","newStartLevel","newEndLevel","isEndLevel","isPortrait","loadPageSetupDialog","topMarginBox","leftMarginBox","bottomMarginBox","rightMarginBox","widthBox","heightBox","checkBox1","checkBox2","headerBox","footerBox","landscape","portrait","closePageSetupDialog","keyUpInsertPageSettings","applyPageSetupProperties","changeByPaperSize","paperSize","ejtabContainer","marginTab","paperTab","layoutTab","ejtab","headerContainer","marginHeader","paperHeader","layoutHeader","contentContainer","marginContent","paperContent","layoutContent","initMarginProperties","initPaperSizeProperties","initLayoutProperties","tabObj","marginDiv","leftMarginDiv","rightMarginDiv","topLabel","topTextBox","bottomBoxLabel","bottomTextBox","leftBoxLabel","leftTextBox","rightLabel","rightTextBox","decimals","orientationDiv","orientationLabeldiv","orientationPropDiv","portraitDiv","landscapeDiv","RadioButton","sizeDiv","leftSizeDiv","rightSizeDiv","widthLabel","widthTextBox","heightLabel","heightTextBox","paperSizeDiv","layoutDiv","firstPageDiv","oddOrEvenDiv","textLabelDiv","textLabel","propertyDiv","leftLayoutDiv","rightLayoutDiv","headerLabel","footerLabel","keyUpParagraphSettings","applyParagraphFormat","changeBeforeSpacing","changeAfterSpacing","changeLeftIndent","changeRightIndent","changeLineSpacingValue","changeFirstLineIndent","changeByTextAlignment","special","byIn","changeBySpacing","atIn","loadParagraphDialog","selectionFormat","alignValue","lineSpaceValue","isApply","onParagraphFormat","closeParagraphDialog","alignLabel","indentionDiv","leftIndentionDiv","rightIndentionDiv","spacingDiv","leftSpacingDiv","rightSpacingDiv","indentLabel","beforeTextLabel","specialLabel","afterTextLabel","byLabel","by","spaceLabel","beforeLabel","lineSpaceLabel","afterLabel","atLabel","lineSpacingAt","step","local","q","ListViewModel","listIn","levelNumberIn","createList","listLevelAdv","viewModel","textIndent","alignedAt","listLevelElement","followNumberWith","numberStyle","restartBy","isListCharacterFormat","onTextIndentChanged","onStartValueChanged","onListLevelValueChanged","updateDialogValues","updateRestartLevelBox","onNumberFormatChanged","onAlignedAtValueChanged","onFollowCharacterValueChanged","onLevelPatternValueChanged","numberFormatTextBox","loadListDialog","dialog2","disposeBindingForListUI","closeListDialog","listLevelDiv","numberStyleDiv","numberFormatDiv","indentsDiv","startAtTextBox","textIndentAtTextBox","alignedAtTextBox","followCharacterElement","numberStyleEle","restartElement","formatInfoToolTip","Tooltip","option_1","listPatternConverter","followCharacterConverter","l","styleBasedOn","styleParagraph","onlyThisDocument","template","openDialog","showNumberingBulletDialog","setBoldProperty","fontButtonClicked","setItalicProperty","setUnderlineProperty","fontSizeUpdate","fontFamilyChanged","fontColorUpdate","currentValue","rgba","setLeftAlignment","setRightAlignment","setCenterAlignment","setJustifyAlignment","increaseBeforeAfterSpacing","decreaseBeforeAfterSpacing","updateNextStyle","typedName","getTypeValue","isUserNextParaUpdated","isEdit","editStyleName","updateOkButton","enableOrDisableOkButton","styleTypeChange","isInteracted","toggleDisable","updateStyleNames","styleBasedOnChange","styleParagraphChange","numberingBulletDialog","showNumberBulletDialog","onOkButtonClick","styleNameElement","updateList","createLinkStyle","loadStyleDialog","okButton","closeStyleDialog","properties","styleNameTypeDiv","nameWholeDiv","nameValue","styleTypeWholeDiv","styleTypeDivElement","styleTypeValue","styleBasedParaDiv","styleBasedOnWholeDiv","styleBasedOnDivElement","styleBasedOnValue","styleParagraphWholeDiv","styleParagraphDivElement","styleParagraphValue","formatting","optionsDiv","fontOptionsDiv","createFontOptions","paragraphOptionsDiv","createParagraphOptions","createFormatDropdown","formatBtn","dropDownbtn","DropDownButton","beforeItemRender","fontFamilyElement","ComboBox","popupWidth","showClearButton","fontSizeElement","sizeDataSource","fontGroupButton","createButtonElement","fontColorElement","ColorPicker","alignmentDiv","leftAlign","centerAlign","lineSpacingDiv","singleLineSpacing","onePointFiveLineSpacing","doubleLineSpacing","indentingDiv","buttonElement","removeAttribute","paragraphFOrmat","nxtName","basedOnIndex","numberListClick","setActiveElement","currentTarget","bulletListClick","symbol","loadNumberingBulletDialog","closeNumberingBulletDialog","initNumberingBulletDialog","tabTarget","createNumberList","createBulletList","heightAdjustMode","refresh","numberListDiv","ulTag","numberedNone","createNumberNoneListTag","numberedNumberDot","createNumberListTag","numberedNumberBrace","numberedUpRoman","numberedUpLettter","numberedLowLetterDot","numberedLowLetterBrace","numberedLowRoman","text1","text2","text3","liTag","liInnerDiv","cssFloat","createBulletListTag","liNextDiv","bulletListDiv","bulletNone","bulletDot","bulletCircle","bulletSquare","bulletFlower","bulletArrow","bulletTick","childElementCount","fontStyleInternal","fontNameList","fontStyleText","fontSizeText","colorPicker","underlineDrop","strikethroughBox","doublestrikethrough","superscript","subscript","loadFontDialog","getItems","closeFontDialog","onInsertFontFormat","onCharacterFormat","fontStyleUpdate","fontFamilyUpdate","underlineUpdate","hex","singleStrikeUpdate","enableCheckBoxProperty","doubleStrikeUpdate","superscriptUpdate","subscriptUpdate","createInputElement","effectLabel","strikeThroughElement","superScriptElement","subScriptElement","doubleStrikeThroughElement","fontDiv","getFontDiv","getFontSizeDiv","colorDiv","fontColorDiv","fontColorLabel","fontEffectsDiv","fontEffectSubDiv1","fontEffectSubDiv2","sizeSubDiv1","sizeLabel","underlineElement","sizeSubDiv2","underlineLabel","fontSubDiv1","fontNameLabel","fontNameValues","fontSubDiv2","fontStyleLabel","fontStyleValues","hasCellWidth","isTableBordersAndShadingUpdated","isCellBordersAndShadingUpdated","isCellOptionsUpdated","isTableOptionsUpdated","onBeforeOpen","loadTableProperties","onCloseTablePropertyDialog","applyTableProperties","preferCheckBox","indeterminate","rowHeightCheckBox","preferredCellWidthCheckBox","rowHeightValue","closeTablePropertiesDialog","applyTableSubProperties","applySubCellOptions","applySubTableOptions","tableWidthBox","tableWidthType","leftIndentBox","rowHeightBox","repeatHeader","allowRowBreak","cellWidthBox","cellWidthType","changeTableCheckBox","enable","changeTableAlignment","updateClassForAlignmentProperties","tableTab","getTableAlignment","changeTableRowCheckBox","changeTableCellCheckBox","changeCellAlignment","updateClassForCellAlignment","cellTab","getCellAlignment","showBordersShadingsPropertiesDialog","rowFormatInternal","rowTab","separatorLine","tableHeader","rowHeader","cellHeader","tableContent","rowContent","cellContent","initTableProperties","initTableRowProperties","initTableCellProperties","alignMentButtons","cellAlignment","calculateGridValue","setTableProperties","setTableRowProperties","setTableCellProperties","bordersAndShadingButton","tableOptionButton","cellOptionButton","onTableWidthChange","onTableWidthTypeChange","onLeftIndentChange","onRowHeightChange","onRowHeightTypeChange","onAllowBreakAcrossPage","onRepeatHeader","onCellWidthChange","onCellWidthTypeChange","sizeHeader","parentContainer","childContainer1","childContainer2","child1","child2","childContainer3","controlDiv","labeltext","alignmentHeader","alignmentContainer","classDivName","leftAlignDiv","centerAlignDiv","center","leftlabel","centerlabel","rightlabel","leftIndenetContainer","leftIndentLabel","tableOptionContiner","formatNumericTextBox","tableHasWidth","groupButtons","groupButton","rowDiv","sizeLabeldiv","childDiv1","childdiv2","child3","child4","allowRowContainer","repeatHeaderContaniner","enableRowHeight","parentdiv","childdiv1","preferredCellWidth","divAlignment","divStyle","topAlignDiv","cellTopAlign","cellCenterAlign","bottomAlignDiv","cellBottomAlign","centerLabel","bottomLabel","cellAlignments","applyBordersShadingsProperties","tablePropertiesDialog","checkClassName","previewDivTopTop","previewDivTopBottom","previewDivTopCenter","previewDivBottomcenter","previewDivBottomLeft","previewDivBottomRight","previewDivDiagonalRight","previewDivLeftDiagonal","shadingColorPicker","ulelementShading","applyTo","noneDiv","currentTableFormat","closeDialog","closeBordersShadingsDialog","handleSettingCheckBoxAction","targetId","tableBorderDialogId","updateClassForSettingDivElements","setSettingPreviewDivElement","boxDiv","allDiv","customDiv","handlePreviewCheckBoxAction","compareClass","handlePreviewCheckBoxShowHide","showHidePreviewDivElements","applyTableCellPreviewBoxes","previewDivBottomcenterContainer","previewDivTopCenterContainer","previewVerticalDiv","previewHorizontalDiv","previewDivBottomRightContainer","applyPreviewTableBackgroundColor","previewDiv","applyPreviewTableBorderColor","previewRightDiagonalDiv","previewLeftDiagonalDiv","settingsContiner","styleContainer","previewContiner","styleText","dropDownList","widthText","widthNumeric","colorText","borderColorPickerElement","settingText","noneDivContainer","noneDivLabel","boxDivContainer","boxDivLabel","allDivContainer","allDivLabel","customDivContainer","customDivLabel","noneDivTransparent","boxDivTransparent","allDivTransparent","customDivTransparent","previewText","previewDivTopTopContainer","previewDivTopBottomContainer","previewDivLeftDiagonalContainer","previewDivBottomLeftContainer","previewDivDiagonalRightContainer","previewDivTopTopTransParent","previewDivTopCenterTransParent","previewDivTopBottomTransParent","previewDivLeftDiagonalTransParent","previewDivBottomLeftTransparent","previewDivBottomcenterTransparent","previewDivBottomRightTransparent","previewDivDiagonalRightTransparent","shadingContiner","shadingText","shadings","shadingColorPickerElement","shdApply","divsion","borderColorPicker","loadBordersShadingsPropertiesDialog","settingDivs","tempClassName","isShowHidePreviewTableElements","settingDiv","elementClass","compareElementClass","setElement","compareElement","setPropertyPreviewDivElement","ele","cloneBorders","getLineStyle","colorPickerEvent","fillColorEvent","horizontalBorder","verticalBorder","diagonalDownBorder","customBorder","diagonalUpBorder","applyTableCellProperties","cellSpaceTextBox","applyTableOptions","closeCellMarginsDialog","changeAllowSpaceCheckBox","allowSpaceCheckBox","removeEvents","innerDiv","innerDivLabel","getCellMarginDialogElements","cellSpaceLabel","table2","cellspacingTextBox","divBtn","loadCellMarginsDialog","applyTableOptionsHistory","applySubTableOptionsHelper","documentLocale","changeSameAsTable","sameAsTableCheckBox","tr","td","localizeValue","sameAsTable","loadCellProperties","enableTextBox","enableCheckBox","applyCellMarginsInternal","applyCellMarginsForCells","rowCells","iterateCells","applySubCellMargins","leftLabel","defaultStyleNames","v","modifyStyles","addNewStyles","initStylesDialog","newButtonDiv","newButtonElement","modifybuttonDiv","modifyButtonElement","hideObjects"],"mappings":"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"}